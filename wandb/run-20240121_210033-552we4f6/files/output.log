/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
obs <crafter.objects.Shelter object at 0x13f71c910> [39.  0.  0.  0. 39.  0.  0.  0. 22.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11ecfbdf0> [39.  0.  0.  0. 43.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13f721760> [ 9.  0.  0.  0.  9.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13f71c910> [39.  0.  0.  0. 39.  0.  0.  0. 19.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x11ecfbdf0> [38.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13f721760> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0030698776245117188 seconds
19 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(0.9029, dtype=torch.float64)
19 gae_duplicate tensor(0.8789, dtype=torch.float64) tensor(-17.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(0.9386, dtype=torch.float64)
18 gae_duplicate tensor(0.9804, dtype=torch.float64) tensor(-20.4196, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9418, dtype=torch.float64) delta_t tensor(0.9783, dtype=torch.float64)
17 gae_duplicate tensor(1.0192, dtype=torch.float64) tensor(-21.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9953, dtype=torch.float64) delta_t tensor(0.9568, dtype=torch.float64)
16 gae_duplicate tensor(0.9128, dtype=torch.float64) tensor(-20.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0595, dtype=torch.float64) delta_t tensor(1.0618, dtype=torch.float64)
15 gae_duplicate tensor(1.0318, dtype=torch.float64) tensor(-22.6850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1382, dtype=torch.float64) delta_t tensor(1.1485, dtype=torch.float64)
14 gae_duplicate tensor(1.1200, dtype=torch.float64) tensor(-25.1020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.2383, dtype=torch.float64) delta_t tensor(1.2001, dtype=torch.float64)
13 gae_duplicate tensor(1.1223, dtype=torch.float64) tensor(-25.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.3715, dtype=torch.float64) delta_t tensor(1.3718, dtype=torch.float64)
12 gae_duplicate tensor(1.2571, dtype=torch.float64) tensor(-29.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.5617, dtype=torch.float64) delta_t tensor(1.4579, dtype=torch.float64)
11 gae_duplicate tensor(1.4697, dtype=torch.float64) tensor(-31.4317, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(1.5371, dtype=torch.float64) delta_t tensor(1.3581, dtype=torch.float64)
10 gae_duplicate tensor(1.4068, dtype=torch.float64) tensor(-29.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4061, dtype=torch.float64) delta_t tensor(1.4936, dtype=torch.float64)
9 gae_duplicate tensor(1.4947, dtype=torch.float64) tensor(-32.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.4322, dtype=torch.float64) delta_t tensor(1.5372, dtype=torch.float64)
8 gae_duplicate tensor(1.4764, dtype=torch.float64) tensor(-33.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(1.4646, dtype=torch.float64) delta_t tensor(1.5978, dtype=torch.float64)
7 gae_duplicate tensor(1.6886, dtype=torch.float64) tensor(-34.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(1.3812, dtype=torch.float64) delta_t tensor(1.4585, dtype=torch.float64)
6 gae_duplicate tensor(1.4469, dtype=torch.float64) tensor(-32.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(1.0211, dtype=torch.float64) delta_t tensor(1.1199, dtype=torch.float64)
5 gae_duplicate tensor(0.9002, dtype=torch.float64) tensor(-25.6262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9202, dtype=torch.float64) delta_t tensor(-0.8885, dtype=torch.float64)
4 gae_duplicate tensor(-0.9527, dtype=torch.float64) tensor(14.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9880, dtype=torch.float64) delta_t tensor(-0.9040, dtype=torch.float64)
3 gae_duplicate tensor(-1.0763, dtype=torch.float64) tensor(18.6050, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8841, dtype=torch.float64) delta_t tensor(-0.8991, dtype=torch.float64)
2 gae_duplicate tensor(-1.2184, dtype=torch.float64) tensor(19.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:18735.51953125
value loss:287.2322082519531
entropies:354.4978942871094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.742297887802124 seconds
19 rew tensor(0.8739, dtype=torch.float64) delta_t tensor(0.8299, dtype=torch.float64)
19 gae_duplicate tensor(0.7978, dtype=torch.float64) tensor(-15.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.8491, dtype=torch.float64)
18 gae_duplicate tensor(0.8986, dtype=torch.float64) tensor(-18.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9151, dtype=torch.float64) delta_t tensor(0.8746, dtype=torch.float64)
17 gae_duplicate tensor(0.9171, dtype=torch.float64) tensor(-18.8589, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9381, dtype=torch.float64) delta_t tensor(0.8493, dtype=torch.float64)
16 gae_duplicate tensor(0.6690, dtype=torch.float64) tensor(-18.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9628, dtype=torch.float64) delta_t tensor(0.8734, dtype=torch.float64)
15 gae_duplicate tensor(0.7126, dtype=torch.float64) tensor(-18.7527, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9897, dtype=torch.float64) delta_t tensor(0.9037, dtype=torch.float64)
14 gae_duplicate tensor(0.7696, dtype=torch.float64) tensor(-19.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0189, dtype=torch.float64) delta_t tensor(0.9264, dtype=torch.float64)
13 gae_duplicate tensor(0.7500, dtype=torch.float64) tensor(-20.4048, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0328, dtype=torch.float64) delta_t tensor(0.9684, dtype=torch.float64)
12 gae_duplicate tensor(0.9736, dtype=torch.float64) tensor(-21.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0121, dtype=torch.float64) delta_t tensor(0.7496, dtype=torch.float64)
11 gae_duplicate tensor(0.6964, dtype=torch.float64) tensor(-16.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8292, dtype=torch.float64) delta_t tensor(0.6007, dtype=torch.float64)
10 gae_duplicate tensor(0.5615, dtype=torch.float64) tensor(-13.5805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4192, dtype=torch.float64) delta_t tensor(0.4699, dtype=torch.float64)
9 gae_duplicate tensor(0.4536, dtype=torch.float64) tensor(-10.8265, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2873, dtype=torch.float64) delta_t tensor(0.3179, dtype=torch.float64)
8 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-7.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0822, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
7 gae_duplicate tensor(-0.4178, dtype=torch.float64) tensor(-0.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2165, dtype=torch.float64) delta_t tensor(-0.1279, dtype=torch.float64)
6 gae_duplicate tensor(-0.3676, dtype=torch.float64) tensor(2.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5154, dtype=torch.float64) delta_t tensor(-0.4547, dtype=torch.float64)
5 gae_duplicate tensor(-0.7996, dtype=torch.float64) tensor(9.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.2022, dtype=torch.float64) delta_t tensor(-1.1142, dtype=torch.float64)
4 gae_duplicate tensor(-1.6299, dtype=torch.float64) tensor(22.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5404, dtype=torch.float64) delta_t tensor(-1.4470, dtype=torch.float64)
3 gae_duplicate tensor(-1.8240, dtype=torch.float64) tensor(30.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4649, dtype=torch.float64) delta_t tensor(-1.4784, dtype=torch.float64)
2 gae_duplicate tensor(-1.9380, dtype=torch.float64) tensor(32.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5455.8515625
value loss:147.45269775390625
entropies:354.9514465332031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.079571008682251 seconds
19 rew tensor(0.8804, dtype=torch.float64) delta_t tensor(0.7216, dtype=torch.float64)
19 gae_duplicate tensor(0.6878, dtype=torch.float64) tensor(-14.2041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(0.7522, dtype=torch.float64)
18 gae_duplicate tensor(0.7964, dtype=torch.float64) tensor(-16.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(0.7662, dtype=torch.float64)
17 gae_duplicate tensor(0.8281, dtype=torch.float64) tensor(-16.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9222, dtype=torch.float64) delta_t tensor(0.7181, dtype=torch.float64)
16 gae_duplicate tensor(0.4638, dtype=torch.float64) tensor(-15.5786, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9375, dtype=torch.float64) delta_t tensor(0.7427, dtype=torch.float64)
15 gae_duplicate tensor(0.5604, dtype=torch.float64) tensor(-16.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9536, dtype=torch.float64) delta_t tensor(0.7695, dtype=torch.float64)
14 gae_duplicate tensor(0.6470, dtype=torch.float64) tensor(-16.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9706, dtype=torch.float64) delta_t tensor(0.7578, dtype=torch.float64)
13 gae_duplicate tensor(0.5540, dtype=torch.float64) tensor(-16.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9885, dtype=torch.float64) delta_t tensor(0.7881, dtype=torch.float64)
12 gae_duplicate tensor(0.6134, dtype=torch.float64) tensor(-17.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9732, dtype=torch.float64) delta_t tensor(0.5815, dtype=torch.float64)
11 gae_duplicate tensor(0.5729, dtype=torch.float64) tensor(-12.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7560, dtype=torch.float64) delta_t tensor(0.3501, dtype=torch.float64)
10 gae_duplicate tensor(0.2498, dtype=torch.float64) tensor(-8.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3587, dtype=torch.float64) delta_t tensor(0.3022, dtype=torch.float64)
9 gae_duplicate tensor(0.2344, dtype=torch.float64) tensor(-6.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1494, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
8 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(-1.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0599, dtype=torch.float64) delta_t tensor(-0.2154, dtype=torch.float64)
7 gae_duplicate tensor(-0.5842, dtype=torch.float64) tensor(3.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3458, dtype=torch.float64) delta_t tensor(-0.3283, dtype=torch.float64)
6 gae_duplicate tensor(-0.4932, dtype=torch.float64) tensor(6.6117, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6226, dtype=torch.float64) delta_t tensor(-0.5616, dtype=torch.float64)
5 gae_duplicate tensor(-0.7547, dtype=torch.float64) tensor(11.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4064, dtype=torch.float64) delta_t tensor(-1.3183, dtype=torch.float64)
4 gae_duplicate tensor(-1.6880, dtype=torch.float64) tensor(27.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6864, dtype=torch.float64) delta_t tensor(-1.5550, dtype=torch.float64)
3 gae_duplicate tensor(-1.8154, dtype=torch.float64) tensor(33.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5556, dtype=torch.float64) delta_t tensor(-1.5114, dtype=torch.float64)
2 gae_duplicate tensor(-2.0063, dtype=torch.float64) tensor(33.6123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2161.27734375
value loss:132.62820434570312
entropies:355.13983154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.680138826370239 seconds
19 rew tensor(0.8796, dtype=torch.float64) delta_t tensor(0.6063, dtype=torch.float64)
19 gae_duplicate tensor(0.5860, dtype=torch.float64) tensor(-12.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.6434, dtype=torch.float64)
18 gae_duplicate tensor(0.6868, dtype=torch.float64) tensor(-13.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(0.6496, dtype=torch.float64)
17 gae_duplicate tensor(0.7047, dtype=torch.float64) tensor(-14.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.4337, dtype=torch.float64)
16 gae_duplicate tensor(0.2381, dtype=torch.float64) tensor(-9.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9213, dtype=torch.float64) delta_t tensor(0.5103, dtype=torch.float64)
15 gae_duplicate tensor(0.2786, dtype=torch.float64) tensor(-11.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(0.5977, dtype=torch.float64)
14 gae_duplicate tensor(0.4087, dtype=torch.float64) tensor(-12.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9446, dtype=torch.float64) delta_t tensor(0.4601, dtype=torch.float64)
13 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-10.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9569, dtype=torch.float64) delta_t tensor(0.5512, dtype=torch.float64)
12 gae_duplicate tensor(0.4155, dtype=torch.float64) tensor(-11.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9697, dtype=torch.float64) delta_t tensor(0.4029, dtype=torch.float64)
11 gae_duplicate tensor(0.3929, dtype=torch.float64) tensor(-9.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7102, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
10 gae_duplicate tensor(0.0585, dtype=torch.float64) tensor(-2.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3736, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
9 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-3.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1952, dtype=torch.float64) delta_t tensor(0.2176, dtype=torch.float64)
8 gae_duplicate tensor(-0.5962, dtype=torch.float64) tensor(-4.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0005, dtype=torch.float64) delta_t tensor(-0.2655, dtype=torch.float64)
7 gae_duplicate tensor(-0.5350, dtype=torch.float64) tensor(4.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.2484, dtype=torch.float64) delta_t tensor(-0.3127, dtype=torch.float64)
6 gae_duplicate tensor(-0.5559, dtype=torch.float64) tensor(6.7579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6725, dtype=torch.float64) delta_t tensor(-0.5999, dtype=torch.float64)
5 gae_duplicate tensor(-0.8696, dtype=torch.float64) tensor(12.7192, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6090, dtype=torch.float64) delta_t tensor(-1.4984, dtype=torch.float64)
4 gae_duplicate tensor(-1.8377, dtype=torch.float64) tensor(31.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5690, dtype=torch.float64) delta_t tensor(-1.4658, dtype=torch.float64)
3 gae_duplicate tensor(-1.8361, dtype=torch.float64) tensor(32.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3988, dtype=torch.float64) delta_t tensor(-1.2962, dtype=torch.float64)
2 gae_duplicate tensor(-1.7186, dtype=torch.float64) tensor(28.2633, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-122.96543884277344
value loss:104.84390258789062
entropies:354.9415283203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.561638832092285 seconds
19 rew tensor(0.8828, dtype=torch.float64) delta_t tensor(0.4858, dtype=torch.float64)
19 gae_duplicate tensor(0.4675, dtype=torch.float64) tensor(-9.7765, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.5337, dtype=torch.float64)
18 gae_duplicate tensor(0.5680, dtype=torch.float64) tensor(-11.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5401, dtype=torch.float64)
17 gae_duplicate tensor(0.5840, dtype=torch.float64) tensor(-11.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.3552, dtype=torch.float64)
16 gae_duplicate tensor(0.0053, dtype=torch.float64) tensor(-8.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9160, dtype=torch.float64) delta_t tensor(0.3932, dtype=torch.float64)
15 gae_duplicate tensor(0.0410, dtype=torch.float64) tensor(-8.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9249, dtype=torch.float64) delta_t tensor(0.4128, dtype=torch.float64)
14 gae_duplicate tensor(0.0581, dtype=torch.float64) tensor(-9.0829, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9340, dtype=torch.float64) delta_t tensor(0.2598, dtype=torch.float64)
13 gae_duplicate tensor(0.0501, dtype=torch.float64) tensor(-6.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(0.3928, dtype=torch.float64)
12 gae_duplicate tensor(0.1490, dtype=torch.float64) tensor(-8.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9349, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
11 gae_duplicate tensor(0.0430, dtype=torch.float64) tensor(-3.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6857, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
10 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3235, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
9 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(-2.0211, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1233, dtype=torch.float64) delta_t tensor(-0.1521, dtype=torch.float64)
8 gae_duplicate tensor(-0.6918, dtype=torch.float64) tensor(2.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0944, dtype=torch.float64) delta_t tensor(-0.5144, dtype=torch.float64)
7 gae_duplicate tensor(-0.9563, dtype=torch.float64) tensor(10.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3583, dtype=torch.float64) delta_t tensor(-0.4823, dtype=torch.float64)
6 gae_duplicate tensor(-0.7333, dtype=torch.float64) tensor(10.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7307, dtype=torch.float64) delta_t tensor(-0.6182, dtype=torch.float64)
5 gae_duplicate tensor(-0.9309, dtype=torch.float64) tensor(13.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4745, dtype=torch.float64) delta_t tensor(-1.2824, dtype=torch.float64)
4 gae_duplicate tensor(-1.5651, dtype=torch.float64) tensor(26.2799, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5374, dtype=torch.float64) delta_t tensor(-1.4234, dtype=torch.float64)
3 gae_duplicate tensor(-1.6759, dtype=torch.float64) tensor(30.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3504, dtype=torch.float64) delta_t tensor(-1.1391, dtype=torch.float64)
2 gae_duplicate tensor(-1.8433, dtype=torch.float64) tensor(24.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2235.248779296875
value loss:85.92318725585938
entropies:354.7027282714844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3977.4751)
ToM Target loss= tensor(3812.5735)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.257875919342041 seconds
19 rew tensor(0.8816, dtype=torch.float64) delta_t tensor(0.3729, dtype=torch.float64)
19 gae_duplicate tensor(0.3441, dtype=torch.float64) tensor(-7.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.4361, dtype=torch.float64)
18 gae_duplicate tensor(0.4513, dtype=torch.float64) tensor(-9.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8949, dtype=torch.float64) delta_t tensor(0.4304, dtype=torch.float64)
17 gae_duplicate tensor(0.4519, dtype=torch.float64) tensor(-9.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9018, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
16 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-3.8604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9089, dtype=torch.float64) delta_t tensor(0.2730, dtype=torch.float64)
15 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-6.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(0.2855, dtype=torch.float64)
14 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-6.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9235, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
13 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(-2.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9311, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
12 gae_duplicate tensor(-0.0639, dtype=torch.float64) tensor(-2.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9389, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
11 gae_duplicate tensor(-0.0312, dtype=torch.float64) tensor(-0.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6698, dtype=torch.float64) delta_t tensor(-0.1874, dtype=torch.float64)
10 gae_duplicate tensor(-0.3039, dtype=torch.float64) tensor(3.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3232, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
9 gae_duplicate tensor(-0.4988, dtype=torch.float64) tensor(2.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1429, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
8 gae_duplicate tensor(-0.5156, dtype=torch.float64) tensor(0.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1115, dtype=torch.float64) delta_t tensor(-0.4726, dtype=torch.float64)
7 gae_duplicate tensor(-0.8738, dtype=torch.float64) tensor(9.5344, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3489, dtype=torch.float64) delta_t tensor(-0.3323, dtype=torch.float64)
6 gae_duplicate tensor(-0.7132, dtype=torch.float64) tensor(7.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7679, dtype=torch.float64) delta_t tensor(-0.5319, dtype=torch.float64)
5 gae_duplicate tensor(-0.7123, dtype=torch.float64) tensor(11.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7290, dtype=torch.float64) delta_t tensor(-1.5018, dtype=torch.float64)
4 gae_duplicate tensor(-1.8035, dtype=torch.float64) tensor(30.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7259, dtype=torch.float64) delta_t tensor(-1.5321, dtype=torch.float64)
3 gae_duplicate tensor(-2.0100, dtype=torch.float64) tensor(32.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5403, dtype=torch.float64) delta_t tensor(-1.3702, dtype=torch.float64)
2 gae_duplicate tensor(-2.2586, dtype=torch.float64) tensor(29.8410, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4367.10009765625
value loss:90.69168853759766
entropies:354.69781494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.807927131652832 seconds
19 rew tensor(0.8819, dtype=torch.float64) delta_t tensor(0.2775, dtype=torch.float64)
19 gae_duplicate tensor(0.2584, dtype=torch.float64) tensor(-5.5401, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.3379, dtype=torch.float64)
18 gae_duplicate tensor(0.3518, dtype=torch.float64) tensor(-7.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
17 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-6.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8992, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
16 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(-2.4780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9052, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
15 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-4.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9113, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
14 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(-5.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(-0.1801, dtype=torch.float64)
13 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(3.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9239, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
12 gae_duplicate tensor(-0.2817, dtype=torch.float64) tensor(3.6003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(-0.1933, dtype=torch.float64)
11 gae_duplicate tensor(-0.4390, dtype=torch.float64) tensor(4.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(-0.2834, dtype=torch.float64)
10 gae_duplicate tensor(-0.5029, dtype=torch.float64) tensor(5.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2599, dtype=torch.float64) delta_t tensor(-0.3526, dtype=torch.float64)
9 gae_duplicate tensor(-0.6313, dtype=torch.float64) tensor(7.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1303, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
8 gae_duplicate tensor(-0.7486, dtype=torch.float64) tensor(1.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0886, dtype=torch.float64) delta_t tensor(-0.6557, dtype=torch.float64)
7 gae_duplicate tensor(-1.1375, dtype=torch.float64) tensor(13.4977, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3891, dtype=torch.float64) delta_t tensor(-0.2953, dtype=torch.float64)
6 gae_duplicate tensor(-0.7947, dtype=torch.float64) tensor(6.8790, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7633, dtype=torch.float64) delta_t tensor(-0.4138, dtype=torch.float64)
5 gae_duplicate tensor(-0.5460, dtype=torch.float64) tensor(8.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6885, dtype=torch.float64) delta_t tensor(-1.4226, dtype=torch.float64)
4 gae_duplicate tensor(-1.7959, dtype=torch.float64) tensor(28.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7699, dtype=torch.float64) delta_t tensor(-1.5702, dtype=torch.float64)
3 gae_duplicate tensor(-1.9777, dtype=torch.float64) tensor(32.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5794, dtype=torch.float64) delta_t tensor(-1.3000, dtype=torch.float64)
2 gae_duplicate tensor(-1.9795, dtype=torch.float64) tensor(29.1077, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6260.869140625
value loss:87.18136596679688
entropies:354.84423828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.08472204208374 seconds
19 rew tensor(0.8809, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
19 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-3.6676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(0.2626, dtype=torch.float64)
18 gae_duplicate tensor(0.2675, dtype=torch.float64) tensor(-5.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
17 gae_duplicate tensor(0.2717, dtype=torch.float64) tensor(-5.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8959, dtype=torch.float64) delta_t tensor(-0.2478, dtype=torch.float64)
16 gae_duplicate tensor(-0.5237, dtype=torch.float64) tensor(4.4039, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9011, dtype=torch.float64) delta_t tensor(-0.1529, dtype=torch.float64)
15 gae_duplicate tensor(-0.5064, dtype=torch.float64) tensor(3.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(-0.1119, dtype=torch.float64)
14 gae_duplicate tensor(-0.4857, dtype=torch.float64) tensor(2.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9118, dtype=torch.float64) delta_t tensor(-0.4618, dtype=torch.float64)
13 gae_duplicate tensor(-0.4890, dtype=torch.float64) tensor(9.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(-0.1193, dtype=torch.float64)
12 gae_duplicate tensor(-0.4759, dtype=torch.float64) tensor(3.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9228, dtype=torch.float64) delta_t tensor(-0.2661, dtype=torch.float64)
11 gae_duplicate tensor(-0.3151, dtype=torch.float64) tensor(5.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6520, dtype=torch.float64) delta_t tensor(-0.4325, dtype=torch.float64)
10 gae_duplicate tensor(-0.5778, dtype=torch.float64) tensor(9.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2873, dtype=torch.float64) delta_t tensor(-0.2870, dtype=torch.float64)
9 gae_duplicate tensor(-0.6300, dtype=torch.float64) tensor(6.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0862, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
8 gae_duplicate tensor(-0.8007, dtype=torch.float64) tensor(2.4150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0595, dtype=torch.float64) delta_t tensor(-0.5395, dtype=torch.float64)
7 gae_duplicate tensor(-0.6984, dtype=torch.float64) tensor(10.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3242, dtype=torch.float64) delta_t tensor(-0.2629, dtype=torch.float64)
6 gae_duplicate tensor(-0.7953, dtype=torch.float64) tensor(6.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7701, dtype=torch.float64) delta_t tensor(-0.4506, dtype=torch.float64)
5 gae_duplicate tensor(-0.6834, dtype=torch.float64) tensor(9.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8072, dtype=torch.float64) delta_t tensor(-1.4866, dtype=torch.float64)
4 gae_duplicate tensor(-1.8300, dtype=torch.float64) tensor(29.9935, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7800, dtype=torch.float64) delta_t tensor(-1.4640, dtype=torch.float64)
3 gae_duplicate tensor(-1.8689, dtype=torch.float64) tensor(31.9002, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5856, dtype=torch.float64) delta_t tensor(-1.2508, dtype=torch.float64)
2 gae_duplicate tensor(-1.6150, dtype=torch.float64) tensor(28.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8136.87060546875
value loss:86.11433410644531
entropies:355.05126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.795199871063232 seconds
19 rew tensor(0.8829, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
19 gae_duplicate tensor(0.1273, dtype=torch.float64) tensor(-2.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.2104, dtype=torch.float64)
18 gae_duplicate tensor(0.2065, dtype=torch.float64) tensor(-4.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
17 gae_duplicate tensor(0.2073, dtype=torch.float64) tensor(-4.6635, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
16 gae_duplicate tensor(-0.2435, dtype=torch.float64) tensor(-3.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9009, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
15 gae_duplicate tensor(0.0275, dtype=torch.float64) tensor(-4.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.1885, dtype=torch.float64)
14 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-4.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(-0.4166, dtype=torch.float64)
13 gae_duplicate tensor(-0.5929, dtype=torch.float64) tensor(7.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9151, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
12 gae_duplicate tensor(-0.5895, dtype=torch.float64) tensor(-2.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(-0.4220, dtype=torch.float64)
11 gae_duplicate tensor(-0.4792, dtype=torch.float64) tensor(8.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6483, dtype=torch.float64) delta_t tensor(-0.4046, dtype=torch.float64)
10 gae_duplicate tensor(-0.6391, dtype=torch.float64) tensor(8.6453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1723, dtype=torch.float64) delta_t tensor(-0.5378, dtype=torch.float64)
9 gae_duplicate tensor(-0.8827, dtype=torch.float64) tensor(11.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0112, dtype=torch.float64) delta_t tensor(-0.4285, dtype=torch.float64)
8 gae_duplicate tensor(-0.9141, dtype=torch.float64) tensor(9.4037, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1949, dtype=torch.float64) delta_t tensor(-0.6251, dtype=torch.float64)
7 gae_duplicate tensor(-0.8529, dtype=torch.float64) tensor(13.2257, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4610, dtype=torch.float64) delta_t tensor(-0.2315, dtype=torch.float64)
6 gae_duplicate tensor(-0.8723, dtype=torch.float64) tensor(6.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8159, dtype=torch.float64) delta_t tensor(-0.7517, dtype=torch.float64)
5 gae_duplicate tensor(-1.1802, dtype=torch.float64) tensor(15.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5256, dtype=torch.float64) delta_t tensor(-1.0701, dtype=torch.float64)
4 gae_duplicate tensor(-1.5248, dtype=torch.float64) tensor(22.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8375, dtype=torch.float64) delta_t tensor(-1.3558, dtype=torch.float64)
3 gae_duplicate tensor(-1.9425, dtype=torch.float64) tensor(28.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6428, dtype=torch.float64) delta_t tensor(-1.3360, dtype=torch.float64)
2 gae_duplicate tensor(-1.9534, dtype=torch.float64) tensor(29.8657, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7476.68017578125
value loss:82.0397720336914
entropies:355.2062072753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.819025278091431 seconds
19 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
19 gae_duplicate tensor(0.0493, dtype=torch.float64) tensor(-1.5370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
18 gae_duplicate tensor(0.1112, dtype=torch.float64) tensor(-3.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(-0.1231, dtype=torch.float64)
17 gae_duplicate tensor(-0.7096, dtype=torch.float64) tensor(2.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(-0.1045, dtype=torch.float64)
16 gae_duplicate tensor(-0.6948, dtype=torch.float64) tensor(2.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
15 gae_duplicate tensor(-0.6540, dtype=torch.float64) tensor(1.8581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
14 gae_duplicate tensor(-0.6480, dtype=torch.float64) tensor(1.7344, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(-0.4844, dtype=torch.float64)
13 gae_duplicate tensor(-0.6537, dtype=torch.float64) tensor(9.8395, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(-0.2749, dtype=torch.float64)
12 gae_duplicate tensor(-0.6690, dtype=torch.float64) tensor(6.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(-0.4845, dtype=torch.float64)
11 gae_duplicate tensor(-0.7611, dtype=torch.float64) tensor(10.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(-0.4349, dtype=torch.float64)
10 gae_duplicate tensor(-0.6893, dtype=torch.float64) tensor(9.6242, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2227, dtype=torch.float64) delta_t tensor(-0.5120, dtype=torch.float64)
9 gae_duplicate tensor(-0.8995, dtype=torch.float64) tensor(10.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0404, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
8 gae_duplicate tensor(-0.6505, dtype=torch.float64) tensor(2.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1613, dtype=torch.float64) delta_t tensor(-0.7974, dtype=torch.float64)
7 gae_duplicate tensor(-1.2828, dtype=torch.float64) tensor(16.2464, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5275, dtype=torch.float64) delta_t tensor(-0.4449, dtype=torch.float64)
6 gae_duplicate tensor(-0.7793, dtype=torch.float64) tensor(10.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8371, dtype=torch.float64) delta_t tensor(-0.3716, dtype=torch.float64)
5 gae_duplicate tensor(-1.1156, dtype=torch.float64) tensor(8.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6563, dtype=torch.float64) delta_t tensor(-1.1826, dtype=torch.float64)
4 gae_duplicate tensor(-1.6416, dtype=torch.float64) tensor(24.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8434, dtype=torch.float64) delta_t tensor(-1.2884, dtype=torch.float64)
3 gae_duplicate tensor(-1.8159, dtype=torch.float64) tensor(28.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6461, dtype=torch.float64) delta_t tensor(-1.2864, dtype=torch.float64)
2 gae_duplicate tensor(-2.2017, dtype=torch.float64) tensor(27.5848, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9177.1494140625
value loss:87.54044342041016
entropies:355.249755859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.6987)
ToM Target loss= tensor(3823.4128)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.430888891220093 seconds
19 rew tensor(0.8844, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
19 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-0.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
18 gae_duplicate tensor(0.1182, dtype=torch.float64) tensor(-2.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
17 gae_duplicate tensor(-0.4193, dtype=torch.float64) tensor(-0.7689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8954, dtype=torch.float64) delta_t tensor(-0.2777, dtype=torch.float64)
16 gae_duplicate tensor(-0.7414, dtype=torch.float64) tensor(5.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8991, dtype=torch.float64) delta_t tensor(-0.2336, dtype=torch.float64)
15 gae_duplicate tensor(-0.7065, dtype=torch.float64) tensor(5.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9029, dtype=torch.float64) delta_t tensor(-0.2266, dtype=torch.float64)
14 gae_duplicate tensor(-0.6985, dtype=torch.float64) tensor(5.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(-0.6171, dtype=torch.float64)
13 gae_duplicate tensor(-0.7067, dtype=torch.float64) tensor(12.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9106, dtype=torch.float64) delta_t tensor(-0.1669, dtype=torch.float64)
12 gae_duplicate tensor(-0.6805, dtype=torch.float64) tensor(4.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8773, dtype=torch.float64) delta_t tensor(-0.4749, dtype=torch.float64)
11 gae_duplicate tensor(-0.6436, dtype=torch.float64) tensor(9.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6232, dtype=torch.float64) delta_t tensor(-0.3682, dtype=torch.float64)
10 gae_duplicate tensor(-0.6968, dtype=torch.float64) tensor(8.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2566, dtype=torch.float64) delta_t tensor(-0.3014, dtype=torch.float64)
9 gae_duplicate tensor(-0.6086, dtype=torch.float64) tensor(6.8079, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0551, dtype=torch.float64) delta_t tensor(-0.2243, dtype=torch.float64)
8 gae_duplicate tensor(-0.9964, dtype=torch.float64) tensor(5.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1462, dtype=torch.float64) delta_t tensor(-0.6076, dtype=torch.float64)
7 gae_duplicate tensor(-0.8970, dtype=torch.float64) tensor(12.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4306, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
6 gae_duplicate tensor(-0.5920, dtype=torch.float64) tensor(4.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7858, dtype=torch.float64) delta_t tensor(-0.2245, dtype=torch.float64)
5 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(4.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6609, dtype=torch.float64) delta_t tensor(-1.1491, dtype=torch.float64)
4 gae_duplicate tensor(-1.4742, dtype=torch.float64) tensor(23.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7899, dtype=torch.float64) delta_t tensor(-1.0190, dtype=torch.float64)
3 gae_duplicate tensor(-1.2843, dtype=torch.float64) tensor(22.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5882, dtype=torch.float64) delta_t tensor(-1.1453, dtype=torch.float64)
2 gae_duplicate tensor(-1.8253, dtype=torch.float64) tensor(24.6483, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-8215.6767578125
value loss:66.57159423828125
entropies:355.2867126464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2851128578186035 seconds
19 rew tensor(0.8841, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
19 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-0.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
18 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-2.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
17 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-2.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
16 gae_duplicate tensor(-0.6920, dtype=torch.float64) tensor(2.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(-0.0982, dtype=torch.float64)
15 gae_duplicate tensor(-0.6453, dtype=torch.float64) tensor(2.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-0.0911, dtype=torch.float64)
14 gae_duplicate tensor(-0.6353, dtype=torch.float64) tensor(1.9571, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(-0.5596, dtype=torch.float64)
13 gae_duplicate tensor(-0.6536, dtype=torch.float64) tensor(11.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(-0.4420, dtype=torch.float64)
12 gae_duplicate tensor(-0.6591, dtype=torch.float64) tensor(9.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9116, dtype=torch.float64) delta_t tensor(-0.3293, dtype=torch.float64)
11 gae_duplicate tensor(-0.4459, dtype=torch.float64) tensor(7.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6384, dtype=torch.float64) delta_t tensor(-0.5102, dtype=torch.float64)
10 gae_duplicate tensor(-0.5948, dtype=torch.float64) tensor(10.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(-0.3655, dtype=torch.float64)
9 gae_duplicate tensor(-0.7455, dtype=torch.float64) tensor(8.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1251, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
8 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-1.4256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.3154, dtype=torch.float64)
7 gae_duplicate tensor(-0.4973, dtype=torch.float64) tensor(6.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3058, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
6 gae_duplicate tensor(-0.4761, dtype=torch.float64) tensor(1.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7909, dtype=torch.float64) delta_t tensor(-0.1841, dtype=torch.float64)
5 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(3.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7616, dtype=torch.float64) delta_t tensor(-1.1551, dtype=torch.float64)
4 gae_duplicate tensor(-1.3940, dtype=torch.float64) tensor(23.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7224, dtype=torch.float64) delta_t tensor(-0.8945, dtype=torch.float64)
3 gae_duplicate tensor(-1.2735, dtype=torch.float64) tensor(20.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5168, dtype=torch.float64) delta_t tensor(-0.7628, dtype=torch.float64)
2 gae_duplicate tensor(-1.2213, dtype=torch.float64) tensor(17.4606, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6536.00341796875
value loss:47.91022872924805
entropies:355.3330078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.276454210281372 seconds
19 rew tensor(0.8845, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
19 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-1.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.1432, dtype=torch.float64)
18 gae_duplicate tensor(0.1202, dtype=torch.float64) tensor(-2.9271, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
17 gae_duplicate tensor(0.0827, dtype=torch.float64) tensor(-3.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
16 gae_duplicate tensor(-0.6254, dtype=torch.float64) tensor(0.8444, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
15 gae_duplicate tensor(-0.5880, dtype=torch.float64) tensor(-0.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
14 gae_duplicate tensor(-0.5703, dtype=torch.float64) tensor(-0.7689, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9033, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
13 gae_duplicate tensor(-0.6063, dtype=torch.float64) tensor(3.0839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
12 gae_duplicate tensor(-0.5542, dtype=torch.float64) tensor(3.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8736, dtype=torch.float64) delta_t tensor(-0.3591, dtype=torch.float64)
11 gae_duplicate tensor(-0.4410, dtype=torch.float64) tensor(7.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6184, dtype=torch.float64) delta_t tensor(-0.2784, dtype=torch.float64)
10 gae_duplicate tensor(-0.4590, dtype=torch.float64) tensor(6.4183, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1965, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
9 gae_duplicate tensor(-0.2427, dtype=torch.float64) tensor(1.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.1386, dtype=torch.float64)
8 gae_duplicate tensor(-0.7329, dtype=torch.float64) tensor(2.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1508, dtype=torch.float64) delta_t tensor(-0.3364, dtype=torch.float64)
7 gae_duplicate tensor(-1.0985, dtype=torch.float64) tensor(7.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5261, dtype=torch.float64) delta_t tensor(-0.2135, dtype=torch.float64)
6 gae_duplicate tensor(-0.5590, dtype=torch.float64) tensor(5.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8469, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
5 gae_duplicate tensor(-0.4303, dtype=torch.float64) tensor(0.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6910, dtype=torch.float64) delta_t tensor(-0.9501, dtype=torch.float64)
4 gae_duplicate tensor(-1.2190, dtype=torch.float64) tensor(18.6565, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8686, dtype=torch.float64) delta_t tensor(-0.9159, dtype=torch.float64)
3 gae_duplicate tensor(-1.3410, dtype=torch.float64) tensor(19.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6840, dtype=torch.float64) delta_t tensor(-0.9756, dtype=torch.float64)
2 gae_duplicate tensor(-1.6692, dtype=torch.float64) tensor(21.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4890.3876953125
value loss:44.546749114990234
entropies:355.3343505859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.96035099029541 seconds
19 rew tensor(0.8837, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
19 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(-0.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
18 gae_duplicate tensor(0.0694, dtype=torch.float64) tensor(-2.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.1491, dtype=torch.float64)
17 gae_duplicate tensor(0.1478, dtype=torch.float64) tensor(-3.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
16 gae_duplicate tensor(-0.5837, dtype=torch.float64) tensor(2.3823, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
15 gae_duplicate tensor(-0.5516, dtype=torch.float64) tensor(1.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8981, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
14 gae_duplicate tensor(-0.5404, dtype=torch.float64) tensor(1.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(-0.2840, dtype=torch.float64)
13 gae_duplicate tensor(-0.5540, dtype=torch.float64) tensor(5.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
12 gae_duplicate tensor(-0.5119, dtype=torch.float64) tensor(4.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9070, dtype=torch.float64) delta_t tensor(-0.2052, dtype=torch.float64)
11 gae_duplicate tensor(-0.3477, dtype=torch.float64) tensor(4.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6344, dtype=torch.float64) delta_t tensor(-0.1774, dtype=torch.float64)
10 gae_duplicate tensor(-0.5033, dtype=torch.float64) tensor(4.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2874, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
9 gae_duplicate tensor(-0.0699, dtype=torch.float64) tensor(-2.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0681, dtype=torch.float64) delta_t tensor(0.2323, dtype=torch.float64)
8 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-4.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(-0.2864, dtype=torch.float64)
7 gae_duplicate tensor(-0.7139, dtype=torch.float64) tensor(5.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3878, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
6 gae_duplicate tensor(-0.4234, dtype=torch.float64) tensor(-0.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8090, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
5 gae_duplicate tensor(-0.0158, dtype=torch.float64) tensor(-0.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8127, dtype=torch.float64) delta_t tensor(-1.0669, dtype=torch.float64)
4 gae_duplicate tensor(-1.3564, dtype=torch.float64) tensor(20.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8821, dtype=torch.float64) delta_t tensor(-0.8771, dtype=torch.float64)
3 gae_duplicate tensor(-1.1553, dtype=torch.float64) tensor(19.4685, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6781, dtype=torch.float64) delta_t tensor(-0.8697, dtype=torch.float64)
2 gae_duplicate tensor(-1.6652, dtype=torch.float64) tensor(19.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4081.025634765625
value loss:41.12262725830078
entropies:355.29180908203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.775821685791016 seconds
19 rew tensor(0.8841, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
19 gae_duplicate tensor(0.0633, dtype=torch.float64) tensor(-1.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(0.1549, dtype=torch.float64)
18 gae_duplicate tensor(0.1538, dtype=torch.float64) tensor(-3.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
17 gae_duplicate tensor(0.1545, dtype=torch.float64) tensor(-3.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.1584, dtype=torch.float64)
16 gae_duplicate tensor(0.1599, dtype=torch.float64) tensor(-3.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
15 gae_duplicate tensor(0.1670, dtype=torch.float64) tensor(-3.6750, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(0.1758, dtype=torch.float64)
14 gae_duplicate tensor(0.1737, dtype=torch.float64) tensor(-3.9165, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9003, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
13 gae_duplicate tensor(-0.3775, dtype=torch.float64) tensor(-2.3339, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9031, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
12 gae_duplicate tensor(-0.2679, dtype=torch.float64) tensor(-3.6177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9059, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
11 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(3.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6325, dtype=torch.float64) delta_t tensor(-0.1463, dtype=torch.float64)
10 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(3.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1745, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
9 gae_duplicate tensor(-0.2005, dtype=torch.float64) tensor(0.4134, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0085, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
8 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-0.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1010, dtype=torch.float64) delta_t tensor(0.3629, dtype=torch.float64)
7 gae_duplicate tensor(0.2264, dtype=torch.float64) tensor(-7.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3116, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
6 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-2.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7963, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
5 gae_duplicate tensor(0.0317, dtype=torch.float64) tensor(-5.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6014, dtype=torch.float64) delta_t tensor(-0.7832, dtype=torch.float64)
4 gae_duplicate tensor(-0.8773, dtype=torch.float64) tensor(15.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7219, dtype=torch.float64) delta_t tensor(-0.5704, dtype=torch.float64)
3 gae_duplicate tensor(-0.8643, dtype=torch.float64) tensor(12.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5139, dtype=torch.float64) delta_t tensor(-0.6313, dtype=torch.float64)
2 gae_duplicate tensor(-1.2156, dtype=torch.float64) tensor(13.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-520.503173828125
value loss:20.252803802490234
entropies:355.2496337890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.1230)
ToM Target loss= tensor(3820.9568)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2732930183410645 seconds
19 rew tensor(0.8833, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
19 gae_duplicate tensor(-0.0586, dtype=torch.float64) tensor(-0.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
18 gae_duplicate tensor(0.0441, dtype=torch.float64) tensor(-2.9301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.1661, dtype=torch.float64)
17 gae_duplicate tensor(0.1604, dtype=torch.float64) tensor(-3.4608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
16 gae_duplicate tensor(-0.4368, dtype=torch.float64) tensor(0.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
15 gae_duplicate tensor(-0.4404, dtype=torch.float64) tensor(-0.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8959, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
14 gae_duplicate tensor(-0.4243, dtype=torch.float64) tensor(-0.7611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
13 gae_duplicate tensor(-0.4441, dtype=torch.float64) tensor(1.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9010, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
12 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-1.9114, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9037, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
11 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(1.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6306, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
10 gae_duplicate tensor(-0.3248, dtype=torch.float64) tensor(2.3039, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2466, dtype=torch.float64) delta_t tensor(0.0998, dtype=torch.float64)
9 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-1.7412, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
8 gae_duplicate tensor(-0.6061, dtype=torch.float64) tensor(-1.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1187, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
7 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(-3.4718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3745, dtype=torch.float64) delta_t tensor(0.1721, dtype=torch.float64)
6 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(-3.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.7958, dtype=torch.float64) delta_t tensor(0.3181, dtype=torch.float64)
5 gae_duplicate tensor(0.0903, dtype=torch.float64) tensor(-6.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8562, dtype=torch.float64) delta_t tensor(-0.9897, dtype=torch.float64)
4 gae_duplicate tensor(-1.3403, dtype=torch.float64) tensor(18.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8689, dtype=torch.float64) delta_t tensor(-0.7140, dtype=torch.float64)
3 gae_duplicate tensor(-0.9449, dtype=torch.float64) tensor(16.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6625, dtype=torch.float64) delta_t tensor(-0.6375, dtype=torch.float64)
2 gae_duplicate tensor(-0.9707, dtype=torch.float64) tensor(13.9030, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1523.7598876953125
value loss:27.71571159362793
entropies:355.2168884277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.153012037277222 seconds
19 rew tensor(0.8834, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
19 gae_duplicate tensor(0.0774, dtype=torch.float64) tensor(-1.7578, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(0.1616, dtype=torch.float64)
18 gae_duplicate tensor(0.1555, dtype=torch.float64) tensor(-3.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
17 gae_duplicate tensor(0.1582, dtype=torch.float64) tensor(-3.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
16 gae_duplicate tensor(0.1664, dtype=torch.float64) tensor(-3.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
15 gae_duplicate tensor(0.1670, dtype=torch.float64) tensor(-3.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
14 gae_duplicate tensor(0.1690, dtype=torch.float64) tensor(-3.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.2297, dtype=torch.float64)
13 gae_duplicate tensor(0.2370, dtype=torch.float64) tensor(-4.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.2330, dtype=torch.float64)
12 gae_duplicate tensor(0.2187, dtype=torch.float64) tensor(-5.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9025, dtype=torch.float64) delta_t tensor(-0.0734, dtype=torch.float64)
11 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(0.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
10 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-0.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1895, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
9 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-0.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0793, dtype=torch.float64) delta_t tensor(0.1689, dtype=torch.float64)
8 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-3.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0861, dtype=torch.float64) delta_t tensor(0.3274, dtype=torch.float64)
7 gae_duplicate tensor(-0.0066, dtype=torch.float64) tensor(-6.8421, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3707, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
6 gae_duplicate tensor(0.0261, dtype=torch.float64) tensor(-4.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8004, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
5 gae_duplicate tensor(0.1645, dtype=torch.float64) tensor(-6.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6978, dtype=torch.float64) delta_t tensor(-0.7491, dtype=torch.float64)
4 gae_duplicate tensor(-0.9930, dtype=torch.float64) tensor(13.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7070, dtype=torch.float64) delta_t tensor(-0.4020, dtype=torch.float64)
3 gae_duplicate tensor(-0.6953, dtype=torch.float64) tensor(9.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4972, dtype=torch.float64) delta_t tensor(-0.4665, dtype=torch.float64)
2 gae_duplicate tensor(-0.7782, dtype=torch.float64) tensor(10.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:892.3633422851562
value loss:16.77836036682129
entropies:355.2374572753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.644104957580566 seconds
19 rew tensor(0.8840, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
19 gae_duplicate tensor(0.0056, dtype=torch.float64) tensor(-1.3993, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
18 gae_duplicate tensor(0.0010, dtype=torch.float64) tensor(-2.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.1712, dtype=torch.float64)
17 gae_duplicate tensor(0.1683, dtype=torch.float64) tensor(-3.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
16 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-2.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.1458, dtype=torch.float64)
15 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-3.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
14 gae_duplicate tensor(0.0785, dtype=torch.float64) tensor(-3.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8974, dtype=torch.float64) delta_t tensor(0.2070, dtype=torch.float64)
13 gae_duplicate tensor(0.1046, dtype=torch.float64) tensor(-4.4114, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8717, dtype=torch.float64) delta_t tensor(0.2232, dtype=torch.float64)
12 gae_duplicate tensor(0.1303, dtype=torch.float64) tensor(-4.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8646, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
11 gae_duplicate tensor(-0.1914, dtype=torch.float64) tensor(0.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6090, dtype=torch.float64) delta_t tensor(0.1790, dtype=torch.float64)
10 gae_duplicate tensor(-0.0681, dtype=torch.float64) tensor(-3.5712, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2055, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
9 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-1.5429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0397, dtype=torch.float64) delta_t tensor(0.3528, dtype=torch.float64)
8 gae_duplicate tensor(0.1789, dtype=torch.float64) tensor(-7.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1622, dtype=torch.float64) delta_t tensor(0.2212, dtype=torch.float64)
7 gae_duplicate tensor(-0.3484, dtype=torch.float64) tensor(-5.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4653, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
6 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(-2.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8225, dtype=torch.float64) delta_t tensor(0.3887, dtype=torch.float64)
5 gae_duplicate tensor(0.2004, dtype=torch.float64) tensor(-7.7631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6291, dtype=torch.float64) delta_t tensor(-0.6193, dtype=torch.float64)
4 gae_duplicate tensor(-0.9521, dtype=torch.float64) tensor(11.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7867, dtype=torch.float64) delta_t tensor(-0.4502, dtype=torch.float64)
3 gae_duplicate tensor(-0.6301, dtype=torch.float64) tensor(9.9313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5772, dtype=torch.float64) delta_t tensor(-0.4908, dtype=torch.float64)
2 gae_duplicate tensor(-0.9930, dtype=torch.float64) tensor(10.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1145.327880859375
value loss:18.211793899536133
entropies:355.2618713378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.848890781402588 seconds
19 rew tensor(0.8838, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
19 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-0.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
18 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-2.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
17 gae_duplicate tensor(0.1412, dtype=torch.float64) tensor(-3.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
16 gae_duplicate tensor(-0.0409, dtype=torch.float64) tensor(-2.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
15 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-1.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
14 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-2.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
13 gae_duplicate tensor(-0.2071, dtype=torch.float64) tensor(-1.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8986, dtype=torch.float64) delta_t tensor(0.2596, dtype=torch.float64)
12 gae_duplicate tensor(0.0857, dtype=torch.float64) tensor(-5.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9008, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
11 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-2.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.3220, dtype=torch.float64)
10 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(-6.7470, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2590, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
9 gae_duplicate tensor(0.0711, dtype=torch.float64) tensor(-4.2629, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0570, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
8 gae_duplicate tensor(0.0718, dtype=torch.float64) tensor(-8.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(0.3067, dtype=torch.float64)
7 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-6.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3846, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
6 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-6.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8063, dtype=torch.float64) delta_t tensor(0.4472, dtype=torch.float64)
5 gae_duplicate tensor(0.2704, dtype=torch.float64) tensor(-9.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7427, dtype=torch.float64) delta_t tensor(-0.6710, dtype=torch.float64)
4 gae_duplicate tensor(-1.1407, dtype=torch.float64) tensor(12.2520, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7346, dtype=torch.float64) delta_t tensor(-0.3322, dtype=torch.float64)
3 gae_duplicate tensor(-0.5360, dtype=torch.float64) tensor(7.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5234, dtype=torch.float64) delta_t tensor(-0.3873, dtype=torch.float64)
2 gae_duplicate tensor(-1.0277, dtype=torch.float64) tensor(8.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1797.6971435546875
value loss:20.30154800415039
entropies:355.3118896484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9615159034729 seconds
19 rew tensor(0.8835, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
19 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-0.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
18 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-2.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.1276, dtype=torch.float64)
17 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-2.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
16 gae_duplicate tensor(0.1270, dtype=torch.float64) tensor(-3.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.1500, dtype=torch.float64)
15 gae_duplicate tensor(0.1209, dtype=torch.float64) tensor(-3.2603, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
14 gae_duplicate tensor(0.1303, dtype=torch.float64) tensor(-3.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
13 gae_duplicate tensor(-0.3008, dtype=torch.float64) tensor(-2.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8976, dtype=torch.float64) delta_t tensor(0.2289, dtype=torch.float64)
12 gae_duplicate tensor(0.1814, dtype=torch.float64) tensor(-4.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8811, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
11 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(-0.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.2598, dtype=torch.float64)
10 gae_duplicate tensor(0.0590, dtype=torch.float64) tensor(-5.1507, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2398, dtype=torch.float64) delta_t tensor(0.1805, dtype=torch.float64)
9 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-4.1343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0739, dtype=torch.float64) delta_t tensor(0.2947, dtype=torch.float64)
8 gae_duplicate tensor(0.1364, dtype=torch.float64) tensor(-6.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1466, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
7 gae_duplicate tensor(-0.5527, dtype=torch.float64) tensor(-5.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3854, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
6 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(-6.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8070, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
5 gae_duplicate tensor(0.3672, dtype=torch.float64) tensor(-9.9694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7784, dtype=torch.float64) delta_t tensor(-0.6239, dtype=torch.float64)
4 gae_duplicate tensor(-0.7697, dtype=torch.float64) tensor(11.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8260, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
3 gae_duplicate tensor(-0.5031, dtype=torch.float64) tensor(5.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6155, dtype=torch.float64) delta_t tensor(-0.2948, dtype=torch.float64)
2 gae_duplicate tensor(-0.6268, dtype=torch.float64) tensor(6.5503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1866.0257568359375
value loss:16.729148864746094
entropies:355.36260986328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.6067)
ToM Target loss= tensor(3819.7437)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.839250802993774 seconds
19 rew tensor(0.8839, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
19 gae_duplicate tensor(0.0086, dtype=torch.float64) tensor(-0.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(0.0980, dtype=torch.float64)
18 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-1.9922, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
17 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-2.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
16 gae_duplicate tensor(0.0855, dtype=torch.float64) tensor(-2.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
15 gae_duplicate tensor(0.0866, dtype=torch.float64) tensor(-2.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
14 gae_duplicate tensor(0.0884, dtype=torch.float64) tensor(-2.6247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(0.1807, dtype=torch.float64)
13 gae_duplicate tensor(0.1485, dtype=torch.float64) tensor(-3.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.1893, dtype=torch.float64)
12 gae_duplicate tensor(0.1606, dtype=torch.float64) tensor(-4.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8993, dtype=torch.float64) delta_t tensor(0.1428, dtype=torch.float64)
11 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-3.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6248, dtype=torch.float64) delta_t tensor(0.3211, dtype=torch.float64)
10 gae_duplicate tensor(0.1618, dtype=torch.float64) tensor(-6.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1659, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
9 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-1.2063, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0195, dtype=torch.float64) delta_t tensor(0.3040, dtype=torch.float64)
8 gae_duplicate tensor(0.0677, dtype=torch.float64) tensor(-6.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1828, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
7 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-3.9808, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5024, dtype=torch.float64) delta_t tensor(0.1765, dtype=torch.float64)
6 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(-3.7393, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8441, dtype=torch.float64) delta_t tensor(0.3602, dtype=torch.float64)
5 gae_duplicate tensor(0.2434, dtype=torch.float64) tensor(-7.5618, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6901, dtype=torch.float64) delta_t tensor(-0.4589, dtype=torch.float64)
4 gae_duplicate tensor(-0.6161, dtype=torch.float64) tensor(8.1405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8620, dtype=torch.float64) delta_t tensor(-0.1688, dtype=torch.float64)
3 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(4.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6514, dtype=torch.float64) delta_t tensor(-0.2696, dtype=torch.float64)
2 gae_duplicate tensor(-0.5015, dtype=torch.float64) tensor(5.7633, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1748.1337890625
value loss:10.928078651428223
entropies:355.38201904296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.803195953369141 seconds
19 rew tensor(0.8841, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
19 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(0.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
18 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-1.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
17 gae_duplicate tensor(0.0713, dtype=torch.float64) tensor(-1.7296, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
16 gae_duplicate tensor(0.0589, dtype=torch.float64) tensor(-1.6992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
15 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-1.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
14 gae_duplicate tensor(-0.0229, dtype=torch.float64) tensor(-1.3126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8950, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
13 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-2.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8969, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
12 gae_duplicate tensor(0.1173, dtype=torch.float64) tensor(-3.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8987, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
11 gae_duplicate tensor(0.0349, dtype=torch.float64) tensor(-2.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6241, dtype=torch.float64) delta_t tensor(0.2597, dtype=torch.float64)
10 gae_duplicate tensor(0.1465, dtype=torch.float64) tensor(-5.3928, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
9 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-1.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0175, dtype=torch.float64) delta_t tensor(0.1528, dtype=torch.float64)
8 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(-3.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1113, dtype=torch.float64) delta_t tensor(0.3116, dtype=torch.float64)
7 gae_duplicate tensor(0.0363, dtype=torch.float64) tensor(-6.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4426, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
6 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-5.2704, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8092, dtype=torch.float64) delta_t tensor(0.4679, dtype=torch.float64)
5 gae_duplicate tensor(0.3654, dtype=torch.float64) tensor(-9.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6914, dtype=torch.float64) delta_t tensor(-0.4142, dtype=torch.float64)
4 gae_duplicate tensor(-0.5451, dtype=torch.float64) tensor(7.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7908, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
3 gae_duplicate tensor(-0.4640, dtype=torch.float64) tensor(2.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5791, dtype=torch.float64) delta_t tensor(-0.1635, dtype=torch.float64)
2 gae_duplicate tensor(-0.6346, dtype=torch.float64) tensor(3.3271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1778.0927734375
value loss:10.481680870056152
entropies:355.38873291015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.899143934249878 seconds
19 rew tensor(0.8851, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
19 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(0.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
18 gae_duplicate tensor(0.0179, dtype=torch.float64) tensor(-0.9102, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
17 gae_duplicate tensor(0.0325, dtype=torch.float64) tensor(-1.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8811, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
16 gae_duplicate tensor(0.0209, dtype=torch.float64) tensor(-1.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8828, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
15 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
14 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-1.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
13 gae_duplicate tensor(0.0859, dtype=torch.float64) tensor(-2.5245, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8789, dtype=torch.float64) delta_t tensor(0.1794, dtype=torch.float64)
12 gae_duplicate tensor(0.1466, dtype=torch.float64) tensor(-3.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8531, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
11 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-4.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5690, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
10 gae_duplicate tensor(0.0371, dtype=torch.float64) tensor(-3.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1281, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
9 gae_duplicate tensor(-0.2321, dtype=torch.float64) tensor(-1.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0925, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
8 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-1.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2584, dtype=torch.float64) delta_t tensor(0.2477, dtype=torch.float64)
7 gae_duplicate tensor(-0.2948, dtype=torch.float64) tensor(-5.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5162, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
6 gae_duplicate tensor(-0.6391, dtype=torch.float64) tensor(-0.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8654, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
5 gae_duplicate tensor(-0.3688, dtype=torch.float64) tensor(-4.9447, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4907, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
4 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(0.6365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8257, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
3 gae_duplicate tensor(-0.8313, dtype=torch.float64) tensor(1.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6879, dtype=torch.float64) delta_t tensor(-0.2114, dtype=torch.float64)
2 gae_duplicate tensor(-1.3548, dtype=torch.float64) tensor(4.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1355.98876953125
value loss:10.604527473449707
entropies:355.36968994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.256415128707886 seconds
19 rew tensor(0.8848, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
19 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(1.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
18 gae_duplicate tensor(-0.0097, dtype=torch.float64) tensor(-0.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-0.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
16 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-1.2035, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
15 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-1.3993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
14 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-1.5487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
13 gae_duplicate tensor(0.1016, dtype=torch.float64) tensor(-2.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
12 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-2.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8982, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
11 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(0.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6232, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
10 gae_duplicate tensor(-0.0574, dtype=torch.float64) tensor(-0.7681, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2555, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
9 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-2.3905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0897, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
8 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-5.1972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0942, dtype=torch.float64) delta_t tensor(0.2828, dtype=torch.float64)
7 gae_duplicate tensor(0.0876, dtype=torch.float64) tensor(-6.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3704, dtype=torch.float64) delta_t tensor(0.3423, dtype=torch.float64)
6 gae_duplicate tensor(0.1498, dtype=torch.float64) tensor(-7.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8113, dtype=torch.float64) delta_t tensor(0.4804, dtype=torch.float64)
5 gae_duplicate tensor(0.4746, dtype=torch.float64) tensor(-10.3026, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8040, dtype=torch.float64) delta_t tensor(-0.4209, dtype=torch.float64)
4 gae_duplicate tensor(-0.6355, dtype=torch.float64) tensor(7.1315, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7202, dtype=torch.float64) delta_t tensor(0.2037, dtype=torch.float64)
3 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-3.3103, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5064, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
2 gae_duplicate tensor(-0.5719, dtype=torch.float64) tensor(0.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1838.2958984375
value loss:9.689909934997559
entropies:355.3368225097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.112457990646362 seconds
19 rew tensor(0.8844, dtype=torch.float64) delta_t tensor(-0.1326, dtype=torch.float64)
19 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(2.6391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
18 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(0.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
17 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(0.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
16 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-0.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
15 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-0.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
14 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-0.5215, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8940, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
13 gae_duplicate tensor(0.0239, dtype=torch.float64) tensor(-1.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
12 gae_duplicate tensor(0.0734, dtype=torch.float64) tensor(-2.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8972, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
11 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-0.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6224, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
10 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.5664, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2358, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
9 gae_duplicate tensor(0.0244, dtype=torch.float64) tensor(-2.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0518, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
8 gae_duplicate tensor(0.0712, dtype=torch.float64) tensor(-5.9397, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1317, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
7 gae_duplicate tensor(0.0228, dtype=torch.float64) tensor(-5.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3337, dtype=torch.float64) delta_t tensor(0.3160, dtype=torch.float64)
6 gae_duplicate tensor(0.0696, dtype=torch.float64) tensor(-6.8376, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8111, dtype=torch.float64) delta_t tensor(0.4657, dtype=torch.float64)
5 gae_duplicate tensor(0.3732, dtype=torch.float64) tensor(-9.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8388, dtype=torch.float64) delta_t tensor(-0.4075, dtype=torch.float64)
4 gae_duplicate tensor(-0.6383, dtype=torch.float64) tensor(6.8694, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8488, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
3 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(-2.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6361, dtype=torch.float64) delta_t tensor(0.0911, dtype=torch.float64)
2 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-1.9601, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1416.887939453125
value loss:8.457897186279297
entropies:355.3186340332031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.5984)
ToM Target loss= tensor(3831.9465)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9082911014556885 seconds
19 rew tensor(0.8853, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
19 gae_duplicate tensor(-0.2311, dtype=torch.float64) tensor(3.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
18 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(1.1309, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
17 gae_duplicate tensor(-0.0568, dtype=torch.float64) tensor(0.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8806, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
16 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(0.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(-0.0093, dtype=torch.float64)
15 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(0.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
14 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-0.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
13 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-1.6323, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8775, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
12 gae_duplicate tensor(0.0018, dtype=torch.float64) tensor(-1.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
11 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-0.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5664, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
10 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(-0.9063, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(0.1441, dtype=torch.float64)
9 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(-2.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0144, dtype=torch.float64) delta_t tensor(0.3315, dtype=torch.float64)
8 gae_duplicate tensor(0.2834, dtype=torch.float64) tensor(-6.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2430, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
7 gae_duplicate tensor(-0.4408, dtype=torch.float64) tensor(0.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5009, dtype=torch.float64) delta_t tensor(0.1267, dtype=torch.float64)
6 gae_duplicate tensor(-0.3584, dtype=torch.float64) tensor(-2.5561, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8135, dtype=torch.float64) delta_t tensor(0.3880, dtype=torch.float64)
5 gae_duplicate tensor(0.0562, dtype=torch.float64) tensor(-7.8509, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.4925, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
4 gae_duplicate tensor(-0.4473, dtype=torch.float64) tensor(-0.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8122, dtype=torch.float64) delta_t tensor(0.1728, dtype=torch.float64)
3 gae_duplicate tensor(-0.3050, dtype=torch.float64) tensor(-3.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6175, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
2 gae_duplicate tensor(-0.8014, dtype=torch.float64) tensor(-0.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1156.31640625
value loss:10.0826997756958
entropies:355.2806091308594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8826141357421875 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.1792, dtype=torch.float64)
19 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(3.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
18 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(1.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
17 gae_duplicate tensor(-0.0954, dtype=torch.float64) tensor(1.5542, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
16 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(1.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(-0.0572, dtype=torch.float64)
15 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(1.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
14 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(1.0056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
13 gae_duplicate tensor(-0.0456, dtype=torch.float64) tensor(-0.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8959, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
12 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-0.7840, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8975, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
11 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(1.8602, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6221, dtype=torch.float64) delta_t tensor(0.0788, dtype=torch.float64)
10 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(-1.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1800, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
9 gae_duplicate tensor(-0.0251, dtype=torch.float64) tensor(-1.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0142, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
8 gae_duplicate tensor(-0.2493, dtype=torch.float64) tensor(-1.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2067, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
7 gae_duplicate tensor(-0.3198, dtype=torch.float64) tensor(-0.2054, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4092, dtype=torch.float64) delta_t tensor(0.1584, dtype=torch.float64)
6 gae_duplicate tensor(-0.2919, dtype=torch.float64) tensor(-3.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8142, dtype=torch.float64) delta_t tensor(0.3780, dtype=torch.float64)
5 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-7.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6415, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
4 gae_duplicate tensor(-0.3291, dtype=torch.float64) tensor(1.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8133, dtype=torch.float64) delta_t tensor(0.2672, dtype=torch.float64)
3 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-5.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5996, dtype=torch.float64) delta_t tensor(0.1786, dtype=torch.float64)
2 gae_duplicate tensor(-0.1900, dtype=torch.float64) tensor(-3.9232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:524.1190795898438
value loss:7.528231620788574
entropies:355.2467041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.863579034805298 seconds
19 rew tensor(0.8850, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
19 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(3.9374, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
18 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(2.1558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
17 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(1.8966, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(0.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
15 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
14 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(0.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
13 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-0.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
12 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-0.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8965, dtype=torch.float64) delta_t tensor(-0.1167, dtype=torch.float64)
11 gae_duplicate tensor(-0.1882, dtype=torch.float64) tensor(2.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6209, dtype=torch.float64) delta_t tensor(-0.0792, dtype=torch.float64)
10 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(1.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2898, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
9 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-2.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.1235, dtype=torch.float64) delta_t tensor(0.3365, dtype=torch.float64)
8 gae_duplicate tensor(0.2459, dtype=torch.float64) tensor(-6.9435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0976, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
7 gae_duplicate tensor(-0.3179, dtype=torch.float64) tensor(-1.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3281, dtype=torch.float64) delta_t tensor(0.2639, dtype=torch.float64)
6 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-5.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8159, dtype=torch.float64) delta_t tensor(0.5917, dtype=torch.float64)
5 gae_duplicate tensor(0.5431, dtype=torch.float64) tensor(-11.9302, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8468, dtype=torch.float64) delta_t tensor(-0.3412, dtype=torch.float64)
4 gae_duplicate tensor(-0.4216, dtype=torch.float64) tensor(5.4803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6878, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
3 gae_duplicate tensor(0.1659, dtype=torch.float64) tensor(-7.2306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4723, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
2 gae_duplicate tensor(0.1191, dtype=torch.float64) tensor(-6.4432, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1163.81396484375
value loss:10.49403190612793
entropies:355.1833801269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.279455900192261 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
19 gae_duplicate tensor(-0.2115, dtype=torch.float64) tensor(4.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
18 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(2.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
17 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(1.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
16 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(1.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
15 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(1.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
14 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(1.3641, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
13 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(0.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
12 gae_duplicate tensor(-0.0473, dtype=torch.float64) tensor(-0.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8594, dtype=torch.float64) delta_t tensor(-0.0768, dtype=torch.float64)
11 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(1.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6021, dtype=torch.float64) delta_t tensor(-0.0184, dtype=torch.float64)
10 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(0.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
9 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-2.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0068, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
8 gae_duplicate tensor(-0.2292, dtype=torch.float64) tensor(-2.7481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2841, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
7 gae_duplicate tensor(-0.5010, dtype=torch.float64) tensor(2.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5151, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
6 gae_duplicate tensor(-0.5866, dtype=torch.float64) tensor(1.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8552, dtype=torch.float64) delta_t tensor(0.3368, dtype=torch.float64)
5 gae_duplicate tensor(-0.0205, dtype=torch.float64) tensor(-6.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5178, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
4 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(-2.1753, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8012, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
3 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-5.6682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6056, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
2 gae_duplicate tensor(-0.8433, dtype=torch.float64) tensor(-2.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:85.7664794921875
value loss:10.14159107208252
entropies:355.100830078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.737344980239868 seconds
19 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(-0.2109, dtype=torch.float64)
19 gae_duplicate tensor(-0.2285, dtype=torch.float64) tensor(4.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(-0.1087, dtype=torch.float64)
18 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(2.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
17 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(2.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
16 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(2.1786, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
15 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(1.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(-0.0681, dtype=torch.float64)
14 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(1.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
13 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(0.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8947, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
12 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-0.4217, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
11 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(0.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6202, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
10 gae_duplicate tensor(-0.2003, dtype=torch.float64) tensor(0.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1960, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
9 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-0.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0118, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
8 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(-2.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1176, dtype=torch.float64) delta_t tensor(-0.2510, dtype=torch.float64)
7 gae_duplicate tensor(-0.4376, dtype=torch.float64) tensor(4.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3846, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
6 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-2.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8178, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
5 gae_duplicate tensor(0.4391, dtype=torch.float64) tensor(-10.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7564, dtype=torch.float64) delta_t tensor(-0.2349, dtype=torch.float64)
4 gae_duplicate tensor(-0.3655, dtype=torch.float64) tensor(3.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8182, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
3 gae_duplicate tensor(0.0887, dtype=torch.float64) tensor(-5.6541, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6034, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
2 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-4.9719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3.112950325012207
value loss:8.354239463806152
entropies:355.0698547363281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3965.5784)
ToM Target loss= tensor(3831.9341)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.2287209033966064 seconds
19 rew tensor(0.8851, dtype=torch.float64) delta_t tensor(-0.2177, dtype=torch.float64)
19 gae_duplicate tensor(-0.2324, dtype=torch.float64) tensor(4.1958, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8863, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
18 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(2.8617, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(-0.0953, dtype=torch.float64)
17 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(2.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
16 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(0.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0689, dtype=torch.float64)
15 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(1.4552, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
14 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(2.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
13 gae_duplicate tensor(-0.4177, dtype=torch.float64) tensor(2.9704, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
12 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(0.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8954, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
11 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-0.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6197, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
10 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(0.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2322, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
9 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(-1.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0297, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
8 gae_duplicate tensor(-0.3329, dtype=torch.float64) tensor(-3.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
7 gae_duplicate tensor(-0.4333, dtype=torch.float64) tensor(3.0084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3939, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
6 gae_duplicate tensor(-0.2459, dtype=torch.float64) tensor(-2.2314, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8174, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
5 gae_duplicate tensor(0.4405, dtype=torch.float64) tensor(-10.9825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8485, dtype=torch.float64) delta_t tensor(-0.3479, dtype=torch.float64)
4 gae_duplicate tensor(-0.4689, dtype=torch.float64) tensor(6.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8564, dtype=torch.float64) delta_t tensor(0.2652, dtype=torch.float64)
3 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-4.7298, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6417, dtype=torch.float64) delta_t tensor(0.1914, dtype=torch.float64)
2 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-4.1815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-72.90478515625
value loss:9.095185279846191
entropies:355.0192565917969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.988034725189209 seconds
19 rew tensor(0.8853, dtype=torch.float64) delta_t tensor(-0.2046, dtype=torch.float64)
19 gae_duplicate tensor(-0.2243, dtype=torch.float64) tensor(3.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
18 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(2.3074, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
17 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(2.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(-0.0813, dtype=torch.float64)
16 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(1.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
15 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(1.8552, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(-0.0775, dtype=torch.float64)
14 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(1.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
13 gae_duplicate tensor(-0.0912, dtype=torch.float64) tensor(0.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8940, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
12 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(0.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
11 gae_duplicate tensor(-0.1605, dtype=torch.float64) tensor(1.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6197, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
10 gae_duplicate tensor(-0.1575, dtype=torch.float64) tensor(-0.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1961, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
9 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-1.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0249, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
8 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(-0.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3016, dtype=torch.float64) delta_t tensor(-0.2646, dtype=torch.float64)
7 gae_duplicate tensor(-0.4880, dtype=torch.float64) tensor(4.9737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(-0.2603, dtype=torch.float64)
6 gae_duplicate tensor(-0.6149, dtype=torch.float64) tensor(5.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8174, dtype=torch.float64) delta_t tensor(0.2791, dtype=torch.float64)
5 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(-4.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6104, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
4 gae_duplicate tensor(-0.4277, dtype=torch.float64) tensor(1.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9098, dtype=torch.float64) delta_t tensor(0.1701, dtype=torch.float64)
3 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-3.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6959, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
2 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-2.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-930.30859375
value loss:7.724987983703613
entropies:355.03668212890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.982132911682129 seconds
19 rew tensor(0.8856, dtype=torch.float64) delta_t tensor(-0.2009, dtype=torch.float64)
19 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(3.9230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
18 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(2.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
17 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(1.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-0.0136, dtype=torch.float64)
16 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(0.4777, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
15 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(0.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
14 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(1.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
13 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(1.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
12 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(0.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
11 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.1394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6195, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
10 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-0.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2326, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
9 gae_duplicate tensor(0.0992, dtype=torch.float64) tensor(-3.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0115, dtype=torch.float64) delta_t tensor(0.1804, dtype=torch.float64)
8 gae_duplicate tensor(-0.0252, dtype=torch.float64) tensor(-3.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3201, dtype=torch.float64) delta_t tensor(-0.2911, dtype=torch.float64)
7 gae_duplicate tensor(-0.5508, dtype=torch.float64) tensor(5.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5046, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
6 gae_duplicate tensor(-0.6284, dtype=torch.float64) tensor(2.8594, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8183, dtype=torch.float64) delta_t tensor(0.3167, dtype=torch.float64)
5 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-5.7977, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5557, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
4 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7989, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
3 gae_duplicate tensor(-0.0124, dtype=torch.float64) tensor(-4.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5836, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
2 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-3.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-56.838951110839844
value loss:8.201955795288086
entropies:355.0258483886719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.908652067184448 seconds
19 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(-0.1726, dtype=torch.float64)
19 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(3.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
18 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(1.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
17 gae_duplicate tensor(-0.0964, dtype=torch.float64) tensor(1.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
16 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(1.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(-0.0553, dtype=torch.float64)
15 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(1.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
14 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(0.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.0009, dtype=torch.float64)
13 gae_duplicate tensor(-0.0332, dtype=torch.float64) tensor(0.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8940, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
12 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(-0.2371, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8767, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
11 gae_duplicate tensor(-0.2147, dtype=torch.float64) tensor(0.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6193, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
10 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-0.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2145, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
9 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(-0.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0301, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
8 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(-3.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2274, dtype=torch.float64) delta_t tensor(-0.3598, dtype=torch.float64)
7 gae_duplicate tensor(-0.7099, dtype=torch.float64) tensor(6.7696, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4767, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
6 gae_duplicate tensor(-0.5452, dtype=torch.float64) tensor(2.2244, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8368, dtype=torch.float64) delta_t tensor(0.3383, dtype=torch.float64)
5 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-6.3013, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6850, dtype=torch.float64) delta_t tensor(-0.1692, dtype=torch.float64)
4 gae_duplicate tensor(-0.4064, dtype=torch.float64) tensor(2.6136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8351, dtype=torch.float64) delta_t tensor(0.2023, dtype=torch.float64)
3 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-3.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6197, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
2 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-2.5756, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-418.4972839355469
value loss:6.94594669342041
entropies:354.98187255859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.895130157470703 seconds
19 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
19 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(2.9198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
18 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(1.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
17 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(1.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
16 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(1.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
15 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(0.9395, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
14 gae_duplicate tensor(-0.0998, dtype=torch.float64) tensor(0.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
13 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-0.1362, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
12 gae_duplicate tensor(-0.0124, dtype=torch.float64) tensor(-0.3616, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
11 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-1.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6190, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
10 gae_duplicate tensor(-0.0500, dtype=torch.float64) tensor(-0.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1953, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
9 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(0.4276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0664, dtype=torch.float64) delta_t tensor(0.2047, dtype=torch.float64)
8 gae_duplicate tensor(-0.0525, dtype=torch.float64) tensor(-3.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1546, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
7 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(2.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4488, dtype=torch.float64) delta_t tensor(-0.0368, dtype=torch.float64)
6 gae_duplicate tensor(-0.6005, dtype=torch.float64) tensor(0.9307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8356, dtype=torch.float64) delta_t tensor(0.3896, dtype=torch.float64)
5 gae_duplicate tensor(-0.1660, dtype=torch.float64) tensor(-7.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8650, dtype=torch.float64) delta_t tensor(-0.3768, dtype=torch.float64)
4 gae_duplicate tensor(-0.5811, dtype=torch.float64) tensor(6.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9087, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
3 gae_duplicate tensor(-0.2959, dtype=torch.float64) tensor(-1.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6939, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
2 gae_duplicate tensor(-0.7473, dtype=torch.float64) tensor(1.0722, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-381.11322021484375
value loss:6.661261081695557
entropies:354.97027587890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.6648)
ToM Target loss= tensor(3833.3101)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.418024063110352 seconds
19 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
19 gae_duplicate tensor(-0.1521, dtype=torch.float64) tensor(2.9041, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
18 gae_duplicate tensor(-0.0874, dtype=torch.float64) tensor(1.1180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
17 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(0.8255, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
16 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(0.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
15 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(0.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
14 gae_duplicate tensor(-0.0875, dtype=torch.float64) tensor(-0.1175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
13 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-0.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
12 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-1.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
11 gae_duplicate tensor(-0.0094, dtype=torch.float64) tensor(-2.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
10 gae_duplicate tensor(0.0217, dtype=torch.float64) tensor(-1.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2320, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
9 gae_duplicate tensor(-0.0613, dtype=torch.float64) tensor(-2.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0108, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
8 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(-3.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2473, dtype=torch.float64) delta_t tensor(-0.2161, dtype=torch.float64)
7 gae_duplicate tensor(-0.4250, dtype=torch.float64) tensor(3.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5328, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
6 gae_duplicate tensor(-0.6024, dtype=torch.float64) tensor(3.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8374, dtype=torch.float64) delta_t tensor(0.4031, dtype=torch.float64)
5 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-7.4619, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5935, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
4 gae_duplicate tensor(-0.2559, dtype=torch.float64) tensor(1.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7442, dtype=torch.float64) delta_t tensor(0.1892, dtype=torch.float64)
3 gae_duplicate tensor(-0.0067, dtype=torch.float64) tensor(-3.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5279, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
2 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(-0.9125, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:458.5867004394531
value loss:6.7722697257995605
entropies:354.95428466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.082135915756226 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
19 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(2.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
18 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(0.6995, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
17 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(0.5028, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
16 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(0.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
15 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(0.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
14 gae_duplicate tensor(-0.0724, dtype=torch.float64) tensor(-0.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
13 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-0.4082, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
12 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-2.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
11 gae_duplicate tensor(0.0690, dtype=torch.float64) tensor(-3.5127, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6184, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
10 gae_duplicate tensor(0.0417, dtype=torch.float64) tensor(-2.3839, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2126, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
9 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(-1.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0283, dtype=torch.float64) delta_t tensor(0.1544, dtype=torch.float64)
8 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-3.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1561, dtype=torch.float64) delta_t tensor(-0.1442, dtype=torch.float64)
7 gae_duplicate tensor(-0.3690, dtype=torch.float64) tensor(2.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4692, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
6 gae_duplicate tensor(-0.6403, dtype=torch.float64) tensor(1.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8373, dtype=torch.float64) delta_t tensor(0.3919, dtype=torch.float64)
5 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(-7.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7771, dtype=torch.float64) delta_t tensor(-0.3203, dtype=torch.float64)
4 gae_duplicate tensor(-0.6030, dtype=torch.float64) tensor(5.7151, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8392, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
3 gae_duplicate tensor(-0.3683, dtype=torch.float64) tensor(-1.6439, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6237, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
2 gae_duplicate tensor(-0.8083, dtype=torch.float64) tensor(1.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:286.2559509277344
value loss:7.942479610443115
entropies:354.9750671386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.860960006713867 seconds
19 rew tensor(0.8851, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
19 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(1.9088, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
18 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(0.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
17 gae_duplicate tensor(-0.0254, dtype=torch.float64) tensor(0.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
16 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-0.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
15 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(-0.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
14 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-0.1997, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
13 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-0.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
12 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-1.6110, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.1660, dtype=torch.float64)
11 gae_duplicate tensor(0.0921, dtype=torch.float64) tensor(-3.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6183, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
10 gae_duplicate tensor(0.0865, dtype=torch.float64) tensor(-2.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2328, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
9 gae_duplicate tensor(-0.1834, dtype=torch.float64) tensor(-0.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0121, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
8 gae_duplicate tensor(0.0485, dtype=torch.float64) tensor(-3.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2090, dtype=torch.float64) delta_t tensor(-0.1244, dtype=torch.float64)
7 gae_duplicate tensor(-0.4843, dtype=torch.float64) tensor(2.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5758, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
6 gae_duplicate tensor(-0.6682, dtype=torch.float64) tensor(5.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8527, dtype=torch.float64) delta_t tensor(0.3070, dtype=torch.float64)
5 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-5.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9196, dtype=torch.float64) delta_t tensor(-0.5000, dtype=torch.float64)
4 gae_duplicate tensor(-0.8880, dtype=torch.float64) tensor(9.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0349, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
3 gae_duplicate tensor(-0.3694, dtype=torch.float64) tensor(2.3035, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8208, dtype=torch.float64) delta_t tensor(-0.2794, dtype=torch.float64)
2 gae_duplicate tensor(-0.7463, dtype=torch.float64) tensor(5.8751, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-496.6333923339844
value loss:8.742255210876465
entropies:355.01727294921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2273218631744385 seconds
19 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
19 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(1.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
18 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(0.3124, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
17 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(0.0935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
16 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(0.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
15 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(0.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
14 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(0.5913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
13 gae_duplicate tensor(0.0102, dtype=torch.float64) tensor(-0.4096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8926, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
12 gae_duplicate tensor(0.0738, dtype=torch.float64) tensor(-2.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8936, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
11 gae_duplicate tensor(0.1717, dtype=torch.float64) tensor(-4.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6184, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
10 gae_duplicate tensor(0.1727, dtype=torch.float64) tensor(-4.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1219, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
9 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(0.0598, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0802, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
8 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(0.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1723, dtype=torch.float64) delta_t tensor(-0.2500, dtype=torch.float64)
7 gae_duplicate tensor(-0.3484, dtype=torch.float64) tensor(4.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4473, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
6 gae_duplicate tensor(-0.4549, dtype=torch.float64) tensor(3.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8157, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
5 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-5.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6249, dtype=torch.float64) delta_t tensor(-0.1625, dtype=torch.float64)
4 gae_duplicate tensor(-0.2787, dtype=torch.float64) tensor(2.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9044, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
3 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-0.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6892, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
2 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(0.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.94587516784668
value loss:3.7205677032470703
entropies:355.0192565917969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.115738153457642 seconds
19 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
19 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(1.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8863, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
18 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(0.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
17 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-0.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
16 gae_duplicate tensor(-0.0279, dtype=torch.float64) tensor(-0.8517, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
15 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-1.2122, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
14 gae_duplicate tensor(-0.0125, dtype=torch.float64) tensor(-1.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
13 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-1.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
12 gae_duplicate tensor(0.0554, dtype=torch.float64) tensor(-2.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(0.3029, dtype=torch.float64)
11 gae_duplicate tensor(0.2701, dtype=torch.float64) tensor(-6.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6179, dtype=torch.float64) delta_t tensor(0.2040, dtype=torch.float64)
10 gae_duplicate tensor(0.1719, dtype=torch.float64) tensor(-4.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1762, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
9 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-1.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0475, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
8 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-2.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0996, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
7 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(0.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3387, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
6 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-0.8085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8167, dtype=torch.float64) delta_t tensor(0.3408, dtype=torch.float64)
5 gae_duplicate tensor(0.0983, dtype=torch.float64) tensor(-6.8198, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6993, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
4 gae_duplicate tensor(-0.3890, dtype=torch.float64) tensor(4.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7223, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
3 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-2.2955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5058, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
2 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(-0.9802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1387.5093994140625
value loss:5.639472007751465
entropies:354.9857482910156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.9189)
ToM Target loss= tensor(3829.5203)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.954906940460205 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
19 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(1.6567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
18 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(0.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
17 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-0.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
16 gae_duplicate tensor(-0.0296, dtype=torch.float64) tensor(-0.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
15 gae_duplicate tensor(-0.0281, dtype=torch.float64) tensor(-0.5952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
14 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-0.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
13 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-0.8238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
12 gae_duplicate tensor(0.0733, dtype=torch.float64) tensor(-2.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8933, dtype=torch.float64) delta_t tensor(0.2306, dtype=torch.float64)
11 gae_duplicate tensor(0.1037, dtype=torch.float64) tensor(-4.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6178, dtype=torch.float64) delta_t tensor(0.2000, dtype=torch.float64)
10 gae_duplicate tensor(0.1068, dtype=torch.float64) tensor(-4.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1946, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
9 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(-1.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0078, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
8 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-2.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1735, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
7 gae_duplicate tensor(-0.4821, dtype=torch.float64) tensor(1.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4308, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
6 gae_duplicate tensor(-0.6663, dtype=torch.float64) tensor(1.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8359, dtype=torch.float64) delta_t tensor(0.3050, dtype=torch.float64)
5 gae_duplicate tensor(0.0359, dtype=torch.float64) tensor(-5.7975, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6821, dtype=torch.float64) delta_t tensor(-0.2383, dtype=torch.float64)
4 gae_duplicate tensor(-0.6449, dtype=torch.float64) tensor(3.9147, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8148, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
3 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(-0.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5985, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
2 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(1.5906, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:664.2291870117188
value loss:5.849790573120117
entropies:354.9394226074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.045070171356201 seconds
19 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(-0.0747, dtype=torch.float64)
19 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(1.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
18 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(0.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
17 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(-0.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
16 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-0.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
15 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-0.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
14 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-0.6842, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
13 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-1.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
12 gae_duplicate tensor(0.0433, dtype=torch.float64) tensor(-1.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.2157, dtype=torch.float64)
11 gae_duplicate tensor(0.1091, dtype=torch.float64) tensor(-4.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6175, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
10 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-4.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1943, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
9 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(-0.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0653, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
8 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-2.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1555, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
7 gae_duplicate tensor(-0.4205, dtype=torch.float64) tensor(1.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4129, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
6 gae_duplicate tensor(-0.3278, dtype=torch.float64) tensor(1.3189, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8180, dtype=torch.float64) delta_t tensor(0.3454, dtype=torch.float64)
5 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-6.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7557, dtype=torch.float64) delta_t tensor(-0.3162, dtype=torch.float64)
4 gae_duplicate tensor(-0.7814, dtype=torch.float64) tensor(5.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7968, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
3 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-1.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5803, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
2 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(0.7585, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:689.1425170898438
value loss:5.368025779724121
entropies:354.941162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.891862154006958 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
19 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(1.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
18 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(0.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
17 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-0.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
16 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
15 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(0.0422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
14 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-0.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
13 gae_duplicate tensor(0.0250, dtype=torch.float64) tensor(-1.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
12 gae_duplicate tensor(0.0304, dtype=torch.float64) tensor(-1.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.2275, dtype=torch.float64)
11 gae_duplicate tensor(0.1268, dtype=torch.float64) tensor(-4.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6174, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
10 gae_duplicate tensor(0.0144, dtype=torch.float64) tensor(-3.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1388, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
9 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(1.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0287, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
8 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-1.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1552, dtype=torch.float64) delta_t tensor(-0.1331, dtype=torch.float64)
7 gae_duplicate tensor(-0.3536, dtype=torch.float64) tensor(2.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4318, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
6 gae_duplicate tensor(-0.5310, dtype=torch.float64) tensor(2.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8184, dtype=torch.float64) delta_t tensor(0.3068, dtype=torch.float64)
5 gae_duplicate tensor(0.0293, dtype=torch.float64) tensor(-5.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7020, dtype=torch.float64) delta_t tensor(-0.2547, dtype=torch.float64)
4 gae_duplicate tensor(-0.6768, dtype=torch.float64) tensor(4.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8338, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
3 gae_duplicate tensor(-0.2104, dtype=torch.float64) tensor(-0.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6174, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
2 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(1.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:148.3451385498047
value loss:4.438597679138184
entropies:354.99810791015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.135096788406372 seconds
19 rew tensor(0.8855, dtype=torch.float64) delta_t tensor(-0.0871, dtype=torch.float64)
19 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(1.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
18 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(0.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
17 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-0.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8789, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
16 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-1.0080, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
15 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-0.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
14 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(-1.0389, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
13 gae_duplicate tensor(0.0122, dtype=torch.float64) tensor(-1.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8732, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
12 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-1.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(0.1883, dtype=torch.float64)
11 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-3.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5798, dtype=torch.float64) delta_t tensor(0.0933, dtype=torch.float64)
10 gae_duplicate tensor(-0.1911, dtype=torch.float64) tensor(-2.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2484, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
9 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(-1.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0460, dtype=torch.float64) delta_t tensor(0.1456, dtype=torch.float64)
8 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-3.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1563, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
7 gae_duplicate tensor(-0.3496, dtype=torch.float64) tensor(0.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4417, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
6 gae_duplicate tensor(-0.5564, dtype=torch.float64) tensor(1.8445, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8368, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
5 gae_duplicate tensor(-0.2239, dtype=torch.float64) tensor(-5.7037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7552, dtype=torch.float64) delta_t tensor(-0.3643, dtype=torch.float64)
4 gae_duplicate tensor(-0.7909, dtype=torch.float64) tensor(6.5240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8543, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
3 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(1.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6381, dtype=torch.float64) delta_t tensor(-0.2222, dtype=torch.float64)
2 gae_duplicate tensor(-0.7322, dtype=torch.float64) tensor(4.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:214.52195739746094
value loss:7.140376091003418
entropies:355.068603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.058758974075317 seconds
19 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
19 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(1.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
18 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(0.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
17 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(0.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
16 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(0.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
15 gae_duplicate tensor(-0.0459, dtype=torch.float64) tensor(-0.2360, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
14 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-0.4358, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.0410, dtype=torch.float64)
13 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-0.8481, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
12 gae_duplicate tensor(0.0565, dtype=torch.float64) tensor(-1.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(0.1739, dtype=torch.float64)
11 gae_duplicate tensor(0.1279, dtype=torch.float64) tensor(-3.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6170, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
10 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-3.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1936, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
9 gae_duplicate tensor(-0.0639, dtype=torch.float64) tensor(-1.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0093, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
8 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(-0.7903, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1565, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
7 gae_duplicate tensor(-0.3017, dtype=torch.float64) tensor(1.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3777, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
6 gae_duplicate tensor(-0.2739, dtype=torch.float64) tensor(1.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8198, dtype=torch.float64) delta_t tensor(0.2650, dtype=torch.float64)
5 gae_duplicate tensor(-0.0119, dtype=torch.float64) tensor(-5.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6125, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
4 gae_duplicate tensor(-0.3664, dtype=torch.float64) tensor(2.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7069, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
3 gae_duplicate tensor(0.0392, dtype=torch.float64) tensor(-2.5231, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4895, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
2 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-0.9981, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:570.6383056640625
value loss:3.148190975189209
entropies:355.09698486328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.0723)
ToM Target loss= tensor(3822.0183)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1865479946136475 seconds
19 rew tensor(0.8859, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
19 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(2.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
18 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(0.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(-0.0103, dtype=torch.float64)
17 gae_duplicate tensor(-0.0200, dtype=torch.float64) tensor(0.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
16 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(0.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
15 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(0.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
14 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(0.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
13 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-0.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
12 gae_duplicate tensor(-0.0027, dtype=torch.float64) tensor(-0.7681, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8745, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
11 gae_duplicate tensor(0.0103, dtype=torch.float64) tensor(-2.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6169, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
10 gae_duplicate tensor(-0.0570, dtype=torch.float64) tensor(-1.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1750, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
9 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(0.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0096, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
8 gae_duplicate tensor(-0.1018, dtype=torch.float64) tensor(-0.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2300, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
7 gae_duplicate tensor(-0.5317, dtype=torch.float64) tensor(3.9901, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4785, dtype=torch.float64) delta_t tensor(-0.2181, dtype=torch.float64)
6 gae_duplicate tensor(-0.6987, dtype=torch.float64) tensor(4.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8201, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
5 gae_duplicate tensor(-0.0631, dtype=torch.float64) tensor(-3.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6496, dtype=torch.float64) delta_t tensor(-0.2330, dtype=torch.float64)
4 gae_duplicate tensor(-0.4334, dtype=torch.float64) tensor(4.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8541, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
3 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(0.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6375, dtype=torch.float64) delta_t tensor(-0.0692, dtype=torch.float64)
2 gae_duplicate tensor(-0.2713, dtype=torch.float64) tensor(1.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-620.6460571289062
value loss:4.464134216308594
entropies:355.1253662109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777508974075317 seconds
19 rew tensor(0.8860, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
19 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(2.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
18 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(0.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
17 gae_duplicate tensor(-0.0322, dtype=torch.float64) tensor(0.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
16 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(0.3134, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
15 gae_duplicate tensor(-0.0602, dtype=torch.float64) tensor(0.1260, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
14 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-0.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
13 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(-0.5226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8645, dtype=torch.float64) delta_t tensor(0.0370, dtype=torch.float64)
12 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-0.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
11 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-2.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5984, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
10 gae_duplicate tensor(-0.1047, dtype=torch.float64) tensor(-0.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2116, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
9 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(1.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0272, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
8 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(-1.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1384, dtype=torch.float64) delta_t tensor(-0.0864, dtype=torch.float64)
7 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(1.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4794, dtype=torch.float64) delta_t tensor(-0.1689, dtype=torch.float64)
6 gae_duplicate tensor(-0.4638, dtype=torch.float64) tensor(3.5280, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8204, dtype=torch.float64) delta_t tensor(0.2877, dtype=torch.float64)
5 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-5.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6872, dtype=torch.float64) delta_t tensor(-0.2868, dtype=torch.float64)
4 gae_duplicate tensor(-0.6402, dtype=torch.float64) tensor(5.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8185, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
3 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(-0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6015, dtype=torch.float64) delta_t tensor(-0.1807, dtype=torch.float64)
2 gae_duplicate tensor(-0.4805, dtype=torch.float64) tensor(3.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-488.4757080078125
value loss:4.817389488220215
entropies:355.1466979980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.851938009262085 seconds
19 rew tensor(0.8860, dtype=torch.float64) delta_t tensor(-0.1183, dtype=torch.float64)
19 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(2.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
18 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(0.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
17 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(0.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
16 gae_duplicate tensor(-0.0677, dtype=torch.float64) tensor(0.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
15 gae_duplicate tensor(-0.0751, dtype=torch.float64) tensor(0.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
14 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(0.5383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
13 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(0.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
12 gae_duplicate tensor(0.0023, dtype=torch.float64) tensor(-0.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8926, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
11 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-1.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6166, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
10 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-0.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1929, dtype=torch.float64) delta_t tensor(-0.0792, dtype=torch.float64)
9 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(1.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0271, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
8 gae_duplicate tensor(-0.2465, dtype=torch.float64) tensor(-0.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1573, dtype=torch.float64) delta_t tensor(-0.1207, dtype=torch.float64)
7 gae_duplicate tensor(-0.2986, dtype=torch.float64) tensor(2.3055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4704, dtype=torch.float64) delta_t tensor(-0.1691, dtype=torch.float64)
6 gae_duplicate tensor(-0.6214, dtype=torch.float64) tensor(3.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8210, dtype=torch.float64) delta_t tensor(0.2828, dtype=torch.float64)
5 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-5.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7062, dtype=torch.float64) delta_t tensor(-0.2735, dtype=torch.float64)
4 gae_duplicate tensor(-0.5407, dtype=torch.float64) tensor(5.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7828, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
3 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(-0.7180, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5655, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
2 gae_duplicate tensor(-0.3608, dtype=torch.float64) tensor(1.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-711.3924560546875
value loss:4.058531761169434
entropies:355.2273254394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.922323226928711 seconds
19 rew tensor(0.8858, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
19 gae_duplicate tensor(-0.1296, dtype=torch.float64) tensor(2.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8866, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
18 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(0.8069, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
17 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(0.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
16 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(0.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
15 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(0.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
14 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(0.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
13 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(0.9632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
12 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-0.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
11 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-1.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6162, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
10 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2482, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
9 gae_duplicate tensor(-0.2379, dtype=torch.float64) tensor(0.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0637, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
8 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-1.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1209, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
7 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4063, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
6 gae_duplicate tensor(-0.5137, dtype=torch.float64) tensor(1.5903, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8214, dtype=torch.float64) delta_t tensor(0.3523, dtype=torch.float64)
5 gae_duplicate tensor(0.2828, dtype=torch.float64) tensor(-6.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8169, dtype=torch.float64) delta_t tensor(-0.3955, dtype=torch.float64)
4 gae_duplicate tensor(-0.7193, dtype=torch.float64) tensor(7.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7646, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
3 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(-1.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5470, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
2 gae_duplicate tensor(-0.3489, dtype=torch.float64) tensor(1.2764, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-321.81793212890625
value loss:4.411543846130371
entropies:355.27923583984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.248802900314331 seconds
19 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(-0.1478, dtype=torch.float64)
19 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(2.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
18 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(1.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
17 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(1.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
16 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(1.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
15 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(1.3734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(-0.0528, dtype=torch.float64)
14 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(1.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
13 gae_duplicate tensor(-0.0499, dtype=torch.float64) tensor(0.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
12 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(0.2710, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
11 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-0.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6164, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
10 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(0.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1180, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
9 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(1.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0293, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
8 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(0.0607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3246, dtype=torch.float64) delta_t tensor(-0.2720, dtype=torch.float64)
7 gae_duplicate tensor(-0.5785, dtype=torch.float64) tensor(5.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5274, dtype=torch.float64) delta_t tensor(-0.2788, dtype=torch.float64)
6 gae_duplicate tensor(-0.6271, dtype=torch.float64) tensor(6.0021, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8419, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
5 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-1.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.3776, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
4 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(-1.5405, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7478, dtype=torch.float64) delta_t tensor(0.1021, dtype=torch.float64)
3 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(-2.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5299, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
2 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-0.0639, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1042.8707275390625
value loss:4.03265380859375
entropies:355.3433532714844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.6929)
ToM Target loss= tensor(3829.1379)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.051380157470703 seconds
19 rew tensor(0.8863, dtype=torch.float64) delta_t tensor(-0.1167, dtype=torch.float64)
19 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(2.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
18 gae_duplicate tensor(-0.0631, dtype=torch.float64) tensor(0.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(-0.0355, dtype=torch.float64)
17 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(0.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
16 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(0.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
15 gae_duplicate tensor(-0.0781, dtype=torch.float64) tensor(0.6437, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
14 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(0.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
13 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(0.2501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
12 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-0.3741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
11 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-1.1379, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6160, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
10 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(0.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2094, dtype=torch.float64) delta_t tensor(-0.0721, dtype=torch.float64)
9 gae_duplicate tensor(-0.2446, dtype=torch.float64) tensor(1.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0434, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
8 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(0.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1225, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
7 gae_duplicate tensor(-0.2760, dtype=torch.float64) tensor(1.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4180, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
6 gae_duplicate tensor(-0.3361, dtype=torch.float64) tensor(2.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8238, dtype=torch.float64) delta_t tensor(0.3296, dtype=torch.float64)
5 gae_duplicate tensor(0.1873, dtype=torch.float64) tensor(-6.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7458, dtype=torch.float64) delta_t tensor(-0.3077, dtype=torch.float64)
4 gae_duplicate tensor(-0.6404, dtype=torch.float64) tensor(5.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7503, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
3 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(-1.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5322, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
2 gae_duplicate tensor(-0.2351, dtype=torch.float64) tensor(1.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-558.9085083007812
value loss:3.89815616607666
entropies:355.3972473144531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.911450147628784 seconds
19 rew tensor(0.8862, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
19 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(2.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
18 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(0.8264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
17 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(0.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
16 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(0.8081, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
15 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(0.6373, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
14 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(0.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
13 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(1.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
12 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-0.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
11 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(-1.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6156, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
10 gae_duplicate tensor(-0.0253, dtype=torch.float64) tensor(-0.5984, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
9 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-1.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0429, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
8 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-1.3427, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
7 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(-0.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3450, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
6 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-0.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8254, dtype=torch.float64) delta_t tensor(0.2852, dtype=torch.float64)
5 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(-5.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6758, dtype=torch.float64) delta_t tensor(-0.2304, dtype=torch.float64)
4 gae_duplicate tensor(-0.5567, dtype=torch.float64) tensor(3.9967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6606, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
3 gae_duplicate tensor(0.0208, dtype=torch.float64) tensor(-2.6102, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4418, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
2 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-0.9578, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:112.68517303466797
value loss:3.486496925354004
entropies:355.4441223144531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052671194076538 seconds
19 rew tensor(0.8861, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
19 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(2.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
18 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(0.5361, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
17 gae_duplicate tensor(-0.0351, dtype=torch.float64) tensor(0.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
16 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(0.3149, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
15 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(-0.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
14 gae_duplicate tensor(-0.0684, dtype=torch.float64) tensor(-0.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(-0.0020, dtype=torch.float64)
13 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(0.0188, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
12 gae_duplicate tensor(-0.0415, dtype=torch.float64) tensor(-0.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
11 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-1.5448, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6152, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-0.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2267, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
9 gae_duplicate tensor(-0.2350, dtype=torch.float64) tensor(1.6007, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0607, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
8 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(-0.9482, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1058, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
7 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-0.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3738, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
6 gae_duplicate tensor(-0.2402, dtype=torch.float64) tensor(0.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8267, dtype=torch.float64) delta_t tensor(0.3201, dtype=torch.float64)
5 gae_duplicate tensor(0.1942, dtype=torch.float64) tensor(-6.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7324, dtype=torch.float64) delta_t tensor(-0.2782, dtype=torch.float64)
4 gae_duplicate tensor(-0.5126, dtype=torch.float64) tensor(4.8851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6804, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
3 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-2.4526, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4616, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
2 gae_duplicate tensor(-0.2350, dtype=torch.float64) tensor(-0.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:79.59671020507812
value loss:3.712456226348877
entropies:355.47900390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.941629886627197 seconds
19 rew tensor(0.8863, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
19 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(2.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
18 gae_duplicate tensor(-0.0431, dtype=torch.float64) tensor(0.6743, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
17 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(0.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(-0.0388, dtype=torch.float64)
16 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(0.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8800, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
15 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(0.7479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
14 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(0.3750, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
13 gae_duplicate tensor(-0.0410, dtype=torch.float64) tensor(0.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8730, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
12 gae_duplicate tensor(-0.0840, dtype=torch.float64) tensor(-0.1970, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
11 gae_duplicate tensor(-0.1376, dtype=torch.float64) tensor(-0.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
10 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(0.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(-0.0932, dtype=torch.float64)
9 gae_duplicate tensor(-0.3482, dtype=torch.float64) tensor(1.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0047, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
8 gae_duplicate tensor(-0.3571, dtype=torch.float64) tensor(0.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1799, dtype=torch.float64) delta_t tensor(-0.0928, dtype=torch.float64)
7 gae_duplicate tensor(-0.4897, dtype=torch.float64) tensor(1.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4849, dtype=torch.float64) delta_t tensor(-0.1205, dtype=torch.float64)
6 gae_duplicate tensor(-0.6752, dtype=torch.float64) tensor(2.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8823, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
5 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(-3.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6954, dtype=torch.float64) delta_t tensor(-0.2790, dtype=torch.float64)
4 gae_duplicate tensor(-0.6246, dtype=torch.float64) tensor(5.2650, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8468, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
3 gae_duplicate tensor(-0.4302, dtype=torch.float64) tensor(0.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6471, dtype=torch.float64) delta_t tensor(-0.1598, dtype=torch.float64)
2 gae_duplicate tensor(-0.9720, dtype=torch.float64) tensor(3.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1058.76220703125
value loss:5.814689636230469
entropies:355.51025390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.723074197769165 seconds
19 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(-0.1000, dtype=torch.float64)
19 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(1.9792, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
18 gae_duplicate tensor(-0.0536, dtype=torch.float64) tensor(0.5712, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
17 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(0.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
16 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(0.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
15 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(0.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
14 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(0.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
13 gae_duplicate tensor(-0.0416, dtype=torch.float64) tensor(-0.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
12 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-0.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
11 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-0.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
10 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(0.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
9 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(1.6473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0423, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
8 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(0.0802, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1796, dtype=torch.float64) delta_t tensor(-0.0388, dtype=torch.float64)
7 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(0.7723, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4388, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
6 gae_duplicate tensor(-0.4390, dtype=torch.float64) tensor(1.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8274, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
5 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-3.5993, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7153, dtype=torch.float64) delta_t tensor(-0.2650, dtype=torch.float64)
4 gae_duplicate tensor(-0.5392, dtype=torch.float64) tensor(4.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7912, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
3 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(-0.6964, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5727, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
2 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(1.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-688.0950927734375
value loss:2.8659427165985107
entropies:355.5041809082031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.9998)
ToM Target loss= tensor(3817.8562)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.593523979187012 seconds
19 rew tensor(0.8865, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
19 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(1.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
18 gae_duplicate tensor(-0.0235, dtype=torch.float64) tensor(0.2170, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
17 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(0.0173, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
16 gae_duplicate tensor(-0.0473, dtype=torch.float64) tensor(0.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
15 gae_duplicate tensor(-0.0605, dtype=torch.float64) tensor(0.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
14 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(0.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0480, dtype=torch.float64)
13 gae_duplicate tensor(-0.2369, dtype=torch.float64) tensor(0.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
12 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(0.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
11 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-0.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
10 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(0.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
9 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(0.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0137, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
8 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(0.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2353, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
7 gae_duplicate tensor(-0.4257, dtype=torch.float64) tensor(1.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4848, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
6 gae_duplicate tensor(-0.6438, dtype=torch.float64) tensor(2.8728, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8460, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
5 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-2.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6419, dtype=torch.float64) delta_t tensor(-0.2264, dtype=torch.float64)
4 gae_duplicate tensor(-0.6766, dtype=torch.float64) tensor(4.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8292, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
3 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(0.4306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6108, dtype=torch.float64) delta_t tensor(-0.1073, dtype=torch.float64)
2 gae_duplicate tensor(-0.3862, dtype=torch.float64) tensor(2.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-845.5243530273438
value loss:3.9826455116271973
entropies:355.4935302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.974347114562988 seconds
19 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(-0.0499, dtype=torch.float64)
19 gae_duplicate tensor(-0.0900, dtype=torch.float64) tensor(0.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
18 gae_duplicate tensor(-0.0113, dtype=torch.float64) tensor(-0.6269, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
17 gae_duplicate tensor(-0.0073, dtype=torch.float64) tensor(-0.4379, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8796, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
16 gae_duplicate tensor(-0.0372, dtype=torch.float64) tensor(-0.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
15 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-0.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
14 gae_duplicate tensor(-0.0468, dtype=torch.float64) tensor(-0.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
13 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(0.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
12 gae_duplicate tensor(0.0004, dtype=torch.float64) tensor(-0.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3121, dtype=torch.float64) delta_t tensor(-0.5166, dtype=torch.float64)
11 gae_duplicate tensor(-3.1212, dtype=torch.float64) tensor(9.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5967, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
10 gae_duplicate tensor(-0.3313, dtype=torch.float64) tensor(1.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1624, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
9 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(1.9121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0320, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
8 gae_duplicate tensor(-0.3003, dtype=torch.float64) tensor(1.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2169, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
7 gae_duplicate tensor(-0.4410, dtype=torch.float64) tensor(3.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4852, dtype=torch.float64) delta_t tensor(-0.1496, dtype=torch.float64)
6 gae_duplicate tensor(-0.4664, dtype=torch.float64) tensor(3.3118, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8274, dtype=torch.float64) delta_t tensor(0.1025, dtype=torch.float64)
5 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-1.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5487, dtype=torch.float64) delta_t tensor(-0.1833, dtype=torch.float64)
4 gae_duplicate tensor(-0.4117, dtype=torch.float64) tensor(3.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9198, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
3 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(1.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7387, dtype=torch.float64) delta_t tensor(-0.2028, dtype=torch.float64)
2 gae_duplicate tensor(-0.7205, dtype=torch.float64) tensor(4.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1616.392578125
value loss:19.23558807373047
entropies:355.4823303222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.922390937805176 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
19 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(1.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
18 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(-0.0872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
17 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-0.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8797, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
16 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-0.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8804, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
15 gae_duplicate tensor(-0.0563, dtype=torch.float64) tensor(0.0154, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
14 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-0.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
13 gae_duplicate tensor(0.0220, dtype=torch.float64) tensor(-0.9980, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8640, dtype=torch.float64) delta_t tensor(0.0185, dtype=torch.float64)
12 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-0.4671, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
11 gae_duplicate tensor(-0.0312, dtype=torch.float64) tensor(-0.5400, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5784, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
10 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(0.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
9 gae_duplicate tensor(-0.3315, dtype=torch.float64) tensor(1.6725, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0241, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
8 gae_duplicate tensor(-0.1997, dtype=torch.float64) tensor(-1.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2163, dtype=torch.float64) delta_t tensor(-0.0584, dtype=torch.float64)
7 gae_duplicate tensor(-0.3875, dtype=torch.float64) tensor(1.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5118, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
6 gae_duplicate tensor(-0.5586, dtype=torch.float64) tensor(2.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8822, dtype=torch.float64) delta_t tensor(0.1629, dtype=torch.float64)
5 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(-2.9002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6415, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
4 gae_duplicate tensor(-0.5060, dtype=torch.float64) tensor(3.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8462, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
3 gae_duplicate tensor(-0.6086, dtype=torch.float64) tensor(1.2404, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6278, dtype=torch.float64) delta_t tensor(-0.2072, dtype=torch.float64)
2 gae_duplicate tensor(-0.8949, dtype=torch.float64) tensor(4.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-614.5883178710938
value loss:5.36867094039917
entropies:355.4808044433594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.876057863235474 seconds
19 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
19 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(1.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
18 gae_duplicate tensor(-0.0014, dtype=torch.float64) tensor(-0.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
17 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(-0.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
16 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(-0.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
15 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-0.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
14 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-0.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
13 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-0.7585, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
12 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-0.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
11 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-1.4134, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
10 gae_duplicate tensor(-0.0396, dtype=torch.float64) tensor(0.3219, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2636, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
9 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-0.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0785, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
8 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-0.8953, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1992, dtype=torch.float64) delta_t tensor(-0.0767, dtype=torch.float64)
7 gae_duplicate tensor(-0.6607, dtype=torch.float64) tensor(1.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4026, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
6 gae_duplicate tensor(-0.4845, dtype=torch.float64) tensor(-0.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8277, dtype=torch.float64) delta_t tensor(0.2624, dtype=torch.float64)
5 gae_duplicate tensor(-0.1261, dtype=torch.float64) tensor(-5.3729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6967, dtype=torch.float64) delta_t tensor(-0.2648, dtype=torch.float64)
4 gae_duplicate tensor(-0.4305, dtype=torch.float64) tensor(4.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6819, dtype=torch.float64) delta_t tensor(0.1192, dtype=torch.float64)
3 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(-1.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4626, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
2 gae_duplicate tensor(-0.6042, dtype=torch.float64) tensor(0.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:295.436767578125
value loss:4.3995819091796875
entropies:355.49468994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.136148929595947 seconds
19 rew tensor(0.8867, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
19 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(0.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
18 gae_duplicate tensor(0.0035, dtype=torch.float64) tensor(-0.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
17 gae_duplicate tensor(0.0122, dtype=torch.float64) tensor(-0.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
16 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-0.2917, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
15 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-0.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
14 gae_duplicate tensor(-0.0111, dtype=torch.float64) tensor(-0.3695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
13 gae_duplicate tensor(0.0141, dtype=torch.float64) tensor(-0.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
12 gae_duplicate tensor(0.0062, dtype=torch.float64) tensor(-1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
11 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(-0.5586, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6150, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
10 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(-0.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
9 gae_duplicate tensor(-0.2906, dtype=torch.float64) tensor(0.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0233, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
8 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-0.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1432, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
7 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(-0.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4202, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
6 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(-0.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8275, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
5 gae_duplicate tensor(0.0156, dtype=torch.float64) tensor(-3.6989, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8079, dtype=torch.float64) delta_t tensor(-0.3550, dtype=torch.float64)
4 gae_duplicate tensor(-0.8347, dtype=torch.float64) tensor(6.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8660, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
3 gae_duplicate tensor(-0.3212, dtype=torch.float64) tensor(0.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6474, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
2 gae_duplicate tensor(-0.5211, dtype=torch.float64) tensor(1.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-66.56464385986328
value loss:4.063542366027832
entropies:355.52069091796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.1692)
ToM Target loss= tensor(3832.4792)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9382288455963135 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
19 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(0.7845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
18 gae_duplicate tensor(0.0233, dtype=torch.float64) tensor(-0.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
17 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-0.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
16 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-0.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
15 gae_duplicate tensor(-0.0148, dtype=torch.float64) tensor(-0.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
14 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-0.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
13 gae_duplicate tensor(1.7612e-05, dtype=torch.float64) tensor(-0.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8731, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
12 gae_duplicate tensor(-0.0143, dtype=torch.float64) tensor(-0.9499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8462, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
11 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(0.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5783, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
10 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(0.0431, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1527, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
9 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(0.3075, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0692, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
8 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(0.9241, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2541, dtype=torch.float64) delta_t tensor(-0.1285, dtype=torch.float64)
7 gae_duplicate tensor(-0.3439, dtype=torch.float64) tensor(2.5671, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4570, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
6 gae_duplicate tensor(-0.4412, dtype=torch.float64) tensor(1.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8456, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
5 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-1.1373, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5666, dtype=torch.float64) delta_t tensor(-0.1344, dtype=torch.float64)
4 gae_duplicate tensor(-0.3297, dtype=torch.float64) tensor(2.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9385, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
3 gae_duplicate tensor(-0.2211, dtype=torch.float64) tensor(0.9229, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7203, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
2 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(1.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-451.3376159667969
value loss:2.1505470275878906
entropies:355.54547119140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.78911280632019 seconds
19 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
19 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(0.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
18 gae_duplicate tensor(0.0113, dtype=torch.float64) tensor(-0.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
17 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-0.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
16 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-0.3371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8804, dtype=torch.float64) delta_t tensor(4.0741e-05, dtype=torch.float64)
15 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-0.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
14 gae_duplicate tensor(0.0014, dtype=torch.float64) tensor(-0.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
13 gae_duplicate tensor(-0.1348, dtype=torch.float64) tensor(-0.3199, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.7055, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
12 gae_duplicate tensor(-1.0072, dtype=torch.float64) tensor(2.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8642, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
11 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-1.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5963, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
10 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-0.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2354, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
9 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-0.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
8 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(-2.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1252, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
7 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(-1.6350, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4307, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
6 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(-0.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8467, dtype=torch.float64) delta_t tensor(0.2669, dtype=torch.float64)
5 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-5.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6231, dtype=torch.float64) delta_t tensor(-0.2048, dtype=torch.float64)
4 gae_duplicate tensor(-0.3869, dtype=torch.float64) tensor(3.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7191, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
3 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(-1.1701, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4999, dtype=torch.float64) delta_t tensor(-0.1144, dtype=torch.float64)
2 gae_duplicate tensor(-0.4998, dtype=torch.float64) tensor(2.1458, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:351.2481689453125
value loss:5.285247325897217
entropies:355.5726013183594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859700918197632 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
19 gae_duplicate tensor(-0.0337, dtype=torch.float64) tensor(0.2256, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0680, dtype=torch.float64)
18 gae_duplicate tensor(0.0401, dtype=torch.float64) tensor(-1.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
17 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-1.3621, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
16 gae_duplicate tensor(0.0178, dtype=torch.float64) tensor(-1.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
15 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-0.9969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
14 gae_duplicate tensor(0.0094, dtype=torch.float64) tensor(-1.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
13 gae_duplicate tensor(0.0260, dtype=torch.float64) tensor(-1.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
12 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-1.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
11 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-0.8668, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6152, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
10 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-0.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
9 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(0.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0237, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
8 gae_duplicate tensor(-0.0973, dtype=torch.float64) tensor(-0.8234, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2349, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
7 gae_duplicate tensor(-0.4997, dtype=torch.float64) tensor(0.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5125, dtype=torch.float64) delta_t tensor(-0.0608, dtype=torch.float64)
6 gae_duplicate tensor(-0.4171, dtype=torch.float64) tensor(1.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8820, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
5 gae_duplicate tensor(-0.3238, dtype=torch.float64) tensor(-2.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8258, dtype=torch.float64) delta_t tensor(-0.4039, dtype=torch.float64)
4 gae_duplicate tensor(-0.7985, dtype=torch.float64) tensor(7.6114, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9763, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
3 gae_duplicate tensor(-0.3742, dtype=torch.float64) tensor(1.9813, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7765, dtype=torch.float64) delta_t tensor(-0.2816, dtype=torch.float64)
2 gae_duplicate tensor(-0.8721, dtype=torch.float64) tensor(5.7009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-375.67681884765625
value loss:6.163581848144531
entropies:355.58575439453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.826557874679565 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
19 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(0.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
18 gae_duplicate tensor(0.0450, dtype=torch.float64) tensor(-0.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
17 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-0.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
16 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-0.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
15 gae_duplicate tensor(-0.0104, dtype=torch.float64) tensor(-0.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
14 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-1.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
13 gae_duplicate tensor(0.0483, dtype=torch.float64) tensor(-1.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
12 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-1.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
11 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-1.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6148, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
10 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-0.5910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2815, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
9 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-1.7631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0967, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
8 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-2.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1068, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
7 gae_duplicate tensor(0.0709, dtype=torch.float64) tensor(-3.2729, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3751, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
6 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-2.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8282, dtype=torch.float64) delta_t tensor(0.3400, dtype=torch.float64)
5 gae_duplicate tensor(0.2569, dtype=torch.float64) tensor(-6.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7525, dtype=torch.float64) delta_t tensor(-0.2786, dtype=torch.float64)
4 gae_duplicate tensor(-0.4785, dtype=torch.float64) tensor(4.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6077, dtype=torch.float64) delta_t tensor(0.1627, dtype=torch.float64)
3 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-2.7378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3879, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
2 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(-1.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1252.91015625
value loss:4.24605131149292
entropies:355.6106872558594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.854306936264038 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
19 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(0.7271, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
18 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-0.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
17 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-0.7274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
16 gae_duplicate tensor(-0.0031, dtype=torch.float64) tensor(-0.7382, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
15 gae_duplicate tensor(0.0008, dtype=torch.float64) tensor(-0.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
14 gae_duplicate tensor(0.0095, dtype=torch.float64) tensor(-1.1532, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
13 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(-0.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
12 gae_duplicate tensor(0.0260, dtype=torch.float64) tensor(-1.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
11 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-1.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6144, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
10 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-0.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2622, dtype=torch.float64) delta_t tensor(0.0487, dtype=torch.float64)
9 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-0.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0958, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
8 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-2.4947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1078, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
7 gae_duplicate tensor(0.0895, dtype=torch.float64) tensor(-2.9648, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3577, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
6 gae_duplicate tensor(0.1382, dtype=torch.float64) tensor(-3.4834, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8298, dtype=torch.float64) delta_t tensor(0.3474, dtype=torch.float64)
5 gae_duplicate tensor(0.2908, dtype=torch.float64) tensor(-7.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7367, dtype=torch.float64) delta_t tensor(-0.2419, dtype=torch.float64)
4 gae_duplicate tensor(-0.5919, dtype=torch.float64) tensor(3.9655, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6103, dtype=torch.float64) delta_t tensor(0.2024, dtype=torch.float64)
3 gae_duplicate tensor(-0.0098, dtype=torch.float64) tensor(-3.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.3902, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
2 gae_duplicate tensor(0.0545, dtype=torch.float64) tensor(-1.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1241.853515625
value loss:3.8144760131835938
entropies:355.629150390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3965.4236)
ToM Target loss= tensor(3826.9895)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.771106004714966 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
19 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(0.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
18 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-0.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
17 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-0.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
16 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-0.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
15 gae_duplicate tensor(-0.0079, dtype=torch.float64) tensor(-0.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
14 gae_duplicate tensor(-0.0128, dtype=torch.float64) tensor(-0.4738, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
13 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-0.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
12 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-1.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(-0.0149, dtype=torch.float64)
11 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(0.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6143, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
10 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-0.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2072, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
9 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(0.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0036, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
8 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-0.0781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2367, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
7 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(0.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4871, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
6 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(0.4886, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8300, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
5 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-3.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6822, dtype=torch.float64) delta_t tensor(-0.2198, dtype=torch.float64)
4 gae_duplicate tensor(-0.4717, dtype=torch.float64) tensor(4.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8684, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
3 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-0.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6493, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
2 gae_duplicate tensor(-0.4076, dtype=torch.float64) tensor(2.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-67.8510513305664
value loss:2.837697744369507
entropies:355.6416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.868561267852783 seconds
19 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
19 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(0.4414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
18 gae_duplicate tensor(0.0153, dtype=torch.float64) tensor(-0.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
17 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-0.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
16 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(-1.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
15 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(0.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
14 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(-0.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
13 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-0.2482, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
12 gae_duplicate tensor(-0.0873, dtype=torch.float64) tensor(-0.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
11 gae_duplicate tensor(-0.0084, dtype=torch.float64) tensor(-1.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6142, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
10 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-0.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2075, dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
9 gae_duplicate tensor(-0.2155, dtype=torch.float64) tensor(0.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0221, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
8 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(-0.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1998, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
7 gae_duplicate tensor(-0.3293, dtype=torch.float64) tensor(-0.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4686, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
6 gae_duplicate tensor(-0.3680, dtype=torch.float64) tensor(0.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8485, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
5 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-4.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7372, dtype=torch.float64) delta_t tensor(-0.3109, dtype=torch.float64)
4 gae_duplicate tensor(-0.6052, dtype=torch.float64) tensor(5.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8308, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
3 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(-0.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6116, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
2 gae_duplicate tensor(-0.3751, dtype=torch.float64) tensor(0.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:109.96503448486328
value loss:4.1379852294921875
entropies:355.6465148925781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.775496006011963 seconds
19 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(-0.0588, dtype=torch.float64)
19 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(1.1536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
18 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-0.4266, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
17 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-0.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
16 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(0.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
15 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(0.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
14 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-0.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
13 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-1.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6788, dtype=torch.float64) delta_t tensor(-0.1640, dtype=torch.float64)
12 gae_duplicate tensor(-1.0821, dtype=torch.float64) tensor(3.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8456, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
11 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(0.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5772, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
10 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(0.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1322, dtype=torch.float64) delta_t tensor(-0.1145, dtype=torch.float64)
9 gae_duplicate tensor(-0.3035, dtype=torch.float64) tensor(2.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0212, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
8 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-0.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1638, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
7 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(-0.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4228, dtype=torch.float64) delta_t tensor(0.0506, dtype=torch.float64)
6 gae_duplicate tensor(-0.2935, dtype=torch.float64) tensor(-0.9879, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8305, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
5 gae_duplicate tensor(-0.0014, dtype=torch.float64) tensor(-4.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5710, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
4 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(1.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7769, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
3 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(-2.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5942, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
2 gae_duplicate tensor(-0.6759, dtype=torch.float64) tensor(0.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2.433110237121582
value loss:4.695511817932129
entropies:355.6482849121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.740324020385742 seconds
19 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
19 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(1.2951, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
18 gae_duplicate tensor(0.0122, dtype=torch.float64) tensor(-0.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
17 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-0.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
16 gae_duplicate tensor(-0.0223, dtype=torch.float64) tensor(-0.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
15 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-0.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
14 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-0.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
13 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(1.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
12 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(0.0952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(-0.0273, dtype=torch.float64)
11 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(0.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6142, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
10 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(0.9114, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
9 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(-1.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0024, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
8 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1831, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
7 gae_duplicate tensor(-0.1531, dtype=torch.float64) tensor(-1.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3959, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
6 gae_duplicate tensor(-0.1721, dtype=torch.float64) tensor(-1.1362, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8311, dtype=torch.float64) delta_t tensor(0.1912, dtype=torch.float64)
5 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-4.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6641, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
4 gae_duplicate tensor(-0.6102, dtype=torch.float64) tensor(2.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7418, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
3 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-2.1626, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5219, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
2 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-1.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:177.0546875
value loss:3.229649305343628
entropies:355.64764404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.078772306442261 seconds
19 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
19 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(1.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
18 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-0.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
17 gae_duplicate tensor(-0.0122, dtype=torch.float64) tensor(-0.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8798, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
16 gae_duplicate tensor(-0.1660, dtype=torch.float64) tensor(0.6329, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
15 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(0.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
14 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(0.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
13 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(0.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
12 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-0.6613, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(-0.1719, dtype=torch.float64)
11 gae_duplicate tensor(-0.9392, dtype=torch.float64) tensor(3.2266, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5953, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
10 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(0.7387, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2707, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
9 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-0.8244, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0575, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
8 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(-2.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1278, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
7 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-1.9314, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4063, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
6 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(-1.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8322, dtype=torch.float64) delta_t tensor(0.2842, dtype=torch.float64)
5 gae_duplicate tensor(-0.0624, dtype=torch.float64) tensor(-5.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6466, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
4 gae_duplicate tensor(-0.4606, dtype=torch.float64) tensor(2.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6873, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
3 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-2.1493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4857, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
2 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:237.45614624023438
value loss:4.637855529785156
entropies:355.6447448730469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3960.1843)
ToM Target loss= tensor(3836.2861)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.861899137496948 seconds
19 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(-0.0547, dtype=torch.float64)
19 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(1.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
18 gae_duplicate tensor(-0.0056, dtype=torch.float64) tensor(-0.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
17 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-0.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
16 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(0.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
15 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(0.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
14 gae_duplicate tensor(-0.0357, dtype=torch.float64) tensor(0.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
13 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-0.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
12 gae_duplicate tensor(-0.0231, dtype=torch.float64) tensor(-0.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(-0.0813, dtype=torch.float64)
11 gae_duplicate tensor(-0.1058, dtype=torch.float64) tensor(1.5647, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6140, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
10 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(1.9610, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2251, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
9 gae_duplicate tensor(-0.2504, dtype=torch.float64) tensor(0.4536, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0393, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
8 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-0.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1461, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
7 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3870, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
6 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(-1.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8318, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
5 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-3.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8509, dtype=torch.float64) delta_t tensor(-0.3342, dtype=torch.float64)
4 gae_duplicate tensor(-0.6050, dtype=torch.float64) tensor(6.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8535, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
3 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-0.3816, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6339, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
2 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(-0.1646, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-294.4708251953125
value loss:2.81447172164917
entropies:355.63909912109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.860046863555908 seconds
19 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
19 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(1.0557, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
18 gae_duplicate tensor(0.0062, dtype=torch.float64) tensor(-0.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
17 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-0.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
16 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-0.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
15 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-0.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
14 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-0.1973, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
13 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-0.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
12 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-0.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8917, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
11 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(1.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6140, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
10 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(0.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2062, dtype=torch.float64) delta_t tensor(-0.0473, dtype=torch.float64)
9 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(1.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0023, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
8 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(-0.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2197, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
7 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(0.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5161, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
6 gae_duplicate tensor(-0.5588, dtype=torch.float64) tensor(2.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8501, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
5 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(-2.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7397, dtype=torch.float64) delta_t tensor(-0.2410, dtype=torch.float64)
4 gae_duplicate tensor(-0.3791, dtype=torch.float64) tensor(4.5590, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8717, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
3 gae_duplicate tensor(-0.3528, dtype=torch.float64) tensor(0.3442, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6521, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
2 gae_duplicate tensor(-0.4151, dtype=torch.float64) tensor(0.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-495.2291259765625
value loss:3.353440284729004
entropies:355.61419677734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.148291110992432 seconds
19 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0725, dtype=torch.float64)
19 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(1.4376, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
18 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-0.6085, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
17 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-0.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
16 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-0.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
15 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(0.8070, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
14 gae_duplicate tensor(-0.0991, dtype=torch.float64) tensor(0.5796, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
13 gae_duplicate tensor(-0.2956, dtype=torch.float64) tensor(1.4278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
12 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(0.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
11 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
10 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(0.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2618, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
9 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(-0.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0393, dtype=torch.float64) delta_t tensor(0.0784, dtype=torch.float64)
8 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-1.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1828, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
7 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-1.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4518, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
6 gae_duplicate tensor(-0.3694, dtype=torch.float64) tensor(0.5365, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8325, dtype=torch.float64) delta_t tensor(0.2884, dtype=torch.float64)
5 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-5.5547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7047, dtype=torch.float64) delta_t tensor(-0.2755, dtype=torch.float64)
4 gae_duplicate tensor(-0.3814, dtype=torch.float64) tensor(4.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7056, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
3 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(-0.5072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4854, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
2 gae_duplicate tensor(-0.1706, dtype=torch.float64) tensor(0.5337, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-71.4842300415039
value loss:3.616786479949951
entropies:355.5841979980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.193396091461182 seconds
19 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
19 gae_duplicate tensor(-0.0537, dtype=torch.float64) tensor(0.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
18 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-0.5764, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
17 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-0.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
16 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(-0.3159, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
15 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-0.1534, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
14 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-0.2535, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
13 gae_duplicate tensor(-0.3520, dtype=torch.float64) tensor(0.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8910, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
12 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.3443, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
11 gae_duplicate tensor(-0.0791, dtype=torch.float64) tensor(-0.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
10 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(1.3442, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1876, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
9 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(0.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0394, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
8 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-0.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2565, dtype=torch.float64) delta_t tensor(-0.1009, dtype=torch.float64)
7 gae_duplicate tensor(-0.5483, dtype=torch.float64) tensor(1.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4332, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
6 gae_duplicate tensor(-0.4259, dtype=torch.float64) tensor(1.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8324, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
5 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(-2.7097, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7227, dtype=torch.float64) delta_t tensor(-0.2600, dtype=torch.float64)
4 gae_duplicate tensor(-0.4868, dtype=torch.float64) tensor(4.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8715, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
3 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(0.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6518, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
2 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(0.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-430.3880920410156
value loss:3.321110725402832
entropies:355.5712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.645540237426758 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
19 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(0.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
18 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-0.7974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
17 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-0.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
16 gae_duplicate tensor(-0.0116, dtype=torch.float64) tensor(-0.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
15 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-0.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
14 gae_duplicate tensor(-0.0255, dtype=torch.float64) tensor(-0.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
13 gae_duplicate tensor(0.0047, dtype=torch.float64) tensor(-0.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
12 gae_duplicate tensor(0.0050, dtype=torch.float64) tensor(-0.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8542, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
11 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-0.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5951, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
10 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(1.5609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1689, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
9 gae_duplicate tensor(-0.3917, dtype=torch.float64) tensor(1.7853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0209, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
8 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-0.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2386, dtype=torch.float64) delta_t tensor(-0.0775, dtype=torch.float64)
7 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(1.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(-0.1528, dtype=torch.float64)
6 gae_duplicate tensor(-0.8289, dtype=torch.float64) tensor(3.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8871, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
5 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(-2.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8310, dtype=torch.float64) delta_t tensor(-0.3889, dtype=torch.float64)
4 gae_duplicate tensor(-0.6974, dtype=torch.float64) tensor(7.2323, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9824, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
3 gae_duplicate tensor(-0.3957, dtype=torch.float64) tensor(2.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.8004, dtype=torch.float64) delta_t tensor(-0.1169, dtype=torch.float64)
2 gae_duplicate tensor(-0.7253, dtype=torch.float64) tensor(2.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-787.0259399414062
value loss:5.558866500854492
entropies:355.537353515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.9617)
ToM Target loss= tensor(3842.1064)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.875101327896118 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0275, dtype=torch.float64)
19 gae_duplicate tensor(-0.0387, dtype=torch.float64) tensor(0.5451, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
18 gae_duplicate tensor(0.0296, dtype=torch.float64) tensor(-0.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
17 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-0.6718, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
16 gae_duplicate tensor(-0.0147, dtype=torch.float64) tensor(-0.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
15 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-0.1280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
14 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(-0.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
13 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-0.3340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
12 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-0.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
11 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(0.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
10 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(0.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
9 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(1.5144, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0401, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
8 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(-0.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1639, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
7 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(-0.5258, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4603, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
6 gae_duplicate tensor(-0.4225, dtype=torch.float64) tensor(1.3293, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
5 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(-3.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.9038, dtype=torch.float64) delta_t tensor(-0.4226, dtype=torch.float64)
4 gae_duplicate tensor(-0.8876, dtype=torch.float64) tensor(7.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9622, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
3 gae_duplicate tensor(-0.2694, dtype=torch.float64) tensor(1.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7430, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
2 gae_duplicate tensor(-0.2606, dtype=torch.float64) tensor(1.7643, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-557.8748168945312
value loss:3.971468925476074
entropies:355.5353088378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.15388298034668 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
19 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(0.6270, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
18 gae_duplicate tensor(0.0278, dtype=torch.float64) tensor(-1.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
17 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-1.0054, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
16 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-0.4278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
15 gae_duplicate tensor(-0.0185, dtype=torch.float64) tensor(-0.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
14 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(0.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
13 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-0.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
12 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-0.8578, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
11 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(0.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6139, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
10 gae_duplicate tensor(-0.1016, dtype=torch.float64) tensor(0.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1512, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
9 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(1.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0709, dtype=torch.float64) delta_t tensor(-0.0760, dtype=torch.float64)
8 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(1.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2370, dtype=torch.float64) delta_t tensor(-0.0207, dtype=torch.float64)
7 gae_duplicate tensor(-0.3124, dtype=torch.float64) tensor(0.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5695, dtype=torch.float64) delta_t tensor(-0.1874, dtype=torch.float64)
6 gae_duplicate tensor(-0.4623, dtype=torch.float64) tensor(3.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8480, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
5 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-1.3959, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6994, dtype=torch.float64) delta_t tensor(-0.2261, dtype=torch.float64)
4 gae_duplicate tensor(-0.4350, dtype=torch.float64) tensor(4.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9790, dtype=torch.float64) delta_t tensor(-0.0742, dtype=torch.float64)
3 gae_duplicate tensor(-0.2401, dtype=torch.float64) tensor(1.8675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.7599, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
2 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(2.7390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-791.7594604492188
value loss:2.8630623817443848
entropies:355.5321350097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.002642869949341 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
19 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(0.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
18 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-0.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
17 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-0.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
16 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(-0.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
15 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-0.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
14 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(-0.1273, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
13 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(0.4044, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
12 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(-0.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8539, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
11 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(0.1129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5952, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
10 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2070, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
9 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(0.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0407, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
8 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-0.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
7 gae_duplicate tensor(-0.3230, dtype=torch.float64) tensor(0.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4494, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
6 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(0.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8292, dtype=torch.float64) delta_t tensor(0.1536, dtype=torch.float64)
5 gae_duplicate tensor(-0.1239, dtype=torch.float64) tensor(-2.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7173, dtype=torch.float64) delta_t tensor(-0.2572, dtype=torch.float64)
4 gae_duplicate tensor(-0.5818, dtype=torch.float64) tensor(4.9054, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8664, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
3 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(0.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6469, dtype=torch.float64) delta_t tensor(0.0150, dtype=torch.float64)
2 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(-0.2437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-236.61239624023438
value loss:3.038555383682251
entropies:355.52862548828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.367155075073242 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
19 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(0.8584, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
18 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-0.7536, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
17 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-0.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
16 gae_duplicate tensor(-0.0132, dtype=torch.float64) tensor(-0.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
15 gae_duplicate tensor(-0.0208, dtype=torch.float64) tensor(-0.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
14 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-0.5224, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
13 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-0.8860, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8632, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
12 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-0.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8546, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
11 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-1.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5955, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
10 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(0.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
9 gae_duplicate tensor(-0.2454, dtype=torch.float64) tensor(1.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0406, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
8 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1628, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
7 gae_duplicate tensor(-0.2949, dtype=torch.float64) tensor(-0.3614, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5048, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
6 gae_duplicate tensor(-0.3689, dtype=torch.float64) tensor(2.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8293, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
5 gae_duplicate tensor(0.1475, dtype=torch.float64) tensor(-5.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6821, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
4 gae_duplicate tensor(-0.6188, dtype=torch.float64) tensor(3.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8302, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
3 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(-0.1338, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6107, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
2 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(0.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:44.36362075805664
value loss:3.258849620819092
entropies:355.5162048339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.975942850112915 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
19 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(0.7132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
18 gae_duplicate tensor(0.0212, dtype=torch.float64) tensor(-0.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
17 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-0.8063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
16 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-0.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
15 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-0.2670, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
14 gae_duplicate tensor(-0.0280, dtype=torch.float64) tensor(-0.2917, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
13 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-0.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
12 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-1.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
11 gae_duplicate tensor(-0.0497, dtype=torch.float64) tensor(-0.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6138, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
10 gae_duplicate tensor(-0.1388, dtype=torch.float64) tensor(0.7286, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1888, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
9 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(0.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0147, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
8 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(0.0758, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
7 gae_duplicate tensor(-0.3010, dtype=torch.float64) tensor(0.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4674, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
6 gae_duplicate tensor(-0.5016, dtype=torch.float64) tensor(0.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8476, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
5 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(-2.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6817, dtype=torch.float64) delta_t tensor(-0.1627, dtype=torch.float64)
4 gae_duplicate tensor(-0.5674, dtype=torch.float64) tensor(2.9483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8483, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
3 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(-0.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6287, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(-0.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:39.56258773803711
value loss:2.635627508163452
entropies:355.50482177734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.0166)
ToM Target loss= tensor(3849.1821)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0526018142700195 seconds
19 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
19 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(0.9759, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
18 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-0.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
17 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-0.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
16 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-0.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
15 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-0.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
14 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-0.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
13 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(0.1199, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
12 gae_duplicate tensor(0.0116, dtype=torch.float64) tensor(-1.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8726, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
11 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(-0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
10 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1876, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
9 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(-0.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0024, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
8 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-0.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1825, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
7 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(0.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4232, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
6 gae_duplicate tensor(-0.2710, dtype=torch.float64) tensor(-0.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8301, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
5 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(-3.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.5698, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
4 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(0.5214, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7209, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
3 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-2.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5008, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
2 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-2.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:518.7763061523438
value loss:2.165111541748047
entropies:355.4834899902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.610214948654175 seconds
19 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
19 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(0.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
18 gae_duplicate tensor(0.0050, dtype=torch.float64) tensor(-0.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
17 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-0.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
16 gae_duplicate tensor(-0.0223, dtype=torch.float64) tensor(-0.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
15 gae_duplicate tensor(-0.0254, dtype=torch.float64) tensor(-0.4180, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
14 gae_duplicate tensor(-0.0066, dtype=torch.float64) tensor(-0.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
13 gae_duplicate tensor(0.0009, dtype=torch.float64) tensor(-0.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
12 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-0.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
11 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(0.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5949, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
10 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(0.9576, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2618, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
9 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-0.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0764, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
8 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-1.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
7 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(-1.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4504, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
6 gae_duplicate tensor(-0.2333, dtype=torch.float64) tensor(-0.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8117, dtype=torch.float64) delta_t tensor(0.2422, dtype=torch.float64)
5 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-4.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7903, dtype=torch.float64) delta_t tensor(-0.2563, dtype=torch.float64)
4 gae_duplicate tensor(-0.8220, dtype=torch.float64) tensor(4.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7755, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
3 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(-1.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5555, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
2 gae_duplicate tensor(-0.1704, dtype=torch.float64) tensor(-1.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:347.83721923828125
value loss:3.7155866622924805
entropies:355.4561767578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.072652101516724 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
19 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(0.8684, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
18 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-0.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
17 gae_duplicate tensor(-0.0085, dtype=torch.float64) tensor(-0.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8885, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
16 gae_duplicate tensor(-0.0258, dtype=torch.float64) tensor(-0.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
15 gae_duplicate tensor(-0.0311, dtype=torch.float64) tensor(-0.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
14 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-0.2764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
13 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-0.4201, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
12 gae_duplicate tensor(-0.0014, dtype=torch.float64) tensor(-0.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
11 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-0.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
10 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(0.7888, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2247, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
9 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-0.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0765, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
8 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-1.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1089, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
7 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-0.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3497, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
6 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-2.7860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8310, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
5 gae_duplicate tensor(0.1846, dtype=torch.float64) tensor(-5.3112, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7573, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
4 gae_duplicate tensor(-0.6825, dtype=torch.float64) tensor(3.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6849, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
3 gae_duplicate tensor(-0.0705, dtype=torch.float64) tensor(-2.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4646, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
2 gae_duplicate tensor(0.0516, dtype=torch.float64) tensor(-2.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:669.6243896484375
value loss:2.6811985969543457
entropies:355.4594421386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.755501985549927 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
19 gae_duplicate tensor(-0.0785, dtype=torch.float64) tensor(0.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8876, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
18 gae_duplicate tensor(0.0113, dtype=torch.float64) tensor(-0.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
17 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-0.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(0.0571, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
15 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(0.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
14 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(0.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
13 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-0.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
12 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-0.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
11 gae_duplicate tensor(-0.0219, dtype=torch.float64) tensor(-0.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
10 gae_duplicate tensor(-0.0551, dtype=torch.float64) tensor(-0.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1505, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
9 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(0.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0346, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
8 gae_duplicate tensor(-0.2838, dtype=torch.float64) tensor(1.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2012, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
7 gae_duplicate tensor(-0.1932, dtype=torch.float64) tensor(-0.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4596, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
6 gae_duplicate tensor(-0.3424, dtype=torch.float64) tensor(0.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8311, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
5 gae_duplicate tensor(-0.1433, dtype=torch.float64) tensor(-1.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6643, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
4 gae_duplicate tensor(-0.3901, dtype=torch.float64) tensor(1.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8879, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
3 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-0.5648, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6681, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
2 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(-1.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:26.134674072265625
value loss:1.863023042678833
entropies:355.4118957519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.229453086853027 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
19 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(0.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
18 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-0.4923, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.0246, dtype=torch.float64)
17 gae_duplicate tensor(-0.0084, dtype=torch.float64) tensor(-0.5560, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
16 gae_duplicate tensor(-0.0251, dtype=torch.float64) tensor(-0.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
15 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(0.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
14 gae_duplicate tensor(-0.0278, dtype=torch.float64) tensor(-1.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
13 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-0.9223, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
12 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-0.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
11 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(-1.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6132, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
10 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(0.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
9 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(0.2801, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0577, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
8 gae_duplicate tensor(-0.2821, dtype=torch.float64) tensor(-0.8408, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1275, dtype=torch.float64) delta_t tensor(0.0896, dtype=torch.float64)
7 gae_duplicate tensor(0.0220, dtype=torch.float64) tensor(-1.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4144, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
6 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(-1.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(0.2197, dtype=torch.float64)
5 gae_duplicate tensor(0.0246, dtype=torch.float64) tensor(-4.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8136, dtype=torch.float64) delta_t tensor(-0.2745, dtype=torch.float64)
4 gae_duplicate tensor(-0.5066, dtype=torch.float64) tensor(5.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7604, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
3 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-1.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5403, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
2 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(0.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:364.50494384765625
value loss:2.947472333908081
entropies:355.3501892089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.4099)
ToM Target loss= tensor(3844.1860)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.989311933517456 seconds
19 rew tensor(0.8871, dtype=torch.float64) delta_t tensor(-0.0453, dtype=torch.float64)
19 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(0.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
18 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-0.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8880, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
17 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-0.5993, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
16 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-0.4091, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
15 gae_duplicate tensor(-0.0184, dtype=torch.float64) tensor(-0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
14 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(0.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-0.0182, dtype=torch.float64)
13 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(0.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8903, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
12 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(-0.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
11 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-0.2936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6132, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
10 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(0.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1869, dtype=torch.float64) delta_t tensor(0.0088, dtype=torch.float64)
9 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(-0.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.0353, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
8 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(0.9927, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2393, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
7 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(0.2762, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
6 gae_duplicate tensor(-0.3368, dtype=torch.float64) tensor(1.6635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8312, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
5 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-1.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6641, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
4 gae_duplicate tensor(-0.4311, dtype=torch.float64) tensor(3.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8897, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
3 gae_duplicate tensor(-0.2636, dtype=torch.float64) tensor(0.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6700, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
2 gae_duplicate tensor(-0.2308, dtype=torch.float64) tensor(0.0797, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-323.25750732421875
value loss:2.4657061100006104
entropies:355.2824401855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7599382400512695 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
19 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(0.7175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
18 gae_duplicate tensor(0.0217, dtype=torch.float64) tensor(-0.7756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
17 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-0.5246, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
16 gae_duplicate tensor(-0.0363, dtype=torch.float64) tensor(-0.0466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
15 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(0.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
14 gae_duplicate tensor(-0.0453, dtype=torch.float64) tensor(0.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
13 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(0.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
12 gae_duplicate tensor(0.0041, dtype=torch.float64) tensor(-0.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8907, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
11 gae_duplicate tensor(-0.0375, dtype=torch.float64) tensor(-0.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6132, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
10 gae_duplicate tensor(-0.0758, dtype=torch.float64) tensor(-0.3800, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2058, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
9 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(0.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0204, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
8 gae_duplicate tensor(-0.2970, dtype=torch.float64) tensor(0.3139, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1275, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
7 gae_duplicate tensor(0.0360, dtype=torch.float64) tensor(-1.7604, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4605, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
6 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8311, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
5 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-4.6557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.8122, dtype=torch.float64) delta_t tensor(-0.2431, dtype=torch.float64)
4 gae_duplicate tensor(-0.3217, dtype=torch.float64) tensor(4.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8332, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
3 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(0.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.6132, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
2 gae_duplicate tensor(-0.3541, dtype=torch.float64) tensor(1.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-98.81982421875
value loss:2.531452178955078
entropies:355.2173156738281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.629611968994141 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
19 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(1.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8875, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
18 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-0.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
17 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-0.4808, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8884, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
16 gae_duplicate tensor(-0.0386, dtype=torch.float64) tensor(0.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
15 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(0.1233, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
14 gae_duplicate tensor(-0.0537, dtype=torch.float64) tensor(0.5659, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8897, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
13 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(0.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8902, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
12 gae_duplicate tensor(-0.0561, dtype=torch.float64) tensor(-0.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
11 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-0.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6131, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
10 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(-0.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1685, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
9 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(0.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0019, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
8 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(1.2907, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1278, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
7 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-1.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3964, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
6 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-1.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8314, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
5 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-4.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7012, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
4 gae_duplicate tensor(-0.3364, dtype=torch.float64) tensor(2.2085, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7773, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
3 gae_duplicate tensor(-0.0456, dtype=torch.float64) tensor(-0.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5571, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
2 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-1.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:149.52975463867188
value loss:1.8250162601470947
entropies:355.163818359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1979451179504395 seconds
19 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
19 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(1.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
18 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-0.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8879, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
17 gae_duplicate tensor(-0.0155, dtype=torch.float64) tensor(-0.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8883, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
16 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(0.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8888, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
15 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-0.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8892, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
14 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-0.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
13 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(0.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
12 gae_duplicate tensor(0.0094, dtype=torch.float64) tensor(-0.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8905, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
11 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-0.1404, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6128, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
10 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(0.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2608, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
9 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(-0.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0570, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
8 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(-0.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1283, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
7 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-1.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3692, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
6 gae_duplicate tensor(-0.0204, dtype=torch.float64) tensor(-1.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8323, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
5 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-4.9158, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7210, dtype=torch.float64) delta_t tensor(-0.1544, dtype=torch.float64)
4 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(2.6082, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6488, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
3 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-2.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.4281, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
2 gae_duplicate tensor(0.0361, dtype=torch.float64) tensor(-1.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:432.4004821777344
value loss:1.9914448261260986
entropies:355.143310546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.013371706008911 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
19 gae_duplicate tensor(-0.1065, dtype=torch.float64) tensor(1.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8874, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
18 gae_duplicate tensor(0.0126, dtype=torch.float64) tensor(-0.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8878, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
17 gae_duplicate tensor(0.0092, dtype=torch.float64) tensor(-0.7307, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-0.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8887, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
15 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(0.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
14 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(0.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8896, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
13 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-0.2480, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8900, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
12 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-0.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8530, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
11 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(-1.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6127, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
10 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
9 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(-0.3559, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0564, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
8 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-1.9400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1661, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
7 gae_duplicate tensor(-0.4064, dtype=torch.float64) tensor(-0.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4628, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
6 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(0.7478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8514, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
5 gae_duplicate tensor(-0.2373, dtype=torch.float64) tensor(-3.5493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7027, dtype=torch.float64) delta_t tensor(-0.2659, dtype=torch.float64)
4 gae_duplicate tensor(-0.4837, dtype=torch.float64) tensor(4.9258, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7808, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
3 gae_duplicate tensor(-0.3211, dtype=torch.float64) tensor(1.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5605, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
2 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(1.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-101.98148345947266
value loss:3.984081268310547
entropies:355.10101318359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.8618)
ToM Target loss= tensor(3843.5564)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.797893762588501 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
19 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(1.1545, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
18 gae_duplicate tensor(-0.0200, dtype=torch.float64) tensor(-0.3784, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0068, dtype=torch.float64)
17 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(-0.1672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8882, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
16 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(0.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
15 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(0.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8891, dtype=torch.float64) delta_t tensor(-0.0200, dtype=torch.float64)
14 gae_duplicate tensor(-0.0676, dtype=torch.float64) tensor(0.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8895, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
13 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(0.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
12 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-0.0159, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8904, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
11 gae_duplicate tensor(-0.0365, dtype=torch.float64) tensor(-0.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6126, dtype=torch.float64) delta_t tensor(-0.0303, dtype=torch.float64)
10 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(0.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2051, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
9 gae_duplicate tensor(-0.1445, dtype=torch.float64) tensor(0.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0565, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
8 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-0.8442, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1659, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
7 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(0.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4348, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
6 gae_duplicate tensor(-0.4607, dtype=torch.float64) tensor(0.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8517, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
5 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(-3.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.7039, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
4 gae_duplicate tensor(-0.4191, dtype=torch.float64) tensor(3.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7239, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
3 gae_duplicate tensor(-0.4027, dtype=torch.float64) tensor(-0.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5034, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
2 gae_duplicate tensor(-0.3681, dtype=torch.float64) tensor(0.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-195.24807739257812
value loss:2.875927448272705
entropies:355.0323486328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1072471141815186 seconds
19 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
19 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(1.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8873, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
18 gae_duplicate tensor(-0.0016, dtype=torch.float64) tensor(-0.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8877, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
17 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-0.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8881, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
16 gae_duplicate tensor(-0.0164, dtype=torch.float64) tensor(-0.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8886, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
15 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(0.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8890, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
14 gae_duplicate tensor(-0.0294, dtype=torch.float64) tensor(-0.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
13 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(0.0661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8899, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
12 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(0.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8533, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
11 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(-0.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6124, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
10 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(0.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
9 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(0.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
8 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(-1.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2033, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
7 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(0.4341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4811, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
6 gae_duplicate tensor(-0.5408, dtype=torch.float64) tensor(1.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8521, dtype=torch.float64) delta_t tensor(0.1713, dtype=torch.float64)
5 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(-3.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-1.6868, dtype=torch.float64) delta_t tensor(-0.2017, dtype=torch.float64)
4 gae_duplicate tensor(-0.5748, dtype=torch.float64) tensor(3.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7815, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
3 gae_duplicate tensor(-0.2284, dtype=torch.float64) tensor(-0.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.5611, dtype=torch.float64) delta_t tensor(-0.1057, dtype=torch.float64)
2 gae_duplicate tensor(-0.2816, dtype=torch.float64) tensor(2.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-348.4256591796875
value loss:3.2046868801116943
entropies:355.00634765625
Policy training finished
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt