obs <crafter.objects.Shelter object at 0x13e062640> [39.  0.  0.  0. 39.  0.  0.  0. 18.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13e062af0> [40.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13e062eb0> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13e062640> [39.  0.  0.  0. 39.  0.  0.  0. 16.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13e062af0> [39.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13e062eb0> [9. 0. 0. 0. 9. 0. 0. 0. 6. 0. 0. 0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0020301342010498047 seconds
19 rew tensor(1.1311, dtype=torch.float64) delta_t tensor(1.0414, dtype=torch.float64)
19 gae_duplicate tensor(0.9500, dtype=torch.float64) tensor(-20.6391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1881, dtype=torch.float64) delta_t tensor(1.1094, dtype=torch.float64)
18 gae_duplicate tensor(1.0462, dtype=torch.float64) tensor(-24.1748, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2124, dtype=torch.float64) delta_t tensor(1.0912, dtype=torch.float64)
17 gae_duplicate tensor(0.8182, dtype=torch.float64) tensor(-23.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.2256, dtype=torch.float64) delta_t tensor(1.0551, dtype=torch.float64)
16 gae_duplicate tensor(1.0013, dtype=torch.float64) tensor(-22.3205, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.3206, dtype=torch.float64) delta_t tensor(1.2086, dtype=torch.float64)
15 gae_duplicate tensor(0.8975, dtype=torch.float64) tensor(-25.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8870, dtype=torch.float64) delta_t tensor(0.7712, dtype=torch.float64)
14 gae_duplicate tensor(-1.3497, dtype=torch.float64) tensor(-18.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1672, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
13 gae_duplicate tensor(-1.9189, dtype=torch.float64) tensor(-2.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0009, dtype=torch.float64) delta_t tensor(0.8640, dtype=torch.float64)
12 gae_duplicate tensor(0.6213, dtype=torch.float64) tensor(-17.6037, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0706, dtype=torch.float64) delta_t tensor(0.9612, dtype=torch.float64)
11 gae_duplicate tensor(0.4893, dtype=torch.float64) tensor(-20.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.7838, dtype=torch.float64)
10 gae_duplicate tensor(0.5871, dtype=torch.float64) tensor(-17.2085, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.0509, dtype=torch.float64) delta_t tensor(1.0965, dtype=torch.float64)
9 gae_duplicate tensor(0.3094, dtype=torch.float64) tensor(-22.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
8 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-4.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1612, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
7 gae_duplicate tensor(-0.6843, dtype=torch.float64) tensor(-3.2492, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
6 gae_duplicate tensor(-0.7436, dtype=torch.float64) tensor(-1.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.5668, dtype=torch.float64) delta_t tensor(-0.5915, dtype=torch.float64)
5 gae_duplicate tensor(-0.8930, dtype=torch.float64) tensor(11.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5151, dtype=torch.float64) delta_t tensor(0.4974, dtype=torch.float64)
4 gae_duplicate tensor(-0.8940, dtype=torch.float64) tensor(-8.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0149, dtype=torch.float64) delta_t tensor(-0.0736, dtype=torch.float64)
3 gae_duplicate tensor(-0.8203, dtype=torch.float64) tensor(0.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8060, dtype=torch.float64) delta_t tensor(0.8379, dtype=torch.float64)
2 gae_duplicate tensor(-0.5596, dtype=torch.float64) tensor(-16.6837, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:12721.3427734375
value loss:169.5819854736328
entropies:354.4415588378906
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.007840871810913 seconds
19 rew tensor(1.1530, dtype=torch.float64) delta_t tensor(1.0521, dtype=torch.float64)
19 gae_duplicate tensor(0.8321, dtype=torch.float64) tensor(-19.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1894, dtype=torch.float64) delta_t tensor(1.1074, dtype=torch.float64)
18 gae_duplicate tensor(1.0171, dtype=torch.float64) tensor(-24.6205, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1294, dtype=torch.float64) delta_t tensor(1.0194, dtype=torch.float64)
17 gae_duplicate tensor(0.9115, dtype=torch.float64) tensor(-21.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0431, dtype=torch.float64) delta_t tensor(0.8791, dtype=torch.float64)
16 gae_duplicate tensor(0.6957, dtype=torch.float64) tensor(-19.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.5891, dtype=torch.float64)
15 gae_duplicate tensor(-0.9859, dtype=torch.float64) tensor(-13.5854, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8712, dtype=torch.float64) delta_t tensor(0.7082, dtype=torch.float64)
14 gae_duplicate tensor(0.6528, dtype=torch.float64) tensor(-14.7226, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7415, dtype=torch.float64) delta_t tensor(0.6846, dtype=torch.float64)
13 gae_duplicate tensor(-0.4530, dtype=torch.float64) tensor(-15.2767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.2729, dtype=torch.float64)
12 gae_duplicate tensor(0.0995, dtype=torch.float64) tensor(-6.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7768, dtype=torch.float64) delta_t tensor(0.6919, dtype=torch.float64)
11 gae_duplicate tensor(0.4068, dtype=torch.float64) tensor(-14.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2422, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
10 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-3.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6023, dtype=torch.float64) delta_t tensor(0.6452, dtype=torch.float64)
9 gae_duplicate tensor(0.3985, dtype=torch.float64) tensor(-13.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3706, dtype=torch.float64) delta_t tensor(-0.5276, dtype=torch.float64)
8 gae_duplicate tensor(-0.9275, dtype=torch.float64) tensor(9.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8748, dtype=torch.float64) delta_t tensor(-0.8869, dtype=torch.float64)
7 gae_duplicate tensor(-2.7998, dtype=torch.float64) tensor(17.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7440, dtype=torch.float64) delta_t tensor(-0.6826, dtype=torch.float64)
6 gae_duplicate tensor(-1.4027, dtype=torch.float64) tensor(15.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0411, dtype=torch.float64) delta_t tensor(-0.9537, dtype=torch.float64)
5 gae_duplicate tensor(-1.3894, dtype=torch.float64) tensor(19.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1315, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
4 gae_duplicate tensor(-0.5513, dtype=torch.float64) tensor(-0.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9459, dtype=torch.float64) delta_t tensor(-1.0391, dtype=torch.float64)
3 gae_duplicate tensor(-2.3090, dtype=torch.float64) tensor(20.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4437, dtype=torch.float64) delta_t tensor(0.4536, dtype=torch.float64)
2 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-6.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:4787.94140625
value loss:136.97789001464844
entropies:353.7034606933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.180436134338379 seconds
19 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(0.9898, dtype=torch.float64)
19 gae_duplicate tensor(0.7456, dtype=torch.float64) tensor(-19.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1619, dtype=torch.float64) delta_t tensor(1.0491, dtype=torch.float64)
18 gae_duplicate tensor(0.9376, dtype=torch.float64) tensor(-22.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7869, dtype=torch.float64) delta_t tensor(0.6555, dtype=torch.float64)
17 gae_duplicate tensor(-0.6755, dtype=torch.float64) tensor(-14.4605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8070, dtype=torch.float64) delta_t tensor(0.5887, dtype=torch.float64)
16 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(-12.9987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9174, dtype=torch.float64) delta_t tensor(0.8023, dtype=torch.float64)
15 gae_duplicate tensor(0.6404, dtype=torch.float64) tensor(-16.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7582, dtype=torch.float64) delta_t tensor(0.5649, dtype=torch.float64)
14 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-12.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7917, dtype=torch.float64) delta_t tensor(0.6839, dtype=torch.float64)
13 gae_duplicate tensor(0.5312, dtype=torch.float64) tensor(-14.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4054, dtype=torch.float64) delta_t tensor(0.2992, dtype=torch.float64)
12 gae_duplicate tensor(0.0809, dtype=torch.float64) tensor(-7.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.6563, dtype=torch.float64)
11 gae_duplicate tensor(0.4239, dtype=torch.float64) tensor(-13.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0513, dtype=torch.float64) delta_t tensor(-0.2070, dtype=torch.float64)
10 gae_duplicate tensor(-0.6725, dtype=torch.float64) tensor(2.6024, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.5863, dtype=torch.float64)
9 gae_duplicate tensor(0.3616, dtype=torch.float64) tensor(-11.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4298, dtype=torch.float64) delta_t tensor(-0.5787, dtype=torch.float64)
8 gae_duplicate tensor(-0.7949, dtype=torch.float64) tensor(10.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3802, dtype=torch.float64) delta_t tensor(-1.3364, dtype=torch.float64)
7 gae_duplicate tensor(-3.1630, dtype=torch.float64) tensor(26.1687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6973, dtype=torch.float64) delta_t tensor(-0.6621, dtype=torch.float64)
6 gae_duplicate tensor(-0.9741, dtype=torch.float64) tensor(14.9589, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2553, dtype=torch.float64) delta_t tensor(-1.2368, dtype=torch.float64)
5 gae_duplicate tensor(-1.9359, dtype=torch.float64) tensor(24.7279, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
4 gae_duplicate tensor(-0.5063, dtype=torch.float64) tensor(-0.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1702, dtype=torch.float64) delta_t tensor(-1.2745, dtype=torch.float64)
3 gae_duplicate tensor(-2.1914, dtype=torch.float64) tensor(25.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4897, dtype=torch.float64) delta_t tensor(0.5035, dtype=torch.float64)
2 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-7.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2534.993896484375
value loss:147.91464233398438
entropies:352.90557861328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.118234872817993 seconds
19 rew tensor(1.0347, dtype=torch.float64) delta_t tensor(0.9335, dtype=torch.float64)
19 gae_duplicate tensor(0.7749, dtype=torch.float64) tensor(-18.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0431, dtype=torch.float64) delta_t tensor(0.9506, dtype=torch.float64)
18 gae_duplicate tensor(0.8408, dtype=torch.float64) tensor(-19.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0126, dtype=torch.float64) delta_t tensor(0.9197, dtype=torch.float64)
17 gae_duplicate tensor(0.8578, dtype=torch.float64) tensor(-19.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9478, dtype=torch.float64) delta_t tensor(0.7731, dtype=torch.float64)
16 gae_duplicate tensor(0.4502, dtype=torch.float64) tensor(-16.3622, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(0.8184, dtype=torch.float64)
15 gae_duplicate tensor(0.7134, dtype=torch.float64) tensor(-18.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7065, dtype=torch.float64) delta_t tensor(0.5259, dtype=torch.float64)
14 gae_duplicate tensor(0.4415, dtype=torch.float64) tensor(-12.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8566, dtype=torch.float64) delta_t tensor(0.7075, dtype=torch.float64)
13 gae_duplicate tensor(0.6126, dtype=torch.float64) tensor(-15.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
12 gae_duplicate tensor(-0.0320, dtype=torch.float64) tensor(-5.1249, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4986, dtype=torch.float64) delta_t tensor(0.2481, dtype=torch.float64)
11 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-5.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(-0.1380, dtype=torch.float64)
10 gae_duplicate tensor(-0.2993, dtype=torch.float64) tensor(2.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3369, dtype=torch.float64) delta_t tensor(0.2595, dtype=torch.float64)
9 gae_duplicate tensor(0.1558, dtype=torch.float64) tensor(-5.2069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3085, dtype=torch.float64) delta_t tensor(-0.4619, dtype=torch.float64)
8 gae_duplicate tensor(-1.1011, dtype=torch.float64) tensor(8.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4919, dtype=torch.float64) delta_t tensor(-0.5803, dtype=torch.float64)
7 gae_duplicate tensor(-1.0564, dtype=torch.float64) tensor(12.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3746, dtype=torch.float64) delta_t tensor(-0.4208, dtype=torch.float64)
6 gae_duplicate tensor(-1.1022, dtype=torch.float64) tensor(9.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3810, dtype=torch.float64) delta_t tensor(-1.3568, dtype=torch.float64)
5 gae_duplicate tensor(-1.8123, dtype=torch.float64) tensor(28.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0386, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
4 gae_duplicate tensor(-0.6367, dtype=torch.float64) tensor(3.1230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7449, dtype=torch.float64) delta_t tensor(-0.8137, dtype=torch.float64)
3 gae_duplicate tensor(-1.2060, dtype=torch.float64) tensor(16.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2852, dtype=torch.float64) delta_t tensor(0.2943, dtype=torch.float64)
2 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-4.0914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3145.843017578125
value loss:92.021240234375
entropies:352.0674743652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.022251605987549 seconds
19 rew tensor(1.1748, dtype=torch.float64) delta_t tensor(1.0532, dtype=torch.float64)
19 gae_duplicate tensor(0.8267, dtype=torch.float64) tensor(-20.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1525, dtype=torch.float64) delta_t tensor(0.9918, dtype=torch.float64)
18 gae_duplicate tensor(0.8993, dtype=torch.float64) tensor(-20.5491, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0847, dtype=torch.float64) delta_t tensor(0.9915, dtype=torch.float64)
17 gae_duplicate tensor(0.7219, dtype=torch.float64) tensor(-22.4661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0912, dtype=torch.float64) delta_t tensor(0.9268, dtype=torch.float64)
16 gae_duplicate tensor(0.7361, dtype=torch.float64) tensor(-21.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9978, dtype=torch.float64) delta_t tensor(0.8506, dtype=torch.float64)
15 gae_duplicate tensor(0.7425, dtype=torch.float64) tensor(-18.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9380, dtype=torch.float64) delta_t tensor(0.7572, dtype=torch.float64)
14 gae_duplicate tensor(0.5046, dtype=torch.float64) tensor(-17.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3291, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
13 gae_duplicate tensor(-0.9932, dtype=torch.float64) tensor(-5.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0639, dtype=torch.float64) delta_t tensor(-0.2548, dtype=torch.float64)
12 gae_duplicate tensor(-1.2153, dtype=torch.float64) tensor(4.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.2923, dtype=torch.float64)
11 gae_duplicate tensor(0.0970, dtype=torch.float64) tensor(-5.1505, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0838, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
10 gae_duplicate tensor(-0.2637, dtype=torch.float64) tensor(1.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6432, dtype=torch.float64) delta_t tensor(0.5658, dtype=torch.float64)
9 gae_duplicate tensor(0.1980, dtype=torch.float64) tensor(-10.8558, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5082, dtype=torch.float64) delta_t tensor(-0.6606, dtype=torch.float64)
8 gae_duplicate tensor(-1.1028, dtype=torch.float64) tensor(11.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6084, dtype=torch.float64) delta_t tensor(-0.6576, dtype=torch.float64)
7 gae_duplicate tensor(-1.3512, dtype=torch.float64) tensor(15.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6383, dtype=torch.float64) delta_t tensor(-0.7094, dtype=torch.float64)
6 gae_duplicate tensor(-1.3642, dtype=torch.float64) tensor(15.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3729, dtype=torch.float64) delta_t tensor(-1.3182, dtype=torch.float64)
5 gae_duplicate tensor(-1.8421, dtype=torch.float64) tensor(27.2463, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0168, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
4 gae_duplicate tensor(-0.6006, dtype=torch.float64) tensor(2.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9791, dtype=torch.float64) delta_t tensor(-1.1026, dtype=torch.float64)
3 gae_duplicate tensor(-1.8125, dtype=torch.float64) tensor(20.8920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3503, dtype=torch.float64) delta_t tensor(0.3644, dtype=torch.float64)
2 gae_duplicate tensor(-0.2365, dtype=torch.float64) tensor(-4.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2457.027099609375
value loss:127.12968444824219
entropies:351.1889343261719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3987.0520)
ToM Target loss= tensor(3834.2197)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.29232382774353 seconds
19 rew tensor(1.1279, dtype=torch.float64) delta_t tensor(0.9213, dtype=torch.float64)
19 gae_duplicate tensor(0.7766, dtype=torch.float64) tensor(-17.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1619, dtype=torch.float64) delta_t tensor(0.9956, dtype=torch.float64)
18 gae_duplicate tensor(0.9253, dtype=torch.float64) tensor(-23.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0279, dtype=torch.float64) delta_t tensor(0.8522, dtype=torch.float64)
17 gae_duplicate tensor(0.8314, dtype=torch.float64) tensor(-20.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9952, dtype=torch.float64) delta_t tensor(0.7096, dtype=torch.float64)
16 gae_duplicate tensor(0.5151, dtype=torch.float64) tensor(-15.6269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8538, dtype=torch.float64) delta_t tensor(0.6706, dtype=torch.float64)
15 gae_duplicate tensor(0.5747, dtype=torch.float64) tensor(-15.0233, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4622, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
14 gae_duplicate tensor(-1.1507, dtype=torch.float64) tensor(-6.2339, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
13 gae_duplicate tensor(0.4675, dtype=torch.float64) tensor(-11.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3144, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
12 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-3.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5195, dtype=torch.float64) delta_t tensor(0.3590, dtype=torch.float64)
11 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(-7.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0370, dtype=torch.float64) delta_t tensor(-0.1780, dtype=torch.float64)
10 gae_duplicate tensor(-0.5399, dtype=torch.float64) tensor(2.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4019, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
9 gae_duplicate tensor(0.0330, dtype=torch.float64) tensor(-6.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4799, dtype=torch.float64) delta_t tensor(-0.6550, dtype=torch.float64)
8 gae_duplicate tensor(-0.9162, dtype=torch.float64) tensor(11.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1641, dtype=torch.float64) delta_t tensor(-1.1720, dtype=torch.float64)
7 gae_duplicate tensor(-4.5095, dtype=torch.float64) tensor(23.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7039, dtype=torch.float64) delta_t tensor(-0.6740, dtype=torch.float64)
6 gae_duplicate tensor(-1.1899, dtype=torch.float64) tensor(15.4023, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3128, dtype=torch.float64) delta_t tensor(-1.2492, dtype=torch.float64)
5 gae_duplicate tensor(-2.0305, dtype=torch.float64) tensor(24.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0799, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
4 gae_duplicate tensor(-0.8323, dtype=torch.float64) tensor(1.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0102, dtype=torch.float64) delta_t tensor(-1.1072, dtype=torch.float64)
3 gae_duplicate tensor(-2.7295, dtype=torch.float64) tensor(20.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4380, dtype=torch.float64) delta_t tensor(0.4591, dtype=torch.float64)
2 gae_duplicate tensor(-0.3807, dtype=torch.float64) tensor(-6.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1665.7286376953125
value loss:144.3253936767578
entropies:350.8736572265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859117031097412 seconds
19 rew tensor(1.1090, dtype=torch.float64) delta_t tensor(0.9747, dtype=torch.float64)
19 gae_duplicate tensor(0.8381, dtype=torch.float64) tensor(-18.9995, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1434, dtype=torch.float64) delta_t tensor(1.0301, dtype=torch.float64)
18 gae_duplicate tensor(1.0415, dtype=torch.float64) tensor(-21.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0778, dtype=torch.float64) delta_t tensor(0.9733, dtype=torch.float64)
17 gae_duplicate tensor(0.8784, dtype=torch.float64) tensor(-20.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0103, dtype=torch.float64) delta_t tensor(0.7019, dtype=torch.float64)
16 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-16.5660, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9465, dtype=torch.float64) delta_t tensor(0.7635, dtype=torch.float64)
15 gae_duplicate tensor(0.6619, dtype=torch.float64) tensor(-16.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.6040, dtype=torch.float64)
14 gae_duplicate tensor(0.2905, dtype=torch.float64) tensor(-12.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3837, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
13 gae_duplicate tensor(-0.6695, dtype=torch.float64) tensor(-6.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1354, dtype=torch.float64) delta_t tensor(-0.3989, dtype=torch.float64)
12 gae_duplicate tensor(-2.1669, dtype=torch.float64) tensor(8.5104, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1054, dtype=torch.float64) delta_t tensor(-0.2599, dtype=torch.float64)
11 gae_duplicate tensor(-2.6074, dtype=torch.float64) tensor(5.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3051, dtype=torch.float64) delta_t tensor(-0.5379, dtype=torch.float64)
10 gae_duplicate tensor(-1.4622, dtype=torch.float64) tensor(10.5353, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5433, dtype=torch.float64) delta_t tensor(0.4797, dtype=torch.float64)
9 gae_duplicate tensor(0.0575, dtype=torch.float64) tensor(-7.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6282, dtype=torch.float64) delta_t tensor(-0.8262, dtype=torch.float64)
8 gae_duplicate tensor(-1.0529, dtype=torch.float64) tensor(15.2973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1375, dtype=torch.float64) delta_t tensor(-0.2380, dtype=torch.float64)
7 gae_duplicate tensor(-0.7803, dtype=torch.float64) tensor(6.9797, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8187, dtype=torch.float64) delta_t tensor(-0.8241, dtype=torch.float64)
6 gae_duplicate tensor(-1.1724, dtype=torch.float64) tensor(15.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1116, dtype=torch.float64) delta_t tensor(-1.1222, dtype=torch.float64)
5 gae_duplicate tensor(-1.6889, dtype=torch.float64) tensor(22.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2982, dtype=torch.float64) delta_t tensor(-0.2709, dtype=torch.float64)
4 gae_duplicate tensor(-0.8823, dtype=torch.float64) tensor(7.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(-0.6118, dtype=torch.float64)
3 gae_duplicate tensor(-1.5749, dtype=torch.float64) tensor(12.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0170, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
2 gae_duplicate tensor(-0.5344, dtype=torch.float64) tensor(0.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:783.011474609375
value loss:122.40748596191406
entropies:350.91387939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.4358460903167725 seconds
19 rew tensor(1.1129, dtype=torch.float64) delta_t tensor(0.9380, dtype=torch.float64)
19 gae_duplicate tensor(0.7030, dtype=torch.float64) tensor(-18.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0911, dtype=torch.float64) delta_t tensor(0.9358, dtype=torch.float64)
18 gae_duplicate tensor(0.8837, dtype=torch.float64) tensor(-19.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0576, dtype=torch.float64) delta_t tensor(0.9342, dtype=torch.float64)
17 gae_duplicate tensor(0.8099, dtype=torch.float64) tensor(-19.2802, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0403, dtype=torch.float64) delta_t tensor(0.8138, dtype=torch.float64)
16 gae_duplicate tensor(0.7146, dtype=torch.float64) tensor(-17.1254, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.7189, dtype=torch.float64)
15 gae_duplicate tensor(0.3739, dtype=torch.float64) tensor(-15.3852, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.6368, dtype=torch.float64)
14 gae_duplicate tensor(0.5467, dtype=torch.float64) tensor(-13.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(0.0539, dtype=torch.float64)
13 gae_duplicate tensor(-0.9370, dtype=torch.float64) tensor(-2.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4564, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
12 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(-4.3565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2835, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
11 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-1.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0366, dtype=torch.float64) delta_t tensor(-0.2116, dtype=torch.float64)
10 gae_duplicate tensor(-0.4635, dtype=torch.float64) tensor(3.8644, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2695, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
9 gae_duplicate tensor(-0.1932, dtype=torch.float64) tensor(-4.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2717, dtype=torch.float64) delta_t tensor(-0.4456, dtype=torch.float64)
8 gae_duplicate tensor(-0.7059, dtype=torch.float64) tensor(7.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0621, dtype=torch.float64) delta_t tensor(-1.0661, dtype=torch.float64)
7 gae_duplicate tensor(-1.4883, dtype=torch.float64) tensor(21.4352, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5405, dtype=torch.float64) delta_t tensor(-0.5422, dtype=torch.float64)
6 gae_duplicate tensor(-0.9935, dtype=torch.float64) tensor(12.1870, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5683, dtype=torch.float64) delta_t tensor(-1.4238, dtype=torch.float64)
5 gae_duplicate tensor(-1.9437, dtype=torch.float64) tensor(29.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1212, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
4 gae_duplicate tensor(-0.8398, dtype=torch.float64) tensor(1.1961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0186, dtype=torch.float64) delta_t tensor(-1.1484, dtype=torch.float64)
3 gae_duplicate tensor(-1.6839, dtype=torch.float64) tensor(22.6652, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4028, dtype=torch.float64) delta_t tensor(0.4480, dtype=torch.float64)
2 gae_duplicate tensor(-0.6071, dtype=torch.float64) tensor(-6.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1212.4403076171875
value loss:116.36331176757812
entropies:350.85333251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.4996559619903564 seconds
19 rew tensor(1.0905, dtype=torch.float64) delta_t tensor(0.8635, dtype=torch.float64)
19 gae_duplicate tensor(0.8042, dtype=torch.float64) tensor(-17.3327, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8177, dtype=torch.float64) delta_t tensor(0.6364, dtype=torch.float64)
18 gae_duplicate tensor(-0.5262, dtype=torch.float64) tensor(-13.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0026, dtype=torch.float64) delta_t tensor(0.8153, dtype=torch.float64)
17 gae_duplicate tensor(0.4784, dtype=torch.float64) tensor(-17.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.6458, dtype=torch.float64)
16 gae_duplicate tensor(0.4232, dtype=torch.float64) tensor(-13.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8734, dtype=torch.float64) delta_t tensor(0.6784, dtype=torch.float64)
15 gae_duplicate tensor(0.5005, dtype=torch.float64) tensor(-14.3465, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6210, dtype=torch.float64) delta_t tensor(0.3848, dtype=torch.float64)
14 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-9.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8019, dtype=torch.float64) delta_t tensor(0.5821, dtype=torch.float64)
13 gae_duplicate tensor(0.4531, dtype=torch.float64) tensor(-11.6752, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2839, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
12 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-1.8138, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5081, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
11 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-5.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0889, dtype=torch.float64) delta_t tensor(-0.3449, dtype=torch.float64)
10 gae_duplicate tensor(-0.6198, dtype=torch.float64) tensor(6.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3029, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
9 gae_duplicate tensor(0.0236, dtype=torch.float64) tensor(-3.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3610, dtype=torch.float64) delta_t tensor(-0.5608, dtype=torch.float64)
8 gae_duplicate tensor(-0.6892, dtype=torch.float64) tensor(10.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5718, dtype=torch.float64) delta_t tensor(-0.6681, dtype=torch.float64)
7 gae_duplicate tensor(-1.2744, dtype=torch.float64) tensor(13.4092, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5344, dtype=torch.float64) delta_t tensor(-0.6251, dtype=torch.float64)
6 gae_duplicate tensor(-1.3241, dtype=torch.float64) tensor(13.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4360, dtype=torch.float64) delta_t tensor(-1.3406, dtype=torch.float64)
5 gae_duplicate tensor(-1.8061, dtype=torch.float64) tensor(27.5256, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1316, dtype=torch.float64) delta_t tensor(-0.1010, dtype=torch.float64)
4 gae_duplicate tensor(-0.8050, dtype=torch.float64) tensor(4.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.8420, dtype=torch.float64)
3 gae_duplicate tensor(-1.3715, dtype=torch.float64) tensor(17.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1783, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
2 gae_duplicate tensor(-0.5350, dtype=torch.float64) tensor(-2.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:872.6748657226562
value loss:87.44635772705078
entropies:350.56146240234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.291452169418335 seconds
19 rew tensor(1.1527, dtype=torch.float64) delta_t tensor(0.9031, dtype=torch.float64)
19 gae_duplicate tensor(0.6435, dtype=torch.float64) tensor(-17.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1597, dtype=torch.float64) delta_t tensor(0.9321, dtype=torch.float64)
18 gae_duplicate tensor(0.7397, dtype=torch.float64) tensor(-19.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0346, dtype=torch.float64) delta_t tensor(0.8735, dtype=torch.float64)
17 gae_duplicate tensor(0.6546, dtype=torch.float64) tensor(-18.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0262, dtype=torch.float64) delta_t tensor(0.6827, dtype=torch.float64)
16 gae_duplicate tensor(0.4272, dtype=torch.float64) tensor(-15.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9638, dtype=torch.float64) delta_t tensor(0.6862, dtype=torch.float64)
15 gae_duplicate tensor(0.5172, dtype=torch.float64) tensor(-14.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7762, dtype=torch.float64) delta_t tensor(0.5474, dtype=torch.float64)
14 gae_duplicate tensor(0.4061, dtype=torch.float64) tensor(-12.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(0.3374, dtype=torch.float64)
13 gae_duplicate tensor(-0.9585, dtype=torch.float64) tensor(-8.9314, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(-0.2136, dtype=torch.float64)
12 gae_duplicate tensor(-1.1370, dtype=torch.float64) tensor(3.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5684, dtype=torch.float64) delta_t tensor(0.3370, dtype=torch.float64)
11 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-6.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0599, dtype=torch.float64) delta_t tensor(-0.2837, dtype=torch.float64)
10 gae_duplicate tensor(-0.7156, dtype=torch.float64) tensor(4.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4319, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
9 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-5.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5503, dtype=torch.float64) delta_t tensor(-0.7608, dtype=torch.float64)
8 gae_duplicate tensor(-0.9725, dtype=torch.float64) tensor(14.2287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4766, dtype=torch.float64) delta_t tensor(-0.5693, dtype=torch.float64)
7 gae_duplicate tensor(-1.5393, dtype=torch.float64) tensor(11.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7702, dtype=torch.float64) delta_t tensor(-0.7538, dtype=torch.float64)
6 gae_duplicate tensor(-1.4317, dtype=torch.float64) tensor(16.5426, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2778, dtype=torch.float64) delta_t tensor(-1.2290, dtype=torch.float64)
5 gae_duplicate tensor(-1.8185, dtype=torch.float64) tensor(24.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1228, dtype=torch.float64) delta_t tensor(-0.1156, dtype=torch.float64)
4 gae_duplicate tensor(-1.0783, dtype=torch.float64) tensor(5.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8173, dtype=torch.float64) delta_t tensor(-0.8975, dtype=torch.float64)
3 gae_duplicate tensor(-2.0544, dtype=torch.float64) tensor(18.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2321, dtype=torch.float64) delta_t tensor(0.2551, dtype=torch.float64)
2 gae_duplicate tensor(-0.4805, dtype=torch.float64) tensor(-3.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1116.1827392578125
value loss:106.57958984375
entropies:350.525634765625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3945.3535)
ToM Target loss= tensor(3869.3328)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0469019412994385 seconds
19 rew tensor(1.0903, dtype=torch.float64) delta_t tensor(0.7755, dtype=torch.float64)
19 gae_duplicate tensor(0.7173, dtype=torch.float64) tensor(-14.9711, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1364, dtype=torch.float64) delta_t tensor(0.9379, dtype=torch.float64)
18 gae_duplicate tensor(0.8627, dtype=torch.float64) tensor(-21.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9947, dtype=torch.float64) delta_t tensor(0.8074, dtype=torch.float64)
17 gae_duplicate tensor(0.7264, dtype=torch.float64) tensor(-16.9546, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(0.6872, dtype=torch.float64)
16 gae_duplicate tensor(0.5662, dtype=torch.float64) tensor(-14.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8600, dtype=torch.float64) delta_t tensor(0.5649, dtype=torch.float64)
15 gae_duplicate tensor(0.5286, dtype=torch.float64) tensor(-12.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7353, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
14 gae_duplicate tensor(0.2584, dtype=torch.float64) tensor(-9.2432, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(0.4996, dtype=torch.float64)
13 gae_duplicate tensor(0.3341, dtype=torch.float64) tensor(-10.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2606, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
12 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(0.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
11 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-6.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0466, dtype=torch.float64) delta_t tensor(-0.2967, dtype=torch.float64)
10 gae_duplicate tensor(-0.5488, dtype=torch.float64) tensor(5.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4857, dtype=torch.float64) delta_t tensor(0.3925, dtype=torch.float64)
9 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-7.3591, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6280, dtype=torch.float64) delta_t tensor(-0.8340, dtype=torch.float64)
8 gae_duplicate tensor(-1.2953, dtype=torch.float64) tensor(16.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3866, dtype=torch.float64) delta_t tensor(-0.4670, dtype=torch.float64)
7 gae_duplicate tensor(-1.3871, dtype=torch.float64) tensor(11.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7958, dtype=torch.float64) delta_t tensor(-0.7355, dtype=torch.float64)
6 gae_duplicate tensor(-1.2402, dtype=torch.float64) tensor(14.7378, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1651, dtype=torch.float64) delta_t tensor(-1.0601, dtype=torch.float64)
5 gae_duplicate tensor(-1.6181, dtype=torch.float64) tensor(21.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2178, dtype=torch.float64) delta_t tensor(-0.2099, dtype=torch.float64)
4 gae_duplicate tensor(-0.9803, dtype=torch.float64) tensor(6.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5490, dtype=torch.float64) delta_t tensor(-0.6233, dtype=torch.float64)
3 gae_duplicate tensor(-1.8361, dtype=torch.float64) tensor(13.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1146, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
2 gae_duplicate tensor(-0.6732, dtype=torch.float64) tensor(-1.4470, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1304.779052734375
value loss:92.62330627441406
entropies:350.55816650390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.874020099639893 seconds
19 rew tensor(1.2073, dtype=torch.float64) delta_t tensor(0.7369, dtype=torch.float64)
19 gae_duplicate tensor(0.5261, dtype=torch.float64) tensor(-14.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8675, dtype=torch.float64) delta_t tensor(0.5583, dtype=torch.float64)
18 gae_duplicate tensor(-0.6801, dtype=torch.float64) tensor(-11.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0286, dtype=torch.float64) delta_t tensor(0.7337, dtype=torch.float64)
17 gae_duplicate tensor(0.4422, dtype=torch.float64) tensor(-16.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0013, dtype=torch.float64) delta_t tensor(0.5889, dtype=torch.float64)
16 gae_duplicate tensor(0.3509, dtype=torch.float64) tensor(-13.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(0.5355, dtype=torch.float64)
15 gae_duplicate tensor(0.4256, dtype=torch.float64) tensor(-11.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8113, dtype=torch.float64) delta_t tensor(0.5309, dtype=torch.float64)
14 gae_duplicate tensor(0.3433, dtype=torch.float64) tensor(-11.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4274, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
13 gae_duplicate tensor(-1.2336, dtype=torch.float64) tensor(-4.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3736, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
12 gae_duplicate tensor(-0.2799, dtype=torch.float64) tensor(-1.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4235, dtype=torch.float64) delta_t tensor(0.1755, dtype=torch.float64)
11 gae_duplicate tensor(-0.4355, dtype=torch.float64) tensor(-3.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0333, dtype=torch.float64) delta_t tensor(-0.3335, dtype=torch.float64)
10 gae_duplicate tensor(-0.5957, dtype=torch.float64) tensor(6.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2974, dtype=torch.float64) delta_t tensor(0.2372, dtype=torch.float64)
9 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-3.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4359, dtype=torch.float64) delta_t tensor(-0.6760, dtype=torch.float64)
8 gae_duplicate tensor(-0.8176, dtype=torch.float64) tensor(12.9898, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8138, dtype=torch.float64) delta_t tensor(-0.8837, dtype=torch.float64)
7 gae_duplicate tensor(-1.6134, dtype=torch.float64) tensor(18.8756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5325, dtype=torch.float64) delta_t tensor(-0.5918, dtype=torch.float64)
6 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(13.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6790, dtype=torch.float64) delta_t tensor(-1.4873, dtype=torch.float64)
5 gae_duplicate tensor(-2.1039, dtype=torch.float64) tensor(31.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0329, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
4 gae_duplicate tensor(-0.2842, dtype=torch.float64) tensor(3.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0954, dtype=torch.float64) delta_t tensor(-1.2166, dtype=torch.float64)
3 gae_duplicate tensor(-1.8912, dtype=torch.float64) tensor(24.6133, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2862, dtype=torch.float64) delta_t tensor(0.3119, dtype=torch.float64)
2 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-3.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-956.1961059570312
value loss:94.39472961425781
entropies:350.4024963378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.203218936920166 seconds
19 rew tensor(1.1888, dtype=torch.float64) delta_t tensor(0.7307, dtype=torch.float64)
19 gae_duplicate tensor(0.6252, dtype=torch.float64) tensor(-14.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2055, dtype=torch.float64) delta_t tensor(0.7585, dtype=torch.float64)
18 gae_duplicate tensor(0.7445, dtype=torch.float64) tensor(-15.9886, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0981, dtype=torch.float64) delta_t tensor(0.6833, dtype=torch.float64)
17 gae_duplicate tensor(0.5634, dtype=torch.float64) tensor(-14.7059, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0518, dtype=torch.float64) delta_t tensor(0.7012, dtype=torch.float64)
16 gae_duplicate tensor(0.4111, dtype=torch.float64) tensor(-14.7370, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9481, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
15 gae_duplicate tensor(0.4632, dtype=torch.float64) tensor(-12.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7932, dtype=torch.float64) delta_t tensor(0.4062, dtype=torch.float64)
14 gae_duplicate tensor(0.2958, dtype=torch.float64) tensor(-9.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4104, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
13 gae_duplicate tensor(-1.2540, dtype=torch.float64) tensor(-4.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3916, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
12 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-3.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3337, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
11 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(-1.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0152, dtype=torch.float64) delta_t tensor(-0.2696, dtype=torch.float64)
10 gae_duplicate tensor(-0.4548, dtype=torch.float64) tensor(5.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4086, dtype=torch.float64) delta_t tensor(0.3053, dtype=torch.float64)
9 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-6.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5004, dtype=torch.float64) delta_t tensor(-0.7311, dtype=torch.float64)
8 gae_duplicate tensor(-1.0145, dtype=torch.float64) tensor(13.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6948, dtype=torch.float64) delta_t tensor(-0.7726, dtype=torch.float64)
7 gae_duplicate tensor(-1.6287, dtype=torch.float64) tensor(17.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7916, dtype=torch.float64) delta_t tensor(-0.6717, dtype=torch.float64)
6 gae_duplicate tensor(-0.9643, dtype=torch.float64) tensor(15.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4003, dtype=torch.float64) delta_t tensor(-1.2506, dtype=torch.float64)
5 gae_duplicate tensor(-1.9454, dtype=torch.float64) tensor(25.2242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0386, dtype=torch.float64) delta_t tensor(-0.0355, dtype=torch.float64)
4 gae_duplicate tensor(-0.7066, dtype=torch.float64) tensor(3.1117, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9059, dtype=torch.float64) delta_t tensor(-1.0322, dtype=torch.float64)
3 gae_duplicate tensor(-2.2719, dtype=torch.float64) tensor(19.4321, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2067, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
2 gae_duplicate tensor(-0.7519, dtype=torch.float64) tensor(-2.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-141.11294555664062
value loss:95.18452453613281
entropies:350.13824462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859837293624878 seconds
19 rew tensor(1.1319, dtype=torch.float64) delta_t tensor(0.6526, dtype=torch.float64)
19 gae_duplicate tensor(0.4998, dtype=torch.float64) tensor(-12.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1366, dtype=torch.float64) delta_t tensor(0.7794, dtype=torch.float64)
18 gae_duplicate tensor(0.6384, dtype=torch.float64) tensor(-16.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0896, dtype=torch.float64) delta_t tensor(0.6860, dtype=torch.float64)
17 gae_duplicate tensor(0.5706, dtype=torch.float64) tensor(-14.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9472, dtype=torch.float64) delta_t tensor(0.5320, dtype=torch.float64)
16 gae_duplicate tensor(0.2083, dtype=torch.float64) tensor(-11.6346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9409, dtype=torch.float64) delta_t tensor(0.6140, dtype=torch.float64)
15 gae_duplicate tensor(0.5713, dtype=torch.float64) tensor(-13.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.4045, dtype=torch.float64)
14 gae_duplicate tensor(0.2952, dtype=torch.float64) tensor(-9.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8582, dtype=torch.float64) delta_t tensor(0.6191, dtype=torch.float64)
13 gae_duplicate tensor(0.1639, dtype=torch.float64) tensor(-12.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1504, dtype=torch.float64) delta_t tensor(-0.4923, dtype=torch.float64)
12 gae_duplicate tensor(-2.3305, dtype=torch.float64) tensor(8.0831, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1007, dtype=torch.float64) delta_t tensor(-0.4352, dtype=torch.float64)
11 gae_duplicate tensor(-3.8595, dtype=torch.float64) tensor(11.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0571, dtype=torch.float64) delta_t tensor(-0.1425, dtype=torch.float64)
10 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(3.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1815, dtype=torch.float64) delta_t tensor(0.0794, dtype=torch.float64)
9 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-1.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5280, dtype=torch.float64) delta_t tensor(-0.7590, dtype=torch.float64)
8 gae_duplicate tensor(-0.8614, dtype=torch.float64) tensor(13.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5253, dtype=torch.float64) delta_t tensor(-0.5931, dtype=torch.float64)
7 gae_duplicate tensor(-1.8044, dtype=torch.float64) tensor(12.3961, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6944, dtype=torch.float64) delta_t tensor(-0.6790, dtype=torch.float64)
6 gae_duplicate tensor(-1.2415, dtype=torch.float64) tensor(14.3051, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4556, dtype=torch.float64) delta_t tensor(-1.3593, dtype=torch.float64)
5 gae_duplicate tensor(-1.9618, dtype=torch.float64) tensor(26.6456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0530, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
4 gae_duplicate tensor(-0.3953, dtype=torch.float64) tensor(3.3507, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9863, dtype=torch.float64) delta_t tensor(-1.0475, dtype=torch.float64)
3 gae_duplicate tensor(-2.3503, dtype=torch.float64) tensor(21.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3260, dtype=torch.float64) delta_t tensor(0.3642, dtype=torch.float64)
2 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-4.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1156.3271484375
value loss:119.00852966308594
entropies:349.9837646484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.767169952392578 seconds
19 rew tensor(1.0841, dtype=torch.float64) delta_t tensor(0.6075, dtype=torch.float64)
19 gae_duplicate tensor(0.4070, dtype=torch.float64) tensor(-11.1839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0759, dtype=torch.float64) delta_t tensor(0.6866, dtype=torch.float64)
18 gae_duplicate tensor(0.4964, dtype=torch.float64) tensor(-15.2879, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0445, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
17 gae_duplicate tensor(0.5524, dtype=torch.float64) tensor(-14.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9551, dtype=torch.float64) delta_t tensor(0.6039, dtype=torch.float64)
16 gae_duplicate tensor(0.4120, dtype=torch.float64) tensor(-13.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8092, dtype=torch.float64) delta_t tensor(0.3532, dtype=torch.float64)
15 gae_duplicate tensor(0.2916, dtype=torch.float64) tensor(-8.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8301, dtype=torch.float64) delta_t tensor(0.5142, dtype=torch.float64)
14 gae_duplicate tensor(0.4258, dtype=torch.float64) tensor(-11.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
13 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(-5.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5347, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
12 gae_duplicate tensor(0.0546, dtype=torch.float64) tensor(-5.4605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3156, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
11 gae_duplicate tensor(-0.3262, dtype=torch.float64) tensor(-0.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1858, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
10 gae_duplicate tensor(-0.4578, dtype=torch.float64) tensor(0.7299, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0086, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
9 gae_duplicate tensor(-0.5142, dtype=torch.float64) tensor(1.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3452, dtype=torch.float64) delta_t tensor(-0.5756, dtype=torch.float64)
8 gae_duplicate tensor(-0.7673, dtype=torch.float64) tensor(11.4064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1222, dtype=torch.float64) delta_t tensor(-1.1767, dtype=torch.float64)
7 gae_duplicate tensor(-1.9670, dtype=torch.float64) tensor(24.5675, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4674, dtype=torch.float64) delta_t tensor(-0.4067, dtype=torch.float64)
6 gae_duplicate tensor(-0.8513, dtype=torch.float64) tensor(10.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8111, dtype=torch.float64) delta_t tensor(-1.6440, dtype=torch.float64)
5 gae_duplicate tensor(-2.2110, dtype=torch.float64) tensor(34.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1610, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
4 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(-0.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3077, dtype=torch.float64) delta_t tensor(-1.4234, dtype=torch.float64)
3 gae_duplicate tensor(-2.0772, dtype=torch.float64) tensor(28.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5247, dtype=torch.float64) delta_t tensor(0.5777, dtype=torch.float64)
2 gae_duplicate tensor(0.0816, dtype=torch.float64) tensor(-8.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-922.6702270507812
value loss:102.55133056640625
entropies:349.6537780761719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3925.8616)
ToM Target loss= tensor(3889.4658)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.090566873550415 seconds
19 rew tensor(1.1544, dtype=torch.float64) delta_t tensor(0.5987, dtype=torch.float64)
19 gae_duplicate tensor(0.3730, dtype=torch.float64) tensor(-11.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1365, dtype=torch.float64) delta_t tensor(0.6107, dtype=torch.float64)
18 gae_duplicate tensor(0.4884, dtype=torch.float64) tensor(-13.7329, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0161, dtype=torch.float64) delta_t tensor(0.5783, dtype=torch.float64)
17 gae_duplicate tensor(0.5200, dtype=torch.float64) tensor(-11.7581, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9174, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
16 gae_duplicate tensor(0.2792, dtype=torch.float64) tensor(-8.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4443, dtype=torch.float64)
15 gae_duplicate tensor(0.3765, dtype=torch.float64) tensor(-9.5422, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.3000, dtype=torch.float64)
14 gae_duplicate tensor(0.1697, dtype=torch.float64) tensor(-6.8283, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.4999, dtype=torch.float64)
13 gae_duplicate tensor(0.3676, dtype=torch.float64) tensor(-10.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1910, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
12 gae_duplicate tensor(-0.2625, dtype=torch.float64) tensor(2.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6183, dtype=torch.float64) delta_t tensor(0.3325, dtype=torch.float64)
11 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(-6.3753, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(-0.4283, dtype=torch.float64)
10 gae_duplicate tensor(-0.7583, dtype=torch.float64) tensor(8.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4282, dtype=torch.float64) delta_t tensor(0.2776, dtype=torch.float64)
9 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(-4.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(-0.9066, dtype=torch.float64)
8 gae_duplicate tensor(-1.2981, dtype=torch.float64) tensor(16.3711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2021, dtype=torch.float64) delta_t tensor(-0.3820, dtype=torch.float64)
7 gae_duplicate tensor(-1.6238, dtype=torch.float64) tensor(8.6814, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8195, dtype=torch.float64) delta_t tensor(-0.7073, dtype=torch.float64)
6 gae_duplicate tensor(-1.2778, dtype=torch.float64) tensor(14.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1822, dtype=torch.float64) delta_t tensor(-1.0428, dtype=torch.float64)
5 gae_duplicate tensor(-1.6840, dtype=torch.float64) tensor(20.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3011, dtype=torch.float64) delta_t tensor(-0.2901, dtype=torch.float64)
4 gae_duplicate tensor(-0.9519, dtype=torch.float64) tensor(7.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5571, dtype=torch.float64) delta_t tensor(-0.5635, dtype=torch.float64)
3 gae_duplicate tensor(-1.9582, dtype=torch.float64) tensor(11.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0537, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
2 gae_duplicate tensor(-0.4052, dtype=torch.float64) tensor(-0.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-391.197021484375
value loss:71.24070739746094
entropies:349.5558166503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.701039791107178 seconds
19 rew tensor(1.2086, dtype=torch.float64) delta_t tensor(0.5900, dtype=torch.float64)
19 gae_duplicate tensor(0.3839, dtype=torch.float64) tensor(-12.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2004, dtype=torch.float64) delta_t tensor(0.7567, dtype=torch.float64)
18 gae_duplicate tensor(0.5477, dtype=torch.float64) tensor(-16.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0773, dtype=torch.float64) delta_t tensor(0.4628, dtype=torch.float64)
17 gae_duplicate tensor(0.3153, dtype=torch.float64) tensor(-9.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0038, dtype=torch.float64) delta_t tensor(0.4910, dtype=torch.float64)
16 gae_duplicate tensor(0.2478, dtype=torch.float64) tensor(-10.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.5199, dtype=torch.float64)
15 gae_duplicate tensor(0.2758, dtype=torch.float64) tensor(-11.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2268, dtype=torch.float64) delta_t tensor(-0.1726, dtype=torch.float64)
14 gae_duplicate tensor(-2.7386, dtype=torch.float64) tensor(1.7189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.3173, dtype=torch.float64)
13 gae_duplicate tensor(-0.0907, dtype=torch.float64) tensor(-5.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3255, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
12 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(0.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4886, dtype=torch.float64) delta_t tensor(0.2026, dtype=torch.float64)
11 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(-4.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(-0.3191, dtype=torch.float64)
10 gae_duplicate tensor(-0.5516, dtype=torch.float64) tensor(5.9048, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4158, dtype=torch.float64) delta_t tensor(0.3048, dtype=torch.float64)
9 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-5.1875, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6026, dtype=torch.float64) delta_t tensor(-0.8666, dtype=torch.float64)
8 gae_duplicate tensor(-1.3424, dtype=torch.float64) tensor(16.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5311, dtype=torch.float64) delta_t tensor(-0.6511, dtype=torch.float64)
7 gae_duplicate tensor(-1.7488, dtype=torch.float64) tensor(14.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8020, dtype=torch.float64) delta_t tensor(-0.6950, dtype=torch.float64)
6 gae_duplicate tensor(-1.3255, dtype=torch.float64) tensor(15.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3079, dtype=torch.float64) delta_t tensor(-1.1009, dtype=torch.float64)
5 gae_duplicate tensor(-1.8268, dtype=torch.float64) tensor(22.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1759, dtype=torch.float64) delta_t tensor(-0.1373, dtype=torch.float64)
4 gae_duplicate tensor(-1.2034, dtype=torch.float64) tensor(5.6807, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7601, dtype=torch.float64) delta_t tensor(-0.8196, dtype=torch.float64)
3 gae_duplicate tensor(-2.3281, dtype=torch.float64) tensor(16.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2186, dtype=torch.float64) delta_t tensor(0.2781, dtype=torch.float64)
2 gae_duplicate tensor(-0.5655, dtype=torch.float64) tensor(-4.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1159.9981689453125
value loss:97.203369140625
entropies:349.5536193847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.90772008895874 seconds
19 rew tensor(1.1205, dtype=torch.float64) delta_t tensor(0.4689, dtype=torch.float64)
19 gae_duplicate tensor(0.1989, dtype=torch.float64) tensor(-9.4396, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1097, dtype=torch.float64) delta_t tensor(0.4914, dtype=torch.float64)
18 gae_duplicate tensor(0.4212, dtype=torch.float64) tensor(-10.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9816, dtype=torch.float64) delta_t tensor(0.4453, dtype=torch.float64)
17 gae_duplicate tensor(0.3429, dtype=torch.float64) tensor(-9.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9367, dtype=torch.float64) delta_t tensor(0.4346, dtype=torch.float64)
16 gae_duplicate tensor(0.2378, dtype=torch.float64) tensor(-9.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.4043, dtype=torch.float64)
15 gae_duplicate tensor(0.3732, dtype=torch.float64) tensor(-8.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5272, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
14 gae_duplicate tensor(-1.1880, dtype=torch.float64) tensor(-2.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7571, dtype=torch.float64) delta_t tensor(0.4127, dtype=torch.float64)
13 gae_duplicate tensor(0.2017, dtype=torch.float64) tensor(-7.9137, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3311, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
12 gae_duplicate tensor(-0.3086, dtype=torch.float64) tensor(0.4683, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5122, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
11 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(-1.5426, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0036, dtype=torch.float64) delta_t tensor(-0.3123, dtype=torch.float64)
10 gae_duplicate tensor(-0.4762, dtype=torch.float64) tensor(5.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1815, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
9 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4927, dtype=torch.float64) delta_t tensor(-0.7525, dtype=torch.float64)
8 gae_duplicate tensor(-0.9288, dtype=torch.float64) tensor(13.9588, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6319, dtype=torch.float64) delta_t tensor(-0.7404, dtype=torch.float64)
7 gae_duplicate tensor(-1.4691, dtype=torch.float64) tensor(17.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6004, dtype=torch.float64) delta_t tensor(-0.6192, dtype=torch.float64)
6 gae_duplicate tensor(-1.0153, dtype=torch.float64) tensor(13.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5756, dtype=torch.float64) delta_t tensor(-1.3004, dtype=torch.float64)
5 gae_duplicate tensor(-1.7860, dtype=torch.float64) tensor(25.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0803, dtype=torch.float64) delta_t tensor(-8.5414e-05, dtype=torch.float64)
4 gae_duplicate tensor(-0.3823, dtype=torch.float64) tensor(2.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9600, dtype=torch.float64) delta_t tensor(-1.0090, dtype=torch.float64)
3 gae_duplicate tensor(-1.8468, dtype=torch.float64) tensor(19.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2885, dtype=torch.float64) delta_t tensor(0.3436, dtype=torch.float64)
2 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-4.4806, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1956.5164794921875
value loss:68.84416198730469
entropies:349.6942138671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.784090757369995 seconds
19 rew tensor(1.1456, dtype=torch.float64) delta_t tensor(0.3695, dtype=torch.float64)
19 gae_duplicate tensor(0.1762, dtype=torch.float64) tensor(-7.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1358, dtype=torch.float64) delta_t tensor(0.5496, dtype=torch.float64)
18 gae_duplicate tensor(0.4540, dtype=torch.float64) tensor(-11.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0180, dtype=torch.float64) delta_t tensor(0.4200, dtype=torch.float64)
17 gae_duplicate tensor(0.3133, dtype=torch.float64) tensor(-9.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0111, dtype=torch.float64) delta_t tensor(0.4639, dtype=torch.float64)
16 gae_duplicate tensor(0.1766, dtype=torch.float64) tensor(-9.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
15 gae_duplicate tensor(0.0620, dtype=torch.float64) tensor(-6.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7541, dtype=torch.float64) delta_t tensor(0.3126, dtype=torch.float64)
14 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-6.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5920, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
13 gae_duplicate tensor(0.1699, dtype=torch.float64) tensor(-4.3750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3399, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
12 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(0.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4633, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
11 gae_duplicate tensor(-0.3829, dtype=torch.float64) tensor(-2.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0077, dtype=torch.float64) delta_t tensor(-0.2212, dtype=torch.float64)
10 gae_duplicate tensor(-0.5035, dtype=torch.float64) tensor(4.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2862, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
9 gae_duplicate tensor(-0.2446, dtype=torch.float64) tensor(-3.7591, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5114, dtype=torch.float64) delta_t tensor(-0.7782, dtype=torch.float64)
8 gae_duplicate tensor(-1.1544, dtype=torch.float64) tensor(15.3729, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0720, dtype=torch.float64) delta_t tensor(-1.0536, dtype=torch.float64)
7 gae_duplicate tensor(-1.6885, dtype=torch.float64) tensor(21.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6235, dtype=torch.float64) delta_t tensor(-0.4390, dtype=torch.float64)
6 gae_duplicate tensor(-0.7938, dtype=torch.float64) tensor(11.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6959, dtype=torch.float64) delta_t tensor(-1.3694, dtype=torch.float64)
5 gae_duplicate tensor(-1.9405, dtype=torch.float64) tensor(27.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.2313, dtype=torch.float64)
4 gae_duplicate tensor(-0.6407, dtype=torch.float64) tensor(-1.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3326, dtype=torch.float64) delta_t tensor(-1.4527, dtype=torch.float64)
3 gae_duplicate tensor(-2.0649, dtype=torch.float64) tensor(26.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5859, dtype=torch.float64) delta_t tensor(0.6744, dtype=torch.float64)
2 gae_duplicate tensor(-0.1309, dtype=torch.float64) tensor(-10.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2011.1505126953125
value loss:88.22132110595703
entropies:349.994873046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.357784986495972 seconds
19 rew tensor(1.1811, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
19 gae_duplicate tensor(0.0578, dtype=torch.float64) tensor(-8.1261, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2248, dtype=torch.float64) delta_t tensor(0.5471, dtype=torch.float64)
18 gae_duplicate tensor(0.4371, dtype=torch.float64) tensor(-11.3171, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0667, dtype=torch.float64) delta_t tensor(0.5551, dtype=torch.float64)
17 gae_duplicate tensor(0.4727, dtype=torch.float64) tensor(-11.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0186, dtype=torch.float64) delta_t tensor(0.4672, dtype=torch.float64)
16 gae_duplicate tensor(0.4113, dtype=torch.float64) tensor(-11.1121, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9253, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
15 gae_duplicate tensor(0.3200, dtype=torch.float64) tensor(-9.1413, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8129, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
14 gae_duplicate tensor(0.1348, dtype=torch.float64) tensor(-6.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4055, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
13 gae_duplicate tensor(-1.3608, dtype=torch.float64) tensor(-0.6211, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
12 gae_duplicate tensor(-0.3199, dtype=torch.float64) tensor(-1.2229, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4342, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
11 gae_duplicate tensor(-0.3010, dtype=torch.float64) tensor(-2.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3795, dtype=torch.float64) delta_t tensor(-0.6191, dtype=torch.float64)
10 gae_duplicate tensor(-2.4618, dtype=torch.float64) tensor(11.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4947, dtype=torch.float64) delta_t tensor(-0.5716, dtype=torch.float64)
9 gae_duplicate tensor(-4.4664, dtype=torch.float64) tensor(11.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4774, dtype=torch.float64) delta_t tensor(-0.7603, dtype=torch.float64)
8 gae_duplicate tensor(-1.2467, dtype=torch.float64) tensor(15.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6234, dtype=torch.float64) delta_t tensor(-0.6168, dtype=torch.float64)
7 gae_duplicate tensor(-1.6789, dtype=torch.float64) tensor(13.5592, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8430, dtype=torch.float64) delta_t tensor(-0.7168, dtype=torch.float64)
6 gae_duplicate tensor(-1.2666, dtype=torch.float64) tensor(16.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4438, dtype=torch.float64) delta_t tensor(-1.2691, dtype=torch.float64)
5 gae_duplicate tensor(-2.0951, dtype=torch.float64) tensor(25.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1677, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
4 gae_duplicate tensor(-0.7112, dtype=torch.float64) tensor(4.5894, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8540, dtype=torch.float64) delta_t tensor(-0.9152, dtype=torch.float64)
3 gae_duplicate tensor(-2.3289, dtype=torch.float64) tensor(18.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0907, dtype=torch.float64) delta_t tensor(0.2099, dtype=torch.float64)
2 gae_duplicate tensor(-0.5001, dtype=torch.float64) tensor(-1.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2910.687255859375
value loss:124.73727416992188
entropies:350.28485107421875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3924.3730)
ToM Target loss= tensor(3889.5435)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.981933116912842 seconds
19 rew tensor(1.1772, dtype=torch.float64) delta_t tensor(0.3120, dtype=torch.float64)
19 gae_duplicate tensor(0.1200, dtype=torch.float64) tensor(-5.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1667, dtype=torch.float64) delta_t tensor(0.4272, dtype=torch.float64)
18 gae_duplicate tensor(0.2196, dtype=torch.float64) tensor(-9.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0921, dtype=torch.float64) delta_t tensor(0.4924, dtype=torch.float64)
17 gae_duplicate tensor(0.3367, dtype=torch.float64) tensor(-9.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0199, dtype=torch.float64) delta_t tensor(0.3910, dtype=torch.float64)
16 gae_duplicate tensor(0.2506, dtype=torch.float64) tensor(-8.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8909, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
15 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-6.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6734, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
14 gae_duplicate tensor(0.0946, dtype=torch.float64) tensor(-4.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6760, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
13 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-6.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4095, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
12 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-0.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3390, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
11 gae_duplicate tensor(-0.5070, dtype=torch.float64) tensor(-0.2498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1344, dtype=torch.float64) delta_t tensor(-0.1720, dtype=torch.float64)
10 gae_duplicate tensor(-0.8349, dtype=torch.float64) tensor(3.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0952, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
9 gae_duplicate tensor(-0.3551, dtype=torch.float64) tensor(-0.4901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3912, dtype=torch.float64) delta_t tensor(-0.6462, dtype=torch.float64)
8 gae_duplicate tensor(-0.8934, dtype=torch.float64) tensor(12.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0319, dtype=torch.float64) delta_t tensor(-1.0309, dtype=torch.float64)
7 gae_duplicate tensor(-1.7322, dtype=torch.float64) tensor(20.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6366, dtype=torch.float64) delta_t tensor(-0.4590, dtype=torch.float64)
6 gae_duplicate tensor(-1.3149, dtype=torch.float64) tensor(10.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5763, dtype=torch.float64) delta_t tensor(-1.3318, dtype=torch.float64)
5 gae_duplicate tensor(-1.8067, dtype=torch.float64) tensor(28.5851, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0275, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
4 gae_duplicate tensor(-1.3666, dtype=torch.float64) tensor(1.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0381, dtype=torch.float64) delta_t tensor(-1.1226, dtype=torch.float64)
3 gae_duplicate tensor(-2.1641, dtype=torch.float64) tensor(22.2085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.4903, dtype=torch.float64)
2 gae_duplicate tensor(-0.6957, dtype=torch.float64) tensor(-7.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2219.879638671875
value loss:90.20806884765625
entropies:350.66949462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.156847238540649 seconds
19 rew tensor(1.1431, dtype=torch.float64) delta_t tensor(0.3114, dtype=torch.float64)
19 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-5.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1585, dtype=torch.float64) delta_t tensor(0.3940, dtype=torch.float64)
18 gae_duplicate tensor(0.2362, dtype=torch.float64) tensor(-8.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1110, dtype=torch.float64) delta_t tensor(0.3580, dtype=torch.float64)
17 gae_duplicate tensor(0.1616, dtype=torch.float64) tensor(-7.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0459, dtype=torch.float64) delta_t tensor(0.3409, dtype=torch.float64)
16 gae_duplicate tensor(0.0844, dtype=torch.float64) tensor(-7.0841, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5820, dtype=torch.float64) delta_t tensor(-0.0303, dtype=torch.float64)
15 gae_duplicate tensor(-1.0559, dtype=torch.float64) tensor(-0.0946, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
14 gae_duplicate tensor(-1.2911, dtype=torch.float64) tensor(-0.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6070, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
13 gae_duplicate tensor(0.0224, dtype=torch.float64) tensor(-3.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4607, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
12 gae_duplicate tensor(-0.3305, dtype=torch.float64) tensor(-1.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0164, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
11 gae_duplicate tensor(-1.9783, dtype=torch.float64) tensor(6.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0957, dtype=torch.float64) delta_t tensor(-0.2168, dtype=torch.float64)
10 gae_duplicate tensor(-0.5681, dtype=torch.float64) tensor(4.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2882, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
9 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(-3.9653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4685, dtype=torch.float64) delta_t tensor(-0.7726, dtype=torch.float64)
8 gae_duplicate tensor(-1.0923, dtype=torch.float64) tensor(15.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8106, dtype=torch.float64) delta_t tensor(-0.8230, dtype=torch.float64)
7 gae_duplicate tensor(-1.5751, dtype=torch.float64) tensor(17.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6179, dtype=torch.float64) delta_t tensor(-0.4668, dtype=torch.float64)
6 gae_duplicate tensor(-0.9596, dtype=torch.float64) tensor(10.7226, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6449, dtype=torch.float64) delta_t tensor(-1.2583, dtype=torch.float64)
5 gae_duplicate tensor(-1.8189, dtype=torch.float64) tensor(25.6871, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0837, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
4 gae_duplicate tensor(-0.8922, dtype=torch.float64) tensor(2.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0025, dtype=torch.float64) delta_t tensor(-1.0753, dtype=torch.float64)
3 gae_duplicate tensor(-1.7808, dtype=torch.float64) tensor(20.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2849, dtype=torch.float64) delta_t tensor(0.4359, dtype=torch.float64)
2 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-6.3393, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3233.484619140625
value loss:75.83979034423828
entropies:350.8827209472656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.512630939483643 seconds
19 rew tensor(1.1766, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
19 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(-3.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(0.2525, dtype=torch.float64)
18 gae_duplicate tensor(0.1355, dtype=torch.float64) tensor(-5.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0232, dtype=torch.float64) delta_t tensor(0.2537, dtype=torch.float64)
17 gae_duplicate tensor(0.1309, dtype=torch.float64) tensor(-5.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.1655, dtype=torch.float64)
16 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-3.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8764, dtype=torch.float64) delta_t tensor(0.2845, dtype=torch.float64)
15 gae_duplicate tensor(0.1806, dtype=torch.float64) tensor(-6.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5875, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
14 gae_duplicate tensor(0.0093, dtype=torch.float64) tensor(-3.5603, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6507, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
13 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(-4.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2339, dtype=torch.float64) delta_t tensor(-0.2130, dtype=torch.float64)
12 gae_duplicate tensor(-0.3371, dtype=torch.float64) tensor(3.7965, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4996, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
11 gae_duplicate tensor(-0.5821, dtype=torch.float64) tensor(-1.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0293, dtype=torch.float64) delta_t tensor(-0.4259, dtype=torch.float64)
10 gae_duplicate tensor(-0.5767, dtype=torch.float64) tensor(8.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3422, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
9 gae_duplicate tensor(-0.3395, dtype=torch.float64) tensor(-2.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6211, dtype=torch.float64) delta_t tensor(-0.9219, dtype=torch.float64)
8 gae_duplicate tensor(-1.2991, dtype=torch.float64) tensor(17.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4659, dtype=torch.float64) delta_t tensor(-0.5226, dtype=torch.float64)
7 gae_duplicate tensor(-1.6244, dtype=torch.float64) tensor(12.4586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6780, dtype=torch.float64) delta_t tensor(-0.4622, dtype=torch.float64)
6 gae_duplicate tensor(-0.8803, dtype=torch.float64) tensor(10.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4395, dtype=torch.float64) delta_t tensor(-1.1072, dtype=torch.float64)
5 gae_duplicate tensor(-1.8989, dtype=torch.float64) tensor(21.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2029, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
4 gae_duplicate tensor(-0.5531, dtype=torch.float64) tensor(3.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7340, dtype=torch.float64) delta_t tensor(-0.7167, dtype=torch.float64)
3 gae_duplicate tensor(-1.9266, dtype=torch.float64) tensor(13.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1788, dtype=torch.float64) delta_t tensor(0.3498, dtype=torch.float64)
2 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-5.1521, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2834.670654296875
value loss:55.159400939941406
entropies:351.0944519042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.67870306968689 seconds
19 rew tensor(1.2369, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
19 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-3.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1775, dtype=torch.float64) delta_t tensor(0.3188, dtype=torch.float64)
18 gae_duplicate tensor(-0.0617, dtype=torch.float64) tensor(-6.3530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0592, dtype=torch.float64) delta_t tensor(0.2486, dtype=torch.float64)
17 gae_duplicate tensor(0.0070, dtype=torch.float64) tensor(-5.8087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0855, dtype=torch.float64) delta_t tensor(0.2938, dtype=torch.float64)
16 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-6.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(0.3890, dtype=torch.float64)
15 gae_duplicate tensor(0.2260, dtype=torch.float64) tensor(-7.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5546, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
14 gae_duplicate tensor(-1.2902, dtype=torch.float64) tensor(-0.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6115, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
13 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(-1.8453, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2596, dtype=torch.float64) delta_t tensor(-0.2071, dtype=torch.float64)
12 gae_duplicate tensor(-0.3856, dtype=torch.float64) tensor(4.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3716, dtype=torch.float64) delta_t tensor(-0.7837, dtype=torch.float64)
11 gae_duplicate tensor(-4.9129, dtype=torch.float64) tensor(14.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6566, dtype=torch.float64) delta_t tensor(-0.8256, dtype=torch.float64)
10 gae_duplicate tensor(-3.5240, dtype=torch.float64) tensor(16.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2941, dtype=torch.float64) delta_t tensor(0.2721, dtype=torch.float64)
9 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(-3.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5391, dtype=torch.float64) delta_t tensor(-0.8076, dtype=torch.float64)
8 gae_duplicate tensor(-1.1226, dtype=torch.float64) tensor(14.8031, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8546, dtype=torch.float64) delta_t tensor(-0.6754, dtype=torch.float64)
7 gae_duplicate tensor(-1.4107, dtype=torch.float64) tensor(14.7358, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8249, dtype=torch.float64) delta_t tensor(-0.5639, dtype=torch.float64)
6 gae_duplicate tensor(-1.3446, dtype=torch.float64) tensor(11.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5810, dtype=torch.float64) delta_t tensor(-1.2240, dtype=torch.float64)
5 gae_duplicate tensor(-1.9014, dtype=torch.float64) tensor(25.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0391, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
4 gae_duplicate tensor(-0.9802, dtype=torch.float64) tensor(1.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1860, dtype=torch.float64) delta_t tensor(-1.2485, dtype=torch.float64)
3 gae_duplicate tensor(-2.3054, dtype=torch.float64) tensor(25.7207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3035, dtype=torch.float64) delta_t tensor(0.4640, dtype=torch.float64)
2 gae_duplicate tensor(-0.3768, dtype=torch.float64) tensor(-6.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4805.20849609375
value loss:134.0723876953125
entropies:351.2810363769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.99141001701355 seconds
19 rew tensor(1.1853, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
19 gae_duplicate tensor(-0.1211, dtype=torch.float64) tensor(-0.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1878, dtype=torch.float64) delta_t tensor(0.2925, dtype=torch.float64)
18 gae_duplicate tensor(0.0969, dtype=torch.float64) tensor(-5.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0713, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
17 gae_duplicate tensor(0.1114, dtype=torch.float64) tensor(-5.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8768, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
16 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(-2.4153, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9023, dtype=torch.float64) delta_t tensor(0.2731, dtype=torch.float64)
15 gae_duplicate tensor(0.0739, dtype=torch.float64) tensor(-5.5762, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3433, dtype=torch.float64) delta_t tensor(-0.1423, dtype=torch.float64)
14 gae_duplicate tensor(-1.6681, dtype=torch.float64) tensor(1.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(0.2883, dtype=torch.float64)
13 gae_duplicate tensor(0.1545, dtype=torch.float64) tensor(-5.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1404, dtype=torch.float64) delta_t tensor(-0.2422, dtype=torch.float64)
12 gae_duplicate tensor(-0.4075, dtype=torch.float64) tensor(3.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5552, dtype=torch.float64) delta_t tensor(0.2002, dtype=torch.float64)
11 gae_duplicate tensor(-0.2815, dtype=torch.float64) tensor(-3.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0033, dtype=torch.float64) delta_t tensor(-0.3224, dtype=torch.float64)
10 gae_duplicate tensor(-0.5928, dtype=torch.float64) tensor(5.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3220, dtype=torch.float64) delta_t tensor(0.2086, dtype=torch.float64)
9 gae_duplicate tensor(-0.7539, dtype=torch.float64) tensor(-3.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(-0.9524, dtype=torch.float64)
8 gae_duplicate tensor(-1.3325, dtype=torch.float64) tensor(18.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5077, dtype=torch.float64) delta_t tensor(-0.5576, dtype=torch.float64)
7 gae_duplicate tensor(-1.8926, dtype=torch.float64) tensor(12.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7328, dtype=torch.float64) delta_t tensor(-0.3831, dtype=torch.float64)
6 gae_duplicate tensor(-0.6690, dtype=torch.float64) tensor(9.0881, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4535, dtype=torch.float64) delta_t tensor(-1.0912, dtype=torch.float64)
5 gae_duplicate tensor(-2.4527, dtype=torch.float64) tensor(23.8176, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1511, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
4 gae_duplicate tensor(-0.4848, dtype=torch.float64) tensor(1.8917, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8581, dtype=torch.float64) delta_t tensor(-0.8257, dtype=torch.float64)
3 gae_duplicate tensor(-2.3194, dtype=torch.float64) tensor(15.9249, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(0.3534, dtype=torch.float64)
2 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-5.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3052.45703125
value loss:67.40776824951172
entropies:351.4434509277344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3920.0149)
ToM Target loss= tensor(3889.4988)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0426599979400635 seconds
19 rew tensor(1.1178, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
19 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(-2.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1601, dtype=torch.float64) delta_t tensor(0.2690, dtype=torch.float64)
18 gae_duplicate tensor(0.1214, dtype=torch.float64) tensor(-5.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0449, dtype=torch.float64) delta_t tensor(0.2010, dtype=torch.float64)
17 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-4.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0022, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
16 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-3.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8762, dtype=torch.float64) delta_t tensor(0.2867, dtype=torch.float64)
15 gae_duplicate tensor(0.0985, dtype=torch.float64) tensor(-5.6695, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6074, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
14 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7481, dtype=torch.float64) delta_t tensor(0.2709, dtype=torch.float64)
13 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-6.0671, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1710, dtype=torch.float64) delta_t tensor(-0.2899, dtype=torch.float64)
12 gae_duplicate tensor(-0.6530, dtype=torch.float64) tensor(5.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5796, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
11 gae_duplicate tensor(-0.2277, dtype=torch.float64) tensor(-2.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2211, dtype=torch.float64) delta_t tensor(-0.4173, dtype=torch.float64)
10 gae_duplicate tensor(-0.5482, dtype=torch.float64) tensor(8.3928, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(0.3019, dtype=torch.float64)
9 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(-5.2792, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7082, dtype=torch.float64) delta_t tensor(-0.9976, dtype=torch.float64)
8 gae_duplicate tensor(-1.3333, dtype=torch.float64) tensor(18.5304, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2234, dtype=torch.float64) delta_t tensor(-1.1459, dtype=torch.float64)
7 gae_duplicate tensor(-4.5663, dtype=torch.float64) tensor(25.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8350, dtype=torch.float64) delta_t tensor(-0.7116, dtype=torch.float64)
6 gae_duplicate tensor(-1.5995, dtype=torch.float64) tensor(16.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4922, dtype=torch.float64) delta_t tensor(-1.0455, dtype=torch.float64)
5 gae_duplicate tensor(-1.4156, dtype=torch.float64) tensor(21.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0044, dtype=torch.float64) delta_t tensor(0.1745, dtype=torch.float64)
4 gae_duplicate tensor(-0.6448, dtype=torch.float64) tensor(-0.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1801, dtype=torch.float64) delta_t tensor(-1.1716, dtype=torch.float64)
3 gae_duplicate tensor(-2.5549, dtype=torch.float64) tensor(24.7394, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3737, dtype=torch.float64) delta_t tensor(0.5027, dtype=torch.float64)
2 gae_duplicate tensor(-0.3947, dtype=torch.float64) tensor(-7.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4053.484375
value loss:101.2126235961914
entropies:351.638671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.197136878967285 seconds
19 rew tensor(1.1664, dtype=torch.float64) delta_t tensor(0.3291, dtype=torch.float64)
19 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-6.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1938, dtype=torch.float64) delta_t tensor(0.3839, dtype=torch.float64)
18 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-7.5826, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0540, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
17 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-3.7684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
16 gae_duplicate tensor(-1.3451, dtype=torch.float64) tensor(0.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9925, dtype=torch.float64) delta_t tensor(0.2677, dtype=torch.float64)
15 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(-5.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2777, dtype=torch.float64) delta_t tensor(-0.2655, dtype=torch.float64)
14 gae_duplicate tensor(-2.8310, dtype=torch.float64) tensor(4.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5940, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
13 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-3.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3226, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
12 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-2.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5448, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
11 gae_duplicate tensor(-0.3497, dtype=torch.float64) tensor(-3.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0694, dtype=torch.float64) delta_t tensor(-0.3045, dtype=torch.float64)
10 gae_duplicate tensor(-0.5175, dtype=torch.float64) tensor(5.9399, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5754, dtype=torch.float64) delta_t tensor(0.6029, dtype=torch.float64)
9 gae_duplicate tensor(-0.0775, dtype=torch.float64) tensor(-11.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7508, dtype=torch.float64) delta_t tensor(-1.0261, dtype=torch.float64)
8 gae_duplicate tensor(-1.2698, dtype=torch.float64) tensor(18.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3810, dtype=torch.float64) delta_t tensor(-1.2494, dtype=torch.float64)
7 gae_duplicate tensor(-4.2493, dtype=torch.float64) tensor(27.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8915, dtype=torch.float64) delta_t tensor(-0.5708, dtype=torch.float64)
6 gae_duplicate tensor(-1.2074, dtype=torch.float64) tensor(13.2335, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4964, dtype=torch.float64) delta_t tensor(-0.9017, dtype=torch.float64)
5 gae_duplicate tensor(-1.5995, dtype=torch.float64) tensor(18.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1708, dtype=torch.float64) delta_t tensor(0.3226, dtype=torch.float64)
4 gae_duplicate tensor(-0.3889, dtype=torch.float64) tensor(-3.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3964, dtype=torch.float64) delta_t tensor(-1.5237, dtype=torch.float64)
3 gae_duplicate tensor(-2.4007, dtype=torch.float64) tensor(30.8822, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.6726, dtype=torch.float64)
2 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(-10.8812, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3395.777099609375
value loss:120.36663818359375
entropies:351.70440673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.606135845184326 seconds
19 rew tensor(1.2131, dtype=torch.float64) delta_t tensor(0.0948, dtype=torch.float64)
19 gae_duplicate tensor(-0.1891, dtype=torch.float64) tensor(-2.0915, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1638, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
18 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-4.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1135, dtype=torch.float64) delta_t tensor(0.2966, dtype=torch.float64)
17 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(-6.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0626, dtype=torch.float64) delta_t tensor(0.1084, dtype=torch.float64)
16 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-2.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0127, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
15 gae_duplicate tensor(-0.1531, dtype=torch.float64) tensor(-5.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5204, dtype=torch.float64) delta_t tensor(-0.1096, dtype=torch.float64)
14 gae_duplicate tensor(-1.2197, dtype=torch.float64) tensor(2.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4495, dtype=torch.float64) delta_t tensor(-0.8184, dtype=torch.float64)
13 gae_duplicate tensor(-4.2259, dtype=torch.float64) tensor(18.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0938, dtype=torch.float64) delta_t tensor(-0.2627, dtype=torch.float64)
12 gae_duplicate tensor(-1.8547, dtype=torch.float64) tensor(6.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4295, dtype=torch.float64) delta_t tensor(0.0946, dtype=torch.float64)
11 gae_duplicate tensor(-0.4770, dtype=torch.float64) tensor(-0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0432, dtype=torch.float64) delta_t tensor(-0.2867, dtype=torch.float64)
10 gae_duplicate tensor(-0.6005, dtype=torch.float64) tensor(5.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4804, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
9 gae_duplicate tensor(-0.2760, dtype=torch.float64) tensor(-8.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7509, dtype=torch.float64) delta_t tensor(-1.0358, dtype=torch.float64)
8 gae_duplicate tensor(-1.2724, dtype=torch.float64) tensor(18.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7227, dtype=torch.float64) delta_t tensor(-0.5797, dtype=torch.float64)
7 gae_duplicate tensor(-1.6631, dtype=torch.float64) tensor(13.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-0.5296, dtype=torch.float64)
6 gae_duplicate tensor(-0.8727, dtype=torch.float64) tensor(11.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5588, dtype=torch.float64) delta_t tensor(-0.9862, dtype=torch.float64)
5 gae_duplicate tensor(-1.5773, dtype=torch.float64) tensor(21.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0315, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
4 gae_duplicate tensor(-0.3724, dtype=torch.float64) tensor(-1.5094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2294, dtype=torch.float64) delta_t tensor(-1.2312, dtype=torch.float64)
3 gae_duplicate tensor(-2.1351, dtype=torch.float64) tensor(24.0021, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3069, dtype=torch.float64) delta_t tensor(0.4634, dtype=torch.float64)
2 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-6.3700, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4668.6689453125
value loss:102.52716064453125
entropies:351.60211181640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.283405065536499 seconds
19 rew tensor(1.2140, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
19 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(0.6090, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2166, dtype=torch.float64) delta_t tensor(0.0240, dtype=torch.float64)
18 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(-0.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1679, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
17 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-3.3224, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9600, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
16 gae_duplicate tensor(-0.3572, dtype=torch.float64) tensor(-0.9049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8837, dtype=torch.float64) delta_t tensor(0.2591, dtype=torch.float64)
15 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-4.8408, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4656, dtype=torch.float64) delta_t tensor(-0.1163, dtype=torch.float64)
14 gae_duplicate tensor(-1.1949, dtype=torch.float64) tensor(1.6168, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3620, dtype=torch.float64) delta_t tensor(-0.1825, dtype=torch.float64)
13 gae_duplicate tensor(-1.2065, dtype=torch.float64) tensor(4.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3269, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
12 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(2.1427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1230, dtype=torch.float64) delta_t tensor(-0.3316, dtype=torch.float64)
11 gae_duplicate tensor(-1.8465, dtype=torch.float64) tensor(6.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1092, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
10 gae_duplicate tensor(-0.5688, dtype=torch.float64) tensor(1.7951, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1627, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
9 gae_duplicate tensor(-0.3257, dtype=torch.float64) tensor(-2.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4818, dtype=torch.float64) delta_t tensor(-0.7841, dtype=torch.float64)
8 gae_duplicate tensor(-1.0407, dtype=torch.float64) tensor(15.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0360, dtype=torch.float64) delta_t tensor(-0.8426, dtype=torch.float64)
7 gae_duplicate tensor(-1.9315, dtype=torch.float64) tensor(18.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6008, dtype=torch.float64) delta_t tensor(-0.2572, dtype=torch.float64)
6 gae_duplicate tensor(-0.7915, dtype=torch.float64) tensor(6.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7106, dtype=torch.float64) delta_t tensor(-1.1524, dtype=torch.float64)
5 gae_duplicate tensor(-1.7255, dtype=torch.float64) tensor(22.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1559, dtype=torch.float64) delta_t tensor(0.3436, dtype=torch.float64)
4 gae_duplicate tensor(-0.3216, dtype=torch.float64) tensor(-4.7576, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3288, dtype=torch.float64) delta_t tensor(-1.3571, dtype=torch.float64)
3 gae_duplicate tensor(-2.1851, dtype=torch.float64) tensor(25.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(0.6725, dtype=torch.float64)
2 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-10.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4307.09033203125
value loss:73.57927703857422
entropies:351.3929748535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797914028167725 seconds
19 rew tensor(1.1756, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
19 gae_duplicate tensor(-0.3087, dtype=torch.float64) tensor(-1.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1650, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
18 gae_duplicate tensor(-0.2779, dtype=torch.float64) tensor(-1.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1550, dtype=torch.float64) delta_t tensor(0.1435, dtype=torch.float64)
17 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(-3.2335, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1446, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
16 gae_duplicate tensor(-0.2399, dtype=torch.float64) tensor(-0.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
15 gae_duplicate tensor(-0.9344, dtype=torch.float64) tensor(0.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7564, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
14 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(-2.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(-0.3697, dtype=torch.float64)
13 gae_duplicate tensor(-2.8904, dtype=torch.float64) tensor(6.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2101, dtype=torch.float64) delta_t tensor(-0.6732, dtype=torch.float64)
12 gae_duplicate tensor(-3.4364, dtype=torch.float64) tensor(13.8983, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4539, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
11 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(0.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(-0.2553, dtype=torch.float64)
10 gae_duplicate tensor(-0.5979, dtype=torch.float64) tensor(4.9322, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4677, dtype=torch.float64) delta_t tensor(0.5294, dtype=torch.float64)
9 gae_duplicate tensor(0.2137, dtype=torch.float64) tensor(-9.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6133, dtype=torch.float64) delta_t tensor(-0.9138, dtype=torch.float64)
8 gae_duplicate tensor(-1.1515, dtype=torch.float64) tensor(18.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2659, dtype=torch.float64) delta_t tensor(-1.1255, dtype=torch.float64)
7 gae_duplicate tensor(-3.8338, dtype=torch.float64) tensor(24.5008, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7780, dtype=torch.float64) delta_t tensor(-0.3109, dtype=torch.float64)
6 gae_duplicate tensor(-1.2740, dtype=torch.float64) tensor(8.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5067, dtype=torch.float64) delta_t tensor(-0.8972, dtype=torch.float64)
5 gae_duplicate tensor(-1.3259, dtype=torch.float64) tensor(18.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0372, dtype=torch.float64) delta_t tensor(0.2523, dtype=torch.float64)
4 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-2.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1940, dtype=torch.float64) delta_t tensor(-1.1715, dtype=torch.float64)
3 gae_duplicate tensor(-2.0225, dtype=torch.float64) tensor(21.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3872, dtype=torch.float64) delta_t tensor(0.5534, dtype=torch.float64)
2 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(-8.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4833.99609375
value loss:110.77133178710938
entropies:351.24725341796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3943.0508)
ToM Target loss= tensor(3882.4768)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.908905982971191 seconds
19 rew tensor(1.2025, dtype=torch.float64) delta_t tensor(-0.1837, dtype=torch.float64)
19 gae_duplicate tensor(-0.2805, dtype=torch.float64) tensor(3.6713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1782, dtype=torch.float64) delta_t tensor(-0.0414, dtype=torch.float64)
18 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(1.2081, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0658, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
17 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-3.7865, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6940, dtype=torch.float64) delta_t tensor(-0.3320, dtype=torch.float64)
16 gae_duplicate tensor(-1.1372, dtype=torch.float64) tensor(6.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(0.2079, dtype=torch.float64)
15 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-3.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
14 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-3.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1456, dtype=torch.float64) delta_t tensor(-0.3719, dtype=torch.float64)
13 gae_duplicate tensor(-1.5842, dtype=torch.float64) tensor(6.6584, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3256, dtype=torch.float64) delta_t tensor(-0.0720, dtype=torch.float64)
12 gae_duplicate tensor(-0.4094, dtype=torch.float64) tensor(1.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3387, dtype=torch.float64) delta_t tensor(-0.1892, dtype=torch.float64)
11 gae_duplicate tensor(-0.4072, dtype=torch.float64) tensor(4.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0025, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
10 gae_duplicate tensor(-0.5392, dtype=torch.float64) tensor(2.3546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2469, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
9 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-4.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5757, dtype=torch.float64) delta_t tensor(-0.8643, dtype=torch.float64)
8 gae_duplicate tensor(-1.1401, dtype=torch.float64) tensor(16.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5886, dtype=torch.float64) delta_t tensor(-0.5505, dtype=torch.float64)
7 gae_duplicate tensor(-1.0674, dtype=torch.float64) tensor(12.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6544, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
6 gae_duplicate tensor(-0.7408, dtype=torch.float64) tensor(4.7904, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5748, dtype=torch.float64) delta_t tensor(-1.0150, dtype=torch.float64)
5 gae_duplicate tensor(-1.2400, dtype=torch.float64) tensor(19.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1308, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
4 gae_duplicate tensor(-0.3958, dtype=torch.float64) tensor(-0.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9996, dtype=torch.float64) delta_t tensor(-0.8794, dtype=torch.float64)
3 gae_duplicate tensor(-1.6855, dtype=torch.float64) tensor(16.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2068, dtype=torch.float64) delta_t tensor(0.3787, dtype=torch.float64)
2 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-5.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4112.66357421875
value loss:48.14275360107422
entropies:351.14678955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762568950653076 seconds
19 rew tensor(1.2456, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
19 gae_duplicate tensor(-0.3493, dtype=torch.float64) tensor(-1.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1822, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
18 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(-2.3380, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0795, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
17 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(-3.6163, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0668, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
16 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(1.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9525, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
15 gae_duplicate tensor(0.0702, dtype=torch.float64) tensor(-3.5684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.2511, dtype=torch.float64)
14 gae_duplicate tensor(0.0914, dtype=torch.float64) tensor(-5.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1726, dtype=torch.float64) delta_t tensor(-0.7051, dtype=torch.float64)
13 gae_duplicate tensor(-3.0476, dtype=torch.float64) tensor(12.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4211, dtype=torch.float64) delta_t tensor(-0.9142, dtype=torch.float64)
12 gae_duplicate tensor(-3.6386, dtype=torch.float64) tensor(18.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4956, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
11 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(-1.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0777, dtype=torch.float64) delta_t tensor(-0.2364, dtype=torch.float64)
10 gae_duplicate tensor(-0.6621, dtype=torch.float64) tensor(4.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.4800, dtype=torch.float64)
9 gae_duplicate tensor(0.2590, dtype=torch.float64) tensor(-8.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5409, dtype=torch.float64) delta_t tensor(-0.7411, dtype=torch.float64)
8 gae_duplicate tensor(-0.9919, dtype=torch.float64) tensor(14.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3396, dtype=torch.float64) delta_t tensor(-0.3059, dtype=torch.float64)
7 gae_duplicate tensor(-0.9260, dtype=torch.float64) tensor(6.8889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8683, dtype=torch.float64) delta_t tensor(-0.4339, dtype=torch.float64)
6 gae_duplicate tensor(-0.9287, dtype=torch.float64) tensor(8.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1917, dtype=torch.float64) delta_t tensor(-0.6329, dtype=torch.float64)
5 gae_duplicate tensor(-1.3354, dtype=torch.float64) tensor(13.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3072, dtype=torch.float64) delta_t tensor(-0.1427, dtype=torch.float64)
4 gae_duplicate tensor(-0.9112, dtype=torch.float64) tensor(4.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5960, dtype=torch.float64) delta_t tensor(-0.4370, dtype=torch.float64)
3 gae_duplicate tensor(-1.3299, dtype=torch.float64) tensor(9.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0704, dtype=torch.float64) delta_t tensor(0.3259, dtype=torch.float64)
2 gae_duplicate tensor(-0.3287, dtype=torch.float64) tensor(-5.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3449.596923828125
value loss:82.50596618652344
entropies:351.17364501953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.547240972518921 seconds
19 rew tensor(1.1017, dtype=torch.float64) delta_t tensor(-0.1200, dtype=torch.float64)
19 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(2.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1545, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
18 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(0.7537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0522, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
17 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(-3.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6273, dtype=torch.float64) delta_t tensor(-0.4826, dtype=torch.float64)
16 gae_duplicate tensor(-1.6818, dtype=torch.float64) tensor(10.0673, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9369, dtype=torch.float64) delta_t tensor(0.2025, dtype=torch.float64)
15 gae_duplicate tensor(-0.3251, dtype=torch.float64) tensor(-2.8053, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6517, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
14 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-2.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6919, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
13 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-3.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2072, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
12 gae_duplicate tensor(-0.3373, dtype=torch.float64) tensor(3.6042, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4846, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
11 gae_duplicate tensor(-0.4840, dtype=torch.float64) tensor(-1.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0553, dtype=torch.float64) delta_t tensor(-0.2751, dtype=torch.float64)
10 gae_duplicate tensor(-0.5469, dtype=torch.float64) tensor(5.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3348, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
9 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-3.8488, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6107, dtype=torch.float64) delta_t tensor(-0.8124, dtype=torch.float64)
8 gae_duplicate tensor(-1.0266, dtype=torch.float64) tensor(15.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4699, dtype=torch.float64) delta_t tensor(-0.3990, dtype=torch.float64)
7 gae_duplicate tensor(-1.2119, dtype=torch.float64) tensor(8.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7989, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
6 gae_duplicate tensor(-0.7460, dtype=torch.float64) tensor(6.2209, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3221, dtype=torch.float64) delta_t tensor(-0.7625, dtype=torch.float64)
5 gae_duplicate tensor(-1.3604, dtype=torch.float64) tensor(15.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1532, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
4 gae_duplicate tensor(-0.8573, dtype=torch.float64) tensor(0.5274, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7837, dtype=torch.float64) delta_t tensor(-0.5706, dtype=torch.float64)
3 gae_duplicate tensor(-1.9254, dtype=torch.float64) tensor(12.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1986, dtype=torch.float64) delta_t tensor(0.4541, dtype=torch.float64)
2 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-7.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3157.222900390625
value loss:46.737667083740234
entropies:351.19256591796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.709942817687988 seconds
19 rew tensor(1.1691, dtype=torch.float64) delta_t tensor(-0.2408, dtype=torch.float64)
19 gae_duplicate tensor(-0.4456, dtype=torch.float64) tensor(4.7430, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
18 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(2.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0678, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
17 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(-1.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0312, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
16 gae_duplicate tensor(-0.3073, dtype=torch.float64) tensor(2.3664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
15 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-2.4381, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2130, dtype=torch.float64) delta_t tensor(-0.5033, dtype=torch.float64)
14 gae_duplicate tensor(-2.8902, dtype=torch.float64) tensor(8.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6747, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
13 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-2.1966, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
12 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(-1.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
11 gae_duplicate tensor(-0.3466, dtype=torch.float64) tensor(-0.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1339, dtype=torch.float64) delta_t tensor(-0.3747, dtype=torch.float64)
10 gae_duplicate tensor(-0.5350, dtype=torch.float64) tensor(7.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4067, dtype=torch.float64) delta_t tensor(0.5714, dtype=torch.float64)
9 gae_duplicate tensor(0.2150, dtype=torch.float64) tensor(-11.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4356, dtype=torch.float64) delta_t tensor(-0.7832, dtype=torch.float64)
8 gae_duplicate tensor(-0.8708, dtype=torch.float64) tensor(14.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9576, dtype=torch.float64) delta_t tensor(-0.5797, dtype=torch.float64)
7 gae_duplicate tensor(-0.7786, dtype=torch.float64) tensor(12.5739, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5421, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
6 gae_duplicate tensor(-0.5850, dtype=torch.float64) tensor(3.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7693, dtype=torch.float64) delta_t tensor(-1.1031, dtype=torch.float64)
5 gae_duplicate tensor(-1.3444, dtype=torch.float64) tensor(22.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0070, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
4 gae_duplicate tensor(0.0216, dtype=torch.float64) tensor(-2.5168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1741, dtype=torch.float64) delta_t tensor(-1.0610, dtype=torch.float64)
3 gae_duplicate tensor(-1.3995, dtype=torch.float64) tensor(20.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3458, dtype=torch.float64) delta_t tensor(0.5848, dtype=torch.float64)
2 gae_duplicate tensor(0.2796, dtype=torch.float64) tensor(-9.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3681.346923828125
value loss:55.36575698852539
entropies:351.0960998535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.150359869003296 seconds
19 rew tensor(1.2058, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
19 gae_duplicate tensor(-0.3330, dtype=torch.float64) tensor(0.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1434, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
18 gae_duplicate tensor(-0.3009, dtype=torch.float64) tensor(-0.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1470, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
17 gae_duplicate tensor(-0.3520, dtype=torch.float64) tensor(0.3882, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1475, dtype=torch.float64) delta_t tensor(0.1653, dtype=torch.float64)
16 gae_duplicate tensor(-0.2450, dtype=torch.float64) tensor(-3.0380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9408, dtype=torch.float64) delta_t tensor(0.2641, dtype=torch.float64)
15 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-5.5742, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2674, dtype=torch.float64) delta_t tensor(-0.2692, dtype=torch.float64)
14 gae_duplicate tensor(-2.8308, dtype=torch.float64) tensor(4.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0545, dtype=torch.float64) delta_t tensor(-0.5689, dtype=torch.float64)
13 gae_duplicate tensor(-3.8151, dtype=torch.float64) tensor(11.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1284, dtype=torch.float64) delta_t tensor(-0.3740, dtype=torch.float64)
12 gae_duplicate tensor(-2.0512, dtype=torch.float64) tensor(8.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2312, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
11 gae_duplicate tensor(-1.2081, dtype=torch.float64) tensor(3.5447, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0307, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
10 gae_duplicate tensor(-0.5472, dtype=torch.float64) tensor(5.3719, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.4860, dtype=torch.float64)
9 gae_duplicate tensor(0.1114, dtype=torch.float64) tensor(-8.7185, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.7042, dtype=torch.float64)
8 gae_duplicate tensor(-1.0376, dtype=torch.float64) tensor(13.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6422, dtype=torch.float64) delta_t tensor(-0.5070, dtype=torch.float64)
7 gae_duplicate tensor(-0.9948, dtype=torch.float64) tensor(10.7434, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(-0.1251, dtype=torch.float64)
6 gae_duplicate tensor(-1.0464, dtype=torch.float64) tensor(3.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3513, dtype=torch.float64) delta_t tensor(-0.7604, dtype=torch.float64)
5 gae_duplicate tensor(-1.2722, dtype=torch.float64) tensor(14.5773, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1810, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
4 gae_duplicate tensor(-1.0119, dtype=torch.float64) tensor(0.0928, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7365, dtype=torch.float64) delta_t tensor(-0.6017, dtype=torch.float64)
3 gae_duplicate tensor(-1.0035, dtype=torch.float64) tensor(12.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1858, dtype=torch.float64) delta_t tensor(0.4164, dtype=torch.float64)
2 gae_duplicate tensor(-0.3260, dtype=torch.float64) tensor(-7.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3512.85400390625
value loss:87.47405242919922
entropies:351.1188049316406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3934.9973)
ToM Target loss= tensor(3887.8838)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.862783908843994 seconds
19 rew tensor(1.1820, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
19 gae_duplicate tensor(-0.4555, dtype=torch.float64) tensor(-1.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1842, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
18 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(-5.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1610, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
17 gae_duplicate tensor(-0.3688, dtype=torch.float64) tensor(-3.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
16 gae_duplicate tensor(-0.2944, dtype=torch.float64) tensor(-2.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0200, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
15 gae_duplicate tensor(-0.2372, dtype=torch.float64) tensor(0.7583, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9406, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
14 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(-3.3991, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4145, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
13 gae_duplicate tensor(-1.4343, dtype=torch.float64) tensor(1.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2926, dtype=torch.float64) delta_t tensor(-0.6985, dtype=torch.float64)
12 gae_duplicate tensor(-2.3540, dtype=torch.float64) tensor(14.5313, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5311, dtype=torch.float64) delta_t tensor(-0.8934, dtype=torch.float64)
11 gae_duplicate tensor(-3.4220, dtype=torch.float64) tensor(18.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1311, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
10 gae_duplicate tensor(-0.5088, dtype=torch.float64) tensor(0.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5015, dtype=torch.float64) delta_t tensor(0.5874, dtype=torch.float64)
9 gae_duplicate tensor(0.3072, dtype=torch.float64) tensor(-10.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6514, dtype=torch.float64) delta_t tensor(-0.8068, dtype=torch.float64)
8 gae_duplicate tensor(-1.1638, dtype=torch.float64) tensor(14.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7387, dtype=torch.float64) delta_t tensor(-0.4094, dtype=torch.float64)
7 gae_duplicate tensor(-1.1072, dtype=torch.float64) tensor(10.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8233, dtype=torch.float64) delta_t tensor(-0.2323, dtype=torch.float64)
6 gae_duplicate tensor(-0.9344, dtype=torch.float64) tensor(5.6899, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5041, dtype=torch.float64) delta_t tensor(-0.9661, dtype=torch.float64)
5 gae_duplicate tensor(-1.2259, dtype=torch.float64) tensor(19.2004, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0251, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
4 gae_duplicate tensor(-0.6782, dtype=torch.float64) tensor(-2.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1451, dtype=torch.float64) delta_t tensor(-1.0880, dtype=torch.float64)
3 gae_duplicate tensor(-1.8931, dtype=torch.float64) tensor(20.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3267, dtype=torch.float64) delta_t tensor(0.6071, dtype=torch.float64)
2 gae_duplicate tensor(-0.2288, dtype=torch.float64) tensor(-9.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3712.884765625
value loss:93.52376556396484
entropies:351.2723693847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.979117155075073 seconds
19 rew tensor(1.2036, dtype=torch.float64) delta_t tensor(-0.1299, dtype=torch.float64)
19 gae_duplicate tensor(-0.4209, dtype=torch.float64) tensor(2.7837, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2055, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
18 gae_duplicate tensor(-0.2524, dtype=torch.float64) tensor(2.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1814, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
17 gae_duplicate tensor(-0.2330, dtype=torch.float64) tensor(-0.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(-0.1604, dtype=torch.float64)
16 gae_duplicate tensor(-1.3858, dtype=torch.float64) tensor(3.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8973, dtype=torch.float64) delta_t tensor(0.1616, dtype=torch.float64)
15 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(-2.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7923, dtype=torch.float64) delta_t tensor(0.2138, dtype=torch.float64)
14 gae_duplicate tensor(0.1296, dtype=torch.float64) tensor(-4.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5120, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
13 gae_duplicate tensor(-0.3191, dtype=torch.float64) tensor(0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5678, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
12 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-2.7528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1441, dtype=torch.float64) delta_t tensor(-0.1693, dtype=torch.float64)
11 gae_duplicate tensor(-0.3495, dtype=torch.float64) tensor(2.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.2056, dtype=torch.float64)
10 gae_duplicate tensor(-0.4013, dtype=torch.float64) tensor(-3.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0619, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
9 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-2.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3786, dtype=torch.float64) delta_t tensor(-0.5041, dtype=torch.float64)
8 gae_duplicate tensor(-0.7747, dtype=torch.float64) tensor(9.2656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3551, dtype=torch.float64) delta_t tensor(-0.9802, dtype=torch.float64)
7 gae_duplicate tensor(-1.7750, dtype=torch.float64) tensor(19.6061, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
6 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(-0.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8682, dtype=torch.float64) delta_t tensor(-1.1485, dtype=torch.float64)
5 gae_duplicate tensor(-1.4872, dtype=torch.float64) tensor(21.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3192, dtype=torch.float64) delta_t tensor(0.5506, dtype=torch.float64)
4 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-8.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5456, dtype=torch.float64) delta_t tensor(-1.3857, dtype=torch.float64)
3 gae_duplicate tensor(-2.1624, dtype=torch.float64) tensor(26.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6839, dtype=torch.float64) delta_t tensor(0.9033, dtype=torch.float64)
2 gae_duplicate tensor(0.2210, dtype=torch.float64) tensor(-15.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2656.263671875
value loss:68.54336547851562
entropies:351.27593994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.833930730819702 seconds
19 rew tensor(1.0892, dtype=torch.float64) delta_t tensor(-0.3083, dtype=torch.float64)
19 gae_duplicate tensor(-0.4548, dtype=torch.float64) tensor(6.3051, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1044, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
18 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(4.0106, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0920, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
17 gae_duplicate tensor(-0.2787, dtype=torch.float64) tensor(-0.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7338, dtype=torch.float64) delta_t tensor(-0.2768, dtype=torch.float64)
16 gae_duplicate tensor(-1.2741, dtype=torch.float64) tensor(5.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8309, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
15 gae_duplicate tensor(-0.4547, dtype=torch.float64) tensor(2.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7544, dtype=torch.float64) delta_t tensor(0.2026, dtype=torch.float64)
14 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-3.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6760, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
13 gae_duplicate tensor(-0.0334, dtype=torch.float64) tensor(-3.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3494, dtype=torch.float64) delta_t tensor(-0.1209, dtype=torch.float64)
12 gae_duplicate tensor(-0.3458, dtype=torch.float64) tensor(2.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3107, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
11 gae_duplicate tensor(-0.5207, dtype=torch.float64) tensor(3.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0404, dtype=torch.float64) delta_t tensor(-0.2274, dtype=torch.float64)
10 gae_duplicate tensor(-0.4919, dtype=torch.float64) tensor(5.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1925, dtype=torch.float64) delta_t tensor(0.2287, dtype=torch.float64)
9 gae_duplicate tensor(0.0131, dtype=torch.float64) tensor(-3.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3957, dtype=torch.float64) delta_t tensor(-0.6731, dtype=torch.float64)
8 gae_duplicate tensor(-1.0667, dtype=torch.float64) tensor(13.1146, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7683, dtype=torch.float64) delta_t tensor(-0.5064, dtype=torch.float64)
7 gae_duplicate tensor(-1.1158, dtype=torch.float64) tensor(11.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6075, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
6 gae_duplicate tensor(-0.3749, dtype=torch.float64) tensor(0.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5530, dtype=torch.float64) delta_t tensor(-0.8683, dtype=torch.float64)
5 gae_duplicate tensor(-1.2521, dtype=torch.float64) tensor(17.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0732, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
4 gae_duplicate tensor(-0.7795, dtype=torch.float64) tensor(-1.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9064, dtype=torch.float64) delta_t tensor(-0.7794, dtype=torch.float64)
3 gae_duplicate tensor(-1.7963, dtype=torch.float64) tensor(15.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(0.5075, dtype=torch.float64)
2 gae_duplicate tensor(-0.3608, dtype=torch.float64) tensor(-8.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3722.0908203125
value loss:42.74306869506836
entropies:351.3709716796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.816711902618408 seconds
19 rew tensor(1.1100, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
19 gae_duplicate tensor(-0.4007, dtype=torch.float64) tensor(1.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1517, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
18 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(-0.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8392, dtype=torch.float64) delta_t tensor(-0.3487, dtype=torch.float64)
17 gae_duplicate tensor(-1.4617, dtype=torch.float64) tensor(6.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0601, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
16 gae_duplicate tensor(-0.3022, dtype=torch.float64) tensor(-0.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7632, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
15 gae_duplicate tensor(-1.3219, dtype=torch.float64) tensor(1.7475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4964, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-0.9391, dtype=torch.float64) tensor(1.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7533, dtype=torch.float64) delta_t tensor(0.2794, dtype=torch.float64)
13 gae_duplicate tensor(0.1484, dtype=torch.float64) tensor(-5.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3478, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
12 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(-1.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5564, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
11 gae_duplicate tensor(-0.2358, dtype=torch.float64) tensor(-3.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0776, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
10 gae_duplicate tensor(-0.6305, dtype=torch.float64) tensor(3.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4018, dtype=torch.float64) delta_t tensor(0.5674, dtype=torch.float64)
9 gae_duplicate tensor(0.0286, dtype=torch.float64) tensor(-10.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6645, dtype=torch.float64) delta_t tensor(-0.8573, dtype=torch.float64)
8 gae_duplicate tensor(-1.1508, dtype=torch.float64) tensor(15.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8655, dtype=torch.float64) delta_t tensor(-1.5081, dtype=torch.float64)
7 gae_duplicate tensor(-4.9905, dtype=torch.float64) tensor(30.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8812, dtype=torch.float64) delta_t tensor(-0.2578, dtype=torch.float64)
6 gae_duplicate tensor(-1.4324, dtype=torch.float64) tensor(8.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3711, dtype=torch.float64) delta_t tensor(-0.6408, dtype=torch.float64)
5 gae_duplicate tensor(-1.0821, dtype=torch.float64) tensor(13.9273, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0271, dtype=torch.float64) delta_t tensor(0.3273, dtype=torch.float64)
4 gae_duplicate tensor(-0.2696, dtype=torch.float64) tensor(-5.5593, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1476, dtype=torch.float64) delta_t tensor(-0.9622, dtype=torch.float64)
3 gae_duplicate tensor(-2.1126, dtype=torch.float64) tensor(18.9266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3925, dtype=torch.float64) delta_t tensor(0.5987, dtype=torch.float64)
2 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-9.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3570.74658203125
value loss:115.05329895019531
entropies:351.3302307128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.088331937789917 seconds
19 rew tensor(1.1768, dtype=torch.float64) delta_t tensor(-0.2746, dtype=torch.float64)
19 gae_duplicate tensor(-0.3771, dtype=torch.float64) tensor(5.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1011, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
18 gae_duplicate tensor(-0.3183, dtype=torch.float64) tensor(1.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0254, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
17 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(0.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9841, dtype=torch.float64) delta_t tensor(-0.1634, dtype=torch.float64)
16 gae_duplicate tensor(-0.3880, dtype=torch.float64) tensor(3.4036, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8600, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
15 gae_duplicate tensor(0.0276, dtype=torch.float64) tensor(-2.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6226, dtype=torch.float64) delta_t tensor(0.1276, dtype=torch.float64)
14 gae_duplicate tensor(-0.0094, dtype=torch.float64) tensor(-2.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7419, dtype=torch.float64) delta_t tensor(0.2658, dtype=torch.float64)
13 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-5.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2603, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
12 gae_duplicate tensor(-0.3066, dtype=torch.float64) tensor(0.5197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5294, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
11 gae_duplicate tensor(-0.2437, dtype=torch.float64) tensor(-0.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2325, dtype=torch.float64) delta_t tensor(-0.3420, dtype=torch.float64)
10 gae_duplicate tensor(-0.4973, dtype=torch.float64) tensor(6.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3849, dtype=torch.float64) delta_t tensor(0.4457, dtype=torch.float64)
9 gae_duplicate tensor(0.1352, dtype=torch.float64) tensor(-8.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4042, dtype=torch.float64) delta_t tensor(-0.6555, dtype=torch.float64)
8 gae_duplicate tensor(-0.7830, dtype=torch.float64) tensor(13.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6955, dtype=torch.float64) delta_t tensor(-0.4677, dtype=torch.float64)
7 gae_duplicate tensor(-0.8917, dtype=torch.float64) tensor(10.6120, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6101, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
6 gae_duplicate tensor(-0.3502, dtype=torch.float64) tensor(1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5073, dtype=torch.float64) delta_t tensor(-0.7730, dtype=torch.float64)
5 gae_duplicate tensor(-1.1468, dtype=torch.float64) tensor(14.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0957, dtype=torch.float64) delta_t tensor(0.1590, dtype=torch.float64)
4 gae_duplicate tensor(-0.5467, dtype=torch.float64) tensor(-1.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8429, dtype=torch.float64) delta_t tensor(-0.5989, dtype=torch.float64)
3 gae_duplicate tensor(-1.2398, dtype=torch.float64) tensor(11.2434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(0.4671, dtype=torch.float64)
2 gae_duplicate tensor(-0.3037, dtype=torch.float64) tensor(-7.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2154.387939453125
value loss:32.750633239746094
entropies:351.2179870605469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.9724)
ToM Target loss= tensor(3895.4319)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.791015148162842 seconds
19 rew tensor(1.1009, dtype=torch.float64) delta_t tensor(-0.3081, dtype=torch.float64)
19 gae_duplicate tensor(-0.4544, dtype=torch.float64) tensor(6.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1161, dtype=torch.float64) delta_t tensor(-0.1431, dtype=torch.float64)
18 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(3.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0259, dtype=torch.float64) delta_t tensor(-0.1486, dtype=torch.float64)
17 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(3.4413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9999, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
16 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(2.9748, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8579, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
15 gae_duplicate tensor(-0.3763, dtype=torch.float64) tensor(1.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
14 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-2.5035, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6229, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
13 gae_duplicate tensor(-0.3089, dtype=torch.float64) tensor(-0.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3487, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
12 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(0.5622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3620, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
11 gae_duplicate tensor(-0.3230, dtype=torch.float64) tensor(0.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0669, dtype=torch.float64) delta_t tensor(-0.2130, dtype=torch.float64)
10 gae_duplicate tensor(-0.4368, dtype=torch.float64) tensor(4.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2860, dtype=torch.float64) delta_t tensor(0.4106, dtype=torch.float64)
9 gae_duplicate tensor(0.2048, dtype=torch.float64) tensor(-7.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4885, dtype=torch.float64) delta_t tensor(-0.7215, dtype=torch.float64)
8 gae_duplicate tensor(-1.1198, dtype=torch.float64) tensor(13.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9254, dtype=torch.float64) delta_t tensor(-0.5136, dtype=torch.float64)
7 gae_duplicate tensor(-1.2720, dtype=torch.float64) tensor(11.6435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5938, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
6 gae_duplicate tensor(-0.3601, dtype=torch.float64) tensor(1.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6570, dtype=torch.float64) delta_t tensor(-0.9116, dtype=torch.float64)
5 gae_duplicate tensor(-1.2563, dtype=torch.float64) tensor(17.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0589, dtype=torch.float64) delta_t tensor(0.3485, dtype=torch.float64)
4 gae_duplicate tensor(-0.2680, dtype=torch.float64) tensor(-5.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1288, dtype=torch.float64) delta_t tensor(-0.8944, dtype=torch.float64)
3 gae_duplicate tensor(-1.9191, dtype=torch.float64) tensor(16.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4366, dtype=torch.float64) delta_t tensor(0.6449, dtype=torch.float64)
2 gae_duplicate tensor(-0.0696, dtype=torch.float64) tensor(-11.9231, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3087.169189453125
value loss:41.10374069213867
entropies:350.9822692871094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.143570184707642 seconds
19 rew tensor(1.2044, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
19 gae_duplicate tensor(-0.3444, dtype=torch.float64) tensor(4.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1674, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
18 gae_duplicate tensor(-0.2791, dtype=torch.float64) tensor(1.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0155, dtype=torch.float64) delta_t tensor(0.2495, dtype=torch.float64)
17 gae_duplicate tensor(-0.3771, dtype=torch.float64) tensor(-4.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9612, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
16 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(0.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8597, dtype=torch.float64) delta_t tensor(0.2425, dtype=torch.float64)
15 gae_duplicate tensor(0.0399, dtype=torch.float64) tensor(-5.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
14 gae_duplicate tensor(-1.6837, dtype=torch.float64) tensor(0.6630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6216, dtype=torch.float64) delta_t tensor(0.2142, dtype=torch.float64)
13 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-4.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3257, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
12 gae_duplicate tensor(-0.1769, dtype=torch.float64) tensor(-2.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.2125, dtype=torch.float64)
11 gae_duplicate tensor(-0.4315, dtype=torch.float64) tensor(-4.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1861, dtype=torch.float64) delta_t tensor(-0.1680, dtype=torch.float64)
10 gae_duplicate tensor(-0.4264, dtype=torch.float64) tensor(2.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4141, dtype=torch.float64) delta_t tensor(0.3824, dtype=torch.float64)
9 gae_duplicate tensor(0.1380, dtype=torch.float64) tensor(-6.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5677, dtype=torch.float64) delta_t tensor(-0.6666, dtype=torch.float64)
8 gae_duplicate tensor(-1.0013, dtype=torch.float64) tensor(12.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3390, dtype=torch.float64) delta_t tensor(-0.3069, dtype=torch.float64)
7 gae_duplicate tensor(-0.8821, dtype=torch.float64) tensor(6.6941, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8635, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
6 gae_duplicate tensor(-0.6263, dtype=torch.float64) tensor(4.9976, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2022, dtype=torch.float64) delta_t tensor(-0.4710, dtype=torch.float64)
5 gae_duplicate tensor(-1.1717, dtype=torch.float64) tensor(8.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2471, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
4 gae_duplicate tensor(-0.4870, dtype=torch.float64) tensor(0.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6352, dtype=torch.float64) delta_t tensor(-0.3330, dtype=torch.float64)
3 gae_duplicate tensor(-1.6680, dtype=torch.float64) tensor(5.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0930, dtype=torch.float64) delta_t tensor(0.3335, dtype=torch.float64)
2 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(-5.8319, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-926.18310546875
value loss:37.23720169067383
entropies:350.8972473144531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.920275926589966 seconds
19 rew tensor(1.2448, dtype=torch.float64) delta_t tensor(-0.1070, dtype=torch.float64)
19 gae_duplicate tensor(-0.2696, dtype=torch.float64) tensor(2.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2337, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
18 gae_duplicate tensor(-0.2198, dtype=torch.float64) tensor(-2.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0777, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
17 gae_duplicate tensor(-0.3628, dtype=torch.float64) tensor(-1.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0676, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
16 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(-4.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8728, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
15 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-3.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6055, dtype=torch.float64) delta_t tensor(-0.1388, dtype=torch.float64)
14 gae_duplicate tensor(-1.2027, dtype=torch.float64) tensor(3.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2390, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
13 gae_duplicate tensor(-1.2762, dtype=torch.float64) tensor(0.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4791, dtype=torch.float64) delta_t tensor(0.3850, dtype=torch.float64)
12 gae_duplicate tensor(0.2698, dtype=torch.float64) tensor(-7.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2211, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
11 gae_duplicate tensor(-0.4790, dtype=torch.float64) tensor(1.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0829, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
10 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(-0.7067, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5102, dtype=torch.float64) delta_t tensor(0.6202, dtype=torch.float64)
9 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-12.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5403, dtype=torch.float64) delta_t tensor(-0.6920, dtype=torch.float64)
8 gae_duplicate tensor(-0.9780, dtype=torch.float64) tensor(12.5317, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0862, dtype=torch.float64) delta_t tensor(-0.5754, dtype=torch.float64)
7 gae_duplicate tensor(-1.2976, dtype=torch.float64) tensor(13.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6853, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
6 gae_duplicate tensor(-0.4101, dtype=torch.float64) tensor(2.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6913, dtype=torch.float64) delta_t tensor(-0.7751, dtype=torch.float64)
5 gae_duplicate tensor(-1.2176, dtype=torch.float64) tensor(14.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2129, dtype=torch.float64) delta_t tensor(0.4800, dtype=torch.float64)
4 gae_duplicate tensor(0.2959, dtype=torch.float64) tensor(-8.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4452, dtype=torch.float64) delta_t tensor(-1.2192, dtype=torch.float64)
3 gae_duplicate tensor(-1.5413, dtype=torch.float64) tensor(21.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5521, dtype=torch.float64) delta_t tensor(0.7778, dtype=torch.float64)
2 gae_duplicate tensor(0.5743, dtype=torch.float64) tensor(-13.3163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1069.1070556640625
value loss:56.13943099975586
entropies:350.9364013671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.583997011184692 seconds
19 rew tensor(1.1157, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
19 gae_duplicate tensor(-0.4212, dtype=torch.float64) tensor(3.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1556, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
18 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(-1.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0918, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
17 gae_duplicate tensor(-0.3277, dtype=torch.float64) tensor(0.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0660, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
16 gae_duplicate tensor(-0.2505, dtype=torch.float64) tensor(-2.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9892, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
15 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-2.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5782, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
14 gae_duplicate tensor(-1.0347, dtype=torch.float64) tensor(-0.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0157, dtype=torch.float64) delta_t tensor(-0.3449, dtype=torch.float64)
13 gae_duplicate tensor(-1.5377, dtype=torch.float64) tensor(7.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2943, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
12 gae_duplicate tensor(-1.7958, dtype=torch.float64) tensor(3.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3064, dtype=torch.float64) delta_t tensor(-0.6303, dtype=torch.float64)
11 gae_duplicate tensor(-3.3976, dtype=torch.float64) tensor(14.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2618, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
10 gae_duplicate tensor(-0.3773, dtype=torch.float64) tensor(-4.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(0.3630, dtype=torch.float64)
9 gae_duplicate tensor(-0.2915, dtype=torch.float64) tensor(-7.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4614, dtype=torch.float64) delta_t tensor(-0.5961, dtype=torch.float64)
8 gae_duplicate tensor(-0.7716, dtype=torch.float64) tensor(10.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9705, dtype=torch.float64) delta_t tensor(-0.5472, dtype=torch.float64)
7 gae_duplicate tensor(-1.4722, dtype=torch.float64) tensor(12.7384, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5803, dtype=torch.float64) delta_t tensor(0.1125, dtype=torch.float64)
6 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-1.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7451, dtype=torch.float64) delta_t tensor(-0.9619, dtype=torch.float64)
5 gae_duplicate tensor(-1.4329, dtype=torch.float64) tensor(18.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0563, dtype=torch.float64) delta_t tensor(0.3317, dtype=torch.float64)
4 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-4.4180, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2115, dtype=torch.float64) delta_t tensor(-0.9609, dtype=torch.float64)
3 gae_duplicate tensor(-1.8934, dtype=torch.float64) tensor(17.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4082, dtype=torch.float64) delta_t tensor(0.6765, dtype=torch.float64)
2 gae_duplicate tensor(0.1073, dtype=torch.float64) tensor(-11.5391, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2993.078125
value loss:71.49807739257812
entropies:351.0476379394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7787511348724365 seconds
19 rew tensor(1.2562, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
19 gae_duplicate tensor(-0.3048, dtype=torch.float64) tensor(0.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2199, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
18 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(-2.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8024, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
17 gae_duplicate tensor(-1.1902, dtype=torch.float64) tensor(-0.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0243, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
16 gae_duplicate tensor(-0.4261, dtype=torch.float64) tensor(1.3039, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8831, dtype=torch.float64) delta_t tensor(0.2586, dtype=torch.float64)
15 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-5.1200, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
14 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-3.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8721, dtype=torch.float64) delta_t tensor(0.2742, dtype=torch.float64)
13 gae_duplicate tensor(-0.0145, dtype=torch.float64) tensor(-5.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1655, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
12 gae_duplicate tensor(-0.4336, dtype=torch.float64) tensor(-1.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1659, dtype=torch.float64) delta_t tensor(-0.5415, dtype=torch.float64)
11 gae_duplicate tensor(-4.5626, dtype=torch.float64) tensor(10.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3912, dtype=torch.float64) delta_t tensor(-0.2908, dtype=torch.float64)
10 gae_duplicate tensor(-1.7297, dtype=torch.float64) tensor(6.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4251, dtype=torch.float64) delta_t tensor(0.3684, dtype=torch.float64)
9 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(-6.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5548, dtype=torch.float64) delta_t tensor(-0.3665, dtype=torch.float64)
8 gae_duplicate tensor(-0.6896, dtype=torch.float64) tensor(6.1130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
7 gae_duplicate tensor(-0.4343, dtype=torch.float64) tensor(-4.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.2572, dtype=torch.float64) delta_t tensor(-0.5792, dtype=torch.float64)
6 gae_duplicate tensor(-1.0775, dtype=torch.float64) tensor(11.2156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6299, dtype=torch.float64) delta_t tensor(-0.1927, dtype=torch.float64)
5 gae_duplicate tensor(-0.9189, dtype=torch.float64) tensor(4.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8276, dtype=torch.float64) delta_t tensor(-0.5048, dtype=torch.float64)
4 gae_duplicate tensor(-1.1815, dtype=torch.float64) tensor(12.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(0.4429, dtype=torch.float64)
3 gae_duplicate tensor(-0.9120, dtype=torch.float64) tensor(-7.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4621, dtype=torch.float64) delta_t tensor(-0.1014, dtype=torch.float64)
2 gae_duplicate tensor(-0.5752, dtype=torch.float64) tensor(1.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1014.1980590820312
value loss:74.36422729492188
entropies:350.9988708496094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3928.6743)
ToM Target loss= tensor(3905.0176)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7557373046875 seconds
19 rew tensor(1.2549, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
19 gae_duplicate tensor(-0.3266, dtype=torch.float64) tensor(1.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2694, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
18 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-1.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8517, dtype=torch.float64) delta_t tensor(-0.1961, dtype=torch.float64)
17 gae_duplicate tensor(-1.0957, dtype=torch.float64) tensor(3.5681, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8376, dtype=torch.float64) delta_t tensor(-0.2727, dtype=torch.float64)
16 gae_duplicate tensor(-1.4584, dtype=torch.float64) tensor(5.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9609, dtype=torch.float64) delta_t tensor(0.2696, dtype=torch.float64)
15 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(-4.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1789, dtype=torch.float64) delta_t tensor(-0.1925, dtype=torch.float64)
14 gae_duplicate tensor(-2.4259, dtype=torch.float64) tensor(2.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(0.2583, dtype=torch.float64)
13 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-4.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2312, dtype=torch.float64) delta_t tensor(0.1926, dtype=torch.float64)
12 gae_duplicate tensor(-0.2515, dtype=torch.float64) tensor(-4.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5672, dtype=torch.float64) delta_t tensor(0.2387, dtype=torch.float64)
11 gae_duplicate tensor(-0.3192, dtype=torch.float64) tensor(-4.8855, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1333, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
10 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(-1.3662, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.6673, dtype=torch.float64)
9 gae_duplicate tensor(0.2708, dtype=torch.float64) tensor(-13.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7309, dtype=torch.float64) delta_t tensor(-0.7043, dtype=torch.float64)
8 gae_duplicate tensor(-0.9518, dtype=torch.float64) tensor(12.1122, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1771, dtype=torch.float64) delta_t tensor(-0.6787, dtype=torch.float64)
7 gae_duplicate tensor(-3.5733, dtype=torch.float64) tensor(14.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9314, dtype=torch.float64) delta_t tensor(-0.2196, dtype=torch.float64)
6 gae_duplicate tensor(-0.7609, dtype=torch.float64) tensor(5.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3298, dtype=torch.float64) delta_t tensor(-0.5002, dtype=torch.float64)
5 gae_duplicate tensor(-1.1049, dtype=torch.float64) tensor(10.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0069, dtype=torch.float64) delta_t tensor(0.3083, dtype=torch.float64)
4 gae_duplicate tensor(-0.4570, dtype=torch.float64) tensor(-5.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0974, dtype=torch.float64) delta_t tensor(-0.7792, dtype=torch.float64)
3 gae_duplicate tensor(-2.0328, dtype=torch.float64) tensor(14.9822, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3459, dtype=torch.float64) delta_t tensor(0.6050, dtype=torch.float64)
2 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-9.9634, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1284.3623046875
value loss:78.95000457763672
entropies:350.9722595214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.66402792930603 seconds
19 rew tensor(1.1891, dtype=torch.float64) delta_t tensor(-0.1183, dtype=torch.float64)
19 gae_duplicate tensor(-0.3318, dtype=torch.float64) tensor(1.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1383, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
18 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(0.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0363, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
17 gae_duplicate tensor(-0.2490, dtype=torch.float64) tensor(-3.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0229, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
16 gae_duplicate tensor(-0.3257, dtype=torch.float64) tensor(-1.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9334, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
15 gae_duplicate tensor(-0.2273, dtype=torch.float64) tensor(-4.5083, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
14 gae_duplicate tensor(-1.4880, dtype=torch.float64) tensor(2.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7791, dtype=torch.float64) delta_t tensor(0.2834, dtype=torch.float64)
13 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-4.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4855, dtype=torch.float64) delta_t tensor(-0.6953, dtype=torch.float64)
12 gae_duplicate tensor(-3.9960, dtype=torch.float64) tensor(13.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(-0.0885, dtype=torch.float64)
11 gae_duplicate tensor(-1.6780, dtype=torch.float64) tensor(4.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0291, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
10 gae_duplicate tensor(-0.4051, dtype=torch.float64) tensor(0.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(0.4765, dtype=torch.float64)
9 gae_duplicate tensor(0.0586, dtype=torch.float64) tensor(-8.7550, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(-0.7065, dtype=torch.float64)
8 gae_duplicate tensor(-0.9122, dtype=torch.float64) tensor(13.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3042, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
7 gae_duplicate tensor(-0.7242, dtype=torch.float64) tensor(2.9148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9054, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
6 gae_duplicate tensor(-0.3119, dtype=torch.float64) tensor(1.6760, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1682, dtype=torch.float64) delta_t tensor(-0.3890, dtype=torch.float64)
5 gae_duplicate tensor(-0.7061, dtype=torch.float64) tensor(7.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2316, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
4 gae_duplicate tensor(-0.5300, dtype=torch.float64) tensor(-0.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6196, dtype=torch.float64) delta_t tensor(-0.3026, dtype=torch.float64)
3 gae_duplicate tensor(-1.4286, dtype=torch.float64) tensor(6.5339, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0413, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
2 gae_duplicate tensor(-0.3149, dtype=torch.float64) tensor(-4.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1531.287109375
value loss:60.55125427246094
entropies:350.9407958984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038858890533447 seconds
19 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
19 gae_duplicate tensor(-0.3015, dtype=torch.float64) tensor(0.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1779, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
18 gae_duplicate tensor(-0.2066, dtype=torch.float64) tensor(-1.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1142, dtype=torch.float64) delta_t tensor(0.0732, dtype=torch.float64)
17 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(-1.6210, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9866, dtype=torch.float64) delta_t tensor(-0.0910, dtype=torch.float64)
16 gae_duplicate tensor(-0.4091, dtype=torch.float64) tensor(1.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9218, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
15 gae_duplicate tensor(-0.4246, dtype=torch.float64) tensor(-4.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7111, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
14 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-1.9386, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6197, dtype=torch.float64) delta_t tensor(0.3536, dtype=torch.float64)
13 gae_duplicate tensor(0.1147, dtype=torch.float64) tensor(-6.8382, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3332, dtype=torch.float64) delta_t tensor(0.2961, dtype=torch.float64)
12 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-6.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3881, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
11 gae_duplicate tensor(-0.4223, dtype=torch.float64) tensor(-0.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1252, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
10 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(-0.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4569, dtype=torch.float64) delta_t tensor(0.7162, dtype=torch.float64)
9 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-13.6073, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5673, dtype=torch.float64) delta_t tensor(-0.6516, dtype=torch.float64)
8 gae_duplicate tensor(-0.8872, dtype=torch.float64) tensor(11.1137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0605, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
7 gae_duplicate tensor(-0.9028, dtype=torch.float64) tensor(6.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6861, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
6 gae_duplicate tensor(-0.3880, dtype=torch.float64) tensor(1.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7395, dtype=torch.float64) delta_t tensor(-0.7912, dtype=torch.float64)
5 gae_duplicate tensor(-0.9747, dtype=torch.float64) tensor(15.2564, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1359, dtype=torch.float64) delta_t tensor(0.4248, dtype=torch.float64)
4 gae_duplicate tensor(0.0265, dtype=torch.float64) tensor(-6.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4203, dtype=torch.float64) delta_t tensor(-1.1555, dtype=torch.float64)
3 gae_duplicate tensor(-1.8280, dtype=torch.float64) tensor(22.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4732, dtype=torch.float64) delta_t tensor(0.7130, dtype=torch.float64)
2 gae_duplicate tensor(0.3701, dtype=torch.float64) tensor(-11.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-328.5461730957031
value loss:45.50303649902344
entropies:350.91357421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.055689096450806 seconds
19 rew tensor(1.1387, dtype=torch.float64) delta_t tensor(-0.2613, dtype=torch.float64)
19 gae_duplicate tensor(-0.3781, dtype=torch.float64) tensor(4.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1019, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
18 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(3.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0889, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
17 gae_duplicate tensor(-0.2244, dtype=torch.float64) tensor(-2.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(-0.2758, dtype=torch.float64)
16 gae_duplicate tensor(-0.3514, dtype=torch.float64) tensor(4.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9336, dtype=torch.float64) delta_t tensor(0.2033, dtype=torch.float64)
15 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-3.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3643, dtype=torch.float64) delta_t tensor(-0.0864, dtype=torch.float64)
14 gae_duplicate tensor(-1.2976, dtype=torch.float64) tensor(1.5459, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5752, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
13 gae_duplicate tensor(-1.3734, dtype=torch.float64) tensor(-1.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
12 gae_duplicate tensor(-0.2204, dtype=torch.float64) tensor(1.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5449, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
11 gae_duplicate tensor(-0.1289, dtype=torch.float64) tensor(-1.6910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
10 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(1.8870, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2563, dtype=torch.float64) delta_t tensor(0.2748, dtype=torch.float64)
9 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-5.0446, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4879, dtype=torch.float64) delta_t tensor(-0.6090, dtype=torch.float64)
8 gae_duplicate tensor(-0.6593, dtype=torch.float64) tensor(10.6423, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5023, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
7 gae_duplicate tensor(-0.4240, dtype=torch.float64) tensor(5.1885, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5669, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
6 gae_duplicate tensor(0.0627, dtype=torch.float64) tensor(-3.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5331, dtype=torch.float64) delta_t tensor(-0.7255, dtype=torch.float64)
5 gae_duplicate tensor(-0.8209, dtype=torch.float64) tensor(13.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1774, dtype=torch.float64) delta_t tensor(0.1500, dtype=torch.float64)
4 gae_duplicate tensor(-0.0351, dtype=torch.float64) tensor(-1.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8038, dtype=torch.float64) delta_t tensor(-0.4598, dtype=torch.float64)
3 gae_duplicate tensor(-0.7702, dtype=torch.float64) tensor(8.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1878, dtype=torch.float64) delta_t tensor(0.4362, dtype=torch.float64)
2 gae_duplicate tensor(0.1369, dtype=torch.float64) tensor(-7.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1681.780517578125
value loss:24.95513343811035
entropies:350.7448425292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.022188663482666 seconds
19 rew tensor(1.2557, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
19 gae_duplicate tensor(-0.2879, dtype=torch.float64) tensor(-1.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2312, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
18 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(-1.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9983, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
17 gae_duplicate tensor(-0.2967, dtype=torch.float64) tensor(-0.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9992, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
16 gae_duplicate tensor(-0.3025, dtype=torch.float64) tensor(-5.4855, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8693, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
15 gae_duplicate tensor(-0.3227, dtype=torch.float64) tensor(-1.2144, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9609, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
14 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-4.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2653, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
13 gae_duplicate tensor(-1.1655, dtype=torch.float64) tensor(1.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3068, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
12 gae_duplicate tensor(-1.7793, dtype=torch.float64) tensor(2.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5441, dtype=torch.float64) delta_t tensor(-0.7688, dtype=torch.float64)
11 gae_duplicate tensor(-4.3617, dtype=torch.float64) tensor(14.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1549, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
10 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-3.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2666, dtype=torch.float64) delta_t tensor(0.4820, dtype=torch.float64)
9 gae_duplicate tensor(0.2006, dtype=torch.float64) tensor(-9.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4851, dtype=torch.float64) delta_t tensor(-0.5508, dtype=torch.float64)
8 gae_duplicate tensor(-0.9579, dtype=torch.float64) tensor(9.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1738, dtype=torch.float64) delta_t tensor(-0.4221, dtype=torch.float64)
7 gae_duplicate tensor(-1.0564, dtype=torch.float64) tensor(9.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6837, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
6 gae_duplicate tensor(-0.4635, dtype=torch.float64) tensor(0.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7684, dtype=torch.float64) delta_t tensor(-0.8207, dtype=torch.float64)
5 gae_duplicate tensor(-1.2993, dtype=torch.float64) tensor(15.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2355, dtype=torch.float64) delta_t tensor(0.5163, dtype=torch.float64)
4 gae_duplicate tensor(-0.0362, dtype=torch.float64) tensor(-8.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5306, dtype=torch.float64) delta_t tensor(-1.2025, dtype=torch.float64)
3 gae_duplicate tensor(-1.5063, dtype=torch.float64) tensor(22.7847, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5747, dtype=torch.float64) delta_t tensor(0.7902, dtype=torch.float64)
2 gae_duplicate tensor(0.1280, dtype=torch.float64) tensor(-14.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1515.2003173828125
value loss:82.71757507324219
entropies:350.675048828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3935.6189)
ToM Target loss= tensor(3913.2727)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.797580003738403 seconds
19 rew tensor(1.2392, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
19 gae_duplicate tensor(-0.2962, dtype=torch.float64) tensor(0.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2407, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
18 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(-2.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1125, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
17 gae_duplicate tensor(-0.1924, dtype=torch.float64) tensor(-0.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0882, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
16 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(-2.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9715, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
15 gae_duplicate tensor(0.0288, dtype=torch.float64) tensor(-4.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5775, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
14 gae_duplicate tensor(-1.1212, dtype=torch.float64) tensor(0.7520, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4909, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
13 gae_duplicate tensor(-0.0045, dtype=torch.float64) tensor(-4.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2259, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
12 gae_duplicate tensor(-1.6710, dtype=torch.float64) tensor(1.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1849, dtype=torch.float64) delta_t tensor(-0.4118, dtype=torch.float64)
11 gae_duplicate tensor(-3.1190, dtype=torch.float64) tensor(7.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0626, dtype=torch.float64) delta_t tensor(0.2435, dtype=torch.float64)
10 gae_duplicate tensor(-0.4642, dtype=torch.float64) tensor(-3.9178, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2426, dtype=torch.float64) delta_t tensor(0.5846, dtype=torch.float64)
9 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(-11.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5865, dtype=torch.float64) delta_t tensor(-0.4896, dtype=torch.float64)
8 gae_duplicate tensor(-0.9754, dtype=torch.float64) tensor(8.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6361, dtype=torch.float64) delta_t tensor(-0.7205, dtype=torch.float64)
7 gae_duplicate tensor(-1.7942, dtype=torch.float64) tensor(15.7533, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
6 gae_duplicate tensor(-0.7349, dtype=torch.float64) tensor(1.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8426, dtype=torch.float64) delta_t tensor(-0.8436, dtype=torch.float64)
5 gae_duplicate tensor(-1.2111, dtype=torch.float64) tensor(16.2551, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3465, dtype=torch.float64) delta_t tensor(0.6062, dtype=torch.float64)
4 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-9.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7685, dtype=torch.float64) delta_t tensor(-1.3748, dtype=torch.float64)
3 gae_duplicate tensor(-1.9691, dtype=torch.float64) tensor(25.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6720, dtype=torch.float64) delta_t tensor(0.8878, dtype=torch.float64)
2 gae_duplicate tensor(0.1354, dtype=torch.float64) tensor(-14.6699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1281.1510009765625
value loss:84.8176498413086
entropies:350.70574951171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.52851676940918 seconds
19 rew tensor(1.2790, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
19 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(2.3773, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2149, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
18 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(0.5148, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0991, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
17 gae_duplicate tensor(-0.1706, dtype=torch.float64) tensor(-3.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
16 gae_duplicate tensor(-0.2883, dtype=torch.float64) tensor(-2.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8940, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
15 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-4.6296, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3944, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
14 gae_duplicate tensor(-1.4405, dtype=torch.float64) tensor(0.5436, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6460, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
13 gae_duplicate tensor(-0.0221, dtype=torch.float64) tensor(-6.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3366, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
12 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-2.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1958, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
11 gae_duplicate tensor(-0.3866, dtype=torch.float64) tensor(1.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(0.4065, dtype=torch.float64)
10 gae_duplicate tensor(0.2736, dtype=torch.float64) tensor(-8.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1826, dtype=torch.float64) delta_t tensor(0.3799, dtype=torch.float64)
9 gae_duplicate tensor(0.1052, dtype=torch.float64) tensor(-8.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5509, dtype=torch.float64) delta_t tensor(-0.4711, dtype=torch.float64)
8 gae_duplicate tensor(-0.7708, dtype=torch.float64) tensor(8.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7918, dtype=torch.float64) delta_t tensor(-0.3029, dtype=torch.float64)
7 gae_duplicate tensor(-1.1045, dtype=torch.float64) tensor(6.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7614, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
6 gae_duplicate tensor(-0.6084, dtype=torch.float64) tensor(0.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5402, dtype=torch.float64) delta_t tensor(-0.6015, dtype=torch.float64)
5 gae_duplicate tensor(-1.0188, dtype=torch.float64) tensor(11.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
4 gae_duplicate tensor(-0.3689, dtype=torch.float64) tensor(-4.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1105, dtype=torch.float64) delta_t tensor(-0.6985, dtype=torch.float64)
3 gae_duplicate tensor(-2.0023, dtype=torch.float64) tensor(12.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2725, dtype=torch.float64) delta_t tensor(0.4561, dtype=torch.float64)
2 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(-7.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:81.2275619506836
value loss:41.720367431640625
entropies:350.66131591796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.141379117965698 seconds
19 rew tensor(1.2132, dtype=torch.float64) delta_t tensor(-0.0925, dtype=torch.float64)
19 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(1.9120, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1755, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
18 gae_duplicate tensor(-0.1808, dtype=torch.float64) tensor(-0.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0981, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
17 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-2.7048, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9458, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
16 gae_duplicate tensor(-0.3526, dtype=torch.float64) tensor(1.9863, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.2846, dtype=torch.float64)
15 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(-5.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1290, dtype=torch.float64) delta_t tensor(-0.2291, dtype=torch.float64)
14 gae_duplicate tensor(-2.3522, dtype=torch.float64) tensor(5.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5687, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
13 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-4.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3206, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
12 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-3.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4669, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
11 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(-4.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0846, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
10 gae_duplicate tensor(-0.3209, dtype=torch.float64) tensor(-4.0225, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2091, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
9 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-6.9186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4863, dtype=torch.float64) delta_t tensor(-0.4112, dtype=torch.float64)
8 gae_duplicate tensor(-0.8205, dtype=torch.float64) tensor(8.0843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7545, dtype=torch.float64) delta_t tensor(-0.3772, dtype=torch.float64)
7 gae_duplicate tensor(-1.4124, dtype=torch.float64) tensor(8.4817, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
6 gae_duplicate tensor(-0.5495, dtype=torch.float64) tensor(-0.6865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4727, dtype=torch.float64) delta_t tensor(-0.5684, dtype=torch.float64)
5 gae_duplicate tensor(-1.0919, dtype=torch.float64) tensor(12.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0195, dtype=torch.float64) delta_t tensor(0.3048, dtype=torch.float64)
4 gae_duplicate tensor(-0.3837, dtype=torch.float64) tensor(-5.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9953, dtype=torch.float64) delta_t tensor(-0.6739, dtype=torch.float64)
3 gae_duplicate tensor(-1.7335, dtype=torch.float64) tensor(11.8321, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.5410, dtype=torch.float64)
2 gae_duplicate tensor(-0.3159, dtype=torch.float64) tensor(-8.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-250.41578674316406
value loss:46.916595458984375
entropies:350.59686279296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.130506992340088 seconds
19 rew tensor(1.1449, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
19 gae_duplicate tensor(-0.3365, dtype=torch.float64) tensor(1.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
18 gae_duplicate tensor(-0.2634, dtype=torch.float64) tensor(-0.5650, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0830, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
17 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(-2.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9946, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
16 gae_duplicate tensor(-0.3621, dtype=torch.float64) tensor(0.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
15 gae_duplicate tensor(-0.3444, dtype=torch.float64) tensor(-0.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8018, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
14 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-4.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7462, dtype=torch.float64) delta_t tensor(0.4009, dtype=torch.float64)
13 gae_duplicate tensor(0.2185, dtype=torch.float64) tensor(-8.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3903, dtype=torch.float64) delta_t tensor(0.2590, dtype=torch.float64)
12 gae_duplicate tensor(0.1168, dtype=torch.float64) tensor(-5.7748, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3941, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
11 gae_duplicate tensor(-0.3758, dtype=torch.float64) tensor(-0.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0024, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
10 gae_duplicate tensor(-0.1113, dtype=torch.float64) tensor(-1.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(0.4672, dtype=torch.float64)
9 gae_duplicate tensor(0.1654, dtype=torch.float64) tensor(-9.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4131, dtype=torch.float64) delta_t tensor(-0.5199, dtype=torch.float64)
8 gae_duplicate tensor(-0.6317, dtype=torch.float64) tensor(9.1120, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8366, dtype=torch.float64) delta_t tensor(-1.0892, dtype=torch.float64)
7 gae_duplicate tensor(-4.3713, dtype=torch.float64) tensor(22.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6246, dtype=torch.float64) delta_t tensor(0.0908, dtype=torch.float64)
6 gae_duplicate tensor(-1.2705, dtype=torch.float64) tensor(1.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7364, dtype=torch.float64) delta_t tensor(-0.7342, dtype=torch.float64)
5 gae_duplicate tensor(-0.9823, dtype=torch.float64) tensor(15.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1662, dtype=torch.float64) delta_t tensor(0.4811, dtype=torch.float64)
4 gae_duplicate tensor(0.0931, dtype=torch.float64) tensor(-7.6750, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4013, dtype=torch.float64) delta_t tensor(-1.0157, dtype=torch.float64)
3 gae_duplicate tensor(-1.4866, dtype=torch.float64) tensor(20.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5164, dtype=torch.float64) delta_t tensor(0.7463, dtype=torch.float64)
2 gae_duplicate tensor(0.2597, dtype=torch.float64) tensor(-12.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1027.706298828125
value loss:74.03035736083984
entropies:350.4227600097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.208180904388428 seconds
19 rew tensor(1.2253, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
19 gae_duplicate tensor(-0.3379, dtype=torch.float64) tensor(1.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
18 gae_duplicate tensor(-0.2339, dtype=torch.float64) tensor(0.5533, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
17 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(-1.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
16 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(0.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
15 gae_duplicate tensor(-0.2739, dtype=torch.float64) tensor(-2.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2517, dtype=torch.float64) delta_t tensor(-0.3987, dtype=torch.float64)
14 gae_duplicate tensor(-2.9610, dtype=torch.float64) tensor(6.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7853, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
13 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-5.2156, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1791, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
12 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(-1.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5023, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
11 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1061, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
10 gae_duplicate tensor(-0.3378, dtype=torch.float64) tensor(-1.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2571, dtype=torch.float64) delta_t tensor(0.3726, dtype=torch.float64)
9 gae_duplicate tensor(0.0465, dtype=torch.float64) tensor(-7.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5853, dtype=torch.float64) delta_t tensor(-0.5806, dtype=torch.float64)
8 gae_duplicate tensor(-0.6098, dtype=torch.float64) tensor(10.4538, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9346, dtype=torch.float64) delta_t tensor(-0.2792, dtype=torch.float64)
7 gae_duplicate tensor(-0.8378, dtype=torch.float64) tensor(7.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7040, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
6 gae_duplicate tensor(-0.2938, dtype=torch.float64) tensor(-1.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6284, dtype=torch.float64) delta_t tensor(-0.5993, dtype=torch.float64)
5 gae_duplicate tensor(-0.8364, dtype=torch.float64) tensor(10.7083, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1443, dtype=torch.float64) delta_t tensor(0.4199, dtype=torch.float64)
4 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-6.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3401, dtype=torch.float64) delta_t tensor(-0.8473, dtype=torch.float64)
3 gae_duplicate tensor(-1.8162, dtype=torch.float64) tensor(16.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(0.6887, dtype=torch.float64)
2 gae_duplicate tensor(0.1986, dtype=torch.float64) tensor(-11.4620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-868.9576416015625
value loss:47.058013916015625
entropies:350.13067626953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3925.5896)
ToM Target loss= tensor(3933.0024)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.038090944290161 seconds
19 rew tensor(1.2098, dtype=torch.float64) delta_t tensor(-0.1936, dtype=torch.float64)
19 gae_duplicate tensor(-0.2946, dtype=torch.float64) tensor(3.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1580, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
18 gae_duplicate tensor(-0.0798, dtype=torch.float64) tensor(0.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0830, dtype=torch.float64) delta_t tensor(0.1772, dtype=torch.float64)
17 gae_duplicate tensor(-0.3178, dtype=torch.float64) tensor(-3.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8620, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
16 gae_duplicate tensor(-0.3008, dtype=torch.float64) tensor(-0.7378, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8281, dtype=torch.float64) delta_t tensor(0.3747, dtype=torch.float64)
15 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-7.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7188, dtype=torch.float64) delta_t tensor(0.2851, dtype=torch.float64)
14 gae_duplicate tensor(0.2047, dtype=torch.float64) tensor(-6.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
13 gae_duplicate tensor(0.0581, dtype=torch.float64) tensor(-4.9154, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4831, dtype=torch.float64) delta_t tensor(0.2192, dtype=torch.float64)
12 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-4.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2387, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
11 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(-2.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3020, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
10 gae_duplicate tensor(-0.3469, dtype=torch.float64) tensor(-5.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0064, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
9 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-3.5050, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4615, dtype=torch.float64) delta_t tensor(-0.3177, dtype=torch.float64)
8 gae_duplicate tensor(-0.8352, dtype=torch.float64) tensor(5.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9153, dtype=torch.float64) delta_t tensor(-0.4270, dtype=torch.float64)
7 gae_duplicate tensor(-1.3929, dtype=torch.float64) tensor(8.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5521, dtype=torch.float64) delta_t tensor(0.2516, dtype=torch.float64)
6 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-3.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6650, dtype=torch.float64) delta_t tensor(-0.6726, dtype=torch.float64)
5 gae_duplicate tensor(-1.1808, dtype=torch.float64) tensor(12.8202, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0769, dtype=torch.float64) delta_t tensor(0.3893, dtype=torch.float64)
4 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(-5.9766, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1453, dtype=torch.float64) delta_t tensor(-0.6552, dtype=torch.float64)
3 gae_duplicate tensor(-1.6058, dtype=torch.float64) tensor(11.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4528, dtype=torch.float64) delta_t tensor(0.7011, dtype=torch.float64)
2 gae_duplicate tensor(0.2422, dtype=torch.float64) tensor(-11.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:836.0222778320312
value loss:43.403873443603516
entropies:349.76715087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.864552021026611 seconds
19 rew tensor(1.1072, dtype=torch.float64) delta_t tensor(-0.1315, dtype=torch.float64)
19 gae_duplicate tensor(-0.3091, dtype=torch.float64) tensor(2.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0694, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
18 gae_duplicate tensor(-0.2358, dtype=torch.float64) tensor(1.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0977, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
17 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(-4.7413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(-0.1350, dtype=torch.float64)
16 gae_duplicate tensor(-0.3421, dtype=torch.float64) tensor(2.1171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9324, dtype=torch.float64) delta_t tensor(0.3840, dtype=torch.float64)
15 gae_duplicate tensor(0.2070, dtype=torch.float64) tensor(-7.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3249, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
14 gae_duplicate tensor(-1.1635, dtype=torch.float64) tensor(0.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7756, dtype=torch.float64) delta_t tensor(0.3838, dtype=torch.float64)
13 gae_duplicate tensor(0.1471, dtype=torch.float64) tensor(-7.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2307, dtype=torch.float64) delta_t tensor(0.1272, dtype=torch.float64)
12 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-3.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2457, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
11 gae_duplicate tensor(-1.3083, dtype=torch.float64) tensor(1.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0574, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
10 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-0.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4245, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
9 gae_duplicate tensor(0.2150, dtype=torch.float64) tensor(-8.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6385, dtype=torch.float64) delta_t tensor(-0.5472, dtype=torch.float64)
8 gae_duplicate tensor(-0.6301, dtype=torch.float64) tensor(9.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2414, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
7 gae_duplicate tensor(-0.3208, dtype=torch.float64) tensor(-2.7224, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7159, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
6 gae_duplicate tensor(0.0018, dtype=torch.float64) tensor(-3.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3445, dtype=torch.float64) delta_t tensor(-0.5339, dtype=torch.float64)
5 gae_duplicate tensor(-0.9393, dtype=torch.float64) tensor(9.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3283, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
4 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(-0.0637, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6194, dtype=torch.float64) delta_t tensor(-0.2030, dtype=torch.float64)
3 gae_duplicate tensor(-0.6722, dtype=torch.float64) tensor(4.3692, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0084, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
2 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(-2.5548, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:414.1123046875
value loss:24.394451141357422
entropies:349.3070373535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.78729772567749 seconds
19 rew tensor(1.2139, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
19 gae_duplicate tensor(-0.3080, dtype=torch.float64) tensor(0.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1897, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
18 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-0.7237, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1915, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
17 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-2.7413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0753, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
16 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(-0.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0257, dtype=torch.float64) delta_t tensor(0.2577, dtype=torch.float64)
15 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(-4.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2698, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
14 gae_duplicate tensor(-1.2101, dtype=torch.float64) tensor(2.7512, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2278, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
13 gae_duplicate tensor(-1.1568, dtype=torch.float64) tensor(2.4717, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1479, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
12 gae_duplicate tensor(-0.7859, dtype=torch.float64) tensor(-1.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4661, dtype=torch.float64) delta_t tensor(0.2077, dtype=torch.float64)
11 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-3.7661, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1193, dtype=torch.float64) delta_t tensor(0.1877, dtype=torch.float64)
10 gae_duplicate tensor(0.0164, dtype=torch.float64) tensor(-3.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5446, dtype=torch.float64) delta_t tensor(0.6248, dtype=torch.float64)
9 gae_duplicate tensor(0.1356, dtype=torch.float64) tensor(-14.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5654, dtype=torch.float64) delta_t tensor(-0.6375, dtype=torch.float64)
8 gae_duplicate tensor(-0.7106, dtype=torch.float64) tensor(12.1984, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8570, dtype=torch.float64) delta_t tensor(-0.2102, dtype=torch.float64)
7 gae_duplicate tensor(-0.5084, dtype=torch.float64) tensor(4.9547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6826, dtype=torch.float64) delta_t tensor(0.1943, dtype=torch.float64)
6 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(-3.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6265, dtype=torch.float64) delta_t tensor(-0.4914, dtype=torch.float64)
5 gae_duplicate tensor(-0.7199, dtype=torch.float64) tensor(9.9269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0572, dtype=torch.float64) delta_t tensor(0.3098, dtype=torch.float64)
4 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-4.8403, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2275, dtype=torch.float64) delta_t tensor(-0.8280, dtype=torch.float64)
3 gae_duplicate tensor(-1.1586, dtype=torch.float64) tensor(16.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(0.6158, dtype=torch.float64)
2 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-11.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.016138076782227
value loss:37.433963775634766
entropies:348.8713073730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.161489009857178 seconds
19 rew tensor(1.2032, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
19 gae_duplicate tensor(-0.3236, dtype=torch.float64) tensor(1.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2302, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
18 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-1.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8114, dtype=torch.float64) delta_t tensor(-0.1700, dtype=torch.float64)
17 gae_duplicate tensor(-1.2796, dtype=torch.float64) tensor(2.7788, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9597, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
16 gae_duplicate tensor(-0.3758, dtype=torch.float64) tensor(2.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9462, dtype=torch.float64) delta_t tensor(0.3775, dtype=torch.float64)
15 gae_duplicate tensor(0.2073, dtype=torch.float64) tensor(-7.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6233, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
14 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-5.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5909, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
13 gae_duplicate tensor(-0.8583, dtype=torch.float64) tensor(-3.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1675, dtype=torch.float64) delta_t tensor(0.1253, dtype=torch.float64)
12 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-2.8055, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0251, dtype=torch.float64) delta_t tensor(-0.2783, dtype=torch.float64)
11 gae_duplicate tensor(-2.8558, dtype=torch.float64) tensor(4.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6227, dtype=torch.float64) delta_t tensor(-0.4239, dtype=torch.float64)
10 gae_duplicate tensor(-2.3300, dtype=torch.float64) tensor(10.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2096, dtype=torch.float64) delta_t tensor(0.3559, dtype=torch.float64)
9 gae_duplicate tensor(-1.2330, dtype=torch.float64) tensor(-7.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6903, dtype=torch.float64) delta_t tensor(-0.5624, dtype=torch.float64)
8 gae_duplicate tensor(-0.8016, dtype=torch.float64) tensor(10.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2727, dtype=torch.float64) delta_t tensor(0.1880, dtype=torch.float64)
7 gae_duplicate tensor(-0.4232, dtype=torch.float64) tensor(-2.3582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7974, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
6 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(-1.0701, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3513, dtype=torch.float64) delta_t tensor(-0.4440, dtype=torch.float64)
5 gae_duplicate tensor(-0.9051, dtype=torch.float64) tensor(8.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3029, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
4 gae_duplicate tensor(-0.1822, dtype=torch.float64) tensor(-0.0246, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7181, dtype=torch.float64) delta_t tensor(-0.2564, dtype=torch.float64)
3 gae_duplicate tensor(-0.8657, dtype=torch.float64) tensor(6.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0470, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
2 gae_duplicate tensor(-0.0451, dtype=torch.float64) tensor(-5.2580, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-655.70751953125
value loss:48.42463684082031
entropies:348.3166198730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.928260087966919 seconds
19 rew tensor(1.2275, dtype=torch.float64) delta_t tensor(-0.0529, dtype=torch.float64)
19 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(1.0280, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2419, dtype=torch.float64) delta_t tensor(0.2144, dtype=torch.float64)
18 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-3.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8830, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
17 gae_duplicate tensor(-1.4550, dtype=torch.float64) tensor(0.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1003, dtype=torch.float64) delta_t tensor(0.3019, dtype=torch.float64)
16 gae_duplicate tensor(-0.3178, dtype=torch.float64) tensor(-5.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(0.2289, dtype=torch.float64)
15 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(-4.7348, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
14 gae_duplicate tensor(-1.2965, dtype=torch.float64) tensor(1.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2782, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
13 gae_duplicate tensor(-1.3200, dtype=torch.float64) tensor(3.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1028, dtype=torch.float64) delta_t tensor(-0.2543, dtype=torch.float64)
12 gae_duplicate tensor(-2.7841, dtype=torch.float64) tensor(7.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1161, dtype=torch.float64) delta_t tensor(-0.4607, dtype=torch.float64)
11 gae_duplicate tensor(-3.0632, dtype=torch.float64) tensor(11.6240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
10 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(-4.9839, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4252, dtype=torch.float64) delta_t tensor(0.4322, dtype=torch.float64)
9 gae_duplicate tensor(0.1826, dtype=torch.float64) tensor(-8.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-0.3699, dtype=torch.float64)
8 gae_duplicate tensor(-0.7914, dtype=torch.float64) tensor(5.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5906, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
7 gae_duplicate tensor(-0.9575, dtype=torch.float64) tensor(0.4505, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8116, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
6 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-2.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4486, dtype=torch.float64) delta_t tensor(-0.4131, dtype=torch.float64)
5 gae_duplicate tensor(-0.8565, dtype=torch.float64) tensor(7.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0174, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
4 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-4.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1269, dtype=torch.float64) delta_t tensor(-0.7476, dtype=torch.float64)
3 gae_duplicate tensor(-1.3738, dtype=torch.float64) tensor(14.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(0.4835, dtype=torch.float64)
2 gae_duplicate tensor(-0.0289, dtype=torch.float64) tensor(-8.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-619.178955078125
value loss:65.52423095703125
entropies:347.79986572265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3908.5127)
ToM Target loss= tensor(3954.7429)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.137247800827026 seconds
19 rew tensor(1.2539, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
19 gae_duplicate tensor(-0.2931, dtype=torch.float64) tensor(1.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2160, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
18 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-2.0033, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1140, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
17 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-0.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0748, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
16 gae_duplicate tensor(-0.1874, dtype=torch.float64) tensor(-3.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9595, dtype=torch.float64) delta_t tensor(0.3758, dtype=torch.float64)
15 gae_duplicate tensor(-0.3287, dtype=torch.float64) tensor(-7.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0071, dtype=torch.float64) delta_t tensor(-0.4736, dtype=torch.float64)
14 gae_duplicate tensor(-2.7269, dtype=torch.float64) tensor(8.4241, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1114, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
13 gae_duplicate tensor(-1.5645, dtype=torch.float64) tensor(1.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2522, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
12 gae_duplicate tensor(-1.2667, dtype=torch.float64) tensor(-1.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0699, dtype=torch.float64) delta_t tensor(-0.2186, dtype=torch.float64)
11 gae_duplicate tensor(-1.8706, dtype=torch.float64) tensor(3.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1529, dtype=torch.float64) delta_t tensor(0.4195, dtype=torch.float64)
10 gae_duplicate tensor(0.0204, dtype=torch.float64) tensor(-7.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2091, dtype=torch.float64) delta_t tensor(0.4587, dtype=torch.float64)
9 gae_duplicate tensor(-0.0322, dtype=torch.float64) tensor(-9.1926, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5107, dtype=torch.float64) delta_t tensor(-0.3175, dtype=torch.float64)
8 gae_duplicate tensor(-0.6641, dtype=torch.float64) tensor(6.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1110, dtype=torch.float64) delta_t tensor(-0.2318, dtype=torch.float64)
7 gae_duplicate tensor(-1.1677, dtype=torch.float64) tensor(4.6858, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
6 gae_duplicate tensor(-0.5777, dtype=torch.float64) tensor(-1.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7278, dtype=torch.float64) delta_t tensor(-0.6599, dtype=torch.float64)
5 gae_duplicate tensor(-0.9501, dtype=torch.float64) tensor(12.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1593, dtype=torch.float64) delta_t tensor(0.4145, dtype=torch.float64)
4 gae_duplicate tensor(-0.5455, dtype=torch.float64) tensor(-6.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4690, dtype=torch.float64) delta_t tensor(-1.0371, dtype=torch.float64)
3 gae_duplicate tensor(-1.5483, dtype=torch.float64) tensor(18.8343, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.7181, dtype=torch.float64)
2 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-13.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-386.1079406738281
value loss:69.13036346435547
entropies:347.1611328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.411722183227539 seconds
19 rew tensor(1.2666, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
19 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(0.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1497, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
18 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(0.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0731, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
17 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(-1.9671, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(-0.1625, dtype=torch.float64)
16 gae_duplicate tensor(-1.4085, dtype=torch.float64) tensor(3.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9190, dtype=torch.float64) delta_t tensor(0.2294, dtype=torch.float64)
15 gae_duplicate tensor(-0.2953, dtype=torch.float64) tensor(-5.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(0.2059, dtype=torch.float64)
14 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(-4.5805, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6067, dtype=torch.float64) delta_t tensor(0.2909, dtype=torch.float64)
13 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-6.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1808, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
12 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-3.1763, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
11 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(-3.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0134, dtype=torch.float64) delta_t tensor(0.2050, dtype=torch.float64)
10 gae_duplicate tensor(-0.2140, dtype=torch.float64) tensor(-4.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4015, dtype=torch.float64) delta_t tensor(0.5783, dtype=torch.float64)
9 gae_duplicate tensor(0.3927, dtype=torch.float64) tensor(-10.9803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6379, dtype=torch.float64) delta_t tensor(-0.5804, dtype=torch.float64)
8 gae_duplicate tensor(-0.6993, dtype=torch.float64) tensor(9.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7923, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
7 gae_duplicate tensor(-0.7438, dtype=torch.float64) tensor(2.8573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7553, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
6 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(-2.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4953, dtype=torch.float64) delta_t tensor(-0.3983, dtype=torch.float64)
5 gae_duplicate tensor(-0.7569, dtype=torch.float64) tensor(7.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0350, dtype=torch.float64) delta_t tensor(0.3444, dtype=torch.float64)
4 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(-5.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1339, dtype=torch.float64) delta_t tensor(-0.6750, dtype=torch.float64)
3 gae_duplicate tensor(-1.4254, dtype=torch.float64) tensor(12.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3722, dtype=torch.float64) delta_t tensor(0.6108, dtype=torch.float64)
2 gae_duplicate tensor(-0.2810, dtype=torch.float64) tensor(-10.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1013.9588623046875
value loss:37.17018127441406
entropies:346.6882629394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.905771970748901 seconds
19 rew tensor(1.2028, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
19 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(0.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1911, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
18 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-1.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1142, dtype=torch.float64) delta_t tensor(0.1848, dtype=torch.float64)
17 gae_duplicate tensor(-0.2699, dtype=torch.float64) tensor(-3.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
16 gae_duplicate tensor(-0.2699, dtype=torch.float64) tensor(1.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9341, dtype=torch.float64) delta_t tensor(0.4105, dtype=torch.float64)
15 gae_duplicate tensor(0.2941, dtype=torch.float64) tensor(-7.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3655, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
14 gae_duplicate tensor(-1.1782, dtype=torch.float64) tensor(-1.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7678, dtype=torch.float64) delta_t tensor(0.3309, dtype=torch.float64)
13 gae_duplicate tensor(0.1006, dtype=torch.float64) tensor(-6.2265, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0192, dtype=torch.float64) delta_t tensor(-0.2375, dtype=torch.float64)
12 gae_duplicate tensor(-1.4253, dtype=torch.float64) tensor(3.5854, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0598, dtype=torch.float64) delta_t tensor(-0.2742, dtype=torch.float64)
11 gae_duplicate tensor(-3.0013, dtype=torch.float64) tensor(5.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2654, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
10 gae_duplicate tensor(-0.9717, dtype=torch.float64) tensor(1.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3988, dtype=torch.float64) delta_t tensor(0.2384, dtype=torch.float64)
9 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-4.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6910, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
8 gae_duplicate tensor(-0.4859, dtype=torch.float64) tensor(4.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(0.3504, dtype=torch.float64)
7 gae_duplicate tensor(0.1121, dtype=torch.float64) tensor(-6.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9116, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
6 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(-1.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0602, dtype=torch.float64) delta_t tensor(-0.2745, dtype=torch.float64)
5 gae_duplicate tensor(-0.8842, dtype=torch.float64) tensor(5.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4574, dtype=torch.float64) delta_t tensor(-0.0886, dtype=torch.float64)
4 gae_duplicate tensor(-0.4319, dtype=torch.float64) tensor(2.2566, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3728, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
3 gae_duplicate tensor(-0.5106, dtype=torch.float64) tensor(-2.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
2 gae_duplicate tensor(-0.0437, dtype=torch.float64) tensor(-1.7827, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:515.8842163085938
value loss:38.18659973144531
entropies:346.2758483886719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.39403772354126 seconds
19 rew tensor(1.2185, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
19 gae_duplicate tensor(-0.3331, dtype=torch.float64) tensor(1.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1669, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
18 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(1.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0641, dtype=torch.float64) delta_t tensor(0.2968, dtype=torch.float64)
17 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-5.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(-0.1070, dtype=torch.float64)
16 gae_duplicate tensor(-0.2884, dtype=torch.float64) tensor(1.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9216, dtype=torch.float64) delta_t tensor(0.3719, dtype=torch.float64)
15 gae_duplicate tensor(0.2501, dtype=torch.float64) tensor(-6.7729, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4639, dtype=torch.float64) delta_t tensor(0.1797, dtype=torch.float64)
14 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-4.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8701, dtype=torch.float64) delta_t tensor(0.4318, dtype=torch.float64)
13 gae_duplicate tensor(0.2287, dtype=torch.float64) tensor(-8.1992, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0608, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
12 gae_duplicate tensor(-0.1633, dtype=torch.float64) tensor(-2.9797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6332, dtype=torch.float64) delta_t tensor(0.2802, dtype=torch.float64)
11 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-5.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1598, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
10 gae_duplicate tensor(-0.3995, dtype=torch.float64) tensor(1.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4679, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
9 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-8.5272, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6162, dtype=torch.float64) delta_t tensor(-0.4772, dtype=torch.float64)
8 gae_duplicate tensor(-0.5373, dtype=torch.float64) tensor(8.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2244, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
7 gae_duplicate tensor(-0.5037, dtype=torch.float64) tensor(-1.5671, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7474, dtype=torch.float64) delta_t tensor(0.2144, dtype=torch.float64)
6 gae_duplicate tensor(-0.0052, dtype=torch.float64) tensor(-4.5239, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2667, dtype=torch.float64) delta_t tensor(-0.2729, dtype=torch.float64)
5 gae_duplicate tensor(-0.7725, dtype=torch.float64) tensor(4.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3324, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
4 gae_duplicate tensor(-0.3099, dtype=torch.float64) tensor(-0.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5650, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
3 gae_duplicate tensor(-0.6619, dtype=torch.float64) tensor(0.9399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
2 gae_duplicate tensor(-0.2867, dtype=torch.float64) tensor(-4.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1668.114013671875
value loss:19.728511810302734
entropies:345.8990478515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.85377311706543 seconds
19 rew tensor(1.1635, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
19 gae_duplicate tensor(-0.3093, dtype=torch.float64) tensor(-0.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
18 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(-2.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0748, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
17 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(-1.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0760, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
16 gae_duplicate tensor(-0.2742, dtype=torch.float64) tensor(-1.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.1991, dtype=torch.float64)
15 gae_duplicate tensor(-0.1843, dtype=torch.float64) tensor(-4.2488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2990, dtype=torch.float64) delta_t tensor(-0.2674, dtype=torch.float64)
14 gae_duplicate tensor(-1.5653, dtype=torch.float64) tensor(3.3890, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6211, dtype=torch.float64) delta_t tensor(0.3156, dtype=torch.float64)
13 gae_duplicate tensor(0.1529, dtype=torch.float64) tensor(-5.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4014, dtype=torch.float64) delta_t tensor(0.3103, dtype=torch.float64)
12 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-6.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4648, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
11 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-3.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1192, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
10 gae_duplicate tensor(-0.2710, dtype=torch.float64) tensor(-1.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4774, dtype=torch.float64) delta_t tensor(0.7958, dtype=torch.float64)
9 gae_duplicate tensor(0.4934, dtype=torch.float64) tensor(-16.3037, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5345, dtype=torch.float64) delta_t tensor(-0.6322, dtype=torch.float64)
8 gae_duplicate tensor(-0.8650, dtype=torch.float64) tensor(10.0823, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4937, dtype=torch.float64) delta_t tensor(-0.4958, dtype=torch.float64)
7 gae_duplicate tensor(-1.4645, dtype=torch.float64) tensor(10.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6796, dtype=torch.float64) delta_t tensor(0.1859, dtype=torch.float64)
6 gae_duplicate tensor(-0.6236, dtype=torch.float64) tensor(-2.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7370, dtype=torch.float64) delta_t tensor(-0.4927, dtype=torch.float64)
5 gae_duplicate tensor(-0.8028, dtype=torch.float64) tensor(9.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3184, dtype=torch.float64) delta_t tensor(0.5395, dtype=torch.float64)
4 gae_duplicate tensor(0.2616, dtype=torch.float64) tensor(-9.3366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5663, dtype=torch.float64) delta_t tensor(-1.1376, dtype=torch.float64)
3 gae_duplicate tensor(-1.3248, dtype=torch.float64) tensor(23.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6827, dtype=torch.float64) delta_t tensor(0.8595, dtype=torch.float64)
2 gae_duplicate tensor(0.5247, dtype=torch.float64) tensor(-14.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:622.0735473632812
value loss:54.71063995361328
entropies:345.4937744140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3890.4341)
ToM Target loss= tensor(3963.8955)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.911035060882568 seconds
19 rew tensor(1.1524, dtype=torch.float64) delta_t tensor(-0.2424, dtype=torch.float64)
19 gae_duplicate tensor(-0.3228, dtype=torch.float64) tensor(4.6703, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1407, dtype=torch.float64) delta_t tensor(-0.1169, dtype=torch.float64)
18 gae_duplicate tensor(-0.2913, dtype=torch.float64) tensor(3.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1542, dtype=torch.float64) delta_t tensor(0.1199, dtype=torch.float64)
17 gae_duplicate tensor(-0.2392, dtype=torch.float64) tensor(-2.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0369, dtype=torch.float64) delta_t tensor(-0.1306, dtype=torch.float64)
16 gae_duplicate tensor(-0.2277, dtype=torch.float64) tensor(2.5019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9340, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
15 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-4.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4143, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
14 gae_duplicate tensor(-1.2280, dtype=torch.float64) tensor(-1.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3651, dtype=torch.float64) delta_t tensor(2.3921e-05, dtype=torch.float64)
13 gae_duplicate tensor(-1.3115, dtype=torch.float64) tensor(-0.9374, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
12 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(-3.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
11 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-4.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2259, dtype=torch.float64) delta_t tensor(0.2022, dtype=torch.float64)
10 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-4.3622, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5185, dtype=torch.float64) delta_t tensor(0.5492, dtype=torch.float64)
9 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-10.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5925, dtype=torch.float64) delta_t tensor(-0.5092, dtype=torch.float64)
8 gae_duplicate tensor(-0.6758, dtype=torch.float64) tensor(8.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3852, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
7 gae_duplicate tensor(-0.3111, dtype=torch.float64) tensor(-0.2958, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7637, dtype=torch.float64) delta_t tensor(0.1472, dtype=torch.float64)
6 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-3.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3141, dtype=torch.float64) delta_t tensor(-0.2784, dtype=torch.float64)
5 gae_duplicate tensor(-0.5311, dtype=torch.float64) tensor(4.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2324, dtype=torch.float64) delta_t tensor(0.1288, dtype=torch.float64)
4 gae_duplicate tensor(-0.1201, dtype=torch.float64) tensor(-1.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7008, dtype=torch.float64) delta_t tensor(-0.2734, dtype=torch.float64)
3 gae_duplicate tensor(-0.9683, dtype=torch.float64) tensor(4.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1057, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
2 gae_duplicate tensor(-0.3734, dtype=torch.float64) tensor(-4.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:667.883544921875
value loss:25.320743560791016
entropies:345.2930603027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.413214921951294 seconds
19 rew tensor(1.1021, dtype=torch.float64) delta_t tensor(-0.2569, dtype=torch.float64)
19 gae_duplicate tensor(-0.3244, dtype=torch.float64) tensor(4.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0634, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
18 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(1.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0383, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
17 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(-0.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9612, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
16 gae_duplicate tensor(-0.3367, dtype=torch.float64) tensor(1.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
15 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-2.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6876, dtype=torch.float64) delta_t tensor(0.1881, dtype=torch.float64)
14 gae_duplicate tensor(0.0759, dtype=torch.float64) tensor(-3.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6987, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
13 gae_duplicate tensor(0.1311, dtype=torch.float64) tensor(-5.0911, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2833, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
12 gae_duplicate tensor(-0.0005, dtype=torch.float64) tensor(-3.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
11 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-3.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1615, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
10 gae_duplicate tensor(-0.2779, dtype=torch.float64) tensor(-0.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3364, dtype=torch.float64) delta_t tensor(0.4342, dtype=torch.float64)
9 gae_duplicate tensor(0.0792, dtype=torch.float64) tensor(-9.4564, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4620, dtype=torch.float64) delta_t tensor(-0.4740, dtype=torch.float64)
8 gae_duplicate tensor(-0.6195, dtype=torch.float64) tensor(7.7189, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7095, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
7 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(2.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5542, dtype=torch.float64) delta_t tensor(0.3425, dtype=torch.float64)
6 gae_duplicate tensor(0.1856, dtype=torch.float64) tensor(-6.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6105, dtype=torch.float64) delta_t tensor(-0.5704, dtype=torch.float64)
5 gae_duplicate tensor(-0.8467, dtype=torch.float64) tensor(11.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0715, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
4 gae_duplicate tensor(0.0179, dtype=torch.float64) tensor(-3.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9483, dtype=torch.float64) delta_t tensor(-0.5679, dtype=torch.float64)
3 gae_duplicate tensor(-1.1157, dtype=torch.float64) tensor(10.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2928, dtype=torch.float64) delta_t tensor(0.4486, dtype=torch.float64)
2 gae_duplicate tensor(0.1116, dtype=torch.float64) tensor(-7.3750, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:215.55300903320312
value loss:19.2740535736084
entropies:345.2406005859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.989006042480469 seconds
19 rew tensor(1.1674, dtype=torch.float64) delta_t tensor(-0.0666, dtype=torch.float64)
19 gae_duplicate tensor(-0.3722, dtype=torch.float64) tensor(1.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1679, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
18 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(-3.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0261, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
17 gae_duplicate tensor(-0.3127, dtype=torch.float64) tensor(-2.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9624, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
16 gae_duplicate tensor(-0.2734, dtype=torch.float64) tensor(-2.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(0.2012, dtype=torch.float64)
15 gae_duplicate tensor(-0.2847, dtype=torch.float64) tensor(-4.3313, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5525, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
14 gae_duplicate tensor(-1.4661, dtype=torch.float64) tensor(-1.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5702, dtype=torch.float64) delta_t tensor(0.2190, dtype=torch.float64)
13 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-4.2720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4536, dtype=torch.float64) delta_t tensor(0.3593, dtype=torch.float64)
12 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(-7.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4407, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
11 gae_duplicate tensor(-0.3339, dtype=torch.float64) tensor(-2.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1354, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
10 gae_duplicate tensor(-0.3215, dtype=torch.float64) tensor(0.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4672, dtype=torch.float64) delta_t tensor(0.6248, dtype=torch.float64)
9 gae_duplicate tensor(0.0333, dtype=torch.float64) tensor(-11.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5393, dtype=torch.float64) delta_t tensor(-0.5566, dtype=torch.float64)
8 gae_duplicate tensor(-0.7602, dtype=torch.float64) tensor(9.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9721, dtype=torch.float64) delta_t tensor(-0.0813, dtype=torch.float64)
7 gae_duplicate tensor(-0.6060, dtype=torch.float64) tensor(2.2822, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6711, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
6 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(-3.9933, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6903, dtype=torch.float64) delta_t tensor(-0.4255, dtype=torch.float64)
5 gae_duplicate tensor(-0.7390, dtype=torch.float64) tensor(7.3987, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1119, dtype=torch.float64) delta_t tensor(0.3578, dtype=torch.float64)
4 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-6.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3272, dtype=torch.float64) delta_t tensor(-0.8303, dtype=torch.float64)
3 gae_duplicate tensor(-1.3221, dtype=torch.float64) tensor(15.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4376, dtype=torch.float64) delta_t tensor(0.5781, dtype=torch.float64)
2 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-9.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1132.390380859375
value loss:36.761619567871094
entropies:345.1716003417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.176419019699097 seconds
19 rew tensor(1.1945, dtype=torch.float64) delta_t tensor(-0.1916, dtype=torch.float64)
19 gae_duplicate tensor(-0.3552, dtype=torch.float64) tensor(3.5610, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1824, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
18 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(1.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1187, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
17 gae_duplicate tensor(-0.2762, dtype=torch.float64) tensor(1.9225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0670, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
16 gae_duplicate tensor(-0.2786, dtype=torch.float64) tensor(0.7915, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6601, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
15 gae_duplicate tensor(-1.1386, dtype=torch.float64) tensor(0.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6192, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
14 gae_duplicate tensor(-1.2722, dtype=torch.float64) tensor(-0.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0407, dtype=torch.float64) delta_t tensor(-0.2616, dtype=torch.float64)
13 gae_duplicate tensor(-2.7591, dtype=torch.float64) tensor(4.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0531, dtype=torch.float64) delta_t tensor(-0.2740, dtype=torch.float64)
12 gae_duplicate tensor(-2.8872, dtype=torch.float64) tensor(5.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1412, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
11 gae_duplicate tensor(-0.4251, dtype=torch.float64) tensor(1.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1377, dtype=torch.float64) delta_t tensor(0.4312, dtype=torch.float64)
10 gae_duplicate tensor(0.0971, dtype=torch.float64) tensor(-7.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1964, dtype=torch.float64) delta_t tensor(0.4745, dtype=torch.float64)
9 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-9.5868, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3855, dtype=torch.float64) delta_t tensor(-0.4202, dtype=torch.float64)
8 gae_duplicate tensor(-0.5340, dtype=torch.float64) tensor(7.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1872, dtype=torch.float64) delta_t tensor(-0.3835, dtype=torch.float64)
7 gae_duplicate tensor(-0.9910, dtype=torch.float64) tensor(8.4695, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4906, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
6 gae_duplicate tensor(0.0796, dtype=torch.float64) tensor(-5.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8967, dtype=torch.float64) delta_t tensor(-0.7076, dtype=torch.float64)
5 gae_duplicate tensor(-0.8866, dtype=torch.float64) tensor(12.5076, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1079, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
4 gae_duplicate tensor(0.0960, dtype=torch.float64) tensor(-6.2938, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3634, dtype=torch.float64) delta_t tensor(-0.8281, dtype=torch.float64)
3 gae_duplicate tensor(-1.2401, dtype=torch.float64) tensor(15.6359, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.6080, dtype=torch.float64)
2 gae_duplicate tensor(0.2523, dtype=torch.float64) tensor(-9.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1413.3382568359375
value loss:58.990455627441406
entropies:345.1163330078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.455110311508179 seconds
19 rew tensor(1.2544, dtype=torch.float64) delta_t tensor(0.0694, dtype=torch.float64)
19 gae_duplicate tensor(-0.2340, dtype=torch.float64) tensor(-1.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2555, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
18 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-5.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1511, dtype=torch.float64) delta_t tensor(0.2812, dtype=torch.float64)
17 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-6.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0865, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
16 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(-2.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9960, dtype=torch.float64) delta_t tensor(0.2972, dtype=torch.float64)
15 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(-5.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8387, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
14 gae_duplicate tensor(-0.2791, dtype=torch.float64) tensor(-4.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0179, dtype=torch.float64) delta_t tensor(-0.4026, dtype=torch.float64)
13 gae_duplicate tensor(-3.9175, dtype=torch.float64) tensor(6.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2010, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
12 gae_duplicate tensor(-1.4980, dtype=torch.float64) tensor(2.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2940, dtype=torch.float64) delta_t tensor(-0.4952, dtype=torch.float64)
11 gae_duplicate tensor(-2.8019, dtype=torch.float64) tensor(8.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9285, dtype=torch.float64) delta_t tensor(-0.6226, dtype=torch.float64)
10 gae_duplicate tensor(-5.3650, dtype=torch.float64) tensor(11.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2217, dtype=torch.float64) delta_t tensor(0.3821, dtype=torch.float64)
9 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(-5.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6552, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
8 gae_duplicate tensor(-0.4543, dtype=torch.float64) tensor(1.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8365, dtype=torch.float64) delta_t tensor(-0.1390, dtype=torch.float64)
7 gae_duplicate tensor(-2.1544, dtype=torch.float64) tensor(3.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9703, dtype=torch.float64) delta_t tensor(-0.1519, dtype=torch.float64)
6 gae_duplicate tensor(-0.5490, dtype=torch.float64) tensor(3.0858, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3713, dtype=torch.float64) delta_t tensor(-0.4537, dtype=torch.float64)
5 gae_duplicate tensor(-1.0961, dtype=torch.float64) tensor(8.5058, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1239, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
4 gae_duplicate tensor(-0.8525, dtype=torch.float64) tensor(-1.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0588, dtype=torch.float64) delta_t tensor(-0.5175, dtype=torch.float64)
3 gae_duplicate tensor(-1.5600, dtype=torch.float64) tensor(9.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(0.4192, dtype=torch.float64)
2 gae_duplicate tensor(-0.3119, dtype=torch.float64) tensor(-7.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-967.7950439453125
value loss:126.78018188476562
entropies:345.0235595703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3888.5759)
ToM Target loss= tensor(3980.2451)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.233742713928223 seconds
19 rew tensor(1.1996, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
19 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(1.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1743, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
18 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-0.8403, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1495, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
17 gae_duplicate tensor(-0.2715, dtype=torch.float64) tensor(-1.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0593, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
16 gae_duplicate tensor(-0.2675, dtype=torch.float64) tensor(1.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.2446, dtype=torch.float64)
15 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-4.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.3010, dtype=torch.float64)
14 gae_duplicate tensor(0.1364, dtype=torch.float64) tensor(-6.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.3017, dtype=torch.float64)
13 gae_duplicate tensor(0.0840, dtype=torch.float64) tensor(-6.1096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(0.1579, dtype=torch.float64)
12 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-3.7883, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3524, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
11 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-2.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0066, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
10 gae_duplicate tensor(-0.0602, dtype=torch.float64) tensor(-3.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3025, dtype=torch.float64) delta_t tensor(0.5659, dtype=torch.float64)
9 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-10.6782, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5208, dtype=torch.float64) delta_t tensor(-0.4033, dtype=torch.float64)
8 gae_duplicate tensor(-0.5806, dtype=torch.float64) tensor(6.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9236, dtype=torch.float64) delta_t tensor(-1.0402, dtype=torch.float64)
7 gae_duplicate tensor(-4.3777, dtype=torch.float64) tensor(24.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7211, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
6 gae_duplicate tensor(-1.2732, dtype=torch.float64) tensor(-0.3440, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7269, dtype=torch.float64) delta_t tensor(-0.5284, dtype=torch.float64)
5 gae_duplicate tensor(-1.1105, dtype=torch.float64) tensor(9.6822, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2149, dtype=torch.float64) delta_t tensor(0.4789, dtype=torch.float64)
4 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(-8.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5110, dtype=torch.float64) delta_t tensor(-0.9413, dtype=torch.float64)
3 gae_duplicate tensor(-1.6009, dtype=torch.float64) tensor(16.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5520, dtype=torch.float64) delta_t tensor(0.7034, dtype=torch.float64)
2 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-12.1964, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-29.306459426879883
value loss:73.56474304199219
entropies:345.1552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.133351802825928 seconds
19 rew tensor(1.1857, dtype=torch.float64) delta_t tensor(-0.1835, dtype=torch.float64)
19 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(3.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1603, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
18 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(1.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1735, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
17 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(1.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
16 gae_duplicate tensor(-0.3420, dtype=torch.float64) tensor(1.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9288, dtype=torch.float64) delta_t tensor(0.2645, dtype=torch.float64)
15 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(-4.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4315, dtype=torch.float64) delta_t tensor(-0.0338, dtype=torch.float64)
14 gae_duplicate tensor(-1.2049, dtype=torch.float64) tensor(0.0431, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7616, dtype=torch.float64) delta_t tensor(0.3160, dtype=torch.float64)
13 gae_duplicate tensor(0.1444, dtype=torch.float64) tensor(-5.8378, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2813, dtype=torch.float64) delta_t tensor(0.1068, dtype=torch.float64)
12 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-2.7795, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1915, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
11 gae_duplicate tensor(-1.3458, dtype=torch.float64) tensor(0.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(0.2618, dtype=torch.float64)
10 gae_duplicate tensor(-0.2283, dtype=torch.float64) tensor(-5.4998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3144, dtype=torch.float64) delta_t tensor(0.5250, dtype=torch.float64)
9 gae_duplicate tensor(0.1956, dtype=torch.float64) tensor(-11.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6097, dtype=torch.float64) delta_t tensor(-0.3081, dtype=torch.float64)
8 gae_duplicate tensor(-0.6569, dtype=torch.float64) tensor(4.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5389, dtype=torch.float64) delta_t tensor(-0.7476, dtype=torch.float64)
7 gae_duplicate tensor(-4.6145, dtype=torch.float64) tensor(13.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8068, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
6 gae_duplicate tensor(-1.0952, dtype=torch.float64) tensor(-0.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4887, dtype=torch.float64) delta_t tensor(-0.4011, dtype=torch.float64)
5 gae_duplicate tensor(-0.6740, dtype=torch.float64) tensor(7.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0550, dtype=torch.float64) delta_t tensor(0.3345, dtype=torch.float64)
4 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(-4.9027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2004, dtype=torch.float64) delta_t tensor(-0.7233, dtype=torch.float64)
3 gae_duplicate tensor(-1.5384, dtype=torch.float64) tensor(14.3555, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4176, dtype=torch.float64) delta_t tensor(0.6648, dtype=torch.float64)
2 gae_duplicate tensor(0.0742, dtype=torch.float64) tensor(-10.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-209.1846923828125
value loss:68.75616455078125
entropies:345.0644226074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.124873161315918 seconds
19 rew tensor(1.2515, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
19 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(2.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2132, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
18 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(-2.0305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9943, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
17 gae_duplicate tensor(-0.2663, dtype=torch.float64) tensor(-0.9829, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(-0.1168, dtype=torch.float64)
16 gae_duplicate tensor(-0.2578, dtype=torch.float64) tensor(2.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
15 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(-4.7311, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0788, dtype=torch.float64) delta_t tensor(-0.3241, dtype=torch.float64)
14 gae_duplicate tensor(-1.3758, dtype=torch.float64) tensor(5.2440, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6715, dtype=torch.float64) delta_t tensor(0.3370, dtype=torch.float64)
13 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-6.5877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(0.2221, dtype=torch.float64)
12 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(-5.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5186, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
11 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-4.9129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2001, dtype=torch.float64) delta_t tensor(0.2491, dtype=torch.float64)
10 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-5.1157, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.5821, dtype=torch.float64)
9 gae_duplicate tensor(0.3630, dtype=torch.float64) tensor(-12.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8660, dtype=torch.float64) delta_t tensor(-0.4105, dtype=torch.float64)
8 gae_duplicate tensor(-0.8677, dtype=torch.float64) tensor(6.2747, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0359, dtype=torch.float64) delta_t tensor(0.3138, dtype=torch.float64)
7 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-5.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9991, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
6 gae_duplicate tensor(-0.4881, dtype=torch.float64) tensor(0.2055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0794, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
5 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(2.1238, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3752, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
4 gae_duplicate tensor(-0.3701, dtype=torch.float64) tensor(0.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5661, dtype=torch.float64) delta_t tensor(-0.2161, dtype=torch.float64)
3 gae_duplicate tensor(-1.2740, dtype=torch.float64) tensor(4.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0259, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
2 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-3.2997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1384.7850341796875
value loss:27.489097595214844
entropies:344.96923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.440230131149292 seconds
19 rew tensor(1.2258, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
19 gae_duplicate tensor(-0.3193, dtype=torch.float64) tensor(2.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2136, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
18 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(-0.6740, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1369, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
17 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-2.3966, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0461, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
16 gae_duplicate tensor(-0.3219, dtype=torch.float64) tensor(-2.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0219, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
15 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-1.6598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
14 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(-2.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0552, dtype=torch.float64) delta_t tensor(-0.4394, dtype=torch.float64)
13 gae_duplicate tensor(-1.3513, dtype=torch.float64) tensor(7.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0981, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
12 gae_duplicate tensor(-0.7340, dtype=torch.float64) tensor(-2.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3734, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
11 gae_duplicate tensor(-0.2178, dtype=torch.float64) tensor(-0.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0018, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
10 gae_duplicate tensor(-0.3186, dtype=torch.float64) tensor(-2.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5396, dtype=torch.float64) delta_t tensor(0.4795, dtype=torch.float64)
9 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-9.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6476, dtype=torch.float64) delta_t tensor(-0.5751, dtype=torch.float64)
8 gae_duplicate tensor(-0.7298, dtype=torch.float64) tensor(10.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8029, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
7 gae_duplicate tensor(-0.3101, dtype=torch.float64) tensor(-0.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7514, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
6 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-4.9521, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5460, dtype=torch.float64) delta_t tensor(-0.2930, dtype=torch.float64)
5 gae_duplicate tensor(-0.6120, dtype=torch.float64) tensor(4.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0828, dtype=torch.float64) delta_t tensor(0.2950, dtype=torch.float64)
4 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-5.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2822, dtype=torch.float64) delta_t tensor(-0.6536, dtype=torch.float64)
3 gae_duplicate tensor(-1.3880, dtype=torch.float64) tensor(12.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4188, dtype=torch.float64) delta_t tensor(0.5154, dtype=torch.float64)
2 gae_duplicate tensor(0.1723, dtype=torch.float64) tensor(-9.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:274.51190185546875
value loss:31.854717254638672
entropies:345.0339660644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.131319046020508 seconds
19 rew tensor(1.2514, dtype=torch.float64) delta_t tensor(-0.1265, dtype=torch.float64)
19 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(2.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2394, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
18 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(0.7288, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1119, dtype=torch.float64) delta_t tensor(3.3265e-05, dtype=torch.float64)
17 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(0.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7845, dtype=torch.float64) delta_t tensor(-0.3810, dtype=torch.float64)
16 gae_duplicate tensor(-1.6466, dtype=torch.float64) tensor(8.7516, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9423, dtype=torch.float64) delta_t tensor(0.3212, dtype=torch.float64)
15 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(-5.5167, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0050, dtype=torch.float64) delta_t tensor(-0.5735, dtype=torch.float64)
14 gae_duplicate tensor(-2.6537, dtype=torch.float64) tensor(10.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
13 gae_duplicate tensor(-0.3618, dtype=torch.float64) tensor(-1.3038, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2574, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
12 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(-2.3990, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
11 gae_duplicate tensor(-0.2723, dtype=torch.float64) tensor(-0.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0139, dtype=torch.float64) delta_t tensor(0.3546, dtype=torch.float64)
10 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-6.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(0.4815, dtype=torch.float64)
9 gae_duplicate tensor(0.3267, dtype=torch.float64) tensor(-9.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7162, dtype=torch.float64) delta_t tensor(-0.3324, dtype=torch.float64)
8 gae_duplicate tensor(-0.4863, dtype=torch.float64) tensor(5.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7283, dtype=torch.float64) delta_t tensor(0.1681, dtype=torch.float64)
7 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-2.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7806, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
6 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-3.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5146, dtype=torch.float64) delta_t tensor(-0.2862, dtype=torch.float64)
5 gae_duplicate tensor(-0.5851, dtype=torch.float64) tensor(4.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0533, dtype=torch.float64) delta_t tensor(0.2854, dtype=torch.float64)
4 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(-4.6976, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2249, dtype=torch.float64) delta_t tensor(-0.7457, dtype=torch.float64)
3 gae_duplicate tensor(-1.3740, dtype=torch.float64) tensor(13.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3896, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
2 gae_duplicate tensor(-0.2205, dtype=torch.float64) tensor(-7.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-153.8786163330078
value loss:42.99839782714844
entropies:345.28680419921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3890.7788)
ToM Target loss= tensor(3985.4524)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.016856908798218 seconds
19 rew tensor(1.1475, dtype=torch.float64) delta_t tensor(-0.2529, dtype=torch.float64)
19 gae_duplicate tensor(-0.3994, dtype=torch.float64) tensor(5.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1087, dtype=torch.float64) delta_t tensor(-0.1223, dtype=torch.float64)
18 gae_duplicate tensor(-0.2608, dtype=torch.float64) tensor(2.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0572, dtype=torch.float64) delta_t tensor(-0.1231, dtype=torch.float64)
17 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(2.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0711, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
16 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(0.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8898, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
15 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(-1.5741, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3120, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
14 gae_duplicate tensor(-2.5469, dtype=torch.float64) tensor(7.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4905, dtype=torch.float64) delta_t tensor(0.1821, dtype=torch.float64)
13 gae_duplicate tensor(-0.3605, dtype=torch.float64) tensor(-2.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5053, dtype=torch.float64) delta_t tensor(0.2787, dtype=torch.float64)
12 gae_duplicate tensor(-0.0190, dtype=torch.float64) tensor(-5.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
11 gae_duplicate tensor(-0.3180, dtype=torch.float64) tensor(-1.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1428, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
10 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-4.6305, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2414, dtype=torch.float64) delta_t tensor(0.4163, dtype=torch.float64)
9 gae_duplicate tensor(0.0949, dtype=torch.float64) tensor(-8.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4016, dtype=torch.float64) delta_t tensor(-0.3970, dtype=torch.float64)
8 gae_duplicate tensor(-0.6829, dtype=torch.float64) tensor(6.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1068, dtype=torch.float64) delta_t tensor(-0.2882, dtype=torch.float64)
7 gae_duplicate tensor(-0.9654, dtype=torch.float64) tensor(5.8039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5192, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
6 gae_duplicate tensor(0.1146, dtype=torch.float64) tensor(-5.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7540, dtype=torch.float64) delta_t tensor(-0.4343, dtype=torch.float64)
5 gae_duplicate tensor(-0.7909, dtype=torch.float64) tensor(7.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(0.3632, dtype=torch.float64)
4 gae_duplicate tensor(0.1868, dtype=torch.float64) tensor(-5.8172, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3028, dtype=torch.float64) delta_t tensor(-0.6929, dtype=torch.float64)
3 gae_duplicate tensor(-1.3066, dtype=torch.float64) tensor(12.3327, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5150, dtype=torch.float64) delta_t tensor(0.6188, dtype=torch.float64)
2 gae_duplicate tensor(0.3797, dtype=torch.float64) tensor(-10.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-411.9427795410156
value loss:35.10784149169922
entropies:345.4938049316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841525077819824 seconds
19 rew tensor(1.2247, dtype=torch.float64) delta_t tensor(-0.2091, dtype=torch.float64)
19 gae_duplicate tensor(-0.2709, dtype=torch.float64) tensor(4.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2271, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
18 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(-0.2756, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1360, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
17 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(-0.5247, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0095, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.2136, dtype=torch.float64) tensor(0.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9958, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
15 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-6.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0019, dtype=torch.float64) delta_t tensor(-0.3931, dtype=torch.float64)
14 gae_duplicate tensor(-1.3460, dtype=torch.float64) tensor(7.7592, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6319, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
13 gae_duplicate tensor(0.0297, dtype=torch.float64) tensor(-5.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2301, dtype=torch.float64) delta_t tensor(0.2282, dtype=torch.float64)
12 gae_duplicate tensor(-0.2402, dtype=torch.float64) tensor(-4.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3418, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
11 gae_duplicate tensor(-1.3224, dtype=torch.float64) tensor(-2.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1850, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
10 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(-2.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.6944, dtype=torch.float64)
9 gae_duplicate tensor(0.2690, dtype=torch.float64) tensor(-13.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9494, dtype=torch.float64) delta_t tensor(-0.4411, dtype=torch.float64)
8 gae_duplicate tensor(-0.8578, dtype=torch.float64) tensor(7.0904, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4578, dtype=torch.float64) delta_t tensor(0.1577, dtype=torch.float64)
7 gae_duplicate tensor(-1.3708, dtype=torch.float64) tensor(-2.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9763, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
6 gae_duplicate tensor(-0.5327, dtype=torch.float64) tensor(-0.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2069, dtype=torch.float64) delta_t tensor(-0.1655, dtype=torch.float64)
5 gae_duplicate tensor(-0.5703, dtype=torch.float64) tensor(3.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2235, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
4 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(-1.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8206, dtype=torch.float64) delta_t tensor(-0.3457, dtype=torch.float64)
3 gae_duplicate tensor(-1.1762, dtype=torch.float64) tensor(6.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(0.2042, dtype=torch.float64)
2 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-3.0487, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:697.9844360351562
value loss:35.53194046020508
entropies:345.5020751953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.722442865371704 seconds
19 rew tensor(1.1751, dtype=torch.float64) delta_t tensor(-0.1965, dtype=torch.float64)
19 gae_duplicate tensor(-0.2657, dtype=torch.float64) tensor(3.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1893, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
18 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(1.2661, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0869, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
17 gae_duplicate tensor(-0.2978, dtype=torch.float64) tensor(1.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7186, dtype=torch.float64) delta_t tensor(-0.1800, dtype=torch.float64)
16 gae_duplicate tensor(-1.1278, dtype=torch.float64) tensor(5.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
15 gae_duplicate tensor(-0.3734, dtype=torch.float64) tensor(0.2545, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
14 gae_duplicate tensor(0.1211, dtype=torch.float64) tensor(-5.3794, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0069, dtype=torch.float64) delta_t tensor(-0.3840, dtype=torch.float64)
13 gae_duplicate tensor(-2.8333, dtype=torch.float64) tensor(6.0907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4656, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
12 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(-4.1904, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2954, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
11 gae_duplicate tensor(-0.3744, dtype=torch.float64) tensor(-1.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0888, dtype=torch.float64) delta_t tensor(0.2455, dtype=torch.float64)
10 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-5.0785, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3873, dtype=torch.float64) delta_t tensor(0.3980, dtype=torch.float64)
9 gae_duplicate tensor(0.1707, dtype=torch.float64) tensor(-8.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6388, dtype=torch.float64) delta_t tensor(-0.3241, dtype=torch.float64)
8 gae_duplicate tensor(-0.4415, dtype=torch.float64) tensor(5.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5179, dtype=torch.float64) delta_t tensor(0.0001, dtype=torch.float64)
7 gae_duplicate tensor(-0.6840, dtype=torch.float64) tensor(0.6360, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6911, dtype=torch.float64) delta_t tensor(0.2303, dtype=torch.float64)
6 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(-3.9560, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4415, dtype=torch.float64) delta_t tensor(-0.4275, dtype=torch.float64)
5 gae_duplicate tensor(-0.6242, dtype=torch.float64) tensor(8.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1487, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
4 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(-1.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8457, dtype=torch.float64) delta_t tensor(-0.3736, dtype=torch.float64)
3 gae_duplicate tensor(-1.0653, dtype=torch.float64) tensor(7.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2136, dtype=torch.float64) delta_t tensor(0.3977, dtype=torch.float64)
2 gae_duplicate tensor(0.0153, dtype=torch.float64) tensor(-6.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-271.23406982421875
value loss:33.297569274902344
entropies:345.46612548828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.977016925811768 seconds
19 rew tensor(1.0975, dtype=torch.float64) delta_t tensor(-0.2369, dtype=torch.float64)
19 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(4.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1112, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
18 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(2.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9956, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
17 gae_duplicate tensor(-0.3517, dtype=torch.float64) tensor(1.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9300, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
16 gae_duplicate tensor(-0.2968, dtype=torch.float64) tensor(3.7456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8535, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
15 gae_duplicate tensor(-0.3469, dtype=torch.float64) tensor(-1.4096, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6459, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
14 gae_duplicate tensor(0.0105, dtype=torch.float64) tensor(-2.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7515, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
13 gae_duplicate tensor(0.0986, dtype=torch.float64) tensor(-4.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2692, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
12 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(-1.8453, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4790, dtype=torch.float64) delta_t tensor(0.0708, dtype=torch.float64)
11 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(-1.5369, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1062, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
10 gae_duplicate tensor(-0.3243, dtype=torch.float64) tensor(-1.1046, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3067, dtype=torch.float64) delta_t tensor(0.3504, dtype=torch.float64)
9 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-6.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4818, dtype=torch.float64) delta_t tensor(-0.3943, dtype=torch.float64)
8 gae_duplicate tensor(-0.4504, dtype=torch.float64) tensor(6.4205, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6134, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
7 gae_duplicate tensor(-0.3432, dtype=torch.float64) tensor(-0.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5479, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
6 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-5.5313, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5486, dtype=torch.float64) delta_t tensor(-0.4618, dtype=torch.float64)
5 gae_duplicate tensor(-0.8203, dtype=torch.float64) tensor(7.9124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1207, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
4 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-1.9021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8494, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
3 gae_duplicate tensor(-0.6947, dtype=torch.float64) tensor(4.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(0.4016, dtype=torch.float64)
2 gae_duplicate tensor(0.1411, dtype=torch.float64) tensor(-7.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:177.8812713623047
value loss:15.58869743347168
entropies:345.30059814453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.918677091598511 seconds
19 rew tensor(1.1647, dtype=torch.float64) delta_t tensor(-0.2208, dtype=torch.float64)
19 gae_duplicate tensor(-0.3892, dtype=torch.float64) tensor(3.9956, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2034, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
18 gae_duplicate tensor(-0.1148, dtype=torch.float64) tensor(0.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0479, dtype=torch.float64) delta_t tensor(-0.1835, dtype=torch.float64)
17 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(3.5778, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9574, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
16 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(2.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9057, dtype=torch.float64) delta_t tensor(0.2043, dtype=torch.float64)
15 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-3.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5926, dtype=torch.float64) delta_t tensor(0.1742, dtype=torch.float64)
14 gae_duplicate tensor(0.0248, dtype=torch.float64) tensor(-3.8497, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4835, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
13 gae_duplicate tensor(-1.3336, dtype=torch.float64) tensor(-0.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1242, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
12 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-4.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4800, dtype=torch.float64) delta_t tensor(0.1499, dtype=torch.float64)
11 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(-3.5119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1337, dtype=torch.float64) delta_t tensor(0.2508, dtype=torch.float64)
10 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-5.5705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(0.4402, dtype=torch.float64)
9 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-8.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8643, dtype=torch.float64) delta_t tensor(-0.2904, dtype=torch.float64)
8 gae_duplicate tensor(-0.4726, dtype=torch.float64) tensor(5.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1203, dtype=torch.float64) delta_t tensor(0.3845, dtype=torch.float64)
7 gae_duplicate tensor(0.1056, dtype=torch.float64) tensor(-7.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9038, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
6 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-0.3998, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0776, dtype=torch.float64) delta_t tensor(-0.1406, dtype=torch.float64)
5 gae_duplicate tensor(-0.3518, dtype=torch.float64) tensor(2.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4639, dtype=torch.float64) delta_t tensor(-0.1014, dtype=torch.float64)
4 gae_duplicate tensor(-0.2659, dtype=torch.float64) tensor(2.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4007, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
3 gae_duplicate tensor(-0.6614, dtype=torch.float64) tensor(0.0928, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1000, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
2 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(0.9838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:758.9169311523438
value loss:15.818061828613281
entropies:345.2938232421875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3877.1172)
ToM Target loss= tensor(3996.5054)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.891649007797241 seconds
19 rew tensor(1.1917, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
19 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(3.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2053, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
18 gae_duplicate tensor(-0.1401, dtype=torch.float64) tensor(0.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(-0.2736, dtype=torch.float64)
17 gae_duplicate tensor(-1.3135, dtype=torch.float64) tensor(4.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
16 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(1.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.1444, dtype=torch.float64)
15 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-2.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
14 gae_duplicate tensor(-1.1859, dtype=torch.float64) tensor(-0.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.2518, dtype=torch.float64)
13 gae_duplicate tensor(0.1770, dtype=torch.float64) tensor(-4.9458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0445, dtype=torch.float64) delta_t tensor(-0.1266, dtype=torch.float64)
12 gae_duplicate tensor(-1.6264, dtype=torch.float64) tensor(1.7172, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3898, dtype=torch.float64) delta_t tensor(0.1366, dtype=torch.float64)
11 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(-2.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0326, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
10 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(-5.1613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(0.2587, dtype=torch.float64)
9 gae_duplicate tensor(0.2020, dtype=torch.float64) tensor(-5.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6803, dtype=torch.float64) delta_t tensor(-0.2238, dtype=torch.float64)
8 gae_duplicate tensor(-0.4828, dtype=torch.float64) tensor(3.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6568, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
7 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(-2.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7468, dtype=torch.float64) delta_t tensor(0.2004, dtype=torch.float64)
6 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(-4.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5015, dtype=torch.float64) delta_t tensor(-0.4517, dtype=torch.float64)
5 gae_duplicate tensor(-0.7750, dtype=torch.float64) tensor(7.8500, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0163, dtype=torch.float64) delta_t tensor(0.2243, dtype=torch.float64)
4 gae_duplicate tensor(-0.2940, dtype=torch.float64) tensor(-3.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0898, dtype=torch.float64) delta_t tensor(-0.5887, dtype=torch.float64)
3 gae_duplicate tensor(-1.3846, dtype=torch.float64) tensor(11.9473, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3478, dtype=torch.float64) delta_t tensor(0.4719, dtype=torch.float64)
2 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(-8.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:69.28446197509766
value loss:33.6570930480957
entropies:345.26531982421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.893970012664795 seconds
19 rew tensor(1.2043, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
19 gae_duplicate tensor(-0.2737, dtype=torch.float64) tensor(3.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1400, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
18 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(1.4838, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0629, dtype=torch.float64) delta_t tensor(-0.1015, dtype=torch.float64)
17 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(2.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0517, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
16 gae_duplicate tensor(-0.3259, dtype=torch.float64) tensor(-1.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9336, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
15 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(-1.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(0.3015, dtype=torch.float64)
14 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-5.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4066, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
13 gae_duplicate tensor(-1.2393, dtype=torch.float64) tensor(-1.0731, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4776, dtype=torch.float64) delta_t tensor(-0.5295, dtype=torch.float64)
12 gae_duplicate tensor(-2.0724, dtype=torch.float64) tensor(9.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3322, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
11 gae_duplicate tensor(-0.3834, dtype=torch.float64) tensor(1.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0017, dtype=torch.float64) delta_t tensor(0.1822, dtype=torch.float64)
10 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-3.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4662, dtype=torch.float64) delta_t tensor(0.5435, dtype=torch.float64)
9 gae_duplicate tensor(0.1968, dtype=torch.float64) tensor(-11.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5511, dtype=torch.float64) delta_t tensor(-0.3813, dtype=torch.float64)
8 gae_duplicate tensor(-0.7138, dtype=torch.float64) tensor(6.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7054, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
7 gae_duplicate tensor(-0.4602, dtype=torch.float64) tensor(-2.4987, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8011, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
6 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-2.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4736, dtype=torch.float64) delta_t tensor(-0.3557, dtype=torch.float64)
5 gae_duplicate tensor(-0.6392, dtype=torch.float64) tensor(6.8028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0721, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
4 gae_duplicate tensor(-0.6571, dtype=torch.float64) tensor(-2.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0732, dtype=torch.float64) delta_t tensor(-0.5593, dtype=torch.float64)
3 gae_duplicate tensor(-1.1184, dtype=torch.float64) tensor(10.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2659, dtype=torch.float64) delta_t tensor(0.4097, dtype=torch.float64)
2 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(-6.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-279.0611267089844
value loss:35.1223030090332
entropies:345.22216796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9962239265441895 seconds
19 rew tensor(1.1642, dtype=torch.float64) delta_t tensor(-0.1548, dtype=torch.float64)
19 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(2.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1527, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
18 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(0.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0753, dtype=torch.float64) delta_t tensor(-0.1043, dtype=torch.float64)
17 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(1.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9974, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
16 gae_duplicate tensor(-0.2035, dtype=torch.float64) tensor(-0.3165, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8393, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
15 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-2.3950, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.1964, dtype=torch.float64)
14 gae_duplicate tensor(-0.0015, dtype=torch.float64) tensor(-4.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3525, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
13 gae_duplicate tensor(-1.3311, dtype=torch.float64) tensor(-1.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3870, dtype=torch.float64) delta_t tensor(0.2306, dtype=torch.float64)
12 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-4.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2835, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
11 gae_duplicate tensor(-0.3671, dtype=torch.float64) tensor(-0.0066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1670, dtype=torch.float64) delta_t tensor(0.2284, dtype=torch.float64)
10 gae_duplicate tensor(-0.3083, dtype=torch.float64) tensor(-4.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2265, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
9 gae_duplicate tensor(-0.0994, dtype=torch.float64) tensor(-3.4923, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6115, dtype=torch.float64) delta_t tensor(-0.1605, dtype=torch.float64)
8 gae_duplicate tensor(-0.4411, dtype=torch.float64) tensor(2.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4185, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
7 gae_duplicate tensor(-0.9624, dtype=torch.float64) tensor(-0.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6517, dtype=torch.float64) delta_t tensor(0.2354, dtype=torch.float64)
6 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(-4.6566, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4559, dtype=torch.float64) delta_t tensor(-0.3018, dtype=torch.float64)
5 gae_duplicate tensor(-1.0439, dtype=torch.float64) tensor(5.6273, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2223, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
4 gae_duplicate tensor(-0.2641, dtype=torch.float64) tensor(-0.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7546, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
3 gae_duplicate tensor(-1.1187, dtype=torch.float64) tensor(2.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1420, dtype=torch.float64) delta_t tensor(0.3147, dtype=torch.float64)
2 gae_duplicate tensor(-0.2571, dtype=torch.float64) tensor(-5.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:663.5326538085938
value loss:21.152639389038086
entropies:345.25543212890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932820081710815 seconds
19 rew tensor(1.2279, dtype=torch.float64) delta_t tensor(-0.1140, dtype=torch.float64)
19 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(2.0716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2421, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
18 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(-0.5143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9098, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
17 gae_duplicate tensor(-1.3991, dtype=torch.float64) tensor(6.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0208, dtype=torch.float64) delta_t tensor(-0.0149, dtype=torch.float64)
16 gae_duplicate tensor(-0.2557, dtype=torch.float64) tensor(0.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9186, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
15 gae_duplicate tensor(-0.3138, dtype=torch.float64) tensor(-0.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5006, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
14 gae_duplicate tensor(-1.1550, dtype=torch.float64) tensor(1.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5813, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
13 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-2.7176, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3357, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
12 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(-1.6047, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2569, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
11 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(-0.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0635, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
10 gae_duplicate tensor(0.0501, dtype=torch.float64) tensor(-4.1685, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1803, dtype=torch.float64) delta_t tensor(0.4650, dtype=torch.float64)
9 gae_duplicate tensor(0.2661, dtype=torch.float64) tensor(-9.3218, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-0.4716, dtype=torch.float64)
8 gae_duplicate tensor(-0.5805, dtype=torch.float64) tensor(7.6703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8884, dtype=torch.float64) delta_t tensor(-0.7023, dtype=torch.float64)
7 gae_duplicate tensor(-2.2033, dtype=torch.float64) tensor(13.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
6 gae_duplicate tensor(-0.3785, dtype=torch.float64) tensor(1.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7833, dtype=torch.float64) delta_t tensor(-0.4060, dtype=torch.float64)
5 gae_duplicate tensor(-0.5960, dtype=torch.float64) tensor(8.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3925, dtype=torch.float64) delta_t tensor(0.5173, dtype=torch.float64)
4 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(-9.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7402, dtype=torch.float64) delta_t tensor(-1.0435, dtype=torch.float64)
3 gae_duplicate tensor(-1.5401, dtype=torch.float64) tensor(17.9924, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7312, dtype=torch.float64) delta_t tensor(0.7856, dtype=torch.float64)
2 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-12.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1124.253662109375
value loss:49.39280700683594
entropies:345.2736511230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.758910894393921 seconds
19 rew tensor(1.1502, dtype=torch.float64) delta_t tensor(-0.1312, dtype=torch.float64)
19 gae_duplicate tensor(-0.2499, dtype=torch.float64) tensor(2.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0980, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
18 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-0.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0472, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
17 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(1.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8084, dtype=torch.float64) delta_t tensor(-0.2057, dtype=torch.float64)
16 gae_duplicate tensor(-1.6243, dtype=torch.float64) tensor(5.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(-0.0767, dtype=torch.float64)
15 gae_duplicate tensor(-0.3320, dtype=torch.float64) tensor(2.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7494, dtype=torch.float64) delta_t tensor(0.2252, dtype=torch.float64)
14 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-4.1997, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6198, dtype=torch.float64) delta_t tensor(0.2028, dtype=torch.float64)
13 gae_duplicate tensor(0.0758, dtype=torch.float64) tensor(-4.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3733, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
12 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-2.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3385, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
11 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(-0.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0320, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
10 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(-1.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1959, dtype=torch.float64) delta_t tensor(0.4113, dtype=torch.float64)
9 gae_duplicate tensor(0.2034, dtype=torch.float64) tensor(-8.4526, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4062, dtype=torch.float64) delta_t tensor(-0.4013, dtype=torch.float64)
8 gae_duplicate tensor(-0.6897, dtype=torch.float64) tensor(6.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3391, dtype=torch.float64) delta_t tensor(-0.1509, dtype=torch.float64)
7 gae_duplicate tensor(-0.3890, dtype=torch.float64) tensor(3.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(0.3409, dtype=torch.float64)
6 gae_duplicate tensor(0.1721, dtype=torch.float64) tensor(-7.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8334, dtype=torch.float64) delta_t tensor(-0.5602, dtype=torch.float64)
5 gae_duplicate tensor(-0.8414, dtype=torch.float64) tensor(10.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3205, dtype=torch.float64) delta_t tensor(0.4423, dtype=torch.float64)
4 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-8.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5246, dtype=torch.float64) delta_t tensor(-0.9906, dtype=torch.float64)
3 gae_duplicate tensor(-1.2987, dtype=torch.float64) tensor(17.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6845, dtype=torch.float64) delta_t tensor(0.7437, dtype=torch.float64)
2 gae_duplicate tensor(0.1631, dtype=torch.float64) tensor(-11.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-70.08161926269531
value loss:32.6362419128418
entropies:345.216064453125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3904.8157)
ToM Target loss= tensor(3993.8445)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.095337867736816 seconds
19 rew tensor(1.1351, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
19 gae_duplicate tensor(-0.2650, dtype=torch.float64) tensor(1.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1497, dtype=torch.float64) delta_t tensor(0.0009, dtype=torch.float64)
18 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(0.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0980, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
17 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(0.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7948, dtype=torch.float64) delta_t tensor(-0.3056, dtype=torch.float64)
16 gae_duplicate tensor(-1.6101, dtype=torch.float64) tensor(5.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
15 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(-0.9377, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7121, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
14 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-3.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7486, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
13 gae_duplicate tensor(0.0889, dtype=torch.float64) tensor(-5.0199, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2829, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
12 gae_duplicate tensor(-0.2175, dtype=torch.float64) tensor(-1.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4499, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
11 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(-1.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0664, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
10 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(-0.1425, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3214, dtype=torch.float64) delta_t tensor(0.4883, dtype=torch.float64)
9 gae_duplicate tensor(0.1619, dtype=torch.float64) tensor(-10.5886, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4798, dtype=torch.float64) delta_t tensor(-0.4084, dtype=torch.float64)
8 gae_duplicate tensor(-0.6564, dtype=torch.float64) tensor(6.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4877, dtype=torch.float64) delta_t tensor(-0.5718, dtype=torch.float64)
7 gae_duplicate tensor(-3.1359, dtype=torch.float64) tensor(10.9663, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7187, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
6 gae_duplicate tensor(-0.8577, dtype=torch.float64) tensor(-0.9640, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5184, dtype=torch.float64) delta_t tensor(-0.4454, dtype=torch.float64)
5 gae_duplicate tensor(-0.8042, dtype=torch.float64) tensor(8.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0548, dtype=torch.float64) delta_t tensor(0.2724, dtype=torch.float64)
4 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(-4.9842, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0584, dtype=torch.float64) delta_t tensor(-0.4816, dtype=torch.float64)
3 gae_duplicate tensor(-1.3135, dtype=torch.float64) tensor(8.5971, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3526, dtype=torch.float64) delta_t tensor(0.4667, dtype=torch.float64)
2 gae_duplicate tensor(-0.2416, dtype=torch.float64) tensor(-8.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-432.4507141113281
value loss:43.77570343017578
entropies:345.1535949707031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.838736057281494 seconds
19 rew tensor(1.2272, dtype=torch.float64) delta_t tensor(-0.0588, dtype=torch.float64)
19 gae_duplicate tensor(-0.1196, dtype=torch.float64) tensor(1.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1913, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
18 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-0.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0345, dtype=torch.float64) delta_t tensor(-0.0667, dtype=torch.float64)
17 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(1.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9181, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
16 gae_duplicate tensor(-0.2754, dtype=torch.float64) tensor(0.4715, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8163, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
15 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-4.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
14 gae_duplicate tensor(0.1464, dtype=torch.float64) tensor(-3.8054, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2702, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
13 gae_duplicate tensor(-1.0128, dtype=torch.float64) tensor(0.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4355, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
12 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(-1.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1559, dtype=torch.float64) delta_t tensor(-0.2218, dtype=torch.float64)
11 gae_duplicate tensor(-1.5870, dtype=torch.float64) tensor(3.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2816, dtype=torch.float64) delta_t tensor(0.2748, dtype=torch.float64)
10 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(-4.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1450, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
9 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-4.4279, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5923, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
8 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(1.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6936, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
7 gae_duplicate tensor(-0.9584, dtype=torch.float64) tensor(0.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6569, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
6 gae_duplicate tensor(0.1221, dtype=torch.float64) tensor(-3.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5933, dtype=torch.float64) delta_t tensor(-0.3661, dtype=torch.float64)
5 gae_duplicate tensor(-0.8630, dtype=torch.float64) tensor(7.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0982, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
4 gae_duplicate tensor(-0.3069, dtype=torch.float64) tensor(-2.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0257, dtype=torch.float64) delta_t tensor(-0.4595, dtype=torch.float64)
3 gae_duplicate tensor(-1.2073, dtype=torch.float64) tensor(8.2903, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2395, dtype=torch.float64) delta_t tensor(0.2477, dtype=torch.float64)
2 gae_duplicate tensor(-0.2906, dtype=torch.float64) tensor(-3.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:229.13125610351562
value loss:28.1668701171875
entropies:345.2481689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.090184211730957 seconds
19 rew tensor(1.1860, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
19 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(2.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1733, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
18 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-0.0961, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1083, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
17 gae_duplicate tensor(-0.1243, dtype=torch.float64) tensor(-0.0668, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0183, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
16 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-1.4499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(0.1743, dtype=torch.float64)
15 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-4.3608, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4657, dtype=torch.float64) delta_t tensor(-0.1563, dtype=torch.float64)
14 gae_duplicate tensor(-1.1225, dtype=torch.float64) tensor(1.7507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.2614, dtype=torch.float64)
13 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-4.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3537, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
12 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-1.3642, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4561, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
11 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(-2.7009, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2241, dtype=torch.float64) delta_t tensor(0.5567, dtype=torch.float64)
10 gae_duplicate tensor(-0.3906, dtype=torch.float64) tensor(-10.3140, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3405, dtype=torch.float64) delta_t tensor(0.3007, dtype=torch.float64)
9 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-6.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4582, dtype=torch.float64) delta_t tensor(-0.1250, dtype=torch.float64)
8 gae_duplicate tensor(-0.5572, dtype=torch.float64) tensor(1.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2283, dtype=torch.float64) delta_t tensor(-0.6443, dtype=torch.float64)
7 gae_duplicate tensor(-4.2062, dtype=torch.float64) tensor(16.4674, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1084, dtype=torch.float64) delta_t tensor(-0.2567, dtype=torch.float64)
6 gae_duplicate tensor(-1.4350, dtype=torch.float64) tensor(6.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8626, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
5 gae_duplicate tensor(-0.8843, dtype=torch.float64) tensor(-0.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3683, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
4 gae_duplicate tensor(-0.7581, dtype=torch.float64) tensor(0.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4230, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
3 gae_duplicate tensor(-1.0063, dtype=torch.float64) tensor(-0.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0963, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
2 gae_duplicate tensor(-0.4829, dtype=torch.float64) tensor(-1.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:172.98513793945312
value loss:62.446868896484375
entropies:345.2379455566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.77265191078186 seconds
19 rew tensor(1.2141, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
19 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(1.8788, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1615, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
18 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-0.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8585, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
17 gae_duplicate tensor(-1.1945, dtype=torch.float64) tensor(-1.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9553, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
16 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-0.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9549, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
15 gae_duplicate tensor(0.0660, dtype=torch.float64) tensor(-5.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1311, dtype=torch.float64) delta_t tensor(-0.2799, dtype=torch.float64)
14 gae_duplicate tensor(-1.2071, dtype=torch.float64) tensor(5.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6685, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
13 gae_duplicate tensor(-0.0221, dtype=torch.float64) tensor(-4.5919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2448, dtype=torch.float64) delta_t tensor(0.2992, dtype=torch.float64)
12 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-5.9330, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6425, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
11 gae_duplicate tensor(0.0898, dtype=torch.float64) tensor(-4.3392, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1562, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
10 gae_duplicate tensor(-0.3136, dtype=torch.float64) tensor(1.7968, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5417, dtype=torch.float64) delta_t tensor(0.3584, dtype=torch.float64)
9 gae_duplicate tensor(-0.0414, dtype=torch.float64) tensor(-6.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(-0.4386, dtype=torch.float64)
8 gae_duplicate tensor(-0.7451, dtype=torch.float64) tensor(7.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7049, dtype=torch.float64) delta_t tensor(-0.0540, dtype=torch.float64)
7 gae_duplicate tensor(-1.2612, dtype=torch.float64) tensor(1.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7944, dtype=torch.float64) delta_t tensor(0.1704, dtype=torch.float64)
6 gae_duplicate tensor(-0.5724, dtype=torch.float64) tensor(-2.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3905, dtype=torch.float64) delta_t tensor(-0.1838, dtype=torch.float64)
5 gae_duplicate tensor(-0.3378, dtype=torch.float64) tensor(3.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1251, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
4 gae_duplicate tensor(-0.3099, dtype=torch.float64) tensor(-0.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9205, dtype=torch.float64) delta_t tensor(-0.3392, dtype=torch.float64)
3 gae_duplicate tensor(-0.7437, dtype=torch.float64) tensor(6.4513, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2248, dtype=torch.float64) delta_t tensor(0.2259, dtype=torch.float64)
2 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-4.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:436.53045654296875
value loss:24.846004486083984
entropies:345.09246826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.223872900009155 seconds
19 rew tensor(1.2122, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
19 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(1.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8603, dtype=torch.float64) delta_t tensor(-0.2847, dtype=torch.float64)
18 gae_duplicate tensor(-1.6502, dtype=torch.float64) tensor(5.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0329, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
17 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(0.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0360, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
16 gae_duplicate tensor(-0.2497, dtype=torch.float64) tensor(-1.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
15 gae_duplicate tensor(-0.2185, dtype=torch.float64) tensor(-1.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9448, dtype=torch.float64) delta_t tensor(0.3169, dtype=torch.float64)
14 gae_duplicate tensor(0.1783, dtype=torch.float64) tensor(-5.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3469, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
13 gae_duplicate tensor(-1.0260, dtype=torch.float64) tensor(-0.8320, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2877, dtype=torch.float64) delta_t tensor(-0.5272, dtype=torch.float64)
12 gae_duplicate tensor(-2.6054, dtype=torch.float64) tensor(9.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0175, dtype=torch.float64) delta_t tensor(-0.2624, dtype=torch.float64)
11 gae_duplicate tensor(-1.9921, dtype=torch.float64) tensor(5.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1973, dtype=torch.float64) delta_t tensor(0.2428, dtype=torch.float64)
10 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-3.9183, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2980, dtype=torch.float64) delta_t tensor(0.4799, dtype=torch.float64)
9 gae_duplicate tensor(0.1027, dtype=torch.float64) tensor(-9.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5084, dtype=torch.float64) delta_t tensor(-0.2508, dtype=torch.float64)
8 gae_duplicate tensor(-0.4823, dtype=torch.float64) tensor(4.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9370, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
7 gae_duplicate tensor(-0.9453, dtype=torch.float64) tensor(-0.2113, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5875, dtype=torch.float64) delta_t tensor(0.2008, dtype=torch.float64)
6 gae_duplicate tensor(0.0793, dtype=torch.float64) tensor(-3.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7049, dtype=torch.float64) delta_t tensor(-0.3713, dtype=torch.float64)
5 gae_duplicate tensor(-0.6983, dtype=torch.float64) tensor(6.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0330, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
4 gae_duplicate tensor(-0.2623, dtype=torch.float64) tensor(-2.6413, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1988, dtype=torch.float64) delta_t tensor(-0.4796, dtype=torch.float64)
3 gae_duplicate tensor(-1.0142, dtype=torch.float64) tensor(8.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3833, dtype=torch.float64) delta_t tensor(0.4656, dtype=torch.float64)
2 gae_duplicate tensor(0.1333, dtype=torch.float64) tensor(-7.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-312.0847473144531
value loss:46.444969177246094
entropies:344.96923828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3912.6328)
ToM Target loss= tensor(3987.3101)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1787567138671875 seconds
19 rew tensor(1.2248, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
19 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-0.1757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2123, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
18 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(-2.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1621, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
17 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(-1.8327, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1242, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
16 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-1.8484, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0727, dtype=torch.float64) delta_t tensor(0.3283, dtype=torch.float64)
15 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-6.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2700, dtype=torch.float64) delta_t tensor(-0.2198, dtype=torch.float64)
14 gae_duplicate tensor(-2.3517, dtype=torch.float64) tensor(3.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4581, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
13 gae_duplicate tensor(-1.3511, dtype=torch.float64) tensor(0.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3200, dtype=torch.float64) delta_t tensor(0.2537, dtype=torch.float64)
12 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-5.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9710, dtype=torch.float64) delta_t tensor(-1.3154, dtype=torch.float64)
11 gae_duplicate tensor(-7.9309, dtype=torch.float64) tensor(23.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1199, dtype=torch.float64) delta_t tensor(0.2725, dtype=torch.float64)
10 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(-2.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3490, dtype=torch.float64) delta_t tensor(0.2573, dtype=torch.float64)
9 gae_duplicate tensor(-0.1590, dtype=torch.float64) tensor(-5.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4979, dtype=torch.float64) delta_t tensor(-0.2357, dtype=torch.float64)
8 gae_duplicate tensor(-0.7503, dtype=torch.float64) tensor(3.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4932, dtype=torch.float64) delta_t tensor(0.2848, dtype=torch.float64)
7 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-4.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8329, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
6 gae_duplicate tensor(-0.0067, dtype=torch.float64) tensor(-3.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4012, dtype=torch.float64) delta_t tensor(-0.2845, dtype=torch.float64)
5 gae_duplicate tensor(-0.9119, dtype=torch.float64) tensor(4.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2465, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
4 gae_duplicate tensor(-0.6156, dtype=torch.float64) tensor(1.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8233, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
3 gae_duplicate tensor(-0.7359, dtype=torch.float64) tensor(5.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0265, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
2 gae_duplicate tensor(-0.3592, dtype=torch.float64) tensor(-1.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-457.6775207519531
value loss:126.16046905517578
entropies:344.9298400878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0498340129852295 seconds
19 rew tensor(1.1743, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
19 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(2.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1099, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
18 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(0.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0335, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
17 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(-0.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9302, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
16 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(-0.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8649, dtype=torch.float64) delta_t tensor(0.2648, dtype=torch.float64)
15 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(-4.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7081, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
14 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(-4.8144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5074, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
13 gae_duplicate tensor(-1.1166, dtype=torch.float64) tensor(-1.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3357, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
12 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(0.0777, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0892, dtype=torch.float64) delta_t tensor(-0.2991, dtype=torch.float64)
11 gae_duplicate tensor(-1.5923, dtype=torch.float64) tensor(5.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0777, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
10 gae_duplicate tensor(-0.3253, dtype=torch.float64) tensor(0.6518, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1913, dtype=torch.float64) delta_t tensor(0.2572, dtype=torch.float64)
9 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-5.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4309, dtype=torch.float64) delta_t tensor(-0.1905, dtype=torch.float64)
8 gae_duplicate tensor(-0.4713, dtype=torch.float64) tensor(3.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7251, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
7 gae_duplicate tensor(-0.5177, dtype=torch.float64) tensor(-0.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5347, dtype=torch.float64) delta_t tensor(0.2958, dtype=torch.float64)
6 gae_duplicate tensor(0.2385, dtype=torch.float64) tensor(-5.7631, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6218, dtype=torch.float64) delta_t tensor(-0.3441, dtype=torch.float64)
5 gae_duplicate tensor(-0.5450, dtype=torch.float64) tensor(6.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
4 gae_duplicate tensor(-0.2403, dtype=torch.float64) tensor(-0.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9484, dtype=torch.float64) delta_t tensor(-0.4370, dtype=torch.float64)
3 gae_duplicate tensor(-0.7515, dtype=torch.float64) tensor(7.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2765, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
2 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(-4.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:35.826107025146484
value loss:20.20098876953125
entropies:344.8233947753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.872405052185059 seconds
19 rew tensor(1.1331, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
19 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(2.8363, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1872, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
18 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(-1.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0039, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
17 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(1.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0577, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
16 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(0.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9548, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
15 gae_duplicate tensor(-0.2559, dtype=torch.float64) tensor(-2.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1622, dtype=torch.float64) delta_t tensor(-0.2808, dtype=torch.float64)
14 gae_duplicate tensor(-2.7054, dtype=torch.float64) tensor(4.9884, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5665, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
13 gae_duplicate tensor(-0.2805, dtype=torch.float64) tensor(-1.2024, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3323, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
12 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-1.6672, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5274, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
11 gae_duplicate tensor(-0.0531, dtype=torch.float64) tensor(-2.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
10 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(-0.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4654, dtype=torch.float64) delta_t tensor(0.4261, dtype=torch.float64)
9 gae_duplicate tensor(0.1127, dtype=torch.float64) tensor(-8.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5250, dtype=torch.float64) delta_t tensor(-0.3787, dtype=torch.float64)
8 gae_duplicate tensor(-0.5947, dtype=torch.float64) tensor(6.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5406, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
7 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-3.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7859, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
6 gae_duplicate tensor(-0.7071, dtype=torch.float64) tensor(-1.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2543, dtype=torch.float64) delta_t tensor(-0.1266, dtype=torch.float64)
5 gae_duplicate tensor(-0.4214, dtype=torch.float64) tensor(2.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2293, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
4 gae_duplicate tensor(-0.6860, dtype=torch.float64) tensor(0.8313, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6068, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
3 gae_duplicate tensor(-0.7101, dtype=torch.float64) tensor(2.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1329, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
2 gae_duplicate tensor(-0.4099, dtype=torch.float64) tensor(-3.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:136.9622344970703
value loss:26.371362686157227
entropies:344.73541259765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.946639060974121 seconds
19 rew tensor(1.2369, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
19 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-1.1644, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1739, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
18 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(-2.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0699, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
17 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-1.7104, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
16 gae_duplicate tensor(-0.2171, dtype=torch.float64) tensor(-1.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9408, dtype=torch.float64) delta_t tensor(0.3196, dtype=torch.float64)
15 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(-5.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4487, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
14 gae_duplicate tensor(-1.4614, dtype=torch.float64) tensor(-1.9058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6052, dtype=torch.float64) delta_t tensor(0.3016, dtype=torch.float64)
13 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(-5.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.3022, dtype=torch.float64)
12 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-6.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5555, dtype=torch.float64) delta_t tensor(-0.8493, dtype=torch.float64)
11 gae_duplicate tensor(-4.9070, dtype=torch.float64) tensor(15.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0528, dtype=torch.float64) delta_t tensor(0.3315, dtype=torch.float64)
10 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(-4.5262, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3304, dtype=torch.float64) delta_t tensor(0.3046, dtype=torch.float64)
9 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(-5.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5593, dtype=torch.float64) delta_t tensor(-0.2901, dtype=torch.float64)
8 gae_duplicate tensor(-0.7880, dtype=torch.float64) tensor(4.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8652, dtype=torch.float64) delta_t tensor(0.2499, dtype=torch.float64)
7 gae_duplicate tensor(-0.3204, dtype=torch.float64) tensor(-4.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7815, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
6 gae_duplicate tensor(-0.2872, dtype=torch.float64) tensor(-1.6905, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6225, dtype=torch.float64) delta_t tensor(-0.3437, dtype=torch.float64)
5 gae_duplicate tensor(-0.9524, dtype=torch.float64) tensor(7.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
4 gae_duplicate tensor(-0.5997, dtype=torch.float64) tensor(-2.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3081, dtype=torch.float64) delta_t tensor(-0.6251, dtype=torch.float64)
3 gae_duplicate tensor(-0.9596, dtype=torch.float64) tensor(11.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3529, dtype=torch.float64) delta_t tensor(0.4103, dtype=torch.float64)
2 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-6.3331, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:668.4395751953125
value loss:68.98236846923828
entropies:344.61480712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.117574214935303 seconds
19 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(-0.0869, dtype=torch.float64)
19 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(1.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1988, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
18 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-1.2232, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1213, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
17 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-1.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9932, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
16 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(-2.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9321, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
15 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(-1.9635, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4051, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
14 gae_duplicate tensor(-1.1525, dtype=torch.float64) tensor(0.5554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(0.2500, dtype=torch.float64)
13 gae_duplicate tensor(0.0644, dtype=torch.float64) tensor(-4.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(0.2044, dtype=torch.float64)
12 gae_duplicate tensor(0.0909, dtype=torch.float64) tensor(-4.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1461, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
11 gae_duplicate tensor(-0.3575, dtype=torch.float64) tensor(0.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0923, dtype=torch.float64) delta_t tensor(0.1904, dtype=torch.float64)
10 gae_duplicate tensor(-0.0817, dtype=torch.float64) tensor(-3.5670, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0822, dtype=torch.float64) delta_t tensor(0.3160, dtype=torch.float64)
9 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-6.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4061, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
8 gae_duplicate tensor(-0.5253, dtype=torch.float64) tensor(2.5477, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3900, dtype=torch.float64) delta_t tensor(-0.1688, dtype=torch.float64)
7 gae_duplicate tensor(-0.4676, dtype=torch.float64) tensor(3.8982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7081, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
6 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-2.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7437, dtype=torch.float64) delta_t tensor(-0.3107, dtype=torch.float64)
5 gae_duplicate tensor(-0.4534, dtype=torch.float64) tensor(5.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3128, dtype=torch.float64) delta_t tensor(0.4524, dtype=torch.float64)
4 gae_duplicate tensor(-0.0137, dtype=torch.float64) tensor(-7.6799, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5367, dtype=torch.float64) delta_t tensor(-0.6408, dtype=torch.float64)
3 gae_duplicate tensor(-1.2620, dtype=torch.float64) tensor(11.7469, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5820, dtype=torch.float64) delta_t tensor(0.5697, dtype=torch.float64)
2 gae_duplicate tensor(-0.6668, dtype=torch.float64) tensor(-8.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:913.0223388671875
value loss:25.719310760498047
entropies:344.6004638671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3882.0630)
ToM Target loss= tensor(3978.4094)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.104104995727539 seconds
19 rew tensor(1.1814, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
19 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(1.6546, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1819, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
18 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-0.6306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1443, dtype=torch.float64) delta_t tensor(0.0794, dtype=torch.float64)
17 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-1.7029, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0791, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
16 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(-2.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9897, dtype=torch.float64) delta_t tensor(0.3479, dtype=torch.float64)
15 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(-7.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6800, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
14 gae_duplicate tensor(0.1215, dtype=torch.float64) tensor(-5.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
13 gae_duplicate tensor(-1.0940, dtype=torch.float64) tensor(-2.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1960, dtype=torch.float64) delta_t tensor(-0.1009, dtype=torch.float64)
12 gae_duplicate tensor(-1.2507, dtype=torch.float64) tensor(1.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1936, dtype=torch.float64) delta_t tensor(-0.5933, dtype=torch.float64)
11 gae_duplicate tensor(-4.1518, dtype=torch.float64) tensor(11.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1228, dtype=torch.float64) delta_t tensor(0.2470, dtype=torch.float64)
10 gae_duplicate tensor(-0.2955, dtype=torch.float64) tensor(-4.7269, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
9 gae_duplicate tensor(-0.0264, dtype=torch.float64) tensor(-5.9108, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6207, dtype=torch.float64) delta_t tensor(-0.1732, dtype=torch.float64)
8 gae_duplicate tensor(-0.6167, dtype=torch.float64) tensor(3.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8937, dtype=torch.float64) delta_t tensor(-1.0324, dtype=torch.float64)
7 gae_duplicate tensor(-4.1624, dtype=torch.float64) tensor(18.8085, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9726, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
6 gae_duplicate tensor(-1.8237, dtype=torch.float64) tensor(5.6320, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3145, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
5 gae_duplicate tensor(-0.3377, dtype=torch.float64) tensor(1.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0670, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
4 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(-4.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2560, dtype=torch.float64) delta_t tensor(-0.4901, dtype=torch.float64)
3 gae_duplicate tensor(-1.0712, dtype=torch.float64) tensor(9.9213, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4162, dtype=torch.float64) delta_t tensor(0.4364, dtype=torch.float64)
2 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(-8.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-616.743896484375
value loss:104.38089752197266
entropies:344.4256286621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.388250827789307 seconds
19 rew tensor(1.1412, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
19 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(2.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1690, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
18 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(-0.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0775, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
17 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(0.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9895, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
16 gae_duplicate tensor(-0.1676, dtype=torch.float64) tensor(-0.7073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8478, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
15 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-1.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5215, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
14 gae_duplicate tensor(-1.3081, dtype=torch.float64) tensor(1.4694, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6553, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
13 gae_duplicate tensor(-0.2277, dtype=torch.float64) tensor(-2.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4239, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
12 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-0.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
11 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(0.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1545, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
10 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-2.9125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
9 gae_duplicate tensor(-0.1147, dtype=torch.float64) tensor(-3.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3527, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
8 gae_duplicate tensor(-0.5276, dtype=torch.float64) tensor(3.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0201, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
7 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(1.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6345, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
6 gae_duplicate tensor(0.1160, dtype=torch.float64) tensor(-5.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5395, dtype=torch.float64) delta_t tensor(-0.2388, dtype=torch.float64)
5 gae_duplicate tensor(-0.4722, dtype=torch.float64) tensor(3.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1386, dtype=torch.float64) delta_t tensor(0.3044, dtype=torch.float64)
4 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(-5.9241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0655, dtype=torch.float64) delta_t tensor(-0.3317, dtype=torch.float64)
3 gae_duplicate tensor(-0.9334, dtype=torch.float64) tensor(4.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4108, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
2 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(-7.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:692.5637817382812
value loss:20.297924041748047
entropies:344.4246520996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7524378299713135 seconds
19 rew tensor(1.2074, dtype=torch.float64) delta_t tensor(-0.0758, dtype=torch.float64)
19 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(1.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1825, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
18 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-1.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1059, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
17 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(-0.5571, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9756, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
16 gae_duplicate tensor(-0.2467, dtype=torch.float64) tensor(-0.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9254, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
15 gae_duplicate tensor(0.0616, dtype=torch.float64) tensor(-4.6147, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1844, dtype=torch.float64) delta_t tensor(-0.3199, dtype=torch.float64)
14 gae_duplicate tensor(-2.7491, dtype=torch.float64) tensor(4.7430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2729, dtype=torch.float64) delta_t tensor(-0.0818, dtype=torch.float64)
13 gae_duplicate tensor(-2.3441, dtype=torch.float64) tensor(1.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0669, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
12 gae_duplicate tensor(-0.8226, dtype=torch.float64) tensor(0.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4396, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
11 gae_duplicate tensor(-0.2455, dtype=torch.float64) tensor(-1.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
10 gae_duplicate tensor(-0.2852, dtype=torch.float64) tensor(0.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2556, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
9 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(-5.7839, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5042, dtype=torch.float64) delta_t tensor(-0.3031, dtype=torch.float64)
8 gae_duplicate tensor(-0.7035, dtype=torch.float64) tensor(4.9254, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8769, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
7 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-0.5431, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5951, dtype=torch.float64) delta_t tensor(0.2506, dtype=torch.float64)
6 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-4.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6909, dtype=torch.float64) delta_t tensor(-0.2722, dtype=torch.float64)
5 gae_duplicate tensor(-0.5783, dtype=torch.float64) tensor(4.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0081, dtype=torch.float64) delta_t tensor(0.1350, dtype=torch.float64)
4 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-2.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1869, dtype=torch.float64) delta_t tensor(-0.4806, dtype=torch.float64)
3 gae_duplicate tensor(-0.8726, dtype=torch.float64) tensor(9.1800, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3432, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
2 gae_duplicate tensor(0.0298, dtype=torch.float64) tensor(-4.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-176.46755981445312
value loss:35.313926696777344
entropies:344.4346923828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.644426107406616 seconds
19 rew tensor(1.1705, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
19 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(1.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1324, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
18 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(0.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0807, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
17 gae_duplicate tensor(-0.1312, dtype=torch.float64) tensor(1.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0295, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
16 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(1.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9406, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
15 gae_duplicate tensor(-0.2190, dtype=torch.float64) tensor(-1.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4898, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
14 gae_duplicate tensor(-0.9695, dtype=torch.float64) tensor(-1.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0913, dtype=torch.float64) delta_t tensor(-0.2926, dtype=torch.float64)
13 gae_duplicate tensor(-1.2679, dtype=torch.float64) tensor(4.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2555, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
12 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(-0.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3338, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
11 gae_duplicate tensor(-0.3013, dtype=torch.float64) tensor(0.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0537, dtype=torch.float64) delta_t tensor(0.0788, dtype=torch.float64)
10 gae_duplicate tensor(-0.3088, dtype=torch.float64) tensor(-1.7562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3602, dtype=torch.float64) delta_t tensor(0.4081, dtype=torch.float64)
9 gae_duplicate tensor(0.2526, dtype=torch.float64) tensor(-7.8907, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4289, dtype=torch.float64) delta_t tensor(-0.2426, dtype=torch.float64)
8 gae_duplicate tensor(-0.4746, dtype=torch.float64) tensor(3.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9324, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
7 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-0.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6231, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
6 gae_duplicate tensor(0.0604, dtype=torch.float64) tensor(-4.9150, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6156, dtype=torch.float64) delta_t tensor(-0.2724, dtype=torch.float64)
5 gae_duplicate tensor(-0.6051, dtype=torch.float64) tensor(5.4718, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0106, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
4 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-2.8467, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1166, dtype=torch.float64) delta_t tensor(-0.4363, dtype=torch.float64)
3 gae_duplicate tensor(-0.8082, dtype=torch.float64) tensor(8.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3196, dtype=torch.float64) delta_t tensor(0.2606, dtype=torch.float64)
2 gae_duplicate tensor(-0.4770, dtype=torch.float64) tensor(-3.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-188.3238067626953
value loss:18.627397537231445
entropies:344.4859619140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7430689334869385 seconds
19 rew tensor(1.1823, dtype=torch.float64) delta_t tensor(-0.0987, dtype=torch.float64)
19 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(1.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1056, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
18 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(-0.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1059, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
17 gae_duplicate tensor(-0.2273, dtype=torch.float64) tensor(-2.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9633, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
16 gae_duplicate tensor(-0.2259, dtype=torch.float64) tensor(-1.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(0.3062, dtype=torch.float64)
15 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-6.4862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5097, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
14 gae_duplicate tensor(-0.7996, dtype=torch.float64) tensor(-1.7602, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7099, dtype=torch.float64) delta_t tensor(0.2086, dtype=torch.float64)
13 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-3.8974, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3978, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
12 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(-1.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0140, dtype=torch.float64) delta_t tensor(-0.3648, dtype=torch.float64)
11 gae_duplicate tensor(-2.8268, dtype=torch.float64) tensor(5.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3009, dtype=torch.float64) delta_t tensor(-0.2922, dtype=torch.float64)
10 gae_duplicate tensor(-0.9560, dtype=torch.float64) tensor(6.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3036, dtype=torch.float64) delta_t tensor(0.2142, dtype=torch.float64)
9 gae_duplicate tensor(-0.2273, dtype=torch.float64) tensor(-3.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4785, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
8 gae_duplicate tensor(-0.6512, dtype=torch.float64) tensor(2.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7549, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
7 gae_duplicate tensor(-1.1011, dtype=torch.float64) tensor(0.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8023, dtype=torch.float64) delta_t tensor(0.1038, dtype=torch.float64)
6 gae_duplicate tensor(-0.4316, dtype=torch.float64) tensor(-1.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3543, dtype=torch.float64) delta_t tensor(-0.2320, dtype=torch.float64)
5 gae_duplicate tensor(-0.6147, dtype=torch.float64) tensor(4.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1528, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
4 gae_duplicate tensor(-0.3525, dtype=torch.float64) tensor(-0.5817, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8187, dtype=torch.float64) delta_t tensor(-0.2466, dtype=torch.float64)
3 gae_duplicate tensor(-0.6387, dtype=torch.float64) tensor(4.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1440, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
2 gae_duplicate tensor(-0.6606, dtype=torch.float64) tensor(-2.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-35.69059371948242
value loss:33.19396209716797
entropies:344.4751892089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3862.1348)
ToM Target loss= tensor(3975.2874)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.723124980926514 seconds
19 rew tensor(1.1949, dtype=torch.float64) delta_t tensor(-0.0835, dtype=torch.float64)
19 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(1.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2081, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
18 gae_duplicate tensor(-0.0899, dtype=torch.float64) tensor(-0.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0398, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
17 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9628, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
16 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(-2.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8582, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
15 gae_duplicate tensor(0.0697, dtype=torch.float64) tensor(-4.3100, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7740, dtype=torch.float64) delta_t tensor(0.2397, dtype=torch.float64)
14 gae_duplicate tensor(0.0132, dtype=torch.float64) tensor(-5.0236, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5727, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
13 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-3.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
12 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(-3.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2243, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
11 gae_duplicate tensor(-0.3739, dtype=torch.float64) tensor(1.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2075, dtype=torch.float64) delta_t tensor(0.2590, dtype=torch.float64)
10 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-4.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(0.4035, dtype=torch.float64)
9 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-8.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4755, dtype=torch.float64) delta_t tensor(-0.1920, dtype=torch.float64)
8 gae_duplicate tensor(-0.4818, dtype=torch.float64) tensor(3.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4470, dtype=torch.float64) delta_t tensor(-0.5881, dtype=torch.float64)
7 gae_duplicate tensor(-2.8197, dtype=torch.float64) tensor(12.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7812, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
6 gae_duplicate tensor(-1.3204, dtype=torch.float64) tensor(2.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4474, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
5 gae_duplicate tensor(-0.6612, dtype=torch.float64) tensor(2.9283, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0677, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
4 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(-4.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0884, dtype=torch.float64) delta_t tensor(-0.3056, dtype=torch.float64)
3 gae_duplicate tensor(-0.8939, dtype=torch.float64) tensor(5.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.4151, dtype=torch.float64)
2 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(-6.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:597.10498046875
value loss:38.704833984375
entropies:344.5517578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.75492787361145 seconds
19 rew tensor(1.1939, dtype=torch.float64) delta_t tensor(-0.0720, dtype=torch.float64)
19 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(1.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1692, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
18 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-0.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0669, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
17 gae_duplicate tensor(-0.2078, dtype=torch.float64) tensor(-0.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0029, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
16 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(-0.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8708, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
15 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-3.7967, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7323, dtype=torch.float64) delta_t tensor(0.2541, dtype=torch.float64)
14 gae_duplicate tensor(0.0898, dtype=torch.float64) tensor(-5.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2476, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
13 gae_duplicate tensor(-1.3366, dtype=torch.float64) tensor(0.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
12 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-1.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2916, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
11 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(-0.9915, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1550, dtype=torch.float64) delta_t tensor(0.1255, dtype=torch.float64)
10 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(-2.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
9 gae_duplicate tensor(-0.0998, dtype=torch.float64) tensor(-5.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6831, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
8 gae_duplicate tensor(-0.5082, dtype=torch.float64) tensor(1.8733, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3756, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
7 gae_duplicate tensor(-1.1912, dtype=torch.float64) tensor(-1.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7612, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
6 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(-3.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2854, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
5 gae_duplicate tensor(-0.7476, dtype=torch.float64) tensor(0.7727, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1913, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
4 gae_duplicate tensor(-0.4082, dtype=torch.float64) tensor(-0.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7225, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
3 gae_duplicate tensor(-0.8706, dtype=torch.float64) tensor(2.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1821, dtype=torch.float64) delta_t tensor(0.2484, dtype=torch.float64)
2 gae_duplicate tensor(-0.2936, dtype=torch.float64) tensor(-5.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1217.101806640625
value loss:21.877368927001953
entropies:344.4457702636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.600915193557739 seconds
19 rew tensor(1.1813, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
19 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(2.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0663, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
18 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(1.5039, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0027, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
17 gae_duplicate tensor(-0.3181, dtype=torch.float64) tensor(1.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0030, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
16 gae_duplicate tensor(-0.2447, dtype=torch.float64) tensor(-1.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8615, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
15 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(-1.6622, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8108, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
14 gae_duplicate tensor(0.0380, dtype=torch.float64) tensor(-5.9033, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
13 gae_duplicate tensor(-1.0984, dtype=torch.float64) tensor(-0.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3750, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
12 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(-0.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1212, dtype=torch.float64) delta_t tensor(-0.5068, dtype=torch.float64)
11 gae_duplicate tensor(-2.9383, dtype=torch.float64) tensor(8.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2594, dtype=torch.float64) delta_t tensor(-0.2290, dtype=torch.float64)
10 gae_duplicate tensor(-0.8424, dtype=torch.float64) tensor(5.9948, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
9 gae_duplicate tensor(-0.1254, dtype=torch.float64) tensor(-4.0102, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4268, dtype=torch.float64) delta_t tensor(-0.1970, dtype=torch.float64)
8 gae_duplicate tensor(-0.4361, dtype=torch.float64) tensor(3.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8032, dtype=torch.float64) delta_t tensor(0.1157, dtype=torch.float64)
7 gae_duplicate tensor(-0.4067, dtype=torch.float64) tensor(-1.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5438, dtype=torch.float64) delta_t tensor(0.2706, dtype=torch.float64)
6 gae_duplicate tensor(0.1993, dtype=torch.float64) tensor(-5.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6680, dtype=torch.float64) delta_t tensor(-0.2642, dtype=torch.float64)
5 gae_duplicate tensor(-0.4539, dtype=torch.float64) tensor(4.6805, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0431, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
4 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-0.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0613, dtype=torch.float64) delta_t tensor(-0.4824, dtype=torch.float64)
3 gae_duplicate tensor(-0.6719, dtype=torch.float64) tensor(8.7070, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2922, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
2 gae_duplicate tensor(-0.0907, dtype=torch.float64) tensor(-3.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-678.6849975585938
value loss:27.481401443481445
entropies:344.2809753417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832124948501587 seconds
19 rew tensor(1.2452, dtype=torch.float64) delta_t tensor(-0.0565, dtype=torch.float64)
19 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(1.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2075, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
18 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(-0.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1050, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
17 gae_duplicate tensor(-0.1605, dtype=torch.float64) tensor(-0.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0408, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
16 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(0.8664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7152, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
15 gae_duplicate tensor(-1.4959, dtype=torch.float64) tensor(0.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2412, dtype=torch.float64) delta_t tensor(-0.3858, dtype=torch.float64)
14 gae_duplicate tensor(-2.6700, dtype=torch.float64) tensor(7.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5003, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
13 gae_duplicate tensor(-0.3813, dtype=torch.float64) tensor(-1.8189, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3055, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
12 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(-0.8762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2875, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
11 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-2.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1483, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
10 gae_duplicate tensor(-0.2939, dtype=torch.float64) tensor(-1.5798, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1606, dtype=torch.float64) delta_t tensor(0.2276, dtype=torch.float64)
9 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(-4.3505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5333, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
8 gae_duplicate tensor(-0.4588, dtype=torch.float64) tensor(2.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9640, dtype=torch.float64) delta_t tensor(-0.2156, dtype=torch.float64)
7 gae_duplicate tensor(-0.7215, dtype=torch.float64) tensor(4.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7655, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
6 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(-1.0079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5279, dtype=torch.float64) delta_t tensor(-0.2070, dtype=torch.float64)
5 gae_duplicate tensor(-0.6266, dtype=torch.float64) tensor(4.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0510, dtype=torch.float64) delta_t tensor(0.1747, dtype=torch.float64)
4 gae_duplicate tensor(-0.4344, dtype=torch.float64) tensor(-3.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1603, dtype=torch.float64) delta_t tensor(-0.3658, dtype=torch.float64)
3 gae_duplicate tensor(-0.8558, dtype=torch.float64) tensor(7.3853, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.3816, dtype=torch.float64)
2 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(-6.3416, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-301.353515625
value loss:31.35865020751953
entropies:344.2176818847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5780861377716064 seconds
19 rew tensor(1.1172, dtype=torch.float64) delta_t tensor(-0.1660, dtype=torch.float64)
19 gae_duplicate tensor(-0.2572, dtype=torch.float64) tensor(3.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1045, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
18 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(1.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0150, dtype=torch.float64) delta_t tensor(-0.1188, dtype=torch.float64)
17 gae_duplicate tensor(-0.2455, dtype=torch.float64) tensor(2.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0406, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
16 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(0.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9516, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
15 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(0.7064, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0025, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
14 gae_duplicate tensor(0.1832, dtype=torch.float64) tensor(-6.5256, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1530, dtype=torch.float64) delta_t tensor(-0.5181, dtype=torch.float64)
13 gae_duplicate tensor(-2.7724, dtype=torch.float64) tensor(8.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1198, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
12 gae_duplicate tensor(-0.8514, dtype=torch.float64) tensor(2.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3082, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
11 gae_duplicate tensor(-0.3460, dtype=torch.float64) tensor(1.4959, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0162, dtype=torch.float64) delta_t tensor(-0.0800, dtype=torch.float64)
10 gae_duplicate tensor(-0.3389, dtype=torch.float64) tensor(1.5799, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(0.3981, dtype=torch.float64)
9 gae_duplicate tensor(-0.2168, dtype=torch.float64) tensor(-8.2423, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4815, dtype=torch.float64) delta_t tensor(-0.3013, dtype=torch.float64)
8 gae_duplicate tensor(-0.4463, dtype=torch.float64) tensor(5.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0837, dtype=torch.float64) delta_t tensor(0.2161, dtype=torch.float64)
7 gae_duplicate tensor(0.0984, dtype=torch.float64) tensor(-3.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6113, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
6 gae_duplicate tensor(0.0788, dtype=torch.float64) tensor(-3.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7691, dtype=torch.float64) delta_t tensor(-0.2466, dtype=torch.float64)
5 gae_duplicate tensor(-0.5766, dtype=torch.float64) tensor(4.4268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1367, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
4 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(-2.9394, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3715, dtype=torch.float64) delta_t tensor(-0.5462, dtype=torch.float64)
3 gae_duplicate tensor(-0.6323, dtype=torch.float64) tensor(10.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
2 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-6.8997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-622.8743286132812
value loss:27.099767684936523
entropies:344.01287841796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3896.9697)
ToM Target loss= tensor(3975.9062)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.634202003479004 seconds
19 rew tensor(1.1406, dtype=torch.float64) delta_t tensor(-0.1380, dtype=torch.float64)
19 gae_duplicate tensor(-0.2035, dtype=torch.float64) tensor(2.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1167, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
18 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(1.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1181, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
17 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(-0.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0156, dtype=torch.float64) delta_t tensor(-0.1236, dtype=torch.float64)
16 gae_duplicate tensor(-0.2666, dtype=torch.float64) tensor(2.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9007, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
15 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-0.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7860, dtype=torch.float64) delta_t tensor(0.2077, dtype=torch.float64)
14 gae_duplicate tensor(0.0880, dtype=torch.float64) tensor(-4.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6791, dtype=torch.float64) delta_t tensor(0.2570, dtype=torch.float64)
13 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-5.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3507, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
12 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-0.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1840, dtype=torch.float64) delta_t tensor(-0.4537, dtype=torch.float64)
11 gae_duplicate tensor(-3.0162, dtype=torch.float64) tensor(7.8092, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5516, dtype=torch.float64) delta_t tensor(-0.4728, dtype=torch.float64)
10 gae_duplicate tensor(-2.7857, dtype=torch.float64) tensor(9.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3403, dtype=torch.float64) delta_t tensor(0.3826, dtype=torch.float64)
9 gae_duplicate tensor(-0.0292, dtype=torch.float64) tensor(-6.6976, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5012, dtype=torch.float64) delta_t tensor(-0.2666, dtype=torch.float64)
8 gae_duplicate tensor(-0.5214, dtype=torch.float64) tensor(4.2239, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6496, dtype=torch.float64) delta_t tensor(0.1899, dtype=torch.float64)
7 gae_duplicate tensor(-0.2252, dtype=torch.float64) tensor(-3.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
6 gae_duplicate tensor(0.1081, dtype=torch.float64) tensor(-4.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4195, dtype=torch.float64) delta_t tensor(-0.3030, dtype=torch.float64)
5 gae_duplicate tensor(-0.8299, dtype=torch.float64) tensor(5.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1367, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
4 gae_duplicate tensor(-0.2980, dtype=torch.float64) tensor(-0.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8683, dtype=torch.float64) delta_t tensor(-0.2747, dtype=torch.float64)
3 gae_duplicate tensor(-0.6538, dtype=torch.float64) tensor(5.6493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1993, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
2 gae_duplicate tensor(-0.5261, dtype=torch.float64) tensor(-3.1082, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-632.9003295898438
value loss:39.81352996826172
entropies:343.994873046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.719778060913086 seconds
19 rew tensor(1.2459, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
19 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(1.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1562, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
18 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0788, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
17 gae_duplicate tensor(-0.2922, dtype=torch.float64) tensor(1.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9784, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
16 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(0.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8610, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
15 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-2.8756, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1545, dtype=torch.float64) delta_t tensor(-0.5253, dtype=torch.float64)
14 gae_duplicate tensor(-1.4659, dtype=torch.float64) tensor(8.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6171, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
13 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-2.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
12 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(-1.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6198, dtype=torch.float64) delta_t tensor(0.1866, dtype=torch.float64)
11 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(-3.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2235, dtype=torch.float64) delta_t tensor(-0.1471, dtype=torch.float64)
10 gae_duplicate tensor(-0.3376, dtype=torch.float64) tensor(2.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4781, dtype=torch.float64) delta_t tensor(0.4120, dtype=torch.float64)
9 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-7.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5592, dtype=torch.float64) delta_t tensor(-0.4237, dtype=torch.float64)
8 gae_duplicate tensor(-0.7760, dtype=torch.float64) tensor(6.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0923, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
7 gae_duplicate tensor(-1.2319, dtype=torch.float64) tensor(1.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6765, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
6 gae_duplicate tensor(-0.5257, dtype=torch.float64) tensor(-2.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5615, dtype=torch.float64) delta_t tensor(-0.1610, dtype=torch.float64)
5 gae_duplicate tensor(-0.7834, dtype=torch.float64) tensor(2.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0890, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
4 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-2.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1813, dtype=torch.float64) delta_t tensor(-0.4564, dtype=torch.float64)
3 gae_duplicate tensor(-0.6348, dtype=torch.float64) tensor(8.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4493, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
2 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(-5.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-360.5064392089844
value loss:24.622089385986328
entropies:344.1315612792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.668284893035889 seconds
19 rew tensor(1.0915, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
19 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(2.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1315, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
18 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-0.1622, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9381, dtype=torch.float64) delta_t tensor(-0.1665, dtype=torch.float64)
17 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(3.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9506, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(0.4557, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8115, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
15 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(-0.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6936, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
14 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-3.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5930, dtype=torch.float64) delta_t tensor(0.2295, dtype=torch.float64)
13 gae_duplicate tensor(0.0375, dtype=torch.float64) tensor(-4.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
12 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-1.6338, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2998, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
11 gae_duplicate tensor(-0.2301, dtype=torch.float64) tensor(-0.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0082, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
10 gae_duplicate tensor(-0.2873, dtype=torch.float64) tensor(-0.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2744, dtype=torch.float64) delta_t tensor(0.3492, dtype=torch.float64)
9 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-6.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6241, dtype=torch.float64) delta_t tensor(-0.3215, dtype=torch.float64)
8 gae_duplicate tensor(-0.4593, dtype=torch.float64) tensor(5.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6222, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
7 gae_duplicate tensor(-0.6626, dtype=torch.float64) tensor(-1.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6752, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
6 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(-1.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5036, dtype=torch.float64) delta_t tensor(-0.1468, dtype=torch.float64)
5 gae_duplicate tensor(-0.5645, dtype=torch.float64) tensor(2.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0976, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
4 gae_duplicate tensor(-0.3485, dtype=torch.float64) tensor(0.0688, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9361, dtype=torch.float64) delta_t tensor(-0.3206, dtype=torch.float64)
3 gae_duplicate tensor(-0.6681, dtype=torch.float64) tensor(6.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2765, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
2 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(-2.0830, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-17.23192024230957
value loss:13.055874824523926
entropies:344.3219909667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.864993095397949 seconds
19 rew tensor(1.2702, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
19 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(0.0884, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2329, dtype=torch.float64) delta_t tensor(0.1813, dtype=torch.float64)
18 gae_duplicate tensor(0.0229, dtype=torch.float64) tensor(-3.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1185, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
17 gae_duplicate tensor(-0.3058, dtype=torch.float64) tensor(-0.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1050, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
16 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(-1.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9653, dtype=torch.float64) delta_t tensor(0.3362, dtype=torch.float64)
15 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-6.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1333, dtype=torch.float64) delta_t tensor(-0.3084, dtype=torch.float64)
14 gae_duplicate tensor(-1.4251, dtype=torch.float64) tensor(6.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5127, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
13 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-2.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4254, dtype=torch.float64) delta_t tensor(0.2700, dtype=torch.float64)
12 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-5.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4944, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
11 gae_duplicate tensor(-0.2758, dtype=torch.float64) tensor(-4.1591, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0718, dtype=torch.float64) delta_t tensor(-0.0085, dtype=torch.float64)
10 gae_duplicate tensor(-0.3201, dtype=torch.float64) tensor(-0.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3660, dtype=torch.float64) delta_t tensor(0.5739, dtype=torch.float64)
9 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-10.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6823, dtype=torch.float64) delta_t tensor(-0.4830, dtype=torch.float64)
8 gae_duplicate tensor(-0.8101, dtype=torch.float64) tensor(7.7496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2575, dtype=torch.float64) delta_t tensor(-0.6934, dtype=torch.float64)
7 gae_duplicate tensor(-2.9789, dtype=torch.float64) tensor(14.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8910, dtype=torch.float64) delta_t tensor(-0.1455, dtype=torch.float64)
6 gae_duplicate tensor(-0.9418, dtype=torch.float64) tensor(5.1157, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7971, dtype=torch.float64) delta_t tensor(-0.0338, dtype=torch.float64)
5 gae_duplicate tensor(-0.5894, dtype=torch.float64) tensor(1.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5019, dtype=torch.float64) delta_t tensor(0.4362, dtype=torch.float64)
4 gae_duplicate tensor(0.1631, dtype=torch.float64) tensor(-8.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-2.0331, dtype=torch.float64) delta_t tensor(-0.7448, dtype=torch.float64)
3 gae_duplicate tensor(-0.9241, dtype=torch.float64) tensor(14.5207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8363, dtype=torch.float64) delta_t tensor(0.6874, dtype=torch.float64)
2 gae_duplicate tensor(0.4116, dtype=torch.float64) tensor(-11.6732, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:218.3195037841797
value loss:51.633758544921875
entropies:344.322021484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.69881272315979 seconds
19 rew tensor(1.0771, dtype=torch.float64) delta_t tensor(-0.1801, dtype=torch.float64)
19 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(3.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0644, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
18 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(1.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9898, dtype=torch.float64) delta_t tensor(-0.1186, dtype=torch.float64)
17 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(2.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9499, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
16 gae_duplicate tensor(-0.2219, dtype=torch.float64) tensor(1.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8872, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
15 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(-1.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7192, dtype=torch.float64) delta_t tensor(0.1899, dtype=torch.float64)
14 gae_duplicate tensor(0.0180, dtype=torch.float64) tensor(-3.5975, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6168, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
13 gae_duplicate tensor(0.1034, dtype=torch.float64) tensor(-3.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2952, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
12 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(-0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4497, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
11 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-1.6433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0398, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
10 gae_duplicate tensor(-0.2908, dtype=torch.float64) tensor(2.8855, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3829, dtype=torch.float64) delta_t tensor(0.3565, dtype=torch.float64)
9 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(-6.2590, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5794, dtype=torch.float64) delta_t tensor(-0.3318, dtype=torch.float64)
8 gae_duplicate tensor(-0.4920, dtype=torch.float64) tensor(6.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5165, dtype=torch.float64) delta_t tensor(0.1265, dtype=torch.float64)
7 gae_duplicate tensor(-0.0722, dtype=torch.float64) tensor(-1.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6316, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
6 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(-2.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4058, dtype=torch.float64) delta_t tensor(-0.1342, dtype=torch.float64)
5 gae_duplicate tensor(-0.3172, dtype=torch.float64) tensor(2.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1185, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
4 gae_duplicate tensor(-0.3278, dtype=torch.float64) tensor(0.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7756, dtype=torch.float64) delta_t tensor(-0.2213, dtype=torch.float64)
3 gae_duplicate tensor(-0.6561, dtype=torch.float64) tensor(4.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2674, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
2 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(-2.2838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-224.4974365234375
value loss:9.905874252319336
entropies:344.1839904785156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3880.5696)
ToM Target loss= tensor(3978.9121)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.836641788482666 seconds
19 rew tensor(1.1781, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
19 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(2.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1144, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
18 gae_duplicate tensor(-0.1384, dtype=torch.float64) tensor(0.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9993, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
17 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(1.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9623, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
16 gae_duplicate tensor(-0.2657, dtype=torch.float64) tensor(-0.4534, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8591, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
15 gae_duplicate tensor(-0.2731, dtype=torch.float64) tensor(-1.5905, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8096, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
14 gae_duplicate tensor(-0.1884, dtype=torch.float64) tensor(-2.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7305, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
13 gae_duplicate tensor(0.0366, dtype=torch.float64) tensor(-3.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3859, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
12 gae_duplicate tensor(-0.2432, dtype=torch.float64) tensor(-0.4998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4740, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
11 gae_duplicate tensor(-0.2648, dtype=torch.float64) tensor(-1.2714, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0123, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
10 gae_duplicate tensor(-0.3399, dtype=torch.float64) tensor(-1.5487, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1665, dtype=torch.float64) delta_t tensor(0.1549, dtype=torch.float64)
9 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(-3.4780, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5276, dtype=torch.float64) delta_t tensor(-0.2418, dtype=torch.float64)
8 gae_duplicate tensor(-0.5228, dtype=torch.float64) tensor(4.6763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.4714, dtype=torch.float64) delta_t tensor(-1.4538, dtype=torch.float64)
7 gae_duplicate tensor(-5.8611, dtype=torch.float64) tensor(26.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7788, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
6 gae_duplicate tensor(-1.4835, dtype=torch.float64) tensor(1.3474, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6389, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
5 gae_duplicate tensor(-0.3144, dtype=torch.float64) tensor(1.6663, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1160, dtype=torch.float64) delta_t tensor(0.1567, dtype=torch.float64)
4 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-2.6731, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4033, dtype=torch.float64) delta_t tensor(-0.6242, dtype=torch.float64)
3 gae_duplicate tensor(-1.3964, dtype=torch.float64) tensor(11.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4501, dtype=torch.float64) delta_t tensor(0.3096, dtype=torch.float64)
2 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-5.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1534.483642578125
value loss:86.77497863769531
entropies:343.92584228515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.701481103897095 seconds
19 rew tensor(1.1523, dtype=torch.float64) delta_t tensor(-0.1070, dtype=torch.float64)
19 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(1.9402, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0764, dtype=torch.float64) delta_t tensor(-0.0466, dtype=torch.float64)
18 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(1.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0122, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
17 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(1.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9995, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
16 gae_duplicate tensor(-0.1591, dtype=torch.float64) tensor(1.8712, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8583, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
15 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(2.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
14 gae_duplicate tensor(0.0736, dtype=torch.float64) tensor(-4.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5260, dtype=torch.float64) delta_t tensor(0.2021, dtype=torch.float64)
13 gae_duplicate tensor(0.0852, dtype=torch.float64) tensor(-4.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
12 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-0.7949, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2272, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
11 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(1.2302, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0679, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
10 gae_duplicate tensor(-0.3365, dtype=torch.float64) tensor(0.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1862, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
9 gae_duplicate tensor(0.2075, dtype=torch.float64) tensor(-10.3360, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3708, dtype=torch.float64) delta_t tensor(-0.3355, dtype=torch.float64)
8 gae_duplicate tensor(-0.6235, dtype=torch.float64) tensor(5.9545, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4035, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
7 gae_duplicate tensor(-0.1737, dtype=torch.float64) tensor(-2.0539, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5004, dtype=torch.float64) delta_t tensor(0.2458, dtype=torch.float64)
6 gae_duplicate tensor(0.0763, dtype=torch.float64) tensor(-4.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8899, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
5 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(2.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3208, dtype=torch.float64) delta_t tensor(0.2538, dtype=torch.float64)
4 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-4.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5582, dtype=torch.float64) delta_t tensor(-0.4860, dtype=torch.float64)
3 gae_duplicate tensor(-0.5416, dtype=torch.float64) tensor(8.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6670, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
2 gae_duplicate tensor(0.2647, dtype=torch.float64) tensor(-9.4660, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:603.3307495117188
value loss:14.01760196685791
entropies:343.89923095703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84993314743042 seconds
19 rew tensor(1.1390, dtype=torch.float64) delta_t tensor(-0.1346, dtype=torch.float64)
19 gae_duplicate tensor(-0.2916, dtype=torch.float64) tensor(2.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1270, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
18 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(0.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1148, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
17 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9365, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
16 gae_duplicate tensor(-0.2428, dtype=torch.float64) tensor(-0.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7812, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
15 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(-3.0925, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7570, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
14 gae_duplicate tensor(-0.0356, dtype=torch.float64) tensor(-3.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(0.1026, dtype=torch.float64)
13 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(-3.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5409, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
12 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-1.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1384, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
11 gae_duplicate tensor(-0.3671, dtype=torch.float64) tensor(0.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3103, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
10 gae_duplicate tensor(-0.3493, dtype=torch.float64) tensor(-1.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1315, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
9 gae_duplicate tensor(-0.2801, dtype=torch.float64) tensor(-1.8885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2957, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
8 gae_duplicate tensor(-0.4414, dtype=torch.float64) tensor(0.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3114, dtype=torch.float64) delta_t tensor(-0.1972, dtype=torch.float64)
7 gae_duplicate tensor(-1.1378, dtype=torch.float64) tensor(3.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4122, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
6 gae_duplicate tensor(0.2977, dtype=torch.float64) tensor(-6.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8881, dtype=torch.float64) delta_t tensor(-0.2859, dtype=torch.float64)
5 gae_duplicate tensor(-0.6795, dtype=torch.float64) tensor(4.8628, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2435, dtype=torch.float64) delta_t tensor(0.2402, dtype=torch.float64)
4 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-3.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4298, dtype=torch.float64) delta_t tensor(-0.4903, dtype=torch.float64)
3 gae_duplicate tensor(-0.8646, dtype=torch.float64) tensor(8.7979, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6030, dtype=torch.float64) delta_t tensor(0.4248, dtype=torch.float64)
2 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(-8.0309, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:698.0086669921875
value loss:19.46875
entropies:343.91241455078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.935006856918335 seconds
19 rew tensor(1.1642, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
19 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(0.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1646, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
18 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(-2.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0619, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
17 gae_duplicate tensor(-0.2094, dtype=torch.float64) tensor(-0.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0239, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.3106, dtype=torch.float64) tensor(-0.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9993, dtype=torch.float64) delta_t tensor(0.2655, dtype=torch.float64)
15 gae_duplicate tensor(0.0143, dtype=torch.float64) tensor(-4.8903, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2166, dtype=torch.float64) delta_t tensor(-0.4751, dtype=torch.float64)
14 gae_duplicate tensor(-2.7247, dtype=torch.float64) tensor(8.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7303, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
13 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(-3.3182, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3080, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
12 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(0.2848, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(-0.2909, dtype=torch.float64)
11 gae_duplicate tensor(-2.7412, dtype=torch.float64) tensor(5.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0881, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
10 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(-3.2866, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3053, dtype=torch.float64) delta_t tensor(0.1815, dtype=torch.float64)
9 gae_duplicate tensor(-0.1676, dtype=torch.float64) tensor(-3.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6019, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-0.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5103, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
7 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(-3.8505, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6920, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
6 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-3.6558, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4561, dtype=torch.float64) delta_t tensor(-0.1194, dtype=torch.float64)
5 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(2.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1388, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
4 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(1.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8943, dtype=torch.float64) delta_t tensor(-0.1624, dtype=torch.float64)
3 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(3.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2075, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
2 gae_duplicate tensor(-0.3858, dtype=torch.float64) tensor(-2.3436, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:244.568603515625
value loss:33.945823669433594
entropies:344.05169677734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.545699119567871 seconds
19 rew tensor(1.1779, dtype=torch.float64) delta_t tensor(-0.1089, dtype=torch.float64)
19 gae_duplicate tensor(-0.1951, dtype=torch.float64) tensor(2.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
18 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(0.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0893, dtype=torch.float64) delta_t tensor(0.1306, dtype=torch.float64)
17 gae_duplicate tensor(0.0060, dtype=torch.float64) tensor(-2.3589, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9229, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
16 gae_duplicate tensor(-0.2577, dtype=torch.float64) tensor(0.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
15 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(-3.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6405, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
14 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-3.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
13 gae_duplicate tensor(-1.3481, dtype=torch.float64) tensor(0.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2811, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
12 gae_duplicate tensor(-0.2458, dtype=torch.float64) tensor(-0.8299, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
11 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(-2.5053, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
10 gae_duplicate tensor(-0.3137, dtype=torch.float64) tensor(0.9699, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2434, dtype=torch.float64) delta_t tensor(-0.0512, dtype=torch.float64)
9 gae_duplicate tensor(-0.2745, dtype=torch.float64) tensor(1.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5280, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
8 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(-0.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4357, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
7 gae_duplicate tensor(-0.1797, dtype=torch.float64) tensor(0.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7345, dtype=torch.float64) delta_t tensor(0.2528, dtype=torch.float64)
6 gae_duplicate tensor(-0.3675, dtype=torch.float64) tensor(-5.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3224, dtype=torch.float64) delta_t tensor(-0.1150, dtype=torch.float64)
5 gae_duplicate tensor(-0.3757, dtype=torch.float64) tensor(1.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2477, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
4 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(1.8369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(-0.2532, dtype=torch.float64)
3 gae_duplicate tensor(-0.7415, dtype=torch.float64) tensor(4.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0986, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
2 gae_duplicate tensor(-0.3997, dtype=torch.float64) tensor(0.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:117.41300201416016
value loss:12.209118843078613
entropies:344.1410827636719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3871.3296)
ToM Target loss= tensor(3977.2578)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.803025007247925 seconds
19 rew tensor(1.1008, dtype=torch.float64) delta_t tensor(-0.1381, dtype=torch.float64)
19 gae_duplicate tensor(-0.2847, dtype=torch.float64) tensor(2.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1257, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
18 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(0.2273, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0761, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
17 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(0.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9999, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
16 gae_duplicate tensor(-0.2093, dtype=torch.float64) tensor(1.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8715, dtype=torch.float64) delta_t tensor(0.1080, dtype=torch.float64)
15 gae_duplicate tensor(-0.2384, dtype=torch.float64) tensor(-1.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7821, dtype=torch.float64) delta_t tensor(0.2981, dtype=torch.float64)
14 gae_duplicate tensor(0.0398, dtype=torch.float64) tensor(-5.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5625, dtype=torch.float64) delta_t tensor(0.1957, dtype=torch.float64)
13 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(-4.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2524, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
12 gae_duplicate tensor(-1.4801, dtype=torch.float64) tensor(2.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1641, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
11 gae_duplicate tensor(-0.6493, dtype=torch.float64) tensor(1.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3086, dtype=torch.float64) delta_t tensor(0.4342, dtype=torch.float64)
10 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(-7.9202, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0642, dtype=torch.float64) delta_t tensor(0.1327, dtype=torch.float64)
9 gae_duplicate tensor(-0.2968, dtype=torch.float64) tensor(-3.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
8 gae_duplicate tensor(-0.3939, dtype=torch.float64) tensor(-1.1287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6097, dtype=torch.float64) delta_t tensor(-0.5309, dtype=torch.float64)
7 gae_duplicate tensor(-4.1733, dtype=torch.float64) tensor(9.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7491, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
6 gae_duplicate tensor(-1.3345, dtype=torch.float64) tensor(-0.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5812, dtype=torch.float64) delta_t tensor(-0.0951, dtype=torch.float64)
5 gae_duplicate tensor(-0.3552, dtype=torch.float64) tensor(2.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0880, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
4 gae_duplicate tensor(-0.5133, dtype=torch.float64) tensor(-1.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2773, dtype=torch.float64) delta_t tensor(-0.4311, dtype=torch.float64)
3 gae_duplicate tensor(-0.8310, dtype=torch.float64) tensor(9.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4471, dtype=torch.float64) delta_t tensor(0.2922, dtype=torch.float64)
2 gae_duplicate tensor(-0.4054, dtype=torch.float64) tensor(-5.3656, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-51.80529022216797
value loss:51.1917839050293
entropies:344.4728088378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762861013412476 seconds
19 rew tensor(1.2133, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
19 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(1.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2005, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
18 gae_duplicate tensor(-0.0309, dtype=torch.float64) tensor(-1.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0859, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
17 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(0.9971, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0990, dtype=torch.float64) delta_t tensor(0.1929, dtype=torch.float64)
16 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-3.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4852, dtype=torch.float64) delta_t tensor(-0.3939, dtype=torch.float64)
15 gae_duplicate tensor(-1.3509, dtype=torch.float64) tensor(6.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4241, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
14 gae_duplicate tensor(-1.3418, dtype=torch.float64) tensor(1.7788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
13 gae_duplicate tensor(-1.2427, dtype=torch.float64) tensor(1.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4875, dtype=torch.float64) delta_t tensor(0.3137, dtype=torch.float64)
12 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-6.2142, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
11 gae_duplicate tensor(-0.3427, dtype=torch.float64) tensor(0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0908, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
10 gae_duplicate tensor(-0.3355, dtype=torch.float64) tensor(-2.0754, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4323, dtype=torch.float64) delta_t tensor(0.2412, dtype=torch.float64)
9 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-4.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5228, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
8 gae_duplicate tensor(-0.4994, dtype=torch.float64) tensor(3.4435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.6168, dtype=torch.float64) delta_t tensor(-1.4947, dtype=torch.float64)
7 gae_duplicate tensor(-5.3966, dtype=torch.float64) tensor(27.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0392, dtype=torch.float64) delta_t tensor(-0.1867, dtype=torch.float64)
6 gae_duplicate tensor(-1.3817, dtype=torch.float64) tensor(6.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3259, dtype=torch.float64) delta_t tensor(0.2466, dtype=torch.float64)
5 gae_duplicate tensor(-0.2976, dtype=torch.float64) tensor(-4.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1441, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
4 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(-4.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4214, dtype=torch.float64) delta_t tensor(-0.4016, dtype=torch.float64)
3 gae_duplicate tensor(-0.7245, dtype=torch.float64) tensor(7.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4642, dtype=torch.float64) delta_t tensor(0.3295, dtype=torch.float64)
2 gae_duplicate tensor(-0.3373, dtype=torch.float64) tensor(-5.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1496.0125732421875
value loss:95.83274841308594
entropies:344.70916748046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.825060129165649 seconds
19 rew tensor(1.2104, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
19 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-0.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1599, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
18 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-2.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8493, dtype=torch.float64) delta_t tensor(-0.1742, dtype=torch.float64)
17 gae_duplicate tensor(-1.4752, dtype=torch.float64) tensor(2.8999, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0196, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
16 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(-0.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
15 gae_duplicate tensor(-0.2323, dtype=torch.float64) tensor(-2.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.2674, dtype=torch.float64)
14 gae_duplicate tensor(0.0979, dtype=torch.float64) tensor(-6.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.1764, dtype=torch.float64)
13 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-3.6963, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(0.1711, dtype=torch.float64)
12 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-4.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0281, dtype=torch.float64) delta_t tensor(-0.2505, dtype=torch.float64)
11 gae_duplicate tensor(-2.4788, dtype=torch.float64) tensor(6.7055, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8346, dtype=torch.float64) delta_t tensor(-0.6737, dtype=torch.float64)
10 gae_duplicate tensor(-5.0082, dtype=torch.float64) tensor(12.8852, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2562, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
9 gae_duplicate tensor(-0.6029, dtype=torch.float64) tensor(-1.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5748, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
8 gae_duplicate tensor(-0.5856, dtype=torch.float64) tensor(0.2674, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0436, dtype=torch.float64) delta_t tensor(-0.2428, dtype=torch.float64)
7 gae_duplicate tensor(-2.8145, dtype=torch.float64) tensor(4.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9191, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
6 gae_duplicate tensor(-0.6438, dtype=torch.float64) tensor(0.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1671, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
5 gae_duplicate tensor(-0.7377, dtype=torch.float64) tensor(2.0713, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2436, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
4 gae_duplicate tensor(-0.4821, dtype=torch.float64) tensor(1.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7568, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
3 gae_duplicate tensor(-0.7069, dtype=torch.float64) tensor(2.7825, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0506, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
2 gae_duplicate tensor(-0.5491, dtype=torch.float64) tensor(-1.8632, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-686.3214721679688
value loss:83.365234375
entropies:345.0790100097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.095711946487427 seconds
19 rew tensor(1.1330, dtype=torch.float64) delta_t tensor(-0.1402, dtype=torch.float64)
19 gae_duplicate tensor(-0.2019, dtype=torch.float64) tensor(2.9872, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1212, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
18 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(0.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0576, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
17 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(1.5515, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(-0.1532, dtype=torch.float64)
16 gae_duplicate tensor(-0.2801, dtype=torch.float64) tensor(2.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9434, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
15 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(-4.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6629, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
14 gae_duplicate tensor(0.0449, dtype=torch.float64) tensor(-3.9126, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7917, dtype=torch.float64) delta_t tensor(0.3056, dtype=torch.float64)
13 gae_duplicate tensor(0.0512, dtype=torch.float64) tensor(-6.5612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
12 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(-0.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
11 gae_duplicate tensor(-0.2522, dtype=torch.float64) tensor(-1.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0243, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
10 gae_duplicate tensor(-0.3199, dtype=torch.float64) tensor(-1.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
9 gae_duplicate tensor(-0.3322, dtype=torch.float64) tensor(0.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5362, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
8 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(0.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0399, dtype=torch.float64) delta_t tensor(-0.5833, dtype=torch.float64)
7 gae_duplicate tensor(-3.8382, dtype=torch.float64) tensor(10.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8802, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
6 gae_duplicate tensor(-1.1965, dtype=torch.float64) tensor(3.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1652, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
5 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-3.0107, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
4 gae_duplicate tensor(-0.2912, dtype=torch.float64) tensor(0.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7182, dtype=torch.float64) delta_t tensor(-0.1695, dtype=torch.float64)
3 gae_duplicate tensor(-0.6039, dtype=torch.float64) tensor(3.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(0.0068, dtype=torch.float64)
2 gae_duplicate tensor(-0.5583, dtype=torch.float64) tensor(0.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-370.3109436035156
value loss:35.68789291381836
entropies:345.38677978515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.921199798583984 seconds
19 rew tensor(1.2100, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
19 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(1.4994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1597, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
18 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(0.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
17 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(1.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9561, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
16 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(0.9901, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8542, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
15 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-3.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1965, dtype=torch.float64) delta_t tensor(-0.2879, dtype=torch.float64)
14 gae_duplicate tensor(-2.7663, dtype=torch.float64) tensor(4.7684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7276, dtype=torch.float64) delta_t tensor(0.2002, dtype=torch.float64)
13 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-3.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1665, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
12 gae_duplicate tensor(-0.2738, dtype=torch.float64) tensor(0.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6504, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
11 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-3.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2309, dtype=torch.float64) delta_t tensor(-0.1678, dtype=torch.float64)
10 gae_duplicate tensor(-0.3440, dtype=torch.float64) tensor(2.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4833, dtype=torch.float64) delta_t tensor(0.2971, dtype=torch.float64)
9 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-5.2149, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6250, dtype=torch.float64) delta_t tensor(-0.1330, dtype=torch.float64)
8 gae_duplicate tensor(-0.7531, dtype=torch.float64) tensor(1.7370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9025, dtype=torch.float64) delta_t tensor(-0.1327, dtype=torch.float64)
7 gae_duplicate tensor(-1.3633, dtype=torch.float64) tensor(2.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8022, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
6 gae_duplicate tensor(-0.6501, dtype=torch.float64) tensor(0.8555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3988, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
5 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-0.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1118, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
4 gae_duplicate tensor(-0.2364, dtype=torch.float64) tensor(0.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9550, dtype=torch.float64) delta_t tensor(-0.2361, dtype=torch.float64)
3 gae_duplicate tensor(-0.8296, dtype=torch.float64) tensor(4.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2326, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
2 gae_duplicate tensor(-0.6750, dtype=torch.float64) tensor(0.2584, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-408.2557373046875
value loss:26.018949508666992
entropies:345.62847900390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3892.0522)
ToM Target loss= tensor(3971.3491)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8174729347229 seconds
19 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
19 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(1.6909, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0828, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
18 gae_duplicate tensor(-0.2201, dtype=torch.float64) tensor(1.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0448, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
17 gae_duplicate tensor(-0.2453, dtype=torch.float64) tensor(1.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8919, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
16 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(1.6696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8937, dtype=torch.float64) delta_t tensor(0.1904, dtype=torch.float64)
15 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(-3.5761, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5459, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
14 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-2.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6398, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
13 gae_duplicate tensor(0.0977, dtype=torch.float64) tensor(-4.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3522, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
12 gae_duplicate tensor(-0.2946, dtype=torch.float64) tensor(0.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3494, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
11 gae_duplicate tensor(-0.2923, dtype=torch.float64) tensor(-0.4961, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0719, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
10 gae_duplicate tensor(-0.3505, dtype=torch.float64) tensor(-0.1018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2596, dtype=torch.float64) delta_t tensor(0.1305, dtype=torch.float64)
9 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-2.7448, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6533, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
8 gae_duplicate tensor(-0.1595, dtype=torch.float64) tensor(0.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4351, dtype=torch.float64) delta_t tensor(0.1951, dtype=torch.float64)
7 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-3.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7822, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
6 gae_duplicate tensor(0.3683, dtype=torch.float64) tensor(-9.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2841, dtype=torch.float64) delta_t tensor(-0.0864, dtype=torch.float64)
5 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(1.2434, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1238, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
4 gae_duplicate tensor(-0.3637, dtype=torch.float64) tensor(-0.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7950, dtype=torch.float64) delta_t tensor(-0.1797, dtype=torch.float64)
3 gae_duplicate tensor(-0.4752, dtype=torch.float64) tensor(3.5561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2075, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
2 gae_duplicate tensor(-0.6366, dtype=torch.float64) tensor(-0.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:700.819580078125
value loss:12.830256462097168
entropies:345.8785705566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.103533029556274 seconds
19 rew tensor(1.2085, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
19 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(-1.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1838, dtype=torch.float64) delta_t tensor(0.1451, dtype=torch.float64)
18 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-2.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
17 gae_duplicate tensor(-0.2961, dtype=torch.float64) tensor(-0.6006, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0442, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
16 gae_duplicate tensor(-0.2900, dtype=torch.float64) tensor(-0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9311, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
15 gae_duplicate tensor(-0.3411, dtype=torch.float64) tensor(-3.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7275, dtype=torch.float64) delta_t tensor(0.2795, dtype=torch.float64)
14 gae_duplicate tensor(-0.1321, dtype=torch.float64) tensor(-5.4813, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7288, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
13 gae_duplicate tensor(-0.1447, dtype=torch.float64) tensor(-4.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5626, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
12 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(-5.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0278, dtype=torch.float64) delta_t tensor(-0.2996, dtype=torch.float64)
11 gae_duplicate tensor(-1.9454, dtype=torch.float64) tensor(5.2168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4384, dtype=torch.float64) delta_t tensor(-0.4652, dtype=torch.float64)
10 gae_duplicate tensor(-4.0456, dtype=torch.float64) tensor(8.9236, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1069, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
9 gae_duplicate tensor(-1.8926, dtype=torch.float64) tensor(1.6176, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7282, dtype=torch.float64) delta_t tensor(-0.2261, dtype=torch.float64)
8 gae_duplicate tensor(-1.2895, dtype=torch.float64) tensor(4.2368, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4820, dtype=torch.float64) delta_t tensor(-0.4806, dtype=torch.float64)
7 gae_duplicate tensor(-3.9731, dtype=torch.float64) tensor(9.4269, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8452, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
6 gae_duplicate tensor(-1.2050, dtype=torch.float64) tensor(0.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3412, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
5 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(-1.0891, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0620, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
4 gae_duplicate tensor(-0.3202, dtype=torch.float64) tensor(-2.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2167, dtype=torch.float64) delta_t tensor(-0.3220, dtype=torch.float64)
3 gae_duplicate tensor(-0.6784, dtype=torch.float64) tensor(6.3987, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4065, dtype=torch.float64) delta_t tensor(0.2584, dtype=torch.float64)
2 gae_duplicate tensor(-0.3310, dtype=torch.float64) tensor(-4.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-306.75531005859375
value loss:85.66478729248047
entropies:346.0718078613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7924418449401855 seconds
19 rew tensor(1.1302, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
19 gae_duplicate tensor(-0.2778, dtype=torch.float64) tensor(2.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1177, dtype=torch.float64) delta_t tensor(0.0986, dtype=torch.float64)
18 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(-1.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0927, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
17 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-1.2866, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
16 gae_duplicate tensor(-1.3600, dtype=torch.float64) tensor(3.2591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0432, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
15 gae_duplicate tensor(-0.2590, dtype=torch.float64) tensor(-5.5802, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7991, dtype=torch.float64) delta_t tensor(0.2233, dtype=torch.float64)
14 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-4.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8010, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
13 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-2.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4172, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
12 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(-1.6911, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0866, dtype=torch.float64) delta_t tensor(-0.2968, dtype=torch.float64)
11 gae_duplicate tensor(-2.2461, dtype=torch.float64) tensor(5.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7879, dtype=torch.float64) delta_t tensor(-0.6468, dtype=torch.float64)
10 gae_duplicate tensor(-3.6228, dtype=torch.float64) tensor(12.6186, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0160, dtype=torch.float64) delta_t tensor(-0.2978, dtype=torch.float64)
9 gae_duplicate tensor(-3.5967, dtype=torch.float64) tensor(6.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6364, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
8 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(2.5481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0163, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
7 gae_duplicate tensor(-2.3829, dtype=torch.float64) tensor(1.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8769, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
6 gae_duplicate tensor(-0.7131, dtype=torch.float64) tensor(-1.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3670, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
5 gae_duplicate tensor(-0.6077, dtype=torch.float64) tensor(-0.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0655, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
4 gae_duplicate tensor(-0.3420, dtype=torch.float64) tensor(1.1717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0579, dtype=torch.float64) delta_t tensor(-0.2825, dtype=torch.float64)
3 gae_duplicate tensor(-0.4399, dtype=torch.float64) tensor(5.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
2 gae_duplicate tensor(-0.3411, dtype=torch.float64) tensor(-3.2032, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1062.6153564453125
value loss:75.13835906982422
entropies:346.3988342285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.008655071258545 seconds
19 rew tensor(1.1321, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
19 gae_duplicate tensor(-0.2485, dtype=torch.float64) tensor(2.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1192, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
18 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(1.1259, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1062, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
17 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-0.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
16 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(1.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
15 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-3.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2063, dtype=torch.float64) delta_t tensor(-0.3087, dtype=torch.float64)
14 gae_duplicate tensor(-1.3521, dtype=torch.float64) tensor(5.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5998, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
13 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-1.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
12 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(0.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2302, dtype=torch.float64) delta_t tensor(-0.1172, dtype=torch.float64)
11 gae_duplicate tensor(-0.3240, dtype=torch.float64) tensor(2.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1380, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
10 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(0.2411, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1422, dtype=torch.float64) delta_t tensor(0.2437, dtype=torch.float64)
9 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(-4.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4197, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
8 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(0.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9522, dtype=torch.float64) delta_t tensor(0.2283, dtype=torch.float64)
7 gae_duplicate tensor(0.0590, dtype=torch.float64) tensor(-4.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5216, dtype=torch.float64) delta_t tensor(0.5144, dtype=torch.float64)
6 gae_duplicate tensor(0.3167, dtype=torch.float64) tensor(-10.1083, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6935, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
5 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-1.9525, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0858, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
4 gae_duplicate tensor(-0.2967, dtype=torch.float64) tensor(-0.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1957, dtype=torch.float64) delta_t tensor(-0.2175, dtype=torch.float64)
3 gae_duplicate tensor(-0.5425, dtype=torch.float64) tensor(3.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4292, dtype=torch.float64) delta_t tensor(0.1802, dtype=torch.float64)
2 gae_duplicate tensor(-0.3410, dtype=torch.float64) tensor(-2.9358, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:592.8400268554688
value loss:15.928121566772461
entropies:346.8922424316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.905555009841919 seconds
19 rew tensor(1.2340, dtype=torch.float64) delta_t tensor(-0.1030, dtype=torch.float64)
19 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(1.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1458, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
18 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(1.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0570, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
17 gae_duplicate tensor(-0.3370, dtype=torch.float64) tensor(2.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0057, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
16 gae_duplicate tensor(-0.2552, dtype=torch.float64) tensor(2.6751, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
15 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(-1.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1859, dtype=torch.float64) delta_t tensor(-0.2421, dtype=torch.float64)
14 gae_duplicate tensor(-1.4760, dtype=torch.float64) tensor(3.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(0.0539, dtype=torch.float64)
13 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(-0.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2667, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
12 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(0.5134, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
11 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(0.8604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1787, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
10 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(0.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.4238, dtype=torch.float64)
9 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-8.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5709, dtype=torch.float64) delta_t tensor(-0.4051, dtype=torch.float64)
8 gae_duplicate tensor(-0.7140, dtype=torch.float64) tensor(7.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1444, dtype=torch.float64) delta_t tensor(0.2988, dtype=torch.float64)
7 gae_duplicate tensor(0.0485, dtype=torch.float64) tensor(-5.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6987, dtype=torch.float64) delta_t tensor(0.2238, dtype=torch.float64)
6 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(-5.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6183, dtype=torch.float64) delta_t tensor(0.2327, dtype=torch.float64)
5 gae_duplicate tensor(0.1372, dtype=torch.float64) tensor(-5.0570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
4 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(-4.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5391, dtype=torch.float64) delta_t tensor(-0.2643, dtype=torch.float64)
3 gae_duplicate tensor(-0.4677, dtype=torch.float64) tensor(4.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6971, dtype=torch.float64) delta_t tensor(0.4388, dtype=torch.float64)
2 gae_duplicate tensor(-0.2110, dtype=torch.float64) tensor(-7.8707, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:491.66070556640625
value loss:21.706045150756836
entropies:347.3182067871094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3903.6746)
ToM Target loss= tensor(3972.3889)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.96122407913208 seconds
19 rew tensor(1.1451, dtype=torch.float64) delta_t tensor(-0.1550, dtype=torch.float64)
19 gae_duplicate tensor(-0.2754, dtype=torch.float64) tensor(3.0181, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1206, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
18 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(1.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0311, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
17 gae_duplicate tensor(-0.3124, dtype=torch.float64) tensor(1.4368, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0070, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
16 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(2.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
15 gae_duplicate tensor(-0.3351, dtype=torch.float64) tensor(-1.4198, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7151, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
14 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(-3.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6012, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
13 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(-2.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3444, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
12 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(0.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0348, dtype=torch.float64) delta_t tensor(-0.3709, dtype=torch.float64)
11 gae_duplicate tensor(-2.7146, dtype=torch.float64) tensor(6.7230, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3364, dtype=torch.float64) delta_t tensor(-0.2337, dtype=torch.float64)
10 gae_duplicate tensor(-0.7462, dtype=torch.float64) tensor(5.0086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3076, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
9 gae_duplicate tensor(-0.3034, dtype=torch.float64) tensor(-2.8194, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5354, dtype=torch.float64) delta_t tensor(-0.1424, dtype=torch.float64)
8 gae_duplicate tensor(-0.8031, dtype=torch.float64) tensor(2.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5361, dtype=torch.float64) delta_t tensor(0.2469, dtype=torch.float64)
7 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(-4.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7925, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
6 gae_duplicate tensor(-0.3550, dtype=torch.float64) tensor(-3.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3569, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
5 gae_duplicate tensor(-0.4198, dtype=torch.float64) tensor(0.0834, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1471, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
4 gae_duplicate tensor(-0.4140, dtype=torch.float64) tensor(1.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8703, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
3 gae_duplicate tensor(-0.2958, dtype=torch.float64) tensor(-1.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2093, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
2 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-5.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-47.68529510498047
value loss:24.006206512451172
entropies:347.6966552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.857881784439087 seconds
19 rew tensor(1.2087, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
19 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.6658, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1830, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
18 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-1.6443, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0425, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
17 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(-0.9608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0316, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
16 gae_duplicate tensor(-0.3017, dtype=torch.float64) tensor(-1.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6587, dtype=torch.float64) delta_t tensor(-0.0726, dtype=torch.float64)
15 gae_duplicate tensor(-1.5200, dtype=torch.float64) tensor(1.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4885, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
14 gae_duplicate tensor(-0.7410, dtype=torch.float64) tensor(-1.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6615, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
13 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-3.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2429, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
12 gae_duplicate tensor(-0.2787, dtype=torch.float64) tensor(-0.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6219, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
11 gae_duplicate tensor(-0.3177, dtype=torch.float64) tensor(-2.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2285, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
10 gae_duplicate tensor(-0.4301, dtype=torch.float64) tensor(4.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(0.2180, dtype=torch.float64)
9 gae_duplicate tensor(-0.2881, dtype=torch.float64) tensor(-3.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6963, dtype=torch.float64) delta_t tensor(-0.2598, dtype=torch.float64)
8 gae_duplicate tensor(-0.7665, dtype=torch.float64) tensor(4.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3050, dtype=torch.float64) delta_t tensor(-0.6083, dtype=torch.float64)
7 gae_duplicate tensor(-2.4994, dtype=torch.float64) tensor(11.5822, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9051, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
6 gae_duplicate tensor(-0.6928, dtype=torch.float64) tensor(2.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2358, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
5 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-2.3918, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
4 gae_duplicate tensor(-0.3066, dtype=torch.float64) tensor(-0.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9420, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
3 gae_duplicate tensor(-0.4471, dtype=torch.float64) tensor(2.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3162, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
2 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-4.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-303.86395263671875
value loss:29.033470153808594
entropies:348.1758117675781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.641453981399536 seconds
19 rew tensor(1.1840, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
19 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(2.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1324, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
18 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(0.2589, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0938, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
17 gae_duplicate tensor(-0.2926, dtype=torch.float64) tensor(1.1118, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9807, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
16 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(0.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.2540, dtype=torch.float64)
15 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(-5.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1378, dtype=torch.float64) delta_t tensor(-0.2449, dtype=torch.float64)
14 gae_duplicate tensor(-1.2763, dtype=torch.float64) tensor(4.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
13 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(-0.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0886, dtype=torch.float64) delta_t tensor(-0.2069, dtype=torch.float64)
12 gae_duplicate tensor(-1.4790, dtype=torch.float64) tensor(3.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4485, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
11 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-1.0041, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0040, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
10 gae_duplicate tensor(-0.2800, dtype=torch.float64) tensor(1.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4753, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
9 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-4.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7275, dtype=torch.float64) delta_t tensor(-0.2930, dtype=torch.float64)
8 gae_duplicate tensor(-0.8080, dtype=torch.float64) tensor(5.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5208, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
7 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-4.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7917, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
6 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-2.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3109, dtype=torch.float64) delta_t tensor(0.1724, dtype=torch.float64)
5 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-3.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0134, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
4 gae_duplicate tensor(-0.3333, dtype=torch.float64) tensor(-0.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9700, dtype=torch.float64) delta_t tensor(-0.1111, dtype=torch.float64)
3 gae_duplicate tensor(-0.3955, dtype=torch.float64) tensor(2.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3557, dtype=torch.float64) delta_t tensor(0.2716, dtype=torch.float64)
2 gae_duplicate tensor(-0.3578, dtype=torch.float64) tensor(-5.0992, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:265.75775146484375
value loss:19.048341751098633
entropies:348.5845947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.884258031845093 seconds
19 rew tensor(1.2339, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
19 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(0.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2218, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
18 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(-1.6764, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1837, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
17 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(-1.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8566, dtype=torch.float64) delta_t tensor(-0.2046, dtype=torch.float64)
16 gae_duplicate tensor(-1.4839, dtype=torch.float64) tensor(3.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6687, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
15 gae_duplicate tensor(-0.8563, dtype=torch.float64) tensor(0.8393, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
14 gae_duplicate tensor(-1.1563, dtype=torch.float64) tensor(0.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4835, dtype=torch.float64) delta_t tensor(0.1479, dtype=torch.float64)
13 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-2.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3029, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
12 gae_duplicate tensor(-1.3588, dtype=torch.float64) tensor(3.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3060, dtype=torch.float64) delta_t tensor(-0.5432, dtype=torch.float64)
11 gae_duplicate tensor(-3.1090, dtype=torch.float64) tensor(10.2367, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1335, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
10 gae_duplicate tensor(-1.2138, dtype=torch.float64) tensor(1.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2945, dtype=torch.float64) delta_t tensor(0.1255, dtype=torch.float64)
9 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-2.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6634, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
8 gae_duplicate tensor(-0.2429, dtype=torch.float64) tensor(2.5258, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1672, dtype=torch.float64) delta_t tensor(-0.1049, dtype=torch.float64)
7 gae_duplicate tensor(-1.9478, dtype=torch.float64) tensor(2.0667, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8274, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
6 gae_duplicate tensor(-0.7980, dtype=torch.float64) tensor(-5.3767, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5433, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
5 gae_duplicate tensor(-0.3557, dtype=torch.float64) tensor(-0.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0433, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
4 gae_duplicate tensor(-0.4379, dtype=torch.float64) tensor(1.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2338, dtype=torch.float64) delta_t tensor(-0.2518, dtype=torch.float64)
3 gae_duplicate tensor(-0.5449, dtype=torch.float64) tensor(5.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2750, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
2 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-4.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-850.0555419921875
value loss:43.69294357299805
entropies:349.01898193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.116100072860718 seconds
19 rew tensor(1.1319, dtype=torch.float64) delta_t tensor(-0.0771, dtype=torch.float64)
19 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(1.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0941, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
18 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-0.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0308, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
17 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.8612, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6812, dtype=torch.float64) delta_t tensor(-0.3403, dtype=torch.float64)
16 gae_duplicate tensor(-1.4628, dtype=torch.float64) tensor(6.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
15 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(-2.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6986, dtype=torch.float64) delta_t tensor(0.1953, dtype=torch.float64)
14 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-3.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6655, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
13 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-3.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
12 gae_duplicate tensor(-0.2770, dtype=torch.float64) tensor(0.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4115, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
11 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(-0.2082, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
10 gae_duplicate tensor(-0.2506, dtype=torch.float64) tensor(0.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3464, dtype=torch.float64) delta_t tensor(0.2230, dtype=torch.float64)
9 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(-4.1302, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5227, dtype=torch.float64) delta_t tensor(-0.1738, dtype=torch.float64)
8 gae_duplicate tensor(-0.4957, dtype=torch.float64) tensor(2.8904, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5699, dtype=torch.float64) delta_t tensor(0.1895, dtype=torch.float64)
7 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(-3.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5861, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
6 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-4.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4880, dtype=torch.float64) delta_t tensor(-0.1761, dtype=torch.float64)
5 gae_duplicate tensor(-0.3852, dtype=torch.float64) tensor(2.7607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
4 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(1.3651, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8379, dtype=torch.float64) delta_t tensor(-0.2393, dtype=torch.float64)
3 gae_duplicate tensor(-0.5096, dtype=torch.float64) tensor(4.6607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2403, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
2 gae_duplicate tensor(-0.3855, dtype=torch.float64) tensor(0.3137, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-80.2323226928711
value loss:11.564517974853516
entropies:349.31475830078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3908.8257)
ToM Target loss= tensor(3972.5991)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.784268140792847 seconds
19 rew tensor(1.1456, dtype=torch.float64) delta_t tensor(-0.0859, dtype=torch.float64)
19 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(1.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1329, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
18 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-0.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7718, dtype=torch.float64) delta_t tensor(-0.3189, dtype=torch.float64)
17 gae_duplicate tensor(-1.6181, dtype=torch.float64) tensor(5.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9291, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
16 gae_duplicate tensor(-0.3218, dtype=torch.float64) tensor(0.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8770, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
15 gae_duplicate tensor(-0.2514, dtype=torch.float64) tensor(-2.4551, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2055, dtype=torch.float64) delta_t tensor(-0.2859, dtype=torch.float64)
14 gae_duplicate tensor(-2.6994, dtype=torch.float64) tensor(4.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
13 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-2.7796, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3971, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
12 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(-2.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5192, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
11 gae_duplicate tensor(-0.3700, dtype=torch.float64) tensor(-1.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0227, dtype=torch.float64) delta_t tensor(-0.1895, dtype=torch.float64)
10 gae_duplicate tensor(-0.3221, dtype=torch.float64) tensor(3.4264, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3528, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
9 gae_duplicate tensor(-0.3562, dtype=torch.float64) tensor(-1.4707, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5956, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
8 gae_duplicate tensor(-0.4354, dtype=torch.float64) tensor(2.4251, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7349, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
7 gae_duplicate tensor(-0.5409, dtype=torch.float64) tensor(1.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6974, dtype=torch.float64) delta_t tensor(0.2836, dtype=torch.float64)
6 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-5.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3936, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
5 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(-2.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0906, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
4 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(1.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8927, dtype=torch.float64) delta_t tensor(-0.1747, dtype=torch.float64)
3 gae_duplicate tensor(-0.5672, dtype=torch.float64) tensor(3.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2662, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(0.3162, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-379.51416015625
value loss:24.543201446533203
entropies:349.561279296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.650480270385742 seconds
19 rew tensor(1.1726, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
19 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(0.5878, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1728, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
18 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-2.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9815, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
17 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(1.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9433, dtype=torch.float64) delta_t tensor(-0.0769, dtype=torch.float64)
16 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(1.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
15 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(-1.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5996, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
14 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-2.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5863, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
13 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-2.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2184, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
12 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(-0.7425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
11 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-0.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0485, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
10 gae_duplicate tensor(-0.2766, dtype=torch.float64) tensor(1.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4805, dtype=torch.float64) delta_t tensor(0.3572, dtype=torch.float64)
9 gae_duplicate tensor(0.1495, dtype=torch.float64) tensor(-7.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6736, dtype=torch.float64) delta_t tensor(-0.1979, dtype=torch.float64)
8 gae_duplicate tensor(-0.5236, dtype=torch.float64) tensor(2.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4531, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
7 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-0.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8403, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
6 gae_duplicate tensor(-0.4311, dtype=torch.float64) tensor(-1.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2416, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
5 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(-0.6328, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1631, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
4 gae_duplicate tensor(-0.3133, dtype=torch.float64) tensor(-0.6455, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7851, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
3 gae_duplicate tensor(-0.5205, dtype=torch.float64) tensor(3.4367, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1938, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
2 gae_duplicate tensor(-0.5922, dtype=torch.float64) tensor(1.7415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:318.78948974609375
value loss:9.362979888916016
entropies:349.7819519042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.827625036239624 seconds
19 rew tensor(1.1076, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
19 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(0.5582, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0824, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
18 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(-0.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
17 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(-1.5755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0445, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
16 gae_duplicate tensor(-0.0506, dtype=torch.float64) tensor(-0.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
15 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(-2.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4928, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
14 gae_duplicate tensor(-1.3263, dtype=torch.float64) tensor(-1.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.1716, dtype=torch.float64)
13 gae_duplicate tensor(0.0670, dtype=torch.float64) tensor(-3.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
12 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(-0.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
11 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-0.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0510, dtype=torch.float64) delta_t tensor(-0.0860, dtype=torch.float64)
10 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(1.6548, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2419, dtype=torch.float64) delta_t tensor(0.3770, dtype=torch.float64)
9 gae_duplicate tensor(0.2553, dtype=torch.float64) tensor(-7.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3682, dtype=torch.float64) delta_t tensor(-0.2797, dtype=torch.float64)
8 gae_duplicate tensor(-0.4186, dtype=torch.float64) tensor(5.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2084, dtype=torch.float64) delta_t tensor(0.1587, dtype=torch.float64)
7 gae_duplicate tensor(-0.0373, dtype=torch.float64) tensor(-3.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4831, dtype=torch.float64) delta_t tensor(0.2555, dtype=torch.float64)
6 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-4.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7728, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
5 gae_duplicate tensor(-0.7134, dtype=torch.float64) tensor(1.7734, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2387, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
4 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(-2.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3741, dtype=torch.float64) delta_t tensor(-0.3106, dtype=torch.float64)
3 gae_duplicate tensor(-0.5411, dtype=torch.float64) tensor(5.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6087, dtype=torch.float64) delta_t tensor(0.3204, dtype=torch.float64)
2 gae_duplicate tensor(0.1020, dtype=torch.float64) tensor(-5.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:913.4609375
value loss:12.897050857543945
entropies:349.9694519042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.056816101074219 seconds
19 rew tensor(1.1734, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
19 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-0.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1221, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
18 gae_duplicate tensor(-0.0121, dtype=torch.float64) tensor(-2.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9686, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
17 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(0.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9820, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
16 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-1.2388, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8158, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
15 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(-3.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
14 gae_duplicate tensor(0.1253, dtype=torch.float64) tensor(-5.5404, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5864, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
13 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-1.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3446, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
12 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(-1.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
11 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-0.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0765, dtype=torch.float64) delta_t tensor(-0.1246, dtype=torch.float64)
10 gae_duplicate tensor(-0.3063, dtype=torch.float64) tensor(2.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.2893, dtype=torch.float64)
9 gae_duplicate tensor(0.1840, dtype=torch.float64) tensor(-5.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5491, dtype=torch.float64) delta_t tensor(-0.3297, dtype=torch.float64)
8 gae_duplicate tensor(-0.5185, dtype=torch.float64) tensor(6.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7831, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
7 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(1.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6140, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
6 gae_duplicate tensor(-0.2659, dtype=torch.float64) tensor(-0.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5209, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
5 gae_duplicate tensor(-0.3637, dtype=torch.float64) tensor(2.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0145, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
4 gae_duplicate tensor(-0.2465, dtype=torch.float64) tensor(-0.3897, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0025, dtype=torch.float64) delta_t tensor(-0.2806, dtype=torch.float64)
3 gae_duplicate tensor(-0.5847, dtype=torch.float64) tensor(5.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3715, dtype=torch.float64) delta_t tensor(0.2770, dtype=torch.float64)
2 gae_duplicate tensor(0.0526, dtype=torch.float64) tensor(-5.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:464.76336669921875
value loss:8.649374008178711
entropies:350.1350402832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.937834978103638 seconds
19 rew tensor(1.1717, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
19 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(-0.6965, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(0.1738, dtype=torch.float64)
18 gae_duplicate tensor(-0.0170, dtype=torch.float64) tensor(-3.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0456, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
17 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-1.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0459, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
16 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-2.2482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9066, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
15 gae_duplicate tensor(-0.1191, dtype=torch.float64) tensor(-4.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7156, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
14 gae_duplicate tensor(0.1308, dtype=torch.float64) tensor(-4.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7796, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
13 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-4.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0156, dtype=torch.float64) delta_t tensor(-0.2166, dtype=torch.float64)
12 gae_duplicate tensor(-1.3891, dtype=torch.float64) tensor(4.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3019, dtype=torch.float64) delta_t tensor(-0.6320, dtype=torch.float64)
11 gae_duplicate tensor(-4.0532, dtype=torch.float64) tensor(15.0752, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6316, dtype=torch.float64) delta_t tensor(-0.4834, dtype=torch.float64)
10 gae_duplicate tensor(-3.0834, dtype=torch.float64) tensor(12.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2503, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
9 gae_duplicate tensor(-1.8665, dtype=torch.float64) tensor(2.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6499, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
8 gae_duplicate tensor(-0.4739, dtype=torch.float64) tensor(2.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4847, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
7 gae_duplicate tensor(-1.0555, dtype=torch.float64) tensor(0.0510, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9041, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
6 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(-1.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1947, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
5 gae_duplicate tensor(-0.4811, dtype=torch.float64) tensor(1.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3664, dtype=torch.float64) delta_t tensor(-0.1127, dtype=torch.float64)
4 gae_duplicate tensor(-0.5293, dtype=torch.float64) tensor(2.6514, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6493, dtype=torch.float64) delta_t tensor(-0.1562, dtype=torch.float64)
3 gae_duplicate tensor(-0.5678, dtype=torch.float64) tensor(3.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0466, dtype=torch.float64) delta_t tensor(-0.0916, dtype=torch.float64)
2 gae_duplicate tensor(-0.5130, dtype=torch.float64) tensor(2.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1423.7236328125
value loss:58.14106369018555
entropies:350.31976318359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3929.4785)
ToM Target loss= tensor(3978.0659)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.84501314163208 seconds
19 rew tensor(1.1472, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
19 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-0.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1480, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
18 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-2.7100, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0843, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
17 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-2.0911, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9709, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
16 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-0.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
15 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-0.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(-0.2408, dtype=torch.float64)
14 gae_duplicate tensor(-2.6796, dtype=torch.float64) tensor(4.2338, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6363, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
13 gae_duplicate tensor(-0.0266, dtype=torch.float64) tensor(-2.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
12 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(0.1000, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
11 gae_duplicate tensor(-0.0813, dtype=torch.float64) tensor(-1.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0259, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
10 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-1.2897, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2437, dtype=torch.float64) delta_t tensor(0.1932, dtype=torch.float64)
9 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(-4.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4214, dtype=torch.float64) delta_t tensor(-0.1473, dtype=torch.float64)
8 gae_duplicate tensor(-0.4749, dtype=torch.float64) tensor(2.4213, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0629, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
7 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-1.2175, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5370, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
6 gae_duplicate tensor(-0.0272, dtype=torch.float64) tensor(-3.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6739, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
5 gae_duplicate tensor(-0.7080, dtype=torch.float64) tensor(3.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(0.1078, dtype=torch.float64)
4 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(-1.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2689, dtype=torch.float64) delta_t tensor(-0.4105, dtype=torch.float64)
3 gae_duplicate tensor(-0.8494, dtype=torch.float64) tensor(8.3714, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(0.2865, dtype=torch.float64)
2 gae_duplicate tensor(-0.1301, dtype=torch.float64) tensor(-4.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:361.8725891113281
value loss:21.135847091674805
entropies:350.2972412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.83247184753418 seconds
19 rew tensor(1.1485, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
19 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(-0.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0959, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
18 gae_duplicate tensor(-0.0347, dtype=torch.float64) tensor(-2.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9701, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
17 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(-0.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
16 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(0.6919, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
15 gae_duplicate tensor(-0.0497, dtype=torch.float64) tensor(-3.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.2582, dtype=torch.float64)
14 gae_duplicate tensor(0.0355, dtype=torch.float64) tensor(-5.1434, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
13 gae_duplicate tensor(0.0844, dtype=torch.float64) tensor(-3.6293, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3450, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
12 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(-0.9182, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3689, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
11 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-1.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0121, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
10 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(-0.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3462, dtype=torch.float64) delta_t tensor(0.1788, dtype=torch.float64)
9 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(-3.4992, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5501, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
8 gae_duplicate tensor(-0.3786, dtype=torch.float64) tensor(1.8527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3066, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
7 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(-0.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7414, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
6 gae_duplicate tensor(-0.4687, dtype=torch.float64) tensor(0.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2391, dtype=torch.float64) delta_t tensor(-0.1678, dtype=torch.float64)
5 gae_duplicate tensor(-0.5331, dtype=torch.float64) tensor(3.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2701, dtype=torch.float64) delta_t tensor(-0.1223, dtype=torch.float64)
4 gae_duplicate tensor(-0.3716, dtype=torch.float64) tensor(2.6137, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(-0.1595, dtype=torch.float64)
3 gae_duplicate tensor(-0.5414, dtype=torch.float64) tensor(3.8856, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
2 gae_duplicate tensor(-0.6193, dtype=torch.float64) tensor(0.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:333.1102294921875
value loss:8.894750595092773
entropies:350.3946228027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.068092107772827 seconds
19 rew tensor(1.1734, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
19 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-1.3875, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0713, dtype=torch.float64) delta_t tensor(0.0770, dtype=torch.float64)
18 gae_duplicate tensor(0.0208, dtype=torch.float64) tensor(-1.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0071, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
17 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(-1.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9576, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
16 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(-2.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6188, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
15 gae_duplicate tensor(-1.2052, dtype=torch.float64) tensor(-0.3339, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
14 gae_duplicate tensor(0.0603, dtype=torch.float64) tensor(-4.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5616, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
13 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-3.3306, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
12 gae_duplicate tensor(-0.0275, dtype=torch.float64) tensor(-2.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
11 gae_duplicate tensor(-0.0582, dtype=torch.float64) tensor(-2.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0615, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
10 gae_duplicate tensor(-0.3555, dtype=torch.float64) tensor(1.5224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2426, dtype=torch.float64) delta_t tensor(0.2202, dtype=torch.float64)
9 gae_duplicate tensor(-0.0151, dtype=torch.float64) tensor(-4.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3963, dtype=torch.float64) delta_t tensor(-0.1050, dtype=torch.float64)
8 gae_duplicate tensor(-0.4774, dtype=torch.float64) tensor(1.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9595, dtype=torch.float64) delta_t tensor(-0.0913, dtype=torch.float64)
7 gae_duplicate tensor(-0.4669, dtype=torch.float64) tensor(1.7260, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5120, dtype=torch.float64) delta_t tensor(0.3143, dtype=torch.float64)
6 gae_duplicate tensor(0.0962, dtype=torch.float64) tensor(-5.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7255, dtype=torch.float64) delta_t tensor(-0.1587, dtype=torch.float64)
5 gae_duplicate tensor(-0.6681, dtype=torch.float64) tensor(2.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0630, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
4 gae_duplicate tensor(-0.2450, dtype=torch.float64) tensor(0.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1776, dtype=torch.float64) delta_t tensor(-0.3289, dtype=torch.float64)
3 gae_duplicate tensor(-0.5543, dtype=torch.float64) tensor(6.5574, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4080, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
2 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(-1.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:877.3092651367188
value loss:11.812228202819824
entropies:350.4384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.694148063659668 seconds
19 rew tensor(1.1606, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
19 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(-1.2839, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1480, dtype=torch.float64) delta_t tensor(0.1856, dtype=torch.float64)
18 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-3.6737, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8503, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
17 gae_duplicate tensor(-1.1044, dtype=torch.float64) tensor(0.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
16 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-1.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0342, dtype=torch.float64) delta_t tensor(0.3292, dtype=torch.float64)
15 gae_duplicate tensor(-0.0775, dtype=torch.float64) tensor(-6.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7134, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
14 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-5.2948, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2392, dtype=torch.float64) delta_t tensor(-0.2001, dtype=torch.float64)
13 gae_duplicate tensor(-2.4625, dtype=torch.float64) tensor(5.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(-0.1137, dtype=torch.float64)
12 gae_duplicate tensor(-0.8848, dtype=torch.float64) tensor(3.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5737, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
11 gae_duplicate tensor(-0.3493, dtype=torch.float64) tensor(-1.7256, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1522, dtype=torch.float64) delta_t tensor(-0.0766, dtype=torch.float64)
10 gae_duplicate tensor(-0.2618, dtype=torch.float64) tensor(1.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
9 gae_duplicate tensor(-0.3141, dtype=torch.float64) tensor(-3.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7288, dtype=torch.float64) delta_t tensor(-0.2530, dtype=torch.float64)
8 gae_duplicate tensor(-0.7297, dtype=torch.float64) tensor(5.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2176, dtype=torch.float64) delta_t tensor(-0.5663, dtype=torch.float64)
7 gae_duplicate tensor(-4.2601, dtype=torch.float64) tensor(11.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8719, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
6 gae_duplicate tensor(-0.9333, dtype=torch.float64) tensor(0.1835, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3144, dtype=torch.float64) delta_t tensor(-0.1341, dtype=torch.float64)
5 gae_duplicate tensor(-0.5862, dtype=torch.float64) tensor(2.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1463, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
4 gae_duplicate tensor(-0.2810, dtype=torch.float64) tensor(0.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9162, dtype=torch.float64) delta_t tensor(-0.1455, dtype=torch.float64)
3 gae_duplicate tensor(-0.6727, dtype=torch.float64) tensor(2.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1727, dtype=torch.float64) delta_t tensor(0.1273, dtype=torch.float64)
2 gae_duplicate tensor(-0.1611, dtype=torch.float64) tensor(-2.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-457.2230224609375
value loss:54.08677673339844
entropies:350.47833251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.814194202423096 seconds
19 rew tensor(1.1724, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
19 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-1.8318, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0956, dtype=torch.float64) delta_t tensor(0.1265, dtype=torch.float64)
18 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-2.9257, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1084, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
17 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-2.5137, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
16 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(-2.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9423, dtype=torch.float64) delta_t tensor(0.2628, dtype=torch.float64)
15 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-5.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
14 gae_duplicate tensor(-0.7736, dtype=torch.float64) tensor(-0.8792, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6758, dtype=torch.float64) delta_t tensor(0.2779, dtype=torch.float64)
13 gae_duplicate tensor(0.0539, dtype=torch.float64) tensor(-5.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3564, dtype=torch.float64) delta_t tensor(0.0141, dtype=torch.float64)
12 gae_duplicate tensor(-0.2891, dtype=torch.float64) tensor(-0.5035, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1356, dtype=torch.float64) delta_t tensor(-0.4672, dtype=torch.float64)
11 gae_duplicate tensor(-3.4971, dtype=torch.float64) tensor(8.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1143, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
10 gae_duplicate tensor(-0.4797, dtype=torch.float64) tensor(0.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3185, dtype=torch.float64) delta_t tensor(0.2204, dtype=torch.float64)
9 gae_duplicate tensor(0.0334, dtype=torch.float64) tensor(-4.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
8 gae_duplicate tensor(-0.6067, dtype=torch.float64) tensor(3.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3887, dtype=torch.float64) delta_t tensor(-0.5293, dtype=torch.float64)
7 gae_duplicate tensor(-3.9010, dtype=torch.float64) tensor(9.9959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8575, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
6 gae_duplicate tensor(-1.0186, dtype=torch.float64) tensor(0.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4910, dtype=torch.float64) delta_t tensor(-0.1677, dtype=torch.float64)
5 gae_duplicate tensor(-0.5301, dtype=torch.float64) tensor(3.1921, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1222, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
4 gae_duplicate tensor(-0.4555, dtype=torch.float64) tensor(0.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1171, dtype=torch.float64) delta_t tensor(-0.3014, dtype=torch.float64)
3 gae_duplicate tensor(-0.6751, dtype=torch.float64) tensor(5.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2223, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
2 gae_duplicate tensor(-0.4507, dtype=torch.float64) tensor(-2.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-363.1407470703125
value loss:56.385643005371094
entropies:350.393310546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3919.3130)
ToM Target loss= tensor(3974.3906)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.022769927978516 seconds
19 rew tensor(1.1211, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
19 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(0.5867, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1217, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
18 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-1.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0581, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
17 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(-0.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9301, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
16 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(0.9674, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
15 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-2.3639, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4131, dtype=torch.float64) delta_t tensor(-0.1307, dtype=torch.float64)
14 gae_duplicate tensor(-1.2923, dtype=torch.float64) tensor(2.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.2543, dtype=torch.float64)
13 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-4.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3570, dtype=torch.float64) delta_t tensor(-0.1291, dtype=torch.float64)
12 gae_duplicate tensor(-0.2359, dtype=torch.float64) tensor(1.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
11 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(0.4148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0249, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
10 gae_duplicate tensor(-0.2158, dtype=torch.float64) tensor(0.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1907, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
9 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(-2.7382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3702, dtype=torch.float64) delta_t tensor(-0.1348, dtype=torch.float64)
8 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(2.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9938, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
7 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-1.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4724, dtype=torch.float64) delta_t tensor(0.2203, dtype=torch.float64)
6 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-4.4255, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7229, dtype=torch.float64) delta_t tensor(-0.0990, dtype=torch.float64)
5 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(1.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
4 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-0.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1613, dtype=torch.float64) delta_t tensor(-0.2817, dtype=torch.float64)
3 gae_duplicate tensor(-0.4093, dtype=torch.float64) tensor(5.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4311, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
2 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(-2.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:139.34640502929688
value loss:8.953495025634766
entropies:350.4264221191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9991419315338135 seconds
19 rew tensor(1.2479, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
19 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(0.1769, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2356, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
18 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-1.9517, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1585, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
17 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-1.2114, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0952, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
16 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(-1.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5195, dtype=torch.float64) delta_t tensor(-0.3551, dtype=torch.float64)
15 gae_duplicate tensor(-2.7911, dtype=torch.float64) tensor(6.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6570, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
14 gae_duplicate tensor(-1.0665, dtype=torch.float64) tensor(-2.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1854, dtype=torch.float64) delta_t tensor(-0.5832, dtype=torch.float64)
13 gae_duplicate tensor(-2.6668, dtype=torch.float64) tensor(12.5706, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
12 gae_duplicate tensor(-1.3494, dtype=torch.float64) tensor(3.0873, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5118, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
11 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(-0.6924, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1022, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
10 gae_duplicate tensor(-0.2533, dtype=torch.float64) tensor(1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6619, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
9 gae_duplicate tensor(0.1952, dtype=torch.float64) tensor(-7.1182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7514, dtype=torch.float64) delta_t tensor(-0.3960, dtype=torch.float64)
8 gae_duplicate tensor(-0.6748, dtype=torch.float64) tensor(7.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6499, dtype=torch.float64) delta_t tensor(-0.3123, dtype=torch.float64)
7 gae_duplicate tensor(-2.2211, dtype=torch.float64) tensor(7.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9435, dtype=torch.float64) delta_t tensor(-0.0936, dtype=torch.float64)
6 gae_duplicate tensor(-0.7157, dtype=torch.float64) tensor(2.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4680, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
5 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-4.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1638, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
4 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-2.7819, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4534, dtype=torch.float64) delta_t tensor(-0.2262, dtype=torch.float64)
3 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(4.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4827, dtype=torch.float64) delta_t tensor(0.1756, dtype=torch.float64)
2 gae_duplicate tensor(-0.4920, dtype=torch.float64) tensor(-2.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1168.39697265625
value loss:50.100074768066406
entropies:350.4881591796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.014830112457275 seconds
19 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
19 gae_duplicate tensor(-0.2124, dtype=torch.float64) tensor(1.0937, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0841, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
18 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-0.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0709, dtype=torch.float64) delta_t tensor(0.0136, dtype=torch.float64)
17 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-0.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
16 gae_duplicate tensor(-0.2239, dtype=torch.float64) tensor(1.9682, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6448, dtype=torch.float64) delta_t tensor(-0.1752, dtype=torch.float64)
15 gae_duplicate tensor(-1.4947, dtype=torch.float64) tensor(3.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4687, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
14 gae_duplicate tensor(-1.2813, dtype=torch.float64) tensor(1.0763, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
13 gae_duplicate tensor(-0.0817, dtype=torch.float64) tensor(-1.8835, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2825, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
12 gae_duplicate tensor(-0.2941, dtype=torch.float64) tensor(0.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
11 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-0.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0112, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
10 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(0.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.2304, dtype=torch.float64)
9 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(-4.1906, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4453, dtype=torch.float64) delta_t tensor(-0.0684, dtype=torch.float64)
8 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(0.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7276, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
7 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-1.8245, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5604, dtype=torch.float64) delta_t tensor(0.2933, dtype=torch.float64)
6 gae_duplicate tensor(0.0283, dtype=torch.float64) tensor(-6.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5439, dtype=torch.float64) delta_t tensor(-0.1556, dtype=torch.float64)
5 gae_duplicate tensor(-0.7071, dtype=torch.float64) tensor(2.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
4 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(0.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9697, dtype=torch.float64) delta_t tensor(-0.2166, dtype=torch.float64)
3 gae_duplicate tensor(-0.4342, dtype=torch.float64) tensor(4.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
2 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-59.01759719848633
value loss:13.800015449523926
entropies:350.3927917480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.756019115447998 seconds
19 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
19 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(1.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1220, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
18 gae_duplicate tensor(-0.0611, dtype=torch.float64) tensor(-0.7226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0462, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
17 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(0.4645, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
16 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(1.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
15 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-2.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5859, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
14 gae_duplicate tensor(0.1182, dtype=torch.float64) tensor(-3.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8188, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
13 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-4.3461, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1507, dtype=torch.float64) delta_t tensor(-0.2047, dtype=torch.float64)
12 gae_duplicate tensor(-0.2768, dtype=torch.float64) tensor(3.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6417, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
11 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(-1.9181, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1658, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
10 gae_duplicate tensor(-0.2941, dtype=torch.float64) tensor(2.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3450, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
9 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(-1.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6636, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
8 gae_duplicate tensor(-0.6043, dtype=torch.float64) tensor(2.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9321, dtype=torch.float64) delta_t tensor(-0.4023, dtype=torch.float64)
7 gae_duplicate tensor(-2.9617, dtype=torch.float64) tensor(7.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7796, dtype=torch.float64) delta_t tensor(0.1181, dtype=torch.float64)
6 gae_duplicate tensor(-0.6778, dtype=torch.float64) tensor(-1.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3134, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
5 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(-0.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1153, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
4 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(-0.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8818, dtype=torch.float64) delta_t tensor(-0.1992, dtype=torch.float64)
3 gae_duplicate tensor(-0.6418, dtype=torch.float64) tensor(3.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2420, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
2 gae_duplicate tensor(-0.5367, dtype=torch.float64) tensor(0.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-427.15234375
value loss:23.018760681152344
entropies:350.29547119140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.098341226577759 seconds
19 rew tensor(1.1705, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
19 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(1.5424, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1968, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
18 gae_duplicate tensor(-0.0605, dtype=torch.float64) tensor(-1.4185, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1729, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
17 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-1.5414, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0579, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
16 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-0.3556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
15 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-3.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2560, dtype=torch.float64) delta_t tensor(-0.4042, dtype=torch.float64)
14 gae_duplicate tensor(-1.2163, dtype=torch.float64) tensor(8.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1355, dtype=torch.float64) delta_t tensor(-0.5604, dtype=torch.float64)
13 gae_duplicate tensor(-4.2030, dtype=torch.float64) tensor(14.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1095, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
12 gae_duplicate tensor(-1.5045, dtype=torch.float64) tensor(6.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4091, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
11 gae_duplicate tensor(-0.1934, dtype=torch.float64) tensor(0.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
10 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(-0.9298, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(0.3606, dtype=torch.float64)
9 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(-6.7684, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5995, dtype=torch.float64) delta_t tensor(-0.1035, dtype=torch.float64)
8 gae_duplicate tensor(-0.5191, dtype=torch.float64) tensor(1.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2725, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
7 gae_duplicate tensor(-1.5006, dtype=torch.float64) tensor(1.6865, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7279, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
6 gae_duplicate tensor(-0.3893, dtype=torch.float64) tensor(-0.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6190, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
5 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-1.8061, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
4 gae_duplicate tensor(-0.3128, dtype=torch.float64) tensor(-2.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4285, dtype=torch.float64) delta_t tensor(-0.2005, dtype=torch.float64)
3 gae_duplicate tensor(-0.6135, dtype=torch.float64) tensor(4.0759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5472, dtype=torch.float64) delta_t tensor(0.3717, dtype=torch.float64)
2 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-6.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-811.5067138671875
value loss:47.54900360107422
entropies:350.32373046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3913.3584)
ToM Target loss= tensor(3966.4592)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.985190153121948 seconds
19 rew tensor(1.1483, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
19 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(1.7918, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1233, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
18 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-0.0658, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1104, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
17 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0848, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
16 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(0.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9447, dtype=torch.float64) delta_t tensor(0.1388, dtype=torch.float64)
15 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-2.3762, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1984, dtype=torch.float64) delta_t tensor(-0.2155, dtype=torch.float64)
14 gae_duplicate tensor(-1.2429, dtype=torch.float64) tensor(3.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3566, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
13 gae_duplicate tensor(-1.3183, dtype=torch.float64) tensor(2.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1353, dtype=torch.float64) delta_t tensor(-0.2746, dtype=torch.float64)
12 gae_duplicate tensor(-1.7325, dtype=torch.float64) tensor(5.4511, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3821, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
11 gae_duplicate tensor(-0.2543, dtype=torch.float64) tensor(0.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0237, dtype=torch.float64) delta_t tensor(0.1379, dtype=torch.float64)
10 gae_duplicate tensor(-0.2914, dtype=torch.float64) tensor(-2.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(0.2239, dtype=torch.float64)
9 gae_duplicate tensor(0.0430, dtype=torch.float64) tensor(-4.9195, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5126, dtype=torch.float64) delta_t tensor(-0.1651, dtype=torch.float64)
8 gae_duplicate tensor(-0.4433, dtype=torch.float64) tensor(2.6350, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6715, dtype=torch.float64) delta_t tensor(0.2512, dtype=torch.float64)
7 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-4.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6017, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
6 gae_duplicate tensor(0.0843, dtype=torch.float64) tensor(-4.4158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5666, dtype=torch.float64) delta_t tensor(-0.2303, dtype=torch.float64)
5 gae_duplicate tensor(-0.5587, dtype=torch.float64) tensor(3.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0662, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
4 gae_duplicate tensor(-0.3620, dtype=torch.float64) tensor(1.3267, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9822, dtype=torch.float64) delta_t tensor(-0.1418, dtype=torch.float64)
3 gae_duplicate tensor(-0.2869, dtype=torch.float64) tensor(2.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2902, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
2 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-2.1437, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-229.78713989257812
value loss:20.92474365234375
entropies:350.1958923339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.839751958847046 seconds
19 rew tensor(1.1855, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
19 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(0.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1860, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
18 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-2.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0322, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
17 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(0.3698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0080, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
16 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(-0.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8672, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
15 gae_duplicate tensor(0.0740, dtype=torch.float64) tensor(-3.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6652, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
14 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(-1.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7516, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
13 gae_duplicate tensor(0.0735, dtype=torch.float64) tensor(-3.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1552, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
12 gae_duplicate tensor(-0.4305, dtype=torch.float64) tensor(1.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6618, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
11 gae_duplicate tensor(-0.2019, dtype=torch.float64) tensor(-1.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1795, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
10 gae_duplicate tensor(-0.3019, dtype=torch.float64) tensor(2.3046, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4347, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
9 gae_duplicate tensor(-0.2549, dtype=torch.float64) tensor(-1.6322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6378, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
8 gae_duplicate tensor(-0.5338, dtype=torch.float64) tensor(-0.5965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6828, dtype=torch.float64) delta_t tensor(-0.1578, dtype=torch.float64)
7 gae_duplicate tensor(-1.1217, dtype=torch.float64) tensor(2.7455, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0335, dtype=torch.float64) delta_t tensor(-0.1850, dtype=torch.float64)
6 gae_duplicate tensor(-0.6421, dtype=torch.float64) tensor(4.1249, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1139, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
5 gae_duplicate tensor(0.0378, dtype=torch.float64) tensor(-1.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2905, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
4 gae_duplicate tensor(-0.3003, dtype=torch.float64) tensor(1.2211, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6848, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
3 gae_duplicate tensor(-0.6236, dtype=torch.float64) tensor(-0.2913, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0663, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
2 gae_duplicate tensor(-0.6301, dtype=torch.float64) tensor(0.2820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:124.33963012695312
value loss:11.580986022949219
entropies:350.21942138671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.186280965805054 seconds
19 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(-0.1141, dtype=torch.float64)
19 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(2.2414, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1477, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
18 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(-0.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9951, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
17 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(2.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0206, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
16 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(1.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
15 gae_duplicate tensor(-0.2274, dtype=torch.float64) tensor(-1.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
14 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-3.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
13 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-0.7398, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0008, dtype=torch.float64) delta_t tensor(-0.3222, dtype=torch.float64)
12 gae_duplicate tensor(-1.7655, dtype=torch.float64) tensor(6.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(4.4313e-05, dtype=torch.float64) delta_t tensor(-0.4356, dtype=torch.float64)
11 gae_duplicate tensor(-2.8157, dtype=torch.float64) tensor(8.9235, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3455, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
10 gae_duplicate tensor(-0.8187, dtype=torch.float64) tensor(4.7997, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.1699, dtype=torch.float64)
9 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(-2.9772, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6260, dtype=torch.float64) delta_t tensor(-0.0703, dtype=torch.float64)
8 gae_duplicate tensor(-0.2534, dtype=torch.float64) tensor(1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1633, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
7 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-1.7069, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8308, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
6 gae_duplicate tensor(-0.3863, dtype=torch.float64) tensor(-0.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1344, dtype=torch.float64) delta_t tensor(-0.0866, dtype=torch.float64)
5 gae_duplicate tensor(-0.4512, dtype=torch.float64) tensor(1.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3471, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
4 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(0.4259, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4836, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
3 gae_duplicate tensor(-0.3612, dtype=torch.float64) tensor(1.8584, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(-0.1591, dtype=torch.float64)
2 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(3.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1307.730712890625
value loss:24.037126541137695
entropies:350.08831787109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.975916862487793 seconds
19 rew tensor(1.1845, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
19 gae_duplicate tensor(-0.2935, dtype=torch.float64) tensor(0.7099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1595, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
18 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-1.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0060, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
17 gae_duplicate tensor(-0.2769, dtype=torch.float64) tensor(1.5244, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9939, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
16 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(1.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9443, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
15 gae_duplicate tensor(-0.1296, dtype=torch.float64) tensor(-4.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3551, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
14 gae_duplicate tensor(-1.2945, dtype=torch.float64) tensor(0.8287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8031, dtype=torch.float64) delta_t tensor(0.2604, dtype=torch.float64)
13 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(-4.8155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1158, dtype=torch.float64) delta_t tensor(-0.1683, dtype=torch.float64)
12 gae_duplicate tensor(-0.3755, dtype=torch.float64) tensor(2.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5464, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
11 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-2.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1900, dtype=torch.float64) delta_t tensor(-0.1422, dtype=torch.float64)
10 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(2.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5482, dtype=torch.float64) delta_t tensor(0.2806, dtype=torch.float64)
9 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-5.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7514, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
8 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(1.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1197, dtype=torch.float64) delta_t tensor(-0.2984, dtype=torch.float64)
7 gae_duplicate tensor(-2.5770, dtype=torch.float64) tensor(7.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8032, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
6 gae_duplicate tensor(-0.5770, dtype=torch.float64) tensor(0.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4173, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
5 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-1.9045, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0419, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
4 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-1.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0568, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
3 gae_duplicate tensor(-0.3487, dtype=torch.float64) tensor(1.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2899, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
2 gae_duplicate tensor(-0.3526, dtype=torch.float64) tensor(-2.4804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:131.46543884277344
value loss:23.617183685302734
entropies:350.0930480957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.740537166595459 seconds
19 rew tensor(1.1101, dtype=torch.float64) delta_t tensor(-0.1373, dtype=torch.float64)
19 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(2.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1105, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
18 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.2385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0222, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
17 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(1.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9686, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
16 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(2.1921, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8810, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
15 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(0.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4788, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
14 gae_duplicate tensor(-1.3032, dtype=torch.float64) tensor(0.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6277, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
13 gae_duplicate tensor(-0.0005, dtype=torch.float64) tensor(-2.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
12 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(0.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3853, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
11 gae_duplicate tensor(-0.2155, dtype=torch.float64) tensor(1.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0641, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
10 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(1.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
9 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(-3.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4749, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
8 gae_duplicate tensor(-0.4697, dtype=torch.float64) tensor(1.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8983, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
7 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(-3.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5897, dtype=torch.float64) delta_t tensor(0.2398, dtype=torch.float64)
6 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-5.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6433, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
5 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(-1.8304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0845, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
4 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-1.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1836, dtype=torch.float64) delta_t tensor(-0.2374, dtype=torch.float64)
3 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(4.9601, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4289, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
2 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(-2.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-6.885865688323975
value loss:10.484434127807617
entropies:349.9466857910156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3920.9658)
ToM Target loss= tensor(3972.5449)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.922439813613892 seconds
19 rew tensor(1.2242, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
19 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(1.3785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9615, dtype=torch.float64) delta_t tensor(-0.1255, dtype=torch.float64)
18 gae_duplicate tensor(-1.3506, dtype=torch.float64) tensor(2.3728, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1618, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
17 gae_duplicate tensor(-0.2330, dtype=torch.float64) tensor(-0.8252, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(0.0981, dtype=torch.float64)
16 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-1.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1127, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
15 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-3.4063, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6473, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
14 gae_duplicate tensor(-1.0957, dtype=torch.float64) tensor(0.6446, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6256, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
13 gae_duplicate tensor(-1.5248, dtype=torch.float64) tensor(-2.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0437, dtype=torch.float64) delta_t tensor(-0.2914, dtype=torch.float64)
12 gae_duplicate tensor(-1.8607, dtype=torch.float64) tensor(5.2373, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5520, dtype=torch.float64) delta_t tensor(-0.9716, dtype=torch.float64)
11 gae_duplicate tensor(-3.9892, dtype=torch.float64) tensor(21.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5385, dtype=torch.float64) delta_t tensor(-0.3830, dtype=torch.float64)
10 gae_duplicate tensor(-2.4417, dtype=torch.float64) tensor(9.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5277, dtype=torch.float64) delta_t tensor(0.1697, dtype=torch.float64)
9 gae_duplicate tensor(-0.5397, dtype=torch.float64) tensor(-2.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6800, dtype=torch.float64) delta_t tensor(-0.1933, dtype=torch.float64)
8 gae_duplicate tensor(-0.6447, dtype=torch.float64) tensor(3.4131, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8382, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
7 gae_duplicate tensor(-0.9629, dtype=torch.float64) tensor(-3.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8730, dtype=torch.float64) delta_t tensor(0.1706, dtype=torch.float64)
6 gae_duplicate tensor(-0.6159, dtype=torch.float64) tensor(-3.6095, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4431, dtype=torch.float64) delta_t tensor(0.1053, dtype=torch.float64)
5 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(-2.8462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0364, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
4 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(-0.9893, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1829, dtype=torch.float64) delta_t tensor(-0.1474, dtype=torch.float64)
3 gae_duplicate tensor(-0.4342, dtype=torch.float64) tensor(2.6018, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
2 gae_duplicate tensor(-0.3752, dtype=torch.float64) tensor(-1.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1337.0494384765625
value loss:66.1258773803711
entropies:349.8552551269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.600749254226685 seconds
19 rew tensor(1.1073, dtype=torch.float64) delta_t tensor(-0.1316, dtype=torch.float64)
19 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(2.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0819, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
18 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(0.8221, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0318, dtype=torch.float64) delta_t tensor(-0.0739, dtype=torch.float64)
17 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(1.4550, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9560, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
16 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(1.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9306, dtype=torch.float64) delta_t tensor(0.1616, dtype=torch.float64)
15 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-2.9936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
14 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(-3.4942, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7260, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
13 gae_duplicate tensor(0.0537, dtype=torch.float64) tensor(-4.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
12 gae_duplicate tensor(-0.2314, dtype=torch.float64) tensor(1.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5827, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
11 gae_duplicate tensor(-0.3074, dtype=torch.float64) tensor(-2.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1642, dtype=torch.float64) delta_t tensor(-0.1261, dtype=torch.float64)
10 gae_duplicate tensor(-0.2672, dtype=torch.float64) tensor(2.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3564, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
9 gae_duplicate tensor(-0.3288, dtype=torch.float64) tensor(-1.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6340, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
8 gae_duplicate tensor(-0.6408, dtype=torch.float64) tensor(3.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0818, dtype=torch.float64) delta_t tensor(-0.2862, dtype=torch.float64)
7 gae_duplicate tensor(-2.6038, dtype=torch.float64) tensor(5.1090, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8391, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
6 gae_duplicate tensor(-0.7304, dtype=torch.float64) tensor(-2.1359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2898, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
5 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-3.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0150, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
4 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-1.9134, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9927, dtype=torch.float64) delta_t tensor(-0.1437, dtype=torch.float64)
3 gae_duplicate tensor(-0.4998, dtype=torch.float64) tensor(2.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3424, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
2 gae_duplicate tensor(-0.3849, dtype=torch.float64) tensor(-2.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:137.8976593017578
value loss:21.646684646606445
entropies:349.8695983886719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.94788670539856 seconds
19 rew tensor(1.2346, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
19 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(1.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2351, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
18 gae_duplicate tensor(-0.0238, dtype=torch.float64) tensor(-1.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1340, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
17 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-0.2444, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0431, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
16 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(0.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9425, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
15 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-2.8001, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(-0.4292, dtype=torch.float64)
14 gae_duplicate tensor(-1.3653, dtype=torch.float64) tensor(7.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6005, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
13 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-3.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3806, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
12 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(-0.4281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
11 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0365, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
10 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(1.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2303, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
9 gae_duplicate tensor(-0.3115, dtype=torch.float64) tensor(-3.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5725, dtype=torch.float64) delta_t tensor(-0.1282, dtype=torch.float64)
8 gae_duplicate tensor(-0.6243, dtype=torch.float64) tensor(1.6250, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4920, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
7 gae_duplicate tensor(-0.7196, dtype=torch.float64) tensor(0.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7004, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
6 gae_duplicate tensor(-0.4345, dtype=torch.float64) tensor(-0.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7184, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
5 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-3.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3398, dtype=torch.float64) delta_t tensor(0.2015, dtype=torch.float64)
4 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(-4.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6386, dtype=torch.float64) delta_t tensor(-0.2460, dtype=torch.float64)
3 gae_duplicate tensor(-0.4623, dtype=torch.float64) tensor(4.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6716, dtype=torch.float64) delta_t tensor(0.3443, dtype=torch.float64)
2 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(-5.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:521.440185546875
value loss:16.169862747192383
entropies:349.9010009765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.005457162857056 seconds
19 rew tensor(1.1718, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
19 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(0.6926, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1326, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
18 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(-1.0701, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0573, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
17 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(0.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0444, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
16 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(1.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9312, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
15 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(-0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3196, dtype=torch.float64) delta_t tensor(-0.3982, dtype=torch.float64)
14 gae_duplicate tensor(-2.7312, dtype=torch.float64) tensor(7.0755, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3634, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
13 gae_duplicate tensor(-1.2982, dtype=torch.float64) tensor(1.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4858, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
12 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-3.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3591, dtype=torch.float64) delta_t tensor(-0.0778, dtype=torch.float64)
11 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(1.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0268, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
10 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(0.9041, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3753, dtype=torch.float64) delta_t tensor(0.3734, dtype=torch.float64)
9 gae_duplicate tensor(0.1431, dtype=torch.float64) tensor(-7.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5755, dtype=torch.float64) delta_t tensor(-0.3499, dtype=torch.float64)
8 gae_duplicate tensor(-0.6533, dtype=torch.float64) tensor(6.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7398, dtype=torch.float64) delta_t tensor(-0.1795, dtype=torch.float64)
7 gae_duplicate tensor(-2.2829, dtype=torch.float64) tensor(5.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7422, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
6 gae_duplicate tensor(-0.8247, dtype=torch.float64) tensor(0.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6913, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
5 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-3.6370, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3434, dtype=torch.float64) delta_t tensor(0.1963, dtype=torch.float64)
4 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-4.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6321, dtype=torch.float64) delta_t tensor(-0.2573, dtype=torch.float64)
3 gae_duplicate tensor(-0.4710, dtype=torch.float64) tensor(4.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.4879, dtype=torch.float64)
2 gae_duplicate tensor(0.1143, dtype=torch.float64) tensor(-9.3836, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-147.30194091796875
value loss:34.623592376708984
entropies:349.8918762207031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6809241771698 seconds
19 rew tensor(1.0822, dtype=torch.float64) delta_t tensor(-0.1207, dtype=torch.float64)
19 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(2.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
18 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(-0.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0699, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
17 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-0.3783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0308, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
16 gae_duplicate tensor(-0.1852, dtype=torch.float64) tensor(-0.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9178, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
15 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(-1.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8275, dtype=torch.float64) delta_t tensor(0.1740, dtype=torch.float64)
14 gae_duplicate tensor(0.0161, dtype=torch.float64) tensor(-3.3914, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
13 gae_duplicate tensor(-0.1692, dtype=torch.float64) tensor(-3.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1685, dtype=torch.float64) delta_t tensor(-0.1454, dtype=torch.float64)
12 gae_duplicate tensor(-0.5991, dtype=torch.float64) tensor(2.3617, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3711, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
11 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(0.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0390, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
10 gae_duplicate tensor(-0.2959, dtype=torch.float64) tensor(0.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2528, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
9 gae_duplicate tensor(-0.3046, dtype=torch.float64) tensor(-5.2637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4707, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
8 gae_duplicate tensor(-0.3894, dtype=torch.float64) tensor(1.8150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9919, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
7 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(-2.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5860, dtype=torch.float64) delta_t tensor(0.2018, dtype=torch.float64)
6 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(-4.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6421, dtype=torch.float64) delta_t tensor(-0.0142, dtype=torch.float64)
5 gae_duplicate tensor(-0.5875, dtype=torch.float64) tensor(-0.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
4 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(-1.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2615, dtype=torch.float64) delta_t tensor(-0.2380, dtype=torch.float64)
3 gae_duplicate tensor(-0.5837, dtype=torch.float64) tensor(4.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.2348, dtype=torch.float64)
2 gae_duplicate tensor(-0.1553, dtype=torch.float64) tensor(-4.1640, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:739.4373779296875
value loss:9.872106552124023
entropies:349.7187805175781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3904.6221)
ToM Target loss= tensor(3965.0132)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.934927940368652 seconds
19 rew tensor(1.1714, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
19 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(0.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1458, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
18 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-1.2464, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0817, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
17 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-1.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9928, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
16 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(0.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8148, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
15 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(-0.6151, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(0.1849, dtype=torch.float64)
14 gae_duplicate tensor(0.1322, dtype=torch.float64) tensor(-3.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1313, dtype=torch.float64) delta_t tensor(-0.2384, dtype=torch.float64)
13 gae_duplicate tensor(-1.3248, dtype=torch.float64) tensor(3.9762, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6120, dtype=torch.float64) delta_t tensor(0.1383, dtype=torch.float64)
12 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-2.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0131, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
11 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(0.7194, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4115, dtype=torch.float64) delta_t tensor(0.2331, dtype=torch.float64)
10 gae_duplicate tensor(0.0305, dtype=torch.float64) tensor(-4.2103, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1933, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
9 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-2.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2392, dtype=torch.float64) delta_t tensor(0.1742, dtype=torch.float64)
8 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(-4.0191, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4942, dtype=torch.float64) delta_t tensor(-0.3167, dtype=torch.float64)
7 gae_duplicate tensor(-0.8111, dtype=torch.float64) tensor(5.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3671, dtype=torch.float64) delta_t tensor(0.3504, dtype=torch.float64)
6 gae_duplicate tensor(0.1249, dtype=torch.float64) tensor(-5.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-2.0520, dtype=torch.float64) delta_t tensor(-0.4808, dtype=torch.float64)
5 gae_duplicate tensor(-0.6091, dtype=torch.float64) tensor(8.8926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2451, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
4 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(-2.5816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5204, dtype=torch.float64) delta_t tensor(-0.3633, dtype=torch.float64)
3 gae_duplicate tensor(-0.5983, dtype=torch.float64) tensor(7.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5759, dtype=torch.float64) delta_t tensor(0.2708, dtype=torch.float64)
2 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(-4.0736, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:172.3424072265625
value loss:14.697134017944336
entropies:349.6843566894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.619619131088257 seconds
19 rew tensor(1.1953, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
19 gae_duplicate tensor(-0.1394, dtype=torch.float64) tensor(0.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1334, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
18 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(-0.5011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0711, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
17 gae_duplicate tensor(-0.3019, dtype=torch.float64) tensor(0.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0176, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
16 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-0.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9182, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
15 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(-0.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7277, dtype=torch.float64) delta_t tensor(0.2761, dtype=torch.float64)
14 gae_duplicate tensor(0.2071, dtype=torch.float64) tensor(-5.3061, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1798, dtype=torch.float64) delta_t tensor(-0.3792, dtype=torch.float64)
13 gae_duplicate tensor(-2.8589, dtype=torch.float64) tensor(8.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3075, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
12 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(0.3549, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2233, dtype=torch.float64) delta_t tensor(-0.6436, dtype=torch.float64)
11 gae_duplicate tensor(-4.2944, dtype=torch.float64) tensor(11.4585, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5922, dtype=torch.float64) delta_t tensor(-0.4281, dtype=torch.float64)
10 gae_duplicate tensor(-2.5360, dtype=torch.float64) tensor(11.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.1768, dtype=torch.float64)
9 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(-2.1035, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5473, dtype=torch.float64) delta_t tensor(-0.1588, dtype=torch.float64)
8 gae_duplicate tensor(-0.4103, dtype=torch.float64) tensor(3.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7204, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
7 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-1.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6998, dtype=torch.float64) delta_t tensor(0.2983, dtype=torch.float64)
6 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-5.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5135, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
5 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(-1.7791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0094, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
4 gae_duplicate tensor(-0.2171, dtype=torch.float64) tensor(1.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1035, dtype=torch.float64) delta_t tensor(-0.1698, dtype=torch.float64)
3 gae_duplicate tensor(-0.2989, dtype=torch.float64) tensor(3.1878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3654, dtype=torch.float64) delta_t tensor(0.2268, dtype=torch.float64)
2 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(-4.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1036.627197265625
value loss:57.4189567565918
entropies:349.51544189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.229383945465088 seconds
19 rew tensor(1.1703, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
19 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(0.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0947, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
18 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-0.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0323, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
17 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(0.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9287, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
16 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-1.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
15 gae_duplicate tensor(-0.1147, dtype=torch.float64) tensor(-5.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4456, dtype=torch.float64) delta_t tensor(0.0872, dtype=torch.float64)
14 gae_duplicate tensor(-0.0378, dtype=torch.float64) tensor(-2.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(0.2467, dtype=torch.float64)
13 gae_duplicate tensor(0.1493, dtype=torch.float64) tensor(-5.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0258, dtype=torch.float64) delta_t tensor(-0.2207, dtype=torch.float64)
12 gae_duplicate tensor(-0.3182, dtype=torch.float64) tensor(3.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7018, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
11 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-2.5742, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2526, dtype=torch.float64) delta_t tensor(-0.2042, dtype=torch.float64)
10 gae_duplicate tensor(-0.3258, dtype=torch.float64) tensor(3.5361, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
9 gae_duplicate tensor(-0.2946, dtype=torch.float64) tensor(-2.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5730, dtype=torch.float64) delta_t tensor(-0.0381, dtype=torch.float64)
8 gae_duplicate tensor(-0.2979, dtype=torch.float64) tensor(0.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2506, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
7 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-2.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8008, dtype=torch.float64) delta_t tensor(0.1390, dtype=torch.float64)
6 gae_duplicate tensor(-0.0154, dtype=torch.float64) tensor(-2.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1073, dtype=torch.float64) delta_t tensor(9.0302e-05, dtype=torch.float64)
5 gae_duplicate tensor(-0.6701, dtype=torch.float64) tensor(-0.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3448, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
4 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(1.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4063, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
3 gae_duplicate tensor(-0.3458, dtype=torch.float64) tensor(-0.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0005, dtype=torch.float64) delta_t tensor(-0.0850, dtype=torch.float64)
2 gae_duplicate tensor(-0.4154, dtype=torch.float64) tensor(1.4526, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:683.7346801757812
value loss:8.348970413208008
entropies:349.231201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.201496124267578 seconds
19 rew tensor(1.1836, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
19 gae_duplicate tensor(-0.0875, dtype=torch.float64) tensor(0.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1322, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
18 gae_duplicate tensor(0.0385, dtype=torch.float64) tensor(-2.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7251, dtype=torch.float64) delta_t tensor(-0.2957, dtype=torch.float64)
17 gae_duplicate tensor(-1.5852, dtype=torch.float64) tensor(5.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
16 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(1.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.2339, dtype=torch.float64)
15 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-4.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7364, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
14 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-1.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
13 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-1.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(-0.0609, dtype=torch.float64)
12 gae_duplicate tensor(-0.2497, dtype=torch.float64) tensor(0.9911, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4490, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
11 gae_duplicate tensor(-0.2400, dtype=torch.float64) tensor(-0.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
10 gae_duplicate tensor(-0.2937, dtype=torch.float64) tensor(1.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2439, dtype=torch.float64) delta_t tensor(0.1989, dtype=torch.float64)
9 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-3.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4712, dtype=torch.float64) delta_t tensor(-0.0798, dtype=torch.float64)
8 gae_duplicate tensor(-0.3982, dtype=torch.float64) tensor(1.3273, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9209, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
7 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-3.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5856, dtype=torch.float64) delta_t tensor(0.2570, dtype=torch.float64)
6 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-5.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6405, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
5 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(-1.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1089, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
4 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-0.4858, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2032, dtype=torch.float64) delta_t tensor(-0.1644, dtype=torch.float64)
3 gae_duplicate tensor(-0.3053, dtype=torch.float64) tensor(2.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4525, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
2 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(-2.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:644.3262329101562
value loss:11.406158447265625
entropies:349.0916442871094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.511008977890015 seconds
19 rew tensor(1.1197, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
19 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(0.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0564, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
18 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(0.4526, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0836, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
17 gae_duplicate tensor(-0.1318, dtype=torch.float64) tensor(-0.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9549, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
16 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-0.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9311, dtype=torch.float64) delta_t tensor(0.2224, dtype=torch.float64)
15 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-3.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6630, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
14 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-3.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(0.1957, dtype=torch.float64)
13 gae_duplicate tensor(0.1043, dtype=torch.float64) tensor(-4.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2554, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
12 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(0.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
11 gae_duplicate tensor(-0.1113, dtype=torch.float64) tensor(-2.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1385, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
10 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(0.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4325, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
9 gae_duplicate tensor(-0.2733, dtype=torch.float64) tensor(-0.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6251, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
8 gae_duplicate tensor(-0.4601, dtype=torch.float64) tensor(0.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0896, dtype=torch.float64) delta_t tensor(-0.5193, dtype=torch.float64)
7 gae_duplicate tensor(-4.1482, dtype=torch.float64) tensor(13.2353, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8544, dtype=torch.float64) delta_t tensor(0.1851, dtype=torch.float64)
6 gae_duplicate tensor(-0.9537, dtype=torch.float64) tensor(-2.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1873, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
5 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-1.8495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2144, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
4 gae_duplicate tensor(-0.2086, dtype=torch.float64) tensor(-0.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6945, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
3 gae_duplicate tensor(-0.4586, dtype=torch.float64) tensor(1.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1170, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
2 gae_duplicate tensor(-0.4238, dtype=torch.float64) tensor(1.4929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-119.71459197998047
value loss:35.75197219848633
entropies:349.0864562988281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3909.7620)
ToM Target loss= tensor(3974.4832)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.940794944763184 seconds
19 rew tensor(1.1462, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
19 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(0.8026, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
18 gae_duplicate tensor(-0.1229, dtype=torch.float64) tensor(0.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9674, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
17 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(1.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
16 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-1.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
15 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(-2.7798, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6269, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
14 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(-4.1427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6222, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
13 gae_duplicate tensor(0.1277, dtype=torch.float64) tensor(-4.0698, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1795, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
12 gae_duplicate tensor(-0.3115, dtype=torch.float64) tensor(0.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(-0.1631, dtype=torch.float64)
11 gae_duplicate tensor(-0.6039, dtype=torch.float64) tensor(3.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1382, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
10 gae_duplicate tensor(-0.3395, dtype=torch.float64) tensor(0.6460, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
9 gae_duplicate tensor(0.0284, dtype=torch.float64) tensor(-4.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6790, dtype=torch.float64) delta_t tensor(-0.1693, dtype=torch.float64)
8 gae_duplicate tensor(-0.3018, dtype=torch.float64) tensor(2.7365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3261, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
7 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-4.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7545, dtype=torch.float64) delta_t tensor(0.1714, dtype=torch.float64)
6 gae_duplicate tensor(0.0456, dtype=torch.float64) tensor(-3.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3370, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
5 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(0.7066, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2452, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
4 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(0.2924, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7515, dtype=torch.float64) delta_t tensor(-0.2757, dtype=torch.float64)
3 gae_duplicate tensor(-0.5261, dtype=torch.float64) tensor(5.5968, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0857, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
2 gae_duplicate tensor(-0.6217, dtype=torch.float64) tensor(1.8503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:239.51583862304688
value loss:8.526589393615723
entropies:348.9189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.217634916305542 seconds
19 rew tensor(1.1204, dtype=torch.float64) delta_t tensor(-0.0781, dtype=torch.float64)
19 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(1.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1074, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
18 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-1.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9670, dtype=torch.float64) delta_t tensor(-0.0711, dtype=torch.float64)
17 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(1.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8672, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
16 gae_duplicate tensor(-0.1776, dtype=torch.float64) tensor(0.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8532, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
15 gae_duplicate tensor(-0.1329, dtype=torch.float64) tensor(-2.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7145, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
14 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-4.5331, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
13 gae_duplicate tensor(-0.0482, dtype=torch.float64) tensor(-1.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2188, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
12 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(-0.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
11 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-2.2799, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1264, dtype=torch.float64) delta_t tensor(-0.1692, dtype=torch.float64)
10 gae_duplicate tensor(-0.2691, dtype=torch.float64) tensor(3.3691, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4184, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
9 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(-1.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6233, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
8 gae_duplicate tensor(-0.5235, dtype=torch.float64) tensor(1.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4835, dtype=torch.float64) delta_t tensor(0.2144, dtype=torch.float64)
7 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(-3.7714, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6996, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
6 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-2.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3906, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
5 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-1.3709, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0917, dtype=torch.float64) delta_t tensor(-0.0293, dtype=torch.float64)
4 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(0.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8902, dtype=torch.float64) delta_t tensor(-0.1055, dtype=torch.float64)
3 gae_duplicate tensor(-0.4186, dtype=torch.float64) tensor(2.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2651, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
2 gae_duplicate tensor(-0.4293, dtype=torch.float64) tensor(1.2741, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:423.4712829589844
value loss:7.442335605621338
entropies:348.7016296386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.977102041244507 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
19 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-0.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1974, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
18 gae_duplicate tensor(0.0512, dtype=torch.float64) tensor(-3.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1077, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
17 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-1.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(-0.4910, dtype=torch.float64)
16 gae_duplicate tensor(-1.6342, dtype=torch.float64) tensor(8.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8930, dtype=torch.float64) delta_t tensor(0.2159, dtype=torch.float64)
15 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(-3.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3627, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
14 gae_duplicate tensor(-1.4081, dtype=torch.float64) tensor(-0.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
13 gae_duplicate tensor(-0.0313, dtype=torch.float64) tensor(-2.2955, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1504, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
12 gae_duplicate tensor(-0.2500, dtype=torch.float64) tensor(0.5852, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6759, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
11 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-2.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2030, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
10 gae_duplicate tensor(-0.2747, dtype=torch.float64) tensor(0.7753, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5736, dtype=torch.float64) delta_t tensor(0.2180, dtype=torch.float64)
9 gae_duplicate tensor(-0.2061, dtype=torch.float64) tensor(-4.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7791, dtype=torch.float64) delta_t tensor(-0.0673, dtype=torch.float64)
8 gae_duplicate tensor(-0.2183, dtype=torch.float64) tensor(0.7304, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-0.2612, dtype=torch.float64)
7 gae_duplicate tensor(-2.9116, dtype=torch.float64) tensor(4.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8810, dtype=torch.float64) delta_t tensor(-0.0951, dtype=torch.float64)
6 gae_duplicate tensor(-0.6797, dtype=torch.float64) tensor(2.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2617, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
5 gae_duplicate tensor(-0.4109, dtype=torch.float64) tensor(-0.2609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0942, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
4 gae_duplicate tensor(-0.2288, dtype=torch.float64) tensor(-0.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9012, dtype=torch.float64) delta_t tensor(-0.1241, dtype=torch.float64)
3 gae_duplicate tensor(-0.6341, dtype=torch.float64) tensor(2.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2633, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
2 gae_duplicate tensor(-0.4565, dtype=torch.float64) tensor(-1.5775, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-104.67390441894531
value loss:31.620264053344727
entropies:348.41217041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741437911987305 seconds
19 rew tensor(1.2230, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
19 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(-0.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2107, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
18 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-3.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0083, dtype=torch.float64) delta_t tensor(-0.0631, dtype=torch.float64)
17 gae_duplicate tensor(-0.1808, dtype=torch.float64) tensor(0.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0586, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
16 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-0.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
15 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-2.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4946, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
14 gae_duplicate tensor(-0.9705, dtype=torch.float64) tensor(-2.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6893, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
13 gae_duplicate tensor(-0.0372, dtype=torch.float64) tensor(-2.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2297, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
12 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-1.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
11 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-0.8997, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2816, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
10 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(2.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5499, dtype=torch.float64) delta_t tensor(0.2892, dtype=torch.float64)
9 gae_duplicate tensor(0.0869, dtype=torch.float64) tensor(-5.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6141, dtype=torch.float64) delta_t tensor(-0.1538, dtype=torch.float64)
8 gae_duplicate tensor(-0.4252, dtype=torch.float64) tensor(2.3496, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2291, dtype=torch.float64) delta_t tensor(-0.3760, dtype=torch.float64)
7 gae_duplicate tensor(-1.1383, dtype=torch.float64) tensor(8.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9441, dtype=torch.float64) delta_t tensor(-0.2263, dtype=torch.float64)
6 gae_duplicate tensor(-0.6398, dtype=torch.float64) tensor(4.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2689, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
5 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(-1.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0319, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
4 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-1.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0219, dtype=torch.float64) delta_t tensor(-0.1734, dtype=torch.float64)
3 gae_duplicate tensor(-0.4324, dtype=torch.float64) tensor(3.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
2 gae_duplicate tensor(-0.5893, dtype=torch.float64) tensor(-2.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:51.34447479248047
value loss:14.946244239807129
entropies:348.245361328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.668155908584595 seconds
19 rew tensor(1.1072, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
19 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(0.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0696, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
18 gae_duplicate tensor(-0.0112, dtype=torch.float64) tensor(-0.5575, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
17 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(0.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
16 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(0.9882, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
15 gae_duplicate tensor(-0.1521, dtype=torch.float64) tensor(-1.7738, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
14 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-4.2191, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5541, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
13 gae_duplicate tensor(-1.0824, dtype=torch.float64) tensor(-0.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3184, dtype=torch.float64) delta_t tensor(-0.1448, dtype=torch.float64)
12 gae_duplicate tensor(-0.3069, dtype=torch.float64) tensor(2.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0568, dtype=torch.float64) delta_t tensor(-0.2937, dtype=torch.float64)
11 gae_duplicate tensor(-1.3545, dtype=torch.float64) tensor(5.6423, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0227, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
10 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(0.6885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2295, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
9 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(-2.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4577, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
8 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(0.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6802, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
7 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-1.3541, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5473, dtype=torch.float64) delta_t tensor(0.2443, dtype=torch.float64)
6 gae_duplicate tensor(0.1053, dtype=torch.float64) tensor(-4.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5971, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
5 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0888, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
4 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(0.7990, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9469, dtype=torch.float64) delta_t tensor(-0.2308, dtype=torch.float64)
3 gae_duplicate tensor(-0.3748, dtype=torch.float64) tensor(4.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
2 gae_duplicate tensor(-0.4186, dtype=torch.float64) tensor(1.6179, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-321.9889221191406
value loss:10.557696342468262
entropies:348.19244384765625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3901.8191)
ToM Target loss= tensor(3979.0090)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.853420972824097 seconds
19 rew tensor(1.1463, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
19 gae_duplicate tensor(-0.1638, dtype=torch.float64) tensor(0.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1208, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
18 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-1.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0833, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
17 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(-1.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9683, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
16 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(-1.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
15 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(-2.2473, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7247, dtype=torch.float64) delta_t tensor(0.2503, dtype=torch.float64)
14 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-4.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6133, dtype=torch.float64) delta_t tensor(0.1262, dtype=torch.float64)
13 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(-2.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4719, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
12 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(-1.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3840, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
11 gae_duplicate tensor(-0.2718, dtype=torch.float64) tensor(0.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1922, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
10 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(-0.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1419, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
9 gae_duplicate tensor(-0.2945, dtype=torch.float64) tensor(-0.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3060, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
8 gae_duplicate tensor(-0.2926, dtype=torch.float64) tensor(-0.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1292, dtype=torch.float64) delta_t tensor(-0.8685, dtype=torch.float64)
7 gae_duplicate tensor(-5.3474, dtype=torch.float64) tensor(20.9699, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6306, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
6 gae_duplicate tensor(-1.6649, dtype=torch.float64) tensor(1.3457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5636, dtype=torch.float64) delta_t tensor(0.1828, dtype=torch.float64)
5 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-3.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2660, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
4 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(-2.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4443, dtype=torch.float64) delta_t tensor(-0.2513, dtype=torch.float64)
3 gae_duplicate tensor(-0.5958, dtype=torch.float64) tensor(4.5900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(0.3971, dtype=torch.float64)
2 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-7.1627, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:77.28271484375
value loss:61.35597229003906
entropies:348.0586853027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8305253982543945 seconds
19 rew tensor(1.1315, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
19 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(1.1577, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1579, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
18 gae_duplicate tensor(0.0140, dtype=torch.float64) tensor(-1.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1062, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
17 gae_duplicate tensor(-0.0867, dtype=torch.float64) tensor(-0.6902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0304, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
16 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(0.3139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9665, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
15 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-1.8290, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8395, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
14 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-3.8761, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0437, dtype=torch.float64) delta_t tensor(-0.4134, dtype=torch.float64)
13 gae_duplicate tensor(-2.6356, dtype=torch.float64) tensor(7.2167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0440, dtype=torch.float64) delta_t tensor(-0.4661, dtype=torch.float64)
12 gae_duplicate tensor(-1.6181, dtype=torch.float64) tensor(9.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2811, dtype=torch.float64) delta_t tensor(-0.4451, dtype=torch.float64)
11 gae_duplicate tensor(-2.9045, dtype=torch.float64) tensor(11.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2917, dtype=torch.float64) delta_t tensor(0.1785, dtype=torch.float64)
10 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-2.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2032, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
9 gae_duplicate tensor(0.0804, dtype=torch.float64) tensor(-4.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5478, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
8 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(1.3814, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9809, dtype=torch.float64) delta_t tensor(0.2165, dtype=torch.float64)
7 gae_duplicate tensor(0.0620, dtype=torch.float64) tensor(-3.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6371, dtype=torch.float64) delta_t tensor(0.2526, dtype=torch.float64)
6 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-5.0547, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6688, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
5 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(-0.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1141, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
4 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(-1.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2868, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
3 gae_duplicate tensor(-0.2647, dtype=torch.float64) tensor(2.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
2 gae_duplicate tensor(-0.4319, dtype=torch.float64) tensor(-2.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-411.6593933105469
value loss:35.68384552001953
entropies:347.8438415527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.618086814880371 seconds
19 rew tensor(1.0954, dtype=torch.float64) delta_t tensor(-0.0871, dtype=torch.float64)
19 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(1.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
18 gae_duplicate tensor(-0.0368, dtype=torch.float64) tensor(-1.6882, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0585, dtype=torch.float64) delta_t tensor(-0.0085, dtype=torch.float64)
17 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-0.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
16 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(1.4092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9308, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
15 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-1.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7376, dtype=torch.float64) delta_t tensor(0.1479, dtype=torch.float64)
14 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-2.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2411, dtype=torch.float64) delta_t tensor(-0.3013, dtype=torch.float64)
13 gae_duplicate tensor(-2.7959, dtype=torch.float64) tensor(4.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0497, dtype=torch.float64) delta_t tensor(-0.2657, dtype=torch.float64)
12 gae_duplicate tensor(-1.4004, dtype=torch.float64) tensor(5.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4073, dtype=torch.float64) delta_t tensor(-0.0607, dtype=torch.float64)
11 gae_duplicate tensor(-0.4590, dtype=torch.float64) tensor(1.7094, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
10 gae_duplicate tensor(-0.1799, dtype=torch.float64) tensor(0.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
9 gae_duplicate tensor(-0.2979, dtype=torch.float64) tensor(-0.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5491, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
8 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(1.0233, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5445, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
7 gae_duplicate tensor(-0.0246, dtype=torch.float64) tensor(-1.9015, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6383, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
6 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-2.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4901, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
5 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-0.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
4 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(1.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9042, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
3 gae_duplicate tensor(-0.3751, dtype=torch.float64) tensor(1.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2387, dtype=torch.float64) delta_t tensor(-0.0817, dtype=torch.float64)
2 gae_duplicate tensor(-0.4534, dtype=torch.float64) tensor(1.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-661.3255615234375
value loss:19.66204261779785
entropies:347.5443115234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.823684930801392 seconds
19 rew tensor(1.0690, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
19 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(2.0534, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0310, dtype=torch.float64) delta_t tensor(0.0015, dtype=torch.float64)
18 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(0.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0448, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
17 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(0.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
16 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(2.5889, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8548, dtype=torch.float64) delta_t tensor(0.1609, dtype=torch.float64)
15 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-3.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6756, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
14 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-1.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4914, dtype=torch.float64) delta_t tensor(-0.1241, dtype=torch.float64)
13 gae_duplicate tensor(-1.3153, dtype=torch.float64) tensor(2.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3171, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
12 gae_duplicate tensor(-0.3330, dtype=torch.float64) tensor(1.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5385, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
11 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(-0.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
10 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(0.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2421, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
9 gae_duplicate tensor(-0.3076, dtype=torch.float64) tensor(2.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5484, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
8 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(-0.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3680, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
7 gae_duplicate tensor(-0.0842, dtype=torch.float64) tensor(-1.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6251, dtype=torch.float64) delta_t tensor(0.2879, dtype=torch.float64)
6 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-5.4068, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4395, dtype=torch.float64) delta_t tensor(-0.1225, dtype=torch.float64)
5 gae_duplicate tensor(-0.3902, dtype=torch.float64) tensor(1.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2431, dtype=torch.float64) delta_t tensor(-0.1588, dtype=torch.float64)
4 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(3.4731, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7132, dtype=torch.float64) delta_t tensor(-0.0946, dtype=torch.float64)
3 gae_duplicate tensor(-0.2550, dtype=torch.float64) tensor(2.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1139, dtype=torch.float64) delta_t tensor(-0.1427, dtype=torch.float64)
2 gae_duplicate tensor(-0.4372, dtype=torch.float64) tensor(2.8214, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-500.6546325683594
value loss:7.994021892547607
entropies:347.283447265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.764652967453003 seconds
19 rew tensor(1.1840, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
19 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(0.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1718, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
18 gae_duplicate tensor(0.0302, dtype=torch.float64) tensor(-2.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0179, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
17 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9548, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
16 gae_duplicate tensor(-0.1821, dtype=torch.float64) tensor(-1.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(0.1472, dtype=torch.float64)
15 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-2.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7148, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
14 gae_duplicate tensor(-0.1947, dtype=torch.float64) tensor(-1.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7252, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
13 gae_duplicate tensor(-0.2474, dtype=torch.float64) tensor(-2.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2569, dtype=torch.float64) delta_t tensor(-0.0910, dtype=torch.float64)
12 gae_duplicate tensor(-0.3011, dtype=torch.float64) tensor(1.7009, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4822, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
11 gae_duplicate tensor(-0.3314, dtype=torch.float64) tensor(0.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0873, dtype=torch.float64) delta_t tensor(-0.0539, dtype=torch.float64)
10 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(0.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
9 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-5.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5719, dtype=torch.float64) delta_t tensor(-0.2715, dtype=torch.float64)
8 gae_duplicate tensor(-0.5464, dtype=torch.float64) tensor(4.4709, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4925, dtype=torch.float64) delta_t tensor(-0.3543, dtype=torch.float64)
7 gae_duplicate tensor(-1.5557, dtype=torch.float64) tensor(6.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7260, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
6 gae_duplicate tensor(-0.4952, dtype=torch.float64) tensor(1.5838, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5461, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
5 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(-0.8393, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1910, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
4 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-2.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3163, dtype=torch.float64) delta_t tensor(-0.3282, dtype=torch.float64)
3 gae_duplicate tensor(-0.6176, dtype=torch.float64) tensor(6.3591, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(0.2933, dtype=torch.float64)
2 gae_duplicate tensor(-0.1808, dtype=torch.float64) tensor(-4.7983, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.609376907348633
value loss:16.695215225219727
entropies:347.0830993652344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3895.8464)
ToM Target loss= tensor(3977.5208)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.651372909545898 seconds
19 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
19 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(1.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1351, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
18 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-1.6621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0823, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
17 gae_duplicate tensor(-0.1340, dtype=torch.float64) tensor(-0.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9431, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
16 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(0.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
15 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-3.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
14 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-3.2041, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
13 gae_duplicate tensor(-1.1728, dtype=torch.float64) tensor(2.8205, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0777, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
12 gae_duplicate tensor(-1.4426, dtype=torch.float64) tensor(4.1537, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0100, dtype=torch.float64) delta_t tensor(-0.4762, dtype=torch.float64)
11 gae_duplicate tensor(-2.7534, dtype=torch.float64) tensor(9.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0887, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
10 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(-0.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
9 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(-1.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5741, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
8 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(-0.7932, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3863, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
7 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-4.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6760, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
6 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-1.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3670, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
5 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-0.9019, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(-0.0841, dtype=torch.float64)
4 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(1.5503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7303, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
3 gae_duplicate tensor(-0.2532, dtype=torch.float64) tensor(0.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1912, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
2 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(0.1193, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-193.5358123779297
value loss:21.980609893798828
entropies:346.7359924316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.947489976882935 seconds
19 rew tensor(1.1596, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
19 gae_duplicate tensor(-0.0865, dtype=torch.float64) tensor(0.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1853, dtype=torch.float64) delta_t tensor(0.1218, dtype=torch.float64)
18 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-2.2214, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0974, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
17 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(-0.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0085, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
16 gae_duplicate tensor(-0.2019, dtype=torch.float64) tensor(-0.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(0.2185, dtype=torch.float64)
15 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(-4.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.1747, dtype=torch.float64)
14 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-4.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5984, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
13 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-0.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
12 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(0.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
11 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-1.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1412, dtype=torch.float64) delta_t tensor(-0.1685, dtype=torch.float64)
10 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(2.9085, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4730, dtype=torch.float64) delta_t tensor(0.2202, dtype=torch.float64)
9 gae_duplicate tensor(-0.3047, dtype=torch.float64) tensor(-3.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7012, dtype=torch.float64) delta_t tensor(-0.1005, dtype=torch.float64)
8 gae_duplicate tensor(-0.5086, dtype=torch.float64) tensor(1.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8645, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
7 gae_duplicate tensor(-1.3746, dtype=torch.float64) tensor(2.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9078, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
6 gae_duplicate tensor(-0.4268, dtype=torch.float64) tensor(-0.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2643, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
5 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-1.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0876, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
4 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(-1.8598, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9112, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
3 gae_duplicate tensor(-0.5046, dtype=torch.float64) tensor(0.8068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2307, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
2 gae_duplicate tensor(-0.4053, dtype=torch.float64) tensor(-0.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:682.2764282226562
value loss:11.649553298950195
entropies:346.6098937988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7265119552612305 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
19 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(0.4627, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1724, dtype=torch.float64) delta_t tensor(0.0648, dtype=torch.float64)
18 gae_duplicate tensor(-0.0048, dtype=torch.float64) tensor(-1.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0958, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
17 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(0.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0330, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
16 gae_duplicate tensor(-0.1065, dtype=torch.float64) tensor(-0.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9694, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
15 gae_duplicate tensor(0.1412, dtype=torch.float64) tensor(-4.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
14 gae_duplicate tensor(-1.4830, dtype=torch.float64) tensor(0.4599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3059, dtype=torch.float64) delta_t tensor(-0.8076, dtype=torch.float64)
13 gae_duplicate tensor(-2.7169, dtype=torch.float64) tensor(14.8224, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0082, dtype=torch.float64) delta_t tensor(-0.2010, dtype=torch.float64)
12 gae_duplicate tensor(-1.6845, dtype=torch.float64) tensor(4.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
11 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(-0.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0124, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
10 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(0.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5331, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
9 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-1.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6759, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
8 gae_duplicate tensor(-0.4937, dtype=torch.float64) tensor(1.8834, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3937, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
7 gae_duplicate tensor(-0.0873, dtype=torch.float64) tensor(-0.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7783, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
6 gae_duplicate tensor(-0.2637, dtype=torch.float64) tensor(-3.0757, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3655, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
5 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-1.1402, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2199, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
4 gae_duplicate tensor(-0.2175, dtype=torch.float64) tensor(2.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8273, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
3 gae_duplicate tensor(-0.4190, dtype=torch.float64) tensor(-0.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1118, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
2 gae_duplicate tensor(-0.2950, dtype=torch.float64) tensor(-0.4662, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-718.3943481445312
value loss:30.148744583129883
entropies:346.45404052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.838631868362427 seconds
19 rew tensor(1.1202, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
19 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(0.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0581, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
18 gae_duplicate tensor(-0.0778, dtype=torch.float64) tensor(-0.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9956, dtype=torch.float64) delta_t tensor(-0.0386, dtype=torch.float64)
17 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(0.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0194, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
16 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-1.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(-0.0858, dtype=torch.float64)
15 gae_duplicate tensor(-0.3388, dtype=torch.float64) tensor(1.4115, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
14 gae_duplicate tensor(0.0579, dtype=torch.float64) tensor(-3.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6762, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
13 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(-3.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
12 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(0.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3030, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
11 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(1.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0603, dtype=torch.float64) delta_t tensor(-0.0709, dtype=torch.float64)
10 gae_duplicate tensor(-0.3178, dtype=torch.float64) tensor(1.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2641, dtype=torch.float64) delta_t tensor(0.2561, dtype=torch.float64)
9 gae_duplicate tensor(0.1124, dtype=torch.float64) tensor(-4.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3688, dtype=torch.float64) delta_t tensor(-0.1244, dtype=torch.float64)
8 gae_duplicate tensor(-0.2469, dtype=torch.float64) tensor(1.9328, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3167, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
7 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(0.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4842, dtype=torch.float64) delta_t tensor(0.2289, dtype=torch.float64)
6 gae_duplicate tensor(0.0637, dtype=torch.float64) tensor(-4.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8524, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
5 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-0.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2675, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
4 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-2.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4824, dtype=torch.float64) delta_t tensor(-0.2417, dtype=torch.float64)
3 gae_duplicate tensor(-0.4933, dtype=torch.float64) tensor(4.5613, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6247, dtype=torch.float64) delta_t tensor(0.2550, dtype=torch.float64)
2 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-4.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:534.9452514648438
value loss:6.5225443840026855
entropies:346.42974853515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.657092094421387 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
19 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(0.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1593, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
18 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-2.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0322, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
17 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(-0.2947, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9684, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
16 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(0.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5901, dtype=torch.float64) delta_t tensor(-0.2149, dtype=torch.float64)
15 gae_duplicate tensor(-1.3167, dtype=torch.float64) tensor(4.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7521, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
14 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(-1.8853, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5886, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
13 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-1.9655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3297, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
12 gae_duplicate tensor(-0.2492, dtype=torch.float64) tensor(-0.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2334, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
11 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(0.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0608, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
10 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-1.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0924, dtype=torch.float64) delta_t tensor(0.2564, dtype=torch.float64)
9 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-5.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4218, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
8 gae_duplicate tensor(-0.5050, dtype=torch.float64) tensor(-0.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2952, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
7 gae_duplicate tensor(-0.3706, dtype=torch.float64) tensor(0.9884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5625, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
6 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(-1.1231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8475, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
5 gae_duplicate tensor(-0.1898, dtype=torch.float64) tensor(1.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2642, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
4 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-2.1364, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5146, dtype=torch.float64) delta_t tensor(-0.2851, dtype=torch.float64)
3 gae_duplicate tensor(-0.5717, dtype=torch.float64) tensor(5.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6089, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
2 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(-4.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:373.04876708984375
value loss:9.63259220123291
entropies:346.51239013671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3896.2646)
ToM Target loss= tensor(3976.3142)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.599874019622803 seconds
19 rew tensor(1.1728, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
19 gae_duplicate tensor(-0.1206, dtype=torch.float64) tensor(-0.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1347, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
18 gae_duplicate tensor(0.0299, dtype=torch.float64) tensor(-1.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0718, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
17 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-2.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0327, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
16 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-0.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9442, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
15 gae_duplicate tensor(-0.0875, dtype=torch.float64) tensor(-1.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8151, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
14 gae_duplicate tensor(-0.1196, dtype=torch.float64) tensor(-3.0394, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0633, dtype=torch.float64) delta_t tensor(-0.4454, dtype=torch.float64)
13 gae_duplicate tensor(-2.7756, dtype=torch.float64) tensor(7.9553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2901, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
12 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(0.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3841, dtype=torch.float64) delta_t tensor(-0.0996, dtype=torch.float64)
11 gae_duplicate tensor(-0.2542, dtype=torch.float64) tensor(2.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0040, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
10 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(-1.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
9 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-3.7426, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5380, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
8 gae_duplicate tensor(-0.3649, dtype=torch.float64) tensor(3.6610, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4175, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
7 gae_duplicate tensor(-0.0682, dtype=torch.float64) tensor(-0.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9569, dtype=torch.float64) delta_t tensor(-0.2014, dtype=torch.float64)
6 gae_duplicate tensor(-0.4514, dtype=torch.float64) tensor(3.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9861, dtype=torch.float64) delta_t tensor(-0.0857, dtype=torch.float64)
5 gae_duplicate tensor(-0.6738, dtype=torch.float64) tensor(2.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3582, dtype=torch.float64) delta_t tensor(-0.1074, dtype=torch.float64)
4 gae_duplicate tensor(-0.6482, dtype=torch.float64) tensor(2.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4489, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
3 gae_duplicate tensor(-0.3515, dtype=torch.float64) tensor(-0.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0258, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
2 gae_duplicate tensor(-0.6579, dtype=torch.float64) tensor(5.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-717.0532836914062
value loss:21.41403579711914
entropies:346.6048278808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8223559856414795 seconds
19 rew tensor(1.2361, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
19 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(0.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2116, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
18 gae_duplicate tensor(0.0466, dtype=torch.float64) tensor(-2.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1222, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
17 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-1.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0336, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
16 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-0.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9950, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
15 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-1.7551, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2864, dtype=torch.float64) delta_t tensor(-0.3009, dtype=torch.float64)
14 gae_duplicate tensor(-2.5459, dtype=torch.float64) tensor(5.3352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2076, dtype=torch.float64) delta_t tensor(-0.6381, dtype=torch.float64)
13 gae_duplicate tensor(-1.4887, dtype=torch.float64) tensor(13.4912, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
12 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(-1.0052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
11 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(0.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0521, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
10 gae_duplicate tensor(-0.2237, dtype=torch.float64) tensor(-0.2076, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2541, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
9 gae_duplicate tensor(-0.2652, dtype=torch.float64) tensor(-1.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4854, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
8 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(0.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5013, dtype=torch.float64) delta_t tensor(-0.3994, dtype=torch.float64)
7 gae_duplicate tensor(-2.0017, dtype=torch.float64) tensor(7.4783, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7143, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
6 gae_duplicate tensor(-0.8949, dtype=torch.float64) tensor(-0.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6229, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
5 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-2.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
4 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-1.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4067, dtype=torch.float64) delta_t tensor(-0.1665, dtype=torch.float64)
3 gae_duplicate tensor(-0.5258, dtype=torch.float64) tensor(2.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
2 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-2.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-937.9181518554688
value loss:31.435997009277344
entropies:346.5465393066406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.588113069534302 seconds
19 rew tensor(1.1973, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
19 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-0.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
18 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-1.5124, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8201, dtype=torch.float64) delta_t tensor(-0.2434, dtype=torch.float64)
17 gae_duplicate tensor(-1.3402, dtype=torch.float64) tensor(4.3190, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0064, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
16 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(-0.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
15 gae_duplicate tensor(-0.2105, dtype=torch.float64) tensor(-1.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
14 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(-3.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7393, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
13 gae_duplicate tensor(-0.0064, dtype=torch.float64) tensor(-1.7608, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1399, dtype=torch.float64) delta_t tensor(-0.1183, dtype=torch.float64)
12 gae_duplicate tensor(-0.2343, dtype=torch.float64) tensor(2.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6380, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
11 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-2.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1401, dtype=torch.float64) delta_t tensor(-0.1333, dtype=torch.float64)
10 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(2.4096, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
9 gae_duplicate tensor(-0.2652, dtype=torch.float64) tensor(-2.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6748, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
8 gae_duplicate tensor(-0.5103, dtype=torch.float64) tensor(3.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2049, dtype=torch.float64) delta_t tensor(-0.2716, dtype=torch.float64)
7 gae_duplicate tensor(-1.4992, dtype=torch.float64) tensor(5.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9304, dtype=torch.float64) delta_t tensor(-0.1115, dtype=torch.float64)
6 gae_duplicate tensor(-0.4416, dtype=torch.float64) tensor(2.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2643, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
5 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-3.4642, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0609, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
4 gae_duplicate tensor(-0.2855, dtype=torch.float64) tensor(-1.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1086, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
3 gae_duplicate tensor(-0.6029, dtype=torch.float64) tensor(1.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4179, dtype=torch.float64) delta_t tensor(0.2534, dtype=torch.float64)
2 gae_duplicate tensor(-0.2281, dtype=torch.float64) tensor(-4.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-28.141693115234375
value loss:17.26559066772461
entropies:346.5474853515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.942015886306763 seconds
19 rew tensor(1.1593, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
19 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(0.5456, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1219, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
18 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-1.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9927, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
17 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(0.9783, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0698, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
16 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-1.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8783, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
15 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-0.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7242, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
14 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-2.9632, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
13 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-1.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0900, dtype=torch.float64) delta_t tensor(-0.2037, dtype=torch.float64)
12 gae_duplicate tensor(-1.1208, dtype=torch.float64) tensor(3.6605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4422, dtype=torch.float64) delta_t tensor(-0.9426, dtype=torch.float64)
11 gae_duplicate tensor(-5.9017, dtype=torch.float64) tensor(17.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4328, dtype=torch.float64) delta_t tensor(-0.2896, dtype=torch.float64)
10 gae_duplicate tensor(-1.3475, dtype=torch.float64) tensor(7.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5505, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
9 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-2.9675, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5639, dtype=torch.float64) delta_t tensor(-0.1152, dtype=torch.float64)
8 gae_duplicate tensor(-0.3105, dtype=torch.float64) tensor(1.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6549, dtype=torch.float64) delta_t tensor(-0.1517, dtype=torch.float64)
7 gae_duplicate tensor(-0.9120, dtype=torch.float64) tensor(3.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8701, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
6 gae_duplicate tensor(-0.4089, dtype=torch.float64) tensor(1.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2338, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
5 gae_duplicate tensor(-0.5152, dtype=torch.float64) tensor(-0.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1958, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
4 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(1.0066, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7476, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
3 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(0.0371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1742, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
2 gae_duplicate tensor(-0.3828, dtype=torch.float64) tensor(-2.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1391.0008544921875
value loss:63.674232482910156
entropies:346.56134033203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.736429691314697 seconds
19 rew tensor(1.2087, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
19 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(0.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
18 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-1.9696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8844, dtype=torch.float64) delta_t tensor(-0.1901, dtype=torch.float64)
17 gae_duplicate tensor(-1.5423, dtype=torch.float64) tensor(3.2202, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0579, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
16 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-0.5447, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9563, dtype=torch.float64) delta_t tensor(0.2140, dtype=torch.float64)
15 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(-4.1046, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1744, dtype=torch.float64) delta_t tensor(-0.3192, dtype=torch.float64)
14 gae_duplicate tensor(-2.6144, dtype=torch.float64) tensor(8.1514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6400, dtype=torch.float64) delta_t tensor(0.1393, dtype=torch.float64)
13 gae_duplicate tensor(-0.4127, dtype=torch.float64) tensor(-2.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3787, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
12 gae_duplicate tensor(-0.4618, dtype=torch.float64) tensor(0.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3990, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
11 gae_duplicate tensor(-0.3396, dtype=torch.float64) tensor(0.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
10 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(-2.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2329, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
9 gae_duplicate tensor(-0.2339, dtype=torch.float64) tensor(-0.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5246, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
8 gae_duplicate tensor(-0.2998, dtype=torch.float64) tensor(-1.0544, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2786, dtype=torch.float64) delta_t tensor(-0.5906, dtype=torch.float64)
7 gae_duplicate tensor(-3.7684, dtype=torch.float64) tensor(10.7055, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9237, dtype=torch.float64) delta_t tensor(-0.0842, dtype=torch.float64)
6 gae_duplicate tensor(-1.2188, dtype=torch.float64) tensor(2.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2046, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
5 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-2.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
4 gae_duplicate tensor(-0.4395, dtype=torch.float64) tensor(0.3465, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8607, dtype=torch.float64) delta_t tensor(-0.1004, dtype=torch.float64)
3 gae_duplicate tensor(-0.5136, dtype=torch.float64) tensor(2.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1860, dtype=torch.float64) delta_t tensor(-0.0333, dtype=torch.float64)
2 gae_duplicate tensor(-0.4266, dtype=torch.float64) tensor(1.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-771.9796752929688
value loss:48.052589416503906
entropies:346.66522216796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3887.3413)
ToM Target loss= tensor(3974.3115)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.883945941925049 seconds
19 rew tensor(1.1831, dtype=torch.float64) delta_t tensor(-0.0529, dtype=torch.float64)
19 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(0.9693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1965, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
18 gae_duplicate tensor(0.0510, dtype=torch.float64) tensor(-2.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8565, dtype=torch.float64) delta_t tensor(-0.2141, dtype=torch.float64)
17 gae_duplicate tensor(-1.5260, dtype=torch.float64) tensor(3.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0200, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
16 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(0.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9418, dtype=torch.float64) delta_t tensor(0.1385, dtype=torch.float64)
15 gae_duplicate tensor(-0.2078, dtype=torch.float64) tensor(-2.2612, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7665, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
14 gae_duplicate tensor(0.0432, dtype=torch.float64) tensor(-2.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7370, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
13 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(-2.4446, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
12 gae_duplicate tensor(-0.2446, dtype=torch.float64) tensor(-3.1634, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0299, dtype=torch.float64) delta_t tensor(-0.3535, dtype=torch.float64)
11 gae_duplicate tensor(-2.2401, dtype=torch.float64) tensor(6.0484, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6859, dtype=torch.float64) delta_t tensor(-0.6760, dtype=torch.float64)
10 gae_duplicate tensor(-3.8122, dtype=torch.float64) tensor(12.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3242, dtype=torch.float64) delta_t tensor(-0.4243, dtype=torch.float64)
9 gae_duplicate tensor(-3.6451, dtype=torch.float64) tensor(8.4733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4060, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
8 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(0.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8721, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
7 gae_duplicate tensor(-0.3205, dtype=torch.float64) tensor(-2.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6624, dtype=torch.float64) delta_t tensor(0.1273, dtype=torch.float64)
6 gae_duplicate tensor(-0.0129, dtype=torch.float64) tensor(-2.8396, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6221, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
5 gae_duplicate tensor(-0.5654, dtype=torch.float64) tensor(1.3837, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0654, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
4 gae_duplicate tensor(-0.1875, dtype=torch.float64) tensor(-0.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2293, dtype=torch.float64) delta_t tensor(-0.2126, dtype=torch.float64)
3 gae_duplicate tensor(-0.3305, dtype=torch.float64) tensor(3.8367, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
2 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(-2.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1073.1253662109375
value loss:59.92829132080078
entropies:346.6073913574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.87935209274292 seconds
19 rew tensor(1.1331, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
19 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(0.7192, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(0.0899, dtype=torch.float64)
18 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-1.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0309, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
17 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(-0.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
16 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(-0.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9040, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
15 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-0.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7134, dtype=torch.float64) delta_t tensor(0.1397, dtype=torch.float64)
14 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(-2.6583, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6867, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
13 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(-2.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2670, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
12 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(-1.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
11 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-0.8327, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1006, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.2252, dtype=torch.float64) tensor(-0.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4339, dtype=torch.float64) delta_t tensor(0.2507, dtype=torch.float64)
9 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(-5.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6882, dtype=torch.float64) delta_t tensor(-0.2624, dtype=torch.float64)
8 gae_duplicate tensor(-0.5713, dtype=torch.float64) tensor(4.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0313, dtype=torch.float64) delta_t tensor(-0.1728, dtype=torch.float64)
7 gae_duplicate tensor(-1.3235, dtype=torch.float64) tensor(4.9762, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7524, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
6 gae_duplicate tensor(-0.5506, dtype=torch.float64) tensor(0.5412, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4647, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
5 gae_duplicate tensor(-0.4721, dtype=torch.float64) tensor(0.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0889, dtype=torch.float64) delta_t tensor(0.1556, dtype=torch.float64)
4 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-3.1353, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1859, dtype=torch.float64) delta_t tensor(-0.1358, dtype=torch.float64)
3 gae_duplicate tensor(-0.6001, dtype=torch.float64) tensor(2.5628, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4582, dtype=torch.float64) delta_t tensor(0.2243, dtype=torch.float64)
2 gae_duplicate tensor(-0.4161, dtype=torch.float64) tensor(-4.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:404.9541015625
value loss:11.919336318969727
entropies:346.7022705078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.597016096115112 seconds
19 rew tensor(1.2598, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
19 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-0.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1837, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
18 gae_duplicate tensor(0.0195, dtype=torch.float64) tensor(-1.9439, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
17 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(-1.8796, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9808, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
16 gae_duplicate tensor(-0.2429, dtype=torch.float64) tensor(1.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
15 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(-1.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1958, dtype=torch.float64) delta_t tensor(-0.4268, dtype=torch.float64)
14 gae_duplicate tensor(-2.3720, dtype=torch.float64) tensor(10.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
13 gae_duplicate tensor(-0.4480, dtype=torch.float64) tensor(0.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1967, dtype=torch.float64) delta_t tensor(-0.1821, dtype=torch.float64)
12 gae_duplicate tensor(-1.2427, dtype=torch.float64) tensor(4.6064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(-0.1654, dtype=torch.float64)
11 gae_duplicate tensor(-0.6555, dtype=torch.float64) tensor(3.3616, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(0.1389, dtype=torch.float64)
10 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-2.2037, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2332, dtype=torch.float64) delta_t tensor(0.2270, dtype=torch.float64)
9 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-4.4164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4876, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
8 gae_duplicate tensor(-0.3554, dtype=torch.float64) tensor(2.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0603, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
7 gae_duplicate tensor(-0.2276, dtype=torch.float64) tensor(-2.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6668, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
6 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-1.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7150, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
5 gae_duplicate tensor(-0.7066, dtype=torch.float64) tensor(1.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1346, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
4 gae_duplicate tensor(-0.5874, dtype=torch.float64) tensor(-1.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3718, dtype=torch.float64) delta_t tensor(-0.1415, dtype=torch.float64)
3 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(2.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
2 gae_duplicate tensor(-0.2286, dtype=torch.float64) tensor(-3.4050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-361.9516906738281
value loss:19.63939666748047
entropies:346.8724365234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8558290004730225 seconds
19 rew tensor(1.1705, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
19 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0564, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
18 gae_duplicate tensor(-0.0537, dtype=torch.float64) tensor(-0.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9291, dtype=torch.float64) delta_t tensor(-0.1005, dtype=torch.float64)
17 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(2.1683, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0071, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
16 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-0.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8138, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
15 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.2279, dtype=torch.float64)
14 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-4.4385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5471, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
13 gae_duplicate tensor(0.0073, dtype=torch.float64) tensor(-1.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4091, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
12 gae_duplicate tensor(-0.1385, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2442, dtype=torch.float64) delta_t tensor(-0.0571, dtype=torch.float64)
11 gae_duplicate tensor(-0.3714, dtype=torch.float64) tensor(1.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0117, dtype=torch.float64) delta_t tensor(-0.1174, dtype=torch.float64)
10 gae_duplicate tensor(-0.3232, dtype=torch.float64) tensor(2.2574, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1932, dtype=torch.float64) delta_t tensor(0.2784, dtype=torch.float64)
9 gae_duplicate tensor(0.1654, dtype=torch.float64) tensor(-4.8869, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3183, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
8 gae_duplicate tensor(-0.2825, dtype=torch.float64) tensor(1.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3860, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
7 gae_duplicate tensor(-0.2164, dtype=torch.float64) tensor(-0.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4590, dtype=torch.float64) delta_t tensor(0.1983, dtype=torch.float64)
6 gae_duplicate tensor(0.0936, dtype=torch.float64) tensor(-3.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8703, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
5 gae_duplicate tensor(-0.1689, dtype=torch.float64) tensor(-0.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3180, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
4 gae_duplicate tensor(0.0579, dtype=torch.float64) tensor(-2.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5152, dtype=torch.float64) delta_t tensor(-0.2195, dtype=torch.float64)
3 gae_duplicate tensor(-0.4514, dtype=torch.float64) tensor(4.6831, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6620, dtype=torch.float64) delta_t tensor(0.2636, dtype=torch.float64)
2 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-4.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:496.7303771972656
value loss:6.211456775665283
entropies:346.7845458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.69856071472168 seconds
19 rew tensor(1.1582, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
19 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(0.7445, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0954, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
18 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(-0.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0581, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
17 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(0.0878, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9945, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
16 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(0.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
15 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(-1.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4186, dtype=torch.float64) delta_t tensor(-0.1128, dtype=torch.float64)
14 gae_duplicate tensor(-1.2044, dtype=torch.float64) tensor(1.8752, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
13 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-2.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2574, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
12 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(-0.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.0883, dtype=torch.float64)
11 gae_duplicate tensor(-0.3719, dtype=torch.float64) tensor(1.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
10 gae_duplicate tensor(-0.2747, dtype=torch.float64) tensor(-0.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3923, dtype=torch.float64) delta_t tensor(0.2175, dtype=torch.float64)
9 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-4.6878, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5455, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
8 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(-0.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6573, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
7 gae_duplicate tensor(-0.4145, dtype=torch.float64) tensor(-0.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6986, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
6 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(-1.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4439, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
5 gae_duplicate tensor(-0.5912, dtype=torch.float64) tensor(1.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1104, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
4 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-0.7435, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9120, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
3 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(2.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2336, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
2 gae_duplicate tensor(-0.3464, dtype=torch.float64) tensor(-0.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:66.35914611816406
value loss:7.8232526779174805
entropies:346.6174621582031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3902.0576)
ToM Target loss= tensor(3974.2458)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.5815510749816895 seconds
19 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
19 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(0.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1348, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
18 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-1.3008, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7336, dtype=torch.float64) delta_t tensor(-0.3278, dtype=torch.float64)
17 gae_duplicate tensor(-1.4086, dtype=torch.float64) tensor(5.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9553, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
16 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(1.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8658, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
15 gae_duplicate tensor(-0.3116, dtype=torch.float64) tensor(-0.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6497, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
14 gae_duplicate tensor(0.0311, dtype=torch.float64) tensor(-3.2582, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5874, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
13 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-1.5390, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2416, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
12 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(-1.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4859, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
11 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-0.3507, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1273, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
10 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(0.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5860, dtype=torch.float64) delta_t tensor(0.1580, dtype=torch.float64)
9 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-2.8198, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6761, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
8 gae_duplicate tensor(-0.1888, dtype=torch.float64) tensor(0.8988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1870, dtype=torch.float64) delta_t tensor(0.2177, dtype=torch.float64)
7 gae_duplicate tensor(-0.0684, dtype=torch.float64) tensor(-3.9113, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8286, dtype=torch.float64) delta_t tensor(-0.0388, dtype=torch.float64)
6 gae_duplicate tensor(-0.3697, dtype=torch.float64) tensor(0.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1581, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
5 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-1.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3212, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
4 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(0.3587, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5450, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-0.2327, dtype=torch.float64) tensor(0.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0359, dtype=torch.float64) delta_t tensor(-0.2057, dtype=torch.float64)
2 gae_duplicate tensor(-0.4442, dtype=torch.float64) tensor(3.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-44.97171401977539
value loss:8.292902946472168
entropies:346.5465087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801249027252197 seconds
19 rew tensor(1.2092, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
19 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(0.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1711, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
18 gae_duplicate tensor(0.0037, dtype=torch.float64) tensor(-1.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(-0.2491, dtype=torch.float64)
17 gae_duplicate tensor(-1.5766, dtype=torch.float64) tensor(6.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9434, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
16 gae_duplicate tensor(-0.2602, dtype=torch.float64) tensor(0.5070, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8040, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
15 gae_duplicate tensor(-0.1721, dtype=torch.float64) tensor(-1.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5575, dtype=torch.float64) delta_t tensor(-0.0293, dtype=torch.float64)
14 gae_duplicate tensor(-0.9960, dtype=torch.float64) tensor(0.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4867, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
13 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(0.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.1225, dtype=torch.float64)
12 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(-2.2074, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3353, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
11 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(-0.0215, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0985, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
10 gae_duplicate tensor(-0.2094, dtype=torch.float64) tensor(-0.5263, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
9 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(-2.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4474, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
8 gae_duplicate tensor(-0.6078, dtype=torch.float64) tensor(0.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3764, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
7 gae_duplicate tensor(-0.9347, dtype=torch.float64) tensor(4.1125, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5755, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
6 gae_duplicate tensor(-0.4694, dtype=torch.float64) tensor(-1.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7194, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
5 gae_duplicate tensor(-0.3501, dtype=torch.float64) tensor(0.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2152, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
4 gae_duplicate tensor(-0.1733, dtype=torch.float64) tensor(-3.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3637, dtype=torch.float64) delta_t tensor(-0.1722, dtype=torch.float64)
3 gae_duplicate tensor(-0.4257, dtype=torch.float64) tensor(2.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5719, dtype=torch.float64) delta_t tensor(0.1970, dtype=torch.float64)
2 gae_duplicate tensor(-0.3057, dtype=torch.float64) tensor(-3.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.36928367614746
value loss:14.937285423278809
entropies:346.4951477050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.669950008392334 seconds
19 rew tensor(1.1459, dtype=torch.float64) delta_t tensor(-0.0557, dtype=torch.float64)
19 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(1.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
18 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-0.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0317, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
17 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-0.0741, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
16 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-0.3005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8797, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
15 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-1.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3972, dtype=torch.float64) delta_t tensor(-0.1657, dtype=torch.float64)
14 gae_duplicate tensor(-1.3327, dtype=torch.float64) tensor(4.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6759, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
13 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-0.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2155, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
12 gae_duplicate tensor(-0.3085, dtype=torch.float64) tensor(1.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
11 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(-0.1675, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0894, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
10 gae_duplicate tensor(-0.2252, dtype=torch.float64) tensor(1.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3970, dtype=torch.float64) delta_t tensor(0.2547, dtype=torch.float64)
9 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-4.7270, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5511, dtype=torch.float64) delta_t tensor(-0.1090, dtype=torch.float64)
8 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(1.5498, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6577, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
7 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-2.3639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6527, dtype=torch.float64) delta_t tensor(0.1053, dtype=torch.float64)
6 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-2.1525, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4120, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
5 gae_duplicate tensor(-0.1626, dtype=torch.float64) tensor(0.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0415, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
4 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-1.2621, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9022, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
3 gae_duplicate tensor(-0.2428, dtype=torch.float64) tensor(1.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3409, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
2 gae_duplicate tensor(-0.5610, dtype=torch.float64) tensor(0.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:9.56246280670166
value loss:7.755277633666992
entropies:346.4198913574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.958525896072388 seconds
19 rew tensor(1.2103, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
19 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(0.9329, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1978, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
18 gae_duplicate tensor(-0.0254, dtype=torch.float64) tensor(-1.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1221, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
17 gae_duplicate tensor(-0.1143, dtype=torch.float64) tensor(-0.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1343, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
16 gae_duplicate tensor(0.0354, dtype=torch.float64) tensor(-3.7476, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9830, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
15 gae_duplicate tensor(-0.2722, dtype=torch.float64) tensor(-2.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4718, dtype=torch.float64) delta_t tensor(-0.0333, dtype=torch.float64)
14 gae_duplicate tensor(-1.1759, dtype=torch.float64) tensor(0.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0330, dtype=torch.float64) delta_t tensor(-0.5176, dtype=torch.float64)
13 gae_duplicate tensor(-2.7836, dtype=torch.float64) tensor(9.4697, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2027, dtype=torch.float64) delta_t tensor(0.3001, dtype=torch.float64)
12 gae_duplicate tensor(-0.1851, dtype=torch.float64) tensor(-5.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
11 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(-1.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
10 gae_duplicate tensor(-0.2926, dtype=torch.float64) tensor(0.3285, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
9 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-5.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7147, dtype=torch.float64) delta_t tensor(-0.2084, dtype=torch.float64)
8 gae_duplicate tensor(-0.4689, dtype=torch.float64) tensor(3.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2819, dtype=torch.float64) delta_t tensor(0.2623, dtype=torch.float64)
7 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-4.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0957, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
6 gae_duplicate tensor(-0.2488, dtype=torch.float64) tensor(0.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9092, dtype=torch.float64) delta_t tensor(0.2433, dtype=torch.float64)
5 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-4.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3199, dtype=torch.float64) delta_t tensor(-0.0436, dtype=torch.float64)
4 gae_duplicate tensor(-0.2178, dtype=torch.float64) tensor(0.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4370, dtype=torch.float64) delta_t tensor(0.2062, dtype=torch.float64)
3 gae_duplicate tensor(-0.0410, dtype=torch.float64) tensor(-3.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0767, dtype=torch.float64) delta_t tensor(-0.1829, dtype=torch.float64)
2 gae_duplicate tensor(-0.5470, dtype=torch.float64) tensor(2.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:734.7913818359375
value loss:27.74733543395996
entropies:346.279541015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.634106874465942 seconds
19 rew tensor(1.1851, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
19 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-0.2682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1983, dtype=torch.float64) delta_t tensor(0.1703, dtype=torch.float64)
18 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-3.5952, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
17 gae_duplicate tensor(-1.1524, dtype=torch.float64) tensor(3.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9569, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
16 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(0.7280, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0074, dtype=torch.float64) delta_t tensor(0.1772, dtype=torch.float64)
15 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-3.4107, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6893, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
14 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-2.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2353, dtype=torch.float64) delta_t tensor(-0.3325, dtype=torch.float64)
13 gae_duplicate tensor(-2.6553, dtype=torch.float64) tensor(5.8099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(-0.3018, dtype=torch.float64)
12 gae_duplicate tensor(-1.1366, dtype=torch.float64) tensor(6.1286, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5467, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
11 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(-1.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0771, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
10 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-0.9436, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4096, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
9 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(-2.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6761, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
8 gae_duplicate tensor(-0.1924, dtype=torch.float64) tensor(1.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8716, dtype=torch.float64) delta_t tensor(-0.1297, dtype=torch.float64)
7 gae_duplicate tensor(-1.4484, dtype=torch.float64) tensor(2.0705, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7534, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
6 gae_duplicate tensor(-0.3902, dtype=torch.float64) tensor(-1.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4442, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
5 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-1.6749, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0116, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
4 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-0.8610, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0768, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
3 gae_duplicate tensor(-0.5621, dtype=torch.float64) tensor(1.6670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3453, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
2 gae_duplicate tensor(-0.4511, dtype=torch.float64) tensor(0.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-272.48980712890625
value loss:24.404441833496094
entropies:346.1376953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3905.5999)
ToM Target loss= tensor(3974.0559)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.664318323135376 seconds
19 rew tensor(1.2086, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
19 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(-0.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
18 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-1.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0827, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
17 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-0.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9692, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
16 gae_duplicate tensor(-0.1934, dtype=torch.float64) tensor(0.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9168, dtype=torch.float64) delta_t tensor(0.2078, dtype=torch.float64)
15 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-3.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4572, dtype=torch.float64) delta_t tensor(-0.2137, dtype=torch.float64)
14 gae_duplicate tensor(-1.0965, dtype=torch.float64) tensor(3.8889, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
13 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-1.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
12 gae_duplicate tensor(0.0466, dtype=torch.float64) tensor(-3.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
11 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(-1.3176, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0628, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
10 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(0.8774, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2049, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
9 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-4.0002, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4459, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
8 gae_duplicate tensor(-0.3509, dtype=torch.float64) tensor(-0.3164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1216, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
7 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(-1.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6886, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
6 gae_duplicate tensor(-0.3696, dtype=torch.float64) tensor(-1.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5945, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
5 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(-1.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
4 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(-2.5059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3006, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
3 gae_duplicate tensor(-0.3929, dtype=torch.float64) tensor(1.5836, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5470, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
2 gae_duplicate tensor(-0.3303, dtype=torch.float64) tensor(-4.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1004.5249633789062
value loss:9.957062721252441
entropies:346.14410400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.779254913330078 seconds
19 rew tensor(1.0811, dtype=torch.float64) delta_t tensor(-0.0869, dtype=torch.float64)
19 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(1.7809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0809, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
18 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-0.4216, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9924, dtype=torch.float64) delta_t tensor(-0.0393, dtype=torch.float64)
17 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(0.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0443, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
16 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-0.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
15 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(1.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6285, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
14 gae_duplicate tensor(-0.9543, dtype=torch.float64) tensor(1.9574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3609, dtype=torch.float64) delta_t tensor(-0.0995, dtype=torch.float64)
13 gae_duplicate tensor(-1.3617, dtype=torch.float64) tensor(1.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
12 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-1.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
11 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(1.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0130, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
10 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(-0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3416, dtype=torch.float64) delta_t tensor(0.3324, dtype=torch.float64)
9 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-6.8614, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4433, dtype=torch.float64) delta_t tensor(-0.1358, dtype=torch.float64)
8 gae_duplicate tensor(-0.5311, dtype=torch.float64) tensor(2.4386, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7136, dtype=torch.float64) delta_t tensor(-0.3594, dtype=torch.float64)
7 gae_duplicate tensor(-2.6092, dtype=torch.float64) tensor(6.4043, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5717, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
6 gae_duplicate tensor(-0.6491, dtype=torch.float64) tensor(-0.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7233, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
5 gae_duplicate tensor(-0.3382, dtype=torch.float64) tensor(-0.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2910, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
4 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(-2.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4395, dtype=torch.float64) delta_t tensor(-0.1852, dtype=torch.float64)
3 gae_duplicate tensor(-0.5286, dtype=torch.float64) tensor(3.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6355, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
2 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(-3.9763, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-350.5929870605469
value loss:21.25603485107422
entropies:346.1833801269531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.657404899597168 seconds
19 rew tensor(1.1835, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
19 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(0.8773, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1711, dtype=torch.float64) delta_t tensor(0.0866, dtype=torch.float64)
18 gae_duplicate tensor(-0.0591, dtype=torch.float64) tensor(-1.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7801, dtype=torch.float64) delta_t tensor(-0.2856, dtype=torch.float64)
17 gae_duplicate tensor(-1.5302, dtype=torch.float64) tensor(4.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9560, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
16 gae_duplicate tensor(-0.2309, dtype=torch.float64) tensor(0.7640, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8658, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
15 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(-0.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7663, dtype=torch.float64) delta_t tensor(0.2885, dtype=torch.float64)
14 gae_duplicate tensor(0.0530, dtype=torch.float64) tensor(-5.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7766, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
13 gae_duplicate tensor(0.0944, dtype=torch.float64) tensor(-4.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2574, dtype=torch.float64) delta_t tensor(0.0984, dtype=torch.float64)
12 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-2.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5809, dtype=torch.float64) delta_t tensor(-0.9580, dtype=torch.float64)
11 gae_duplicate tensor(-6.2230, dtype=torch.float64) tensor(17.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1128, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
10 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(0.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
9 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-3.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7017, dtype=torch.float64) delta_t tensor(-0.1480, dtype=torch.float64)
8 gae_duplicate tensor(-0.5012, dtype=torch.float64) tensor(2.5064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3320, dtype=torch.float64) delta_t tensor(0.2207, dtype=torch.float64)
7 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-4.2543, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8165, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
6 gae_duplicate tensor(-0.2079, dtype=torch.float64) tensor(-0.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3413, dtype=torch.float64) delta_t tensor(-0.0553, dtype=torch.float64)
5 gae_duplicate tensor(-0.3983, dtype=torch.float64) tensor(1.3121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2435, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
4 gae_duplicate tensor(-0.3753, dtype=torch.float64) tensor(1.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8061, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
3 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(1.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
2 gae_duplicate tensor(-0.3307, dtype=torch.float64) tensor(0.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-552.8712768554688
value loss:69.07005310058594
entropies:346.1797180175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.967571973800659 seconds
19 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
19 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(1.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1075, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
18 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-0.5245, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0310, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
17 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0069, dtype=torch.float64) delta_t tensor(-0.0038, dtype=torch.float64)
16 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(0.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.1585, dtype=torch.float64)
15 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(-3.6231, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7015, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
14 gae_duplicate tensor(0.0188, dtype=torch.float64) tensor(-3.3697, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2837, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
13 gae_duplicate tensor(-1.3015, dtype=torch.float64) tensor(4.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4581, dtype=torch.float64) delta_t tensor(0.2052, dtype=torch.float64)
12 gae_duplicate tensor(0.0576, dtype=torch.float64) tensor(-3.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4986, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
11 gae_duplicate tensor(-0.2083, dtype=torch.float64) tensor(-1.9394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1537, dtype=torch.float64) delta_t tensor(-0.0763, dtype=torch.float64)
10 gae_duplicate tensor(-0.2374, dtype=torch.float64) tensor(1.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4080, dtype=torch.float64) delta_t tensor(0.2229, dtype=torch.float64)
9 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-3.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5222, dtype=torch.float64) delta_t tensor(-0.0913, dtype=torch.float64)
8 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(1.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9556, dtype=torch.float64) delta_t tensor(0.2372, dtype=torch.float64)
7 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-4.3305, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6372, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
6 gae_duplicate tensor(0.0124, dtype=torch.float64) tensor(-3.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6441, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
5 gae_duplicate tensor(-0.3369, dtype=torch.float64) tensor(-0.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
4 gae_duplicate tensor(-0.2688, dtype=torch.float64) tensor(0.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2747, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
3 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(1.7870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4448, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
2 gae_duplicate tensor(-0.3285, dtype=torch.float64) tensor(-0.6923, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:797.4733276367188
value loss:9.57327938079834
entropies:346.3811340332031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.842370986938477 seconds
19 rew tensor(1.1328, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
19 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(0.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1080, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
18 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-0.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0575, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
17 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-0.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0332, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
16 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-0.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8932, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
15 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(0.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
14 gae_duplicate tensor(0.1348, dtype=torch.float64) tensor(-4.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0943, dtype=torch.float64) delta_t tensor(-0.4223, dtype=torch.float64)
13 gae_duplicate tensor(-2.7607, dtype=torch.float64) tensor(7.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1095, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
12 gae_duplicate tensor(-1.2252, dtype=torch.float64) tensor(2.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
11 gae_duplicate tensor(-0.3985, dtype=torch.float64) tensor(2.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1033, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
10 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(1.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3963, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
9 gae_duplicate tensor(0.0983, dtype=torch.float64) tensor(-3.2561, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4347, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
8 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-0.3047, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5889, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
7 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(-0.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7390, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
6 gae_duplicate tensor(-0.4348, dtype=torch.float64) tensor(0.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3164, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
5 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(1.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2035, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
4 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(1.4606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7061, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
3 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(0.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1531, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
2 gae_duplicate tensor(-0.6491, dtype=torch.float64) tensor(1.5623, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-693.529052734375
value loss:18.243803024291992
entropies:346.4646301269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3881.6897)
ToM Target loss= tensor(3971.7725)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.679485082626343 seconds
19 rew tensor(1.2225, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
19 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1338, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
18 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-1.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0068, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
17 gae_duplicate tensor(-0.1487, dtype=torch.float64) tensor(0.5897, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6877, dtype=torch.float64) delta_t tensor(-0.2867, dtype=torch.float64)
16 gae_duplicate tensor(-1.5635, dtype=torch.float64) tensor(5.3736, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8536, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
15 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(-0.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6495, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
14 gae_duplicate tensor(-0.2102, dtype=torch.float64) tensor(-1.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6379, dtype=torch.float64) delta_t tensor(0.1297, dtype=torch.float64)
13 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-2.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
12 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-0.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
11 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(0.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(-0.0695, dtype=torch.float64)
10 gae_duplicate tensor(-0.3496, dtype=torch.float64) tensor(1.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
9 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(-1.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5243, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
8 gae_duplicate tensor(-0.0944, dtype=torch.float64) tensor(-0.4243, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0353, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
7 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-0.8431, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9718, dtype=torch.float64) delta_t tensor(-0.0528, dtype=torch.float64)
6 gae_duplicate tensor(-0.3942, dtype=torch.float64) tensor(0.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9037, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
5 gae_duplicate tensor(-0.1160, dtype=torch.float64) tensor(-0.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5263, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
4 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(1.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1762, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
3 gae_duplicate tensor(-0.3546, dtype=torch.float64) tensor(-0.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1951, dtype=torch.float64) delta_t tensor(-0.1960, dtype=torch.float64)
2 gae_duplicate tensor(-0.6109, dtype=torch.float64) tensor(4.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-300.8990173339844
value loss:9.29902458190918
entropies:346.6209716796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.823067903518677 seconds
19 rew tensor(1.0821, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
19 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(1.1919, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0439, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
18 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-0.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0188, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
17 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(-0.4468, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0187, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
16 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-0.5249, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7898, dtype=torch.float64) delta_t tensor(0.1371, dtype=torch.float64)
15 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-2.5388, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8280, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
14 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-2.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5252, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
13 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(-1.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4819, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
12 gae_duplicate tensor(-0.2999, dtype=torch.float64) tensor(-0.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2836, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
11 gae_duplicate tensor(-0.3233, dtype=torch.float64) tensor(0.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1621, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
10 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-0.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1051, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
9 gae_duplicate tensor(-0.2335, dtype=torch.float64) tensor(-2.7070, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3971, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
8 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(-0.4064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9767, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
7 gae_duplicate tensor(-0.7648, dtype=torch.float64) tensor(0.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6541, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
6 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(-3.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5143, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
5 gae_duplicate tensor(-0.2828, dtype=torch.float64) tensor(0.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0068, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
4 gae_duplicate tensor(-0.2295, dtype=torch.float64) tensor(-0.9456, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9761, dtype=torch.float64) delta_t tensor(-0.0702, dtype=torch.float64)
3 gae_duplicate tensor(-0.5469, dtype=torch.float64) tensor(1.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3123, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
2 gae_duplicate tensor(-0.5054, dtype=torch.float64) tensor(-0.3171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:562.9869995117188
value loss:9.335251808166504
entropies:346.675537109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6782920360565186 seconds
19 rew tensor(0.9134, dtype=torch.float64) delta_t tensor(-0.2904, dtype=torch.float64)
19 gae_duplicate tensor(-1.4519, dtype=torch.float64) tensor(5.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1594, dtype=torch.float64) delta_t tensor(0.0940, dtype=torch.float64)
18 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(-1.1892, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8781, dtype=torch.float64) delta_t tensor(-0.1471, dtype=torch.float64)
17 gae_duplicate tensor(-1.2027, dtype=torch.float64) tensor(2.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0065, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
16 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(0.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
15 gae_duplicate tensor(-0.2910, dtype=torch.float64) tensor(-0.0501, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1602, dtype=torch.float64) delta_t tensor(-0.2891, dtype=torch.float64)
14 gae_duplicate tensor(-2.2865, dtype=torch.float64) tensor(7.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6136, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
13 gae_duplicate tensor(-0.4435, dtype=torch.float64) tensor(-0.9078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
12 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(-0.3760, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3309, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
11 gae_duplicate tensor(-0.3309, dtype=torch.float64) tensor(0.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0272, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
10 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(0.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
9 gae_duplicate tensor(-0.2316, dtype=torch.float64) tensor(-0.8025, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4991, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
8 gae_duplicate tensor(-0.0438, dtype=torch.float64) tensor(-0.0702, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7374, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
7 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(-0.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6011, dtype=torch.float64) delta_t tensor(0.1644, dtype=torch.float64)
6 gae_duplicate tensor(-0.0370, dtype=torch.float64) tensor(-3.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6210, dtype=torch.float64) delta_t tensor(-0.0241, dtype=torch.float64)
5 gae_duplicate tensor(-0.3342, dtype=torch.float64) tensor(0.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0681, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
4 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(0.9845, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0451, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
3 gae_duplicate tensor(-0.3419, dtype=torch.float64) tensor(1.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2764, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
2 gae_duplicate tensor(-0.4938, dtype=torch.float64) tensor(0.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-694.0546875
value loss:18.191816329956055
entropies:346.7167663574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052712917327881 seconds
19 rew tensor(1.1725, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
19 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-0.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1214, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
18 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-1.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0447, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
17 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(-1.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
16 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(0.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8035, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
15 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(-1.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5342, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
14 gae_duplicate tensor(-1.2048, dtype=torch.float64) tensor(2.8993, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5736, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
13 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(-1.4997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.2208, dtype=torch.float64)
12 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-4.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
11 gae_duplicate tensor(-0.3251, dtype=torch.float64) tensor(0.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1392, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
10 gae_duplicate tensor(-0.2332, dtype=torch.float64) tensor(0.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1151, dtype=torch.float64) delta_t tensor(0.1639, dtype=torch.float64)
9 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(-3.1381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4989, dtype=torch.float64) delta_t tensor(-0.0951, dtype=torch.float64)
8 gae_duplicate tensor(-0.5194, dtype=torch.float64) tensor(1.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4674, dtype=torch.float64) delta_t tensor(-0.2594, dtype=torch.float64)
7 gae_duplicate tensor(-0.9940, dtype=torch.float64) tensor(6.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6273, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
6 gae_duplicate tensor(-0.5403, dtype=torch.float64) tensor(0.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8255, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
5 gae_duplicate tensor(-0.2232, dtype=torch.float64) tensor(1.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1894, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
4 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-1.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4949, dtype=torch.float64) delta_t tensor(-0.2633, dtype=torch.float64)
3 gae_duplicate tensor(-0.5967, dtype=torch.float64) tensor(4.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5336, dtype=torch.float64) delta_t tensor(0.2014, dtype=torch.float64)
2 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-3.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-60.427452087402344
value loss:11.952642440795898
entropies:346.51470947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.734247207641602 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
19 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(0.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
18 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-1.6833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
17 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(-0.4350, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0320, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
16 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(-0.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9176, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
15 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(0.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0060, dtype=torch.float64) delta_t tensor(-0.6474, dtype=torch.float64)
14 gae_duplicate tensor(-2.8625, dtype=torch.float64) tensor(14.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
13 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(-1.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2921, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
12 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(0.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4864, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
11 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-2.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0661, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
10 gae_duplicate tensor(-0.1687, dtype=torch.float64) tensor(1.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
9 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(-2.6348, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5245, dtype=torch.float64) delta_t tensor(-0.1478, dtype=torch.float64)
8 gae_duplicate tensor(-0.5051, dtype=torch.float64) tensor(2.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3796, dtype=torch.float64) delta_t tensor(-0.0462, dtype=torch.float64)
7 gae_duplicate tensor(-1.3314, dtype=torch.float64) tensor(2.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6399, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
6 gae_duplicate tensor(-0.4409, dtype=torch.float64) tensor(-0.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6708, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
5 gae_duplicate tensor(-0.2662, dtype=torch.float64) tensor(-1.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2665, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
4 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(-1.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4299, dtype=torch.float64) delta_t tensor(-0.0911, dtype=torch.float64)
3 gae_duplicate tensor(-0.4531, dtype=torch.float64) tensor(1.5619, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6109, dtype=torch.float64) delta_t tensor(0.1728, dtype=torch.float64)
2 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(-2.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-607.9652709960938
value loss:22.62125015258789
entropies:346.1595153808594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3873.7500)
ToM Target loss= tensor(3974.5698)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.608364105224609 seconds
19 rew tensor(1.2357, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
19 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-0.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1984, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
18 gae_duplicate tensor(0.0157, dtype=torch.float64) tensor(-2.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1352, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
17 gae_duplicate tensor(-0.0935, dtype=torch.float64) tensor(-1.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9692, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
16 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(0.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9443, dtype=torch.float64) delta_t tensor(0.0708, dtype=torch.float64)
15 gae_duplicate tensor(-0.1906, dtype=torch.float64) tensor(-1.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0747, dtype=torch.float64) delta_t tensor(-0.7083, dtype=torch.float64)
14 gae_duplicate tensor(-2.9135, dtype=torch.float64) tensor(12.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
13 gae_duplicate tensor(-1.3753, dtype=torch.float64) tensor(2.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3684, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
12 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(-1.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3456, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
11 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(0.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
10 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-0.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2937, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
9 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-1.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5244, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
8 gae_duplicate tensor(-0.4038, dtype=torch.float64) tensor(1.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8155, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
7 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-0.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6140, dtype=torch.float64) delta_t tensor(0.1547, dtype=torch.float64)
6 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(-2.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5944, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
5 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-1.2731, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0366, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
4 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(0.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1486, dtype=torch.float64) delta_t tensor(-0.1166, dtype=torch.float64)
3 gae_duplicate tensor(-0.4100, dtype=torch.float64) tensor(2.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
2 gae_duplicate tensor(-0.3398, dtype=torch.float64) tensor(1.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-468.48040771484375
value loss:23.990718841552734
entropies:345.60845947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.576485872268677 seconds
19 rew tensor(1.2232, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
19 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(0.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1592, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
18 gae_duplicate tensor(-0.0297, dtype=torch.float64) tensor(-1.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1857, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
17 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-2.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
16 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(-0.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9307, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
15 gae_duplicate tensor(-0.1430, dtype=torch.float64) tensor(-1.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
14 gae_duplicate tensor(0.0401, dtype=torch.float64) tensor(-3.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4323, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
13 gae_duplicate tensor(-1.3140, dtype=torch.float64) tensor(1.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(-0.1554, dtype=torch.float64)
12 gae_duplicate tensor(-1.4597, dtype=torch.float64) tensor(2.4579, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(-0.3458, dtype=torch.float64)
11 gae_duplicate tensor(-2.8728, dtype=torch.float64) tensor(6.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0355, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
10 gae_duplicate tensor(-0.2539, dtype=torch.float64) tensor(-0.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3549, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
9 gae_duplicate tensor(-0.3041, dtype=torch.float64) tensor(-1.7683, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5977, dtype=torch.float64) delta_t tensor(-0.1063, dtype=torch.float64)
8 gae_duplicate tensor(-0.4382, dtype=torch.float64) tensor(2.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0792, dtype=torch.float64) delta_t tensor(-0.3411, dtype=torch.float64)
7 gae_duplicate tensor(-2.7171, dtype=torch.float64) tensor(6.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8685, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
6 gae_duplicate tensor(-0.6628, dtype=torch.float64) tensor(0.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3370, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
5 gae_duplicate tensor(-0.3502, dtype=torch.float64) tensor(0.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0716, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
4 gae_duplicate tensor(-0.3107, dtype=torch.float64) tensor(-0.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9474, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
3 gae_duplicate tensor(-0.5037, dtype=torch.float64) tensor(1.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2085, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
2 gae_duplicate tensor(-0.3524, dtype=torch.float64) tensor(1.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-663.7500610351562
value loss:38.11130905151367
entropies:345.2640686035156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.302631855010986 seconds
19 rew tensor(1.1855, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
19 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(0.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1852, dtype=torch.float64) delta_t tensor(0.1651, dtype=torch.float64)
18 gae_duplicate tensor(0.0383, dtype=torch.float64) tensor(-2.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9948, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
17 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(0.5820, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9698, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
16 gae_duplicate tensor(-0.0804, dtype=torch.float64) tensor(0.1375, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8671, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
15 gae_duplicate tensor(-0.0855, dtype=torch.float64) tensor(-0.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6395, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
14 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-2.6841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4173, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
13 gae_duplicate tensor(-1.0502, dtype=torch.float64) tensor(0.9502, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1921, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
12 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-1.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4314, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
11 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(0.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1403, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
10 gae_duplicate tensor(-0.3627, dtype=torch.float64) tensor(0.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.2641, dtype=torch.float64)
9 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-4.9825, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6871, dtype=torch.float64) delta_t tensor(-0.1561, dtype=torch.float64)
8 gae_duplicate tensor(-0.5234, dtype=torch.float64) tensor(2.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2883, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
7 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-1.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8546, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
6 gae_duplicate tensor(-0.4063, dtype=torch.float64) tensor(1.0459, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1911, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
5 gae_duplicate tensor(-0.1275, dtype=torch.float64) tensor(-0.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2658, dtype=torch.float64) delta_t tensor(-0.0368, dtype=torch.float64)
4 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(0.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6582, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
3 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(1.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0781, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
2 gae_duplicate tensor(-0.4717, dtype=torch.float64) tensor(3.4035, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:93.56201934814453
value loss:8.200758934020996
entropies:344.9630126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5510478019714355 seconds
19 rew tensor(1.1471, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
19 gae_duplicate tensor(-0.1511, dtype=torch.float64) tensor(0.8781, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1734, dtype=torch.float64) delta_t tensor(0.1388, dtype=torch.float64)
18 gae_duplicate tensor(-0.0634, dtype=torch.float64) tensor(-2.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7772, dtype=torch.float64) delta_t tensor(-0.2771, dtype=torch.float64)
17 gae_duplicate tensor(-1.5225, dtype=torch.float64) tensor(4.7690, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8665, dtype=torch.float64) delta_t tensor(-0.1032, dtype=torch.float64)
16 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(2.4666, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9575, dtype=torch.float64) delta_t tensor(0.1995, dtype=torch.float64)
15 gae_duplicate tensor(-0.1522, dtype=torch.float64) tensor(-3.6354, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6128, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
14 gae_duplicate tensor(-0.0271, dtype=torch.float64) tensor(-1.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
13 gae_duplicate tensor(-1.5271, dtype=torch.float64) tensor(1.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3265, dtype=torch.float64) delta_t tensor(-0.4570, dtype=torch.float64)
12 gae_duplicate tensor(-3.0112, dtype=torch.float64) tensor(11.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4316, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
11 gae_duplicate tensor(-0.7601, dtype=torch.float64) tensor(1.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1669, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
10 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(-0.6303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4447, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
9 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(-0.3505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7554, dtype=torch.float64) delta_t tensor(-0.1496, dtype=torch.float64)
8 gae_duplicate tensor(-0.3140, dtype=torch.float64) tensor(2.7853, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2140, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
7 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(-0.5777, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7937, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
6 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-1.0386, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3157, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
5 gae_duplicate tensor(-0.3352, dtype=torch.float64) tensor(0.6442, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2979, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
4 gae_duplicate tensor(-0.6591, dtype=torch.float64) tensor(2.1901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6892, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
3 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-0.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0592, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
2 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(0.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1089.4761962890625
value loss:26.545589447021484
entropies:344.78814697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.993859767913818 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0303, dtype=torch.float64)
19 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(0.5944, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1596, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
18 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-2.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1094, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
17 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-1.4617, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0201, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
16 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-0.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9179, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
15 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(-2.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
14 gae_duplicate tensor(-0.1091, dtype=torch.float64) tensor(-0.9199, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
13 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-3.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4229, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
12 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-2.0923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(-0.0546, dtype=torch.float64)
11 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(0.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0097, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
10 gae_duplicate tensor(-0.1906, dtype=torch.float64) tensor(0.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2518, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
9 gae_duplicate tensor(0.0067, dtype=torch.float64) tensor(-3.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5228, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
8 gae_duplicate tensor(-0.3370, dtype=torch.float64) tensor(0.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1381, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
7 gae_duplicate tensor(-0.2810, dtype=torch.float64) tensor(-1.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6125, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
6 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(-1.4796, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6989, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
5 gae_duplicate tensor(-0.2764, dtype=torch.float64) tensor(0.7103, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2172, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
4 gae_duplicate tensor(-0.1162, dtype=torch.float64) tensor(-1.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4064, dtype=torch.float64) delta_t tensor(-0.1870, dtype=torch.float64)
3 gae_duplicate tensor(-0.4481, dtype=torch.float64) tensor(3.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(0.2422, dtype=torch.float64)
2 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(-4.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:923.8052368164062
value loss:6.766565322875977
entropies:344.4061584472656
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3879.5867)
ToM Target loss= tensor(3962.3171)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.941636085510254 seconds
19 rew tensor(1.1474, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
19 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(0.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1222, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
18 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-1.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0723, dtype=torch.float64) delta_t tensor(0.0319, dtype=torch.float64)
17 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-0.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9563, dtype=torch.float64) delta_t tensor(-0.0483, dtype=torch.float64)
16 gae_duplicate tensor(-0.1726, dtype=torch.float64) tensor(0.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8550, dtype=torch.float64) delta_t tensor(0.1171, dtype=torch.float64)
15 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-2.6402, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4815, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
14 gae_duplicate tensor(-1.1888, dtype=torch.float64) tensor(1.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6238, dtype=torch.float64) delta_t tensor(0.0886, dtype=torch.float64)
13 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-1.5624, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2805, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
12 gae_duplicate tensor(-0.2338, dtype=torch.float64) tensor(-1.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
11 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(0.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0377, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
10 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(0.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(0.1669, dtype=torch.float64)
9 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(-3.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4996, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
8 gae_duplicate tensor(-0.3631, dtype=torch.float64) tensor(1.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7971, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
7 gae_duplicate tensor(-0.0415, dtype=torch.float64) tensor(-1.5722, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7153, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
6 gae_duplicate tensor(-0.3718, dtype=torch.float64) tensor(-0.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4470, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
5 gae_duplicate tensor(-0.4415, dtype=torch.float64) tensor(-0.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0152, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
4 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(0.0913, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0425, dtype=torch.float64) delta_t tensor(-0.0873, dtype=torch.float64)
3 gae_duplicate tensor(-0.2226, dtype=torch.float64) tensor(1.8487, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3722, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
2 gae_duplicate tensor(-0.2546, dtype=torch.float64) tensor(-0.3011, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:303.6417541503906
value loss:7.316752910614014
entropies:344.0548400878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.95001220703125 seconds
19 rew tensor(1.2123, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
19 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-0.1903, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-0.1459, dtype=torch.float64)
18 gae_duplicate tensor(-1.5630, dtype=torch.float64) tensor(2.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0077, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
17 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(0.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9455, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
16 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(0.6482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
15 gae_duplicate tensor(-0.2829, dtype=torch.float64) tensor(0.1672, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
14 gae_duplicate tensor(-0.0494, dtype=torch.float64) tensor(-3.8127, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3782, dtype=torch.float64) delta_t tensor(-0.1244, dtype=torch.float64)
13 gae_duplicate tensor(-1.1119, dtype=torch.float64) tensor(1.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3074, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
12 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(0.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
11 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-1.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1538, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
10 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(0.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1384, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
9 gae_duplicate tensor(-0.2800, dtype=torch.float64) tensor(0.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4966, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
8 gae_duplicate tensor(-0.2526, dtype=torch.float64) tensor(2.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8363, dtype=torch.float64) delta_t tensor(0.1921, dtype=torch.float64)
7 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-3.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5740, dtype=torch.float64) delta_t tensor(0.2033, dtype=torch.float64)
6 gae_duplicate tensor(0.0587, dtype=torch.float64) tensor(-4.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6521, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
5 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(0.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0123, dtype=torch.float64) delta_t tensor(0.0185, dtype=torch.float64)
4 gae_duplicate tensor(-0.2094, dtype=torch.float64) tensor(-0.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1167, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
3 gae_duplicate tensor(-0.3291, dtype=torch.float64) tensor(2.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
2 gae_duplicate tensor(-0.2639, dtype=torch.float64) tensor(0.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-85.33171081542969
value loss:10.908974647521973
entropies:343.80499267578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.055628061294556 seconds
19 rew tensor(1.2356, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
19 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(0.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2108, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
18 gae_duplicate tensor(0.0305, dtype=torch.float64) tensor(-2.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1986, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
17 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-2.0715, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1356, dtype=torch.float64) delta_t tensor(0.1550, dtype=torch.float64)
16 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-3.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1218, dtype=torch.float64) delta_t tensor(0.4339, dtype=torch.float64)
15 gae_duplicate tensor(0.0638, dtype=torch.float64) tensor(-8.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4123, dtype=torch.float64) delta_t tensor(-0.2155, dtype=torch.float64)
14 gae_duplicate tensor(-1.2521, dtype=torch.float64) tensor(4.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8049, dtype=torch.float64) delta_t tensor(0.3139, dtype=torch.float64)
13 gae_duplicate tensor(-0.0793, dtype=torch.float64) tensor(-5.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.3750, dtype=torch.float64)
12 gae_duplicate tensor(0.0285, dtype=torch.float64) tensor(-8.4144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1224, dtype=torch.float64) delta_t tensor(-1.2424, dtype=torch.float64)
11 gae_duplicate tensor(-4.2077, dtype=torch.float64) tensor(21.3948, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9741, dtype=torch.float64) delta_t tensor(-0.8973, dtype=torch.float64)
10 gae_duplicate tensor(-4.1285, dtype=torch.float64) tensor(18.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4257, dtype=torch.float64) delta_t tensor(-0.5387, dtype=torch.float64)
9 gae_duplicate tensor(-3.4976, dtype=torch.float64) tensor(15.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4211, dtype=torch.float64) delta_t tensor(0.2656, dtype=torch.float64)
8 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-4.0814, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3069, dtype=torch.float64) delta_t tensor(-0.5364, dtype=torch.float64)
7 gae_duplicate tensor(-3.8126, dtype=torch.float64) tensor(9.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0143, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
6 gae_duplicate tensor(-1.8673, dtype=torch.float64) tensor(-0.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2354, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
5 gae_duplicate tensor(-0.6814, dtype=torch.float64) tensor(-0.0299, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2471, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
4 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-0.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0600, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
3 gae_duplicate tensor(-0.6133, dtype=torch.float64) tensor(1.2629, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0593, dtype=torch.float64) delta_t tensor(-0.0784, dtype=torch.float64)
2 gae_duplicate tensor(-1.2724, dtype=torch.float64) tensor(1.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2151.637451171875
value loss:144.08840942382812
entropies:343.4935607910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.672595024108887 seconds
19 rew tensor(1.1708, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
19 gae_duplicate tensor(-0.1808, dtype=torch.float64) tensor(1.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1714, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
18 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-1.5535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(-0.2300, dtype=torch.float64)
17 gae_duplicate tensor(-1.2830, dtype=torch.float64) tensor(3.9510, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0063, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
16 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(0.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9816, dtype=torch.float64) delta_t tensor(0.2432, dtype=torch.float64)
15 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(-4.4041, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5973, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
14 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(-3.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5990, dtype=torch.float64) delta_t tensor(0.1342, dtype=torch.float64)
13 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-2.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2544, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
12 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-3.0149, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4612, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
11 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-2.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(-0.1392, dtype=torch.float64)
10 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(2.8693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4229, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
9 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(-4.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7652, dtype=torch.float64) delta_t tensor(-0.3488, dtype=torch.float64)
8 gae_duplicate tensor(-0.4804, dtype=torch.float64) tensor(6.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9370, dtype=torch.float64) delta_t tensor(0.2965, dtype=torch.float64)
7 gae_duplicate tensor(-0.0642, dtype=torch.float64) tensor(-5.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.0660, dtype=torch.float64)
6 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(0.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5147, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
5 gae_duplicate tensor(-0.1905, dtype=torch.float64) tensor(-2.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2125, dtype=torch.float64) delta_t tensor(0.1787, dtype=torch.float64)
4 gae_duplicate tensor(0.0263, dtype=torch.float64) tensor(-3.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4486, dtype=torch.float64) delta_t tensor(-0.2534, dtype=torch.float64)
3 gae_duplicate tensor(-0.4724, dtype=torch.float64) tensor(4.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5437, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
2 gae_duplicate tensor(-0.4912, dtype=torch.float64) tensor(-1.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:736.02734375
value loss:12.982722282409668
entropies:343.2542724609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.822524070739746 seconds
19 rew tensor(1.2096, dtype=torch.float64) delta_t tensor(-0.0391, dtype=torch.float64)
19 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(0.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
18 gae_duplicate tensor(0.0848, dtype=torch.float64) tensor(-2.2468, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0315, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
17 gae_duplicate tensor(-0.2160, dtype=torch.float64) tensor(0.2405, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8901, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
16 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(0.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6535, dtype=torch.float64) delta_t tensor(-0.1538, dtype=torch.float64)
15 gae_duplicate tensor(-1.3038, dtype=torch.float64) tensor(2.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5713, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
14 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(-2.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
13 gae_duplicate tensor(-1.1570, dtype=torch.float64) tensor(0.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1761, dtype=torch.float64) delta_t tensor(-0.0283, dtype=torch.float64)
12 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(0.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2488, dtype=torch.float64) delta_t tensor(-0.1109, dtype=torch.float64)
11 gae_duplicate tensor(-1.4028, dtype=torch.float64) tensor(2.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1049, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
10 gae_duplicate tensor(-0.2827, dtype=torch.float64) tensor(0.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(0.1297, dtype=torch.float64)
9 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(-2.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8038, dtype=torch.float64) delta_t tensor(-0.1257, dtype=torch.float64)
8 gae_duplicate tensor(-0.4116, dtype=torch.float64) tensor(2.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3519, dtype=torch.float64) delta_t tensor(0.2609, dtype=torch.float64)
7 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-5.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
6 gae_duplicate tensor(-0.2285, dtype=torch.float64) tensor(1.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2604, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
5 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(-0.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1180, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
4 gae_duplicate tensor(-0.0080, dtype=torch.float64) tensor(-2.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8759, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
3 gae_duplicate tensor(-0.4753, dtype=torch.float64) tensor(-0.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2389, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
2 gae_duplicate tensor(-0.4140, dtype=torch.float64) tensor(-1.8324, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:246.27340698242188
value loss:15.254257202148438
entropies:342.9687805175781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3845.9543)
ToM Target loss= tensor(3954.2390)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.752751111984253 seconds
19 rew tensor(1.1335, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
19 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(1.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0580, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
18 gae_duplicate tensor(-0.0919, dtype=torch.float64) tensor(0.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9940, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
17 gae_duplicate tensor(-0.2513, dtype=torch.float64) tensor(1.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0329, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
16 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-0.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(-0.0391, dtype=torch.float64)
15 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(0.6014, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6498, dtype=torch.float64) delta_t tensor(0.2347, dtype=torch.float64)
14 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-4.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6250, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
13 gae_duplicate tensor(0.0036, dtype=torch.float64) tensor(-2.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2156, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
12 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-0.8262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
11 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-1.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2944, dtype=torch.float64) delta_t tensor(-0.1623, dtype=torch.float64)
10 gae_duplicate tensor(-0.3071, dtype=torch.float64) tensor(2.7909, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.1218, dtype=torch.float64)
9 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-1.8998, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4468, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
8 gae_duplicate tensor(-0.2992, dtype=torch.float64) tensor(1.1452, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5757, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
7 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(0.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7656, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
6 gae_duplicate tensor(-0.3432, dtype=torch.float64) tensor(-1.6705, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2639, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
5 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-1.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1399, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
4 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(0.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7171, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
3 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(-1.2063, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
2 gae_duplicate tensor(-0.4854, dtype=torch.float64) tensor(1.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:314.5580749511719
value loss:4.632425308227539
entropies:342.7687683105469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.76662802696228 seconds
19 rew tensor(1.1850, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
19 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(1.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1728, dtype=torch.float64) delta_t tensor(0.0788, dtype=torch.float64)
18 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-1.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1219, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
17 gae_duplicate tensor(-0.0970, dtype=torch.float64) tensor(-0.2567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9689, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
16 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(0.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9696, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
15 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-2.4044, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7139, dtype=torch.float64) delta_t tensor(0.1690, dtype=torch.float64)
14 gae_duplicate tensor(-0.1122, dtype=torch.float64) tensor(-3.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3453, dtype=torch.float64) delta_t tensor(-0.8544, dtype=torch.float64)
13 gae_duplicate tensor(-2.6629, dtype=torch.float64) tensor(16.9364, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(-0.3951, dtype=torch.float64)
12 gae_duplicate tensor(-3.0010, dtype=torch.float64) tensor(8.5013, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4735, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
11 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-0.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0257, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
10 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(-2.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
9 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(-2.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6508, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
8 gae_duplicate tensor(-0.3640, dtype=torch.float64) tensor(2.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5985, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
7 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-1.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7275, dtype=torch.float64) delta_t tensor(0.2213, dtype=torch.float64)
6 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-4.6387, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4927, dtype=torch.float64) delta_t tensor(0.0949, dtype=torch.float64)
5 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-2.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0912, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
4 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(1.3462, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0325, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
3 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(0.5029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
2 gae_duplicate tensor(-0.2489, dtype=torch.float64) tensor(0.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-781.323974609375
value loss:35.62790298461914
entropies:342.6534118652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.364339828491211 seconds
19 rew tensor(1.2108, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
19 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(0.5355, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1475, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
18 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-1.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9807, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
17 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(0.8973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0332, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
16 gae_duplicate tensor(-0.1482, dtype=torch.float64) tensor(0.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8925, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
15 gae_duplicate tensor(-0.2392, dtype=torch.float64) tensor(-1.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
14 gae_duplicate tensor(-0.7325, dtype=torch.float64) tensor(0.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5363, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
13 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(0.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2916, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
12 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(-0.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4870, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
11 gae_duplicate tensor(-0.1808, dtype=torch.float64) tensor(-0.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0513, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
10 gae_duplicate tensor(-0.2653, dtype=torch.float64) tensor(-0.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5120, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
9 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-3.0526, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5514, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
8 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-1.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4259, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
7 gae_duplicate tensor(-0.2444, dtype=torch.float64) tensor(0.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0006, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
6 gae_duplicate tensor(-0.4560, dtype=torch.float64) tensor(0.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9491, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
5 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-2.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4026, dtype=torch.float64) delta_t tensor(-0.1145, dtype=torch.float64)
4 gae_duplicate tensor(-0.4301, dtype=torch.float64) tensor(1.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3869, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
3 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-3.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0707, dtype=torch.float64) delta_t tensor(-0.1293, dtype=torch.float64)
2 gae_duplicate tensor(-0.4977, dtype=torch.float64) tensor(2.5991, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:261.1326904296875
value loss:7.944852352142334
entropies:342.5870056152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.290882110595703 seconds
19 rew tensor(1.1088, dtype=torch.float64) delta_t tensor(-0.0742, dtype=torch.float64)
19 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(1.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(-0.2302, dtype=torch.float64)
18 gae_duplicate tensor(-1.5673, dtype=torch.float64) tensor(4.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0074, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
17 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(0.7811, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9436, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
16 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(1.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
15 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(0.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
14 gae_duplicate tensor(0.0536, dtype=torch.float64) tensor(-3.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
13 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-1.8887, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3559, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
12 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(-0.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4220, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
11 gae_duplicate tensor(-0.3245, dtype=torch.float64) tensor(-0.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0146, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
10 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(1.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2799, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
9 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-1.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4467, dtype=torch.float64) delta_t tensor(-0.0979, dtype=torch.float64)
8 gae_duplicate tensor(-0.1900, dtype=torch.float64) tensor(1.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6267, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
7 gae_duplicate tensor(-0.3754, dtype=torch.float64) tensor(0.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5109, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
6 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-1.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5207, dtype=torch.float64) delta_t tensor(-0.1701, dtype=torch.float64)
5 gae_duplicate tensor(-0.5071, dtype=torch.float64) tensor(3.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0906, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
4 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(0.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8315, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
3 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(0.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(-0.1198, dtype=torch.float64)
2 gae_duplicate tensor(-0.4538, dtype=torch.float64) tensor(2.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-603.8766479492188
value loss:7.783365249633789
entropies:342.38787841796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0445427894592285 seconds
19 rew tensor(1.1978, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
19 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(0.9775, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1603, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
18 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-1.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1222, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
17 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(-0.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0337, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
16 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-0.2014, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9452, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
15 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
14 gae_duplicate tensor(-1.1424, dtype=torch.float64) tensor(-2.0980, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0303, dtype=torch.float64) delta_t tensor(-0.4334, dtype=torch.float64)
13 gae_duplicate tensor(-2.7598, dtype=torch.float64) tensor(7.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0839, dtype=torch.float64) delta_t tensor(-0.1623, dtype=torch.float64)
12 gae_duplicate tensor(-1.6669, dtype=torch.float64) tensor(3.7648, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3583, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
11 gae_duplicate tensor(-0.1002, dtype=torch.float64) tensor(-1.3119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
10 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(-1.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
9 gae_duplicate tensor(0.0380, dtype=torch.float64) tensor(-2.9908, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5504, dtype=torch.float64) delta_t tensor(-0.2064, dtype=torch.float64)
8 gae_duplicate tensor(-0.3773, dtype=torch.float64) tensor(3.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9268, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
7 gae_duplicate tensor(-0.4900, dtype=torch.float64) tensor(1.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6142, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
6 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(-1.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6456, dtype=torch.float64) delta_t tensor(-0.0275, dtype=torch.float64)
5 gae_duplicate tensor(-0.3325, dtype=torch.float64) tensor(0.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0591, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
4 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-0.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2220, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
3 gae_duplicate tensor(-0.4990, dtype=torch.float64) tensor(3.2211, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4040, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
2 gae_duplicate tensor(-0.2535, dtype=torch.float64) tensor(-1.3630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-385.7327575683594
value loss:24.202438354492188
entropies:342.1765441894531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3836.1497)
ToM Target loss= tensor(3958.8882)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.774073123931885 seconds
19 rew tensor(1.1735, dtype=torch.float64) delta_t tensor(-0.0542, dtype=torch.float64)
19 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(1.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1866, dtype=torch.float64) delta_t tensor(0.1087, dtype=torch.float64)
18 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-1.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0588, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
17 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-0.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
16 gae_duplicate tensor(-0.1799, dtype=torch.float64) tensor(0.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(0.1988, dtype=torch.float64)
15 gae_duplicate tensor(-0.0664, dtype=torch.float64) tensor(-3.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3543, dtype=torch.float64) delta_t tensor(-0.0329, dtype=torch.float64)
14 gae_duplicate tensor(-1.1372, dtype=torch.float64) tensor(0.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6272, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
13 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-2.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2533, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
12 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(-0.8599, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(0.1640, dtype=torch.float64)
11 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-3.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
10 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(0.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
9 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(-2.5898, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6660, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
8 gae_duplicate tensor(-0.3249, dtype=torch.float64) tensor(1.9138, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4545, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
7 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(-0.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7423, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
6 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-1.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3395, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
5 gae_duplicate tensor(-0.1386, dtype=torch.float64) tensor(-0.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0941, dtype=torch.float64) delta_t tensor(0.0568, dtype=torch.float64)
4 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-1.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8391, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
3 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(0.2255, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2633, dtype=torch.float64) delta_t tensor(0.1907, dtype=torch.float64)
2 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-3.4236, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:845.1211547851562
value loss:8.028331756591797
entropies:342.1309509277344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.633349180221558 seconds
19 rew tensor(1.1724, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
19 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(0.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1855, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
18 gae_duplicate tensor(-0.0064, dtype=torch.float64) tensor(-2.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.0158, dtype=torch.float64)
17 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(-0.6468, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8669, dtype=torch.float64) delta_t tensor(-0.1384, dtype=torch.float64)
16 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(2.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7656, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
15 gae_duplicate tensor(-0.1214, dtype=torch.float64) tensor(-1.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7269, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
14 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-2.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5386, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
13 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(-0.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3545, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
12 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(0.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3226, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
11 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(-0.9097, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2119, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
10 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-1.1987, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0414, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
9 gae_duplicate tensor(-0.2464, dtype=torch.float64) tensor(-1.7757, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4496, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
8 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(1.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9761, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
7 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-0.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5389, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
6 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-0.3696, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6708, dtype=torch.float64) delta_t tensor(-0.0877, dtype=torch.float64)
5 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(1.5104, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1091, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
4 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(-1.4359, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1962, dtype=torch.float64) delta_t tensor(-0.1318, dtype=torch.float64)
3 gae_duplicate tensor(-0.2901, dtype=torch.float64) tensor(2.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4669, dtype=torch.float64) delta_t tensor(0.1118, dtype=torch.float64)
2 gae_duplicate tensor(-0.2810, dtype=torch.float64) tensor(-1.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:223.9163360595703
value loss:4.0553412437438965
entropies:342.04937744140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7689149379730225 seconds
19 rew tensor(1.1999, dtype=torch.float64) delta_t tensor(0.0023, dtype=torch.float64)
19 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-0.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1484, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
18 gae_duplicate tensor(-0.0370, dtype=torch.float64) tensor(-1.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0341, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
17 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(0.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
16 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(1.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9318, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
15 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(-2.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1025, dtype=torch.float64) delta_t tensor(-0.5411, dtype=torch.float64)
14 gae_duplicate tensor(-2.7085, dtype=torch.float64) tensor(12.9779, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7024, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
13 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(-2.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1778, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
12 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(-1.1380, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
11 gae_duplicate tensor(-0.2446, dtype=torch.float64) tensor(-1.7102, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0907, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
10 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(-0.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3969, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
9 gae_duplicate tensor(-0.2321, dtype=torch.float64) tensor(-1.6823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6279, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
8 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(1.4297, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5221, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
7 gae_duplicate tensor(0.0265, dtype=torch.float64) tensor(-3.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
6 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-2.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4442, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
5 gae_duplicate tensor(-0.4743, dtype=torch.float64) tensor(0.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0930, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
4 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(0.7010, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9448, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
3 gae_duplicate tensor(-0.3458, dtype=torch.float64) tensor(1.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2388, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
2 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(1.0490, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-324.12322998046875
value loss:17.813142776489258
entropies:341.91485595703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.677526950836182 seconds
19 rew tensor(1.1735, dtype=torch.float64) delta_t tensor(-0.0436, dtype=torch.float64)
19 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(0.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1737, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
18 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-1.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0592, dtype=torch.float64) delta_t tensor(0.0009, dtype=torch.float64)
17 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-0.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0467, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
16 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(-0.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9572, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
15 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-1.5354, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5024, dtype=torch.float64) delta_t tensor(-0.2093, dtype=torch.float64)
14 gae_duplicate tensor(-1.0625, dtype=torch.float64) tensor(5.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(-0.0907, dtype=torch.float64)
13 gae_duplicate tensor(-1.1529, dtype=torch.float64) tensor(1.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0765, dtype=torch.float64) delta_t tensor(-0.1622, dtype=torch.float64)
12 gae_duplicate tensor(-1.0885, dtype=torch.float64) tensor(4.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2200, dtype=torch.float64) delta_t tensor(-0.6139, dtype=torch.float64)
11 gae_duplicate tensor(-4.2417, dtype=torch.float64) tensor(11.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0122, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
10 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-1.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
9 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(-2.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(-0.1181, dtype=torch.float64)
8 gae_duplicate tensor(-0.5194, dtype=torch.float64) tensor(1.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9902, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
7 gae_duplicate tensor(-1.4914, dtype=torch.float64) tensor(4.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8188, dtype=torch.float64) delta_t tensor(-0.0987, dtype=torch.float64)
6 gae_duplicate tensor(-0.4654, dtype=torch.float64) tensor(1.9319, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4466, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
5 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(-2.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0891, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
4 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(-1.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2050, dtype=torch.float64) delta_t tensor(-0.1192, dtype=torch.float64)
3 gae_duplicate tensor(-0.5676, dtype=torch.float64) tensor(1.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
2 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-2.4874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1142.2657470703125
value loss:42.48931884765625
entropies:341.55889892578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.672417163848877 seconds
19 rew tensor(1.1102, dtype=torch.float64) delta_t tensor(-0.0726, dtype=torch.float64)
19 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(1.3106, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1230, dtype=torch.float64) delta_t tensor(0.1004, dtype=torch.float64)
18 gae_duplicate tensor(0.0144, dtype=torch.float64) tensor(-1.6854, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0721, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
17 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(-0.5250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8676, dtype=torch.float64) delta_t tensor(-0.0936, dtype=torch.float64)
16 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(1.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
15 gae_duplicate tensor(-0.0804, dtype=torch.float64) tensor(-2.8601, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6642, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
14 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-4.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4165, dtype=torch.float64) delta_t tensor(-0.3226, dtype=torch.float64)
13 gae_duplicate tensor(-2.5584, dtype=torch.float64) tensor(9.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2869, dtype=torch.float64) delta_t tensor(-0.5413, dtype=torch.float64)
12 gae_duplicate tensor(-2.5300, dtype=torch.float64) tensor(10.7565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4057, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
11 gae_duplicate tensor(-1.5337, dtype=torch.float64) tensor(2.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0770, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
10 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(-0.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3450, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
9 gae_duplicate tensor(-0.1692, dtype=torch.float64) tensor(0.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5383, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
8 gae_duplicate tensor(-0.3770, dtype=torch.float64) tensor(0.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1583, dtype=torch.float64) delta_t tensor(-0.6834, dtype=torch.float64)
7 gae_duplicate tensor(-3.9682, dtype=torch.float64) tensor(12.6858, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7190, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
6 gae_duplicate tensor(-0.5135, dtype=torch.float64) tensor(1.9178, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3159, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
5 gae_duplicate tensor(-0.6248, dtype=torch.float64) tensor(2.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1679, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
4 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-0.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7698, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
3 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(1.3310, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2023, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
2 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(-1.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1887.6656494140625
value loss:52.4569091796875
entropies:341.0644836425781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3871.1184)
ToM Target loss= tensor(3957.6599)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.702617645263672 seconds
19 rew tensor(1.1858, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
19 gae_duplicate tensor(-0.0806, dtype=torch.float64) tensor(0.0955, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1359, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
18 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.4202, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
17 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(0.8380, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9695, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
16 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(0.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8291, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
15 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(0.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6514, dtype=torch.float64) delta_t tensor(0.2510, dtype=torch.float64)
14 gae_duplicate tensor(0.0837, dtype=torch.float64) tensor(-4.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7024, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
13 gae_duplicate tensor(0.0770, dtype=torch.float64) tensor(-2.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2055, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
12 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-0.5459, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5999, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
11 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-1.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(-0.0666, dtype=torch.float64)
10 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(1.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
9 gae_duplicate tensor(-0.2246, dtype=torch.float64) tensor(-2.9813, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4971, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
8 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(0.8570, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4598, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
7 gae_duplicate tensor(-0.0499, dtype=torch.float64) tensor(-1.8126, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9081, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
6 gae_duplicate tensor(-0.2764, dtype=torch.float64) tensor(-0.0507, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0344, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
5 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-0.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2718, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
4 gae_duplicate tensor(-0.4945, dtype=torch.float64) tensor(1.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3283, dtype=torch.float64) delta_t tensor(0.2749, dtype=torch.float64)
3 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(-5.6564, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1329, dtype=torch.float64) delta_t tensor(-0.2066, dtype=torch.float64)
2 gae_duplicate tensor(-0.7843, dtype=torch.float64) tensor(3.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:634.3509521484375
value loss:7.879179000854492
entropies:340.457275390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.782043933868408 seconds
19 rew tensor(1.0965, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
19 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(0.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0586, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
18 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-0.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0215, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
17 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-0.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9577, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
16 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(0.4424, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8677, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
15 gae_duplicate tensor(-0.1383, dtype=torch.float64) tensor(-0.8938, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
14 gae_duplicate tensor(0.0609, dtype=torch.float64) tensor(-2.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
13 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-2.9865, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3198, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
12 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-0.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3434, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
11 gae_duplicate tensor(-0.0280, dtype=torch.float64) tensor(-0.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0121, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
10 gae_duplicate tensor(-0.2104, dtype=torch.float64) tensor(1.3680, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2532, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
9 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-3.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4463, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
8 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(2.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9907, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
7 gae_duplicate tensor(-0.2412, dtype=torch.float64) tensor(0.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5368, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
6 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(-2.8478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6529, dtype=torch.float64) delta_t tensor(-0.0824, dtype=torch.float64)
5 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(1.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1164, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
4 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-0.6845, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1694, dtype=torch.float64) delta_t tensor(-0.1067, dtype=torch.float64)
3 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(1.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4871, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
2 gae_duplicate tensor(-0.4510, dtype=torch.float64) tensor(-0.8477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:272.430419921875
value loss:4.373955249786377
entropies:339.9831237792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.949066877365112 seconds
19 rew tensor(1.2113, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
19 gae_duplicate tensor(-0.0991, dtype=torch.float64) tensor(0.7765, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2120, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
18 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-2.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0584, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
17 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(-0.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9687, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
16 gae_duplicate tensor(-0.0587, dtype=torch.float64) tensor(0.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8676, dtype=torch.float64) delta_t tensor(-0.0796, dtype=torch.float64)
15 gae_duplicate tensor(-0.3133, dtype=torch.float64) tensor(1.4258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6634, dtype=torch.float64) delta_t tensor(0.3007, dtype=torch.float64)
14 gae_duplicate tensor(0.1193, dtype=torch.float64) tensor(-5.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6246, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
13 gae_duplicate tensor(0.0440, dtype=torch.float64) tensor(-2.4902, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3046, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
12 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-2.8980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
11 gae_duplicate tensor(-0.3170, dtype=torch.float64) tensor(-2.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1666, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
10 gae_duplicate tensor(-0.2584, dtype=torch.float64) tensor(1.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5112, dtype=torch.float64) delta_t tensor(0.3122, dtype=torch.float64)
9 gae_duplicate tensor(0.1651, dtype=torch.float64) tensor(-5.4808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(-0.2857, dtype=torch.float64)
8 gae_duplicate tensor(-0.4918, dtype=torch.float64) tensor(4.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5180, dtype=torch.float64) delta_t tensor(-0.3370, dtype=torch.float64)
7 gae_duplicate tensor(-2.7184, dtype=torch.float64) tensor(5.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7801, dtype=torch.float64) delta_t tensor(-0.1660, dtype=torch.float64)
6 gae_duplicate tensor(-0.6726, dtype=torch.float64) tensor(4.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5462, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
5 gae_duplicate tensor(-0.1575, dtype=torch.float64) tensor(-2.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2622, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
4 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-2.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4520, dtype=torch.float64) delta_t tensor(-0.1744, dtype=torch.float64)
3 gae_duplicate tensor(-0.4890, dtype=torch.float64) tensor(3.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6201, dtype=torch.float64) delta_t tensor(0.2579, dtype=torch.float64)
2 gae_duplicate tensor(0.0437, dtype=torch.float64) tensor(-4.3374, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:327.7286682128906
value loss:20.23859405517578
entropies:339.60565185546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.671814203262329 seconds
19 rew tensor(1.1866, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-0.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0839, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
18 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-1.6730, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9698, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
17 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(0.8555, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9692, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
16 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(0.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8037, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
15 gae_duplicate tensor(-0.1576, dtype=torch.float64) tensor(-0.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.1800, dtype=torch.float64)
14 gae_duplicate tensor(0.0480, dtype=torch.float64) tensor(-3.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6502, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
13 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-3.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
12 gae_duplicate tensor(-0.1066, dtype=torch.float64) tensor(0.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3041, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
11 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-1.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0639, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
10 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(1.8284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2275, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
9 gae_duplicate tensor(0.0613, dtype=torch.float64) tensor(-3.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3196, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
8 gae_duplicate tensor(-0.2040, dtype=torch.float64) tensor(1.1682, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0296, dtype=torch.float64) delta_t tensor(-0.0608, dtype=torch.float64)
7 gae_duplicate tensor(-0.3130, dtype=torch.float64) tensor(1.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5481, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
6 gae_duplicate tensor(-0.3362, dtype=torch.float64) tensor(-1.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6549, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
5 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(1.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0403, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
4 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(0.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0946, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
3 gae_duplicate tensor(-0.3973, dtype=torch.float64) tensor(1.5592, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3977, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
2 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-1.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:398.7444152832031
value loss:4.776366233825684
entropies:339.1900329589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.554771900177002 seconds
19 rew tensor(1.1097, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
19 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(1.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1100, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
18 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-0.9550, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0331, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
17 gae_duplicate tensor(-0.1589, dtype=torch.float64) tensor(-0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9317, dtype=torch.float64) delta_t tensor(-0.0414, dtype=torch.float64)
16 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(0.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8426, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
15 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(-2.1969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(-0.1736, dtype=torch.float64)
14 gae_duplicate tensor(-1.3935, dtype=torch.float64) tensor(2.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4848, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
13 gae_duplicate tensor(-1.3479, dtype=torch.float64) tensor(2.7339, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3301, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
12 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(0.8470, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
11 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(-0.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0872, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
10 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-0.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1529, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
9 gae_duplicate tensor(-0.2447, dtype=torch.float64) tensor(-0.0470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4750, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
8 gae_duplicate tensor(-0.3517, dtype=torch.float64) tensor(0.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5747, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
7 gae_duplicate tensor(-0.2428, dtype=torch.float64) tensor(1.5542, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5774, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
6 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-3.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4961, dtype=torch.float64) delta_t tensor(-0.2110, dtype=torch.float64)
5 gae_duplicate tensor(-0.6623, dtype=torch.float64) tensor(4.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0921, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
4 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-1.5266, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8575, dtype=torch.float64) delta_t tensor(-0.1098, dtype=torch.float64)
3 gae_duplicate tensor(-0.4703, dtype=torch.float64) tensor(1.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(0.0946, dtype=torch.float64)
2 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-1.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-436.29705810546875
value loss:11.29249095916748
entropies:338.9557189941406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3831.7058)
ToM Target loss= tensor(3956.2280)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.005786895751953 seconds
19 rew tensor(1.1350, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
19 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(1.4744, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1485, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
18 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-1.5015, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0851, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
17 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
16 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(0.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9715, dtype=torch.float64) delta_t tensor(0.1642, dtype=torch.float64)
15 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(-3.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(-0.5732, dtype=torch.float64)
14 gae_duplicate tensor(-2.3460, dtype=torch.float64) tensor(9.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5203, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
13 gae_duplicate tensor(-1.1005, dtype=torch.float64) tensor(0.5864, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2051, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
12 gae_duplicate tensor(-0.1221, dtype=torch.float64) tensor(-0.6692, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
11 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-2.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1415, dtype=torch.float64) delta_t tensor(-0.0827, dtype=torch.float64)
10 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(1.4910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5338, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
9 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(-2.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6651, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
8 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(1.5260, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8399, dtype=torch.float64) delta_t tensor(-0.3378, dtype=torch.float64)
7 gae_duplicate tensor(-2.0406, dtype=torch.float64) tensor(6.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8712, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
6 gae_duplicate tensor(-0.6928, dtype=torch.float64) tensor(1.0669, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2437, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
5 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-2.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1917, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
4 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-0.3894, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8114, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
3 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-1.0720, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1533, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
2 gae_duplicate tensor(-0.3724, dtype=torch.float64) tensor(0.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-567.4407958984375
value loss:24.49683380126953
entropies:338.6566162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.757143020629883 seconds
19 rew tensor(1.2382, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
19 gae_duplicate tensor(-0.0948, dtype=torch.float64) tensor(0.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1616, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
18 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-0.4962, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1365, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
17 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-1.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7822, dtype=torch.float64) delta_t tensor(-0.1902, dtype=torch.float64)
16 gae_duplicate tensor(-1.4911, dtype=torch.float64) tensor(3.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8685, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
15 gae_duplicate tensor(-0.3512, dtype=torch.float64) tensor(-1.8221, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1520, dtype=torch.float64) delta_t tensor(-0.6059, dtype=torch.float64)
14 gae_duplicate tensor(-2.5898, dtype=torch.float64) tensor(10.8875, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3102, dtype=torch.float64) delta_t tensor(-0.1555, dtype=torch.float64)
13 gae_duplicate tensor(-1.3160, dtype=torch.float64) tensor(4.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
12 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(-1.6196, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3709, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
11 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-0.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0608, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
10 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-0.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3576, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
9 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-1.8373, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5257, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
8 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(1.5479, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6162, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
7 gae_duplicate tensor(-0.4081, dtype=torch.float64) tensor(-0.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6544, dtype=torch.float64) delta_t tensor(0.2817, dtype=torch.float64)
6 gae_duplicate tensor(-0.1019, dtype=torch.float64) tensor(-6.0465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4716, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
5 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(-1.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0911, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
4 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-0.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9356, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
3 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(0.7864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
2 gae_duplicate tensor(-0.3453, dtype=torch.float64) tensor(1.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-446.8869934082031
value loss:25.593107223510742
entropies:338.5655517578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.897471189498901 seconds
19 rew tensor(1.0845, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
19 gae_duplicate tensor(-0.1775, dtype=torch.float64) tensor(1.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0979, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
18 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-0.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(-0.2220, dtype=torch.float64)
17 gae_duplicate tensor(-1.5508, dtype=torch.float64) tensor(3.9689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9957, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
16 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-0.6970, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
15 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(0.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7526, dtype=torch.float64) delta_t tensor(0.2109, dtype=torch.float64)
14 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-3.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7029, dtype=torch.float64) delta_t tensor(0.2240, dtype=torch.float64)
13 gae_duplicate tensor(-0.0610, dtype=torch.float64) tensor(-4.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.1678, dtype=torch.float64)
12 gae_duplicate tensor(-0.0406, dtype=torch.float64) tensor(-3.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
11 gae_duplicate tensor(-0.3127, dtype=torch.float64) tensor(-0.0419, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0408, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
10 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(1.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2558, dtype=torch.float64) delta_t tensor(0.0648, dtype=torch.float64)
9 gae_duplicate tensor(-0.2991, dtype=torch.float64) tensor(-1.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4628, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
8 gae_duplicate tensor(-0.3361, dtype=torch.float64) tensor(1.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5217, dtype=torch.float64) delta_t tensor(-0.6061, dtype=torch.float64)
7 gae_duplicate tensor(-3.7096, dtype=torch.float64) tensor(11.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6560, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
6 gae_duplicate tensor(-1.1680, dtype=torch.float64) tensor(0.2176, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5731, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
5 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-0.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0097, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
4 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-1.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1397, dtype=torch.float64) delta_t tensor(-0.1030, dtype=torch.float64)
3 gae_duplicate tensor(-0.3239, dtype=torch.float64) tensor(2.1456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3676, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
2 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(-1.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-274.86444091796875
value loss:34.583072662353516
entropies:338.44354248046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.007493019104004 seconds
19 rew tensor(1.1737, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
19 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(0.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1362, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
18 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-1.3639, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0982, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
17 gae_duplicate tensor(-0.0561, dtype=torch.float64) tensor(-0.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0215, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
16 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-0.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
15 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(-1.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6880, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
14 gae_duplicate tensor(-0.1496, dtype=torch.float64) tensor(-1.4727, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3611, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
13 gae_duplicate tensor(-1.0088, dtype=torch.float64) tensor(1.9619, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0386, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
12 gae_duplicate tensor(-0.6315, dtype=torch.float64) tensor(2.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4611, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
11 gae_duplicate tensor(-0.0912, dtype=torch.float64) tensor(-0.7717, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0217, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
10 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-0.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4473, dtype=torch.float64) delta_t tensor(0.1967, dtype=torch.float64)
9 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(-3.5660, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7054, dtype=torch.float64) delta_t tensor(-0.1409, dtype=torch.float64)
8 gae_duplicate tensor(-0.5229, dtype=torch.float64) tensor(2.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8593, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
7 gae_duplicate tensor(-1.4641, dtype=torch.float64) tensor(3.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8989, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
6 gae_duplicate tensor(-0.4634, dtype=torch.float64) tensor(-0.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2903, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
5 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-1.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1182, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
4 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(-1.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9076, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
3 gae_duplicate tensor(-0.5393, dtype=torch.float64) tensor(-0.1400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1886, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
2 gae_duplicate tensor(-0.3881, dtype=torch.float64) tensor(1.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:85.76958465576172
value loss:12.111225128173828
entropies:338.37945556640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.095882892608643 seconds
19 rew tensor(1.2120, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
19 gae_duplicate tensor(-0.0551, dtype=torch.float64) tensor(0.1144, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1609, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
18 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(-2.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0470, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
17 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(-0.2101, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9582, dtype=torch.float64) delta_t tensor(-0.0176, dtype=torch.float64)
16 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9071, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
15 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-0.2559, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
14 gae_duplicate tensor(-1.3116, dtype=torch.float64) tensor(1.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6508, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
13 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-3.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2682, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
12 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-0.2219, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(-0.5191, dtype=torch.float64)
11 gae_duplicate tensor(-3.2208, dtype=torch.float64) tensor(9.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1288, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
10 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(0.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
9 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.4409, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6425, dtype=torch.float64) delta_t tensor(-0.1184, dtype=torch.float64)
8 gae_duplicate tensor(-0.3452, dtype=torch.float64) tensor(1.9535, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6510, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
7 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-4.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7063, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
6 gae_duplicate tensor(0.1088, dtype=torch.float64) tensor(-3.9579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4966, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
5 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(-0.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0158, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
4 gae_duplicate tensor(-0.3527, dtype=torch.float64) tensor(0.9483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0500, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
3 gae_duplicate tensor(-0.2522, dtype=torch.float64) tensor(0.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3419, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
2 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-2.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:110.01469421386719
value loss:23.44097900390625
entropies:338.4150085449219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3820.4233)
ToM Target loss= tensor(3946.9756)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.6802568435668945 seconds
19 rew tensor(1.1865, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
19 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(0.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1994, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
18 gae_duplicate tensor(-0.0080, dtype=torch.float64) tensor(-2.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2120, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
17 gae_duplicate tensor(0.0158, dtype=torch.float64) tensor(-4.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0586, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
16 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-1.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0460, dtype=torch.float64) delta_t tensor(0.2254, dtype=torch.float64)
15 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-4.7319, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5195, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
14 gae_duplicate tensor(-0.6808, dtype=torch.float64) tensor(1.2019, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
13 gae_duplicate tensor(0.0403, dtype=torch.float64) tensor(-2.9134, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1509, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
12 gae_duplicate tensor(-0.9775, dtype=torch.float64) tensor(2.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7048, dtype=torch.float64) delta_t tensor(0.2255, dtype=torch.float64)
11 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-4.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5649, dtype=torch.float64) delta_t tensor(-0.4430, dtype=torch.float64)
10 gae_duplicate tensor(-1.8052, dtype=torch.float64) tensor(7.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6753, dtype=torch.float64) delta_t tensor(-0.8726, dtype=torch.float64)
9 gae_duplicate tensor(-6.3009, dtype=torch.float64) tensor(16.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8598, dtype=torch.float64) delta_t tensor(-0.3696, dtype=torch.float64)
8 gae_duplicate tensor(-1.7849, dtype=torch.float64) tensor(8.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2145, dtype=torch.float64) delta_t tensor(-0.2048, dtype=torch.float64)
7 gae_duplicate tensor(-2.5724, dtype=torch.float64) tensor(3.9346, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9894, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
6 gae_duplicate tensor(-0.8302, dtype=torch.float64) tensor(1.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3397, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
5 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(-1.4277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0440, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
4 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(-0.5608, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1609, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
3 gae_duplicate tensor(-0.4357, dtype=torch.float64) tensor(-0.3592, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3012, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
2 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(-1.3954, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1081.0772705078125
value loss:92.29049682617188
entropies:338.3705749511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.503597974777222 seconds
19 rew tensor(1.1347, dtype=torch.float64) delta_t tensor(-0.0591, dtype=torch.float64)
19 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(1.1785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1478, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
18 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(-1.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.6001, dtype=torch.float64) delta_t tensor(-0.4610, dtype=torch.float64)
17 gae_duplicate tensor(-1.5252, dtype=torch.float64) tensor(8.3261, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0467, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
16 gae_duplicate tensor(-0.2211, dtype=torch.float64) tensor(0.4024, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(-0.1165, dtype=torch.float64)
15 gae_duplicate tensor(-1.3404, dtype=torch.float64) tensor(2.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5344, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
14 gae_duplicate tensor(-1.0495, dtype=torch.float64) tensor(0.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7264, dtype=torch.float64) delta_t tensor(0.2747, dtype=torch.float64)
13 gae_duplicate tensor(0.0337, dtype=torch.float64) tensor(-5.6631, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2934, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
12 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-1.8864, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
11 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-2.6068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1274, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
10 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(0.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3695, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
9 gae_duplicate tensor(-0.2033, dtype=torch.float64) tensor(-1.3727, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5634, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
8 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(0.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0537, dtype=torch.float64) delta_t tensor(-0.7184, dtype=torch.float64)
7 gae_duplicate tensor(-3.5797, dtype=torch.float64) tensor(17.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7959, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
6 gae_duplicate tensor(-0.9665, dtype=torch.float64) tensor(3.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6228, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
5 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-2.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2177, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
4 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-0.8492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5133, dtype=torch.float64) delta_t tensor(-0.1169, dtype=torch.float64)
3 gae_duplicate tensor(-0.5220, dtype=torch.float64) tensor(2.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
2 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(-1.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1105.508544921875
value loss:39.89891052246094
entropies:338.42730712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.937791109085083 seconds
19 rew tensor(1.0825, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
19 gae_duplicate tensor(-0.2177, dtype=torch.float64) tensor(0.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
18 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-1.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0829, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
17 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-0.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0321, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
16 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-0.9229, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9301, dtype=torch.float64) delta_t tensor(0.2086, dtype=torch.float64)
15 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(-3.8886, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7522, dtype=torch.float64) delta_t tensor(0.1641, dtype=torch.float64)
14 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-4.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3472, dtype=torch.float64) delta_t tensor(-0.1553, dtype=torch.float64)
13 gae_duplicate tensor(-1.3927, dtype=torch.float64) tensor(2.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3690, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
12 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-2.2842, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5241, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
11 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(-1.8035, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1416, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
10 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(-0.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
9 gae_duplicate tensor(0.0200, dtype=torch.float64) tensor(-3.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6006, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
8 gae_duplicate tensor(-0.3700, dtype=torch.float64) tensor(1.5328, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3062, dtype=torch.float64) delta_t tensor(-0.5983, dtype=torch.float64)
7 gae_duplicate tensor(-4.1621, dtype=torch.float64) tensor(17.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8046, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
6 gae_duplicate tensor(-0.9608, dtype=torch.float64) tensor(2.2727, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3176, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
5 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(0.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1398, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
4 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8094, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
3 gae_duplicate tensor(-0.5092, dtype=torch.float64) tensor(-2.2769, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2173, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
2 gae_duplicate tensor(-0.2721, dtype=torch.float64) tensor(0.3798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-277.7350769042969
value loss:39.84091567993164
entropies:338.2879943847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.869279146194458 seconds
19 rew tensor(1.1976, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
19 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(0.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1345, dtype=torch.float64) delta_t tensor(0.0690, dtype=torch.float64)
18 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-1.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0584, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
17 gae_duplicate tensor(-0.2131, dtype=torch.float64) tensor(0.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
16 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(0.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
15 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-2.0592, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6504, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
14 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(-1.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7636, dtype=torch.float64) delta_t tensor(0.2763, dtype=torch.float64)
13 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(-5.0908, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2048, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
12 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(1.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
11 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-0.7571, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0132, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
10 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(0.3960, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1900, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
9 gae_duplicate tensor(-0.2929, dtype=torch.float64) tensor(-0.7071, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4215, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
8 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(-0.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8549, dtype=torch.float64) delta_t tensor(0.1004, dtype=torch.float64)
7 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-1.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
6 gae_duplicate tensor(-0.1597, dtype=torch.float64) tensor(-3.5377, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5949, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
5 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-0.6547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0651, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
4 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(0.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0471, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
3 gae_duplicate tensor(-0.1626, dtype=torch.float64) tensor(-0.2105, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
2 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(1.5026, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:586.3157958984375
value loss:5.240894794464111
entropies:337.8833312988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.69325590133667 seconds
19 rew tensor(1.1473, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
19 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(1.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(-0.2786, dtype=torch.float64)
18 gae_duplicate tensor(-1.5826, dtype=torch.float64) tensor(5.0787, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0710, dtype=torch.float64) delta_t tensor(-0.0197, dtype=torch.float64)
17 gae_duplicate tensor(-0.2749, dtype=torch.float64) tensor(0.8969, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1092, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
16 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-0.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9440, dtype=torch.float64) delta_t tensor(-0.1283, dtype=torch.float64)
15 gae_duplicate tensor(-0.3234, dtype=torch.float64) tensor(2.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5735, dtype=torch.float64) delta_t tensor(-0.0988, dtype=torch.float64)
14 gae_duplicate tensor(-1.0078, dtype=torch.float64) tensor(1.7512, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
13 gae_duplicate tensor(-1.1975, dtype=torch.float64) tensor(1.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(0.1866, dtype=torch.float64)
12 gae_duplicate tensor(-0.2094, dtype=torch.float64) tensor(-3.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0540, dtype=torch.float64) delta_t tensor(-0.4719, dtype=torch.float64)
11 gae_duplicate tensor(-2.8653, dtype=torch.float64) tensor(7.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5261, dtype=torch.float64) delta_t tensor(-0.3313, dtype=torch.float64)
10 gae_duplicate tensor(-2.3143, dtype=torch.float64) tensor(6.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1379, dtype=torch.float64) delta_t tensor(-0.2018, dtype=torch.float64)
9 gae_duplicate tensor(-1.8542, dtype=torch.float64) tensor(4.4053, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4735, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
8 gae_duplicate tensor(-0.2124, dtype=torch.float64) tensor(-0.8739, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5636, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
7 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-4.4262, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7787, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
6 gae_duplicate tensor(3.2635e-05, dtype=torch.float64) tensor(-4.0194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3182, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
5 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-3.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1407, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
4 gae_duplicate tensor(-0.3275, dtype=torch.float64) tensor(1.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7713, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
3 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(-1.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
2 gae_duplicate tensor(-0.3050, dtype=torch.float64) tensor(-0.1255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-921.9644775390625
value loss:40.59339141845703
entropies:337.2730407714844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3835.0356)
ToM Target loss= tensor(3938.5601)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.838330268859863 seconds
19 rew tensor(1.1603, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
19 gae_duplicate tensor(-0.1196, dtype=torch.float64) tensor(1.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1223, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
18 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-1.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7639, dtype=torch.float64) delta_t tensor(-0.2873, dtype=torch.float64)
17 gae_duplicate tensor(-1.5665, dtype=torch.float64) tensor(4.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8795, dtype=torch.float64) delta_t tensor(-0.1005, dtype=torch.float64)
16 gae_duplicate tensor(-0.2636, dtype=torch.float64) tensor(2.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8802, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
15 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-1.0140, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6750, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
14 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-1.7509, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
13 gae_duplicate tensor(-1.0143, dtype=torch.float64) tensor(1.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2413, dtype=torch.float64) delta_t tensor(0.1053, dtype=torch.float64)
12 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(-1.6374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
11 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(-1.0650, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0266, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
10 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-0.7295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3698, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
9 gae_duplicate tensor(-0.2997, dtype=torch.float64) tensor(-0.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5886, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
8 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(-0.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4584, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
7 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-1.5192, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6907, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
6 gae_duplicate tensor(-0.0948, dtype=torch.float64) tensor(-3.2743, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3916, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
5 gae_duplicate tensor(-0.3909, dtype=torch.float64) tensor(-2.1619, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0917, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
4 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(0.1794, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8936, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
3 gae_duplicate tensor(-0.3451, dtype=torch.float64) tensor(0.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2655, dtype=torch.float64) delta_t tensor(-0.1740, dtype=torch.float64)
2 gae_duplicate tensor(-0.3468, dtype=torch.float64) tensor(3.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.510103225708008
value loss:12.7426176071167
entropies:337.2563171386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6571009159088135 seconds
19 rew tensor(1.1220, dtype=torch.float64) delta_t tensor(-0.1134, dtype=torch.float64)
19 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(1.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1478, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
18 gae_duplicate tensor(-0.0292, dtype=torch.float64) tensor(-1.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
17 gae_duplicate tensor(-0.1730, dtype=torch.float64) tensor(1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9179, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
16 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(1.5389, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.2158, dtype=torch.float64)
15 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(-3.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4484, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
14 gae_duplicate tensor(-0.8026, dtype=torch.float64) tensor(1.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6772, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
13 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-1.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2928, dtype=torch.float64) delta_t tensor(0.1292, dtype=torch.float64)
12 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(-2.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6379, dtype=torch.float64) delta_t tensor(0.1421, dtype=torch.float64)
11 gae_duplicate tensor(0.0954, dtype=torch.float64) tensor(-2.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2175, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
10 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(1.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
9 gae_duplicate tensor(-0.2425, dtype=torch.float64) tensor(-0.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6011, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
8 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-1.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6244, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
7 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-5.0040, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7034, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
6 gae_duplicate tensor(-0.2509, dtype=torch.float64) tensor(-0.4950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4944, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
5 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-2.8499, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0410, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
4 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(0.1856, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0212, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
3 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-0.4691, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3166, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
2 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(0.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:751.8323364257812
value loss:7.290499687194824
entropies:337.03857421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.608850955963135 seconds
19 rew tensor(0.9531, dtype=torch.float64) delta_t tensor(-0.2483, dtype=torch.float64)
19 gae_duplicate tensor(-1.4588, dtype=torch.float64) tensor(4.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1234, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
18 gae_duplicate tensor(-0.0736, dtype=torch.float64) tensor(-0.6518, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7941, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
17 gae_duplicate tensor(-1.5250, dtype=torch.float64) tensor(4.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9576, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
16 gae_duplicate tensor(-0.2382, dtype=torch.float64) tensor(1.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
15 gae_duplicate tensor(-0.2904, dtype=torch.float64) tensor(-0.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3980, dtype=torch.float64) delta_t tensor(-0.2113, dtype=torch.float64)
14 gae_duplicate tensor(-1.4468, dtype=torch.float64) tensor(3.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.1608, dtype=torch.float64)
13 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-2.5796, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2016, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
12 gae_duplicate tensor(-1.4086, dtype=torch.float64) tensor(1.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(-0.1179, dtype=torch.float64)
11 gae_duplicate tensor(-0.5973, dtype=torch.float64) tensor(2.2002, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0372, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
10 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(-1.8966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
9 gae_duplicate tensor(-0.2395, dtype=torch.float64) tensor(0.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5766, dtype=torch.float64) delta_t tensor(0.1896, dtype=torch.float64)
8 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-3.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3709, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
7 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-2.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6662, dtype=torch.float64) delta_t tensor(0.3460, dtype=torch.float64)
6 gae_duplicate tensor(0.0898, dtype=torch.float64) tensor(-6.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4703, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
5 gae_duplicate tensor(-0.0515, dtype=torch.float64) tensor(-1.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2448, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
4 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-0.7551, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7936, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
3 gae_duplicate tensor(-0.3498, dtype=torch.float64) tensor(1.5248, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0873, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
2 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(2.4291, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-198.4349365234375
value loss:20.117721557617188
entropies:336.8694152832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.930872917175293 seconds
19 rew tensor(1.1361, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
19 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(1.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1748, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
18 gae_duplicate tensor(0.0134, dtype=torch.float64) tensor(-2.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0473, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-0.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
16 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(0.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8813, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
15 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-0.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
14 gae_duplicate tensor(-1.3079, dtype=torch.float64) tensor(2.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4085, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
13 gae_duplicate tensor(-1.1348, dtype=torch.float64) tensor(1.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2298, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
12 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-1.6062, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
11 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-0.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1668, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
10 gae_duplicate tensor(-0.3011, dtype=torch.float64) tensor(0.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(0.1486, dtype=torch.float64)
9 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-2.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
8 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(0.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3499, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
7 gae_duplicate tensor(-0.0862, dtype=torch.float64) tensor(-1.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8176, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
6 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(-0.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2190, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
5 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-0.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1911, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
4 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-0.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6960, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
3 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(-1.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1543, dtype=torch.float64) delta_t tensor(-0.0938, dtype=torch.float64)
2 gae_duplicate tensor(-0.3882, dtype=torch.float64) tensor(1.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:104.4984130859375
value loss:10.314095497131348
entropies:336.55230712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658302307128906 seconds
19 rew tensor(1.1233, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
19 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(0.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0982, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
18 gae_duplicate tensor(-0.0746, dtype=torch.float64) tensor(-2.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7533, dtype=torch.float64) delta_t tensor(-0.2339, dtype=torch.float64)
17 gae_duplicate tensor(-1.5043, dtype=torch.float64) tensor(3.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8818, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
16 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(0.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8684, dtype=torch.float64) delta_t tensor(0.1032, dtype=torch.float64)
15 gae_duplicate tensor(-0.1875, dtype=torch.float64) tensor(-1.7441, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5234, dtype=torch.float64) delta_t tensor(0.1943, dtype=torch.float64)
14 gae_duplicate tensor(0.0363, dtype=torch.float64) tensor(-3.6824, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8044, dtype=torch.float64) delta_t tensor(0.3120, dtype=torch.float64)
13 gae_duplicate tensor(0.0942, dtype=torch.float64) tensor(-6.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2045, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
12 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-0.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4705, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
11 gae_duplicate tensor(-0.0085, dtype=torch.float64) tensor(-1.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0264, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
10 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-1.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3816, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
9 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(1.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6656, dtype=torch.float64) delta_t tensor(0.0165, dtype=torch.float64)
8 gae_duplicate tensor(-0.0825, dtype=torch.float64) tensor(-0.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1395, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
7 gae_duplicate tensor(-0.0853, dtype=torch.float64) tensor(-1.3108, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8847, dtype=torch.float64) delta_t tensor(0.1973, dtype=torch.float64)
6 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(-3.6789, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0113, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
5 gae_duplicate tensor(-0.0389, dtype=torch.float64) tensor(-0.9787, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5013, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
4 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-0.8272, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2437, dtype=torch.float64) delta_t tensor(-0.0038, dtype=torch.float64)
3 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(-0.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2209, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
2 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(2.5428, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:884.2907104492188
value loss:10.495115280151367
entropies:336.3414306640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3834.9067)
ToM Target loss= tensor(3959.1113)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.885180950164795 seconds
19 rew tensor(1.1492, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
19 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-1.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0991, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
18 gae_duplicate tensor(0.0132, dtype=torch.float64) tensor(-2.3185, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0216, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
17 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-1.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9455, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
16 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(0.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8816, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
15 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-1.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7277, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
14 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-1.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5618, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
13 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-3.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2109, dtype=torch.float64) delta_t tensor(-0.1981, dtype=torch.float64)
12 gae_duplicate tensor(-1.4320, dtype=torch.float64) tensor(3.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0305, dtype=torch.float64) delta_t tensor(-0.3059, dtype=torch.float64)
11 gae_duplicate tensor(-2.0015, dtype=torch.float64) tensor(5.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(0.2578, dtype=torch.float64)
10 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-3.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
9 gae_duplicate tensor(-0.2671, dtype=torch.float64) tensor(-1.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6302, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(0.0738, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3552, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
7 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-1.9672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9234, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
6 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(-0.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0905, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
5 gae_duplicate tensor(-0.2917, dtype=torch.float64) tensor(0.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3366, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
4 gae_duplicate tensor(-0.3768, dtype=torch.float64) tensor(0.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5903, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
3 gae_duplicate tensor(-0.3743, dtype=torch.float64) tensor(0.0133, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0418, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
2 gae_duplicate tensor(-0.5976, dtype=torch.float64) tensor(-0.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:369.2789306640625
value loss:17.20466423034668
entropies:336.238525390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.752608060836792 seconds
19 rew tensor(1.1622, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
19 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-0.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2010, dtype=torch.float64) delta_t tensor(0.1961, dtype=torch.float64)
18 gae_duplicate tensor(0.0928, dtype=torch.float64) tensor(-3.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1107, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
17 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-2.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9830, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
16 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-1.8294, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
15 gae_duplicate tensor(-0.0231, dtype=torch.float64) tensor(-1.8111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
14 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-2.8094, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6264, dtype=torch.float64) delta_t tensor(0.1591, dtype=torch.float64)
13 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-3.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
12 gae_duplicate tensor(-1.0811, dtype=torch.float64) tensor(-0.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9581, dtype=torch.float64) delta_t tensor(-1.1768, dtype=torch.float64)
11 gae_duplicate tensor(-4.3166, dtype=torch.float64) tensor(20.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2141, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
10 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(-3.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3471, dtype=torch.float64) delta_t tensor(0.2463, dtype=torch.float64)
9 gae_duplicate tensor(-0.0166, dtype=torch.float64) tensor(-4.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7076, dtype=torch.float64) delta_t tensor(-0.1225, dtype=torch.float64)
8 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(1.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4553, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
7 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-2.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7842, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
6 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(-2.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3676, dtype=torch.float64) delta_t tensor(-0.1341, dtype=torch.float64)
5 gae_duplicate tensor(-0.2709, dtype=torch.float64) tensor(3.0377, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1464, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
4 gae_duplicate tensor(-0.3144, dtype=torch.float64) tensor(-0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8670, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
3 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(0.5701, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1992, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
2 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-1.7956, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:223.4446258544922
value loss:50.67091751098633
entropies:335.8995056152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.751780986785889 seconds
19 rew tensor(1.2006, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
19 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-0.5429, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2010, dtype=torch.float64) delta_t tensor(0.2122, dtype=torch.float64)
18 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-3.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7819, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
17 gae_duplicate tensor(-1.4352, dtype=torch.float64) tensor(5.3873, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
16 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-0.0338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
15 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-3.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6518, dtype=torch.float64) delta_t tensor(0.2364, dtype=torch.float64)
14 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-4.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
13 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-2.9822, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1519, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
12 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(-2.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5370, dtype=torch.float64) delta_t tensor(0.1316, dtype=torch.float64)
11 gae_duplicate tensor(0.0686, dtype=torch.float64) tensor(-2.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2324, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
10 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(0.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5767, dtype=torch.float64) delta_t tensor(0.2059, dtype=torch.float64)
9 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-3.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6813, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
8 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(-0.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4592, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
7 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-4.0582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8740, dtype=torch.float64) delta_t tensor(-0.1038, dtype=torch.float64)
6 gae_duplicate tensor(-0.4317, dtype=torch.float64) tensor(1.5423, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2918, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
5 gae_duplicate tensor(-0.0226, dtype=torch.float64) tensor(-1.3753, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1696, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
4 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(0.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8448, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
3 gae_duplicate tensor(-0.2627, dtype=torch.float64) tensor(1.0626, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1759, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
2 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-0.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1096.31298828125
value loss:9.550980567932129
entropies:336.0985412597656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.921617031097412 seconds
19 rew tensor(1.0849, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
19 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(0.4434, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1109, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
18 gae_duplicate tensor(0.0284, dtype=torch.float64) tensor(-2.5001, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0600, dtype=torch.float64) delta_t tensor(0.1337, dtype=torch.float64)
17 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-2.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6929, dtype=torch.float64) delta_t tensor(-0.2258, dtype=torch.float64)
16 gae_duplicate tensor(-1.4163, dtype=torch.float64) tensor(3.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
15 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-0.5528, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(-0.2699, dtype=torch.float64)
14 gae_duplicate tensor(-2.6189, dtype=torch.float64) tensor(4.9963, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7417, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
13 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(-4.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2553, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
12 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(0.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.1269, dtype=torch.float64)
11 gae_duplicate tensor(-0.1777, dtype=torch.float64) tensor(-2.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0662, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
10 gae_duplicate tensor(-0.1312, dtype=torch.float64) tensor(-0.3311, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2418, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
9 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(-0.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5780, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
8 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-1.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4735, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
7 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-3.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6419, dtype=torch.float64) delta_t tensor(0.1886, dtype=torch.float64)
6 gae_duplicate tensor(0.0679, dtype=torch.float64) tensor(-4.5795, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4479, dtype=torch.float64) delta_t tensor(-0.1385, dtype=torch.float64)
5 gae_duplicate tensor(-0.5192, dtype=torch.float64) tensor(1.9970, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
4 gae_duplicate tensor(-0.2421, dtype=torch.float64) tensor(1.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8328, dtype=torch.float64) delta_t tensor(-0.1813, dtype=torch.float64)
3 gae_duplicate tensor(-0.3907, dtype=torch.float64) tensor(3.3199, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2015, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
2 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(-0.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.67105102539062
value loss:19.090930938720703
entropies:336.393798828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.610414981842041 seconds
19 rew tensor(1.0859, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
19 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-0.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0859, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
18 gae_duplicate tensor(0.0336, dtype=torch.float64) tensor(-3.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0221, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
17 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-1.8461, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9201, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
16 gae_duplicate tensor(-0.0767, dtype=torch.float64) tensor(-1.0269, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
15 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(-1.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
14 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-2.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7676, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
13 gae_duplicate tensor(0.1130, dtype=torch.float64) tensor(-3.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3043, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
12 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(-0.9881, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4618, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
11 gae_duplicate tensor(-0.2742, dtype=torch.float64) tensor(-1.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0413, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
10 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(0.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1533, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
9 gae_duplicate tensor(-0.2224, dtype=torch.float64) tensor(-0.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5016, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
8 gae_duplicate tensor(-0.4813, dtype=torch.float64) tensor(2.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7419, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
7 gae_duplicate tensor(-0.4003, dtype=torch.float64) tensor(0.2057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6041, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
6 gae_duplicate tensor(-0.3271, dtype=torch.float64) tensor(0.5480, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5505, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
5 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(1.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0349, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
4 gae_duplicate tensor(-0.1010, dtype=torch.float64) tensor(-1.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0632, dtype=torch.float64) delta_t tensor(-0.1349, dtype=torch.float64)
3 gae_duplicate tensor(-0.6078, dtype=torch.float64) tensor(2.3085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
2 gae_duplicate tensor(-0.2731, dtype=torch.float64) tensor(-2.9628, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:605.6171875
value loss:5.516118049621582
entropies:336.7015686035156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3853.5322)
ToM Target loss= tensor(3956.8501)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.75304388999939 seconds
19 rew tensor(1.2396, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
19 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-2.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1500, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
18 gae_duplicate tensor(0.0908, dtype=torch.float64) tensor(-3.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0351, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
17 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-2.0456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0094, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
16 gae_duplicate tensor(0.0396, dtype=torch.float64) tensor(-1.9503, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
15 gae_duplicate tensor(-0.2514, dtype=torch.float64) tensor(0.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7548, dtype=torch.float64) delta_t tensor(0.2458, dtype=torch.float64)
14 gae_duplicate tensor(0.0827, dtype=torch.float64) tensor(-4.3945, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
13 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(-2.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2819, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
12 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(0.1625, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
11 gae_duplicate tensor(-0.2907, dtype=torch.float64) tensor(0.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0638, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
10 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(-2.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
9 gae_duplicate tensor(-0.0073, dtype=torch.float64) tensor(-2.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5133, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
8 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(0.1494, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5040, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
7 gae_duplicate tensor(-0.4719, dtype=torch.float64) tensor(0.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9107, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
6 gae_duplicate tensor(-0.4608, dtype=torch.float64) tensor(0.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0668, dtype=torch.float64) delta_t tensor(-0.0543, dtype=torch.float64)
5 gae_duplicate tensor(-0.2687, dtype=torch.float64) tensor(1.3675, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3725, dtype=torch.float64) delta_t tensor(-0.1295, dtype=torch.float64)
4 gae_duplicate tensor(-0.5392, dtype=torch.float64) tensor(2.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4276, dtype=torch.float64) delta_t tensor(0.1576, dtype=torch.float64)
3 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(-2.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0645, dtype=torch.float64) delta_t tensor(-0.1546, dtype=torch.float64)
2 gae_duplicate tensor(-0.5455, dtype=torch.float64) tensor(2.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:759.4853515625
value loss:8.710020065307617
entropies:336.90765380859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.87683892250061 seconds
19 rew tensor(1.2276, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
19 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-0.7174, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2023, dtype=torch.float64) delta_t tensor(0.1412, dtype=torch.float64)
18 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-2.5830, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(0.1303, dtype=torch.float64)
17 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-3.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(-0.1951, dtype=torch.float64)
16 gae_duplicate tensor(-1.4428, dtype=torch.float64) tensor(3.3281, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
15 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(-2.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0044, dtype=torch.float64) delta_t tensor(-0.4832, dtype=torch.float64)
14 gae_duplicate tensor(-2.3676, dtype=torch.float64) tensor(8.4557, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6004, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
13 gae_duplicate tensor(-0.3683, dtype=torch.float64) tensor(-1.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0817, dtype=torch.float64) delta_t tensor(-0.2116, dtype=torch.float64)
12 gae_duplicate tensor(-1.9562, dtype=torch.float64) tensor(3.8374, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
11 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(-0.1258, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0020, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
10 gae_duplicate tensor(-0.0757, dtype=torch.float64) tensor(-2.2442, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(0.2594, dtype=torch.float64)
9 gae_duplicate tensor(-0.0227, dtype=torch.float64) tensor(-4.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6320, dtype=torch.float64) delta_t tensor(-0.1436, dtype=torch.float64)
8 gae_duplicate tensor(-0.3057, dtype=torch.float64) tensor(2.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6011, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
7 gae_duplicate tensor(-0.1762, dtype=torch.float64) tensor(-1.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7604, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
6 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(-0.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4229, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
5 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(-0.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0089, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
4 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-0.0603, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0652, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
3 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(0.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
2 gae_duplicate tensor(0.0006, dtype=torch.float64) tensor(-1.8645, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:149.83982849121094
value loss:27.2623348236084
entropies:337.0085144042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.811805009841919 seconds
19 rew tensor(1.1635, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
19 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-0.4233, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1895, dtype=torch.float64) delta_t tensor(0.2175, dtype=torch.float64)
18 gae_duplicate tensor(0.1668, dtype=torch.float64) tensor(-3.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9974, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
17 gae_duplicate tensor(0.0021, dtype=torch.float64) tensor(-0.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8563, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
16 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(0.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
15 gae_duplicate tensor(-0.1151, dtype=torch.float64) tensor(-2.5078, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
14 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-3.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7021, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
13 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-3.0972, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1261, dtype=torch.float64) delta_t tensor(-0.0389, dtype=torch.float64)
12 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(0.3810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4716, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
11 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-1.4106, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1170, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
10 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(0.3189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.1786, dtype=torch.float64)
9 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-3.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7328, dtype=torch.float64) delta_t tensor(-0.0742, dtype=torch.float64)
8 gae_duplicate tensor(-0.2448, dtype=torch.float64) tensor(0.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2989, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
7 gae_duplicate tensor(-0.1022, dtype=torch.float64) tensor(0.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7461, dtype=torch.float64) delta_t tensor(-0.0497, dtype=torch.float64)
6 gae_duplicate tensor(-0.2205, dtype=torch.float64) tensor(0.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2982, dtype=torch.float64) delta_t tensor(-0.1942, dtype=torch.float64)
5 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(3.6166, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2710, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
4 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(0.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6331, dtype=torch.float64) delta_t tensor(-0.1026, dtype=torch.float64)
3 gae_duplicate tensor(-0.3782, dtype=torch.float64) tensor(1.8025, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0878, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
2 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(-0.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:441.31463623046875
value loss:4.377663612365723
entropies:337.1741027832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.679042100906372 seconds
19 rew tensor(1.0995, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
19 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(1.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1255, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
18 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-1.8113, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9972, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
17 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(-0.5399, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9340, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
16 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(0.8142, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8696, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
15 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-1.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5759, dtype=torch.float64) delta_t tensor(-0.0721, dtype=torch.float64)
14 gae_duplicate tensor(-1.3311, dtype=torch.float64) tensor(0.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6639, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
13 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-3.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
12 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-0.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0437, dtype=torch.float64) delta_t tensor(-0.4222, dtype=torch.float64)
11 gae_duplicate tensor(-3.0539, dtype=torch.float64) tensor(7.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2467, dtype=torch.float64) delta_t tensor(-0.1700, dtype=torch.float64)
10 gae_duplicate tensor(-0.9871, dtype=torch.float64) tensor(3.8716, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
9 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-1.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4768, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
8 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(0.9452, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7468, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
7 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(1.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5796, dtype=torch.float64) delta_t tensor(0.1334, dtype=torch.float64)
6 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-2.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6061, dtype=torch.float64) delta_t tensor(-0.1441, dtype=torch.float64)
5 gae_duplicate tensor(-0.3726, dtype=torch.float64) tensor(2.4185, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0412, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
4 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(0.6829, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0041, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
3 gae_duplicate tensor(-0.0848, dtype=torch.float64) tensor(0.6220, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3304, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
2 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-2.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-413.604248046875
value loss:21.926328659057617
entropies:337.439208984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.607449293136597 seconds
19 rew tensor(1.1757, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
19 gae_duplicate tensor(-0.0755, dtype=torch.float64) tensor(0.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1244, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
18 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-1.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0868, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
17 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-0.8186, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9715, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
16 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-0.3761, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9712, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
15 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(-1.5792, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
14 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-0.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8682, dtype=torch.float64) delta_t tensor(0.3261, dtype=torch.float64)
13 gae_duplicate tensor(0.0867, dtype=torch.float64) tensor(-6.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
12 gae_duplicate tensor(-0.2265, dtype=torch.float64) tensor(-2.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6589, dtype=torch.float64) delta_t tensor(-0.8878, dtype=torch.float64)
11 gae_duplicate tensor(-3.5962, dtype=torch.float64) tensor(16.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2815, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
10 gae_duplicate tensor(-2.2805, dtype=torch.float64) tensor(4.6276, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0900, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
9 gae_duplicate tensor(-1.7411, dtype=torch.float64) tensor(4.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
8 gae_duplicate tensor(-0.3037, dtype=torch.float64) tensor(0.1942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6359, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
7 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-0.8890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6924, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
6 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-1.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5059, dtype=torch.float64) delta_t tensor(-0.1618, dtype=torch.float64)
5 gae_duplicate tensor(-0.3280, dtype=torch.float64) tensor(2.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0391, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
4 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(-0.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0440, dtype=torch.float64) delta_t tensor(-0.2021, dtype=torch.float64)
3 gae_duplicate tensor(-0.4789, dtype=torch.float64) tensor(4.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
2 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(-3.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-873.543701171875
value loss:41.99491882324219
entropies:337.7578430175781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3837.1082)
ToM Target loss= tensor(3956.2305)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8132641315460205 seconds
19 rew tensor(1.2024, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
19 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(1.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1900, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
18 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-0.7612, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1646, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
17 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-0.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8674, dtype=torch.float64) delta_t tensor(-0.1642, dtype=torch.float64)
16 gae_duplicate tensor(-1.3066, dtype=torch.float64) tensor(2.5756, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0117, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
15 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-1.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7941, dtype=torch.float64) delta_t tensor(0.3087, dtype=torch.float64)
14 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-5.4776, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.6080, dtype=torch.float64) delta_t tensor(-1.0057, dtype=torch.float64)
13 gae_duplicate tensor(-2.8769, dtype=torch.float64) tensor(21.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4149, dtype=torch.float64) delta_t tensor(-0.5501, dtype=torch.float64)
12 gae_duplicate tensor(-2.7689, dtype=torch.float64) tensor(11.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5356, dtype=torch.float64) delta_t tensor(0.1917, dtype=torch.float64)
11 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-2.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1679, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
10 gae_duplicate tensor(-0.2056, dtype=torch.float64) tensor(-1.4286, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5751, dtype=torch.float64) delta_t tensor(0.2738, dtype=torch.float64)
9 gae_duplicate tensor(0.0982, dtype=torch.float64) tensor(-5.0495, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.1833, dtype=torch.float64)
8 gae_duplicate tensor(-0.3553, dtype=torch.float64) tensor(3.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5081, dtype=torch.float64) delta_t tensor(-0.2278, dtype=torch.float64)
7 gae_duplicate tensor(-2.5175, dtype=torch.float64) tensor(4.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8752, dtype=torch.float64) delta_t tensor(-0.1125, dtype=torch.float64)
6 gae_duplicate tensor(-0.7189, dtype=torch.float64) tensor(2.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6050, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
5 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-2.7798, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1904, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
4 gae_duplicate tensor(-0.2279, dtype=torch.float64) tensor(-0.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5561, dtype=torch.float64) delta_t tensor(-0.1944, dtype=torch.float64)
3 gae_duplicate tensor(-0.3821, dtype=torch.float64) tensor(3.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
2 gae_duplicate tensor(-0.2495, dtype=torch.float64) tensor(-1.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1661.2523193359375
value loss:59.78290939331055
entropies:338.0593566894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.699381113052368 seconds
19 rew tensor(1.1634, dtype=torch.float64) delta_t tensor(-0.1061, dtype=torch.float64)
19 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(2.0589, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1765, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
18 gae_duplicate tensor(-0.0587, dtype=torch.float64) tensor(-1.0417, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1128, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
17 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-0.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9591, dtype=torch.float64) delta_t tensor(-0.0197, dtype=torch.float64)
16 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(0.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9202, dtype=torch.float64) delta_t tensor(0.2482, dtype=torch.float64)
15 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-4.4039, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2775, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
14 gae_duplicate tensor(-1.1908, dtype=torch.float64) tensor(0.9228, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.2250, dtype=torch.float64)
13 gae_duplicate tensor(0.1242, dtype=torch.float64) tensor(-3.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
12 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(-0.2620, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.2079, dtype=torch.float64)
11 gae_duplicate tensor(0.1265, dtype=torch.float64) tensor(-4.4894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2709, dtype=torch.float64) delta_t tensor(-0.0838, dtype=torch.float64)
10 gae_duplicate tensor(-0.2995, dtype=torch.float64) tensor(1.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6139, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
9 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(-2.5885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7068, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
8 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(1.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2572, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
7 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-0.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8870, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
6 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-1.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1668, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
5 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-1.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2204, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
4 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-0.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6806, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
3 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-0.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1125, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
2 gae_duplicate tensor(-0.2616, dtype=torch.float64) tensor(1.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:599.6149291992188
value loss:7.648592948913574
entropies:338.24871826171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.718382120132446 seconds
19 rew tensor(1.1765, dtype=torch.float64) delta_t tensor(-0.1136, dtype=torch.float64)
19 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(2.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1767, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
18 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.4461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0490, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
17 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(-0.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9090, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
16 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(1.8375, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9723, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
15 gae_duplicate tensor(-0.0587, dtype=torch.float64) tensor(-3.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7306, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
14 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(0.0816, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4062, dtype=torch.float64) delta_t tensor(-0.1908, dtype=torch.float64)
13 gae_duplicate tensor(-1.0654, dtype=torch.float64) tensor(3.5138, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0308, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
12 gae_duplicate tensor(-2.0183, dtype=torch.float64) tensor(4.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1991, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
11 gae_duplicate tensor(-1.7554, dtype=torch.float64) tensor(4.5037, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0769, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
10 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(-1.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2801, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
9 gae_duplicate tensor(-0.1962, dtype=torch.float64) tensor(-2.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5148, dtype=torch.float64) delta_t tensor(-0.2032, dtype=torch.float64)
8 gae_duplicate tensor(-0.4601, dtype=torch.float64) tensor(3.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0185, dtype=torch.float64) delta_t tensor(-0.1226, dtype=torch.float64)
7 gae_duplicate tensor(-0.9132, dtype=torch.float64) tensor(2.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6824, dtype=torch.float64) delta_t tensor(0.0643, dtype=torch.float64)
6 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-0.9668, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5535, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
5 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(-0.2974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0368, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
4 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-1.6184, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1584, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
3 gae_duplicate tensor(-0.3034, dtype=torch.float64) tensor(0.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3953, dtype=torch.float64) delta_t tensor(0.1087, dtype=torch.float64)
2 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-1.9932, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-553.3028564453125
value loss:19.312274932861328
entropies:338.4310302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831743001937866 seconds
19 rew tensor(1.2143, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
19 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(1.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2018, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
18 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(-0.4678, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0613, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
17 gae_duplicate tensor(-0.2286, dtype=torch.float64) tensor(0.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0104, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
16 gae_duplicate tensor(-0.2258, dtype=torch.float64) tensor(1.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8446, dtype=torch.float64) delta_t tensor(0.1919, dtype=torch.float64)
15 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-3.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5644, dtype=torch.float64) delta_t tensor(-0.1110, dtype=torch.float64)
14 gae_duplicate tensor(-1.4390, dtype=torch.float64) tensor(1.1570, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0679, dtype=torch.float64) delta_t tensor(-0.4576, dtype=torch.float64)
13 gae_duplicate tensor(-2.6300, dtype=torch.float64) tensor(8.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
12 gae_duplicate tensor(-1.1856, dtype=torch.float64) tensor(0.1068, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3325, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
11 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(-0.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0495, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
10 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-0.9098, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3196, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
9 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-3.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5797, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
8 gae_duplicate tensor(-0.3080, dtype=torch.float64) tensor(1.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9460, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
7 gae_duplicate tensor(-0.3081, dtype=torch.float64) tensor(0.0890, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6691, dtype=torch.float64) delta_t tensor(0.1448, dtype=torch.float64)
6 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(-2.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6022, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
5 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(-1.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1363, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
4 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-1.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2808, dtype=torch.float64) delta_t tensor(-0.1180, dtype=torch.float64)
3 gae_duplicate tensor(-0.4278, dtype=torch.float64) tensor(1.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4823, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
2 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(-2.0319, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-174.63604736328125
value loss:22.47536277770996
entropies:338.654052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6772620677948 seconds
19 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(-0.1681, dtype=torch.float64)
19 gae_duplicate tensor(-0.2431, dtype=torch.float64) tensor(2.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1377, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
18 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(0.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1003, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
17 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(0.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(-0.1324, dtype=torch.float64)
16 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(2.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8699, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
15 gae_duplicate tensor(-0.2507, dtype=torch.float64) tensor(1.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4963, dtype=torch.float64) delta_t tensor(-0.2539, dtype=torch.float64)
14 gae_duplicate tensor(-1.2542, dtype=torch.float64) tensor(4.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6519, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
13 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(0.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3054, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
12 gae_duplicate tensor(-0.2374, dtype=torch.float64) tensor(0.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4479, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
11 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(-0.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0492, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
10 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(-0.2910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1528, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
9 gae_duplicate tensor(-0.1384, dtype=torch.float64) tensor(-2.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4765, dtype=torch.float64) delta_t tensor(-0.1371, dtype=torch.float64)
8 gae_duplicate tensor(-0.4246, dtype=torch.float64) tensor(2.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5636, dtype=torch.float64) delta_t tensor(-0.5371, dtype=torch.float64)
7 gae_duplicate tensor(-2.9398, dtype=torch.float64) tensor(14.3275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6051, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
6 gae_duplicate tensor(-0.5815, dtype=torch.float64) tensor(-0.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6795, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
5 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(-0.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
4 gae_duplicate tensor(-0.1206, dtype=torch.float64) tensor(-2.5999, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3218, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
3 gae_duplicate tensor(-0.5312, dtype=torch.float64) tensor(1.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5353, dtype=torch.float64) delta_t tensor(0.1883, dtype=torch.float64)
2 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-3.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1160.363525390625
value loss:20.113361358642578
entropies:339.00555419921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3838.6392)
ToM Target loss= tensor(3949.8713)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.915092945098877 seconds
19 rew tensor(1.1758, dtype=torch.float64) delta_t tensor(-0.1444, dtype=torch.float64)
19 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(2.8464, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1629, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
18 gae_duplicate tensor(-0.0813, dtype=torch.float64) tensor(-0.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0862, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
17 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(0.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9582, dtype=torch.float64) delta_t tensor(-0.1417, dtype=torch.float64)
16 gae_duplicate tensor(-0.2233, dtype=torch.float64) tensor(2.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9590, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
15 gae_duplicate tensor(-0.2363, dtype=torch.float64) tensor(-1.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5256, dtype=torch.float64) delta_t tensor(-0.1858, dtype=torch.float64)
14 gae_duplicate tensor(-1.3602, dtype=torch.float64) tensor(3.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2095, dtype=torch.float64) delta_t tensor(-0.3294, dtype=torch.float64)
13 gae_duplicate tensor(-2.5727, dtype=torch.float64) tensor(6.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1165, dtype=torch.float64) delta_t tensor(-0.1687, dtype=torch.float64)
12 gae_duplicate tensor(-1.1592, dtype=torch.float64) tensor(3.5480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3824, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
11 gae_duplicate tensor(-0.0714, dtype=torch.float64) tensor(-1.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0013, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
10 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-0.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3174, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
9 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(-1.8850, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6036, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
8 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(2.2434, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6424, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
7 gae_duplicate tensor(-0.2858, dtype=torch.float64) tensor(-0.5273, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6679, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
6 gae_duplicate tensor(-0.0882, dtype=torch.float64) tensor(-2.9765, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5013, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
5 gae_duplicate tensor(-0.0979, dtype=torch.float64) tensor(-1.3153, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0409, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
4 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-0.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0271, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
3 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-0.5320, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3049, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
2 gae_duplicate tensor(-0.2664, dtype=torch.float64) tensor(-1.5530, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-568.7698364257812
value loss:19.213333129882812
entropies:339.1128234863281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.691622734069824 seconds
19 rew tensor(1.2021, dtype=torch.float64) delta_t tensor(-0.1268, dtype=torch.float64)
19 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(2.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1768, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
18 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(0.1013, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1255, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
17 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-0.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0358, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
16 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(0.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9340, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
15 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(0.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0565, dtype=torch.float64) delta_t tensor(-0.6675, dtype=torch.float64)
14 gae_duplicate tensor(-2.4351, dtype=torch.float64) tensor(11.6945, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
13 gae_duplicate tensor(-1.6604, dtype=torch.float64) tensor(2.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2425, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
12 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(0.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
11 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-0.4229, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1164, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
10 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(0.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(0.2029, dtype=torch.float64)
9 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-3.9406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4758, dtype=torch.float64) delta_t tensor(-0.2626, dtype=torch.float64)
8 gae_duplicate tensor(-0.5143, dtype=torch.float64) tensor(4.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4493, dtype=torch.float64) delta_t tensor(-0.1367, dtype=torch.float64)
7 gae_duplicate tensor(-1.4018, dtype=torch.float64) tensor(3.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5789, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
6 gae_duplicate tensor(-0.4206, dtype=torch.float64) tensor(-0.9560, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7818, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
5 gae_duplicate tensor(-0.1375, dtype=torch.float64) tensor(-0.5982, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
4 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(-0.2060, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4633, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
3 gae_duplicate tensor(-0.4844, dtype=torch.float64) tensor(0.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5621, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
2 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-2.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1053.792236328125
value loss:24.30835723876953
entropies:339.2127685546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.933153867721558 seconds
19 rew tensor(1.1888, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
19 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(1.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
18 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(-0.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0361, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
17 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(1.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9079, dtype=torch.float64) delta_t tensor(-0.1595, dtype=torch.float64)
16 gae_duplicate tensor(-0.2937, dtype=torch.float64) tensor(3.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8825, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
15 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(-1.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6633, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
14 gae_duplicate tensor(0.0345, dtype=torch.float64) tensor(-3.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
13 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-2.4646, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0758, dtype=torch.float64) delta_t tensor(-0.1008, dtype=torch.float64)
12 gae_duplicate tensor(-0.8239, dtype=torch.float64) tensor(1.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4101, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
11 gae_duplicate tensor(-0.4169, dtype=torch.float64) tensor(0.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1681, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
10 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(-1.7482, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
9 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(-2.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7439, dtype=torch.float64) delta_t tensor(-0.1947, dtype=torch.float64)
8 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(3.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5761, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
7 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-0.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8207, dtype=torch.float64) delta_t tensor(0.2003, dtype=torch.float64)
6 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(-3.6845, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4481, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
5 gae_duplicate tensor(-0.4418, dtype=torch.float64) tensor(-0.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
4 gae_duplicate tensor(-0.3093, dtype=torch.float64) tensor(-0.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0751, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
3 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-0.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2790, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
2 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(-1.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:325.424072265625
value loss:8.259245872497559
entropies:339.39691162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.642315149307251 seconds
19 rew tensor(1.1764, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
19 gae_duplicate tensor(-0.1633, dtype=torch.float64) tensor(1.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1129, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
18 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(0.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0364, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
17 gae_duplicate tensor(-0.2738, dtype=torch.float64) tensor(0.3849, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0232, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
16 gae_duplicate tensor(-0.1386, dtype=torch.float64) tensor(-0.0887, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8707, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
15 gae_duplicate tensor(-0.2509, dtype=torch.float64) tensor(-0.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(-0.2090, dtype=torch.float64)
14 gae_duplicate tensor(-1.5228, dtype=torch.float64) tensor(2.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6014, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
13 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(-0.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
12 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-1.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4092, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
11 gae_duplicate tensor(-0.3236, dtype=torch.float64) tensor(0.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
10 gae_duplicate tensor(-0.2806, dtype=torch.float64) tensor(1.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2291, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
9 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(-2.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5276, dtype=torch.float64) delta_t tensor(-0.1362, dtype=torch.float64)
8 gae_duplicate tensor(-0.5242, dtype=torch.float64) tensor(2.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3492, dtype=torch.float64) delta_t tensor(-0.2312, dtype=torch.float64)
7 gae_duplicate tensor(-1.4276, dtype=torch.float64) tensor(4.6940, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6562, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
6 gae_duplicate tensor(-0.4297, dtype=torch.float64) tensor(-2.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6541, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
5 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-1.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
4 gae_duplicate tensor(0.0586, dtype=torch.float64) tensor(-3.5373, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4385, dtype=torch.float64) delta_t tensor(-0.0823, dtype=torch.float64)
3 gae_duplicate tensor(-0.5259, dtype=torch.float64) tensor(0.9420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(0.2352, dtype=torch.float64)
2 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-4.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:161.1716766357422
value loss:13.548176765441895
entropies:339.5823059082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.719404935836792 seconds
19 rew tensor(1.1637, dtype=torch.float64) delta_t tensor(-0.1150, dtype=torch.float64)
19 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(2.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1767, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
18 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-0.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0874, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
17 gae_duplicate tensor(-0.1565, dtype=torch.float64) tensor(0.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
16 gae_duplicate tensor(-0.2100, dtype=torch.float64) tensor(1.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9216, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
15 gae_duplicate tensor(-0.2314, dtype=torch.float64) tensor(-2.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(-0.3263, dtype=torch.float64)
14 gae_duplicate tensor(-1.3108, dtype=torch.float64) tensor(5.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1510, dtype=torch.float64) delta_t tensor(-0.3614, dtype=torch.float64)
13 gae_duplicate tensor(-2.7581, dtype=torch.float64) tensor(6.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3446, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
12 gae_duplicate tensor(-0.2352, dtype=torch.float64) tensor(-0.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5504, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
11 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-2.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1169, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
10 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(0.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3449, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
9 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(-1.2310, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4505, dtype=torch.float64) delta_t tensor(-0.0657, dtype=torch.float64)
8 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(1.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7445, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
7 gae_duplicate tensor(-0.1011, dtype=torch.float64) tensor(-0.8492, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5405, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
6 gae_duplicate tensor(0.0299, dtype=torch.float64) tensor(-2.1697, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5773, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
5 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(0.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0145, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
4 gae_duplicate tensor(-0.1021, dtype=torch.float64) tensor(0.4430, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9891, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
3 gae_duplicate tensor(-0.1771, dtype=torch.float64) tensor(0.7648, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3441, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
2 gae_duplicate tensor(-0.1580, dtype=torch.float64) tensor(-0.7338, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-504.67205810546875
value loss:19.226722717285156
entropies:339.80523681640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3853.6470)
ToM Target loss= tensor(3952.6836)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.773157835006714 seconds
19 rew tensor(1.1380, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
19 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(1.4972, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1002, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
18 gae_duplicate tensor(-0.0622, dtype=torch.float64) tensor(-0.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9463, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
17 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(1.7712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9338, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
16 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(2.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8186, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
15 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(0.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8055, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
14 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(-2.5580, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4581, dtype=torch.float64) delta_t tensor(-0.1600, dtype=torch.float64)
13 gae_duplicate tensor(-1.3898, dtype=torch.float64) tensor(2.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4212, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
12 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-2.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
11 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-2.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0014, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
10 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-1.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2681, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
9 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-1.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4759, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
8 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(2.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1258, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
7 gae_duplicate tensor(-2.4836, dtype=torch.float64) tensor(5.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7461, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
6 gae_duplicate tensor(-1.1372, dtype=torch.float64) tensor(1.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3712, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
5 gae_duplicate tensor(-0.1125, dtype=torch.float64) tensor(-0.9562, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0671, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
4 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(-0.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9229, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
3 gae_duplicate tensor(-0.5171, dtype=torch.float64) tensor(-0.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
2 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(-0.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-445.7054138183594
value loss:19.981281280517578
entropies:340.15802001953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.80084490776062 seconds
19 rew tensor(1.2019, dtype=torch.float64) delta_t tensor(-0.0798, dtype=torch.float64)
19 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(1.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2022, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
18 gae_duplicate tensor(-0.0080, dtype=torch.float64) tensor(-1.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0996, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
17 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(-0.5910, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
16 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(0.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9467, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
15 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(0.2588, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5524, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
14 gae_duplicate tensor(-1.2151, dtype=torch.float64) tensor(-0.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6773, dtype=torch.float64) delta_t tensor(0.1400, dtype=torch.float64)
13 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-2.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(0.1656, dtype=torch.float64)
12 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(-3.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3241, dtype=torch.float64) delta_t tensor(-0.6803, dtype=torch.float64)
11 gae_duplicate tensor(-4.3608, dtype=torch.float64) tensor(11.6883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5668, dtype=torch.float64) delta_t tensor(-0.3059, dtype=torch.float64)
10 gae_duplicate tensor(-2.5307, dtype=torch.float64) tensor(6.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3566, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
9 gae_duplicate tensor(-0.4337, dtype=torch.float64) tensor(-2.4551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5647, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
8 gae_duplicate tensor(-0.2104, dtype=torch.float64) tensor(1.8178, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7211, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
7 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(-1.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7190, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
6 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-1.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5793, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
5 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-0.8543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0397, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
4 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(1.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1186, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
3 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(1.0227, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
2 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(-1.4937, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-451.9789123535156
value loss:46.29963302612305
entropies:340.5440673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.96040678024292 seconds
19 rew tensor(1.0870, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
19 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(1.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0870, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
18 gae_duplicate tensor(-0.0699, dtype=torch.float64) tensor(-1.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0749, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
17 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-0.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(-0.1213, dtype=torch.float64)
16 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(2.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
15 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-3.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6139, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
14 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-1.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7416, dtype=torch.float64) delta_t tensor(0.1363, dtype=torch.float64)
13 gae_duplicate tensor(0.0410, dtype=torch.float64) tensor(-2.8777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
12 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(0.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5495, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
11 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-2.2257, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0009, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
10 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(-0.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2028, dtype=torch.float64) delta_t tensor(-0.0677, dtype=torch.float64)
9 gae_duplicate tensor(-0.2226, dtype=torch.float64) tensor(0.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5522, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
8 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(-0.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2599, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
7 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-1.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7572, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
6 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-1.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2203, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
5 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-0.1329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2444, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
4 gae_duplicate tensor(-0.2280, dtype=torch.float64) tensor(-0.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5806, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
3 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-1.2401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1400, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
2 gae_duplicate tensor(-0.3029, dtype=torch.float64) tensor(0.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:541.6992797851562
value loss:4.071197509765625
entropies:340.9996032714844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.566556930541992 seconds
19 rew tensor(1.1635, dtype=torch.float64) delta_t tensor(-0.0414, dtype=torch.float64)
19 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(0.7614, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8714, dtype=torch.float64) delta_t tensor(-0.1059, dtype=torch.float64)
18 gae_duplicate tensor(-1.2697, dtype=torch.float64) tensor(2.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0367, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
17 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-0.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8695, dtype=torch.float64) delta_t tensor(-0.1168, dtype=torch.float64)
16 gae_duplicate tensor(-0.2838, dtype=torch.float64) tensor(2.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9471, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
15 gae_duplicate tensor(-0.2176, dtype=torch.float64) tensor(-2.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.1801, dtype=torch.float64)
14 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-3.5477, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7160, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
13 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-3.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2677, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
12 gae_duplicate tensor(-0.0461, dtype=torch.float64) tensor(-0.7795, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1434, dtype=torch.float64) delta_t tensor(-0.4184, dtype=torch.float64)
11 gae_duplicate tensor(-3.2121, dtype=torch.float64) tensor(7.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
10 gae_duplicate tensor(-0.3044, dtype=torch.float64) tensor(-0.2446, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
9 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-1.9053, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5912, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
8 gae_duplicate tensor(-0.2284, dtype=torch.float64) tensor(1.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3879, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
7 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(-1.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8092, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
6 gae_duplicate tensor(-0.3814, dtype=torch.float64) tensor(-0.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3747, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
5 gae_duplicate tensor(-0.1721, dtype=torch.float64) tensor(0.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2963, dtype=torch.float64) delta_t tensor(-0.0649, dtype=torch.float64)
4 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(1.3891, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7729, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
3 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(1.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0241, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
2 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(2.4805, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-326.14532470703125
value loss:23.681583404541016
entropies:341.50860595703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.700824975967407 seconds
19 rew tensor(1.1393, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
19 gae_duplicate tensor(-0.1098, dtype=torch.float64) tensor(0.9626, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1395, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
18 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-2.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1139, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
17 gae_duplicate tensor(0.0106, dtype=torch.float64) tensor(-1.6529, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9342, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
16 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(-0.4900, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9219, dtype=torch.float64) delta_t tensor(0.1910, dtype=torch.float64)
15 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-3.8404, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1834, dtype=torch.float64) delta_t tensor(-0.5744, dtype=torch.float64)
14 gae_duplicate tensor(-2.3303, dtype=torch.float64) tensor(10.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5629, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
13 gae_duplicate tensor(-1.3353, dtype=torch.float64) tensor(2.0442, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2030, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
12 gae_duplicate tensor(-0.1660, dtype=torch.float64) tensor(-0.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5760, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
11 gae_duplicate tensor(-0.0456, dtype=torch.float64) tensor(-3.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0274, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
10 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-1.3273, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
9 gae_duplicate tensor(-0.2430, dtype=torch.float64) tensor(0.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5537, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
8 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.5478, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3604, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
7 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-0.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6308, dtype=torch.float64) delta_t tensor(0.1371, dtype=torch.float64)
6 gae_duplicate tensor(-0.0234, dtype=torch.float64) tensor(-2.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3996, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
5 gae_duplicate tensor(-0.3518, dtype=torch.float64) tensor(1.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1949, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
4 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(1.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7333, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
3 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(0.2781, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1641, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
2 gae_duplicate tensor(-0.3145, dtype=torch.float64) tensor(3.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-307.87890625
value loss:17.597286224365234
entropies:341.920166015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3852.7266)
ToM Target loss= tensor(3956.7207)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.736437082290649 seconds
19 rew tensor(1.1776, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
19 gae_duplicate tensor(-0.1239, dtype=torch.float64) tensor(0.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2161, dtype=torch.float64) delta_t tensor(0.1459, dtype=torch.float64)
18 gae_duplicate tensor(0.0357, dtype=torch.float64) tensor(-2.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0752, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
17 gae_duplicate tensor(-0.0197, dtype=torch.float64) tensor(-1.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9723, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
16 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(0.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9470, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
15 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-2.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2307, dtype=torch.float64) delta_t tensor(-0.3315, dtype=torch.float64)
14 gae_duplicate tensor(-1.1409, dtype=torch.float64) tensor(6.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
13 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-1.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3710, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
12 gae_duplicate tensor(-0.0907, dtype=torch.float64) tensor(-2.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
11 gae_duplicate tensor(-0.3250, dtype=torch.float64) tensor(-0.1441, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0130, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
10 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(-2.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
9 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-2.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6555, dtype=torch.float64) delta_t tensor(-0.1114, dtype=torch.float64)
8 gae_duplicate tensor(-0.3092, dtype=torch.float64) tensor(1.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2780, dtype=torch.float64) delta_t tensor(-0.3182, dtype=torch.float64)
7 gae_duplicate tensor(-2.5412, dtype=torch.float64) tensor(5.7565, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8622, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
6 gae_duplicate tensor(-1.0962, dtype=torch.float64) tensor(1.6177, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4519, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
5 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-2.9921, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1147, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
4 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(-1.3571, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2753, dtype=torch.float64) delta_t tensor(-0.0951, dtype=torch.float64)
3 gae_duplicate tensor(-0.5373, dtype=torch.float64) tensor(1.5561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4608, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
2 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(-1.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:91.1545181274414
value loss:20.345439910888672
entropies:342.30328369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6446919441223145 seconds
19 rew tensor(1.1772, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
19 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(0.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1386, dtype=torch.float64) delta_t tensor(0.0988, dtype=torch.float64)
18 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-1.7535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0363, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
17 gae_duplicate tensor(-0.1211, dtype=torch.float64) tensor(-0.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0112, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
16 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-0.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9468, dtype=torch.float64) delta_t tensor(0.1118, dtype=torch.float64)
15 gae_duplicate tensor(-0.1375, dtype=torch.float64) tensor(-2.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4715, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
14 gae_duplicate tensor(-1.1008, dtype=torch.float64) tensor(-1.1434, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7160, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
13 gae_duplicate tensor(0.0762, dtype=torch.float64) tensor(-3.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3696, dtype=torch.float64) delta_t tensor(0.1763, dtype=torch.float64)
12 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-3.8193, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5490, dtype=torch.float64) delta_t tensor(-0.8670, dtype=torch.float64)
11 gae_duplicate tensor(-5.6943, dtype=torch.float64) tensor(22.8424, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0533, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
10 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-0.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3328, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
9 gae_duplicate tensor(-0.2493, dtype=torch.float64) tensor(-1.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6304, dtype=torch.float64) delta_t tensor(-0.0882, dtype=torch.float64)
8 gae_duplicate tensor(-0.3116, dtype=torch.float64) tensor(1.6696, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5928, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
7 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(-1.9856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7718, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
6 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-1.0476, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4768, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
5 gae_duplicate tensor(-0.3748, dtype=torch.float64) tensor(-1.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
4 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-0.5033, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0811, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
3 gae_duplicate tensor(-0.1387, dtype=torch.float64) tensor(0.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2810, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
2 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(-0.3651, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-381.2174377441406
value loss:56.30126190185547
entropies:342.67730712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.829960823059082 seconds
19 rew tensor(1.2151, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
19 gae_duplicate tensor(-0.0515, dtype=torch.float64) tensor(-0.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2281, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
18 gae_duplicate tensor(0.0558, dtype=torch.float64) tensor(-3.0647, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0482, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
17 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9975, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
16 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-1.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
15 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-4.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3329, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
14 gae_duplicate tensor(-0.6891, dtype=torch.float64) tensor(-2.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.0941, dtype=torch.float64)
13 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-1.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2667, dtype=torch.float64) delta_t tensor(0.1822, dtype=torch.float64)
12 gae_duplicate tensor(-0.0266, dtype=torch.float64) tensor(-3.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5241, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
11 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-1.2584, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1305, dtype=torch.float64) delta_t tensor(0.0023, dtype=torch.float64)
10 gae_duplicate tensor(-0.2251, dtype=torch.float64) tensor(-0.2572, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6394, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
9 gae_duplicate tensor(0.0843, dtype=torch.float64) tensor(-4.1086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8604, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
8 gae_duplicate tensor(-0.4258, dtype=torch.float64) tensor(2.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1118, dtype=torch.float64) delta_t tensor(-0.4428, dtype=torch.float64)
7 gae_duplicate tensor(-3.7372, dtype=torch.float64) tensor(7.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0016, dtype=torch.float64) delta_t tensor(-0.0929, dtype=torch.float64)
6 gae_duplicate tensor(-0.9735, dtype=torch.float64) tensor(2.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1434, dtype=torch.float64) delta_t tensor(0.1508, dtype=torch.float64)
5 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(-2.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
4 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-1.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9897, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
3 gae_duplicate tensor(-0.2850, dtype=torch.float64) tensor(1.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3441, dtype=torch.float64) delta_t tensor(0.1432, dtype=torch.float64)
2 gae_duplicate tensor(-0.3828, dtype=torch.float64) tensor(-2.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:742.0673828125
value loss:31.912212371826172
entropies:342.7749938964844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.70464825630188 seconds
19 rew tensor(1.2145, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
19 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(0.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1889, dtype=torch.float64) delta_t tensor(0.1034, dtype=torch.float64)
18 gae_duplicate tensor(0.0350, dtype=torch.float64) tensor(-2.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1252, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
17 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-1.1323, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0613, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
16 gae_duplicate tensor(-0.0260, dtype=torch.float64) tensor(-1.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9454, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
15 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-1.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3179, dtype=torch.float64) delta_t tensor(-0.2089, dtype=torch.float64)
14 gae_duplicate tensor(-1.1339, dtype=torch.float64) tensor(3.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5995, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
13 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-2.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3807, dtype=torch.float64) delta_t tensor(-0.4800, dtype=torch.float64)
12 gae_duplicate tensor(-3.4745, dtype=torch.float64) tensor(8.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
11 gae_duplicate tensor(-1.7989, dtype=torch.float64) tensor(5.5270, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0259, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
10 gae_duplicate tensor(-0.2347, dtype=torch.float64) tensor(-0.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
9 gae_duplicate tensor(0.1010, dtype=torch.float64) tensor(-4.4906, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6269, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
8 gae_duplicate tensor(-0.5168, dtype=torch.float64) tensor(3.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5240, dtype=torch.float64) delta_t tensor(-0.4136, dtype=torch.float64)
7 gae_duplicate tensor(-2.5787, dtype=torch.float64) tensor(8.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
6 gae_duplicate tensor(-0.8060, dtype=torch.float64) tensor(1.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6313, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
5 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-2.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1652, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
4 gae_duplicate tensor(-0.1372, dtype=torch.float64) tensor(-0.4419, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4127, dtype=torch.float64) delta_t tensor(-0.0871, dtype=torch.float64)
3 gae_duplicate tensor(-0.5107, dtype=torch.float64) tensor(2.0374, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4854, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
2 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(-0.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-944.1473999023438
value loss:42.42512130737305
entropies:343.01995849609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.606602191925049 seconds
19 rew tensor(1.2012, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
19 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(0.6027, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1891, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
18 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-1.3499, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8667, dtype=torch.float64) delta_t tensor(-0.1849, dtype=torch.float64)
17 gae_duplicate tensor(-1.2909, dtype=torch.float64) tensor(3.1642, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1123, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
16 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-1.9200, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(-0.1794, dtype=torch.float64)
15 gae_duplicate tensor(-1.2615, dtype=torch.float64) tensor(3.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.3077, dtype=torch.float64)
14 gae_duplicate tensor(0.1100, dtype=torch.float64) tensor(-5.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7549, dtype=torch.float64) delta_t tensor(0.3334, dtype=torch.float64)
13 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-7.1429, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0814, dtype=torch.float64) delta_t tensor(-0.1618, dtype=torch.float64)
12 gae_duplicate tensor(-1.7726, dtype=torch.float64) tensor(2.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0744, dtype=torch.float64) delta_t tensor(-0.1606, dtype=torch.float64)
11 gae_duplicate tensor(-1.8421, dtype=torch.float64) tensor(3.2418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0016, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
10 gae_duplicate tensor(-0.2894, dtype=torch.float64) tensor(-0.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3198, dtype=torch.float64) delta_t tensor(0.2129, dtype=torch.float64)
9 gae_duplicate tensor(-0.2576, dtype=torch.float64) tensor(-4.5479, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6552, dtype=torch.float64) delta_t tensor(-0.1247, dtype=torch.float64)
8 gae_duplicate tensor(-0.4746, dtype=torch.float64) tensor(1.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3149, dtype=torch.float64) delta_t tensor(-0.3328, dtype=torch.float64)
7 gae_duplicate tensor(-2.5585, dtype=torch.float64) tensor(6.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8984, dtype=torch.float64) delta_t tensor(-0.1309, dtype=torch.float64)
6 gae_duplicate tensor(-1.1646, dtype=torch.float64) tensor(4.2396, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2966, dtype=torch.float64) delta_t tensor(0.2708, dtype=torch.float64)
5 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-4.5543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0877, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
4 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(-2.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2708, dtype=torch.float64) delta_t tensor(-0.1674, dtype=torch.float64)
3 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(3.1153, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3951, dtype=torch.float64) delta_t tensor(0.1817, dtype=torch.float64)
2 gae_duplicate tensor(-0.3726, dtype=torch.float64) tensor(-2.9318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:54.84696960449219
value loss:41.47917175292969
entropies:343.0753173828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3873.9690)
ToM Target loss= tensor(3948.0815)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.963263988494873 seconds
19 rew tensor(1.2266, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
19 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(1.2008, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2142, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
18 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-1.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1371, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
17 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-0.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1250, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
16 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-4.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
15 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(-0.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4444, dtype=torch.float64) delta_t tensor(0.1671, dtype=torch.float64)
14 gae_duplicate tensor(-1.1770, dtype=torch.float64) tensor(-3.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.2194, dtype=torch.float64)
13 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-4.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0892, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
12 gae_duplicate tensor(-1.0867, dtype=torch.float64) tensor(1.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0080, dtype=torch.float64) delta_t tensor(-0.4011, dtype=torch.float64)
11 gae_duplicate tensor(-2.9508, dtype=torch.float64) tensor(7.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1056, dtype=torch.float64) delta_t tensor(0.0807, dtype=torch.float64)
10 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(-0.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4868, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
9 gae_duplicate tensor(0.0891, dtype=torch.float64) tensor(-5.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6800, dtype=torch.float64) delta_t tensor(-0.2000, dtype=torch.float64)
8 gae_duplicate tensor(-0.5821, dtype=torch.float64) tensor(3.1748, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4621, dtype=torch.float64) delta_t tensor(-0.3239, dtype=torch.float64)
7 gae_duplicate tensor(-2.7098, dtype=torch.float64) tensor(6.0354, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8344, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
6 gae_duplicate tensor(-0.6410, dtype=torch.float64) tensor(-0.2908, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5246, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
5 gae_duplicate tensor(-0.0670, dtype=torch.float64) tensor(-3.4113, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1666, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
4 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(-1.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3998, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
3 gae_duplicate tensor(-0.4603, dtype=torch.float64) tensor(-0.2149, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5121, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
2 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-2.6884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:349.2066650390625
value loss:38.331634521484375
entropies:343.0604553222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.720701217651367 seconds
19 rew tensor(1.0855, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
19 gae_duplicate tensor(-0.1875, dtype=torch.float64) tensor(1.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1115, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
18 gae_duplicate tensor(-0.0387, dtype=torch.float64) tensor(-0.9037, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0345, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
17 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(0.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9839, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
16 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(0.8481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8176, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
15 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7539, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
14 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-0.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
13 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-0.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
12 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-0.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3698, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
11 gae_duplicate tensor(-0.0517, dtype=torch.float64) tensor(-0.8170, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0755, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
10 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-0.4127, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2799, dtype=torch.float64) delta_t tensor(0.2183, dtype=torch.float64)
9 gae_duplicate tensor(0.0902, dtype=torch.float64) tensor(-3.9857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5252, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
8 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(1.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6161, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
7 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-0.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8453, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
6 gae_duplicate tensor(-0.4008, dtype=torch.float64) tensor(-1.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2177, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
5 gae_duplicate tensor(-0.0101, dtype=torch.float64) tensor(-1.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1416, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
4 gae_duplicate tensor(-0.2666, dtype=torch.float64) tensor(0.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7065, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
3 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-0.9099, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2422, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
2 gae_duplicate tensor(-0.2612, dtype=torch.float64) tensor(-1.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:407.59503173828125
value loss:4.474841117858887
entropies:343.15423583984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.045660972595215 seconds
19 rew tensor(1.2015, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
19 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(0.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1506, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
18 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-0.7082, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0608, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
17 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(-0.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9201, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
16 gae_duplicate tensor(-0.1971, dtype=torch.float64) tensor(1.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8050, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
15 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-2.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
14 gae_duplicate tensor(-1.4836, dtype=torch.float64) tensor(-0.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6124, dtype=torch.float64) delta_t tensor(0.1667, dtype=torch.float64)
13 gae_duplicate tensor(0.0072, dtype=torch.float64) tensor(-2.9478, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
12 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-1.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(-0.2838, dtype=torch.float64)
11 gae_duplicate tensor(-1.6478, dtype=torch.float64) tensor(7.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0383, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
10 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-2.5838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3048, dtype=torch.float64) delta_t tensor(0.1147, dtype=torch.float64)
9 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-2.2079, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5256, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
8 gae_duplicate tensor(-0.1243, dtype=torch.float64) tensor(-0.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5538, dtype=torch.float64) delta_t tensor(0.0807, dtype=torch.float64)
7 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-1.7679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6409, dtype=torch.float64) delta_t tensor(0.2857, dtype=torch.float64)
6 gae_duplicate tensor(0.1167, dtype=torch.float64) tensor(-5.3175, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5007, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
5 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-0.0135, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1927, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
4 gae_duplicate tensor(-0.3610, dtype=torch.float64) tensor(1.5237, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8488, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
3 gae_duplicate tensor(-0.3273, dtype=torch.float64) tensor(-0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1398, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
2 gae_duplicate tensor(-0.2695, dtype=torch.float64) tensor(1.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:338.4008483886719
value loss:12.769572257995605
entropies:343.18463134765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.720700025558472 seconds
19 rew tensor(1.2136, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
19 gae_duplicate tensor(-0.2209, dtype=torch.float64) tensor(1.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1886, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
18 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-1.5036, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0350, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
17 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(1.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0355, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
16 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(0.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9200, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
15 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.0943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.1768, dtype=torch.float64)
14 gae_duplicate tensor(-0.2780, dtype=torch.float64) tensor(-3.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6776, dtype=torch.float64) delta_t tensor(0.2005, dtype=torch.float64)
13 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-3.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2418, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
12 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(0.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4152, dtype=torch.float64) delta_t tensor(-0.7409, dtype=torch.float64)
11 gae_duplicate tensor(-4.6163, dtype=torch.float64) tensor(19.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0788, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
10 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-0.2736, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3324, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
9 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(-0.7815, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5651, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
8 gae_duplicate tensor(-0.2887, dtype=torch.float64) tensor(-0.2696, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5072, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
7 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-2.6116, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8869, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
6 gae_duplicate tensor(-0.3212, dtype=torch.float64) tensor(-2.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3166, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
5 gae_duplicate tensor(-0.8319, dtype=torch.float64) tensor(-0.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1723, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
4 gae_duplicate tensor(-0.1676, dtype=torch.float64) tensor(0.0703, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8925, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
3 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(-1.5082, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1605, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
2 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(-0.3740, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-281.7337951660156
value loss:38.92383575439453
entropies:343.189697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.76966404914856 seconds
19 rew tensor(1.0607, dtype=torch.float64) delta_t tensor(-0.1365, dtype=torch.float64)
19 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(2.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9969, dtype=torch.float64) delta_t tensor(-0.0695, dtype=torch.float64)
18 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(1.9539, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0094, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
17 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(1.2131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
16 gae_duplicate tensor(-0.2372, dtype=torch.float64) tensor(1.8380, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
15 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-0.9916, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7159, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
14 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(-1.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6638, dtype=torch.float64) delta_t tensor(0.1546, dtype=torch.float64)
13 gae_duplicate tensor(0.1003, dtype=torch.float64) tensor(-2.9006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
12 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(-1.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4726, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
11 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-0.4241, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0263, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
10 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(-1.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
9 gae_duplicate tensor(-0.2097, dtype=torch.float64) tensor(-0.8164, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4500, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
8 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-0.0315, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7183, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
7 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(0.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5399, dtype=torch.float64) delta_t tensor(0.2693, dtype=torch.float64)
6 gae_duplicate tensor(0.1128, dtype=torch.float64) tensor(-4.8918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5502, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
5 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-1.6869, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
4 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(0.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9498, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
3 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-0.5368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
2 gae_duplicate tensor(-0.3207, dtype=torch.float64) tensor(1.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:251.0465087890625
value loss:5.01108980178833
entropies:342.88909912109375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3845.4495)
ToM Target loss= tensor(3956.4858)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.736491918563843 seconds
19 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(-0.3507, dtype=torch.float64)
19 gae_duplicate tensor(-1.4878, dtype=torch.float64) tensor(6.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0997, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
18 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(0.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0867, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
17 gae_duplicate tensor(-0.0631, dtype=torch.float64) tensor(0.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0612, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
16 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
15 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-0.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4857, dtype=torch.float64) delta_t tensor(-0.2432, dtype=torch.float64)
14 gae_duplicate tensor(-1.0267, dtype=torch.float64) tensor(4.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3690, dtype=torch.float64) delta_t tensor(-0.0542, dtype=torch.float64)
13 gae_duplicate tensor(-1.0070, dtype=torch.float64) tensor(1.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1648, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
12 gae_duplicate tensor(-0.6319, dtype=torch.float64) tensor(0.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4081, dtype=torch.float64) delta_t tensor(-0.0341, dtype=torch.float64)
11 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(0.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1036, dtype=torch.float64) delta_t tensor(0.1279, dtype=torch.float64)
10 gae_duplicate tensor(-0.2365, dtype=torch.float64) tensor(-1.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4853, dtype=torch.float64) delta_t tensor(0.1633, dtype=torch.float64)
9 gae_duplicate tensor(0.0183, dtype=torch.float64) tensor(-3.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5271, dtype=torch.float64) delta_t tensor(-0.0318, dtype=torch.float64)
8 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(0.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7948, dtype=torch.float64) delta_t tensor(0.1137, dtype=torch.float64)
7 gae_duplicate tensor(-0.0134, dtype=torch.float64) tensor(-2.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6169, dtype=torch.float64) delta_t tensor(0.2325, dtype=torch.float64)
6 gae_duplicate tensor(0.1437, dtype=torch.float64) tensor(-4.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5767, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
5 gae_duplicate tensor(-0.3588, dtype=torch.float64) tensor(-1.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
4 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(0.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1034, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
3 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-0.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(-0.1071, dtype=torch.float64)
2 gae_duplicate tensor(-0.3621, dtype=torch.float64) tensor(2.0683, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-212.90174865722656
value loss:12.829313278198242
entropies:342.6976318359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965063095092773 seconds
19 rew tensor(1.0736, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
19 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(2.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0868, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
18 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-0.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
17 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(1.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6767, dtype=torch.float64) delta_t tensor(-0.3104, dtype=torch.float64)
16 gae_duplicate tensor(-1.5927, dtype=torch.float64) tensor(5.8776, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
15 gae_duplicate tensor(-0.2183, dtype=torch.float64) tensor(0.7808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7298, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
14 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(1.1941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7027, dtype=torch.float64) delta_t tensor(0.1580, dtype=torch.float64)
13 gae_duplicate tensor(-0.0084, dtype=torch.float64) tensor(-2.7507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2938, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
12 gae_duplicate tensor(-0.1852, dtype=torch.float64) tensor(0.8141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4205, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
11 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-0.5489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0264, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
10 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2921, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
9 gae_duplicate tensor(-0.3007, dtype=torch.float64) tensor(-1.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4745, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
8 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(1.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7093, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
7 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(0.3245, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5519, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
6 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(-3.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5535, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
5 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-0.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
4 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(1.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9269, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
3 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-0.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3325, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
2 gae_duplicate tensor(-0.3347, dtype=torch.float64) tensor(0.6957, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-414.9234313964844
value loss:7.148085594177246
entropies:342.5343017578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.010619878768921 seconds
19 rew tensor(1.1123, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
19 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(1.0969, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0747, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
18 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-0.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9461, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
17 gae_duplicate tensor(-0.1463, dtype=torch.float64) tensor(1.6283, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9595, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
16 gae_duplicate tensor(-0.1897, dtype=torch.float64) tensor(0.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8824, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
15 gae_duplicate tensor(-0.2114, dtype=torch.float64) tensor(-1.9878, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4873, dtype=torch.float64) delta_t tensor(-0.2545, dtype=torch.float64)
14 gae_duplicate tensor(-1.1616, dtype=torch.float64) tensor(6.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2951, dtype=torch.float64) delta_t tensor(-0.1507, dtype=torch.float64)
13 gae_duplicate tensor(-1.3066, dtype=torch.float64) tensor(3.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3182, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
12 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-1.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3957, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
11 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(-1.2101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
10 gae_duplicate tensor(0.0108, dtype=torch.float64) tensor(-4.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(0.1981, dtype=torch.float64)
9 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-4.2399, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7446, dtype=torch.float64) delta_t tensor(-0.1387, dtype=torch.float64)
8 gae_duplicate tensor(-0.2878, dtype=torch.float64) tensor(2.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2724, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
7 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-2.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7577, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
6 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-1.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3226, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
5 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-0.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2449, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
4 gae_duplicate tensor(-0.0910, dtype=torch.float64) tensor(0.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7081, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
3 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(-0.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1267, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
2 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-1.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:190.94813537597656
value loss:9.170547485351562
entropies:342.45404052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.066847085952759 seconds
19 rew tensor(1.2153, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
19 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(0.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2028, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
18 gae_duplicate tensor(0.0438, dtype=torch.float64) tensor(-1.9645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9097, dtype=torch.float64) delta_t tensor(-0.1613, dtype=torch.float64)
17 gae_duplicate tensor(-1.5311, dtype=torch.float64) tensor(2.3981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9982, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
16 gae_duplicate tensor(-0.2237, dtype=torch.float64) tensor(0.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9473, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
15 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-1.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7808, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
14 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-1.0687, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7434, dtype=torch.float64) delta_t tensor(0.2468, dtype=torch.float64)
13 gae_duplicate tensor(0.0778, dtype=torch.float64) tensor(-4.6356, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
12 gae_duplicate tensor(-0.8451, dtype=torch.float64) tensor(0.6052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6356, dtype=torch.float64) delta_t tensor(-0.7560, dtype=torch.float64)
11 gae_duplicate tensor(-2.8170, dtype=torch.float64) tensor(13.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5583, dtype=torch.float64) delta_t tensor(-0.5182, dtype=torch.float64)
10 gae_duplicate tensor(-3.8328, dtype=torch.float64) tensor(10.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1655, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
9 gae_duplicate tensor(-0.3547, dtype=torch.float64) tensor(-0.7243, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5531, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
8 gae_duplicate tensor(-0.4288, dtype=torch.float64) tensor(-2.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7928, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
7 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-3.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7978, dtype=torch.float64) delta_t tensor(0.2141, dtype=torch.float64)
6 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-4.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4481, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
5 gae_duplicate tensor(-0.2940, dtype=torch.float64) tensor(-1.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1373, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
4 gae_duplicate tensor(0.0248, dtype=torch.float64) tensor(-2.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3079, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
3 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(2.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
2 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-3.6318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-251.70388793945312
value loss:53.23832702636719
entropies:342.33355712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.844722270965576 seconds
19 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
19 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(1.0320, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0618, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
18 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-0.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0106, dtype=torch.float64) delta_t tensor(0.0150, dtype=torch.float64)
17 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-0.2215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0240, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
16 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-0.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8698, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
15 gae_duplicate tensor(-0.1381, dtype=torch.float64) tensor(-0.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2268, dtype=torch.float64) delta_t tensor(-0.3519, dtype=torch.float64)
14 gae_duplicate tensor(-2.3831, dtype=torch.float64) tensor(9.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5877, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
13 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(-0.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
12 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-2.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
11 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(-0.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0138, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
10 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(-0.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3442, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
9 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-2.4826, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5005, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
8 gae_duplicate tensor(-0.1606, dtype=torch.float64) tensor(0.6932, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6958, dtype=torch.float64) delta_t tensor(-0.1202, dtype=torch.float64)
7 gae_duplicate tensor(-0.2842, dtype=torch.float64) tensor(2.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5777, dtype=torch.float64) delta_t tensor(0.1645, dtype=torch.float64)
6 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(-3.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5279, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
5 gae_duplicate tensor(-0.1968, dtype=torch.float64) tensor(1.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0394, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
4 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(0.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9392, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
3 gae_duplicate tensor(-0.3568, dtype=torch.float64) tensor(2.4142, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3193, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
2 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(-0.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-480.5897521972656
value loss:12.057650566101074
entropies:342.36053466796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3841.8633)
ToM Target loss= tensor(3958.1194)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.947953224182129 seconds
19 rew tensor(1.1640, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
19 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-0.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1256, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
18 gae_duplicate tensor(-0.0015, dtype=torch.float64) tensor(-1.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0617, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
17 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-0.0498, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0753, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
16 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-1.4390, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8699, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
15 gae_duplicate tensor(-0.2534, dtype=torch.float64) tensor(-0.6933, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7297, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
14 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(-3.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7294, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
13 gae_duplicate tensor(0.0446, dtype=torch.float64) tensor(-2.9651, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(-0.3594, dtype=torch.float64)
12 gae_duplicate tensor(-2.3281, dtype=torch.float64) tensor(6.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0334, dtype=torch.float64) delta_t tensor(-0.3159, dtype=torch.float64)
11 gae_duplicate tensor(-2.5885, dtype=torch.float64) tensor(6.1991, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2335, dtype=torch.float64) delta_t tensor(-0.2043, dtype=torch.float64)
10 gae_duplicate tensor(-1.0543, dtype=torch.float64) tensor(4.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3825, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
9 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-1.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5270, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
8 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(-0.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5653, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
7 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(-2.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8611, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
6 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-2.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2194, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
5 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-1.2710, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0403, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
4 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-0.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8233, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
3 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(-0.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2544, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
2 gae_duplicate tensor(-0.4380, dtype=torch.float64) tensor(-0.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:33.530216217041016
value loss:25.022844314575195
entropies:342.1946105957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6231348514556885 seconds
19 rew tensor(1.1899, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
19 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(0.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1902, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
18 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-2.6414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0498, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
17 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-0.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
16 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-0.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9088, dtype=torch.float64) delta_t tensor(0.2456, dtype=torch.float64)
15 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-4.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2271, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
14 gae_duplicate tensor(-1.1694, dtype=torch.float64) tensor(1.2285, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6134, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
13 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-1.1599, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1139, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
12 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-1.5750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6524, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
11 gae_duplicate tensor(0.0364, dtype=torch.float64) tensor(-2.5944, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2968, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
10 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(2.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7160, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
9 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-3.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7834, dtype=torch.float64) delta_t tensor(-0.1717, dtype=torch.float64)
8 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(2.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2852, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
7 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(-0.1412, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8093, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
6 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(1.1269, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2206, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
5 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(0.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1938, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
4 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(0.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7086, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
3 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(1.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1651, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
2 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(0.0346, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:299.4901428222656
value loss:6.335360527038574
entropies:342.1346740722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.572790145874023 seconds
19 rew tensor(1.1895, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
19 gae_duplicate tensor(-0.1010, dtype=torch.float64) tensor(-0.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0877, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
18 gae_duplicate tensor(0.0071, dtype=torch.float64) tensor(-1.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9596, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
17 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-0.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0366, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
16 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-1.4040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7804, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
15 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(0.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8063, dtype=torch.float64) delta_t tensor(0.3177, dtype=torch.float64)
14 gae_duplicate tensor(0.0282, dtype=torch.float64) tensor(-5.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2657, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
13 gae_duplicate tensor(-1.1489, dtype=torch.float64) tensor(2.1955, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
12 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-1.6217, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2416, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
11 gae_duplicate tensor(-0.2727, dtype=torch.float64) tensor(0.6480, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0656, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
10 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(1.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2674, dtype=torch.float64) delta_t tensor(0.1900, dtype=torch.float64)
9 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-3.8171, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3991, dtype=torch.float64) delta_t tensor(-0.1818, dtype=torch.float64)
8 gae_duplicate tensor(-0.3027, dtype=torch.float64) tensor(2.9444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3991, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
7 gae_duplicate tensor(-0.3358, dtype=torch.float64) tensor(0.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5533, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
6 gae_duplicate tensor(-0.2480, dtype=torch.float64) tensor(0.2701, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8867, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
5 gae_duplicate tensor(-0.2440, dtype=torch.float64) tensor(0.4916, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
4 gae_duplicate tensor(-0.0936, dtype=torch.float64) tensor(-0.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5924, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
3 gae_duplicate tensor(-0.4343, dtype=torch.float64) tensor(2.5019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6513, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
2 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-0.6084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:118.72999572753906
value loss:6.741067886352539
entropies:342.0651550292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.648040056228638 seconds
19 rew tensor(0.9197, dtype=torch.float64) delta_t tensor(-0.2220, dtype=torch.float64)
19 gae_duplicate tensor(-1.3483, dtype=torch.float64) tensor(4.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1393, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
18 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-2.6208, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1261, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
17 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-3.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9214, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
16 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-0.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
15 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(-2.1188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0637, dtype=torch.float64) delta_t tensor(-0.4138, dtype=torch.float64)
14 gae_duplicate tensor(-1.2995, dtype=torch.float64) tensor(7.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6777, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
13 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-3.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3183, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
12 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(-2.5539, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1538, dtype=torch.float64) delta_t tensor(-0.1556, dtype=torch.float64)
11 gae_duplicate tensor(-1.2612, dtype=torch.float64) tensor(4.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0281, dtype=torch.float64) delta_t tensor(0.1025, dtype=torch.float64)
10 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-1.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3580, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
9 gae_duplicate tensor(-0.2239, dtype=torch.float64) tensor(-1.0015, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6818, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
8 gae_duplicate tensor(-0.2139, dtype=torch.float64) tensor(0.5531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2710, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
7 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(0.5172, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
6 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(-3.2849, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3995, dtype=torch.float64) delta_t tensor(-0.2444, dtype=torch.float64)
5 gae_duplicate tensor(-0.7976, dtype=torch.float64) tensor(4.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3230, dtype=torch.float64) delta_t tensor(-0.1139, dtype=torch.float64)
4 gae_duplicate tensor(-0.3648, dtype=torch.float64) tensor(2.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7073, dtype=torch.float64) delta_t tensor(-0.1396, dtype=torch.float64)
3 gae_duplicate tensor(-0.3396, dtype=torch.float64) tensor(3.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0104, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
2 gae_duplicate tensor(-0.3116, dtype=torch.float64) tensor(-0.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-436.6047058105469
value loss:15.227198600769043
entropies:341.95989990234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.606407880783081 seconds
19 rew tensor(1.1521, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
19 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-0.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1781, dtype=torch.float64) delta_t tensor(0.2004, dtype=torch.float64)
18 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-4.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0367, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
17 gae_duplicate tensor(-0.0784, dtype=torch.float64) tensor(-1.0090, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
16 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(0.2989, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8575, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
15 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-2.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6137, dtype=torch.float64) delta_t tensor(0.1652, dtype=torch.float64)
14 gae_duplicate tensor(0.0444, dtype=torch.float64) tensor(-3.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8320, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
13 gae_duplicate tensor(0.1078, dtype=torch.float64) tensor(-4.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2028, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
12 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(-0.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1167, dtype=torch.float64) delta_t tensor(-0.3274, dtype=torch.float64)
11 gae_duplicate tensor(-2.7049, dtype=torch.float64) tensor(5.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1182, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
10 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(0.6157, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3578, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
9 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(0.9113, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6178, dtype=torch.float64) delta_t tensor(0.0366, dtype=torch.float64)
8 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-0.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1525, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
7 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-0.5850, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9008, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
6 gae_duplicate tensor(-0.3949, dtype=torch.float64) tensor(0.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9381, dtype=torch.float64) delta_t tensor(-0.1191, dtype=torch.float64)
5 gae_duplicate tensor(-0.3433, dtype=torch.float64) tensor(2.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5033, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
4 gae_duplicate tensor(-0.2296, dtype=torch.float64) tensor(1.2386, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1684, dtype=torch.float64) delta_t tensor(0.1739, dtype=torch.float64)
3 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-3.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1568, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
2 gae_duplicate tensor(-0.3068, dtype=torch.float64) tensor(0.7320, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:406.58697509765625
value loss:15.920650482177734
entropies:341.8167419433594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3815.5869)
ToM Target loss= tensor(3959.6514)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.840027809143066 seconds
19 rew tensor(1.2415, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
19 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1649, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
18 gae_duplicate tensor(0.0699, dtype=torch.float64) tensor(-2.7507, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1010, dtype=torch.float64) delta_t tensor(0.1260, dtype=torch.float64)
17 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-2.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0629, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
16 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-2.3617, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8576, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
15 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-2.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5388, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
14 gae_duplicate tensor(-1.3550, dtype=torch.float64) tensor(0.9264, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4475, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
13 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(-0.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5628, dtype=torch.float64) delta_t tensor(0.1783, dtype=torch.float64)
12 gae_duplicate tensor(0.0334, dtype=torch.float64) tensor(-3.7646, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2671, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
11 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-0.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0635, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
10 gae_duplicate tensor(-0.0865, dtype=torch.float64) tensor(-0.7639, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(0.2915, dtype=torch.float64)
9 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-5.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4506, dtype=torch.float64) delta_t tensor(-0.1921, dtype=torch.float64)
8 gae_duplicate tensor(-0.5602, dtype=torch.float64) tensor(2.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7872, dtype=torch.float64) delta_t tensor(-0.3147, dtype=torch.float64)
7 gae_duplicate tensor(-1.1000, dtype=torch.float64) tensor(5.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6050, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
6 gae_duplicate tensor(-0.3293, dtype=torch.float64) tensor(0.6621, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8628, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
5 gae_duplicate tensor(-0.3337, dtype=torch.float64) tensor(-0.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4730, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
4 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-2.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7615, dtype=torch.float64) delta_t tensor(-0.2135, dtype=torch.float64)
3 gae_duplicate tensor(-0.4388, dtype=torch.float64) tensor(4.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8323, dtype=torch.float64) delta_t tensor(0.2440, dtype=torch.float64)
2 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-4.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:721.8983764648438
value loss:13.787435531616211
entropies:341.80718994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.846950054168701 seconds
19 rew tensor(1.1393, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
19 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(0.0995, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1136, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
18 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-2.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
17 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-1.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8830, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-0.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8961, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
15 gae_duplicate tensor(-0.0738, dtype=torch.float64) tensor(-1.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6650, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
14 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(-2.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6530, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
13 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(-1.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2798, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
12 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(-0.6629, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3837, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
11 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-0.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0150, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3055, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
9 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-1.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5917, dtype=torch.float64) delta_t tensor(-0.1582, dtype=torch.float64)
8 gae_duplicate tensor(-0.2838, dtype=torch.float64) tensor(2.6972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5674, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
7 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(-1.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6945, dtype=torch.float64) delta_t tensor(0.1195, dtype=torch.float64)
6 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(-2.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4265, dtype=torch.float64) delta_t tensor(-0.1329, dtype=torch.float64)
5 gae_duplicate tensor(-0.6389, dtype=torch.float64) tensor(3.0537, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0657, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
4 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9272, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
3 gae_duplicate tensor(-0.2430, dtype=torch.float64) tensor(1.9822, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2935, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
2 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.7743, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:438.58660888671875
value loss:4.864669322967529
entropies:341.76385498046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7084431648254395 seconds
19 rew tensor(1.1391, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
19 gae_duplicate tensor(-0.1356, dtype=torch.float64) tensor(0.7589, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1393, dtype=torch.float64) delta_t tensor(0.1037, dtype=torch.float64)
18 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-1.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0240, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
17 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(0.0290, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9344, dtype=torch.float64) delta_t tensor(-0.0518, dtype=torch.float64)
16 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
15 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-2.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2047, dtype=torch.float64) delta_t tensor(-0.2941, dtype=torch.float64)
14 gae_duplicate tensor(-0.8699, dtype=torch.float64) tensor(5.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7300, dtype=torch.float64) delta_t tensor(0.1802, dtype=torch.float64)
13 gae_duplicate tensor(0.0052, dtype=torch.float64) tensor(-3.3507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2803, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
12 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-3.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7552, dtype=torch.float64) delta_t tensor(0.2306, dtype=torch.float64)
11 gae_duplicate tensor(0.0788, dtype=torch.float64) tensor(-5.1501, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1816, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
10 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(0.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
9 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-1.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6560, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
8 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(2.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6957, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
7 gae_duplicate tensor(-1.3340, dtype=torch.float64) tensor(2.3664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7462, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
6 gae_duplicate tensor(-0.3043, dtype=torch.float64) tensor(0.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3246, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
5 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(-1.1967, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0922, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
4 gae_duplicate tensor(-0.2140, dtype=torch.float64) tensor(1.4842, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8499, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
3 gae_duplicate tensor(-0.2313, dtype=torch.float64) tensor(2.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2670, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
2 gae_duplicate tensor(-0.3165, dtype=torch.float64) tensor(0.0210, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:46.979061126708984
value loss:9.296873092651367
entropies:341.6903381347656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.601977825164795 seconds
19 rew tensor(1.1525, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
19 gae_duplicate tensor(-0.1332, dtype=torch.float64) tensor(1.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1398, dtype=torch.float64) delta_t tensor(0.0781, dtype=torch.float64)
18 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(-1.3116, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
17 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(0.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9986, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
16 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-0.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8702, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
15 gae_duplicate tensor(-0.2294, dtype=torch.float64) tensor(-0.8188, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3715, dtype=torch.float64) delta_t tensor(-0.1970, dtype=torch.float64)
14 gae_duplicate tensor(-0.9475, dtype=torch.float64) tensor(3.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5885, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
13 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-0.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2030, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
12 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-0.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4983, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
11 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(-1.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
10 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-0.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5881, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
9 gae_duplicate tensor(0.0843, dtype=torch.float64) tensor(-4.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7343, dtype=torch.float64) delta_t tensor(-0.1597, dtype=torch.float64)
8 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(2.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3735, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
7 gae_duplicate tensor(-0.3641, dtype=torch.float64) tensor(1.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7471, dtype=torch.float64) delta_t tensor(-0.0278, dtype=torch.float64)
6 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(0.9667, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2984, dtype=torch.float64) delta_t tensor(-0.1043, dtype=torch.float64)
5 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(2.2594, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1958, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
4 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(0.5336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(-0.0599, dtype=torch.float64)
3 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(1.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1636, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
2 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-0.1482, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-360.45233154296875
value loss:4.377969741821289
entropies:341.8399963378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.765891790390015 seconds
19 rew tensor(1.1654, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
19 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(0.9830, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1013, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
18 gae_duplicate tensor(-0.0806, dtype=torch.float64) tensor(-0.5974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0499, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
17 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-0.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0113, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
16 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(-0.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(-0.1723, dtype=torch.float64)
15 gae_duplicate tensor(-1.4254, dtype=torch.float64) tensor(2.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6779, dtype=torch.float64) delta_t tensor(0.1986, dtype=torch.float64)
14 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-4.8083, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6009, dtype=torch.float64) delta_t tensor(0.0643, dtype=torch.float64)
13 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(-1.4333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3447, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
12 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-2.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5109, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
11 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-2.6916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0525, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
10 gae_duplicate tensor(-0.2802, dtype=torch.float64) tensor(0.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3179, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
9 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-2.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5024, dtype=torch.float64) delta_t tensor(-0.1130, dtype=torch.float64)
8 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(2.1137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1552, dtype=torch.float64) delta_t tensor(-0.1489, dtype=torch.float64)
7 gae_duplicate tensor(-0.8185, dtype=torch.float64) tensor(2.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6182, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
6 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(-1.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5820, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
5 gae_duplicate tensor(-0.2169, dtype=torch.float64) tensor(-1.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1378, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
4 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-0.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2088, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
3 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(0.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
2 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(-2.1455, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:404.45733642578125
value loss:9.446803092956543
entropies:341.9204406738281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3835.6211)
ToM Target loss= tensor(3961.7759)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.836262941360474 seconds
19 rew tensor(1.1900, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
19 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(1.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1515, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
18 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-0.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1385, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
17 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-0.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0108, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
16 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(0.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9722, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
15 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-0.9620, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2801, dtype=torch.float64) delta_t tensor(-0.3825, dtype=torch.float64)
14 gae_duplicate tensor(-2.2929, dtype=torch.float64) tensor(9.9149, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
13 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-4.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4724, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
12 gae_duplicate tensor(-0.2254, dtype=torch.float64) tensor(-2.5796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.1001, dtype=torch.float64) delta_t tensor(-1.3099, dtype=torch.float64)
11 gae_duplicate tensor(-8.0347, dtype=torch.float64) tensor(23.5144, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
10 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(0.8104, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
9 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(-1.7632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5923, dtype=torch.float64) delta_t tensor(-0.1148, dtype=torch.float64)
8 gae_duplicate tensor(-0.3151, dtype=torch.float64) tensor(1.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1825, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
7 gae_duplicate tensor(-2.2690, dtype=torch.float64) tensor(5.5564, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8240, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
6 gae_duplicate tensor(-0.5168, dtype=torch.float64) tensor(-0.2089, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5819, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
5 gae_duplicate tensor(-0.8043, dtype=torch.float64) tensor(2.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0929, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
4 gae_duplicate tensor(-0.5568, dtype=torch.float64) tensor(0.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1967, dtype=torch.float64) delta_t tensor(-0.1573, dtype=torch.float64)
3 gae_duplicate tensor(-0.4042, dtype=torch.float64) tensor(2.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
2 gae_duplicate tensor(-0.3547, dtype=torch.float64) tensor(-0.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2120.880126953125
value loss:120.17881774902344
entropies:342.1455078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.936901807785034 seconds
19 rew tensor(1.1387, dtype=torch.float64) delta_t tensor(-0.0977, dtype=torch.float64)
19 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(1.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1132, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
18 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-0.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0493, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
17 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-0.0003, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6912, dtype=torch.float64) delta_t tensor(-0.3742, dtype=torch.float64)
16 gae_duplicate tensor(-1.5549, dtype=torch.float64) tensor(8.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8703, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
15 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(1.2947, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7931, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
14 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-2.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6008, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
13 gae_duplicate tensor(-0.0404, dtype=torch.float64) tensor(-4.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
12 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(-1.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3962, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
11 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(0.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0665, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
10 gae_duplicate tensor(-0.1269, dtype=torch.float64) tensor(-0.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4100, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
9 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-3.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6062, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
8 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-0.4763, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7948, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
7 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-2.4099, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7219, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
6 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-1.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5783, dtype=torch.float64) delta_t tensor(-0.0200, dtype=torch.float64)
5 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(0.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0164, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
4 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(0.5734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1431, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
3 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(1.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3296, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
2 gae_duplicate tensor(-0.1626, dtype=torch.float64) tensor(0.2047, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:45.313629150390625
value loss:9.855274200439453
entropies:342.2315368652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.762321949005127 seconds
19 rew tensor(1.1902, dtype=torch.float64) delta_t tensor(-0.0923, dtype=torch.float64)
19 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(1.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2034, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
18 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-1.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0235, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
17 gae_duplicate tensor(-0.1757, dtype=torch.float64) tensor(1.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
16 gae_duplicate tensor(-0.2382, dtype=torch.float64) tensor(2.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9083, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
15 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(-0.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
14 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-1.0261, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4999, dtype=torch.float64) delta_t tensor(-0.1531, dtype=torch.float64)
13 gae_duplicate tensor(-1.1450, dtype=torch.float64) tensor(2.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4590, dtype=torch.float64) delta_t tensor(-0.7162, dtype=torch.float64)
12 gae_duplicate tensor(-4.0221, dtype=torch.float64) tensor(13.4405, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2046, dtype=torch.float64) delta_t tensor(-0.1878, dtype=torch.float64)
11 gae_duplicate tensor(-1.7791, dtype=torch.float64) tensor(4.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0023, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
10 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(0.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3703, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
9 gae_duplicate tensor(-0.2229, dtype=torch.float64) tensor(-0.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6697, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
8 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(1.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2700, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
7 gae_duplicate tensor(-0.2949, dtype=torch.float64) tensor(-0.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7209, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
6 gae_duplicate tensor(-0.1397, dtype=torch.float64) tensor(-1.5253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3484, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
5 gae_duplicate tensor(-0.2007, dtype=torch.float64) tensor(0.1759, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2470, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
4 gae_duplicate tensor(-0.2348, dtype=torch.float64) tensor(1.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7197, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
3 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(-1.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1121, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
2 gae_duplicate tensor(-0.0015, dtype=torch.float64) tensor(-1.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1223.2708740234375
value loss:34.70259094238281
entropies:342.11761474609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.746496200561523 seconds
19 rew tensor(1.2031, dtype=torch.float64) delta_t tensor(-0.1081, dtype=torch.float64)
19 gae_duplicate tensor(-0.1633, dtype=torch.float64) tensor(1.9574, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1646, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
18 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-0.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8461, dtype=torch.float64) delta_t tensor(-0.2482, dtype=torch.float64)
17 gae_duplicate tensor(-1.4684, dtype=torch.float64) tensor(4.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0627, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
16 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(-0.7569, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8574, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
15 gae_duplicate tensor(-0.3393, dtype=torch.float64) tensor(-1.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5231, dtype=torch.float64) delta_t tensor(0.2094, dtype=torch.float64)
14 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(-5.5615, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6658, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
13 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-2.2261, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1891, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
12 gae_duplicate tensor(-0.2745, dtype=torch.float64) tensor(-2.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6527, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
11 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-3.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3104, dtype=torch.float64) delta_t tensor(-0.1529, dtype=torch.float64)
10 gae_duplicate tensor(-0.2950, dtype=torch.float64) tensor(2.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5756, dtype=torch.float64) delta_t tensor(0.1701, dtype=torch.float64)
9 gae_duplicate tensor(-0.0853, dtype=torch.float64) tensor(-3.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5796, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
8 gae_duplicate tensor(-0.2389, dtype=torch.float64) tensor(1.4256, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5248, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
7 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-2.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8115, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
6 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-2.8071, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2701, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
5 gae_duplicate tensor(-0.5138, dtype=torch.float64) tensor(-0.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1202, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
4 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8201, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
3 gae_duplicate tensor(-0.2158, dtype=torch.float64) tensor(1.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2003, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
2 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(1.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:577.6122436523438
value loss:10.432379722595215
entropies:341.88397216796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8873138427734375 seconds
19 rew tensor(1.2417, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
19 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.7863, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2289, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
18 gae_duplicate tensor(0.0219, dtype=torch.float64) tensor(-1.7300, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0881, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
17 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-0.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7428, dtype=torch.float64) delta_t tensor(-0.2947, dtype=torch.float64)
16 gae_duplicate tensor(-1.5227, dtype=torch.float64) tensor(5.2800, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5868, dtype=torch.float64) delta_t tensor(-0.2763, dtype=torch.float64)
15 gae_duplicate tensor(-1.5333, dtype=torch.float64) tensor(7.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7813, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
14 gae_duplicate tensor(-0.1323, dtype=torch.float64) tensor(-1.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2297, dtype=torch.float64) delta_t tensor(-0.1961, dtype=torch.float64)
13 gae_duplicate tensor(-1.3497, dtype=torch.float64) tensor(3.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4727, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
12 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-0.2381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2032, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
11 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-0.8886, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
10 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-2.6694, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
9 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-3.3309, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5531, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
8 gae_duplicate tensor(-0.3474, dtype=torch.float64) tensor(2.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4175, dtype=torch.float64) delta_t tensor(-0.2305, dtype=torch.float64)
7 gae_duplicate tensor(-1.1929, dtype=torch.float64) tensor(4.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6565, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
6 gae_duplicate tensor(-0.3529, dtype=torch.float64) tensor(-0.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7358, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
5 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(0.1328, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2172, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
4 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-3.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4684, dtype=torch.float64) delta_t tensor(-0.1259, dtype=torch.float64)
3 gae_duplicate tensor(-0.5011, dtype=torch.float64) tensor(1.6870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5506, dtype=torch.float64) delta_t tensor(0.1882, dtype=torch.float64)
2 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-3.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-524.972412109375
value loss:17.720815658569336
entropies:341.95977783203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3831.5828)
ToM Target loss= tensor(3965.6179)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.037038803100586 seconds
19 rew tensor(1.1775, dtype=torch.float64) delta_t tensor(-0.0798, dtype=torch.float64)
19 gae_duplicate tensor(-0.1318, dtype=torch.float64) tensor(1.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1519, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
18 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-0.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0752, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
17 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(0.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
16 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(1.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9859, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
15 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-2.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7809, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
14 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(-0.7354, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
13 gae_duplicate tensor(-0.0439, dtype=torch.float64) tensor(-1.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0371, dtype=torch.float64) delta_t tensor(-0.3734, dtype=torch.float64)
12 gae_duplicate tensor(-2.9825, dtype=torch.float64) tensor(6.6561, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9436, dtype=torch.float64) delta_t tensor(-1.1964, dtype=torch.float64)
11 gae_duplicate tensor(-3.3202, dtype=torch.float64) tensor(22.3136, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7371, dtype=torch.float64) delta_t tensor(-0.2745, dtype=torch.float64)
10 gae_duplicate tensor(-3.7843, dtype=torch.float64) tensor(6.6458, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(-0.2101, dtype=torch.float64)
9 gae_duplicate tensor(-2.0426, dtype=torch.float64) tensor(4.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7468, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
8 gae_duplicate tensor(-0.1991, dtype=torch.float64) tensor(-0.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0236, dtype=torch.float64) delta_t tensor(0.1713, dtype=torch.float64)
7 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-3.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9654, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
6 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-0.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1704, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
5 gae_duplicate tensor(-0.4838, dtype=torch.float64) tensor(2.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4774, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
4 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(2.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5556, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
3 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(0.7715, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1312, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
2 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(-0.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2179.042236328125
value loss:77.6755599975586
entropies:341.88031005859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.724500894546509 seconds
19 rew tensor(1.1642, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
19 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(1.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
18 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-0.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1133, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
17 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-0.8880, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9985, dtype=torch.float64) delta_t tensor(-0.0093, dtype=torch.float64)
16 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(0.0751, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8575, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
15 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(0.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4081, dtype=torch.float64) delta_t tensor(-0.2278, dtype=torch.float64)
14 gae_duplicate tensor(-1.5167, dtype=torch.float64) tensor(4.0772, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6396, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
13 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-2.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3832, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
12 gae_duplicate tensor(-0.3833, dtype=torch.float64) tensor(-0.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
11 gae_duplicate tensor(-0.3246, dtype=torch.float64) tensor(1.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0745, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
10 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(0.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1912, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
9 gae_duplicate tensor(-0.0574, dtype=torch.float64) tensor(-1.8402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4119, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
8 gae_duplicate tensor(-0.4147, dtype=torch.float64) tensor(0.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8985, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
7 gae_duplicate tensor(-0.3627, dtype=torch.float64) tensor(0.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6809, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
6 gae_duplicate tensor(-0.4893, dtype=torch.float64) tensor(-0.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5026, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
5 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(1.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0668, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
4 gae_duplicate tensor(-0.4128, dtype=torch.float64) tensor(1.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9634, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
3 gae_duplicate tensor(-0.4761, dtype=torch.float64) tensor(0.9802, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2923, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
2 gae_duplicate tensor(-0.4421, dtype=torch.float64) tensor(-0.5996, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-399.9622497558594
value loss:8.661076545715332
entropies:341.9486389160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.786289215087891 seconds
19 rew tensor(1.1136, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
19 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(1.7923, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1008, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
18 gae_duplicate tensor(-0.0713, dtype=torch.float64) tensor(-0.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0757, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
17 gae_duplicate tensor(-0.1527, dtype=torch.float64) tensor(-0.4293, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0372, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
16 gae_duplicate tensor(-0.2229, dtype=torch.float64) tensor(-0.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8576, dtype=torch.float64) delta_t tensor(-0.0457, dtype=torch.float64)
15 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(1.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2409, dtype=torch.float64) delta_t tensor(-0.4928, dtype=torch.float64)
14 gae_duplicate tensor(-1.5224, dtype=torch.float64) tensor(9.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4089, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
13 gae_duplicate tensor(-1.3863, dtype=torch.float64) tensor(2.2933, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(-0.0189, dtype=torch.float64)
12 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3061, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
11 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-0.0686, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0618, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
10 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-0.4245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1782, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
9 gae_duplicate tensor(-0.2354, dtype=torch.float64) tensor(-0.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4631, dtype=torch.float64) delta_t tensor(-0.0764, dtype=torch.float64)
8 gae_duplicate tensor(-0.1737, dtype=torch.float64) tensor(1.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8114, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
7 gae_duplicate tensor(-0.0126, dtype=torch.float64) tensor(-1.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5532, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
6 gae_duplicate tensor(0.0528, dtype=torch.float64) tensor(-4.1903, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6319, dtype=torch.float64) delta_t tensor(-0.0673, dtype=torch.float64)
5 gae_duplicate tensor(-0.2405, dtype=torch.float64) tensor(0.8196, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0111, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
4 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-0.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0681, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
3 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(0.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3573, dtype=torch.float64) delta_t tensor(0.0545, dtype=torch.float64)
2 gae_duplicate tensor(-0.1047, dtype=torch.float64) tensor(-0.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-559.2648315429688
value loss:11.687589645385742
entropies:342.0762023925781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.680382966995239 seconds
19 rew tensor(1.1901, dtype=torch.float64) delta_t tensor(-0.0749, dtype=torch.float64)
19 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(1.5670, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1904, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
18 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-1.4092, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1391, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
17 gae_duplicate tensor(-0.0114, dtype=torch.float64) tensor(-0.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0495, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
16 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-0.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0110, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
15 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(-0.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(-0.3096, dtype=torch.float64)
14 gae_duplicate tensor(-2.5244, dtype=torch.float64) tensor(4.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1799, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
13 gae_duplicate tensor(-1.1668, dtype=torch.float64) tensor(5.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2169, dtype=torch.float64) delta_t tensor(-0.3184, dtype=torch.float64)
12 gae_duplicate tensor(-2.0620, dtype=torch.float64) tensor(8.9740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0895, dtype=torch.float64) delta_t tensor(-0.2732, dtype=torch.float64)
11 gae_duplicate tensor(-1.8631, dtype=torch.float64) tensor(5.4078, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0785, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
10 gae_duplicate tensor(-0.1931, dtype=torch.float64) tensor(-0.1367, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4589, dtype=torch.float64) delta_t tensor(0.1762, dtype=torch.float64)
9 gae_duplicate tensor(-0.0028, dtype=torch.float64) tensor(-3.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6296, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
8 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(1.3526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8232, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
7 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-3.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7069, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
6 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-0.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6316, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
5 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(0.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
4 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(1.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2335, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
3 gae_duplicate tensor(-0.2727, dtype=torch.float64) tensor(0.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
2 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(-0.0695, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1051.1917724609375
value loss:28.868831634521484
entropies:342.19384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.656933069229126 seconds
19 rew tensor(1.2287, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
19 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(0.2557, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1386, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
18 gae_duplicate tensor(-0.0640, dtype=torch.float64) tensor(-1.7197, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1136, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
17 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-1.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9343, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
16 gae_duplicate tensor(-0.1609, dtype=torch.float64) tensor(0.7741, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9605, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
15 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(-2.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4747, dtype=torch.float64) delta_t tensor(-0.2358, dtype=torch.float64)
14 gae_duplicate tensor(-1.1193, dtype=torch.float64) tensor(3.9987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6782, dtype=torch.float64) delta_t tensor(0.1629, dtype=torch.float64)
13 gae_duplicate tensor(-0.0045, dtype=torch.float64) tensor(-2.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
12 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-2.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4257, dtype=torch.float64) delta_t tensor(-0.6530, dtype=torch.float64)
11 gae_duplicate tensor(-4.0880, dtype=torch.float64) tensor(11.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3619, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
10 gae_duplicate tensor(-2.5981, dtype=torch.float64) tensor(6.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
9 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(0.6802, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5926, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
8 gae_duplicate tensor(-0.3654, dtype=torch.float64) tensor(2.7097, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7186, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
7 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(-1.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7082, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
6 gae_duplicate tensor(0.0187, dtype=torch.float64) tensor(-2.1403, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5276, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
5 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(0.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0102, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
4 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-1.7622, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1435, dtype=torch.float64) delta_t tensor(-0.1166, dtype=torch.float64)
3 gae_duplicate tensor(-0.4111, dtype=torch.float64) tensor(1.9909, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3693, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
2 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-2.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-752.4965209960938
value loss:41.76509094238281
entropies:342.119384765625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3850.9871)
ToM Target loss= tensor(3966.5410)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.056577682495117 seconds
19 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
19 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(0.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1139, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
18 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-2.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8202, dtype=torch.float64) delta_t tensor(-0.1890, dtype=torch.float64)
17 gae_duplicate tensor(-1.4953, dtype=torch.float64) tensor(3.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9599, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
16 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(0.4562, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8962, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
15 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(0.1190, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4602, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
14 gae_duplicate tensor(-1.1870, dtype=torch.float64) tensor(3.3478, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6529, dtype=torch.float64) delta_t tensor(0.1329, dtype=torch.float64)
13 gae_duplicate tensor(0.0670, dtype=torch.float64) tensor(-2.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0751, dtype=torch.float64) delta_t tensor(-0.2361, dtype=torch.float64)
12 gae_duplicate tensor(-1.2102, dtype=torch.float64) tensor(4.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4479, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
11 gae_duplicate tensor(-0.1185, dtype=torch.float64) tensor(-0.6636, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0109, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
10 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-0.3580, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2679, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
9 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-1.5213, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4763, dtype=torch.float64) delta_t tensor(-0.0301, dtype=torch.float64)
8 gae_duplicate tensor(-0.1865, dtype=torch.float64) tensor(0.4162, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6562, dtype=torch.float64) delta_t tensor(-0.0495, dtype=torch.float64)
7 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(0.9583, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5919, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
6 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-2.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5281, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
5 gae_duplicate tensor(-0.4745, dtype=torch.float64) tensor(2.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0402, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
4 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(0.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9260, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
3 gae_duplicate tensor(-0.3396, dtype=torch.float64) tensor(-0.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3317, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
2 gae_duplicate tensor(-0.2912, dtype=torch.float64) tensor(-1.3861, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-338.56744384765625
value loss:10.654629707336426
entropies:342.0873718261719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.683108806610107 seconds
19 rew tensor(1.2290, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
19 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(0.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2292, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
18 gae_duplicate tensor(0.0355, dtype=torch.float64) tensor(-2.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1781, dtype=torch.float64) delta_t tensor(0.1099, dtype=torch.float64)
17 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(-2.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0753, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
16 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-1.0659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9984, dtype=torch.float64) delta_t tensor(0.1480, dtype=torch.float64)
15 gae_duplicate tensor(-0.0631, dtype=torch.float64) tensor(-3.0978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-1.0132, dtype=torch.float64) delta_t tensor(-1.3496, dtype=torch.float64)
14 gae_duplicate tensor(-2.4257, dtype=torch.float64) tensor(27.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
13 gae_duplicate tensor(-1.0149, dtype=torch.float64) tensor(4.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4219, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
12 gae_duplicate tensor(0.0353, dtype=torch.float64) tensor(-3.9181, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
11 gae_duplicate tensor(-0.2236, dtype=torch.float64) tensor(-3.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0140, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
10 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-1.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3441, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
9 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-1.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5399, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
8 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(2.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3718, dtype=torch.float64) delta_t tensor(-0.3284, dtype=torch.float64)
7 gae_duplicate tensor(-2.1045, dtype=torch.float64) tensor(8.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7577, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
6 gae_duplicate tensor(-0.6619, dtype=torch.float64) tensor(1.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5038, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
5 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-2.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1651, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
4 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-0.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3112, dtype=torch.float64) delta_t tensor(-0.0920, dtype=torch.float64)
3 gae_duplicate tensor(-0.4255, dtype=torch.float64) tensor(1.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5242, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
2 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(-1.8240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1256.3095703125
value loss:40.650367736816406
entropies:341.9976501464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754710912704468 seconds
19 rew tensor(1.0883, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
19 gae_duplicate tensor(-0.1111, dtype=torch.float64) tensor(0.8606, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1270, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
18 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-2.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0244, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
17 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-1.3086, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9091, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
16 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-0.3628, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8706, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
15 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-2.2550, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6783, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
14 gae_duplicate tensor(-0.0254, dtype=torch.float64) tensor(-1.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.1359, dtype=torch.float64)
13 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-2.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2293, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
12 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(0.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
11 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(-1.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0526, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
10 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(0.1376, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
9 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(-2.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5536, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
8 gae_duplicate tensor(-0.3521, dtype=torch.float64) tensor(1.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6556, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
7 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-1.9574, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6435, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
6 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-0.5596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4763, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
5 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(1.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0145, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
4 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(0.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9389, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
3 gae_duplicate tensor(-0.3321, dtype=torch.float64) tensor(1.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3573, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
2 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(-1.8879, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:544.6566162109375
value loss:3.5173420906066895
entropies:341.7642822265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.585340976715088 seconds
19 rew tensor(0.9202, dtype=torch.float64) delta_t tensor(-0.2026, dtype=torch.float64)
19 gae_duplicate tensor(-1.3930, dtype=torch.float64) tensor(3.7350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1272, dtype=torch.float64) delta_t tensor(0.1309, dtype=torch.float64)
18 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-2.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0633, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
17 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-2.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
16 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-0.0480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8193, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
15 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-2.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6783, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
14 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-2.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6776, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
13 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-2.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3840, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
12 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-0.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
11 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-2.3783, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
10 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-0.6370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1904, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
9 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(-1.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4248, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
8 gae_duplicate tensor(-0.0987, dtype=torch.float64) tensor(-0.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6954, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
7 gae_duplicate tensor(-0.0929, dtype=torch.float64) tensor(-0.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6305, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
6 gae_duplicate tensor(-0.0039, dtype=torch.float64) tensor(-3.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4262, dtype=torch.float64) delta_t tensor(-0.1211, dtype=torch.float64)
5 gae_duplicate tensor(-0.2209, dtype=torch.float64) tensor(1.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1428, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
4 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(0.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7084, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
3 gae_duplicate tensor(-0.2766, dtype=torch.float64) tensor(0.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1520, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
2 gae_duplicate tensor(-0.5758, dtype=torch.float64) tensor(2.0415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:611.9404296875
value loss:8.047101974487305
entropies:341.53717041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.815840005874634 seconds
19 rew tensor(1.1895, dtype=torch.float64) delta_t tensor(0.0107, dtype=torch.float64)
19 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-0.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
18 gae_duplicate tensor(0.0646, dtype=torch.float64) tensor(-2.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0874, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
17 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-0.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9977, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
16 gae_duplicate tensor(-0.0664, dtype=torch.float64) tensor(-0.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(-0.0510, dtype=torch.float64) delta_t tensor(-0.7980, dtype=torch.float64)
15 gae_duplicate tensor(-2.6801, dtype=torch.float64) tensor(14.3583, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7669, dtype=torch.float64) delta_t tensor(0.2305, dtype=torch.float64)
14 gae_duplicate tensor(-0.0437, dtype=torch.float64) tensor(-2.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7669, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
13 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(-3.2626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3700, dtype=torch.float64) delta_t tensor(0.2309, dtype=torch.float64)
12 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-4.9247, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
11 gae_duplicate tensor(-0.1237, dtype=torch.float64) tensor(-1.8683, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0497, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
10 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-2.0026, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3835, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
9 gae_duplicate tensor(-0.1762, dtype=torch.float64) tensor(-1.3000, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5524, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
8 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(0.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.8421, dtype=torch.float64) delta_t tensor(-1.8752, dtype=torch.float64)
7 gae_duplicate tensor(-6.8023, dtype=torch.float64) tensor(33.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9262, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
6 gae_duplicate tensor(-0.9848, dtype=torch.float64) tensor(3.6907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2723, dtype=torch.float64) delta_t tensor(0.1821, dtype=torch.float64)
5 gae_duplicate tensor(-0.2280, dtype=torch.float64) tensor(-2.5591, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0114, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
4 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-1.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1969, dtype=torch.float64) delta_t tensor(-0.1297, dtype=torch.float64)
3 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(2.1863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.2154, dtype=torch.float64)
2 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-3.7026, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1494.3251953125
value loss:140.71295166015625
entropies:341.46063232421875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3860.2603)
ToM Target loss= tensor(3976.4177)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.838431119918823 seconds
19 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
19 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(0.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1899, dtype=torch.float64) delta_t tensor(0.1617, dtype=torch.float64)
18 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-2.9297, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0618, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
17 gae_duplicate tensor(-0.1091, dtype=torch.float64) tensor(-1.5100, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9977, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
16 gae_duplicate tensor(-0.1240, dtype=torch.float64) tensor(-0.8021, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6267, dtype=torch.float64) delta_t tensor(-0.1122, dtype=torch.float64)
15 gae_duplicate tensor(-1.4695, dtype=torch.float64) tensor(1.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5114, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
14 gae_duplicate tensor(-1.2186, dtype=torch.float64) tensor(1.6430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5621, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
13 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-4.0660, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
12 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(-1.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3184, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
11 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-1.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0500, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
10 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-2.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3700, dtype=torch.float64) delta_t tensor(0.2203, dtype=torch.float64)
9 gae_duplicate tensor(0.1325, dtype=torch.float64) tensor(-4.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6292, dtype=torch.float64) delta_t tensor(-0.0969, dtype=torch.float64)
8 gae_duplicate tensor(-0.3458, dtype=torch.float64) tensor(1.3791, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7451, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
7 gae_duplicate tensor(-0.1485, dtype=torch.float64) tensor(-1.9256, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7446, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
6 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-0.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4756, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
5 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(0.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0144, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
4 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-0.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0534, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
3 gae_duplicate tensor(-0.2816, dtype=torch.float64) tensor(-0.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
2 gae_duplicate tensor(-0.2496, dtype=torch.float64) tensor(-1.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:998.0745239257812
value loss:11.892650604248047
entropies:341.614501953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.678443908691406 seconds
19 rew tensor(1.2022, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
19 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(0.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(0.1366, dtype=torch.float64)
18 gae_duplicate tensor(-0.0243, dtype=torch.float64) tensor(-2.4545, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1257, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
17 gae_duplicate tensor(0.0466, dtype=torch.float64) tensor(-2.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7555, dtype=torch.float64) delta_t tensor(-0.2162, dtype=torch.float64)
16 gae_duplicate tensor(-1.1859, dtype=torch.float64) tensor(3.5205, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
15 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-3.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
14 gae_duplicate tensor(-0.7861, dtype=torch.float64) tensor(0.4372, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6646, dtype=torch.float64) delta_t tensor(0.2098, dtype=torch.float64)
13 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-3.7435, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2165, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
12 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-0.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5493, dtype=torch.float64) delta_t tensor(0.1500, dtype=torch.float64)
11 gae_duplicate tensor(-0.0238, dtype=torch.float64) tensor(-2.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1803, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
10 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(1.5279, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3444, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
9 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(-1.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5773, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
8 gae_duplicate tensor(-0.3492, dtype=torch.float64) tensor(0.3523, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4189, dtype=torch.float64) delta_t tensor(-0.3178, dtype=torch.float64)
7 gae_duplicate tensor(-2.6291, dtype=torch.float64) tensor(5.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
6 gae_duplicate tensor(-0.4120, dtype=torch.float64) tensor(0.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5256, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
5 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(-1.0508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1130, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
4 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-1.0670, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2693, dtype=torch.float64) delta_t tensor(-0.1581, dtype=torch.float64)
3 gae_duplicate tensor(-0.4765, dtype=torch.float64) tensor(2.7303, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4332, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
2 gae_duplicate tensor(-0.2211, dtype=torch.float64) tensor(-0.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:121.50047302246094
value loss:19.671363830566406
entropies:341.7110290527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7903101444244385 seconds
19 rew tensor(1.1254, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
19 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(1.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1128, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
18 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(-1.4767, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0616, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
17 gae_duplicate tensor(-0.0348, dtype=torch.float64) tensor(-0.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9595, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
16 gae_duplicate tensor(-0.0209, dtype=torch.float64) tensor(-1.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8315, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
15 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(-0.9493, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6388, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
14 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-2.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6650, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
13 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-2.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(0.0989, dtype=torch.float64)
12 gae_duplicate tensor(-0.1394, dtype=torch.float64) tensor(-2.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
11 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(-1.4346, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
10 gae_duplicate tensor(-0.2316, dtype=torch.float64) tensor(1.7328, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3969, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
9 gae_duplicate tensor(-0.1351, dtype=torch.float64) tensor(-2.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5018, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
8 gae_duplicate tensor(-0.1924, dtype=torch.float64) tensor(1.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5121, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
7 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-1.7817, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6810, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
6 gae_duplicate tensor(-0.0976, dtype=torch.float64) tensor(-1.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3458, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
5 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1692, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
4 gae_duplicate tensor(-0.0777, dtype=torch.float64) tensor(-0.6428, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7053, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
3 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(1.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
2 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(0.0398, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:616.805908203125
value loss:3.9406051635742188
entropies:341.7931823730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.599606037139893 seconds
19 rew tensor(1.2273, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
19 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(0.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2276, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
18 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-1.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1894, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
17 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.7437, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0743, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
16 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(-0.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4737, dtype=torch.float64) delta_t tensor(-0.2420, dtype=torch.float64)
15 gae_duplicate tensor(-2.8322, dtype=torch.float64) tensor(4.6948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(-0.1686, dtype=torch.float64)
14 gae_duplicate tensor(-1.3230, dtype=torch.float64) tensor(3.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6130, dtype=torch.float64) delta_t tensor(0.2187, dtype=torch.float64)
13 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-3.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4475, dtype=torch.float64) delta_t tensor(0.2526, dtype=torch.float64)
12 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-5.5527, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
11 gae_duplicate tensor(-0.2208, dtype=torch.float64) tensor(-3.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0379, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
10 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(-1.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3050, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
9 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(-2.6533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6797, dtype=torch.float64) delta_t tensor(-0.0361, dtype=torch.float64)
8 gae_duplicate tensor(-0.5211, dtype=torch.float64) tensor(0.4029, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8229, dtype=torch.float64) delta_t tensor(-0.7785, dtype=torch.float64)
7 gae_duplicate tensor(-2.5122, dtype=torch.float64) tensor(14.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9621, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
6 gae_duplicate tensor(-0.6793, dtype=torch.float64) tensor(2.5228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3999, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
5 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-2.5729, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0385, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
4 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-3.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2481, dtype=torch.float64) delta_t tensor(-0.1202, dtype=torch.float64)
3 gae_duplicate tensor(-0.4668, dtype=torch.float64) tensor(1.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3716, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
2 gae_duplicate tensor(-0.3466, dtype=torch.float64) tensor(-1.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-40.69926834106445
value loss:43.09016418457031
entropies:341.91790771484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.751250982284546 seconds
19 rew tensor(1.2019, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
19 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(0.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1509, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
18 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-1.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0871, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
17 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-0.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9588, dtype=torch.float64) delta_t tensor(-0.0417, dtype=torch.float64)
16 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(0.6767, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8568, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
15 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.3379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1763, dtype=torch.float64) delta_t tensor(-0.2716, dtype=torch.float64)
14 gae_duplicate tensor(-1.0172, dtype=torch.float64) tensor(4.7079, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6525, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
13 gae_duplicate tensor(-0.1589, dtype=torch.float64) tensor(-1.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
12 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-0.2681, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4226, dtype=torch.float64) delta_t tensor(0.0996, dtype=torch.float64)
11 gae_duplicate tensor(-0.0488, dtype=torch.float64) tensor(-1.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0278, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
10 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(0.9704, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2686, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
9 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(-1.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5010, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
8 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8569, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
7 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(-3.0586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6419, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
6 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(-1.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5498, dtype=torch.float64) delta_t tensor(0.0840, dtype=torch.float64)
5 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(-1.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
4 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-0.4675, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1396, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
3 gae_duplicate tensor(-0.2469, dtype=torch.float64) tensor(0.9677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
2 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-0.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:264.577392578125
value loss:6.954701900482178
entropies:342.1427001953125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3859.7920)
ToM Target loss= tensor(3981.2393)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7740888595581055 seconds
19 rew tensor(1.2147, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
19 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(0.8132, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2021, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
18 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-2.1487, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0617, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
17 gae_duplicate tensor(-0.1610, dtype=torch.float64) tensor(0.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0618, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
16 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(-0.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9212, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
15 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.8801, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
14 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(-0.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4335, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
13 gae_duplicate tensor(-1.1599, dtype=torch.float64) tensor(2.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0785, dtype=torch.float64) delta_t tensor(-0.3896, dtype=torch.float64)
12 gae_duplicate tensor(-1.1728, dtype=torch.float64) tensor(7.0212, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3756, dtype=torch.float64) delta_t tensor(-0.6569, dtype=torch.float64)
11 gae_duplicate tensor(-4.1571, dtype=torch.float64) tensor(12.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.1815, dtype=torch.float64)
10 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(-1.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2799, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
9 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(-1.6360, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5009, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
8 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(-1.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(0.1487, dtype=torch.float64)
7 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(-2.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8722, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
6 gae_duplicate tensor(-0.2452, dtype=torch.float64) tensor(-1.1582, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1938, dtype=torch.float64) delta_t tensor(0.1685, dtype=torch.float64)
5 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-3.8542, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
4 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(0.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7083, dtype=torch.float64) delta_t tensor(0.1787, dtype=torch.float64)
3 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(-3.1965, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1400, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
2 gae_duplicate tensor(-0.3576, dtype=torch.float64) tensor(0.6798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-305.23681640625
value loss:37.80930709838867
entropies:342.3214416503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.521050214767456 seconds
19 rew tensor(1.1760, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
19 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(1.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1119, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
18 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-0.5545, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0225, dtype=torch.float64) delta_t tensor(-0.0330, dtype=torch.float64)
17 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(0.7394, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
16 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-0.1151, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
15 gae_duplicate tensor(-0.3601, dtype=torch.float64) tensor(2.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
14 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(-2.2769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6901, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
13 gae_duplicate tensor(0.0425, dtype=torch.float64) tensor(-2.0936, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(-0.1009, dtype=torch.float64)
12 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(1.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4342, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
11 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(0.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1419, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
10 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(0.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
9 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-2.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5512, dtype=torch.float64) delta_t tensor(-0.2691, dtype=torch.float64)
8 gae_duplicate tensor(-0.7470, dtype=torch.float64) tensor(4.6778, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2046, dtype=torch.float64) delta_t tensor(0.2872, dtype=torch.float64)
7 gae_duplicate tensor(-0.0498, dtype=torch.float64) tensor(-4.7734, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6540, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
6 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(-2.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7301, dtype=torch.float64) delta_t tensor(0.1983, dtype=torch.float64)
5 gae_duplicate tensor(-0.0260, dtype=torch.float64) tensor(-4.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
4 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(-1.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5763, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
3 gae_duplicate tensor(-0.4894, dtype=torch.float64) tensor(0.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
2 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(-1.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:427.7482604980469
value loss:7.299642086029053
entropies:342.5187072753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.90683388710022 seconds
19 rew tensor(1.1886, dtype=torch.float64) delta_t tensor(-0.0825, dtype=torch.float64)
19 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(1.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1759, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
18 gae_duplicate tensor(-0.1053, dtype=torch.float64) tensor(-1.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0477, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
17 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9965, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
16 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(0.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9197, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
15 gae_duplicate tensor(-0.2758, dtype=torch.float64) tensor(1.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7150, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
14 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-3.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
13 gae_duplicate tensor(-0.0369, dtype=torch.float64) tensor(-2.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
12 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(-0.3688, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3702, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
11 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(0.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0016, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
10 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-0.1647, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
9 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(0.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5384, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
8 gae_duplicate tensor(-0.3058, dtype=torch.float64) tensor(-0.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4915, dtype=torch.float64) delta_t tensor(-0.5179, dtype=torch.float64)
7 gae_duplicate tensor(-3.6215, dtype=torch.float64) tensor(9.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8204, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
6 gae_duplicate tensor(-0.6490, dtype=torch.float64) tensor(1.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3716, dtype=torch.float64) delta_t tensor(0.2110, dtype=torch.float64)
5 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-3.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0361, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
4 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(-1.4369, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0634, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
3 gae_duplicate tensor(-0.2430, dtype=torch.float64) tensor(-1.7309, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
2 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-1.8561, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.98278045654297
value loss:26.31316375732422
entropies:342.80078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6956846714019775 seconds
19 rew tensor(1.2140, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
19 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(1.1369, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2142, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
18 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(-2.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9972, dtype=torch.float64) delta_t tensor(-0.0916, dtype=torch.float64)
17 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(1.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9970, dtype=torch.float64) delta_t tensor(-0.0646, dtype=torch.float64)
16 gae_duplicate tensor(-0.2114, dtype=torch.float64) tensor(1.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7414, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
15 gae_duplicate tensor(-0.2714, dtype=torch.float64) tensor(0.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
14 gae_duplicate tensor(-1.0187, dtype=torch.float64) tensor(1.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
13 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(-0.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1634, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
12 gae_duplicate tensor(-1.4410, dtype=torch.float64) tensor(2.9113, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2290, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
11 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(0.8553, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0631, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
10 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(-1.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
9 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(-2.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4756, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
8 gae_duplicate tensor(-0.2822, dtype=torch.float64) tensor(1.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7822, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
7 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(-2.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6923, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
6 gae_duplicate tensor(-0.2325, dtype=torch.float64) tensor(-2.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5001, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
5 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-0.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
4 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-0.4539, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9888, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
3 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-2.8863, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
2 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(-0.4240, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:41.24207305908203
value loss:9.937873840332031
entropies:343.0771179199219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.70540189743042 seconds
19 rew tensor(1.1373, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
19 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(2.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1249, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
18 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-0.0575, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
17 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(-0.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1124, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-0.0436, dtype=torch.float64) tensor(-0.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(-0.3489, dtype=torch.float64)
15 gae_duplicate tensor(-1.5597, dtype=torch.float64) tensor(6.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(-0.2474, dtype=torch.float64)
14 gae_duplicate tensor(-1.2456, dtype=torch.float64) tensor(5.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2049, dtype=torch.float64) delta_t tensor(-0.4063, dtype=torch.float64)
13 gae_duplicate tensor(-2.9039, dtype=torch.float64) tensor(8.1278, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2585, dtype=torch.float64) delta_t tensor(-0.4447, dtype=torch.float64)
12 gae_duplicate tensor(-3.7524, dtype=torch.float64) tensor(9.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0409, dtype=torch.float64) delta_t tensor(-0.4009, dtype=torch.float64)
11 gae_duplicate tensor(-2.9550, dtype=torch.float64) tensor(8.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0629, dtype=torch.float64) delta_t tensor(0.2126, dtype=torch.float64)
10 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-3.5180, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3189, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
9 gae_duplicate tensor(-0.1138, dtype=torch.float64) tensor(-1.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4498, dtype=torch.float64) delta_t tensor(-0.1629, dtype=torch.float64)
8 gae_duplicate tensor(-0.3040, dtype=torch.float64) tensor(3.0555, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5773, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
7 gae_duplicate tensor(-0.2780, dtype=torch.float64) tensor(0.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5653, dtype=torch.float64) delta_t tensor(0.2303, dtype=torch.float64)
6 gae_duplicate tensor(0.0673, dtype=torch.float64) tensor(-4.9611, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4738, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
5 gae_duplicate tensor(-0.3960, dtype=torch.float64) tensor(-0.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0915, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
4 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(0.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8212, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
3 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.2341, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
2 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(-0.1237, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1768.7353515625
value loss:58.09231948852539
entropies:343.34649658203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3867.4785)
ToM Target loss= tensor(3979.8406)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.85161280632019 seconds
19 rew tensor(1.0859, dtype=torch.float64) delta_t tensor(-0.0913, dtype=torch.float64)
19 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(2.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9970, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
18 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(1.0852, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0228, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
17 gae_duplicate tensor(-0.2005, dtype=torch.float64) tensor(0.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
16 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(0.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8820, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
15 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-1.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6135, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
14 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-0.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6138, dtype=torch.float64) delta_t tensor(0.1560, dtype=torch.float64)
13 gae_duplicate tensor(0.0797, dtype=torch.float64) tensor(-3.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
12 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-2.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4085, dtype=torch.float64) delta_t tensor(-0.0725, dtype=torch.float64)
11 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(1.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1680, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
10 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(-0.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4844, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
9 gae_duplicate tensor(-0.1592, dtype=torch.float64) tensor(-1.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4741, dtype=torch.float64) delta_t tensor(-0.1901, dtype=torch.float64)
8 gae_duplicate tensor(-0.3681, dtype=torch.float64) tensor(3.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7969, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
7 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-1.1065, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6149, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
6 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-3.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5265, dtype=torch.float64) delta_t tensor(0.0880, dtype=torch.float64)
5 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-1.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0119, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
4 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(0.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0272, dtype=torch.float64) delta_t tensor(0.0867, dtype=torch.float64)
3 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-1.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3576, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
2 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(1.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:253.9871368408203
value loss:4.916364669799805
entropies:343.72601318359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.761530876159668 seconds
19 rew tensor(1.1507, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
19 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(1.3332, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1381, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
18 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-1.3105, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1252, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
17 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-1.7169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0103, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
16 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-0.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9462, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
15 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-1.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7673, dtype=torch.float64) delta_t tensor(0.0885, dtype=torch.float64)
14 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-2.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3437, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
13 gae_duplicate tensor(-1.1184, dtype=torch.float64) tensor(1.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1907, dtype=torch.float64) delta_t tensor(-0.1072, dtype=torch.float64)
12 gae_duplicate tensor(-1.0782, dtype=torch.float64) tensor(1.9901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
11 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-1.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1021, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
10 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-3.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
9 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(0.1220, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5393, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
8 gae_duplicate tensor(-0.4260, dtype=torch.float64) tensor(0.6318, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7304, dtype=torch.float64) delta_t tensor(0.2186, dtype=torch.float64)
7 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-3.9159, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8226, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
6 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-3.6143, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2414, dtype=torch.float64) delta_t tensor(0.1621, dtype=torch.float64)
5 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-3.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0801, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
4 gae_duplicate tensor(-0.4601, dtype=torch.float64) tensor(0.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8961, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
3 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-2.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2398, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
2 gae_duplicate tensor(-0.5031, dtype=torch.float64) tensor(0.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:862.7771606445312
value loss:12.996373176574707
entropies:343.9467468261719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.870165824890137 seconds
19 rew tensor(1.2271, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
19 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(-0.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1381, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
18 gae_duplicate tensor(-0.0032, dtype=torch.float64) tensor(-1.9687, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0101, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
17 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(-0.2871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0228, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
16 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-0.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8180, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
15 gae_duplicate tensor(-0.2747, dtype=torch.float64) tensor(1.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8817, dtype=torch.float64) delta_t tensor(0.1943, dtype=torch.float64)
14 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-3.7711, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3581, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
13 gae_duplicate tensor(-0.9511, dtype=torch.float64) tensor(1.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1132, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
12 gae_duplicate tensor(-0.5549, dtype=torch.float64) tensor(1.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
11 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(0.2734, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0536, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
10 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-0.8469, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.2487, dtype=torch.float64)
9 gae_duplicate tensor(0.0668, dtype=torch.float64) tensor(-4.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6039, dtype=torch.float64) delta_t tensor(-0.2211, dtype=torch.float64)
8 gae_duplicate tensor(-0.7592, dtype=torch.float64) tensor(3.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0764, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
7 gae_duplicate tensor(-0.2007, dtype=torch.float64) tensor(-2.0208, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8221, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
6 gae_duplicate tensor(-0.2831, dtype=torch.float64) tensor(-1.4604, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5761, dtype=torch.float64) delta_t tensor(0.1694, dtype=torch.float64)
5 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-4.0102, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
4 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-0.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4365, dtype=torch.float64) delta_t tensor(-0.1016, dtype=torch.float64)
3 gae_duplicate tensor(-0.5579, dtype=torch.float64) tensor(1.3514, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.0648, dtype=torch.float64)
2 gae_duplicate tensor(-0.2163, dtype=torch.float64) tensor(-1.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:490.9657897949219
value loss:9.34177017211914
entropies:344.1841735839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.787811994552612 seconds
19 rew tensor(1.1878, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
19 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(0.4097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2011, dtype=torch.float64) delta_t tensor(0.1153, dtype=torch.float64)
18 gae_duplicate tensor(0.0097, dtype=torch.float64) tensor(-2.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0986, dtype=torch.float64) delta_t tensor(0.0557, dtype=torch.float64)
17 gae_duplicate tensor(0.0035, dtype=torch.float64) tensor(-1.2316, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0986, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
16 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-1.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9583, dtype=torch.float64) delta_t tensor(0.2367, dtype=torch.float64)
15 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-4.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5739, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
14 gae_duplicate tensor(-1.2017, dtype=torch.float64) tensor(0.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7413, dtype=torch.float64) delta_t tensor(0.2924, dtype=torch.float64)
13 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-5.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3563, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
12 gae_duplicate tensor(-1.5101, dtype=torch.float64) tensor(-0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2177, dtype=torch.float64) delta_t tensor(-0.4495, dtype=torch.float64)
11 gae_duplicate tensor(-2.2841, dtype=torch.float64) tensor(7.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7448, dtype=torch.float64) delta_t tensor(-0.6049, dtype=torch.float64)
10 gae_duplicate tensor(-5.4024, dtype=torch.float64) tensor(12.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1532, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
9 gae_duplicate tensor(-0.7292, dtype=torch.float64) tensor(0.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5268, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
8 gae_duplicate tensor(-0.2494, dtype=torch.float64) tensor(-0.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0450, dtype=torch.float64) delta_t tensor(-0.6124, dtype=torch.float64)
7 gae_duplicate tensor(-3.4548, dtype=torch.float64) tensor(11.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0011, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
6 gae_duplicate tensor(-0.7169, dtype=torch.float64) tensor(0.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1400, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
5 gae_duplicate tensor(-0.5624, dtype=torch.float64) tensor(-0.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2213, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
4 gae_duplicate tensor(-0.0163, dtype=torch.float64) tensor(-1.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6776, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
3 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-0.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0217, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
2 gae_duplicate tensor(-0.4226, dtype=torch.float64) tensor(-0.3378, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-859.3214721679688
value loss:88.70536804199219
entropies:344.5143127441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.845100164413452 seconds
19 rew tensor(1.1498, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
19 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(0.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0987, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
18 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-2.3080, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0220, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
17 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-1.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9068, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
16 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(0.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8813, dtype=torch.float64) delta_t tensor(0.2134, dtype=torch.float64)
15 gae_duplicate tensor(0.0318, dtype=torch.float64) tensor(-3.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
14 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-1.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5614, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
13 gae_duplicate tensor(0.0201, dtype=torch.float64) tensor(-2.2498, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3821, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
12 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-2.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4084, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
11 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-0.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0496, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
10 gae_duplicate tensor(-0.0756, dtype=torch.float64) tensor(-0.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1785, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
9 gae_duplicate tensor(-0.1716, dtype=torch.float64) tensor(-1.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4748, dtype=torch.float64) delta_t tensor(-0.0873, dtype=torch.float64)
8 gae_duplicate tensor(-0.3229, dtype=torch.float64) tensor(1.3778, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8821, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
7 gae_duplicate tensor(-0.0272, dtype=torch.float64) tensor(-3.6255, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7062, dtype=torch.float64) delta_t tensor(0.1142, dtype=torch.float64)
6 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(-2.3829, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4714, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
5 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-2.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0862, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
4 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-0.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1127, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
3 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(0.4263, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
2 gae_duplicate tensor(-0.3573, dtype=torch.float64) tensor(-1.6115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1288.8021240234375
value loss:5.030602931976318
entropies:345.0151062011719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3895.7529)
ToM Target loss= tensor(3982.0300)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8606719970703125 seconds
19 rew tensor(1.1499, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
19 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(0.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
18 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-2.6708, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0864, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
17 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-2.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9206, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
16 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(-0.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8818, dtype=torch.float64) delta_t tensor(0.2019, dtype=torch.float64)
15 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-3.7859, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(-0.1998, dtype=torch.float64)
14 gae_duplicate tensor(-1.4193, dtype=torch.float64) tensor(4.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4453, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
13 gae_duplicate tensor(-1.3145, dtype=torch.float64) tensor(1.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3444, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
12 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(-0.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
11 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-1.8084, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0014, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
10 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(-1.0729, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2292, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
9 gae_duplicate tensor(-0.2191, dtype=torch.float64) tensor(-0.1653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4495, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
8 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-0.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6540, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
7 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-0.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5519, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
6 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-2.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5504, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
5 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-0.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0661, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
4 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(0.8761, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9235, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
3 gae_duplicate tensor(-0.2229, dtype=torch.float64) tensor(0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3049, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
2 gae_duplicate tensor(-0.2577, dtype=torch.float64) tensor(0.6167, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:304.3663024902344
value loss:9.439053535461426
entropies:345.3977355957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5228259563446045 seconds
19 rew tensor(1.1626, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
19 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-0.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1756, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
18 gae_duplicate tensor(0.0568, dtype=torch.float64) tensor(-3.3930, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0990, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
17 gae_duplicate tensor(0.0473, dtype=torch.float64) tensor(-2.8427, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
16 gae_duplicate tensor(-0.0236, dtype=torch.float64) tensor(-1.8369, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9069, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
15 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-4.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5376, dtype=torch.float64) delta_t tensor(-0.0773, dtype=torch.float64)
14 gae_duplicate tensor(-1.1253, dtype=torch.float64) tensor(1.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
13 gae_duplicate tensor(-0.0674, dtype=torch.float64) tensor(-2.7874, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1923, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
12 gae_duplicate tensor(-1.0517, dtype=torch.float64) tensor(1.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
11 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-1.8104, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1913, dtype=torch.float64) delta_t tensor(0.0882, dtype=torch.float64)
10 gae_duplicate tensor(-0.1246, dtype=torch.float64) tensor(-1.8029, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0361, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
9 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(1.2717, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4238, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
8 gae_duplicate tensor(-0.2500, dtype=torch.float64) tensor(-1.9852, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7988, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
7 gae_duplicate tensor(-0.2316, dtype=torch.float64) tensor(-1.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6538, dtype=torch.float64) delta_t tensor(0.2780, dtype=torch.float64)
6 gae_duplicate tensor(-0.0208, dtype=torch.float64) tensor(-5.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5015, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
5 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-0.2826, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0133, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
4 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(-2.1928, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0172, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
3 gae_duplicate tensor(-0.3878, dtype=torch.float64) tensor(1.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3209, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
2 gae_duplicate tensor(-0.3804, dtype=torch.float64) tensor(-1.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1349.502685546875
value loss:10.748929023742676
entropies:345.65838623046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.647280931472778 seconds
19 rew tensor(1.1244, dtype=torch.float64) delta_t tensor(-0.0297, dtype=torch.float64)
19 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(0.6783, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1501, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
18 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(-2.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0862, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
17 gae_duplicate tensor(-0.0420, dtype=torch.float64) tensor(-1.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0736, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
16 gae_duplicate tensor(-0.0874, dtype=torch.float64) tensor(-1.2950, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9454, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
15 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-2.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5248, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
14 gae_duplicate tensor(-0.6474, dtype=torch.float64) tensor(0.3002, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4867, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
13 gae_duplicate tensor(-1.1940, dtype=torch.float64) tensor(2.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(-0.3451, dtype=torch.float64)
12 gae_duplicate tensor(-1.4768, dtype=torch.float64) tensor(6.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5131, dtype=torch.float64) delta_t tensor(-0.8015, dtype=torch.float64)
11 gae_duplicate tensor(-2.6907, dtype=torch.float64) tensor(15.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1289, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
10 gae_duplicate tensor(-1.1107, dtype=torch.float64) tensor(1.7927, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
9 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-2.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6288, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
8 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.3004, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3090, dtype=torch.float64) delta_t tensor(-0.0207, dtype=torch.float64)
7 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(0.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7312, dtype=torch.float64) delta_t tensor(0.1845, dtype=torch.float64)
6 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-3.6139, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3466, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
5 gae_duplicate tensor(-0.3155, dtype=torch.float64) tensor(1.0087, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2199, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
4 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(1.7250, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7571, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
3 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(0.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1258, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
2 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(0.6897, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1153.0545654296875
value loss:34.790767669677734
entropies:345.9136047363281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.720343112945557 seconds
19 rew tensor(1.1882, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
19 gae_duplicate tensor(-0.0993, dtype=torch.float64) tensor(0.0984, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1627, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
18 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-2.8757, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0224, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
17 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(-0.8413, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0098, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(-0.7957, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8307, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
15 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(-0.7622, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5111, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
14 gae_duplicate tensor(-0.7793, dtype=torch.float64) tensor(1.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5878, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
13 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-2.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
12 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-2.6963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4085, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
11 gae_duplicate tensor(-0.1150, dtype=torch.float64) tensor(-0.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0532, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
10 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-0.1388, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2807, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
9 gae_duplicate tensor(0.0676, dtype=torch.float64) tensor(-2.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4492, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
8 gae_duplicate tensor(-0.2202, dtype=torch.float64) tensor(1.3033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3070, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
7 gae_duplicate tensor(-0.7529, dtype=torch.float64) tensor(2.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6795, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
6 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(0.5888, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5770, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
5 gae_duplicate tensor(-0.2092, dtype=torch.float64) tensor(-0.9271, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1390, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
4 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(-0.4289, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2440, dtype=torch.float64) delta_t tensor(-0.1259, dtype=torch.float64)
3 gae_duplicate tensor(-0.2283, dtype=torch.float64) tensor(2.6461, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
2 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(-0.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:328.9042663574219
value loss:5.567377090454102
entropies:346.1806945800781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.61932635307312 seconds
19 rew tensor(1.2145, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
19 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(0.1248, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1636, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
18 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-2.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0618, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
17 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-1.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
16 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-1.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8825, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
15 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(-2.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3560, dtype=torch.float64) delta_t tensor(-0.1238, dtype=torch.float64)
14 gae_duplicate tensor(-1.2703, dtype=torch.float64) tensor(2.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4578, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
13 gae_duplicate tensor(-1.0782, dtype=torch.float64) tensor(-0.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3062, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
12 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-2.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0435, dtype=torch.float64) delta_t tensor(-0.3398, dtype=torch.float64)
11 gae_duplicate tensor(-1.2088, dtype=torch.float64) tensor(6.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0128, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
10 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-2.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
9 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-2.5604, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6548, dtype=torch.float64) delta_t tensor(-0.1133, dtype=torch.float64)
8 gae_duplicate tensor(-0.3776, dtype=torch.float64) tensor(1.9870, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4856, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
7 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-1.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7317, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
6 gae_duplicate tensor(-0.0061, dtype=torch.float64) tensor(-3.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4225, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
5 gae_duplicate tensor(-0.5911, dtype=torch.float64) tensor(1.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0933, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
4 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-1.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9475, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
3 gae_duplicate tensor(-0.3207, dtype=torch.float64) tensor(1.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2522, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
2 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-2.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:554.0100708007812
value loss:16.415082931518555
entropies:346.5039978027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3893.2871)
ToM Target loss= tensor(3985.7168)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9362311363220215 seconds
19 rew tensor(1.1377, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
19 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(0.9530, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1636, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
18 gae_duplicate tensor(-0.0357, dtype=torch.float64) tensor(-2.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0354, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
17 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(-0.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
16 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8822, dtype=torch.float64) delta_t tensor(0.1825, dtype=torch.float64)
15 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(-3.7836, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
14 gae_duplicate tensor(-0.0316, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3713, dtype=torch.float64) delta_t tensor(-0.0937, dtype=torch.float64)
13 gae_duplicate tensor(-0.9866, dtype=torch.float64) tensor(1.6003, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
12 gae_duplicate tensor(-0.1140, dtype=torch.float64) tensor(-0.5403, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1035, dtype=torch.float64) delta_t tensor(-0.2299, dtype=torch.float64)
11 gae_duplicate tensor(-1.3975, dtype=torch.float64) tensor(3.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0104, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
10 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-1.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
9 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-2.2883, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6300, dtype=torch.float64) delta_t tensor(-0.1090, dtype=torch.float64)
8 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(1.8046, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3973, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
7 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(0.1101, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6810, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
6 gae_duplicate tensor(-0.1372, dtype=torch.float64) tensor(-0.9230, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3711, dtype=torch.float64) delta_t tensor(-0.1129, dtype=torch.float64)
5 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(2.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1946, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
4 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(0.4124, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7180, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
3 gae_duplicate tensor(-0.3388, dtype=torch.float64) tensor(0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1768, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
2 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-0.5577, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:50.82733917236328
value loss:8.147942543029785
entropies:346.7945556640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6596291065216064 seconds
19 rew tensor(1.1762, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
19 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1637, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
18 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-1.6832, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0486, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
17 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-0.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
16 gae_duplicate tensor(-1.2802, dtype=torch.float64) tensor(2.9670, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8952, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
15 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-1.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
14 gae_duplicate tensor(-0.1375, dtype=torch.float64) tensor(-4.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(-0.2619, dtype=torch.float64)
13 gae_duplicate tensor(-1.3953, dtype=torch.float64) tensor(5.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2545, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
12 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(-2.8364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
11 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-1.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1002, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
10 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-4.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5633, dtype=torch.float64) delta_t tensor(0.3121, dtype=torch.float64)
9 gae_duplicate tensor(0.0965, dtype=torch.float64) tensor(-6.9319, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6937, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
8 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(1.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1937, dtype=torch.float64) delta_t tensor(-0.2941, dtype=torch.float64)
7 gae_duplicate tensor(-2.2677, dtype=torch.float64) tensor(5.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8991, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
6 gae_duplicate tensor(-0.3682, dtype=torch.float64) tensor(0.6503, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3213, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
5 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-3.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0373, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
4 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-0.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1311, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
3 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(-0.2900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3703, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
2 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-0.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:464.03424072265625
value loss:23.004474639892578
entropies:347.1411437988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.071249961853027 seconds
19 rew tensor(1.1248, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
19 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(0.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1250, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
18 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-1.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
17 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-1.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0483, dtype=torch.float64) delta_t tensor(0.1397, dtype=torch.float64)
16 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-2.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9461, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
15 gae_duplicate tensor(-0.1240, dtype=torch.float64) tensor(-3.2804, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
14 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(-1.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
13 gae_duplicate tensor(-1.0959, dtype=torch.float64) tensor(-1.1989, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2415, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
12 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(-0.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
11 gae_duplicate tensor(-1.2003, dtype=torch.float64) tensor(1.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
10 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(0.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4087, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
9 gae_duplicate tensor(-0.2183, dtype=torch.float64) tensor(-2.1120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5786, dtype=torch.float64) delta_t tensor(-0.0242, dtype=torch.float64)
8 gae_duplicate tensor(-0.3875, dtype=torch.float64) tensor(0.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3376, dtype=torch.float64) delta_t tensor(-0.6874, dtype=torch.float64)
7 gae_duplicate tensor(-4.0570, dtype=torch.float64) tensor(12.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7843, dtype=torch.float64) delta_t tensor(0.1548, dtype=torch.float64)
6 gae_duplicate tensor(-0.5234, dtype=torch.float64) tensor(-1.8622, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3211, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
5 gae_duplicate tensor(-0.1463, dtype=torch.float64) tensor(0.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1422, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
4 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(0.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7855, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
3 gae_duplicate tensor(-0.4939, dtype=torch.float64) tensor(0.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1651, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
2 gae_duplicate tensor(-0.3975, dtype=torch.float64) tensor(1.4411, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-152.40933227539062
value loss:37.166019439697266
entropies:347.4837646484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.665288925170898 seconds
19 rew tensor(1.2271, dtype=torch.float64) delta_t tensor(-0.0758, dtype=torch.float64)
19 gae_duplicate tensor(-0.1827, dtype=torch.float64) tensor(1.3987, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1634, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
18 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-0.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1120, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
17 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-0.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9716, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
16 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(1.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9714, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
15 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-1.5519, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6385, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
14 gae_duplicate tensor(-0.7612, dtype=torch.float64) tensor(-0.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0279, dtype=torch.float64) delta_t tensor(-0.3663, dtype=torch.float64)
13 gae_duplicate tensor(-2.6423, dtype=torch.float64) tensor(6.8148, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.2186, dtype=torch.float64)
12 gae_duplicate tensor(-0.0472, dtype=torch.float64) tensor(-3.4479, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
11 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(-1.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0242, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
10 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-1.5522, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
9 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-2.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5265, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
8 gae_duplicate tensor(-0.1769, dtype=torch.float64) tensor(0.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8614, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
7 gae_duplicate tensor(-0.4724, dtype=torch.float64) tensor(-0.2635, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7569, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
6 gae_duplicate tensor(-0.2861, dtype=torch.float64) tensor(0.3791, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5524, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
5 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(-1.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0137, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
4 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(0.7833, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1440, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
3 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(-0.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3190, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
2 gae_duplicate tensor(-0.2543, dtype=torch.float64) tensor(2.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-73.28314208984375
value loss:16.023391723632812
entropies:347.87225341796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.810161113739014 seconds
19 rew tensor(1.2265, dtype=torch.float64) delta_t tensor(-0.0644, dtype=torch.float64)
19 gae_duplicate tensor(-0.2007, dtype=torch.float64) tensor(1.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2011, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
18 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(-0.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1243, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
17 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-1.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0478, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
16 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-0.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6517, dtype=torch.float64) delta_t tensor(-0.1822, dtype=torch.float64)
15 gae_duplicate tensor(-1.4233, dtype=torch.float64) tensor(4.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8306, dtype=torch.float64) delta_t tensor(0.3867, dtype=torch.float64)
14 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-7.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2430, dtype=torch.float64) delta_t tensor(-0.0810, dtype=torch.float64)
13 gae_duplicate tensor(-1.1663, dtype=torch.float64) tensor(0.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.1043, dtype=torch.float64)
12 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-1.7773, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2414, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
11 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-0.7673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0889, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
10 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-2.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2662, dtype=torch.float64) delta_t tensor(0.1398, dtype=torch.float64)
9 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-2.7997, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5639, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
8 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(0.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4344, dtype=torch.float64) delta_t tensor(-0.1185, dtype=torch.float64)
7 gae_duplicate tensor(-0.7211, dtype=torch.float64) tensor(2.8641, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6667, dtype=torch.float64) delta_t tensor(0.1509, dtype=torch.float64)
6 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-3.0355, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7047, dtype=torch.float64) delta_t tensor(0.1292, dtype=torch.float64)
5 gae_duplicate tensor(-0.1083, dtype=torch.float64) tensor(-3.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2924, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
4 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-1.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5379, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
3 gae_duplicate tensor(-0.3404, dtype=torch.float64) tensor(0.1343, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6381, dtype=torch.float64) delta_t tensor(0.1435, dtype=torch.float64)
2 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(-3.3347, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:924.4050903320312
value loss:13.722253799438477
entropies:347.9830017089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3883.4131)
ToM Target loss= tensor(3991.3875)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.805624961853027 seconds
19 rew tensor(1.1374, dtype=torch.float64) delta_t tensor(-0.1047, dtype=torch.float64)
19 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(2.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1633, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
18 gae_duplicate tensor(-0.0357, dtype=torch.float64) tensor(-1.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9713, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
17 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(1.6080, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
16 gae_duplicate tensor(-0.2359, dtype=torch.float64) tensor(2.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8819, dtype=torch.float64) delta_t tensor(0.1510, dtype=torch.float64)
15 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(-2.5316, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(-0.2230, dtype=torch.float64)
14 gae_duplicate tensor(-1.1001, dtype=torch.float64) tensor(4.0103, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6384, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
13 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-0.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1389, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
12 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(-0.6302, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5619, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
11 gae_duplicate tensor(-0.2218, dtype=torch.float64) tensor(-1.2222, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
10 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-1.4658, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
9 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-1.5794, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7575, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
8 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(1.0962, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3085, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
7 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(-0.5570, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7831, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
6 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(0.9648, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2433, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
5 gae_duplicate tensor(-0.3066, dtype=torch.float64) tensor(0.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1941, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
4 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-0.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6935, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
3 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(1.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1771, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
2 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(-0.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-241.602294921875
value loss:4.611071586608887
entropies:348.1424865722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.588848829269409 seconds
19 rew tensor(1.1500, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
19 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(2.5346, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1118, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
18 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(0.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1632, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
17 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(-0.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9455, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
16 gae_duplicate tensor(-0.2284, dtype=torch.float64) tensor(1.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
15 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-2.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3944, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
14 gae_duplicate tensor(-1.3731, dtype=torch.float64) tensor(3.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5110, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
13 gae_duplicate tensor(0.0376, dtype=torch.float64) tensor(-2.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.1121, dtype=torch.float64)
12 gae_duplicate tensor(-0.2110, dtype=torch.float64) tensor(-2.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3577, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
11 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-2.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0748, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
10 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-1.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3318, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
9 gae_duplicate tensor(-0.2466, dtype=torch.float64) tensor(-3.7694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6037, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
8 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(1.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9345, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
7 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-1.1495, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7062, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
6 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-2.9647, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5503, dtype=torch.float64) delta_t tensor(0.1307, dtype=torch.float64)
5 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-2.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.1164, dtype=torch.float64)
4 gae_duplicate tensor(-0.0586, dtype=torch.float64) tensor(-2.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3069, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
3 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-1.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5478, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
2 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-3.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1018.1243896484375
value loss:8.578144073486328
entropies:348.25732421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777734994888306 seconds
19 rew tensor(1.2389, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
19 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(0.7432, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1753, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
18 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-1.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0602, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
17 gae_duplicate tensor(-0.2355, dtype=torch.float64) tensor(0.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0858, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
16 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-0.7782, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7036, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
15 gae_duplicate tensor(-1.0602, dtype=torch.float64) tensor(2.7483, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5738, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
14 gae_duplicate tensor(-1.0800, dtype=torch.float64) tensor(-1.4132, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3807, dtype=torch.float64) delta_t tensor(-0.0763, dtype=torch.float64)
13 gae_duplicate tensor(-1.4283, dtype=torch.float64) tensor(1.4148, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0026, dtype=torch.float64) delta_t tensor(-0.1523, dtype=torch.float64)
12 gae_duplicate tensor(-1.6001, dtype=torch.float64) tensor(4.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4843, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
11 gae_duplicate tensor(-0.2600, dtype=torch.float64) tensor(-1.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2055, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
10 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(-0.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
9 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-3.2116, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6278, dtype=torch.float64) delta_t tensor(-0.2505, dtype=torch.float64)
8 gae_duplicate tensor(-0.5657, dtype=torch.float64) tensor(4.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.5422, dtype=torch.float64) delta_t tensor(-0.9037, dtype=torch.float64)
7 gae_duplicate tensor(-3.7925, dtype=torch.float64) tensor(20.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8078, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
6 gae_duplicate tensor(-0.5730, dtype=torch.float64) tensor(2.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7814, dtype=torch.float64) delta_t tensor(0.1724, dtype=torch.float64)
5 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-2.8793, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
4 gae_duplicate tensor(-0.2914, dtype=torch.float64) tensor(-0.5165, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7556, dtype=torch.float64) delta_t tensor(-0.1262, dtype=torch.float64)
3 gae_duplicate tensor(-0.4420, dtype=torch.float64) tensor(2.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
2 gae_duplicate tensor(-0.3632, dtype=torch.float64) tensor(-1.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1442.5074462890625
value loss:51.25490188598633
entropies:348.509521484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7634828090667725 seconds
19 rew tensor(1.1112, dtype=torch.float64) delta_t tensor(-0.1616, dtype=torch.float64)
19 gae_duplicate tensor(-0.2530, dtype=torch.float64) tensor(3.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0987, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
18 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(0.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(-0.3167, dtype=torch.float64)
17 gae_duplicate tensor(-1.5877, dtype=torch.float64) tensor(5.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9196, dtype=torch.float64) delta_t tensor(-0.1201, dtype=torch.float64)
16 gae_duplicate tensor(-0.2711, dtype=torch.float64) tensor(3.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8686, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
15 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-0.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6768, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
14 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-0.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.0986, dtype=torch.float64)
13 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-1.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
12 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(0.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
11 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-1.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1911, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
10 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-0.5203, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0144, dtype=torch.float64) delta_t tensor(-0.1069, dtype=torch.float64)
9 gae_duplicate tensor(-0.2646, dtype=torch.float64) tensor(1.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4614, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
8 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-0.2352, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9233, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
7 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(-0.5585, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5640, dtype=torch.float64) delta_t tensor(0.2494, dtype=torch.float64)
6 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-4.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6520, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
5 gae_duplicate tensor(-0.0296, dtype=torch.float64) tensor(-0.7283, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1142, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
4 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-2.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2051, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
3 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(0.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4468, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
2 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(-2.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-57.5562744140625
value loss:8.255959510803223
entropies:348.5504455566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.768496036529541 seconds
19 rew tensor(1.2392, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
19 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(2.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1882, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
18 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(0.3538, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1117, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
17 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(0.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0350, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
16 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(0.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.1118, dtype=torch.float64)
15 gae_duplicate tensor(-0.2081, dtype=torch.float64) tensor(-2.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2295, dtype=torch.float64) delta_t tensor(-0.2818, dtype=torch.float64)
14 gae_duplicate tensor(-1.4826, dtype=torch.float64) tensor(4.7158, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4080, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
13 gae_duplicate tensor(-0.0594, dtype=torch.float64) tensor(-1.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3955, dtype=torch.float64) delta_t tensor(0.2039, dtype=torch.float64)
12 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-4.0387, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3955, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
11 gae_duplicate tensor(-0.2071, dtype=torch.float64) tensor(-1.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
10 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(0.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4721, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
9 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(-2.8025, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5507, dtype=torch.float64) delta_t tensor(-0.1000, dtype=torch.float64)
8 gae_duplicate tensor(-0.2406, dtype=torch.float64) tensor(1.6144, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1020, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
7 gae_duplicate tensor(-0.1238, dtype=torch.float64) tensor(-1.2556, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6917, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
6 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-4.4031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7033, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
5 gae_duplicate tensor(-0.0459, dtype=torch.float64) tensor(-3.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2161, dtype=torch.float64) delta_t tensor(-0.0149, dtype=torch.float64)
4 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(0.0321, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4603, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
3 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-1.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5487, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
2 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-0.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:548.6361083984375
value loss:11.972209930419922
entropies:348.5845642089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3889.4478)
ToM Target loss= tensor(3996.6089)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.425991058349609 seconds
19 rew tensor(1.1366, dtype=torch.float64) delta_t tensor(-0.1049, dtype=torch.float64)
19 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(2.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1368, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
18 gae_duplicate tensor(-0.0574, dtype=torch.float64) tensor(-0.6650, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(-0.0963, dtype=torch.float64)
17 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(1.8754, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(-0.1008, dtype=torch.float64)
16 gae_duplicate tensor(-0.2304, dtype=torch.float64) tensor(2.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8050, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
15 gae_duplicate tensor(-0.3070, dtype=torch.float64) tensor(0.6369, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6257, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
14 gae_duplicate tensor(-0.1878, dtype=torch.float64) tensor(-2.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
13 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-1.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
12 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(0.4273, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5757, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
11 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(-1.7479, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
10 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(0.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
9 gae_duplicate tensor(-0.2383, dtype=torch.float64) tensor(0.5401, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5260, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
8 gae_duplicate tensor(-0.2974, dtype=torch.float64) tensor(-0.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2686, dtype=torch.float64) delta_t tensor(-0.0358, dtype=torch.float64)
7 gae_duplicate tensor(-0.1136, dtype=torch.float64) tensor(0.5842, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8329, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
6 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(0.2956, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1144, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
5 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(0.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2710, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
4 gae_duplicate tensor(-0.2051, dtype=torch.float64) tensor(8.9238e-05, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4997, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
3 gae_duplicate tensor(-0.3457, dtype=torch.float64) tensor(1.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0872, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
2 gae_duplicate tensor(-0.3395, dtype=torch.float64) tensor(0.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-362.3604431152344
value loss:4.207089424133301
entropies:348.7525634765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.705688953399658 seconds
19 rew tensor(1.0992, dtype=torch.float64) delta_t tensor(-0.1574, dtype=torch.float64)
19 gae_duplicate tensor(-0.2241, dtype=torch.float64) tensor(3.0947, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
18 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-0.7424, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0095, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
17 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(1.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9586, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
16 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(-0.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
15 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-0.8560, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5616, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
14 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-2.4482, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
13 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-3.0566, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
12 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-1.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
11 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(-0.8568, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2068, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
10 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-0.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
9 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(-2.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7698, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
8 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(1.3946, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
7 gae_duplicate tensor(-0.1447, dtype=torch.float64) tensor(-0.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9499, dtype=torch.float64) delta_t tensor(0.0165, dtype=torch.float64)
6 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(-0.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0628, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
5 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-0.2599, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3738, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
4 gae_duplicate tensor(-0.2522, dtype=torch.float64) tensor(1.5273, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4872, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
3 gae_duplicate tensor(-0.2459, dtype=torch.float64) tensor(1.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0283, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
2 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(1.2920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:10.35936164855957
value loss:5.008000373840332
entropies:348.90570068359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.630636692047119 seconds
19 rew tensor(1.1755, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
19 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(1.7617, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1886, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
18 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-1.9472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7671, dtype=torch.float64) delta_t tensor(-0.3074, dtype=torch.float64)
17 gae_duplicate tensor(-1.4203, dtype=torch.float64) tensor(5.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9710, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
16 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(1.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
15 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(0.8236, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6893, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
14 gae_duplicate tensor(-0.0290, dtype=torch.float64) tensor(-4.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4614, dtype=torch.float64) delta_t tensor(-0.1493, dtype=torch.float64)
13 gae_duplicate tensor(-1.4026, dtype=torch.float64) tensor(1.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1773, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
12 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(0.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5878, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
11 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-2.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1808, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
10 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-0.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
9 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-0.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6036, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
8 gae_duplicate tensor(-0.4478, dtype=torch.float64) tensor(2.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5123, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
7 gae_duplicate tensor(-0.3077, dtype=torch.float64) tensor(-0.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8088, dtype=torch.float64) delta_t tensor(0.0426, dtype=torch.float64)
6 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(-0.8650, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2429, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
5 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-0.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1438, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
4 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(0.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6917, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
3 gae_duplicate tensor(-0.2373, dtype=torch.float64) tensor(0.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1251, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
2 gae_duplicate tensor(-0.4979, dtype=torch.float64) tensor(2.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-428.2630310058594
value loss:11.424189567565918
entropies:349.1301574707031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.04655385017395 seconds
19 rew tensor(1.1761, dtype=torch.float64) delta_t tensor(-0.0588, dtype=torch.float64)
19 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(1.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1634, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
18 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-1.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0485, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
17 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(0.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
16 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-0.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9201, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
15 gae_duplicate tensor(0.0684, dtype=torch.float64) tensor(-3.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6130, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
14 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-0.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
13 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-1.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0020, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
12 gae_duplicate tensor(-1.2648, dtype=torch.float64) tensor(3.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0281, dtype=torch.float64) delta_t tensor(-0.4922, dtype=torch.float64)
11 gae_duplicate tensor(-4.0255, dtype=torch.float64) tensor(8.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3739, dtype=torch.float64) delta_t tensor(-0.2832, dtype=torch.float64)
10 gae_duplicate tensor(-1.3605, dtype=torch.float64) tensor(6.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
9 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-1.4518, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6807, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
8 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.3354, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1009, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
7 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-0.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0147, dtype=torch.float64) delta_t tensor(-0.0739, dtype=torch.float64)
6 gae_duplicate tensor(-0.4406, dtype=torch.float64) tensor(1.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8340, dtype=torch.float64) delta_t tensor(-0.1195, dtype=torch.float64)
5 gae_duplicate tensor(-0.3663, dtype=torch.float64) tensor(2.4728, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5793, dtype=torch.float64) delta_t tensor(-0.1105, dtype=torch.float64)
4 gae_duplicate tensor(-0.3505, dtype=torch.float64) tensor(2.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0914, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
3 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(-0.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2463, dtype=torch.float64) delta_t tensor(-0.1599, dtype=torch.float64)
2 gae_duplicate tensor(-0.4449, dtype=torch.float64) tensor(3.4654, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1115.13818359375
value loss:34.32714080810547
entropies:349.496337890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.742767810821533 seconds
19 rew tensor(1.1117, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
19 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(1.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1121, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
18 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-0.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0099, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
17 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(0.3235, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
16 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.2448, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8435, dtype=torch.float64) delta_t tensor(-0.0418, dtype=torch.float64)
15 gae_duplicate tensor(-0.1905, dtype=torch.float64) tensor(0.9000, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
14 gae_duplicate tensor(-0.0775, dtype=torch.float64) tensor(-1.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6002, dtype=torch.float64) delta_t tensor(0.1404, dtype=torch.float64)
13 gae_duplicate tensor(-0.0785, dtype=torch.float64) tensor(-2.7746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3570, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
12 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-1.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
11 gae_duplicate tensor(-0.2786, dtype=torch.float64) tensor(0.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(-0.0490, dtype=torch.float64)
10 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(1.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4462, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
9 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-1.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5270, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
8 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(2.0906, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6688, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
7 gae_duplicate tensor(-0.3966, dtype=torch.float64) tensor(1.2084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7319, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
6 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(0.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3992, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
5 gae_duplicate tensor(-0.2763, dtype=torch.float64) tensor(1.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0660, dtype=torch.float64) delta_t tensor(-0.0722, dtype=torch.float64)
4 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(1.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8742, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
3 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(0.7709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2671, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
2 gae_duplicate tensor(-0.2258, dtype=torch.float64) tensor(1.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-333.5049133300781
value loss:4.4812750816345215
entropies:350.0518493652344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3914.5229)
ToM Target loss= tensor(4007.2781)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.763988018035889 seconds
19 rew tensor(1.0605, dtype=torch.float64) delta_t tensor(-0.0871, dtype=torch.float64)
19 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(1.6496, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0864, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
18 gae_duplicate tensor(-0.0084, dtype=torch.float64) tensor(-1.2696, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9588, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
17 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(0.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9585, dtype=torch.float64) delta_t tensor(0.0199, dtype=torch.float64)
16 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-0.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8178, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
15 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-0.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7156, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
14 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-1.5644, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.1460, dtype=torch.float64)
13 gae_duplicate tensor(-0.0386, dtype=torch.float64) tensor(-2.8037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
12 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-1.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
11 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-0.9344, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0141, dtype=torch.float64) delta_t tensor(0.0326, dtype=torch.float64)
10 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.7540, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4321, dtype=torch.float64) delta_t tensor(0.1400, dtype=torch.float64)
9 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-3.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(-0.1699, dtype=torch.float64)
8 gae_duplicate tensor(-0.3141, dtype=torch.float64) tensor(2.9545, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7465, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
7 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-0.6100, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8085, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
6 gae_duplicate tensor(-0.1438, dtype=torch.float64) tensor(-2.0267, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3232, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
5 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(-0.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0146, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
4 gae_duplicate tensor(-0.2669, dtype=torch.float64) tensor(0.4986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8366, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
3 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-0.1879, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2420, dtype=torch.float64) delta_t tensor(-0.0980, dtype=torch.float64)
2 gae_duplicate tensor(-0.5831, dtype=torch.float64) tensor(1.5362, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:386.9543762207031
value loss:5.836657524108887
entropies:350.5146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.697399854660034 seconds
19 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(-0.2450, dtype=torch.float64)
19 gae_duplicate tensor(-1.4274, dtype=torch.float64) tensor(4.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1763, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
18 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-1.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1376, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
17 gae_duplicate tensor(-0.1048, dtype=torch.float64) tensor(-2.4990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0358, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
16 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-0.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8692, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
15 gae_duplicate tensor(-0.2403, dtype=torch.float64) tensor(0.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4716, dtype=torch.float64) delta_t tensor(-0.0939, dtype=torch.float64)
14 gae_duplicate tensor(-1.0207, dtype=torch.float64) tensor(1.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2691, dtype=torch.float64) delta_t tensor(-0.5503, dtype=torch.float64)
13 gae_duplicate tensor(-2.6631, dtype=torch.float64) tensor(10.7884, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
12 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-1.8736, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
11 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-1.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0615, dtype=torch.float64) delta_t tensor(0.1051, dtype=torch.float64)
10 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-2.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
9 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(-1.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6294, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
8 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(0.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0015, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
7 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-2.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7577, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
6 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(-0.6616, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6300, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
5 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-1.7174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1894, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
4 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(0.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4502, dtype=torch.float64) delta_t tensor(-0.1160, dtype=torch.float64)
3 gae_duplicate tensor(-0.4853, dtype=torch.float64) tensor(2.4799, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
2 gae_duplicate tensor(-0.3844, dtype=torch.float64) tensor(1.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-375.2296142578125
value loss:22.976285934448242
entropies:351.037841796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658584833145142 seconds
19 rew tensor(1.1507, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
19 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(0.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1510, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
18 gae_duplicate tensor(0.0297, dtype=torch.float64) tensor(-2.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0486, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
17 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(-1.2420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9719, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
16 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-0.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
15 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(-2.0680, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
14 gae_duplicate tensor(-1.3636, dtype=torch.float64) tensor(2.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
13 gae_duplicate tensor(0.0862, dtype=torch.float64) tensor(-2.3666, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2669, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
12 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-1.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
11 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-2.5291, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(-0.1001, dtype=torch.float64)
10 gae_duplicate tensor(-0.1935, dtype=torch.float64) tensor(1.6681, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3447, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
9 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(-1.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5787, dtype=torch.float64) delta_t tensor(-0.1505, dtype=torch.float64)
8 gae_duplicate tensor(-0.3861, dtype=torch.float64) tensor(2.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9639, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
7 gae_duplicate tensor(-0.2295, dtype=torch.float64) tensor(-0.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7071, dtype=torch.float64) delta_t tensor(0.0273, dtype=torch.float64)
6 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(-0.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5785, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
5 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-1.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2161, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
4 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3747, dtype=torch.float64) delta_t tensor(-0.0798, dtype=torch.float64)
3 gae_duplicate tensor(-0.2990, dtype=torch.float64) tensor(1.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5619, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
2 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-0.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:299.1336364746094
value loss:7.299421787261963
entropies:351.55029296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.835003852844238 seconds
19 rew tensor(1.1123, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
19 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(0.5666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1125, dtype=torch.float64) delta_t tensor(0.1023, dtype=torch.float64)
18 gae_duplicate tensor(-0.0106, dtype=torch.float64) tensor(-1.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0485, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
17 gae_duplicate tensor(-0.0737, dtype=torch.float64) tensor(-0.7406, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0100, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
16 gae_duplicate tensor(0.0312, dtype=torch.float64) tensor(-1.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8948, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
15 gae_duplicate tensor(-0.1509, dtype=torch.float64) tensor(-2.4537, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6644, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
14 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(-3.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6513, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
13 gae_duplicate tensor(0.0497, dtype=torch.float64) tensor(-3.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3059, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
12 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(-1.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4461, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
11 gae_duplicate tensor(-0.2743, dtype=torch.float64) tensor(-0.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0910, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
10 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(0.3302, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4461, dtype=torch.float64) delta_t tensor(0.1129, dtype=torch.float64)
9 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-2.1548, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5786, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
8 gae_duplicate tensor(-0.2160, dtype=torch.float64) tensor(1.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9120, dtype=torch.float64) delta_t tensor(-0.1483, dtype=torch.float64)
7 gae_duplicate tensor(-0.9041, dtype=torch.float64) tensor(3.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6941, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
6 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(0.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4248, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
5 gae_duplicate tensor(-0.2396, dtype=torch.float64) tensor(2.0502, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
4 gae_duplicate tensor(-0.2634, dtype=torch.float64) tensor(1.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-0.1645, dtype=torch.float64)
3 gae_duplicate tensor(-0.2877, dtype=torch.float64) tensor(3.2723, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3309, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
2 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(0.7008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.36144256591797
value loss:6.60088586807251
entropies:351.9772644042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.96720814704895 seconds
19 rew tensor(1.1891, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
19 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-0.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1381, dtype=torch.float64) delta_t tensor(0.1505, dtype=torch.float64)
18 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-2.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9972, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
17 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-0.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9208, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
16 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(0.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8436, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
15 gae_duplicate tensor(-0.2268, dtype=torch.float64) tensor(-1.2613, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7023, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
14 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-0.9824, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(-0.3849, dtype=torch.float64)
13 gae_duplicate tensor(-2.6786, dtype=torch.float64) tensor(6.9358, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2414, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
12 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0962, dtype=torch.float64)
11 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-1.8347, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0410, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
10 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-1.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
9 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(-1.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6558, dtype=torch.float64) delta_t tensor(-0.0283, dtype=torch.float64)
8 gae_duplicate tensor(-0.2374, dtype=torch.float64) tensor(0.4707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2706, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
7 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(0.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8355, dtype=torch.float64) delta_t tensor(-0.0089, dtype=torch.float64)
6 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(0.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2198, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
5 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(0.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2724, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
4 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(0.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6427, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
3 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(-0.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0736, dtype=torch.float64) delta_t tensor(-0.1647, dtype=torch.float64)
2 gae_duplicate tensor(-0.4173, dtype=torch.float64) tensor(3.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-264.9985046386719
value loss:15.007591247558594
entropies:352.3048400878906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3932.4736)
ToM Target loss= tensor(4005.1924)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.990854024887085 seconds
19 rew tensor(1.1509, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
19 gae_duplicate tensor(-0.1032, dtype=torch.float64) tensor(-0.3699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0614, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
18 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-1.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0872, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
17 gae_duplicate tensor(0.0179, dtype=torch.float64) tensor(-1.9142, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
16 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-0.3995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8308, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
15 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-0.1385, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
14 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(-1.4648, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
13 gae_duplicate tensor(-1.2935, dtype=torch.float64) tensor(0.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
12 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-1.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
11 gae_duplicate tensor(-0.0825, dtype=torch.float64) tensor(0.0548, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0101, dtype=torch.float64) delta_t tensor(-0.0031, dtype=torch.float64)
10 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(0.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
9 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-0.7369, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4254, dtype=torch.float64) delta_t tensor(-0.1585, dtype=torch.float64)
8 gae_duplicate tensor(-0.3836, dtype=torch.float64) tensor(2.9531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0252, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
7 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-1.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6442, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
6 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-2.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5772, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
5 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(0.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1371, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
4 gae_duplicate tensor(-0.1914, dtype=torch.float64) tensor(0.4670, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2181, dtype=torch.float64) delta_t tensor(-0.1762, dtype=torch.float64)
3 gae_duplicate tensor(-0.3809, dtype=torch.float64) tensor(3.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4701, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
2 gae_duplicate tensor(-0.2962, dtype=torch.float64) tensor(0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:68.36180114746094
value loss:7.9895148277282715
entropies:352.6006164550781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.897225856781006 seconds
19 rew tensor(1.0739, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
19 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(1.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0743, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
18 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-1.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9720, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
17 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(0.6421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9848, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
16 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(-0.5634, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
15 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-1.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6260, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
14 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-3.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6515, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
13 gae_duplicate tensor(0.0580, dtype=torch.float64) tensor(-2.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
12 gae_duplicate tensor(-0.1383, dtype=torch.float64) tensor(-0.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
11 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(-0.9433, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
10 gae_duplicate tensor(-0.0991, dtype=torch.float64) tensor(-0.5030, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
9 gae_duplicate tensor(-0.1492, dtype=torch.float64) tensor(-1.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6823, dtype=torch.float64) delta_t tensor(-0.1091, dtype=torch.float64)
8 gae_duplicate tensor(-0.3089, dtype=torch.float64) tensor(2.1462, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3988, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
7 gae_duplicate tensor(-0.1000, dtype=torch.float64) tensor(-0.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7848, dtype=torch.float64) delta_t tensor(-0.1068, dtype=torch.float64)
6 gae_duplicate tensor(-0.2479, dtype=torch.float64) tensor(2.2106, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2970, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
5 gae_duplicate tensor(-0.5993, dtype=torch.float64) tensor(1.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1699, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
4 gae_duplicate tensor(-0.2699, dtype=torch.float64) tensor(1.5022, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7715, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
3 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(1.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1890, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
2 gae_duplicate tensor(-0.2848, dtype=torch.float64) tensor(-2.0649, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:84.0941162109375
value loss:4.691871643066406
entropies:352.875244140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.743117094039917 seconds
19 rew tensor(1.1256, dtype=torch.float64) delta_t tensor(-0.0599, dtype=torch.float64)
19 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(1.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1386, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
18 gae_duplicate tensor(0.0247, dtype=torch.float64) tensor(-1.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0616, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
17 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-0.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9591, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
16 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-0.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8698, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
15 gae_duplicate tensor(-0.1755, dtype=torch.float64) tensor(-1.5356, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4206, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
14 gae_duplicate tensor(-1.3945, dtype=torch.float64) tensor(1.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(-0.1477, dtype=torch.float64)
13 gae_duplicate tensor(-1.3732, dtype=torch.float64) tensor(3.5685, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3433, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
12 gae_duplicate tensor(-0.2294, dtype=torch.float64) tensor(0.2040, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
11 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(-0.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0230, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
10 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-0.5429, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2160, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
9 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(0.1086, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5030, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
8 gae_duplicate tensor(-0.4425, dtype=torch.float64) tensor(1.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7573, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
7 gae_duplicate tensor(-0.3214, dtype=torch.float64) tensor(-0.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6185, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
6 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-1.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5791, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
5 gae_duplicate tensor(-0.2271, dtype=torch.float64) tensor(0.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0093, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
4 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(0.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0533, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
3 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(0.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3683, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
2 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(-0.1103, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-242.8057861328125
value loss:9.575736999511719
entropies:353.1065673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.878451824188232 seconds
19 rew tensor(1.1766, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
19 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(0.5855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1510, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
18 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-1.8254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0737, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
17 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-1.0280, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0614, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
16 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-2.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
15 gae_duplicate tensor(-0.2541, dtype=torch.float64) tensor(0.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
14 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-0.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
13 gae_duplicate tensor(-0.0281, dtype=torch.float64) tensor(-2.4217, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3298, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
12 gae_duplicate tensor(-0.2584, dtype=torch.float64) tensor(-0.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7132, dtype=torch.float64) delta_t tensor(-0.9980, dtype=torch.float64)
11 gae_duplicate tensor(-5.8502, dtype=torch.float64) tensor(18.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0473, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
10 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-1.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2557, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
9 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-1.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(0.0158, dtype=torch.float64)
8 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-0.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5124, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
7 gae_duplicate tensor(-0.0937, dtype=torch.float64) tensor(-1.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8756, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
6 gae_duplicate tensor(-0.3663, dtype=torch.float64) tensor(1.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2702, dtype=torch.float64) delta_t tensor(-0.1797, dtype=torch.float64)
5 gae_duplicate tensor(-0.5661, dtype=torch.float64) tensor(3.8504, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2482, dtype=torch.float64) delta_t tensor(-0.0660, dtype=torch.float64)
4 gae_duplicate tensor(-0.2693, dtype=torch.float64) tensor(1.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7693, dtype=torch.float64) delta_t tensor(-0.1453, dtype=torch.float64)
3 gae_duplicate tensor(-0.4840, dtype=torch.float64) tensor(2.8543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1110, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
2 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(1.5964, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-935.729248046875
value loss:57.239559173583984
entropies:353.3236083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777451038360596 seconds
19 rew tensor(1.1511, dtype=torch.float64) delta_t tensor(-0.0583, dtype=torch.float64)
19 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(1.1116, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1513, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
18 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-1.7985, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0616, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
17 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-1.0579, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9721, dtype=torch.float64) delta_t tensor(-0.0133, dtype=torch.float64)
16 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(0.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8051, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
15 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(-2.3648, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4214, dtype=torch.float64) delta_t tensor(-0.2370, dtype=torch.float64)
14 gae_duplicate tensor(-1.2636, dtype=torch.float64) tensor(4.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5742, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
13 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-0.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
12 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(0.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3815, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
11 gae_duplicate tensor(-0.0593, dtype=torch.float64) tensor(-0.9169, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0371, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
10 gae_duplicate tensor(-0.1340, dtype=torch.float64) tensor(-0.2898, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
9 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(-1.3370, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5019, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
8 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(2.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8897, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
7 gae_duplicate tensor(-0.4722, dtype=torch.float64) tensor(0.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5921, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
6 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(-0.4798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5809, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
5 gae_duplicate tensor(-0.2077, dtype=torch.float64) tensor(1.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0885, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
4 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(0.3115, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1209, dtype=torch.float64) delta_t tensor(-0.1261, dtype=torch.float64)
3 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(2.3928, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4474, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
2 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(0.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-358.5536193847656
value loss:5.900111675262451
entropies:353.6029052734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.1282)
ToM Target loss= tensor(4009.6836)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.661245107650757 seconds
19 rew tensor(1.1637, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
19 gae_duplicate tensor(-0.1346, dtype=torch.float64) tensor(1.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1255, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
18 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-1.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7809, dtype=torch.float64) delta_t tensor(-0.2791, dtype=torch.float64)
17 gae_duplicate tensor(-1.5230, dtype=torch.float64) tensor(5.8661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9210, dtype=torch.float64) delta_t tensor(-0.0559, dtype=torch.float64)
16 gae_duplicate tensor(-0.2069, dtype=torch.float64) tensor(1.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9338, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
15 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(-1.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1389, dtype=torch.float64) delta_t tensor(-0.4303, dtype=torch.float64)
14 gae_duplicate tensor(-2.4436, dtype=torch.float64) tensor(7.9836, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7284, dtype=torch.float64) delta_t tensor(0.1637, dtype=torch.float64)
13 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(-2.3129, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
12 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-0.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3441, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
11 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-1.7531, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0282, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
10 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(-0.1428, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
9 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-0.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4004, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
8 gae_duplicate tensor(-0.3175, dtype=torch.float64) tensor(1.3149, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7952, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
7 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(0.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5551, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
6 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-1.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6038, dtype=torch.float64) delta_t tensor(-0.1275, dtype=torch.float64)
5 gae_duplicate tensor(-0.2554, dtype=torch.float64) tensor(2.2861, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0938, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
4 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(2.4217, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9626, dtype=torch.float64) delta_t tensor(-0.0554, dtype=torch.float64)
3 gae_duplicate tensor(-0.4506, dtype=torch.float64) tensor(1.3511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(-0.2380, dtype=torch.float64)
2 gae_duplicate tensor(-0.2826, dtype=torch.float64) tensor(4.6254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1113.4442138671875
value loss:16.584997177124023
entropies:353.88812255859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.81627082824707 seconds
19 rew tensor(1.1388, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
19 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(1.7788, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1259, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
18 gae_duplicate tensor(-0.0027, dtype=torch.float64) tensor(-0.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0613, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
17 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(-0.5790, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9594, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
16 gae_duplicate tensor(-0.2190, dtype=torch.float64) tensor(1.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8437, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
15 gae_duplicate tensor(-0.2931, dtype=torch.float64) tensor(-1.3726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(-0.1982, dtype=torch.float64)
14 gae_duplicate tensor(-1.2713, dtype=torch.float64) tensor(4.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5748, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
13 gae_duplicate tensor(-0.1685, dtype=torch.float64) tensor(-0.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3817, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
12 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(-1.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4863, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
11 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(-2.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0424, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
10 gae_duplicate tensor(-0.2490, dtype=torch.float64) tensor(1.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
9 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-1.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5030, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
8 gae_duplicate tensor(-0.3790, dtype=torch.float64) tensor(3.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1426, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
7 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(-4.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6315, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
6 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-1.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6562, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
5 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-1.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
4 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(-1.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4132, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
3 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(0.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6637, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
2 gae_duplicate tensor(-0.2234, dtype=torch.float64) tensor(-2.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:279.2108154296875
value loss:7.518646240234375
entropies:354.1150207519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.687160015106201 seconds
19 rew tensor(1.0998, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
19 gae_duplicate tensor(-0.2061, dtype=torch.float64) tensor(2.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1001, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
18 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-0.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9717, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
17 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(0.7263, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(-0.1041, dtype=torch.float64)
16 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(2.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8056, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
15 gae_duplicate tensor(-0.3102, dtype=torch.float64) tensor(1.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7406, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
14 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-1.3691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6782, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
13 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(-1.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
12 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(-0.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4478, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
11 gae_duplicate tensor(-0.2524, dtype=torch.float64) tensor(-0.4080, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0289, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
10 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(0.9809, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1522, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
9 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(0.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5163, dtype=torch.float64) delta_t tensor(-0.1378, dtype=torch.float64)
8 gae_duplicate tensor(-0.3834, dtype=torch.float64) tensor(2.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8710, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
7 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-4.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6188, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
6 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-1.5386, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5785, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
5 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(-0.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1366, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
4 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-1.3378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2189, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
3 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(1.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
2 gae_duplicate tensor(-0.2184, dtype=torch.float64) tensor(-2.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:100.47279357910156
value loss:4.757143974304199
entropies:354.26275634765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.876568794250488 seconds
19 rew tensor(1.2410, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
19 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-0.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1772, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
18 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-1.7375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0487, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
17 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(-0.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9724, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
16 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(0.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8704, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
15 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(0.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7156, dtype=torch.float64) delta_t tensor(-0.0831, dtype=torch.float64)
14 gae_duplicate tensor(-0.2948, dtype=torch.float64) tensor(1.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
13 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(-1.0472, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4075, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
12 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(1.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
11 gae_duplicate tensor(-0.2693, dtype=torch.float64) tensor(1.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
10 gae_duplicate tensor(-0.2792, dtype=torch.float64) tensor(-0.8110, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1398, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
9 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(-0.7786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3235, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
8 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(0.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1664, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
7 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-0.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5942, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
6 gae_duplicate tensor(-0.3409, dtype=torch.float64) tensor(0.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6026, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
5 gae_duplicate tensor(-0.3264, dtype=torch.float64) tensor(2.5323, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1493, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
4 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-0.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1794, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
3 gae_duplicate tensor(-0.3111, dtype=torch.float64) tensor(-0.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4048, dtype=torch.float64) delta_t tensor(-0.0695, dtype=torch.float64)
2 gae_duplicate tensor(-0.6353, dtype=torch.float64) tensor(1.3351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-335.8288879394531
value loss:4.320675849914551
entropies:354.4037170410156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.809437990188599 seconds
19 rew tensor(1.2403, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
19 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(1.2278, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1763, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
18 gae_duplicate tensor(-0.0769, dtype=torch.float64) tensor(-0.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1766, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
17 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-1.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0485, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
16 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(0.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9724, dtype=torch.float64) delta_t tensor(0.1897, dtype=torch.float64)
15 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(-3.8116, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0287, dtype=torch.float64) delta_t tensor(-0.5239, dtype=torch.float64)
14 gae_duplicate tensor(-2.5682, dtype=torch.float64) tensor(10.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6261, dtype=torch.float64) delta_t tensor(0.2029, dtype=torch.float64)
13 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(-2.8893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3559, dtype=torch.float64) delta_t tensor(0.1925, dtype=torch.float64)
12 gae_duplicate tensor(-0.0445, dtype=torch.float64) tensor(-4.0373, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.1356, dtype=torch.float64)
11 gae_duplicate tensor(-0.0764, dtype=torch.float64) tensor(-3.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0284, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
10 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-2.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5238, dtype=torch.float64) delta_t tensor(0.1661, dtype=torch.float64)
9 gae_duplicate tensor(0.0057, dtype=torch.float64) tensor(-3.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8103, dtype=torch.float64) delta_t tensor(-0.2137, dtype=torch.float64)
8 gae_duplicate tensor(-0.5202, dtype=torch.float64) tensor(3.9008, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6536, dtype=torch.float64) delta_t tensor(-0.7648, dtype=torch.float64)
7 gae_duplicate tensor(-2.5089, dtype=torch.float64) tensor(15.8250, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9391, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
6 gae_duplicate tensor(-0.5416, dtype=torch.float64) tensor(0.3079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3747, dtype=torch.float64) delta_t tensor(0.1533, dtype=torch.float64)
5 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-3.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
4 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-1.9824, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2977, dtype=torch.float64) delta_t tensor(-0.2699, dtype=torch.float64)
3 gae_duplicate tensor(-0.5934, dtype=torch.float64) tensor(5.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4198, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
2 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-1.4491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-550.3938598632812
value loss:39.31625747680664
entropies:354.60491943359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.5208)
ToM Target loss= tensor(3989.5820)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.792687892913818 seconds
19 rew tensor(1.2404, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
19 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(1.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2024, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
18 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-0.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1641, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
17 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(-0.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7037, dtype=torch.float64) delta_t tensor(-0.3481, dtype=torch.float64)
16 gae_duplicate tensor(-1.5502, dtype=torch.float64) tensor(6.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
15 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-0.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(-0.1656, dtype=torch.float64)
14 gae_duplicate tensor(-1.3335, dtype=torch.float64) tensor(3.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3103, dtype=torch.float64) delta_t tensor(-0.7350, dtype=torch.float64)
13 gae_duplicate tensor(-2.5864, dtype=torch.float64) tensor(15.1087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0479, dtype=torch.float64) delta_t tensor(-0.1039, dtype=torch.float64)
12 gae_duplicate tensor(-0.7348, dtype=torch.float64) tensor(3.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4855, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
11 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(-1.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0665, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
10 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-1.0342, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.0446, dtype=torch.float64)
9 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(-1.0689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6054, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
8 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-0.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4387, dtype=torch.float64) delta_t tensor(0.0341, dtype=torch.float64)
7 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-0.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7971, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
6 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(-1.0693, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3239, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
5 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-0.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2203, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
4 gae_duplicate tensor(-0.1852, dtype=torch.float64) tensor(0.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7858, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
3 gae_duplicate tensor(-0.2185, dtype=torch.float64) tensor(0.1353, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1259, dtype=torch.float64) delta_t tensor(-0.1337, dtype=torch.float64)
2 gae_duplicate tensor(-0.3231, dtype=torch.float64) tensor(2.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1352.5313720703125
value loss:29.428462982177734
entropies:354.7209167480469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.863111972808838 seconds
19 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
19 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(0.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1002, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
18 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-0.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(-0.0580, dtype=torch.float64)
17 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(1.0811, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8182, dtype=torch.float64) delta_t tensor(-0.1451, dtype=torch.float64)
16 gae_duplicate tensor(-0.2234, dtype=torch.float64) tensor(3.0724, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
15 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-0.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.1307, dtype=torch.float64)
14 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-2.6033, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8056, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
13 gae_duplicate tensor(0.0297, dtype=torch.float64) tensor(-2.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
12 gae_duplicate tensor(-0.2279, dtype=torch.float64) tensor(0.8446, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6771, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
11 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-2.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1949, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
10 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(0.8688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
9 gae_duplicate tensor(-0.1828, dtype=torch.float64) tensor(1.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5543, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
8 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(0.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5396, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
7 gae_duplicate tensor(-0.0833, dtype=torch.float64) tensor(-0.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6570, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
6 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-1.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4254, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
5 gae_duplicate tensor(-0.0931, dtype=torch.float64) tensor(-0.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0676, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
4 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(-0.5335, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8611, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
3 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-1.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3042, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
2 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-2.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:383.0484619140625
value loss:3.131446361541748
entropies:354.76690673828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.553883075714111 seconds
19 rew tensor(1.1765, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
19 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(1.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1256, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
18 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-0.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1253, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
17 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.8798, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9975, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
16 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(0.7299, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6256, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
15 gae_duplicate tensor(-1.0680, dtype=torch.float64) tensor(2.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2683, dtype=torch.float64) delta_t tensor(-0.2690, dtype=torch.float64)
14 gae_duplicate tensor(-2.2188, dtype=torch.float64) tensor(6.1097, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6515, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
13 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-2.4841, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4079, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
12 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(-2.4038, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(-0.1992, dtype=torch.float64)
11 gae_duplicate tensor(-1.4852, dtype=torch.float64) tensor(3.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0925, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
10 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-1.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4846, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
9 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-1.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6561, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
8 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-0.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7586, dtype=torch.float64) delta_t tensor(-0.3169, dtype=torch.float64)
7 gae_duplicate tensor(-2.1563, dtype=torch.float64) tensor(5.9209, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0281, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
6 gae_duplicate tensor(-0.4609, dtype=torch.float64) tensor(-0.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0685, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
5 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-0.8585, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4001, dtype=torch.float64) delta_t tensor(-0.0437, dtype=torch.float64)
4 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(0.8160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4913, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
3 gae_duplicate tensor(-0.2449, dtype=torch.float64) tensor(-0.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0921, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
2 gae_duplicate tensor(-0.5719, dtype=torch.float64) tensor(2.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-734.322021484375
value loss:24.9432373046875
entropies:354.7793273925781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9177162647247314 seconds
19 rew tensor(1.1519, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
19 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(1.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1136, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
18 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-0.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0369, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
17 gae_duplicate tensor(-0.2298, dtype=torch.float64) tensor(0.0950, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0109, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
16 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(0.1855, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8828, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
15 gae_duplicate tensor(-0.1332, dtype=torch.float64) tensor(-1.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0966, dtype=torch.float64) delta_t tensor(-0.2506, dtype=torch.float64)
14 gae_duplicate tensor(-1.1851, dtype=torch.float64) tensor(5.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6131, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
13 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-1.1164, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3051, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
12 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-0.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5879, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
11 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-1.8168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2466, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
10 gae_duplicate tensor(-0.2571, dtype=torch.float64) tensor(1.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4083, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
9 gae_duplicate tensor(-0.1482, dtype=torch.float64) tensor(0.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5282, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
8 gae_duplicate tensor(-0.0603, dtype=torch.float64) tensor(-1.4586, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7093, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
7 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(0.0314, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6310, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
6 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-2.6352, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5297, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
5 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-0.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
4 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(0.8538, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0558, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
3 gae_duplicate tensor(-0.2218, dtype=torch.float64) tensor(0.2299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3696, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
2 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(-0.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-75.73085021972656
value loss:6.62567138671875
entropies:354.7513427734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.644540071487427 seconds
19 rew tensor(1.1638, dtype=torch.float64) delta_t tensor(-0.0502, dtype=torch.float64)
19 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(0.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1513, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
18 gae_duplicate tensor(0.0030, dtype=torch.float64) tensor(-1.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0360, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
17 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-0.6845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9594, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
16 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(0.0435, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8314, dtype=torch.float64) delta_t tensor(-0.0445, dtype=torch.float64)
15 gae_duplicate tensor(-0.1769, dtype=torch.float64) tensor(0.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6780, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
14 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-0.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6902, dtype=torch.float64) delta_t tensor(0.1830, dtype=torch.float64)
13 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(-3.7082, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3695, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
12 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(0.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
11 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.4124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0871, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
10 gae_duplicate tensor(-0.0924, dtype=torch.float64) tensor(-0.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0876, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
9 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(1.3826, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5153, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
8 gae_duplicate tensor(-0.0996, dtype=torch.float64) tensor(0.1203, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7603, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
7 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-1.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6054, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
6 gae_duplicate tensor(-0.0628, dtype=torch.float64) tensor(-2.1861, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5811, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
5 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(0.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
4 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-2.1445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0682, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
3 gae_duplicate tensor(-0.4166, dtype=torch.float64) tensor(-0.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
2 gae_duplicate tensor(-0.2496, dtype=torch.float64) tensor(-2.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:568.7249145507812
value loss:3.54976224899292
entropies:354.6762390136719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3964.0671)
ToM Target loss= tensor(3982.0061)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.613811016082764 seconds
19 rew tensor(1.1900, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
19 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(0.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
18 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-0.8689, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1004, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
17 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-1.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9594, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.0924, dtype=torch.float64) tensor(0.4496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
15 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(-0.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7801, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
14 gae_duplicate tensor(0.0768, dtype=torch.float64) tensor(-5.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5113, dtype=torch.float64) delta_t tensor(0.1255, dtype=torch.float64)
13 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-3.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
12 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(-1.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0017, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
11 gae_duplicate tensor(-1.5816, dtype=torch.float64) tensor(4.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0483, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
10 gae_duplicate tensor(-0.1401, dtype=torch.float64) tensor(-1.5941, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2290, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
9 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-0.7521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4769, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
8 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(-0.0064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1064, dtype=torch.float64) delta_t tensor(-0.0197, dtype=torch.float64)
7 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(0.4159, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5797, dtype=torch.float64) delta_t tensor(0.2388, dtype=torch.float64)
6 gae_duplicate tensor(0.1033, dtype=torch.float64) tensor(-4.6948, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7866, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
5 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-0.0164, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1382, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
4 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(-0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4018, dtype=torch.float64) delta_t tensor(-0.0201, dtype=torch.float64)
3 gae_duplicate tensor(-0.3081, dtype=torch.float64) tensor(0.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4845, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
2 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(-2.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:775.1261596679688
value loss:9.541397094726562
entropies:354.5957336425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.882852077484131 seconds
19 rew tensor(1.1133, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
19 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(1.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0879, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
18 gae_duplicate tensor(-0.0493, dtype=torch.float64) tensor(-1.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0496, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
17 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-0.1324, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
16 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-0.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9215, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
15 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(-0.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6907, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
14 gae_duplicate tensor(-0.1875, dtype=torch.float64) tensor(-1.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8056, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
13 gae_duplicate tensor(0.0737, dtype=torch.float64) tensor(-3.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2543, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
12 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(1.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5367, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
11 gae_duplicate tensor(-0.1634, dtype=torch.float64) tensor(-1.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1309, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
10 gae_duplicate tensor(-0.1324, dtype=torch.float64) tensor(1.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
9 gae_duplicate tensor(-0.2195, dtype=torch.float64) tensor(1.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4779, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
8 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(-0.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2786, dtype=torch.float64) delta_t tensor(-0.4183, dtype=torch.float64)
7 gae_duplicate tensor(-2.2944, dtype=torch.float64) tensor(8.7512, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5942, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
6 gae_duplicate tensor(-0.3928, dtype=torch.float64) tensor(-1.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5552, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
5 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-0.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0369, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
4 gae_duplicate tensor(-0.1249, dtype=torch.float64) tensor(-0.9373, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0832, dtype=torch.float64) delta_t tensor(-0.1165, dtype=torch.float64)
3 gae_duplicate tensor(-0.2534, dtype=torch.float64) tensor(2.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3960, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
2 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(-0.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-349.6680908203125
value loss:12.164259910583496
entropies:354.5504455566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.625318765640259 seconds
19 rew tensor(1.1257, dtype=torch.float64) delta_t tensor(-0.0338, dtype=torch.float64)
19 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.6997, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0620, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
18 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-0.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9980, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
17 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-0.2602, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9468, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(0.5137, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8826, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
15 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-2.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7545, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
14 gae_duplicate tensor(-0.1492, dtype=torch.float64) tensor(-0.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
13 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-2.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
12 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(-1.0225, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
11 gae_duplicate tensor(-0.2297, dtype=torch.float64) tensor(-0.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0098, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
10 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-0.1876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3180, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
9 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(-0.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4259, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
8 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-0.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6320, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
7 gae_duplicate tensor(0.0351, dtype=torch.float64) tensor(-2.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6564, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
6 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(-1.3953, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3768, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
5 gae_duplicate tensor(-0.2143, dtype=torch.float64) tensor(0.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1950, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
4 gae_duplicate tensor(-0.2057, dtype=torch.float64) tensor(0.7436, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6456, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
3 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(-1.4351, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1259, dtype=torch.float64) delta_t tensor(-0.1459, dtype=torch.float64)
2 gae_duplicate tensor(-0.4813, dtype=torch.float64) tensor(2.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:365.83746337890625
value loss:4.195197582244873
entropies:354.39874267578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.950769901275635 seconds
19 rew tensor(1.1005, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
19 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(1.3720, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0880, dtype=torch.float64) delta_t tensor(0.0590, dtype=torch.float64)
18 gae_duplicate tensor(-0.0416, dtype=torch.float64) tensor(-1.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0239, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
17 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-0.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0242, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
16 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-1.7857, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8572, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
15 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-1.6312, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
14 gae_duplicate tensor(-1.4158, dtype=torch.float64) tensor(5.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(-0.1014, dtype=torch.float64)
13 gae_duplicate tensor(-1.3823, dtype=torch.float64) tensor(2.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3697, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
12 gae_duplicate tensor(-0.2078, dtype=torch.float64) tensor(-0.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(-0.0293, dtype=torch.float64)
11 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(0.6895, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0362, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
10 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-1.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2153, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
9 gae_duplicate tensor(-0.1514, dtype=torch.float64) tensor(-0.3752, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4009, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(-0.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8115, dtype=torch.float64) delta_t tensor(0.0839, dtype=torch.float64)
7 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(-1.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5038, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
6 gae_duplicate tensor(-0.1884, dtype=torch.float64) tensor(-1.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6331, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
5 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(0.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0097, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
4 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-0.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0047, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
3 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-0.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
2 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(-0.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-146.2650604248047
value loss:8.416008949279785
entropies:354.2818908691406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7958338260650635 seconds
19 rew tensor(1.1134, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
19 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(2.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
18 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-1.0492, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1268, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
17 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-1.4997, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9345, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-0.3947, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8960, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
15 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-2.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4086, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
14 gae_duplicate tensor(-1.4151, dtype=torch.float64) tensor(1.7402, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4340, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
13 gae_duplicate tensor(-1.1733, dtype=torch.float64) tensor(0.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
12 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-1.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4334, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
11 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(-1.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0801, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
10 gae_duplicate tensor(-0.1974, dtype=torch.float64) tensor(-0.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
9 gae_duplicate tensor(-0.2204, dtype=torch.float64) tensor(-1.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5036, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
8 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(0.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4147, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
7 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(-2.8195, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7601, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
6 gae_duplicate tensor(-0.0160, dtype=torch.float64) tensor(-2.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3265, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
5 gae_duplicate tensor(-0.3574, dtype=torch.float64) tensor(0.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2211, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
4 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-0.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6975, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
3 gae_duplicate tensor(-0.1947, dtype=torch.float64) tensor(-2.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0743, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
2 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(1.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:487.8242492675781
value loss:11.633482933044434
entropies:354.11468505859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3939.0225)
ToM Target loss= tensor(3967.8901)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.696427583694458 seconds
19 rew tensor(1.1908, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
19 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(1.2622, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2167, dtype=torch.float64) delta_t tensor(0.0788, dtype=torch.float64)
18 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-1.3882, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1398, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
17 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(-0.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0887, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
16 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0116, dtype=torch.float64) delta_t tensor(0.1960, dtype=torch.float64)
15 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-3.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.4248, dtype=torch.float64) delta_t tensor(-0.7839, dtype=torch.float64)
14 gae_duplicate tensor(-2.2965, dtype=torch.float64) tensor(14.4944, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5491, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
13 gae_duplicate tensor(-0.2748, dtype=torch.float64) tensor(-0.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2283, dtype=torch.float64) delta_t tensor(0.0784, dtype=torch.float64)
12 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(-1.5486, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6009, dtype=torch.float64) delta_t tensor(0.1284, dtype=torch.float64)
11 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-2.6121, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1962, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
10 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-0.9773, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5625, dtype=torch.float64) delta_t tensor(0.1519, dtype=torch.float64)
9 gae_duplicate tensor(-0.0315, dtype=torch.float64) tensor(-3.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7225, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
8 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(0.3825, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6069, dtype=torch.float64) delta_t tensor(0.1461, dtype=torch.float64)
7 gae_duplicate tensor(-0.1767, dtype=torch.float64) tensor(-2.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7997, dtype=torch.float64) delta_t tensor(0.0487, dtype=torch.float64)
6 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-1.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4289, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
5 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(-1.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0161, dtype=torch.float64) delta_t tensor(-0.0049, dtype=torch.float64)
4 gae_duplicate tensor(-0.0965, dtype=torch.float64) tensor(-0.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0829, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
3 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(0.1873, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3433, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
2 gae_duplicate tensor(-0.0994, dtype=torch.float64) tensor(-0.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:275.3460693359375
value loss:20.709928512573242
entropies:353.9003601074219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.852213144302368 seconds
19 rew tensor(1.1521, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
19 gae_duplicate tensor(-0.1348, dtype=torch.float64) tensor(0.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1135, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
18 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-0.9983, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0747, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
17 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-1.7814, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0495, dtype=torch.float64) delta_t tensor(0.1059, dtype=torch.float64)
16 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-2.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8697, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
15 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-0.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7546, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
14 gae_duplicate tensor(-0.2081, dtype=torch.float64) tensor(-1.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6643, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
13 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(-3.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3316, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
12 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-0.7920, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
11 gae_duplicate tensor(-0.1292, dtype=torch.float64) tensor(-0.5413, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0794, dtype=torch.float64) delta_t tensor(-0.0813, dtype=torch.float64)
10 gae_duplicate tensor(-0.1438, dtype=torch.float64) tensor(1.5597, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3308, dtype=torch.float64) delta_t tensor(0.1281, dtype=torch.float64)
9 gae_duplicate tensor(-0.0536, dtype=torch.float64) tensor(-2.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5288, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
8 gae_duplicate tensor(-0.3538, dtype=torch.float64) tensor(1.7349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5396, dtype=torch.float64) delta_t tensor(-0.3135, dtype=torch.float64)
7 gae_duplicate tensor(-2.4349, dtype=torch.float64) tensor(7.1852, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6190, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
6 gae_duplicate tensor(-0.3946, dtype=torch.float64) tensor(0.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6593, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
5 gae_duplicate tensor(-0.2448, dtype=torch.float64) tensor(0.2430, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1627, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
4 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-0.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3244, dtype=torch.float64) delta_t tensor(-0.2363, dtype=torch.float64)
3 gae_duplicate tensor(-0.3234, dtype=torch.float64) tensor(4.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5093, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
2 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-0.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-180.50634765625
value loss:14.320772171020508
entropies:353.75482177734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.729759931564331 seconds
19 rew tensor(1.1649, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
19 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(1.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1524, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
18 gae_duplicate tensor(-0.0437, dtype=torch.float64) tensor(-1.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9985, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
17 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(0.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0238, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
16 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(-0.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8313, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
15 gae_duplicate tensor(-0.0521, dtype=torch.float64) tensor(-0.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3446, dtype=torch.float64) delta_t tensor(-0.3109, dtype=torch.float64)
14 gae_duplicate tensor(-2.3140, dtype=torch.float64) tensor(5.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6774, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
13 gae_duplicate tensor(0.0110, dtype=torch.float64) tensor(-3.0600, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
12 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-1.3879, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5358, dtype=torch.float64) delta_t tensor(0.0880, dtype=torch.float64)
11 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-1.8608, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1053, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
10 gae_duplicate tensor(-0.2749, dtype=torch.float64) tensor(0.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
9 gae_duplicate tensor(-0.0898, dtype=torch.float64) tensor(-0.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4778, dtype=torch.float64) delta_t tensor(-0.0184, dtype=torch.float64)
8 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(0.2421, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1197, dtype=torch.float64) delta_t tensor(-0.2477, dtype=torch.float64)
7 gae_duplicate tensor(-2.5728, dtype=torch.float64) tensor(4.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8890, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
6 gae_duplicate tensor(-0.5016, dtype=torch.float64) tensor(2.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2491, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
5 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-2.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0927, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
4 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(0.7798, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8646, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
3 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
2 gae_duplicate tensor(-0.2342, dtype=torch.float64) tensor(0.6744, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-388.0283508300781
value loss:22.746965408325195
entropies:353.54205322265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9559948444366455 seconds
19 rew tensor(1.1773, dtype=torch.float64) delta_t tensor(-0.0545, dtype=torch.float64)
19 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(1.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1264, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
18 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-1.5577, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(-0.0556, dtype=torch.float64)
17 gae_duplicate tensor(-0.1487, dtype=torch.float64) tensor(0.9219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9209, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
16 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(0.4579, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(0.1424, dtype=torch.float64)
15 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(-2.7276, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
14 gae_duplicate tensor(-0.2221, dtype=torch.float64) tensor(-2.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6513, dtype=torch.float64) delta_t tensor(0.1041, dtype=torch.float64)
13 gae_duplicate tensor(-0.3243, dtype=torch.float64) tensor(-2.3994, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
12 gae_duplicate tensor(-0.1438, dtype=torch.float64) tensor(-2.3881, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
11 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(0.0321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0606, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
10 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-0.1950, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
9 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(-1.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5551, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
8 gae_duplicate tensor(-0.2716, dtype=torch.float64) tensor(-0.2406, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3325, dtype=torch.float64) delta_t tensor(-0.5006, dtype=torch.float64)
7 gae_duplicate tensor(-3.6588, dtype=torch.float64) tensor(9.6181, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7602, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
6 gae_duplicate tensor(-0.7453, dtype=torch.float64) tensor(0.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4281, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
5 gae_duplicate tensor(-0.2198, dtype=torch.float64) tensor(0.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0682, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
4 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-0.1964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9907, dtype=torch.float64) delta_t tensor(-0.1866, dtype=torch.float64)
3 gae_duplicate tensor(-0.4585, dtype=torch.float64) tensor(3.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2786, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
2 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-0.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-301.8427429199219
value loss:28.659652709960938
entropies:353.4879455566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.616984844207764 seconds
19 rew tensor(1.2289, dtype=torch.float64) delta_t tensor(-0.0750, dtype=torch.float64)
19 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(1.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2291, dtype=torch.float64) delta_t tensor(0.1265, dtype=torch.float64)
18 gae_duplicate tensor(-0.0313, dtype=torch.float64) tensor(-2.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0111, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
17 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(0.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8828, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
16 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(1.6238, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8957, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
15 gae_duplicate tensor(-0.1487, dtype=torch.float64) tensor(-0.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
14 gae_duplicate tensor(-0.0185, dtype=torch.float64) tensor(-4.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6392, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
13 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-2.7803, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2666, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
12 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-0.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3447, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
11 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(0.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1318, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
10 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(0.1540, dtype=torch.float64)
9 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-2.9282, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4781, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
8 gae_duplicate tensor(-0.4120, dtype=torch.float64) tensor(2.7562, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3491, dtype=torch.float64) delta_t tensor(0.4197, dtype=torch.float64)
7 gae_duplicate tensor(0.0918, dtype=torch.float64) tensor(-7.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6195, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
6 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8634, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
5 gae_duplicate tensor(-0.1767, dtype=torch.float64) tensor(-1.3244, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2913, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
4 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(-0.2417, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6196, dtype=torch.float64) delta_t tensor(-0.1858, dtype=torch.float64)
3 gae_duplicate tensor(-0.3993, dtype=torch.float64) tensor(3.6772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6250, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
2 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-1.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:747.1747436523438
value loss:7.050076484680176
entropies:353.4412841796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3938.9436)
ToM Target loss= tensor(3964.1362)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.731705188751221 seconds
19 rew tensor(1.1140, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
19 gae_duplicate tensor(-0.2518, dtype=torch.float64) tensor(2.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0622, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
18 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-0.2283, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9467, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
17 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(2.4746, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
16 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(1.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8828, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
15 gae_duplicate tensor(-0.2086, dtype=torch.float64) tensor(-2.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3932, dtype=torch.float64) delta_t tensor(-0.2649, dtype=torch.float64)
14 gae_duplicate tensor(-1.5231, dtype=torch.float64) tensor(4.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7163, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
13 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(-2.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
12 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(-1.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
11 gae_duplicate tensor(-0.1237, dtype=torch.float64) tensor(-1.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0353, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
10 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(-1.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3562, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
9 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(0.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4904, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
8 gae_duplicate tensor(-0.1634, dtype=torch.float64) tensor(-0.6278, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4665, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
7 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-0.5580, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7213, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
6 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(-2.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2242, dtype=torch.float64) delta_t tensor(-0.0969, dtype=torch.float64)
5 gae_duplicate tensor(-0.1845, dtype=torch.float64) tensor(1.7403, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3621, dtype=torch.float64) delta_t tensor(-0.0760, dtype=torch.float64)
4 gae_duplicate tensor(-0.4748, dtype=torch.float64) tensor(1.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5057, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
3 gae_duplicate tensor(-0.3131, dtype=torch.float64) tensor(-1.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0541, dtype=torch.float64) delta_t tensor(-0.1347, dtype=torch.float64)
2 gae_duplicate tensor(-0.5861, dtype=torch.float64) tensor(2.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-205.81710815429688
value loss:10.83767032623291
entropies:353.31268310546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.70525598526001 seconds
19 rew tensor(1.2546, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
19 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(0.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2034, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
18 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-1.1999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1647, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
17 gae_duplicate tensor(-0.1290, dtype=torch.float64) tensor(-1.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7552, dtype=torch.float64) delta_t tensor(-0.2947, dtype=torch.float64)
16 gae_duplicate tensor(-1.4475, dtype=torch.float64) tensor(6.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7025, dtype=torch.float64) delta_t tensor(-0.1905, dtype=torch.float64)
15 gae_duplicate tensor(-0.9514, dtype=torch.float64) tensor(4.0651, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
14 gae_duplicate tensor(-0.7698, dtype=torch.float64) tensor(1.4668, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3761, dtype=torch.float64) delta_t tensor(-0.7250, dtype=torch.float64)
13 gae_duplicate tensor(-3.6081, dtype=torch.float64) tensor(14.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.4176, dtype=torch.float64)
12 gae_duplicate tensor(-0.1128, dtype=torch.float64) tensor(-6.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3178, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
11 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-2.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
10 gae_duplicate tensor(0.0535, dtype=torch.float64) tensor(-3.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(0.1526, dtype=torch.float64)
9 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-3.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7229, dtype=torch.float64) delta_t tensor(-0.1590, dtype=torch.float64)
8 gae_duplicate tensor(-0.4227, dtype=torch.float64) tensor(2.6820, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1580, dtype=torch.float64) delta_t tensor(-0.2402, dtype=torch.float64)
7 gae_duplicate tensor(-2.0283, dtype=torch.float64) tensor(4.8744, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8130, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
6 gae_duplicate tensor(-0.4220, dtype=torch.float64) tensor(-1.3180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5555, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
5 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-1.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0685, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
4 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-1.2109, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1964, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
3 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(1.3782, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2524, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
2 gae_duplicate tensor(-0.3471, dtype=torch.float64) tensor(0.8821, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-869.7457275390625
value loss:39.80858612060547
entropies:353.23443603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.532434940338135 seconds
19 rew tensor(1.2674, dtype=torch.float64) delta_t tensor(-0.0780, dtype=torch.float64)
19 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(1.5626, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2292, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
18 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-0.9165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1268, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
17 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(1.3743, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8575, dtype=torch.float64) delta_t tensor(-0.2321, dtype=torch.float64)
16 gae_duplicate tensor(-1.5770, dtype=torch.float64) tensor(4.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0499, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
15 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-0.2233, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2696, dtype=torch.float64) delta_t tensor(-0.4163, dtype=torch.float64)
14 gae_duplicate tensor(-1.6467, dtype=torch.float64) tensor(7.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-1.3665, dtype=torch.float64) delta_t tensor(-1.7430, dtype=torch.float64)
13 gae_duplicate tensor(-4.2416, dtype=torch.float64) tensor(34.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1359, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
12 gae_duplicate tensor(-1.0141, dtype=torch.float64) tensor(2.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.2025, dtype=torch.float64)
11 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-3.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0157, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
10 gae_duplicate tensor(-0.2292, dtype=torch.float64) tensor(-2.3379, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5369, dtype=torch.float64) delta_t tensor(0.1004, dtype=torch.float64)
9 gae_duplicate tensor(-0.1148, dtype=torch.float64) tensor(-2.1479, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6324, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
8 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-2.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4017, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
7 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(0.0341, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8247, dtype=torch.float64) delta_t tensor(0.1353, dtype=torch.float64)
6 gae_duplicate tensor(-0.2842, dtype=torch.float64) tensor(-2.7233, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3004, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
5 gae_duplicate tensor(-0.0944, dtype=torch.float64) tensor(-2.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2208, dtype=torch.float64) delta_t tensor(0.0568, dtype=torch.float64)
4 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-1.4791, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8006, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
3 gae_duplicate tensor(-0.1591, dtype=torch.float64) tensor(-0.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1000, dtype=torch.float64) delta_t tensor(-0.1548, dtype=torch.float64)
2 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(2.9884, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2057.715087890625
value loss:74.7255630493164
entropies:353.2341613769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925675868988037 seconds
19 rew tensor(1.1900, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
19 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(2.2258, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1771, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
18 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(-0.6058, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0618, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
17 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(0.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0363, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
16 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(0.9325, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9465, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
15 gae_duplicate tensor(-0.2693, dtype=torch.float64) tensor(-1.1632, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3158, dtype=torch.float64) delta_t tensor(-0.3719, dtype=torch.float64)
14 gae_duplicate tensor(-2.2953, dtype=torch.float64) tensor(7.1031, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7146, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
13 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-0.8046, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
12 gae_duplicate tensor(-0.2421, dtype=torch.float64) tensor(-1.4367, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1029, dtype=torch.float64) delta_t tensor(-0.3408, dtype=torch.float64)
11 gae_duplicate tensor(-2.2191, dtype=torch.float64) tensor(6.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.3431, dtype=torch.float64) delta_t tensor(-1.1262, dtype=torch.float64)
10 gae_duplicate tensor(-6.6623, dtype=torch.float64) tensor(25.3129, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
9 gae_duplicate tensor(-0.6316, dtype=torch.float64) tensor(1.8388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5164, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
8 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(-1.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1948, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
7 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-2.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9278, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
6 gae_duplicate tensor(-0.2798, dtype=torch.float64) tensor(0.6536, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1187, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
5 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-0.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3759, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
4 gae_duplicate tensor(-0.1736, dtype=torch.float64) tensor(0.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5155, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
3 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(-1.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
2 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(0.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2062.160400390625
value loss:86.79741668701172
entropies:353.3576354980469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.55977988243103 seconds
19 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
19 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(1.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1124, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
18 gae_duplicate tensor(-0.1306, dtype=torch.float64) tensor(-0.1761, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0231, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
17 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(1.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9462, dtype=torch.float64) delta_t tensor(-0.1258, dtype=torch.float64)
16 gae_duplicate tensor(-0.2195, dtype=torch.float64) tensor(2.4820, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
15 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(1.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5356, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
14 gae_duplicate tensor(-1.1380, dtype=torch.float64) tensor(1.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7282, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
13 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-2.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3182, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
12 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(-1.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0494, dtype=torch.float64) delta_t tensor(-0.4654, dtype=torch.float64)
11 gae_duplicate tensor(-2.8333, dtype=torch.float64) tensor(8.6560, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6023, dtype=torch.float64) delta_t tensor(-0.3661, dtype=torch.float64)
10 gae_duplicate tensor(-2.6159, dtype=torch.float64) tensor(7.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3176, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
9 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(1.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6179, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
8 gae_duplicate tensor(-0.1822, dtype=torch.float64) tensor(0.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6826, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
7 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-3.8104, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7334, dtype=torch.float64) delta_t tensor(0.0940, dtype=torch.float64)
6 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-2.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5554, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
5 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-1.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
4 gae_duplicate tensor(-0.2526, dtype=torch.float64) tensor(0.3860, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1316, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
3 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-1.4169, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
2 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-1.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-733.1276245117188
value loss:28.17551040649414
entropies:353.33984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.2979)
ToM Target loss= tensor(3958.9651)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.799458980560303 seconds
19 rew tensor(1.1383, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
19 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(1.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
18 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-1.5391, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1007, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
17 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-1.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9724, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
16 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(0.5880, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9466, dtype=torch.float64) delta_t tensor(0.2180, dtype=torch.float64)
15 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-4.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(-0.5252, dtype=torch.float64)
14 gae_duplicate tensor(-1.5378, dtype=torch.float64) tensor(9.5266, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
13 gae_duplicate tensor(-0.0963, dtype=torch.float64) tensor(-0.5292, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4982, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
12 gae_duplicate tensor(-0.0877, dtype=torch.float64) tensor(-3.1881, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2670, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
11 gae_duplicate tensor(-0.2441, dtype=torch.float64) tensor(-1.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1645, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
10 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-1.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1385, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
9 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-2.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4766, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
8 gae_duplicate tensor(-0.4000, dtype=torch.float64) tensor(1.9171, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1192, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
7 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-2.2651, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6052, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
6 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-2.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7092, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
5 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-1.5835, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2412, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
4 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-2.7887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4143, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
3 gae_duplicate tensor(-0.3941, dtype=torch.float64) tensor(0.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
2 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(-2.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:685.2463989257812
value loss:11.327564239501953
entropies:353.3946838378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831284999847412 seconds
19 rew tensor(1.2413, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
19 gae_duplicate tensor(-0.0752, dtype=torch.float64) tensor(0.3834, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2161, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
18 gae_duplicate tensor(0.0683, dtype=torch.float64) tensor(-2.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1906, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
17 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-2.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0111, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
16 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-0.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9726, dtype=torch.float64) delta_t tensor(0.1287, dtype=torch.float64)
15 gae_duplicate tensor(-0.0082, dtype=torch.float64) tensor(-2.5720, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0610, dtype=torch.float64) delta_t tensor(-0.5714, dtype=torch.float64)
14 gae_duplicate tensor(-1.6272, dtype=torch.float64) tensor(11.2954, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2078, dtype=torch.float64) delta_t tensor(-0.7328, dtype=torch.float64)
13 gae_duplicate tensor(-2.6840, dtype=torch.float64) tensor(16.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
12 gae_duplicate tensor(-1.0396, dtype=torch.float64) tensor(3.8066, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0782, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
11 gae_duplicate tensor(-1.2039, dtype=torch.float64) tensor(5.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
10 gae_duplicate tensor(-0.3714, dtype=torch.float64) tensor(-2.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3313, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
9 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(-2.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6320, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
8 gae_duplicate tensor(-0.3218, dtype=torch.float64) tensor(-0.2140, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1935, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
7 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(0.6745, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8241, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
6 gae_duplicate tensor(-0.3509, dtype=torch.float64) tensor(-2.1059, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2212, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
5 gae_duplicate tensor(-0.3025, dtype=torch.float64) tensor(0.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3753, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
4 gae_duplicate tensor(-0.2542, dtype=torch.float64) tensor(-0.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5541, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
3 gae_duplicate tensor(-0.3100, dtype=torch.float64) tensor(-0.3317, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0417, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
2 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(0.8423, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1310.793212890625
value loss:32.7995719909668
entropies:353.5494384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6107189655303955 seconds
19 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
19 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1134, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
18 gae_duplicate tensor(-0.0082, dtype=torch.float64) tensor(-2.3634, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0111, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
17 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-0.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8831, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
16 gae_duplicate tensor(-0.1213, dtype=torch.float64) tensor(0.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
15 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(-1.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6521, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
14 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(0.9480, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6381, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
13 gae_duplicate tensor(-0.2714, dtype=torch.float64) tensor(-0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
12 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(0.7703, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5098, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
11 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-0.6912, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
10 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-2.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4463, dtype=torch.float64) delta_t tensor(0.0437, dtype=torch.float64)
9 gae_duplicate tensor(-0.1346, dtype=torch.float64) tensor(-1.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5154, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
8 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-1.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2109, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
7 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-1.1143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8742, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
6 gae_duplicate tensor(-0.2956, dtype=torch.float64) tensor(1.3519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9679, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
5 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-0.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4505, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
4 gae_duplicate tensor(-0.3159, dtype=torch.float64) tensor(1.5186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2241, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
3 gae_duplicate tensor(-0.2166, dtype=torch.float64) tensor(-2.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1039, dtype=torch.float64) delta_t tensor(-0.1915, dtype=torch.float64)
2 gae_duplicate tensor(-0.6515, dtype=torch.float64) tensor(3.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:184.89813232421875
value loss:4.456570148468018
entropies:353.5448913574219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.877443075180054 seconds
19 rew tensor(1.1908, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
19 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-0.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1909, dtype=torch.float64) delta_t tensor(0.1865, dtype=torch.float64)
18 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-3.7183, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7648, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
17 gae_duplicate tensor(-1.3631, dtype=torch.float64) tensor(4.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0366, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
16 gae_duplicate tensor(-0.0449, dtype=torch.float64) tensor(-1.3753, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6398, dtype=torch.float64) delta_t tensor(-0.1938, dtype=torch.float64)
15 gae_duplicate tensor(-1.3637, dtype=torch.float64) tensor(3.5392, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7675, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
14 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-3.9545, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
13 gae_duplicate tensor(-1.2394, dtype=torch.float64) tensor(-0.3346, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
12 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-3.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
11 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-2.2643, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0871, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
10 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-2.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
9 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-1.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6698, dtype=torch.float64) delta_t tensor(-0.0839, dtype=torch.float64)
8 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(1.5110, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4394, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
7 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(0.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7466, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
6 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(-0.5812, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4029, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
5 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(1.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1956, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
4 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(-0.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8505, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
3 gae_duplicate tensor(-0.4464, dtype=torch.float64) tensor(-0.3934, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1380, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
2 gae_duplicate tensor(-0.3282, dtype=torch.float64) tensor(0.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:386.1087646484375
value loss:13.880868911743164
entropies:353.5457458496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.646494150161743 seconds
19 rew tensor(1.1656, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
19 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-0.1113, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8928, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
18 gae_duplicate tensor(-1.4627, dtype=torch.float64) tensor(1.1049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0238, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
17 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(-0.3372, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9987, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
16 gae_duplicate tensor(-0.0032, dtype=torch.float64) tensor(-3.2755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
15 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(-3.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5882, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
14 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-3.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7289, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
13 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-3.6813, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2414, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
12 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(-1.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
11 gae_duplicate tensor(-0.1338, dtype=torch.float64) tensor(-2.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1822, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
10 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-1.2896, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
9 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(-1.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6582, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
8 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(1.2070, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4003, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
7 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-4.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8506, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
6 gae_duplicate tensor(-0.3380, dtype=torch.float64) tensor(0.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2486, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
5 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(0.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2732, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
4 gae_duplicate tensor(-0.2795, dtype=torch.float64) tensor(1.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6454, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
3 gae_duplicate tensor(-0.3099, dtype=torch.float64) tensor(-0.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0476, dtype=torch.float64) delta_t tensor(-0.1678, dtype=torch.float64)
2 gae_duplicate tensor(-0.4894, dtype=torch.float64) tensor(3.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:831.7759399414062
value loss:10.286417007446289
entropies:353.4503173828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3929.1670)
ToM Target loss= tensor(3969.8091)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.679038047790527 seconds
19 rew tensor(1.1777, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
19 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-0.5561, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1396, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
18 gae_duplicate tensor(0.0565, dtype=torch.float64) tensor(-2.4611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0498, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
17 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-2.1787, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0373, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
16 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-2.0927, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
15 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(-3.8444, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1926, dtype=torch.float64) delta_t tensor(-0.3294, dtype=torch.float64)
14 gae_duplicate tensor(-1.4432, dtype=torch.float64) tensor(5.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5750, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
13 gae_duplicate tensor(-0.0071, dtype=torch.float64) tensor(-2.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3562, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
12 gae_duplicate tensor(-0.0351, dtype=torch.float64) tensor(-2.9614, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4981, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
11 gae_duplicate tensor(-0.0431, dtype=torch.float64) tensor(-2.6521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0546, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
10 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-0.3151, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3825, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
9 gae_duplicate tensor(-0.1845, dtype=torch.float64) tensor(-0.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5805, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
8 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(0.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3515, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
7 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(-0.5981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7996, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
6 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-1.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2492, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
5 gae_duplicate tensor(-0.0993, dtype=torch.float64) tensor(0.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2469, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
4 gae_duplicate tensor(-0.2609, dtype=torch.float64) tensor(-0.1560, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6588, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
3 gae_duplicate tensor(-0.0568, dtype=torch.float64) tensor(-1.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1128, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
2 gae_duplicate tensor(-0.2998, dtype=torch.float64) tensor(-0.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:893.116455078125
value loss:9.659576416015625
entropies:353.4529113769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.729008197784424 seconds
19 rew tensor(1.2165, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
19 gae_duplicate tensor(-0.0493, dtype=torch.float64) tensor(-1.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8955, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
18 gae_duplicate tensor(-1.4386, dtype=torch.float64) tensor(2.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1007, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
17 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(-3.0826, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0374, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
16 gae_duplicate tensor(0.0830, dtype=torch.float64) tensor(-2.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7802, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
15 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(-1.7433, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2449, dtype=torch.float64) delta_t tensor(-0.2564, dtype=torch.float64)
14 gae_duplicate tensor(-1.3467, dtype=torch.float64) tensor(4.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4850, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
13 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-0.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
12 gae_duplicate tensor(-0.0646, dtype=torch.float64) tensor(-3.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
11 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-1.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0363, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
10 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-0.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1887, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
9 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(-1.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4002, dtype=torch.float64) delta_t tensor(-0.0344, dtype=torch.float64)
8 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(0.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1983, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
7 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(0.4920, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5290, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
6 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-1.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7640, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
5 gae_duplicate tensor(-0.2899, dtype=torch.float64) tensor(0.7745, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2404, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
4 gae_duplicate tensor(-0.1827, dtype=torch.float64) tensor(0.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3906, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
3 gae_duplicate tensor(-0.3512, dtype=torch.float64) tensor(1.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5872, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
2 gae_duplicate tensor(-0.2853, dtype=torch.float64) tensor(0.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:271.1139221191406
value loss:13.241042137145996
entropies:353.54425048828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.598618030548096 seconds
19 rew tensor(1.1906, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
19 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-0.0545, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2166, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
18 gae_duplicate tensor(0.0936, dtype=torch.float64) tensor(-3.4847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8698, dtype=torch.float64) delta_t tensor(-0.1284, dtype=torch.float64)
17 gae_duplicate tensor(-1.3179, dtype=torch.float64) tensor(2.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8070, dtype=torch.float64) delta_t tensor(-0.1610, dtype=torch.float64)
16 gae_duplicate tensor(-1.2345, dtype=torch.float64) tensor(3.2828, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9345, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
15 gae_duplicate tensor(-0.1865, dtype=torch.float64) tensor(-0.4542, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
14 gae_duplicate tensor(-0.6066, dtype=torch.float64) tensor(-3.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4467, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
13 gae_duplicate tensor(-1.1783, dtype=torch.float64) tensor(1.4505, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3300, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
12 gae_duplicate tensor(-0.0284, dtype=torch.float64) tensor(-2.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5247, dtype=torch.float64) delta_t tensor(0.1473, dtype=torch.float64)
11 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(-3.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0221, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
10 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-3.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
9 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-2.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6846, dtype=torch.float64) delta_t tensor(-0.1686, dtype=torch.float64)
8 gae_duplicate tensor(-0.2709, dtype=torch.float64) tensor(3.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9115, dtype=torch.float64) delta_t tensor(-0.7493, dtype=torch.float64)
7 gae_duplicate tensor(-2.4792, dtype=torch.float64) tensor(14.5309, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8262, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
6 gae_duplicate tensor(-0.4379, dtype=torch.float64) tensor(2.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4786, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
5 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(-1.6780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
4 gae_duplicate tensor(-0.1576, dtype=torch.float64) tensor(-1.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3628, dtype=torch.float64) delta_t tensor(-0.2405, dtype=torch.float64)
3 gae_duplicate tensor(-0.4929, dtype=torch.float64) tensor(4.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5219, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
2 gae_duplicate tensor(-0.3197, dtype=torch.float64) tensor(-0.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-538.1060180664062
value loss:32.29106140136719
entropies:353.641845703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.727733135223389 seconds
19 rew tensor(1.1770, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
19 gae_duplicate tensor(-0.0569, dtype=torch.float64) tensor(-0.9052, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0749, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
18 gae_duplicate tensor(0.0244, dtype=torch.float64) tensor(-1.4370, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0110, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
17 gae_duplicate tensor(-0.0775, dtype=torch.float64) tensor(-1.1188, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0496, dtype=torch.float64) delta_t tensor(0.0770, dtype=torch.float64)
16 gae_duplicate tensor(-0.0214, dtype=torch.float64) tensor(-1.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8576, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
15 gae_duplicate tensor(-0.1338, dtype=torch.float64) tensor(-0.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(-0.2044, dtype=torch.float64)
14 gae_duplicate tensor(-2.1042, dtype=torch.float64) tensor(3.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4602, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
13 gae_duplicate tensor(-0.9756, dtype=torch.float64) tensor(2.6469, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3566, dtype=torch.float64) delta_t tensor(0.1237, dtype=torch.float64)
12 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(-2.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.1170, dtype=torch.float64)
11 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-2.4438, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1185, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
10 gae_duplicate tensor(-0.2571, dtype=torch.float64) tensor(1.6465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
9 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(-1.1104, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4646, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
8 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(1.0014, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4014, dtype=torch.float64) delta_t tensor(-0.6282, dtype=torch.float64)
7 gae_duplicate tensor(-3.4672, dtype=torch.float64) tensor(13.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8107, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
6 gae_duplicate tensor(-0.7336, dtype=torch.float64) tensor(1.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3528, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
5 gae_duplicate tensor(-0.2325, dtype=torch.float64) tensor(-0.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1179, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
4 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(1.4042, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9292, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
3 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(0.3842, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2288, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
2 gae_duplicate tensor(-0.3135, dtype=torch.float64) tensor(0.6580, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-903.1991577148438
value loss:31.814735412597656
entropies:353.7422180175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.704853057861328 seconds
19 rew tensor(1.1909, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
19 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-0.0635, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2038, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
18 gae_duplicate tensor(0.1289, dtype=torch.float64) tensor(-3.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0116, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
17 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-0.0903, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9340, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(0.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8317, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
15 gae_duplicate tensor(-0.2374, dtype=torch.float64) tensor(-1.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1099, dtype=torch.float64) delta_t tensor(-0.2471, dtype=torch.float64)
14 gae_duplicate tensor(-1.4377, dtype=torch.float64) tensor(4.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6653, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
13 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-2.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1513, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
12 gae_duplicate tensor(-0.2177, dtype=torch.float64) tensor(-0.6634, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5741, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
11 gae_duplicate tensor(0.0206, dtype=torch.float64) tensor(-2.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1937, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
10 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-1.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
9 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-2.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7607, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
8 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-0.4529, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3987, dtype=torch.float64) delta_t tensor(0.1935, dtype=torch.float64)
7 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(-3.6965, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9522, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
6 gae_duplicate tensor(-0.2918, dtype=torch.float64) tensor(0.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2741, dtype=torch.float64) delta_t tensor(0.0707, dtype=torch.float64)
5 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-1.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1967, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
4 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(0.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8748, dtype=torch.float64) delta_t tensor(-0.1223, dtype=torch.float64)
3 gae_duplicate tensor(-0.3243, dtype=torch.float64) tensor(2.5433, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1499, dtype=torch.float64) delta_t tensor(-0.0667, dtype=torch.float64)
2 gae_duplicate tensor(-0.3190, dtype=torch.float64) tensor(1.7265, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:533.6564331054688
value loss:10.869006156921387
entropies:353.6844177246094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3932.2161)
ToM Target loss= tensor(3978.1953)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7514660358428955 seconds
19 rew tensor(1.2547, dtype=torch.float64) delta_t tensor(0.0499, dtype=torch.float64)
19 gae_duplicate tensor(-0.0941, dtype=torch.float64) tensor(-0.9735, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2038, dtype=torch.float64) delta_t tensor(0.1343, dtype=torch.float64)
18 gae_duplicate tensor(0.0079, dtype=torch.float64) tensor(-2.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1012, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
17 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-1.1631, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0240, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
16 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-1.1279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9596, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
15 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-1.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7292, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
14 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-1.7357, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
13 gae_duplicate tensor(-1.1577, dtype=torch.float64) tensor(-0.4720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3440, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
12 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-2.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2954, dtype=torch.float64) delta_t tensor(-0.5403, dtype=torch.float64)
11 gae_duplicate tensor(-3.9396, dtype=torch.float64) tensor(10.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0282, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
10 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(1.3200, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2792, dtype=torch.float64) delta_t tensor(0.0813, dtype=torch.float64)
9 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(-1.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5809, dtype=torch.float64) delta_t tensor(-0.0280, dtype=torch.float64)
8 gae_duplicate tensor(-0.4784, dtype=torch.float64) tensor(0.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1998, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
7 gae_duplicate tensor(-1.0830, dtype=torch.float64) tensor(0.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7481, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
6 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(-1.2246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6075, dtype=torch.float64) delta_t tensor(0.1396, dtype=torch.float64)
5 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(-2.7845, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1647, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
4 gae_duplicate tensor(-0.1290, dtype=torch.float64) tensor(-1.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4037, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
3 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(1.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
2 gae_duplicate tensor(-0.2590, dtype=torch.float64) tensor(-0.8019, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:225.6080780029297
value loss:34.023895263671875
entropies:353.63494873046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.653230905532837 seconds
19 rew tensor(1.0876, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
19 gae_duplicate tensor(-0.1002, dtype=torch.float64) tensor(1.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0751, dtype=torch.float64) delta_t tensor(0.0984, dtype=torch.float64)
18 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-1.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0624, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
17 gae_duplicate tensor(0.0190, dtype=torch.float64) tensor(-1.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
16 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(1.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9213, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
15 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-2.0369, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
14 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-1.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8319, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
13 gae_duplicate tensor(0.0718, dtype=torch.float64) tensor(-2.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2409, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
12 gae_duplicate tensor(-0.2118, dtype=torch.float64) tensor(1.1140, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2949, dtype=torch.float64) delta_t tensor(-0.1700, dtype=torch.float64)
11 gae_duplicate tensor(-1.1935, dtype=torch.float64) tensor(3.2101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8574, dtype=torch.float64) delta_t tensor(-0.5828, dtype=torch.float64)
10 gae_duplicate tensor(-3.5709, dtype=torch.float64) tensor(11.2795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2159, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
9 gae_duplicate tensor(-0.2265, dtype=torch.float64) tensor(1.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5031, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
8 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.7885, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4656, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
7 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-1.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6186, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
6 gae_duplicate tensor(-0.0083, dtype=torch.float64) tensor(-1.5064, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5050, dtype=torch.float64) delta_t tensor(-0.1470, dtype=torch.float64)
5 gae_duplicate tensor(-0.3625, dtype=torch.float64) tensor(2.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2209, dtype=torch.float64) delta_t tensor(-0.0200, dtype=torch.float64)
4 gae_duplicate tensor(-0.1123, dtype=torch.float64) tensor(0.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7733, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
3 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(1.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
2 gae_duplicate tensor(-0.2382, dtype=torch.float64) tensor(1.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-783.9894409179688
value loss:24.29682159423828
entropies:353.4601135253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.846787929534912 seconds
19 rew tensor(1.2293, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
19 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-0.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1654, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
18 gae_duplicate tensor(0.0070, dtype=torch.float64) tensor(-1.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1267, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
17 gae_duplicate tensor(0.0245, dtype=torch.float64) tensor(-2.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9990, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
16 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(-0.5477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
15 gae_duplicate tensor(-0.3639, dtype=torch.float64) tensor(-0.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3843, dtype=torch.float64) delta_t tensor(-0.0286, dtype=torch.float64)
14 gae_duplicate tensor(-1.2290, dtype=torch.float64) tensor(0.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6788, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
13 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(-2.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2023, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
12 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(0.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1539, dtype=torch.float64) delta_t tensor(-0.3998, dtype=torch.float64)
11 gae_duplicate tensor(-3.1116, dtype=torch.float64) tensor(7.4381, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0281, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
10 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(-1.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
9 gae_duplicate tensor(-0.1514, dtype=torch.float64) tensor(-1.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5922, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
8 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(1.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5319, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
7 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(-0.4087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7334, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
6 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(-0.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4813, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
5 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(0.6930, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1946, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
4 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(0.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8908, dtype=torch.float64) delta_t tensor(0.0753, dtype=torch.float64)
3 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-1.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1391, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
2 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(1.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-169.54893493652344
value loss:21.48862075805664
entropies:353.4622802734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.734262943267822 seconds
19 rew tensor(1.2292, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
19 gae_duplicate tensor(-0.1394, dtype=torch.float64) tensor(1.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1910, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
18 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-0.9635, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1014, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
17 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(0.1305, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9988, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
16 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(1.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9479, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
15 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(0.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8197, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
14 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(-1.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0683, dtype=torch.float64) delta_t tensor(-0.2958, dtype=torch.float64)
13 gae_duplicate tensor(-2.5185, dtype=torch.float64) tensor(5.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0328, dtype=torch.float64) delta_t tensor(-0.2445, dtype=torch.float64)
12 gae_duplicate tensor(-1.5181, dtype=torch.float64) tensor(5.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3176, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
11 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(1.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0796, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
10 gae_duplicate tensor(-0.1833, dtype=torch.float64) tensor(-0.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3576, dtype=torch.float64) delta_t tensor(0.1343, dtype=torch.float64)
9 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-2.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5547, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
8 gae_duplicate tensor(-0.4105, dtype=torch.float64) tensor(1.9101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5892, dtype=torch.float64) delta_t tensor(-0.3629, dtype=torch.float64)
7 gae_duplicate tensor(-2.5809, dtype=torch.float64) tensor(7.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7860, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
6 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(0.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6082, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
5 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-1.5536, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1380, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
4 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-0.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3776, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
3 gae_duplicate tensor(-0.3867, dtype=torch.float64) tensor(0.8149, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4845, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
2 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(-0.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1040.8353271484375
value loss:27.070253372192383
entropies:353.5088806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.632962942123413 seconds
19 rew tensor(1.2286, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
19 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(1.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2288, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
18 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-0.8527, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2031, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
17 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-1.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0755, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
16 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-0.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9474, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
15 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(-1.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9343, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
14 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(-3.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.8547, dtype=torch.float64) delta_t tensor(-1.1404, dtype=torch.float64)
13 gae_duplicate tensor(-2.8747, dtype=torch.float64) tensor(23.2688, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.1653, dtype=torch.float64)
12 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(-1.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
11 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-0.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1634, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
10 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-2.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1400, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
9 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-1.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5545, dtype=torch.float64) delta_t tensor(-0.0946, dtype=torch.float64)
8 gae_duplicate tensor(-0.4738, dtype=torch.float64) tensor(1.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4115, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
7 gae_duplicate tensor(-0.9870, dtype=torch.float64) tensor(1.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6702, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
6 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-0.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6823, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
5 gae_duplicate tensor(0.0448, dtype=torch.float64) tensor(-3.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2906, dtype=torch.float64) delta_t tensor(0.1505, dtype=torch.float64)
4 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(-3.1644, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5144, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
3 gae_duplicate tensor(-0.2274, dtype=torch.float64) tensor(0.5083, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.2152, dtype=torch.float64)
2 gae_duplicate tensor(-0.2457, dtype=torch.float64) tensor(-4.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-348.81231689453125
value loss:33.30826950073242
entropies:353.6675720214844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3939.2747)
ToM Target loss= tensor(3980.1736)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.812448024749756 seconds
19 rew tensor(1.1775, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
19 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(1.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8560, dtype=torch.float64) delta_t tensor(-0.2356, dtype=torch.float64)
18 gae_duplicate tensor(-1.5705, dtype=torch.float64) tensor(4.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9977, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
17 gae_duplicate tensor(-0.2399, dtype=torch.float64) tensor(1.8550, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9467, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
16 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(1.5572, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9081, dtype=torch.float64) delta_t tensor(-0.0604, dtype=torch.float64)
15 gae_duplicate tensor(-0.3001, dtype=torch.float64) tensor(1.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
14 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(-2.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(-0.3179, dtype=torch.float64)
13 gae_duplicate tensor(-1.4269, dtype=torch.float64) tensor(6.3811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3179, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
12 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(0.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4469, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
11 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-2.0836, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1130, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
10 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(-0.9543, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2936, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
9 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(0.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4909, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
8 gae_duplicate tensor(-0.2233, dtype=torch.float64) tensor(-0.8837, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5517, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
7 gae_duplicate tensor(-0.1852, dtype=torch.float64) tensor(-0.0033, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7347, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
6 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-3.0863, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2710, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
5 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-2.1833, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2735, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
4 gae_duplicate tensor(-0.2658, dtype=torch.float64) tensor(0.1102, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6165, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
3 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(-1.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0216, dtype=torch.float64) delta_t tensor(-0.1290, dtype=torch.float64)
2 gae_duplicate tensor(-0.6227, dtype=torch.float64) tensor(2.1893, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-473.8477783203125
value loss:12.424612045288086
entropies:353.6800537109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.63159704208374 seconds
19 rew tensor(1.1906, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
19 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(1.6156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1397, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
18 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-1.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9983, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
17 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(1.5132, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9986, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
16 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(0.6130, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8700, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
15 gae_duplicate tensor(-0.3323, dtype=torch.float64) tensor(-0.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6648, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
14 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(-0.1834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2917, dtype=torch.float64) delta_t tensor(-0.1906, dtype=torch.float64)
13 gae_duplicate tensor(-1.3512, dtype=torch.float64) tensor(3.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
12 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(-1.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4724, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
11 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-0.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1827, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
10 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-0.4919, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
9 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-2.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6441, dtype=torch.float64) delta_t tensor(-0.0830, dtype=torch.float64)
8 gae_duplicate tensor(-0.3532, dtype=torch.float64) tensor(1.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3241, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
7 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(-0.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9397, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
6 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(0.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0938, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
5 gae_duplicate tensor(-0.4417, dtype=torch.float64) tensor(-1.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2595, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
4 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-0.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5936, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
3 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-3.5735, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0868, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
2 gae_duplicate tensor(-0.2334, dtype=torch.float64) tensor(0.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-19.059293746948242
value loss:7.218338489532471
entropies:353.762939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.746302843093872 seconds
19 rew tensor(1.2028, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
19 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(2.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1902, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
18 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-0.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1132, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
17 gae_duplicate tensor(-0.1563, dtype=torch.float64) tensor(0.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0488, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
16 gae_duplicate tensor(-0.2181, dtype=torch.float64) tensor(1.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9597, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
15 gae_duplicate tensor(-0.2517, dtype=torch.float64) tensor(1.4516, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7797, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
14 gae_duplicate tensor(-0.2389, dtype=torch.float64) tensor(-0.8465, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8707, dtype=torch.float64) delta_t tensor(0.2437, dtype=torch.float64)
13 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-4.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1046, dtype=torch.float64) delta_t tensor(-0.3182, dtype=torch.float64)
12 gae_duplicate tensor(-0.8294, dtype=torch.float64) tensor(5.6400, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1891, dtype=torch.float64) delta_t tensor(-0.2807, dtype=torch.float64)
11 gae_duplicate tensor(-2.0798, dtype=torch.float64) tensor(5.9507, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7882, dtype=torch.float64) delta_t tensor(-0.5445, dtype=torch.float64)
10 gae_duplicate tensor(-3.7566, dtype=torch.float64) tensor(10.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4327, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
9 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(0.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6054, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
8 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-3.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9611, dtype=torch.float64) delta_t tensor(-0.3781, dtype=torch.float64)
7 gae_duplicate tensor(-2.4240, dtype=torch.float64) tensor(6.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9144, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
6 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(-0.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1699, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
5 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-3.3926, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0942, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
4 gae_duplicate tensor(-0.1381, dtype=torch.float64) tensor(-1.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8996, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
3 gae_duplicate tensor(-0.3255, dtype=torch.float64) tensor(-0.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2525, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
2 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(-1.2626, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1083.916259765625
value loss:44.63258743286133
entropies:353.8883056640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.599980115890503 seconds
19 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(-0.0746, dtype=torch.float64)
19 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(1.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0876, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
18 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-0.6535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9727, dtype=torch.float64) delta_t tensor(-0.0405, dtype=torch.float64)
17 gae_duplicate tensor(-0.0893, dtype=torch.float64) tensor(0.7699, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9080, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
16 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(1.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8311, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
15 gae_duplicate tensor(-0.2459, dtype=torch.float64) tensor(0.4546, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7286, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
14 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(0.5514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6391, dtype=torch.float64) delta_t tensor(0.1124, dtype=torch.float64)
13 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-2.1409, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3057, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
12 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(0.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3942, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
11 gae_duplicate tensor(-0.2687, dtype=torch.float64) tensor(0.0393, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0021, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
10 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(0.7063, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
9 gae_duplicate tensor(-0.2482, dtype=torch.float64) tensor(-0.9765, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4507, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
8 gae_duplicate tensor(-0.3482, dtype=torch.float64) tensor(1.8157, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6202, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
7 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-1.5031, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6439, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
6 gae_duplicate tensor(-0.0179, dtype=torch.float64) tensor(-2.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4285, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
5 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-0.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1184, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
4 gae_duplicate tensor(-0.0253, dtype=torch.float64) tensor(-0.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7867, dtype=torch.float64) delta_t tensor(0.1262, dtype=torch.float64)
3 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-2.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2278, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
2 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-0.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:112.0871810913086
value loss:3.133329391479492
entropies:354.01641845703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.496997117996216 seconds
19 rew tensor(1.1263, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
19 gae_duplicate tensor(-0.2224, dtype=torch.float64) tensor(1.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1262, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
18 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-0.8023, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0105, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
17 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(0.2315, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9468, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
16 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(1.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5354, dtype=torch.float64) delta_t tensor(-0.2068, dtype=torch.float64)
15 gae_duplicate tensor(-1.2661, dtype=torch.float64) tensor(3.9990, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7674, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
14 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-2.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4864, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
13 gae_duplicate tensor(-0.9917, dtype=torch.float64) tensor(0.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
12 gae_duplicate tensor(-0.3163, dtype=torch.float64) tensor(-2.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
11 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(-1.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0223, dtype=torch.float64) delta_t tensor(0.0613, dtype=torch.float64)
10 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(-1.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
9 gae_duplicate tensor(-0.1997, dtype=torch.float64) tensor(-1.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5042, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
8 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-0.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6938, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
7 gae_duplicate tensor(-0.1966, dtype=torch.float64) tensor(-0.9440, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5940, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
6 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-1.9766, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5548, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
5 gae_duplicate tensor(-0.0395, dtype=torch.float64) tensor(-1.8911, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0425, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
4 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(0.6317, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0031, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
3 gae_duplicate tensor(-0.1687, dtype=torch.float64) tensor(-1.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3040, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
2 gae_duplicate tensor(-0.2506, dtype=torch.float64) tensor(-1.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:393.4791564941406
value loss:9.030223846435547
entropies:354.1046142578125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.4146)
ToM Target loss= tensor(3989.4419)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.890056133270264 seconds
19 rew tensor(1.2673, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
19 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(1.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2420, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
18 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-1.1135, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2166, dtype=torch.float64) delta_t tensor(0.0924, dtype=torch.float64)
17 gae_duplicate tensor(-0.0234, dtype=torch.float64) tensor(-1.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1011, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
16 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-1.0780, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0368, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
15 gae_duplicate tensor(-0.1136, dtype=torch.float64) tensor(-0.1628, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9472, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
14 gae_duplicate tensor(-0.0709, dtype=torch.float64) tensor(-4.4157, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7071, dtype=torch.float64) delta_t tensor(-0.9987, dtype=torch.float64)
13 gae_duplicate tensor(-2.6272, dtype=torch.float64) tensor(19.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
12 gae_duplicate tensor(-1.0693, dtype=torch.float64) tensor(3.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
11 gae_duplicate tensor(-0.2117, dtype=torch.float64) tensor(-0.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0021, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
10 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-1.6028, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
9 gae_duplicate tensor(-0.1752, dtype=torch.float64) tensor(-1.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5421, dtype=torch.float64) delta_t tensor(-0.1524, dtype=torch.float64)
8 gae_duplicate tensor(-0.3651, dtype=torch.float64) tensor(2.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6338, dtype=torch.float64) delta_t tensor(-0.1652, dtype=torch.float64)
7 gae_duplicate tensor(-1.9461, dtype=torch.float64) tensor(4.2085, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7737, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
6 gae_duplicate tensor(-0.3853, dtype=torch.float64) tensor(1.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6585, dtype=torch.float64) delta_t tensor(0.2675, dtype=torch.float64)
5 gae_duplicate tensor(-0.0119, dtype=torch.float64) tensor(-5.2029, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2415, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
4 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(-0.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5832, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
3 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-2.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5622, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
2 gae_duplicate tensor(-0.2515, dtype=torch.float64) tensor(0.5665, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-842.8080444335938
value loss:33.081016540527344
entropies:354.2402648925781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.542980194091797 seconds
19 rew tensor(1.1262, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
19 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(1.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1393, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
18 gae_duplicate tensor(-0.0400, dtype=torch.float64) tensor(-1.8913, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0622, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
17 gae_duplicate tensor(-0.0689, dtype=torch.float64) tensor(-1.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9214, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
16 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(0.4851, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
15 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-2.2152, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
14 gae_duplicate tensor(-1.0424, dtype=torch.float64) tensor(4.1862, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7031, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
13 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(-0.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2023, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
12 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(1.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
11 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-0.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1059, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
10 gae_duplicate tensor(-0.1150, dtype=torch.float64) tensor(0.2196, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4221, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
9 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(0.1506, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6323, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
8 gae_duplicate tensor(-0.2615, dtype=torch.float64) tensor(1.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4629, dtype=torch.float64) delta_t tensor(0.0807, dtype=torch.float64)
7 gae_duplicate tensor(-0.1329, dtype=torch.float64) tensor(-1.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6706, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
6 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-0.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3495, dtype=torch.float64) delta_t tensor(0.0479, dtype=torch.float64)
5 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(-0.9434, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1197, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
4 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-0.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7585, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
3 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(1.2236, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2652, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
2 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-1.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-46.976470947265625
value loss:4.230615139007568
entropies:354.2220764160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.993084192276001 seconds
19 rew tensor(1.1775, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
19 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(1.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2031, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
18 gae_duplicate tensor(0.0611, dtype=torch.float64) tensor(-2.2348, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1264, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
17 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-1.9191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
16 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(-0.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8958, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
15 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-4.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0882, dtype=torch.float64) delta_t tensor(-0.3753, dtype=torch.float64)
14 gae_duplicate tensor(-1.2131, dtype=torch.float64) tensor(6.6800, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5371, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
13 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-2.6825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
12 gae_duplicate tensor(-0.1122, dtype=torch.float64) tensor(-2.6569, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0006, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
11 gae_duplicate tensor(-1.1534, dtype=torch.float64) tensor(3.3082, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1241, dtype=torch.float64) delta_t tensor(0.1421, dtype=torch.float64)
10 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-2.4779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2425, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
9 gae_duplicate tensor(-0.2574, dtype=torch.float64) tensor(-0.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5801, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
8 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(0.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6963, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
7 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(0.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6571, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
6 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-1.6842, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5564, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
5 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0416, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
4 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-1.8572, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0556, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
3 gae_duplicate tensor(-0.3673, dtype=torch.float64) tensor(1.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
2 gae_duplicate tensor(-0.2537, dtype=torch.float64) tensor(-1.3951, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:422.713134765625
value loss:12.526968955993652
entropies:354.2986755371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.540211200714111 seconds
19 rew tensor(1.1647, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
19 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(0.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1263, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
18 gae_duplicate tensor(0.0346, dtype=torch.float64) tensor(-1.8852, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0109, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
17 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-0.1471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9592, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
16 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-0.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(0.1370, dtype=torch.float64)
15 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(-2.6530, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6254, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
14 gae_duplicate tensor(0.0080, dtype=torch.float64) tensor(-4.3089, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7424, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
13 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(-2.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1503, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
12 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(0.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6136, dtype=torch.float64) delta_t tensor(0.1750, dtype=torch.float64)
11 gae_duplicate tensor(0.0220, dtype=torch.float64) tensor(-3.3028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1566, dtype=torch.float64) delta_t tensor(-0.1073, dtype=torch.float64)
10 gae_duplicate tensor(-0.1986, dtype=torch.float64) tensor(1.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.1327, dtype=torch.float64)
9 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-2.2667, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7091, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
8 gae_duplicate tensor(-0.2770, dtype=torch.float64) tensor(0.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8792, dtype=torch.float64) delta_t tensor(-0.4054, dtype=torch.float64)
7 gae_duplicate tensor(-2.3310, dtype=torch.float64) tensor(7.8559, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8123, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
6 gae_duplicate tensor(-0.3425, dtype=torch.float64) tensor(1.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3226, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
5 gae_duplicate tensor(-0.1638, dtype=torch.float64) tensor(-0.3570, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1726, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
4 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-1.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8202, dtype=torch.float64) delta_t tensor(-0.1553, dtype=torch.float64)
3 gae_duplicate tensor(-0.4996, dtype=torch.float64) tensor(2.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1870, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
2 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-0.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:108.07463073730469
value loss:12.510276794433594
entropies:354.386474609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.784878969192505 seconds
19 rew tensor(1.1901, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
19 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(-0.2158, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1650, dtype=torch.float64) delta_t tensor(0.1372, dtype=torch.float64)
18 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-2.8672, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0756, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
17 gae_duplicate tensor(-0.0173, dtype=torch.float64) tensor(-2.9169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
16 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(-2.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6768, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
15 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-3.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8192, dtype=torch.float64) delta_t tensor(0.1297, dtype=torch.float64)
14 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-2.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4068, dtype=torch.float64) delta_t tensor(-0.0530, dtype=torch.float64)
13 gae_duplicate tensor(-0.2019, dtype=torch.float64) tensor(0.7132, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6909, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
12 gae_duplicate tensor(-0.1667, dtype=torch.float64) tensor(-2.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
11 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(0.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3836, dtype=torch.float64) delta_t tensor(0.1526, dtype=torch.float64)
10 gae_duplicate tensor(-0.0866, dtype=torch.float64) tensor(-3.1808, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1833, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
9 gae_duplicate tensor(-0.1312, dtype=torch.float64) tensor(-1.2566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3232, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
8 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(-0.2638, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4804, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
7 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(1.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4517, dtype=torch.float64) delta_t tensor(0.2217, dtype=torch.float64)
6 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-4.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9161, dtype=torch.float64) delta_t tensor(-0.0546, dtype=torch.float64)
5 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(0.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3702, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
4 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-3.3498, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5837, dtype=torch.float64) delta_t tensor(-0.1592, dtype=torch.float64)
3 gae_duplicate tensor(-0.3557, dtype=torch.float64) tensor(2.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7296, dtype=torch.float64) delta_t tensor(0.2037, dtype=torch.float64)
2 gae_duplicate tensor(-0.1463, dtype=torch.float64) tensor(-3.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1339.117919921875
value loss:7.703795433044434
entropies:354.4432067871094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3947.0107)
ToM Target loss= tensor(3989.8237)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.820547103881836 seconds
19 rew tensor(1.1137, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
19 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(1.5776, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1136, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
18 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-2.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0112, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
17 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-0.4992, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8697, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
16 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(1.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8829, dtype=torch.float64) delta_t tensor(0.1791, dtype=torch.float64)
15 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-3.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6002, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
14 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-1.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6397, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
13 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(-1.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
12 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-0.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6008, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
11 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-1.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2081, dtype=torch.float64) delta_t tensor(-0.0793, dtype=torch.float64)
10 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(1.3342, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4718, dtype=torch.float64) delta_t tensor(0.0708, dtype=torch.float64)
9 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-1.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5548, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
8 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(-0.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3220, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
7 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-0.7148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7481, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
6 gae_duplicate tensor(-0.2676, dtype=torch.float64) tensor(0.4274, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2468, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
5 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(0.8565, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2737, dtype=torch.float64) delta_t tensor(-0.0866, dtype=torch.float64)
4 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(1.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5534, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
3 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(0.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0986, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
2 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(0.7153, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:183.45538330078125
value loss:2.8131654262542725
entropies:354.4931335449219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.583710193634033 seconds
19 rew tensor(1.1654, dtype=torch.float64) delta_t tensor(-0.0539, dtype=torch.float64)
19 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(1.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1527, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
18 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-2.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0242, dtype=torch.float64) delta_t tensor(0.0068, dtype=torch.float64)
17 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(-0.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
16 gae_duplicate tensor(-0.0199, dtype=torch.float64) tensor(-0.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7668, dtype=torch.float64) delta_t tensor(-0.0997, dtype=torch.float64)
15 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(1.8536, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7156, dtype=torch.float64) delta_t tensor(-0.0535, dtype=torch.float64)
14 gae_duplicate tensor(-0.1692, dtype=torch.float64) tensor(1.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4973, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
13 gae_duplicate tensor(-0.0873, dtype=torch.float64) tensor(-0.9632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5890, dtype=torch.float64) delta_t tensor(0.0701, dtype=torch.float64)
12 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-1.4868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1371, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
11 gae_duplicate tensor(-0.2398, dtype=torch.float64) tensor(1.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2040, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
10 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(-0.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0595, dtype=torch.float64) delta_t tensor(0.0366, dtype=torch.float64)
9 gae_duplicate tensor(-0.1575, dtype=torch.float64) tensor(-0.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3491, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
8 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(0.8686, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9437, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
7 gae_duplicate tensor(-0.0275, dtype=torch.float64) tensor(-1.6000, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6570, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
6 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(-1.4814, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5073, dtype=torch.float64) delta_t tensor(-0.0429, dtype=torch.float64)
5 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(0.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0118, dtype=torch.float64) delta_t tensor(0.0648, dtype=torch.float64)
4 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(-1.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9956, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
3 gae_duplicate tensor(-0.2646, dtype=torch.float64) tensor(-0.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3715, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
2 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(-0.5118, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:130.77252197265625
value loss:3.543710708618164
entropies:354.53521728515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.708335876464844 seconds
19 rew tensor(1.2161, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
19 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(1.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2290, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
18 gae_duplicate tensor(0.0728, dtype=torch.float64) tensor(-2.3543, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1907, dtype=torch.float64) delta_t tensor(0.1317, dtype=torch.float64)
17 gae_duplicate tensor(-0.0205, dtype=torch.float64) tensor(-2.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0493, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
16 gae_duplicate tensor(-0.1791, dtype=torch.float64) tensor(-1.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9471, dtype=torch.float64) delta_t tensor(0.1827, dtype=torch.float64)
15 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-3.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0188, dtype=torch.float64) delta_t tensor(-0.3028, dtype=torch.float64)
14 gae_duplicate tensor(-1.0084, dtype=torch.float64) tensor(5.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(-0.1388, dtype=torch.float64)
13 gae_duplicate tensor(-1.1417, dtype=torch.float64) tensor(3.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
12 gae_duplicate tensor(-0.1891, dtype=torch.float64) tensor(-2.8213, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4605, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
11 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-2.3032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1624, dtype=torch.float64) delta_t tensor(0.1603, dtype=torch.float64)
10 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-3.4149, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2299, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
9 gae_duplicate tensor(-0.2166, dtype=torch.float64) tensor(-0.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5291, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
8 gae_duplicate tensor(-0.1193, dtype=torch.float64) tensor(-1.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6956, dtype=torch.float64) delta_t tensor(-0.5374, dtype=torch.float64)
7 gae_duplicate tensor(-3.4874, dtype=torch.float64) tensor(10.2297, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7349, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
6 gae_duplicate tensor(-0.5895, dtype=torch.float64) tensor(-0.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5559, dtype=torch.float64) delta_t tensor(0.1487, dtype=torch.float64)
5 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-2.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1890, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
4 gae_duplicate tensor(-0.2307, dtype=torch.float64) tensor(0.2248, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3634, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
3 gae_duplicate tensor(-0.3637, dtype=torch.float64) tensor(2.3419, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
2 gae_duplicate tensor(-0.2074, dtype=torch.float64) tensor(-1.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:14.02810287475586
value loss:30.22420310974121
entropies:354.5817565917969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.608327865600586 seconds
19 rew tensor(1.1901, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
19 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(1.9361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1769, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
18 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-0.4505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0871, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
17 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(0.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0363, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
16 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-0.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8693, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
15 gae_duplicate tensor(-0.1834, dtype=torch.float64) tensor(0.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1115, dtype=torch.float64) delta_t tensor(-0.2131, dtype=torch.float64)
14 gae_duplicate tensor(-0.9933, dtype=torch.float64) tensor(4.3624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7920, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
13 gae_duplicate tensor(0.0174, dtype=torch.float64) tensor(-3.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2150, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
12 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-0.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
11 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-2.4412, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2982, dtype=torch.float64) delta_t tensor(-0.1183, dtype=torch.float64)
10 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(2.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5873, dtype=torch.float64) delta_t tensor(0.1551, dtype=torch.float64)
9 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-2.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7070, dtype=torch.float64) delta_t tensor(-0.1518, dtype=torch.float64)
8 gae_duplicate tensor(-0.5014, dtype=torch.float64) tensor(2.6832, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5252, dtype=torch.float64) delta_t tensor(-0.4796, dtype=torch.float64)
7 gae_duplicate tensor(-2.3961, dtype=torch.float64) tensor(10.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9383, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
6 gae_duplicate tensor(-0.2710, dtype=torch.float64) tensor(0.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3264, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
5 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-3.0493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0099, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
4 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-1.2704, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0178, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
3 gae_duplicate tensor(-0.2879, dtype=torch.float64) tensor(0.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
2 gae_duplicate tensor(-0.5909, dtype=torch.float64) tensor(1.5933, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-676.81201171875
value loss:18.126419067382812
entropies:354.64300537109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.03419303894043 seconds
19 rew tensor(1.2413, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
19 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(1.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2155, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
18 gae_duplicate tensor(-0.0094, dtype=torch.float64) tensor(-1.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8656, dtype=torch.float64) delta_t tensor(-0.2485, dtype=torch.float64)
17 gae_duplicate tensor(-1.5252, dtype=torch.float64) tensor(4.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9975, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
16 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(1.4556, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0490, dtype=torch.float64) delta_t tensor(0.2133, dtype=torch.float64)
15 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-4.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1662, dtype=torch.float64) delta_t tensor(-0.2610, dtype=torch.float64)
14 gae_duplicate tensor(-2.0741, dtype=torch.float64) tensor(5.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
13 gae_duplicate tensor(-1.0236, dtype=torch.float64) tensor(-1.9573, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1253, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
12 gae_duplicate tensor(-0.9613, dtype=torch.float64) tensor(0.8708, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3402, dtype=torch.float64) delta_t tensor(-0.5915, dtype=torch.float64)
11 gae_duplicate tensor(-3.1109, dtype=torch.float64) tensor(11.5559, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0146, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
10 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-4.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
9 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-1.4701, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7337, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
8 gae_duplicate tensor(-0.2511, dtype=torch.float64) tensor(-0.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9881, dtype=torch.float64) delta_t tensor(-0.3349, dtype=torch.float64)
7 gae_duplicate tensor(-1.9184, dtype=torch.float64) tensor(7.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8878, dtype=torch.float64) delta_t tensor(0.1976, dtype=torch.float64)
6 gae_duplicate tensor(-0.3695, dtype=torch.float64) tensor(-3.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4277, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
5 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-3.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
4 gae_duplicate tensor(-0.2748, dtype=torch.float64) tensor(-0.0409, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0804, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
3 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2011, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
2 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-0.6419, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-681.6963500976562
value loss:43.93467330932617
entropies:354.5846862792969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3943.4768)
ToM Target loss= tensor(3989.5073)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.678680896759033 seconds
19 rew tensor(1.1124, dtype=torch.float64) delta_t tensor(-0.1105, dtype=torch.float64)
19 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(2.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0998, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
18 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-0.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9468, dtype=torch.float64) delta_t tensor(-0.0899, dtype=torch.float64)
17 gae_duplicate tensor(-0.1661, dtype=torch.float64) tensor(1.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9595, dtype=torch.float64) delta_t tensor(-0.0877, dtype=torch.float64)
16 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(1.9267, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8572, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
15 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(1.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8051, dtype=torch.float64) delta_t tensor(-0.0651, dtype=torch.float64)
14 gae_duplicate tensor(-0.2264, dtype=torch.float64) tensor(1.4487, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3552, dtype=torch.float64) delta_t tensor(-0.1323, dtype=torch.float64)
13 gae_duplicate tensor(-1.3747, dtype=torch.float64) tensor(2.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
12 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(-0.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
11 gae_duplicate tensor(-0.2521, dtype=torch.float64) tensor(0.7986, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0099, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
10 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(0.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2161, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
9 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-1.4018, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4513, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
8 gae_duplicate tensor(-0.4212, dtype=torch.float64) tensor(1.5983, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0260, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
7 gae_duplicate tensor(-1.1481, dtype=torch.float64) tensor(2.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6694, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
6 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(0.0081, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4776, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
5 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-0.9634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0167, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
4 gae_duplicate tensor(-0.1818, dtype=torch.float64) tensor(0.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9893, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
3 gae_duplicate tensor(-0.2977, dtype=torch.float64) tensor(0.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(0.6517, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-864.0050048828125
value loss:8.078716278076172
entropies:354.4276428222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.625064849853516 seconds
19 rew tensor(0.9441, dtype=torch.float64) delta_t tensor(-0.3504, dtype=torch.float64)
19 gae_duplicate tensor(-1.5168, dtype=torch.float64) tensor(6.7900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2153, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
18 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-0.6235, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1772, dtype=torch.float64) delta_t tensor(0.1151, dtype=torch.float64)
17 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(-2.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(-0.0207, dtype=torch.float64)
16 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.1782, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
15 gae_duplicate tensor(-0.2980, dtype=torch.float64) tensor(1.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1295, dtype=torch.float64) delta_t tensor(-0.2794, dtype=torch.float64)
14 gae_duplicate tensor(-0.9540, dtype=torch.float64) tensor(5.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6769, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
13 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-1.9612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2171, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
12 gae_duplicate tensor(-0.1384, dtype=torch.float64) tensor(1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3297, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
11 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-1.4449, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0518, dtype=torch.float64) delta_t tensor(0.0072, dtype=torch.float64)
10 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2652, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
9 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(0.2346, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5542, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
8 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(1.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8497, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
7 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(-2.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6314, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
6 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-3.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6320, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
5 gae_duplicate tensor(-0.1002, dtype=torch.float64) tensor(-1.2132, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0105, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
4 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(-0.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1582, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
3 gae_duplicate tensor(-0.1849, dtype=torch.float64) tensor(0.4470, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
2 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-1.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-110.32052612304688
value loss:10.165498733520508
entropies:354.2818298339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.76173210144043 seconds
19 rew tensor(1.2279, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
19 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(2.6212, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2153, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
18 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-0.2128, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1383, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
17 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(0.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1127, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
16 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(-0.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9970, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
15 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(-3.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.2841, dtype=torch.float64) delta_t tensor(-0.6277, dtype=torch.float64)
14 gae_duplicate tensor(-2.2733, dtype=torch.float64) tensor(11.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6251, dtype=torch.float64) delta_t tensor(0.1505, dtype=torch.float64)
13 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-1.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1540, dtype=torch.float64) delta_t tensor(-0.1693, dtype=torch.float64)
12 gae_duplicate tensor(-2.2385, dtype=torch.float64) tensor(2.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2436, dtype=torch.float64) delta_t tensor(-0.2266, dtype=torch.float64)
11 gae_duplicate tensor(-2.8341, dtype=torch.float64) tensor(5.7101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2717, dtype=torch.float64) delta_t tensor(0.0150, dtype=torch.float64)
10 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(0.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6511, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
9 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-2.3070, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
8 gae_duplicate tensor(-0.3829, dtype=torch.float64) tensor(0.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3816, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
7 gae_duplicate tensor(-2.2244, dtype=torch.float64) tensor(0.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9379, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
6 gae_duplicate tensor(-0.4522, dtype=torch.float64) tensor(0.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4525, dtype=torch.float64) delta_t tensor(0.4020, dtype=torch.float64)
5 gae_duplicate tensor(0.0791, dtype=torch.float64) tensor(-7.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2398, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
4 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-0.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4887, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
3 gae_duplicate tensor(-0.3063, dtype=torch.float64) tensor(-1.1756, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(0.0023, dtype=torch.float64)
2 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(-0.1541, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-499.1660461425781
value loss:47.918033599853516
entropies:354.0657958984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.696919918060303 seconds
19 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
19 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(1.3045, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1769, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
18 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-2.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0232, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(0.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0364, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
16 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-0.6133, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9082, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
15 gae_duplicate tensor(-0.2875, dtype=torch.float64) tensor(0.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7030, dtype=torch.float64) delta_t tensor(-0.0441, dtype=torch.float64)
14 gae_duplicate tensor(-0.2566, dtype=torch.float64) tensor(1.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3968, dtype=torch.float64) delta_t tensor(-0.0874, dtype=torch.float64)
13 gae_duplicate tensor(-1.2263, dtype=torch.float64) tensor(1.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
12 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-0.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2924, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
11 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(-0.8896, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0617, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
10 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(-0.4598, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1770, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
9 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-0.5222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4764, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
8 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(0.7685, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8501, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
7 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-1.7082, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6947, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
6 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(-1.1158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5292, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
5 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-1.0791, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0147, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
4 gae_duplicate tensor(-0.1794, dtype=torch.float64) tensor(-0.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0554, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
3 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(0.4817, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3315, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
2 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(-1.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:141.3232421875
value loss:6.566789150238037
entropies:353.83905029296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.905135869979858 seconds
19 rew tensor(1.1898, dtype=torch.float64) delta_t tensor(-0.1281, dtype=torch.float64)
19 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(2.4889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1771, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
18 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(-0.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1388, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
17 gae_duplicate tensor(-0.0374, dtype=torch.float64) tensor(-0.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0235, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
16 gae_duplicate tensor(-0.1182, dtype=torch.float64) tensor(1.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9341, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
15 gae_duplicate tensor(-0.2140, dtype=torch.float64) tensor(0.8103, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(0.3645, dtype=torch.float64)
14 gae_duplicate tensor(0.1556, dtype=torch.float64) tensor(-6.8023, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
13 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-5.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5177, dtype=torch.float64) delta_t tensor(-0.6980, dtype=torch.float64)
12 gae_duplicate tensor(-3.2901, dtype=torch.float64) tensor(12.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1264, dtype=torch.float64) delta_t tensor(-0.1733, dtype=torch.float64)
11 gae_duplicate tensor(-1.5345, dtype=torch.float64) tensor(4.4532, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
10 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(-2.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5116, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
9 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-3.6186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6836, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
8 gae_duplicate tensor(-0.4143, dtype=torch.float64) tensor(0.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3142, dtype=torch.float64) delta_t tensor(-0.2406, dtype=torch.float64)
7 gae_duplicate tensor(-2.2046, dtype=torch.float64) tensor(4.6552, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8768, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
6 gae_duplicate tensor(-0.3431, dtype=torch.float64) tensor(-0.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4498, dtype=torch.float64) delta_t tensor(0.2529, dtype=torch.float64)
5 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-5.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1126, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
4 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(0.1993, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3240, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
3 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(0.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4330, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
2 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(0.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-265.5883483886719
value loss:38.31439208984375
entropies:353.54998779296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3937.3901)
ToM Target loss= tensor(3981.3381)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.751344203948975 seconds
19 rew tensor(1.2021, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
19 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(1.5610, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2150, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
18 gae_duplicate tensor(0.0101, dtype=torch.float64) tensor(-1.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1254, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
17 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(-0.7751, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1129, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
16 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(-1.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6004, dtype=torch.float64) delta_t tensor(-0.3133, dtype=torch.float64)
15 gae_duplicate tensor(-1.5016, dtype=torch.float64) tensor(6.0351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0286, dtype=torch.float64) delta_t tensor(-0.4979, dtype=torch.float64)
14 gae_duplicate tensor(-2.3709, dtype=torch.float64) tensor(9.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3411, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
13 gae_duplicate tensor(-0.9195, dtype=torch.float64) tensor(1.7050, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
12 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-3.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
11 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-1.8907, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
10 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-2.6976, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3716, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
9 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(-0.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
8 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(1.1316, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9375, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
7 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6061, dtype=torch.float64) delta_t tensor(0.2205, dtype=torch.float64)
6 gae_duplicate tensor(0.1026, dtype=torch.float64) tensor(-4.3517, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6555, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
5 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(-2.4984, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0872, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
4 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(2.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2337, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
3 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-0.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
2 gae_duplicate tensor(-0.3448, dtype=torch.float64) tensor(3.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-402.853759765625
value loss:20.72027015686035
entropies:353.3680114746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.713299036026001 seconds
19 rew tensor(1.0992, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
19 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(1.5707, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0733, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
18 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0342, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
17 gae_duplicate tensor(-0.1917, dtype=torch.float64) tensor(0.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0480, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
16 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(0.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
15 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-1.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3484, dtype=torch.float64) delta_t tensor(-0.3809, dtype=torch.float64)
14 gae_duplicate tensor(-2.6788, dtype=torch.float64) tensor(7.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3594, dtype=torch.float64) delta_t tensor(-0.1486, dtype=torch.float64)
13 gae_duplicate tensor(-1.3284, dtype=torch.float64) tensor(3.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
12 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-2.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3585, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
11 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-2.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1747, dtype=torch.float64) delta_t tensor(-0.0241, dtype=torch.float64)
10 gae_duplicate tensor(-0.2417, dtype=torch.float64) tensor(0.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1271, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
9 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(-0.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3874, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
8 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(0.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2175, dtype=torch.float64) delta_t tensor(-0.7203, dtype=torch.float64)
7 gae_duplicate tensor(-4.8381, dtype=torch.float64) tensor(13.3104, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6685, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
6 gae_duplicate tensor(-0.6119, dtype=torch.float64) tensor(-3.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6050, dtype=torch.float64) delta_t tensor(0.2793, dtype=torch.float64)
5 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-5.6516, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3423, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
4 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.9227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5388, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
3 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-1.2776, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7141, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
2 gae_duplicate tensor(-0.0035, dtype=torch.float64) tensor(-3.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-395.90191650390625
value loss:54.74789810180664
entropies:353.198974609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.746983051300049 seconds
19 rew tensor(1.2401, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
19 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-0.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1890, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
18 gae_duplicate tensor(0.0318, dtype=torch.float64) tensor(-3.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0863, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
17 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-1.1712, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
16 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(-0.7391, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9839, dtype=torch.float64) delta_t tensor(0.2745, dtype=torch.float64)
15 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-5.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
14 gae_duplicate tensor(-1.4293, dtype=torch.float64) tensor(1.7728, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7013, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
13 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-4.9090, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(0.1829, dtype=torch.float64)
12 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-4.2364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7013, dtype=torch.float64) delta_t tensor(0.2324, dtype=torch.float64)
11 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-4.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2828, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
10 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(0.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
9 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(-0.9544, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8079, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
8 gae_duplicate tensor(-0.4070, dtype=torch.float64) tensor(1.8210, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5005, dtype=torch.float64) delta_t tensor(-0.3136, dtype=torch.float64)
7 gae_duplicate tensor(-2.1433, dtype=torch.float64) tensor(5.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8985, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
6 gae_duplicate tensor(-0.3843, dtype=torch.float64) tensor(-1.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4261, dtype=torch.float64) delta_t tensor(0.2545, dtype=torch.float64)
5 gae_duplicate tensor(0.0301, dtype=torch.float64) tensor(-5.1823, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1400, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
4 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-2.3525, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3375, dtype=torch.float64) delta_t tensor(-0.1551, dtype=torch.float64)
3 gae_duplicate tensor(-0.3164, dtype=torch.float64) tensor(2.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4603, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
2 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(-1.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1209.3182373046875
value loss:21.341379165649414
entropies:353.17840576171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.660598993301392 seconds
19 rew tensor(1.1760, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
19 gae_duplicate tensor(-0.1348, dtype=torch.float64) tensor(-1.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1248, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
18 gae_duplicate tensor(-0.0789, dtype=torch.float64) tensor(-3.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0482, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
17 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-2.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(-0.1868, dtype=torch.float64)
16 gae_duplicate tensor(-1.4066, dtype=torch.float64) tensor(3.9272, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.2890, dtype=torch.float64)
15 gae_duplicate tensor(0.0698, dtype=torch.float64) tensor(-5.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8692, dtype=torch.float64) delta_t tensor(0.1313, dtype=torch.float64)
14 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-3.0425, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4869, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
13 gae_duplicate tensor(-1.2580, dtype=torch.float64) tensor(0.3748, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4333, dtype=torch.float64) delta_t tensor(0.2088, dtype=torch.float64)
12 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-4.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0154, dtype=torch.float64) delta_t tensor(-0.2564, dtype=torch.float64)
11 gae_duplicate tensor(-2.0225, dtype=torch.float64) tensor(4.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6286, dtype=torch.float64) delta_t tensor(-0.5044, dtype=torch.float64)
10 gae_duplicate tensor(-3.8901, dtype=torch.float64) tensor(9.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2850, dtype=torch.float64) delta_t tensor(-0.4179, dtype=torch.float64)
9 gae_duplicate tensor(-3.2580, dtype=torch.float64) tensor(8.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7823, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
8 gae_duplicate tensor(-0.8547, dtype=torch.float64) tensor(3.1516, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6854, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
7 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-2.0731, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7316, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
6 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-2.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4785, dtype=torch.float64) delta_t tensor(-0.0417, dtype=torch.float64)
5 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(0.4863, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0904, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
4 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(-0.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0828, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
3 gae_duplicate tensor(-0.3915, dtype=torch.float64) tensor(1.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
2 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(-0.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-404.4671325683594
value loss:60.23114013671875
entropies:353.26568603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7106239795684814 seconds
19 rew tensor(1.2402, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
19 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-0.2326, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1632, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
18 gae_duplicate tensor(0.0305, dtype=torch.float64) tensor(-2.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9835, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
17 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(0.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0100, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
16 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8427, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
15 gae_duplicate tensor(-0.0312, dtype=torch.float64) tensor(-5.2173, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1801, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
14 gae_duplicate tensor(-1.4047, dtype=torch.float64) tensor(2.7462, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
13 gae_duplicate tensor(-0.8478, dtype=torch.float64) tensor(0.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3316, dtype=torch.float64) delta_t tensor(0.1328, dtype=torch.float64)
12 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(-2.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
11 gae_duplicate tensor(0.0818, dtype=torch.float64) tensor(-3.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
10 gae_duplicate tensor(-0.2245, dtype=torch.float64) tensor(0.9098, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3437, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
9 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(0.1306, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5138, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
8 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-0.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5633, dtype=torch.float64) delta_t tensor(-0.0241, dtype=torch.float64)
7 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(0.4856, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7203, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
6 gae_duplicate tensor(-0.2807, dtype=torch.float64) tensor(-2.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4215, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
5 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-0.7356, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1705, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
4 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(0.7825, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8443, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
3 gae_duplicate tensor(-0.3204, dtype=torch.float64) tensor(-0.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1498, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
2 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(1.3211, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:486.3258056640625
value loss:10.254423141479492
entropies:353.47589111328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3936.4062)
ToM Target loss= tensor(3987.1675)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.6811089515686035 seconds
19 rew tensor(1.1633, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
19 gae_duplicate tensor(-0.0921, dtype=torch.float64) tensor(0.4479, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1374, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
18 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-1.8396, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0859, dtype=torch.float64) delta_t tensor(0.0589, dtype=torch.float64)
17 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-1.3077, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0098, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
16 gae_duplicate tensor(0.0045, dtype=torch.float64) tensor(-0.8322, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9326, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
15 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-0.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1675, dtype=torch.float64) delta_t tensor(-0.1685, dtype=torch.float64)
14 gae_duplicate tensor(-2.2752, dtype=torch.float64) tensor(3.9354, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.1936, dtype=torch.float64)
13 gae_duplicate tensor(0.0411, dtype=torch.float64) tensor(-3.3762, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2286, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
12 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-1.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5614, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
11 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(-1.3436, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1045, dtype=torch.float64) delta_t tensor(0.0222, dtype=torch.float64)
10 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(-0.5095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
9 gae_duplicate tensor(-0.2352, dtype=torch.float64) tensor(-0.0179, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5265, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
8 gae_duplicate tensor(-0.3067, dtype=torch.float64) tensor(1.1783, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4856, dtype=torch.float64) delta_t tensor(-0.3265, dtype=torch.float64)
7 gae_duplicate tensor(-2.2428, dtype=torch.float64) tensor(7.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6677, dtype=torch.float64) delta_t tensor(0.0033, dtype=torch.float64)
6 gae_duplicate tensor(-0.2763, dtype=torch.float64) tensor(0.6635, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6037, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
5 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-1.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
4 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(0.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3350, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
3 gae_duplicate tensor(-0.3385, dtype=torch.float64) tensor(1.8136, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(-0.0080, dtype=torch.float64)
2 gae_duplicate tensor(-0.2744, dtype=torch.float64) tensor(0.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-296.4176940917969
value loss:20.066308975219727
entropies:353.7959899902344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.538235902786255 seconds
19 rew tensor(1.1887, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
19 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(1.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1885, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
18 gae_duplicate tensor(0.0149, dtype=torch.float64) tensor(-2.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8454, dtype=torch.float64) delta_t tensor(-0.2192, dtype=torch.float64)
17 gae_duplicate tensor(-1.3349, dtype=torch.float64) tensor(3.9049, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0741, dtype=torch.float64) delta_t tensor(0.0861, dtype=torch.float64)
16 gae_duplicate tensor(-0.1246, dtype=torch.float64) tensor(-1.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.2766, dtype=torch.float64)
15 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-5.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3788, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
14 gae_duplicate tensor(-1.3262, dtype=torch.float64) tensor(-1.8494, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3913, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
13 gae_duplicate tensor(-1.2013, dtype=torch.float64) tensor(1.5693, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(0.1746, dtype=torch.float64)
12 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(-3.3751, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5623, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
11 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(-2.8201, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0542, dtype=torch.float64) delta_t tensor(-0.0386, dtype=torch.float64)
10 gae_duplicate tensor(-0.1771, dtype=torch.float64) tensor(0.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3840, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
9 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(-1.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4896, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
8 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(-0.3314, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6846, dtype=torch.float64) delta_t tensor(-0.8428, dtype=torch.float64)
7 gae_duplicate tensor(-4.8942, dtype=torch.float64) tensor(15.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9359, dtype=torch.float64) delta_t tensor(0.0770, dtype=torch.float64)
6 gae_duplicate tensor(-0.9258, dtype=torch.float64) tensor(0.0336, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3233, dtype=torch.float64) delta_t tensor(0.1756, dtype=torch.float64)
5 gae_duplicate tensor(-0.1949, dtype=torch.float64) tensor(-3.3425, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0117, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
4 gae_duplicate tensor(-0.2198, dtype=torch.float64) tensor(-0.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0301, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
3 gae_duplicate tensor(-0.4032, dtype=torch.float64) tensor(-0.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2430, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
2 gae_duplicate tensor(-0.4773, dtype=torch.float64) tensor(0.5780, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-120.50958251953125
value loss:53.64357376098633
entropies:353.93768310546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.889204978942871 seconds
19 rew tensor(1.1380, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
19 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(1.7835, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1636, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
18 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-2.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1000, dtype=torch.float64) delta_t tensor(0.0597, dtype=torch.float64)
17 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-1.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9469, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
16 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-0.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9334, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
15 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(-1.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1982, dtype=torch.float64) delta_t tensor(-0.2943, dtype=torch.float64)
14 gae_duplicate tensor(-1.2547, dtype=torch.float64) tensor(5.6695, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1147, dtype=torch.float64) delta_t tensor(-0.5855, dtype=torch.float64)
13 gae_duplicate tensor(-4.2457, dtype=torch.float64) tensor(11.5396, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3066, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
12 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(0.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4591, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
11 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-2.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0376, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-2.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
9 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(0.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5394, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
8 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(-0.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7973, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
7 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(1.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6421, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
6 gae_duplicate tensor(-0.0304, dtype=torch.float64) tensor(-1.0237, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5773, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
5 gae_duplicate tensor(0.0491, dtype=torch.float64) tensor(-2.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0374, dtype=torch.float64) delta_t tensor(-0.0091, dtype=torch.float64)
4 gae_duplicate tensor(-0.0931, dtype=torch.float64) tensor(-0.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1307, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
3 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-0.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3573, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
2 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(1.9182, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-648.8792724609375
value loss:33.692813873291016
entropies:354.1253356933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.692438840866089 seconds
19 rew tensor(1.1877, dtype=torch.float64) delta_t tensor(-0.0628, dtype=torch.float64)
19 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(1.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1882, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
18 gae_duplicate tensor(-0.0264, dtype=torch.float64) tensor(-1.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1115, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
17 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(-0.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0732, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
16 gae_duplicate tensor(-0.0679, dtype=torch.float64) tensor(-0.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9589, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
15 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(-2.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8046, dtype=torch.float64) delta_t tensor(0.2434, dtype=torch.float64)
14 gae_duplicate tensor(-0.0234, dtype=torch.float64) tensor(-5.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1269, dtype=torch.float64) delta_t tensor(-0.3741, dtype=torch.float64)
13 gae_duplicate tensor(-2.4507, dtype=torch.float64) tensor(6.4750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1143, dtype=torch.float64) delta_t tensor(-0.0780, dtype=torch.float64)
12 gae_duplicate tensor(-0.8959, dtype=torch.float64) tensor(2.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9231, dtype=torch.float64) delta_t tensor(-1.1971, dtype=torch.float64)
11 gae_duplicate tensor(-7.5871, dtype=torch.float64) tensor(23.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0014, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
10 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-2.0823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4461, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
9 gae_duplicate tensor(0.0423, dtype=torch.float64) tensor(-2.5502, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6945, dtype=torch.float64) delta_t tensor(-0.0103, dtype=torch.float64)
8 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-0.1255, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2183, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
7 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-1.7238, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9999, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
6 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(-1.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0921, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
5 gae_duplicate tensor(-0.2047, dtype=torch.float64) tensor(0.1156, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3992, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
4 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(1.5517, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5414, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
3 gae_duplicate tensor(-0.3103, dtype=torch.float64) tensor(-0.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0409, dtype=torch.float64) delta_t tensor(-0.0880, dtype=torch.float64)
2 gae_duplicate tensor(-0.3110, dtype=torch.float64) tensor(1.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1130.708984375
value loss:101.66029357910156
entropies:354.39794921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.834017992019653 seconds
19 rew tensor(1.2005, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
19 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(0.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2136, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
18 gae_duplicate tensor(-0.0067, dtype=torch.float64) tensor(-2.4681, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0732, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
17 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-0.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0222, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
16 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-1.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5599, dtype=torch.float64) delta_t tensor(-0.1798, dtype=torch.float64)
15 gae_duplicate tensor(-1.2396, dtype=torch.float64) tensor(3.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7280, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
14 gae_duplicate tensor(-0.0762, dtype=torch.float64) tensor(-1.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1842, dtype=torch.float64) delta_t tensor(-0.5908, dtype=torch.float64)
13 gae_duplicate tensor(-2.1564, dtype=torch.float64) tensor(11.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4329, dtype=torch.float64) delta_t tensor(0.1671, dtype=torch.float64)
12 gae_duplicate tensor(-0.0575, dtype=torch.float64) tensor(-2.2802, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3065, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
11 gae_duplicate tensor(0.0264, dtype=torch.float64) tensor(-1.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1761, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
10 gae_duplicate tensor(-0.1949, dtype=torch.float64) tensor(-1.7108, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2694, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
9 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-2.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6301, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
8 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(0.5201, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8982, dtype=torch.float64) delta_t tensor(-0.2267, dtype=torch.float64)
7 gae_duplicate tensor(-0.9053, dtype=torch.float64) tensor(4.8408, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7460, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
6 gae_duplicate tensor(-0.2877, dtype=torch.float64) tensor(-0.1210, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4206, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
5 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(-1.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0151, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
4 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-1.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0003, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
3 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(1.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3303, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
2 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(-0.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-366.5589294433594
value loss:16.261070251464844
entropies:354.66229248046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3944.8848)
ToM Target loss= tensor(3993.9756)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.613113164901733 seconds
19 rew tensor(1.1747, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
19 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(1.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1749, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
18 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-1.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1107, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
17 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-0.6791, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9702, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
16 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(0.9372, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
15 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(-2.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4562, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
14 gae_duplicate tensor(-0.7544, dtype=torch.float64) tensor(-2.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2812, dtype=torch.float64) delta_t tensor(-0.2741, dtype=torch.float64)
13 gae_duplicate tensor(-2.4344, dtype=torch.float64) tensor(4.8362, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0387, dtype=torch.float64) delta_t tensor(-0.1144, dtype=torch.float64)
12 gae_duplicate tensor(-0.8846, dtype=torch.float64) tensor(3.0604, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.2120, dtype=torch.float64)
11 gae_duplicate tensor(0.1098, dtype=torch.float64) tensor(-3.8173, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1169, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
10 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-1.4770, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4206, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
9 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(0.4966, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6790, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.5368, dtype=torch.float64) tensor(-0.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0712, dtype=torch.float64) delta_t tensor(-0.3782, dtype=torch.float64)
7 gae_duplicate tensor(-2.0620, dtype=torch.float64) tensor(7.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7943, dtype=torch.float64) delta_t tensor(-0.0184, dtype=torch.float64)
6 gae_duplicate tensor(-0.4318, dtype=torch.float64) tensor(1.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3710, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
5 gae_duplicate tensor(-0.3620, dtype=torch.float64) tensor(-2.5074, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0099, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
4 gae_duplicate tensor(-0.2087, dtype=torch.float64) tensor(0.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0495, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
3 gae_duplicate tensor(-0.3185, dtype=torch.float64) tensor(0.5978, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3810, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
2 gae_duplicate tensor(-0.2822, dtype=torch.float64) tensor(-1.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-324.1405944824219
value loss:23.80696678161621
entropies:354.927001953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.678359031677246 seconds
19 rew tensor(1.1112, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
19 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(1.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1500, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
18 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(-1.2311, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0601, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
17 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(0.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
16 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(0.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9711, dtype=torch.float64) delta_t tensor(0.1874, dtype=torch.float64)
15 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(-3.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5873, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
14 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-2.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7532, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
13 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-2.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2166, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
12 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-1.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2264, dtype=torch.float64) delta_t tensor(-0.6215, dtype=torch.float64)
11 gae_duplicate tensor(-4.1893, dtype=torch.float64) tensor(12.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5950, dtype=torch.float64) delta_t tensor(-0.3723, dtype=torch.float64)
10 gae_duplicate tensor(-2.2936, dtype=torch.float64) tensor(8.4247, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4582, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
9 gae_duplicate tensor(-0.3575, dtype=torch.float64) tensor(0.7970, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8210, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
8 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-0.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
7 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(1.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9107, dtype=torch.float64) delta_t tensor(0.0506, dtype=torch.float64)
6 gae_duplicate tensor(-0.0862, dtype=torch.float64) tensor(-0.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0394, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
5 gae_duplicate tensor(-0.2873, dtype=torch.float64) tensor(0.7642, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5270, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
4 gae_duplicate tensor(-0.0775, dtype=torch.float64) tensor(-0.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3104, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
3 gae_duplicate tensor(-0.2956, dtype=torch.float64) tensor(1.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1560, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
2 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-0.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-852.3551025390625
value loss:38.30945587158203
entropies:355.14361572265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.681167840957642 seconds
19 rew tensor(1.1627, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
19 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(1.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1368, dtype=torch.float64) delta_t tensor(0.0878, dtype=torch.float64)
18 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-1.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9704, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
17 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(0.4643, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9330, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
16 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(1.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
15 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-1.4260, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.1834, dtype=torch.float64)
14 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(-3.6944, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6375, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
13 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-3.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3580, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
12 gae_duplicate tensor(-0.2035, dtype=torch.float64) tensor(0.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3799, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
11 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(0.0789, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
10 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(0.0017, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2655, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
9 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(-1.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5000, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
8 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(1.6207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8108, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
7 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-0.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5899, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
6 gae_duplicate tensor(-0.0324, dtype=torch.float64) tensor(-1.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6030, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
5 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-0.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0121, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
4 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.7132, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0666, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
3 gae_duplicate tensor(-0.2734, dtype=torch.float64) tensor(0.4972, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
2 gae_duplicate tensor(-0.1637, dtype=torch.float64) tensor(0.2524, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:286.2008056640625
value loss:3.716496229171753
entropies:355.23834228515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.732284307479858 seconds
19 rew tensor(1.1108, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
19 gae_duplicate tensor(-0.2153, dtype=torch.float64) tensor(2.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1110, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
18 gae_duplicate tensor(-0.0882, dtype=torch.float64) tensor(0.1205, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0471, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
17 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(0.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9706, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
16 gae_duplicate tensor(-0.2285, dtype=torch.float64) tensor(-0.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8812, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
15 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(-1.0404, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5741, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
14 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-1.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(0.1773, dtype=torch.float64)
13 gae_duplicate tensor(0.0083, dtype=torch.float64) tensor(-3.6531, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
12 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(0.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5991, dtype=torch.float64) delta_t tensor(0.1657, dtype=torch.float64)
11 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-3.3155, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2064, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
10 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5481, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
9 gae_duplicate tensor(-0.2622, dtype=torch.float64) tensor(-0.5837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6420, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
8 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(0.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3979, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
7 gae_duplicate tensor(-0.2078, dtype=torch.float64) tensor(-0.4595, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
6 gae_duplicate tensor(-0.0475, dtype=torch.float64) tensor(-4.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1676, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
5 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-1.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2453, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
4 gae_duplicate tensor(-0.0988, dtype=torch.float64) tensor(-0.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5150, dtype=torch.float64) delta_t tensor(0.1437, dtype=torch.float64)
3 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-2.8293, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0013, dtype=torch.float64) delta_t tensor(-0.1465, dtype=torch.float64)
2 gae_duplicate tensor(-0.6840, dtype=torch.float64) tensor(2.5965, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:659.5082397460938
value loss:6.854999542236328
entropies:355.30352783203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.92483115196228 seconds
19 rew tensor(1.1240, dtype=torch.float64) delta_t tensor(-0.1066, dtype=torch.float64)
19 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(2.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0856, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
18 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.0171, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0093, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
17 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(1.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9325, dtype=torch.float64) delta_t tensor(-0.1232, dtype=torch.float64)
16 gae_duplicate tensor(-0.2624, dtype=torch.float64) tensor(2.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
15 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(-1.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6767, dtype=torch.float64) delta_t tensor(0.1296, dtype=torch.float64)
14 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-2.7397, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6379, dtype=torch.float64) delta_t tensor(0.1741, dtype=torch.float64)
13 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-3.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3959, dtype=torch.float64) delta_t tensor(0.0761, dtype=torch.float64)
12 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(-1.8352, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1478, dtype=torch.float64) delta_t tensor(-0.5326, dtype=torch.float64)
11 gae_duplicate tensor(-3.1838, dtype=torch.float64) tensor(10.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1168, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
10 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(-2.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
9 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-2.9974, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6927, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
8 gae_duplicate tensor(-0.1000, dtype=torch.float64) tensor(0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4507, dtype=torch.float64) delta_t tensor(0.0887, dtype=torch.float64)
7 gae_duplicate tensor(-0.0533, dtype=torch.float64) tensor(-1.6665, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7570, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
6 gae_duplicate tensor(0.0025, dtype=torch.float64) tensor(-3.5358, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4243, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
5 gae_duplicate tensor(-0.3945, dtype=torch.float64) tensor(0.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1691, dtype=torch.float64) delta_t tensor(-0.0448, dtype=torch.float64)
4 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(0.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8731, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
3 gae_duplicate tensor(-0.3215, dtype=torch.float64) tensor(2.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1892, dtype=torch.float64) delta_t tensor(-0.0841, dtype=torch.float64)
2 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(1.8876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-192.0697021484375
value loss:22.315223693847656
entropies:355.32611083984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.7969)
ToM Target loss= tensor(3997.7878)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.759366989135742 seconds
19 rew tensor(1.1879, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
19 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(2.8457, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1501, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
18 gae_duplicate tensor(-0.0160, dtype=torch.float64) tensor(-0.4020, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0221, dtype=torch.float64) delta_t tensor(-0.1039, dtype=torch.float64)
17 gae_duplicate tensor(-0.1984, dtype=torch.float64) tensor(2.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9329, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
16 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(1.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9329, dtype=torch.float64) delta_t tensor(0.2065, dtype=torch.float64)
15 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-3.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3422, dtype=torch.float64) delta_t tensor(0.1024, dtype=torch.float64)
14 gae_duplicate tensor(-0.7575, dtype=torch.float64) tensor(-2.3577, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4085, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
13 gae_duplicate tensor(-1.0477, dtype=torch.float64) tensor(-1.0127, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
12 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-0.7068, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5360, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
11 gae_duplicate tensor(0.0673, dtype=torch.float64) tensor(-3.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2834, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
10 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-0.3902, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4589, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
9 gae_duplicate tensor(-0.2480, dtype=torch.float64) tensor(-0.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6170, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
8 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8452, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
7 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(-2.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7194, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
6 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-1.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6269, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
5 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-2.5188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0357, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
4 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-0.3386, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2560, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
3 gae_duplicate tensor(-0.2381, dtype=torch.float64) tensor(-0.5958, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(-0.0622, dtype=torch.float64)
2 gae_duplicate tensor(-0.2608, dtype=torch.float64) tensor(1.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:646.0560302734375
value loss:9.68094253540039
entropies:355.3772888183594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.813844203948975 seconds
19 rew tensor(1.1371, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
19 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(1.2824, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1370, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
18 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0346, dtype=torch.float64) delta_t tensor(-0.0179, dtype=torch.float64)
17 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(0.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9841, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
16 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-0.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8041, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
15 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-0.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
14 gae_duplicate tensor(-0.1979, dtype=torch.float64) tensor(1.3376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6501, dtype=torch.float64) delta_t tensor(0.1526, dtype=torch.float64)
13 gae_duplicate tensor(0.0087, dtype=torch.float64) tensor(-2.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4089, dtype=torch.float64) delta_t tensor(-0.0735, dtype=torch.float64)
12 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(1.1499, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2152, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
11 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(-0.2518, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1398, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
10 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-0.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0997, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
9 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-0.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3723, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
8 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(1.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1685, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
7 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(-0.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4624, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
6 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(-2.5696, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7826, dtype=torch.float64) delta_t tensor(-0.0500, dtype=torch.float64)
5 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(0.7494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1651, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
4 gae_duplicate tensor(-0.1022, dtype=torch.float64) tensor(-0.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2709, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
3 gae_duplicate tensor(-0.2102, dtype=torch.float64) tensor(0.5034, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
2 gae_duplicate tensor(-0.2705, dtype=torch.float64) tensor(-0.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:153.90415954589844
value loss:3.0056498050689697
entropies:355.3527526855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801699161529541 seconds
19 rew tensor(1.1635, dtype=torch.float64) delta_t tensor(-0.1185, dtype=torch.float64)
19 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(2.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1382, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
18 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(-0.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0350, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
17 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(0.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0101, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
16 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(0.8651, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9075, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
15 gae_duplicate tensor(-0.2903, dtype=torch.float64) tensor(0.0642, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1616, dtype=torch.float64) delta_t tensor(-0.3354, dtype=torch.float64)
14 gae_duplicate tensor(-1.0069, dtype=torch.float64) tensor(6.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.1585, dtype=torch.float64)
13 gae_duplicate tensor(-0.0415, dtype=torch.float64) tensor(-2.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
12 gae_duplicate tensor(-0.2433, dtype=torch.float64) tensor(0.2600, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
11 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-1.5990, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2461, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
10 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(1.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4218, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
9 gae_duplicate tensor(-0.1730, dtype=torch.float64) tensor(-0.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5020, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
8 gae_duplicate tensor(-0.0087, dtype=torch.float64) tensor(-1.2971, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7061, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
7 gae_duplicate tensor(-0.0116, dtype=torch.float64) tensor(-3.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7207, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
6 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(-0.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4224, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
5 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(-1.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0408, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
4 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(0.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9629, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
3 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(0.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3175, dtype=torch.float64) delta_t tensor(-0.0329, dtype=torch.float64)
2 gae_duplicate tensor(-0.1899, dtype=torch.float64) tensor(0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-291.76153564453125
value loss:6.613719940185547
entropies:355.3397521972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.549423933029175 seconds
19 rew tensor(1.1881, dtype=torch.float64) delta_t tensor(-0.0852, dtype=torch.float64)
19 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(1.6540, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1880, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
18 gae_duplicate tensor(-0.0224, dtype=torch.float64) tensor(-1.4880, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8179, dtype=torch.float64) delta_t tensor(-0.2515, dtype=torch.float64)
17 gae_duplicate tensor(-1.4178, dtype=torch.float64) tensor(4.7037, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0346, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(1.0773, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
15 gae_duplicate tensor(-0.2621, dtype=torch.float64) tensor(-1.2464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
14 gae_duplicate tensor(-2.4503, dtype=torch.float64) tensor(6.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
13 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-0.8586, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1396, dtype=torch.float64) delta_t tensor(-0.3115, dtype=torch.float64)
12 gae_duplicate tensor(-2.0551, dtype=torch.float64) tensor(5.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2273, dtype=torch.float64) delta_t tensor(-0.5505, dtype=torch.float64)
11 gae_duplicate tensor(-4.2366, dtype=torch.float64) tensor(12.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(0.1737, dtype=torch.float64)
10 gae_duplicate tensor(0.0354, dtype=torch.float64) tensor(-2.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4065, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
9 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(-1.1738, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6411, dtype=torch.float64) delta_t tensor(-0.0934, dtype=torch.float64)
8 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(1.6618, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6321, dtype=torch.float64) delta_t tensor(0.1689, dtype=torch.float64)
7 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-3.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8074, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
6 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(0.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3998, dtype=torch.float64) delta_t tensor(0.1346, dtype=torch.float64)
5 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-2.6366, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0115, dtype=torch.float64) delta_t tensor(-0.0071, dtype=torch.float64)
4 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-0.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0792, dtype=torch.float64) delta_t tensor(-0.0588, dtype=torch.float64)
3 gae_duplicate tensor(-0.2657, dtype=torch.float64) tensor(1.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3574, dtype=torch.float64) delta_t tensor(0.0304, dtype=torch.float64)
2 gae_duplicate tensor(-0.3167, dtype=torch.float64) tensor(-0.5445, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1256.252197265625
value loss:50.90129470825195
entropies:355.28045654296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.74347710609436 seconds
19 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
19 gae_duplicate tensor(-0.0989, dtype=torch.float64) tensor(0.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1117, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
18 gae_duplicate tensor(-0.0506, dtype=torch.float64) tensor(-1.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0727, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
17 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-0.9512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9706, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
16 gae_duplicate tensor(-0.1661, dtype=torch.float64) tensor(0.9542, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8686, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
15 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(0.6462, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8046, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
14 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-2.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
13 gae_duplicate tensor(0.0731, dtype=torch.float64) tensor(-3.2929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4197, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
12 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-0.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
11 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(0.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0033, dtype=torch.float64) delta_t tensor(-0.0359, dtype=torch.float64)
10 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(0.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1404, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
9 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-0.9334, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4249, dtype=torch.float64) delta_t tensor(-0.1520, dtype=torch.float64)
8 gae_duplicate tensor(-0.3860, dtype=torch.float64) tensor(2.8416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3060, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
7 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-4.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5403, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
6 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-2.2006, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7808, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
5 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(-1.1266, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3427, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
4 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(-1.4488, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5378, dtype=torch.float64) delta_t tensor(-0.1443, dtype=torch.float64)
3 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(2.6447, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
2 gae_duplicate tensor(-0.2497, dtype=torch.float64) tensor(-1.2326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:499.45135498046875
value loss:5.1449456214904785
entropies:355.1451721191406
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3939.5933)
ToM Target loss= tensor(3991.2573)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.779443025588989 seconds
19 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
19 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(1.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1631, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
18 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(-2.0919, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0348, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
17 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-0.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
16 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(1.7550, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(0.1759, dtype=torch.float64)
15 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-3.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6767, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
14 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(-2.7012, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6761, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
13 gae_duplicate tensor(-0.2324, dtype=torch.float64) tensor(-0.5938, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3961, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
12 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(-0.7242, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4837, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
11 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-0.9564, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1786, dtype=torch.float64) delta_t tensor(0.2063, dtype=torch.float64)
10 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-4.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1521, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
9 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-0.8497, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5786, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
8 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-1.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2236, dtype=torch.float64) delta_t tensor(-0.3613, dtype=torch.float64)
7 gae_duplicate tensor(-2.1706, dtype=torch.float64) tensor(7.3871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7592, dtype=torch.float64) delta_t tensor(0.0285, dtype=torch.float64)
6 gae_duplicate tensor(-0.4479, dtype=torch.float64) tensor(0.2555, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4227, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
5 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(-0.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0631, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
4 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(-1.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0931, dtype=torch.float64) delta_t tensor(-0.1832, dtype=torch.float64)
3 gae_duplicate tensor(-0.4276, dtype=torch.float64) tensor(3.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4343, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
2 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(-1.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:303.70843505859375
value loss:13.506250381469727
entropies:355.04437255859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8291778564453125 seconds
19 rew tensor(1.1375, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
19 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(1.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1376, dtype=torch.float64) delta_t tensor(0.0979, dtype=torch.float64)
18 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-1.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0740, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
17 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(-1.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9078, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
16 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(0.9566, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
15 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-2.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1598, dtype=torch.float64) delta_t tensor(-0.3288, dtype=torch.float64)
14 gae_duplicate tensor(-2.3564, dtype=torch.float64) tensor(5.9656, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.1978, dtype=torch.float64)
13 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-3.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4220, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
12 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-2.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4834, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
11 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-1.9744, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0504, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
10 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(0.0175, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
9 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(0.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
8 gae_duplicate tensor(-0.4396, dtype=torch.float64) tensor(1.4533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5426, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
7 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(0.4191, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6679, dtype=torch.float64) delta_t tensor(0.1258, dtype=torch.float64)
6 gae_duplicate tensor(-0.0017, dtype=torch.float64) tensor(-2.5085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4241, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
5 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(-0.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0388, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
4 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-0.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9397, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
3 gae_duplicate tensor(-0.2319, dtype=torch.float64) tensor(1.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3453, dtype=torch.float64) delta_t tensor(0.1367, dtype=torch.float64)
2 gae_duplicate tensor(-0.2090, dtype=torch.float64) tensor(-2.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:314.89923095703125
value loss:12.988640785217285
entropies:354.86090087890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.689119100570679 seconds
19 rew tensor(1.1624, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
19 gae_duplicate tensor(-0.1161, dtype=torch.float64) tensor(1.4527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2012, dtype=torch.float64) delta_t tensor(0.1014, dtype=torch.float64)
18 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-1.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0605, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
17 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(0.0739, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0221, dtype=torch.float64) delta_t tensor(-0.0228, dtype=torch.float64)
16 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(0.4437, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9965, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
15 gae_duplicate tensor(-0.1169, dtype=torch.float64) tensor(-1.4963, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2816, dtype=torch.float64) delta_t tensor(-0.2575, dtype=torch.float64)
14 gae_duplicate tensor(-2.3602, dtype=torch.float64) tensor(4.7648, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0050, dtype=torch.float64) delta_t tensor(-0.4440, dtype=torch.float64)
13 gae_duplicate tensor(-3.8911, dtype=torch.float64) tensor(8.8761, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0982, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
12 gae_duplicate tensor(-0.9968, dtype=torch.float64) tensor(2.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0022, dtype=torch.float64) delta_t tensor(-0.3087, dtype=torch.float64)
11 gae_duplicate tensor(-2.9165, dtype=torch.float64) tensor(6.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1929, dtype=torch.float64) delta_t tensor(-0.0038, dtype=torch.float64)
10 gae_duplicate tensor(-1.1066, dtype=torch.float64) tensor(0.9362, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4603, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
9 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-2.1528, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7966, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
8 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(-0.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7279, dtype=torch.float64) delta_t tensor(-0.3819, dtype=torch.float64)
7 gae_duplicate tensor(-1.9705, dtype=torch.float64) tensor(7.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9244, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
6 gae_duplicate tensor(-0.4463, dtype=torch.float64) tensor(0.0872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2432, dtype=torch.float64) delta_t tensor(0.0882, dtype=torch.float64)
5 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(-1.7538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2206, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
4 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-0.9775, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8205, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
3 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(1.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1251, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
2 gae_duplicate tensor(-0.3019, dtype=torch.float64) tensor(-0.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1388.536865234375
value loss:57.55447006225586
entropies:354.6918640136719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.656522035598755 seconds
19 rew tensor(1.1376, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
19 gae_duplicate tensor(-0.0611, dtype=torch.float64) tensor(0.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0995, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
18 gae_duplicate tensor(-0.0242, dtype=torch.float64) tensor(-1.0295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0865, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
17 gae_duplicate tensor(-0.0014, dtype=torch.float64) tensor(-1.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9963, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-0.2513, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(-0.0609, dtype=torch.float64)
15 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(1.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4690, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
14 gae_duplicate tensor(-0.9990, dtype=torch.float64) tensor(1.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6253, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
13 gae_duplicate tensor(-0.0112, dtype=torch.float64) tensor(-2.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
12 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4342, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
11 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(0.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1688, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
10 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(1.2993, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
9 gae_duplicate tensor(-0.1381, dtype=torch.float64) tensor(0.3606, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3994, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
8 gae_duplicate tensor(-0.2814, dtype=torch.float64) tensor(0.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1160, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
7 gae_duplicate tensor(-0.1551, dtype=torch.float64) tensor(-2.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5021, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
6 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-2.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7299, dtype=torch.float64) delta_t tensor(-0.0860, dtype=torch.float64)
5 gae_duplicate tensor(-0.2399, dtype=torch.float64) tensor(1.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1905, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
4 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2966, dtype=torch.float64) delta_t tensor(-0.1291, dtype=torch.float64)
3 gae_duplicate tensor(-0.2184, dtype=torch.float64) tensor(2.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(-0.0347, dtype=torch.float64)
2 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(0.9485, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-169.1065673828125
value loss:4.805942535400391
entropies:354.5998840332031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754361867904663 seconds
19 rew tensor(1.1367, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
19 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(0.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
18 gae_duplicate tensor(0.0328, dtype=torch.float64) tensor(-2.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8054, dtype=torch.float64) delta_t tensor(-0.2153, dtype=torch.float64)
17 gae_duplicate tensor(-1.4501, dtype=torch.float64) tensor(3.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9198, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
16 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(-0.4735, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9324, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
15 gae_duplicate tensor(-0.0682, dtype=torch.float64) tensor(-4.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
14 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-2.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6770, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
13 gae_duplicate tensor(0.0856, dtype=torch.float64) tensor(-3.0698, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
12 gae_duplicate tensor(-0.2267, dtype=torch.float64) tensor(0.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6378, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
11 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(-3.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1682, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
10 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(0.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4589, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
9 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(-1.2519, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6292, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
8 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-0.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3726, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
7 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-0.5579, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7060, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
6 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(-0.8814, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3463, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
5 gae_duplicate tensor(-0.2579, dtype=torch.float64) tensor(0.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1693, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
4 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(0.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7437, dtype=torch.float64) delta_t tensor(-0.0723, dtype=torch.float64)
3 gae_duplicate tensor(-0.2321, dtype=torch.float64) tensor(1.4269, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
2 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-0.4963, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:528.969482421875
value loss:7.336944580078125
entropies:354.52423095703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.0767)
ToM Target loss= tensor(3988.5229)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.608840227127075 seconds
19 rew tensor(1.1627, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
19 gae_duplicate tensor(-0.0884, dtype=torch.float64) tensor(0.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1118, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
18 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(-1.7009, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0482, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
17 gae_duplicate tensor(-0.0842, dtype=torch.float64) tensor(-1.2563, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9969, dtype=torch.float64) delta_t tensor(0.1296, dtype=torch.float64)
16 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-2.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9460, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
15 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-1.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7026, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
14 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-3.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6389, dtype=torch.float64) delta_t tensor(0.1273, dtype=torch.float64)
13 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-2.9203, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(0.0821, dtype=torch.float64)
12 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-1.9676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2802, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
11 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(0.1905, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0243, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
10 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(-0.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3183, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
9 gae_duplicate tensor(-0.1156, dtype=torch.float64) tensor(-0.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4762, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
8 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(0.7569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6717, dtype=torch.float64) delta_t tensor(-0.6503, dtype=torch.float64)
7 gae_duplicate tensor(-3.6662, dtype=torch.float64) tensor(12.5367, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6566, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
6 gae_duplicate tensor(-0.6563, dtype=torch.float64) tensor(0.3102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6277, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
5 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(1.1796, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0879, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
4 gae_duplicate tensor(-0.2339, dtype=torch.float64) tensor(0.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2202, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
3 gae_duplicate tensor(-0.3686, dtype=torch.float64) tensor(3.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
2 gae_duplicate tensor(-0.1362, dtype=torch.float64) tensor(0.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-265.3522033691406
value loss:25.269763946533203
entropies:354.5610046386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.703498125076294 seconds
19 rew tensor(1.1240, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
19 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(0.8261, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0988, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
18 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-1.1388, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0607, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
17 gae_duplicate tensor(-0.0212, dtype=torch.float64) tensor(-1.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9714, dtype=torch.float64) delta_t tensor(0.0367, dtype=torch.float64)
16 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(-0.7512, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9455, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
15 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-1.2411, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3940, dtype=torch.float64) delta_t tensor(-0.2334, dtype=torch.float64)
14 gae_duplicate tensor(-0.9674, dtype=torch.float64) tensor(4.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
13 gae_duplicate tensor(-1.0600, dtype=torch.float64) tensor(0.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2552, dtype=torch.float64) delta_t tensor(-0.0489, dtype=torch.float64)
12 gae_duplicate tensor(-0.2858, dtype=torch.float64) tensor(1.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5607, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
11 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(-1.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0533, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
10 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(-0.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4975, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
9 gae_duplicate tensor(-0.0738, dtype=torch.float64) tensor(-3.7851, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5654, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
8 gae_duplicate tensor(-0.2671, dtype=torch.float64) tensor(-0.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4273, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
7 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-2.0694, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8719, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
6 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-0.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0929, dtype=torch.float64) delta_t tensor(0.0426, dtype=torch.float64)
5 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(-0.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2177, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
4 gae_duplicate tensor(-0.1378, dtype=torch.float64) tensor(0.9621, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5441, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
3 gae_duplicate tensor(-0.3882, dtype=torch.float64) tensor(-0.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1026, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
2 gae_duplicate tensor(-0.6285, dtype=torch.float64) tensor(-0.2096, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:225.54617309570312
value loss:9.314606666564941
entropies:354.65899658203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.788416147232056 seconds
19 rew tensor(1.0860, dtype=torch.float64) delta_t tensor(-0.1194, dtype=torch.float64)
19 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(2.3334, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1246, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
18 gae_duplicate tensor(0.0023, dtype=torch.float64) tensor(-1.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1120, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
17 gae_duplicate tensor(0.0087, dtype=torch.float64) tensor(-1.4463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0224, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
16 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-0.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9453, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
15 gae_duplicate tensor(-0.0890, dtype=torch.float64) tensor(0.3505, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7789, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
14 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-0.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1633, dtype=torch.float64) delta_t tensor(-0.3065, dtype=torch.float64)
13 gae_duplicate tensor(-1.2530, dtype=torch.float64) tensor(5.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3566, dtype=torch.float64) delta_t tensor(-0.6511, dtype=torch.float64)
12 gae_duplicate tensor(-3.8340, dtype=torch.float64) tensor(13.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0879, dtype=torch.float64) delta_t tensor(-0.2428, dtype=torch.float64)
11 gae_duplicate tensor(-1.6393, dtype=torch.float64) tensor(5.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
10 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-1.0297, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
9 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(-0.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4757, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
8 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.1829, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7198, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
7 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(0.6717, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5911, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
6 gae_duplicate tensor(0.0235, dtype=torch.float64) tensor(-1.3802, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6292, dtype=torch.float64) delta_t tensor(-0.1153, dtype=torch.float64)
5 gae_duplicate tensor(-0.2330, dtype=torch.float64) tensor(2.2306, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0921, dtype=torch.float64) delta_t tensor(-0.0878, dtype=torch.float64)
4 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(1.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9760, dtype=torch.float64) delta_t tensor(-0.0413, dtype=torch.float64)
3 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(1.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(0.1209, dtype=torch.float64)
2 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-2.2873, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1443.49365234375
value loss:32.62697982788086
entropies:354.6902160644531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.896509170532227 seconds
19 rew tensor(1.2144, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
19 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(0.4943, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1250, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
18 gae_duplicate tensor(-0.0445, dtype=torch.float64) tensor(-1.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0354, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
17 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.7407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0100, dtype=torch.float64) delta_t tensor(-0.0599, dtype=torch.float64)
16 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(1.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9716, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
15 gae_duplicate tensor(-0.2663, dtype=torch.float64) tensor(0.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7925, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
14 gae_duplicate tensor(-0.2369, dtype=torch.float64) tensor(-3.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0575, dtype=torch.float64) delta_t tensor(-0.2947, dtype=torch.float64)
13 gae_duplicate tensor(-2.4372, dtype=torch.float64) tensor(6.1081, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1115, dtype=torch.float64) delta_t tensor(-0.0466, dtype=torch.float64)
12 gae_duplicate tensor(-0.9128, dtype=torch.float64) tensor(1.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3815, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
11 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-1.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0121, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
10 gae_duplicate tensor(-0.3791, dtype=torch.float64) tensor(-1.6905, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3685, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
9 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-3.1637, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5266, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
8 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-0.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7330, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
7 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-1.9360, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7446, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
6 gae_duplicate tensor(-0.2320, dtype=torch.float64) tensor(-1.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4757, dtype=torch.float64) delta_t tensor(-0.0200, dtype=torch.float64)
5 gae_duplicate tensor(-0.3624, dtype=torch.float64) tensor(0.2706, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0663, dtype=torch.float64) delta_t tensor(-0.0514, dtype=torch.float64)
4 gae_duplicate tensor(-0.1626, dtype=torch.float64) tensor(0.9754, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0274, dtype=torch.float64) delta_t tensor(-0.0107, dtype=torch.float64)
3 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(0.3090, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2665, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
2 gae_duplicate tensor(-0.2364, dtype=torch.float64) tensor(1.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-44.75096893310547
value loss:16.22581672668457
entropies:354.8124084472656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.866896867752075 seconds
19 rew tensor(1.1376, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
19 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(1.1743, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1380, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
18 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-1.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9973, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
17 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(-0.0294, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
16 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8566, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
15 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-1.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6503, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
14 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(0.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(-0.1584, dtype=torch.float64)
13 gae_duplicate tensor(-1.1070, dtype=torch.float64) tensor(3.0406, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
12 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(0.8994, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1634, dtype=torch.float64) delta_t tensor(-0.1502, dtype=torch.float64)
11 gae_duplicate tensor(-1.1225, dtype=torch.float64) tensor(2.9137, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0493, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
10 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-1.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(0.1322, dtype=torch.float64)
9 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-2.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6309, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
8 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(0.8662, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3325, dtype=torch.float64) delta_t tensor(-0.0341, dtype=torch.float64)
7 gae_duplicate tensor(-0.2165, dtype=torch.float64) tensor(0.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6820, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
6 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-1.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3458, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
5 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(2.0022, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2214, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
4 gae_duplicate tensor(0.0132, dtype=torch.float64) tensor(-0.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6669, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
3 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(-0.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1372, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
2 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-1.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-140.25515747070312
value loss:6.554500102996826
entropies:354.8741149902344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3947.1289)
ToM Target loss= tensor(3983.7891)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.620270252227783 seconds
19 rew tensor(1.1504, dtype=torch.float64) delta_t tensor(-0.0662, dtype=torch.float64)
19 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(1.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1119, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
18 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-0.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9841, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
17 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(0.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9327, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
16 gae_duplicate tensor(-0.1587, dtype=torch.float64) tensor(0.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8688, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
15 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(0.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
14 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(-0.9797, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7410, dtype=torch.float64) delta_t tensor(0.2032, dtype=torch.float64)
13 gae_duplicate tensor(0.0244, dtype=torch.float64) tensor(-4.0207, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2407, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
12 gae_duplicate tensor(-0.2681, dtype=torch.float64) tensor(1.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4595, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
11 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(-0.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0106, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
10 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-1.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
9 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(-0.4608, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6421, dtype=torch.float64) delta_t tensor(-0.0736, dtype=torch.float64)
8 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(1.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1436, dtype=torch.float64) delta_t tensor(-0.3194, dtype=torch.float64)
7 gae_duplicate tensor(-2.1623, dtype=torch.float64) tensor(6.2690, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8477, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
6 gae_duplicate tensor(-0.5601, dtype=torch.float64) tensor(1.1217, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3994, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
5 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(-1.5544, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0370, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
4 gae_duplicate tensor(0.0123, dtype=torch.float64) tensor(-2.3241, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1573, dtype=torch.float64) delta_t tensor(-0.0309, dtype=torch.float64)
3 gae_duplicate tensor(-0.5308, dtype=torch.float64) tensor(0.2759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3829, dtype=torch.float64) delta_t tensor(0.1414, dtype=torch.float64)
2 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-2.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-45.70663070678711
value loss:11.720839500427246
entropies:354.9778137207031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.871937036514282 seconds
19 rew tensor(1.0990, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
19 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(2.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1631, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
18 gae_duplicate tensor(-0.0218, dtype=torch.float64) tensor(-1.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0480, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
17 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(0.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(-0.0518, dtype=torch.float64)
16 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(1.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9590, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
15 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-2.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7287, dtype=torch.float64) delta_t tensor(0.0539, dtype=torch.float64)
14 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-1.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0336, dtype=torch.float64) delta_t tensor(-0.3884, dtype=torch.float64)
13 gae_duplicate tensor(-2.5369, dtype=torch.float64) tensor(7.3226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1598, dtype=torch.float64) delta_t tensor(-0.4455, dtype=torch.float64)
12 gae_duplicate tensor(-2.8015, dtype=torch.float64) tensor(9.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2803, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
11 gae_duplicate tensor(-0.2756, dtype=torch.float64) tensor(-0.2507, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1635, dtype=torch.float64) delta_t tensor(0.1877, dtype=torch.float64)
10 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(-3.6552, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
9 gae_duplicate tensor(-0.0767, dtype=torch.float64) tensor(-2.4121, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6556, dtype=torch.float64) delta_t tensor(-0.1026, dtype=torch.float64)
8 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(1.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6798, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
7 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-1.3790, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7070, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
6 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-1.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5009, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
5 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(0.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0418, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
4 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(-1.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0139, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
3 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-1.6766, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3168, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
2 gae_duplicate tensor(-0.0083, dtype=torch.float64) tensor(-3.9500, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-233.21078491210938
value loss:25.174711227416992
entropies:355.1373596191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.761850833892822 seconds
19 rew tensor(1.1503, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
19 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(1.0162, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1376, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
18 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-1.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0355, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
17 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-0.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0360, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
16 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-0.4667, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8946, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
15 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(-0.4801, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4224, dtype=torch.float64) delta_t tensor(-0.2279, dtype=torch.float64)
14 gae_duplicate tensor(-1.4574, dtype=torch.float64) tensor(4.3212, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.1772, dtype=torch.float64)
13 gae_duplicate tensor(-0.0374, dtype=torch.float64) tensor(-2.9892, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
12 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-0.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3689, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
11 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-2.4188, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0110, dtype=torch.float64) delta_t tensor(-0.0168, dtype=torch.float64)
10 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(0.1023, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2916, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
9 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-1.1773, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(-0.0966, dtype=torch.float64)
8 gae_duplicate tensor(-0.3967, dtype=torch.float64) tensor(1.7868, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4652, dtype=torch.float64) delta_t tensor(0.0911, dtype=torch.float64)
7 gae_duplicate tensor(-0.0651, dtype=torch.float64) tensor(-1.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7843, dtype=torch.float64) delta_t tensor(0.1797, dtype=torch.float64)
6 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-3.6289, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2704, dtype=torch.float64) delta_t tensor(-0.0678, dtype=torch.float64)
5 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(0.9967, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1937, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
4 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-2.2051, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6566, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
3 gae_duplicate tensor(-0.3675, dtype=torch.float64) tensor(0.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0747, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
2 gae_duplicate tensor(-0.4649, dtype=torch.float64) tensor(-0.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:395.4026794433594
value loss:8.211348533630371
entropies:355.343994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.852167844772339 seconds
19 rew tensor(1.1368, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
19 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(1.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1112, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
18 gae_duplicate tensor(-0.0565, dtype=torch.float64) tensor(-0.2663, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0730, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
17 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(0.0860, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8316, dtype=torch.float64) delta_t tensor(-0.2487, dtype=torch.float64)
16 gae_duplicate tensor(-1.4298, dtype=torch.float64) tensor(5.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9321, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
15 gae_duplicate tensor(-0.3147, dtype=torch.float64) tensor(1.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8555, dtype=torch.float64) delta_t tensor(0.1554, dtype=torch.float64)
14 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-2.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4339, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
13 gae_duplicate tensor(-0.5927, dtype=torch.float64) tensor(-0.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
12 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(-1.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3692, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
11 gae_duplicate tensor(-0.2273, dtype=torch.float64) tensor(1.2328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0610, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
10 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-2.6142, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
9 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-2.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3988, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
8 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(0.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1716, dtype=torch.float64) delta_t tensor(-0.8606, dtype=torch.float64)
7 gae_duplicate tensor(-4.8794, dtype=torch.float64) tensor(16.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8716, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
6 gae_duplicate tensor(-0.6992, dtype=torch.float64) tensor(1.4553, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3497, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
5 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(-4.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1135, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
4 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-1.1583, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1438, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
3 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(-1.6486, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3957, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
2 gae_duplicate tensor(-0.4345, dtype=torch.float64) tensor(0.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-740.4939575195312
value loss:46.773258209228516
entropies:355.45501708984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777740001678467 seconds
19 rew tensor(1.1751, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
19 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(1.2284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1498, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
18 gae_duplicate tensor(-0.0611, dtype=torch.float64) tensor(-1.3893, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9964, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
17 gae_duplicate tensor(-0.0994, dtype=torch.float64) tensor(0.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(-0.0755, dtype=torch.float64)
16 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(1.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8304, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
15 gae_duplicate tensor(-0.3398, dtype=torch.float64) tensor(0.8924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4723, dtype=torch.float64) delta_t tensor(-0.1576, dtype=torch.float64)
14 gae_duplicate tensor(-0.9940, dtype=torch.float64) tensor(3.3613, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6387, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
13 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-1.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(-0.0836, dtype=torch.float64)
12 gae_duplicate tensor(-0.2654, dtype=torch.float64) tensor(1.5348, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4341, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
11 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(-0.5138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0790, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
10 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-0.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
9 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(-1.7813, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5530, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
8 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(0.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8962, dtype=torch.float64) delta_t tensor(0.1328, dtype=torch.float64)
7 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-2.5172, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6426, dtype=torch.float64) delta_t tensor(-0.0419, dtype=torch.float64)
6 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(0.6090, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6019, dtype=torch.float64) delta_t tensor(0.0246, dtype=torch.float64)
5 gae_duplicate tensor(-0.1585, dtype=torch.float64) tensor(-0.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0861, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
4 gae_duplicate tensor(-0.1243, dtype=torch.float64) tensor(-0.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2042, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
3 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-0.3161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4320, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
2 gae_duplicate tensor(-0.1394, dtype=torch.float64) tensor(-0.9751, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-113.7269287109375
value loss:4.778078556060791
entropies:355.5517883300781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3966.4092)
ToM Target loss= tensor(3976.9841)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.620794773101807 seconds
19 rew tensor(1.1752, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
19 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(2.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1625, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
18 gae_duplicate tensor(-0.0552, dtype=torch.float64) tensor(0.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1628, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
17 gae_duplicate tensor(-0.0424, dtype=torch.float64) tensor(-0.7984, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0733, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
16 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-0.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9967, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
15 gae_duplicate tensor(-0.3527, dtype=torch.float64) tensor(-0.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3222, dtype=torch.float64) delta_t tensor(-0.2300, dtype=torch.float64)
14 gae_duplicate tensor(-2.1900, dtype=torch.float64) tensor(4.8052, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
13 gae_duplicate tensor(-1.0885, dtype=torch.float64) tensor(1.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3696, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
12 gae_duplicate tensor(-0.2580, dtype=torch.float64) tensor(-1.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0483, dtype=torch.float64) delta_t tensor(-0.3395, dtype=torch.float64)
11 gae_duplicate tensor(-2.2216, dtype=torch.float64) tensor(6.8398, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1165, dtype=torch.float64) delta_t tensor(-0.8052, dtype=torch.float64)
10 gae_duplicate tensor(-5.2478, dtype=torch.float64) tensor(16.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
9 gae_duplicate tensor(-0.6862, dtype=torch.float64) tensor(0.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5403, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
8 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(-0.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3624, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
7 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(-1.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8091, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
6 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-1.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2973, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
5 gae_duplicate tensor(-0.2266, dtype=torch.float64) tensor(-0.1350, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2195, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
4 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7729, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
3 gae_duplicate tensor(-0.1597, dtype=torch.float64) tensor(0.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
2 gae_duplicate tensor(-0.2277, dtype=torch.float64) tensor(1.7845, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1675.0413818359375
value loss:63.53807830810547
entropies:355.5873107910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.756890058517456 seconds
19 rew tensor(1.0986, dtype=torch.float64) delta_t tensor(-0.1176, dtype=torch.float64)
19 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(2.3536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1498, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
18 gae_duplicate tensor(0.0041, dtype=torch.float64) tensor(-1.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0604, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
17 gae_duplicate tensor(-0.0544, dtype=torch.float64) tensor(-0.7360, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8810, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
16 gae_duplicate tensor(-0.1737, dtype=torch.float64) tensor(1.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8556, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
15 gae_duplicate tensor(-0.2250, dtype=torch.float64) tensor(0.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3587, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
14 gae_duplicate tensor(-1.2416, dtype=torch.float64) tensor(3.4700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.1956, dtype=torch.float64)
13 gae_duplicate tensor(0.0227, dtype=torch.float64) tensor(-3.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3310, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
12 gae_duplicate tensor(-0.2821, dtype=torch.float64) tensor(0.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4200, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
11 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(-0.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0652, dtype=torch.float64) delta_t tensor(-0.0381, dtype=torch.float64)
10 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(0.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2400, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
9 gae_duplicate tensor(-0.2265, dtype=torch.float64) tensor(0.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5136, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
8 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(0.3490, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5792, dtype=torch.float64) delta_t tensor(-0.0490, dtype=torch.float64)
7 gae_duplicate tensor(-0.2514, dtype=torch.float64) tensor(0.9651, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6034, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
6 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-1.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5012, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
5 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(-0.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0918, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
4 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-0.8091, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8991, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
3 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-0.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2667, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
2 gae_duplicate tensor(-0.2609, dtype=torch.float64) tensor(-0.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-181.5472869873047
value loss:5.339149475097656
entropies:355.5888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.533355951309204 seconds
19 rew tensor(1.1880, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
19 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(0.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0985, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
18 gae_duplicate tensor(-0.0376, dtype=torch.float64) tensor(-0.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0727, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
17 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(-1.0883, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
16 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-0.1983, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
15 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(0.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7532, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
14 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(-1.0607, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4988, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
13 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-0.9494, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
12 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(0.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1269, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
11 gae_duplicate tensor(-0.2170, dtype=torch.float64) tensor(-0.1651, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2533, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
10 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(-1.0405, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0782, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
9 gae_duplicate tensor(-0.1552, dtype=torch.float64) tensor(0.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3483, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
8 gae_duplicate tensor(-0.3267, dtype=torch.float64) tensor(1.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3570, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
7 gae_duplicate tensor(-0.1346, dtype=torch.float64) tensor(-1.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4764, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
6 gae_duplicate tensor(0.0951, dtype=torch.float64) tensor(-5.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9348, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
5 gae_duplicate tensor(-0.2690, dtype=torch.float64) tensor(0.1816, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2397, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
4 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(-1.9454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5118, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
3 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-1.2111, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5853, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
2 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(-1.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:574.0401000976562
value loss:4.004772663116455
entropies:355.5930480957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.86580491065979 seconds
19 rew tensor(1.1109, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
19 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(2.5035, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1367, dtype=torch.float64) delta_t tensor(0.0598, dtype=torch.float64)
18 gae_duplicate tensor(0.0107, dtype=torch.float64) tensor(-0.9536, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0472, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(0.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7550, dtype=torch.float64) delta_t tensor(-0.2747, dtype=torch.float64)
16 gae_duplicate tensor(-1.3229, dtype=torch.float64) tensor(5.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(-0.2404, dtype=torch.float64)
15 gae_duplicate tensor(-1.1005, dtype=torch.float64) tensor(5.2431, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8564, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
14 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(-1.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2242, dtype=torch.float64) delta_t tensor(-0.2457, dtype=torch.float64)
13 gae_duplicate tensor(-2.0991, dtype=torch.float64) tensor(4.6691, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4590, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
12 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(-1.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3946, dtype=torch.float64) delta_t tensor(0.0281, dtype=torch.float64)
11 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-0.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0623, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
10 gae_duplicate tensor(-0.1359, dtype=torch.float64) tensor(-3.0821, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3567, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
9 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(-0.9946, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5391, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
8 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-0.9986, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1981, dtype=torch.float64) delta_t tensor(-1.1321, dtype=torch.float64)
7 gae_duplicate tensor(-6.2646, dtype=torch.float64) tensor(21.9121, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0137, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
6 gae_duplicate tensor(-1.0327, dtype=torch.float64) tensor(1.7498, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2195, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
5 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-5.0307, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
4 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(-0.3215, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9902, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
3 gae_duplicate tensor(-0.2907, dtype=torch.float64) tensor(-1.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
2 gae_duplicate tensor(-0.6197, dtype=torch.float64) tensor(0.1173, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1540.6832275390625
value loss:79.11923217773438
entropies:355.60089111328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.807047128677368 seconds
19 rew tensor(1.1623, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
19 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(0.9175, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1496, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
18 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-2.0642, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1113, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
17 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-1.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
16 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(0.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9708, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
15 gae_duplicate tensor(-0.0862, dtype=torch.float64) tensor(-2.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2029, dtype=torch.float64) delta_t tensor(-0.2061, dtype=torch.float64)
14 gae_duplicate tensor(-2.1102, dtype=torch.float64) tensor(3.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6894, dtype=torch.float64) delta_t tensor(0.1874, dtype=torch.float64)
13 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(-3.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2921, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
12 gae_duplicate tensor(-0.2403, dtype=torch.float64) tensor(-0.4726, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4979, dtype=torch.float64) delta_t tensor(0.0934, dtype=torch.float64)
11 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(-1.9477, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1303, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
10 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-0.9869, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3448, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
9 gae_duplicate tensor(-0.1485, dtype=torch.float64) tensor(-2.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6042, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
8 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(-0.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4489, dtype=torch.float64) delta_t tensor(-0.2341, dtype=torch.float64)
7 gae_duplicate tensor(-0.6874, dtype=torch.float64) tensor(4.5446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7325, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
6 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-0.2062, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6779, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
5 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(-1.6953, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0875, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
4 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(0.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3597, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
3 gae_duplicate tensor(-0.3730, dtype=torch.float64) tensor(0.4669, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4329, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
2 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-1.1460, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:326.8427429199219
value loss:13.996589660644531
entropies:355.6602478027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3965.4307)
ToM Target loss= tensor(3977.5786)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.731312990188599 seconds
19 rew tensor(1.1748, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
19 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(1.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1878, dtype=torch.float64) delta_t tensor(0.1118, dtype=torch.float64)
18 gae_duplicate tensor(-0.0045, dtype=torch.float64) tensor(-2.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0216, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
17 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-0.1492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0086, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
16 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(0.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8938, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
15 gae_duplicate tensor(-0.1576, dtype=torch.float64) tensor(-0.8793, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0759, dtype=torch.float64) delta_t tensor(-0.2106, dtype=torch.float64)
14 gae_duplicate tensor(-2.1728, dtype=torch.float64) tensor(3.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(0.1140, dtype=torch.float64)
13 gae_duplicate tensor(-0.0334, dtype=torch.float64) tensor(-1.8268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2680, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
12 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-0.5395, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.0470, dtype=torch.float64)
11 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-1.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0004, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
10 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-2.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3288, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
9 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(-0.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6024, dtype=torch.float64) delta_t tensor(-0.1636, dtype=torch.float64)
8 gae_duplicate tensor(-0.2830, dtype=torch.float64) tensor(3.1871, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7958, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
7 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(0.4586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6923, dtype=torch.float64) delta_t tensor(0.0486, dtype=torch.float64)
6 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-0.9602, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5255, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
5 gae_duplicate tensor(-0.1509, dtype=torch.float64) tensor(-1.9146, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0619, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
4 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-1.2325, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1414, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
3 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(0.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4073, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
2 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(-0.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:190.8237762451172
value loss:10.967195510864258
entropies:355.7268981933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7694408893585205 seconds
19 rew tensor(1.1364, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
19 gae_duplicate tensor(-0.1138, dtype=torch.float64) tensor(0.9382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1109, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
18 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-1.0180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0855, dtype=torch.float64) delta_t tensor(0.0328, dtype=torch.float64)
17 gae_duplicate tensor(-0.0092, dtype=torch.float64) tensor(-0.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0346, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
16 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(0.5960, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9452, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
15 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(0.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5500, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
14 gae_duplicate tensor(-0.9013, dtype=torch.float64) tensor(0.7130, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3795, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
13 gae_duplicate tensor(-1.3291, dtype=torch.float64) tensor(2.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
12 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-1.2268, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3944, dtype=torch.float64) delta_t tensor(0.0108, dtype=torch.float64)
11 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-0.3546, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0397, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
10 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-1.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
9 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(1.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5009, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
8 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(0.7119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4565, dtype=torch.float64) delta_t tensor(-0.1801, dtype=torch.float64)
7 gae_duplicate tensor(-2.0372, dtype=torch.float64) tensor(3.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6291, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
6 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(-1.3263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6003, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
5 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-2.2972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1628, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
4 gae_duplicate tensor(-0.1935, dtype=torch.float64) tensor(-0.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2667, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
3 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(0.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5211, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
2 gae_duplicate tensor(-0.1844, dtype=torch.float64) tensor(-0.8275, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-160.43698120117188
value loss:14.878626823425293
entropies:355.7995300292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.694952964782715 seconds
19 rew tensor(1.1876, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
19 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(0.5150, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1620, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
18 gae_duplicate tensor(0.0355, dtype=torch.float64) tensor(-1.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0726, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
17 gae_duplicate tensor(-0.1255, dtype=torch.float64) tensor(-0.2801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9705, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
16 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-0.5569, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
15 gae_duplicate tensor(-0.0922, dtype=torch.float64) tensor(-3.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4970, dtype=torch.float64) delta_t tensor(0.1992, dtype=torch.float64)
14 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-4.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(0.1854, dtype=torch.float64)
13 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-4.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0236, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
12 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(0.5649, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7274, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
11 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-3.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1938, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
10 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-0.7194, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
9 gae_duplicate tensor(-0.1580, dtype=torch.float64) tensor(-2.2645, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8077, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
8 gae_duplicate tensor(-0.5269, dtype=torch.float64) tensor(0.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2942, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
7 gae_duplicate tensor(-0.7522, dtype=torch.float64) tensor(1.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0392, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
6 gae_duplicate tensor(0.0250, dtype=torch.float64) tensor(-3.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9092, dtype=torch.float64) delta_t tensor(0.0656, dtype=torch.float64)
5 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(-1.6565, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4002, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
4 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(-0.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4225, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
3 gae_duplicate tensor(-0.2855, dtype=torch.float64) tensor(0.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0420, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
2 gae_duplicate tensor(-0.3455, dtype=torch.float64) tensor(0.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1113.893798828125
value loss:7.42334508895874
entropies:355.8567810058594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.822005987167358 seconds
19 rew tensor(1.1875, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
19 gae_duplicate tensor(-0.1082, dtype=torch.float64) tensor(0.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1106, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
18 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-0.3168, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0465, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
17 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(-0.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8187, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
16 gae_duplicate tensor(-1.4300, dtype=torch.float64) tensor(3.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8680, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
15 gae_duplicate tensor(-0.3516, dtype=torch.float64) tensor(-0.5598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
14 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-1.9491, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2813, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
13 gae_duplicate tensor(-1.2265, dtype=torch.float64) tensor(0.5352, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
12 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-2.9521, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2677, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
11 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(-0.4045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1002, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
10 gae_duplicate tensor(-0.1989, dtype=torch.float64) tensor(-2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2674, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
9 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(-0.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3987, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
8 gae_duplicate tensor(-0.0852, dtype=torch.float64) tensor(-1.3810, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8225, dtype=torch.float64) delta_t tensor(-0.5130, dtype=torch.float64)
7 gae_duplicate tensor(-3.3127, dtype=torch.float64) tensor(9.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6817, dtype=torch.float64) delta_t tensor(0.1419, dtype=torch.float64)
6 gae_duplicate tensor(-0.5851, dtype=torch.float64) tensor(-1.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6518, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
5 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(-3.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
4 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(-0.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4116, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
3 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(0.1064, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5746, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
2 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:60.68009567260742
value loss:29.606834411621094
entropies:355.89154052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.062779903411865 seconds
19 rew tensor(1.2385, dtype=torch.float64) delta_t tensor(-0.0287, dtype=torch.float64)
19 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2005, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
18 gae_duplicate tensor(0.0320, dtype=torch.float64) tensor(-2.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1624, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
17 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-2.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
16 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.4261, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5739, dtype=torch.float64) delta_t tensor(-0.3197, dtype=torch.float64)
15 gae_duplicate tensor(-1.4821, dtype=torch.float64) tensor(6.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(-0.3557, dtype=torch.float64)
14 gae_duplicate tensor(-1.2235, dtype=torch.float64) tensor(7.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5987, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
13 gae_duplicate tensor(-0.2221, dtype=torch.float64) tensor(-0.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3951, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
12 gae_duplicate tensor(-0.2298, dtype=torch.float64) tensor(-0.5641, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3427, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
11 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-1.9799, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0888, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
10 gae_duplicate tensor(-0.0952, dtype=torch.float64) tensor(-1.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1253, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
9 gae_duplicate tensor(-0.1318, dtype=torch.float64) tensor(-1.6811, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4749, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
8 gae_duplicate tensor(-0.4128, dtype=torch.float64) tensor(2.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3826, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
7 gae_duplicate tensor(-0.7303, dtype=torch.float64) tensor(2.2471, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5902, dtype=torch.float64) delta_t tensor(0.1738, dtype=torch.float64)
6 gae_duplicate tensor(0.0086, dtype=torch.float64) tensor(-3.2086, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7039, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
5 gae_duplicate tensor(-0.0865, dtype=torch.float64) tensor(-2.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2414, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
4 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(-0.1564, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4232, dtype=torch.float64) delta_t tensor(-0.1435, dtype=torch.float64)
3 gae_duplicate tensor(-0.3128, dtype=torch.float64) tensor(2.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5740, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
2 gae_duplicate tensor(-0.3313, dtype=torch.float64) tensor(0.1517, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-412.27984619140625
value loss:13.263836860656738
entropies:355.927490234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3965.6101)
ToM Target loss= tensor(3972.7771)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.83310079574585 seconds
19 rew tensor(1.1106, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
19 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(1.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1107, dtype=torch.float64) delta_t tensor(0.0513, dtype=torch.float64)
18 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-0.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0851, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
17 gae_duplicate tensor(-0.1048, dtype=torch.float64) tensor(-1.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9956, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
16 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(0.6789, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9187, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
15 gae_duplicate tensor(-0.2074, dtype=torch.float64) tensor(0.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0115, dtype=torch.float64) delta_t tensor(-0.4847, dtype=torch.float64)
14 gae_duplicate tensor(-2.4080, dtype=torch.float64) tensor(9.6836, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5866, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
13 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-2.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
12 gae_duplicate tensor(-0.0359, dtype=torch.float64) tensor(-3.2331, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4454, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
11 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-0.9644, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0138, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
10 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-1.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3680, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
9 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(-0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4746, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
8 gae_duplicate tensor(-0.0230, dtype=torch.float64) tensor(-0.9236, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8338, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
7 gae_duplicate tensor(-0.1926, dtype=torch.float64) tensor(-1.2944, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5644, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
6 gae_duplicate tensor(-0.0404, dtype=torch.float64) tensor(-1.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6012, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
5 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-1.8993, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0365, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
4 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(1.5771, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1023, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
3 gae_duplicate tensor(-0.1509, dtype=torch.float64) tensor(-0.9102, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(-0.1819, dtype=torch.float64)
2 gae_duplicate tensor(-0.2847, dtype=torch.float64) tensor(3.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-122.83615112304688
value loss:12.963689804077148
entropies:355.9460144042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.33843207359314 seconds
19 rew tensor(1.1746, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
19 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(1.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1616, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
18 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-1.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1106, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
17 gae_duplicate tensor(-0.0416, dtype=torch.float64) tensor(-0.9993, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0083, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
16 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(0.1654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9448, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
15 gae_duplicate tensor(-0.3307, dtype=torch.float64) tensor(0.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(-0.1017, dtype=torch.float64)
14 gae_duplicate tensor(-1.0643, dtype=torch.float64) tensor(2.1169, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2322, dtype=torch.float64) delta_t tensor(-0.3850, dtype=torch.float64)
13 gae_duplicate tensor(-2.3580, dtype=torch.float64) tensor(7.8020, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0769, dtype=torch.float64) delta_t tensor(-0.2883, dtype=torch.float64)
12 gae_duplicate tensor(-1.4153, dtype=torch.float64) tensor(6.4740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
11 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(0.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1934, dtype=torch.float64) delta_t tensor(1.3804e-06, dtype=torch.float64)
10 gae_duplicate tensor(-0.2460, dtype=torch.float64) tensor(0.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
9 gae_duplicate tensor(-0.1019, dtype=torch.float64) tensor(-1.1348, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5254, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
8 gae_duplicate tensor(-0.3668, dtype=torch.float64) tensor(0.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1680, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
7 gae_duplicate tensor(-0.2467, dtype=torch.float64) tensor(0.9017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9622, dtype=torch.float64) delta_t tensor(0.1286, dtype=torch.float64)
6 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-2.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.8831, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
5 gae_duplicate tensor(-0.1275, dtype=torch.float64) tensor(-0.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4509, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
4 gae_duplicate tensor(-0.1935, dtype=torch.float64) tensor(1.5654, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.0498, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
3 gae_duplicate tensor(-0.2067, dtype=torch.float64) tensor(-2.1812, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2859, dtype=torch.float64) delta_t tensor(-0.2864, dtype=torch.float64)
2 gae_duplicate tensor(-0.5908, dtype=torch.float64) tensor(5.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1125.6337890625
value loss:17.779661178588867
entropies:355.9444580078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2303619384765625 seconds
19 rew tensor(1.2135, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
19 gae_duplicate tensor(-0.0948, dtype=torch.float64) tensor(-0.9268, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1237, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
18 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-2.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9957, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
17 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-0.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8813, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
16 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(0.6304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8425, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
15 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-0.8271, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
14 gae_duplicate tensor(-0.2700, dtype=torch.float64) tensor(-1.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6246, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
13 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(-1.3636, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2538, dtype=torch.float64) delta_t tensor(-0.0566, dtype=torch.float64)
12 gae_duplicate tensor(-0.2385, dtype=torch.float64) tensor(0.9824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
11 gae_duplicate tensor(-0.2652, dtype=torch.float64) tensor(0.7208, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0918, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
10 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(0.5284, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3694, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
9 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-0.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5905, dtype=torch.float64) delta_t tensor(-0.0879, dtype=torch.float64)
8 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(1.7215, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5801, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
7 gae_duplicate tensor(-0.2910, dtype=torch.float64) tensor(1.5393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6676, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
6 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(-1.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4490, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
5 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(-1.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0650, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
4 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-0.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9258, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
3 gae_duplicate tensor(-0.2151, dtype=torch.float64) tensor(-1.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
2 gae_duplicate tensor(-0.2362, dtype=torch.float64) tensor(0.5783, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:161.71505737304688
value loss:3.5789520740509033
entropies:355.9361877441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5656797885894775 seconds
19 rew tensor(1.1239, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
19 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(1.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1236, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
18 gae_duplicate tensor(-0.0041, dtype=torch.float64) tensor(-2.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0477, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
17 gae_duplicate tensor(-0.0319, dtype=torch.float64) tensor(-0.9328, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9315, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
16 gae_duplicate tensor(-0.1168, dtype=torch.float64) tensor(0.5031, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9710, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
15 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(-2.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7142, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
14 gae_duplicate tensor(-0.0296, dtype=torch.float64) tensor(-1.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
13 gae_duplicate tensor(-0.9951, dtype=torch.float64) tensor(1.3397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
12 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-1.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0520, dtype=torch.float64) delta_t tensor(-0.3704, dtype=torch.float64)
11 gae_duplicate tensor(-2.5112, dtype=torch.float64) tensor(7.2187, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2964, dtype=torch.float64) delta_t tensor(-0.1751, dtype=torch.float64)
10 gae_duplicate tensor(-1.1386, dtype=torch.float64) tensor(4.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4202, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
9 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6554, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
8 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(-0.3524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3333, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
7 gae_duplicate tensor(-0.0278, dtype=torch.float64) tensor(-0.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7194, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
6 gae_duplicate tensor(-0.0143, dtype=torch.float64) tensor(-3.4214, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3710, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
5 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-2.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2206, dtype=torch.float64) delta_t tensor(-0.0757, dtype=torch.float64)
4 gae_duplicate tensor(-0.3144, dtype=torch.float64) tensor(1.2987, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7439, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
3 gae_duplicate tensor(-0.3314, dtype=torch.float64) tensor(0.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1250, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
2 gae_duplicate tensor(-0.3051, dtype=torch.float64) tensor(1.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-233.02484130859375
value loss:16.310901641845703
entropies:355.9227294921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.28685188293457 seconds
19 rew tensor(1.1748, dtype=torch.float64) delta_t tensor(0.0091, dtype=torch.float64)
19 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-0.1849, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1751, dtype=torch.float64) delta_t tensor(0.1598, dtype=torch.float64)
18 gae_duplicate tensor(0.0547, dtype=torch.float64) tensor(-3.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8173, dtype=torch.float64) delta_t tensor(-0.1782, dtype=torch.float64)
17 gae_duplicate tensor(-1.3478, dtype=torch.float64) tensor(3.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9448, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
16 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(0.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
15 gae_duplicate tensor(-0.2110, dtype=torch.float64) tensor(0.3733, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4220, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
14 gae_duplicate tensor(-0.6725, dtype=torch.float64) tensor(-2.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7151, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
13 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(-3.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3182, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
12 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(-0.7182, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5474, dtype=torch.float64) delta_t tensor(0.1294, dtype=torch.float64)
11 gae_duplicate tensor(-0.0089, dtype=torch.float64) tensor(-2.6512, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0113, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
10 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(-1.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3805, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
9 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-0.2486, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6035, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
8 gae_duplicate tensor(-0.1841, dtype=torch.float64) tensor(0.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4253, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
7 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(-0.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7829, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
6 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-2.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1680, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
5 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(-1.4139, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2195, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
4 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(0.0445, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5156, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
3 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(-1.0814, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0622, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
2 gae_duplicate tensor(-0.6549, dtype=torch.float64) tensor(1.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:571.408203125
value loss:9.160103797912598
entropies:355.8865051269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3961.4087)
ToM Target loss= tensor(3971.6375)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.982341051101685 seconds
19 rew tensor(1.2135, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
19 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(0.0370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2006, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
18 gae_duplicate tensor(0.0234, dtype=torch.float64) tensor(-2.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
17 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-2.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0862, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
16 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(-1.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9970, dtype=torch.float64) delta_t tensor(0.1929, dtype=torch.float64)
15 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-3.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0740, dtype=torch.float64) delta_t tensor(-0.5900, dtype=torch.float64)
14 gae_duplicate tensor(-2.2675, dtype=torch.float64) tensor(11.2460, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(-0.0689, dtype=torch.float64)
13 gae_duplicate tensor(-1.1623, dtype=torch.float64) tensor(2.4968, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5881, dtype=torch.float64) delta_t tensor(0.3166, dtype=torch.float64)
12 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-6.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4683, dtype=torch.float64) delta_t tensor(-0.6135, dtype=torch.float64)
11 gae_duplicate tensor(-3.5161, dtype=torch.float64) tensor(11.3562, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4823, dtype=torch.float64) delta_t tensor(-0.4554, dtype=torch.float64)
10 gae_duplicate tensor(-4.1618, dtype=torch.float64) tensor(10.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1137, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
9 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-0.0758, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3990, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
8 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(-1.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3076, dtype=torch.float64) delta_t tensor(-0.0769, dtype=torch.float64)
7 gae_duplicate tensor(-0.8836, dtype=torch.float64) tensor(1.2911, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6436, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
6 gae_duplicate tensor(-0.0268, dtype=torch.float64) tensor(-2.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6260, dtype=torch.float64) delta_t tensor(0.1887, dtype=torch.float64)
5 gae_duplicate tensor(-0.0512, dtype=torch.float64) tensor(-4.0028, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1626, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
4 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-0.6105, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3839, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
3 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(1.9139, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4825, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
2 gae_duplicate tensor(-0.2661, dtype=torch.float64) tensor(0.8219, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-845.9373168945312
value loss:65.58191680908203
entropies:355.87115478515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.743201017379761 seconds
19 rew tensor(1.1740, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
19 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(-0.2192, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1356, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
18 gae_duplicate tensor(0.0660, dtype=torch.float64) tensor(-1.7965, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8310, dtype=torch.float64) delta_t tensor(-0.1494, dtype=torch.float64)
17 gae_duplicate tensor(-1.3055, dtype=torch.float64) tensor(2.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0207, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
16 gae_duplicate tensor(-0.0463, dtype=torch.float64) tensor(-0.6806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7034, dtype=torch.float64) delta_t tensor(-0.1955, dtype=torch.float64)
15 gae_duplicate tensor(-1.0548, dtype=torch.float64) tensor(3.8218, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8036, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
14 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-1.3987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0832, dtype=torch.float64) delta_t tensor(-0.3714, dtype=torch.float64)
13 gae_duplicate tensor(-2.7308, dtype=torch.float64) tensor(7.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4453, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
12 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-2.8625, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3703, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
11 gae_duplicate tensor(-0.1523, dtype=torch.float64) tensor(-2.6013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
10 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-2.8226, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1390, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
9 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(-0.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4370, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
8 gae_duplicate tensor(-0.3673, dtype=torch.float64) tensor(1.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2243, dtype=torch.float64) delta_t tensor(-0.8756, dtype=torch.float64)
7 gae_duplicate tensor(-6.2253, dtype=torch.float64) tensor(17.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7052, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
6 gae_duplicate tensor(-0.8627, dtype=torch.float64) tensor(1.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6010, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
5 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-2.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1367, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
4 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(-0.0192, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3426, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
3 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(0.6715, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.0484, dtype=torch.float64)
2 gae_duplicate tensor(-0.2637, dtype=torch.float64) tensor(-0.9123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1132.807861328125
value loss:80.64285278320312
entropies:355.8825988769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.883462905883789 seconds
19 rew tensor(1.1362, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
19 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(0.6185, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1232, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
18 gae_duplicate tensor(0.0039, dtype=torch.float64) tensor(-1.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0978, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
17 gae_duplicate tensor(0.0165, dtype=torch.float64) tensor(-2.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0212, dtype=torch.float64) delta_t tensor(0.1305, dtype=torch.float64)
16 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-2.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
15 gae_duplicate tensor(-0.0211, dtype=torch.float64) tensor(-2.8978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3144, dtype=torch.float64) delta_t tensor(-0.2328, dtype=torch.float64)
14 gae_duplicate tensor(-1.2852, dtype=torch.float64) tensor(4.2600, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
13 gae_duplicate tensor(0.1229, dtype=torch.float64) tensor(-3.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2403, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
12 gae_duplicate tensor(-0.1827, dtype=torch.float64) tensor(-0.5460, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5620, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
11 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-1.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1692, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
10 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-1.3504, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4094, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
9 gae_duplicate tensor(0.0205, dtype=torch.float64) tensor(-2.6467, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6037, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
8 gae_duplicate tensor(-0.4648, dtype=torch.float64) tensor(1.7111, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0948, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
7 gae_duplicate tensor(-0.8459, dtype=torch.float64) tensor(1.0030, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7448, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
6 gae_duplicate tensor(-0.0207, dtype=torch.float64) tensor(-1.9409, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4704, dtype=torch.float64) delta_t tensor(0.1623, dtype=torch.float64)
5 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-3.3993, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1107, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
4 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-0.8058, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1882, dtype=torch.float64) delta_t tensor(-0.0485, dtype=torch.float64)
3 gae_duplicate tensor(-0.2577, dtype=torch.float64) tensor(0.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4559, dtype=torch.float64) delta_t tensor(-0.0218, dtype=torch.float64)
2 gae_duplicate tensor(-0.2098, dtype=torch.float64) tensor(0.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:799.718505859375
value loss:8.554769515991211
entropies:355.86492919921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.472102165222168 seconds
19 rew tensor(1.2252, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
19 gae_duplicate tensor(-0.0380, dtype=torch.float64) tensor(-0.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2126, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
18 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-2.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1871, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
17 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-3.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7110, dtype=torch.float64) delta_t tensor(-0.2504, dtype=torch.float64)
16 gae_duplicate tensor(-1.4070, dtype=torch.float64) tensor(4.4962, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8797, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
15 gae_duplicate tensor(-0.0755, dtype=torch.float64) tensor(-2.0888, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4716, dtype=torch.float64) delta_t tensor(-0.0570, dtype=torch.float64)
14 gae_duplicate tensor(-0.9367, dtype=torch.float64) tensor(0.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7006, dtype=torch.float64) delta_t tensor(0.1248, dtype=torch.float64)
13 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-2.3761, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1541, dtype=torch.float64) delta_t tensor(-0.1612, dtype=torch.float64)
12 gae_duplicate tensor(-1.0327, dtype=torch.float64) tensor(2.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3264, dtype=torch.float64) delta_t tensor(-0.5052, dtype=torch.float64)
11 gae_duplicate tensor(-3.8164, dtype=torch.float64) tensor(10.1141, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1152, dtype=torch.float64) delta_t tensor(-0.0916, dtype=torch.float64)
10 gae_duplicate tensor(-1.3614, dtype=torch.float64) tensor(2.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2160, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
9 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-0.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5266, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
8 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-1.8077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4622, dtype=torch.float64) delta_t tensor(0.0337, dtype=torch.float64)
7 gae_duplicate tensor(-0.1269, dtype=torch.float64) tensor(-0.8451, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6924, dtype=torch.float64) delta_t tensor(0.1817, dtype=torch.float64)
6 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-3.6852, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3964, dtype=torch.float64) delta_t tensor(-0.0563, dtype=torch.float64)
5 gae_duplicate tensor(-0.2347, dtype=torch.float64) tensor(0.7546, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1688, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
4 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(-0.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8076, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
3 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(0.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1893, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
2 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(-0.6747, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-248.96133422851562
value loss:34.90338897705078
entropies:355.87689208984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.002164125442505 seconds
19 rew tensor(1.1745, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
19 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(0.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1359, dtype=torch.float64) delta_t tensor(0.0841, dtype=torch.float64)
18 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-1.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0588, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
17 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-1.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0460, dtype=torch.float64) delta_t tensor(0.0567, dtype=torch.float64)
16 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-1.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9182, dtype=torch.float64) delta_t tensor(0.1821, dtype=torch.float64)
15 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(-3.7272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4590, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
14 gae_duplicate tensor(-0.7557, dtype=torch.float64) tensor(-0.5848, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(0.2037, dtype=torch.float64)
13 gae_duplicate tensor(0.0594, dtype=torch.float64) tensor(-4.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.1894, dtype=torch.float64)
12 gae_duplicate tensor(-0.0080, dtype=torch.float64) tensor(-4.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(0.1648, dtype=torch.float64)
11 gae_duplicate tensor(0.0281, dtype=torch.float64) tensor(-3.6660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(0.0151, dtype=torch.float64)
10 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-0.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4446, dtype=torch.float64) delta_t tensor(0.2256, dtype=torch.float64)
9 gae_duplicate tensor(0.0097, dtype=torch.float64) tensor(-4.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4484, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
8 gae_duplicate tensor(-0.2165, dtype=torch.float64) tensor(0.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4730, dtype=torch.float64) delta_t tensor(-0.0695, dtype=torch.float64)
7 gae_duplicate tensor(-0.5332, dtype=torch.float64) tensor(1.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5894, dtype=torch.float64) delta_t tensor(0.0095, dtype=torch.float64)
6 gae_duplicate tensor(-0.3281, dtype=torch.float64) tensor(-0.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7547, dtype=torch.float64) delta_t tensor(0.1399, dtype=torch.float64)
5 gae_duplicate tensor(-0.1838, dtype=torch.float64) tensor(-2.7849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2662, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
4 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-0.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4598, dtype=torch.float64) delta_t tensor(-0.1176, dtype=torch.float64)
3 gae_duplicate tensor(-0.3292, dtype=torch.float64) tensor(2.3264, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6114, dtype=torch.float64) delta_t tensor(-0.0553, dtype=torch.float64)
2 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(1.3216, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1082.5948486328125
value loss:7.804790496826172
entropies:355.91021728515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3960.5498)
ToM Target loss= tensor(3964.5955)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.101533889770508 seconds
19 rew tensor(1.2245, dtype=torch.float64) delta_t tensor(-0.0445, dtype=torch.float64)
19 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(0.8814, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2247, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
18 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-1.9616, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1351, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
17 gae_duplicate tensor(-0.0276, dtype=torch.float64) tensor(-0.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0844, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
16 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-0.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
15 gae_duplicate tensor(-0.0530, dtype=torch.float64) tensor(-1.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6025, dtype=torch.float64) delta_t tensor(-0.1253, dtype=torch.float64)
14 gae_duplicate tensor(-1.2603, dtype=torch.float64) tensor(2.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
13 gae_duplicate tensor(-0.8690, dtype=torch.float64) tensor(0.8072, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6511, dtype=torch.float64) delta_t tensor(0.3470, dtype=torch.float64)
12 gae_duplicate tensor(-0.0014, dtype=torch.float64) tensor(-6.7855, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.4195, dtype=torch.float64) delta_t tensor(-1.5458, dtype=torch.float64)
11 gae_duplicate tensor(-5.1848, dtype=torch.float64) tensor(30.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6897, dtype=torch.float64) delta_t tensor(-0.5022, dtype=torch.float64)
10 gae_duplicate tensor(-2.7242, dtype=torch.float64) tensor(12.8635, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3155, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
9 gae_duplicate tensor(-0.2827, dtype=torch.float64) tensor(-0.1998, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6014, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
8 gae_duplicate tensor(-0.2830, dtype=torch.float64) tensor(-0.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0904, dtype=torch.float64) delta_t tensor(0.3718, dtype=torch.float64)
7 gae_duplicate tensor(-0.1151, dtype=torch.float64) tensor(-7.3658, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8828, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
6 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-1.3049, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5507, dtype=torch.float64) delta_t tensor(0.3790, dtype=torch.float64)
5 gae_duplicate tensor(0.0921, dtype=torch.float64) tensor(-7.6557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3179, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
4 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(-0.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6521, dtype=torch.float64) delta_t tensor(0.0141, dtype=torch.float64)
3 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(-0.2983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6506, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
2 gae_duplicate tensor(-0.2324, dtype=torch.float64) tensor(-2.3232, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-888.45947265625
value loss:90.18437957763672
entropies:355.92730712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.71903920173645 seconds
19 rew tensor(1.2373, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
19 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-0.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1992, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
18 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-3.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0332, dtype=torch.float64) delta_t tensor(0.0041, dtype=torch.float64)
17 gae_duplicate tensor(-0.1185, dtype=torch.float64) tensor(-0.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0328, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
16 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-0.2365, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
15 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(0.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0264, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
14 gae_duplicate tensor(-2.1546, dtype=torch.float64) tensor(6.3871, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2439, dtype=torch.float64) delta_t tensor(-0.2839, dtype=torch.float64)
13 gae_duplicate tensor(-2.0678, dtype=torch.float64) tensor(6.1840, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1895, dtype=torch.float64) delta_t tensor(0.2199, dtype=torch.float64)
12 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-3.7427, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
11 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-1.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2570, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
10 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(-1.0249, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6239, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
9 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-2.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6401, dtype=torch.float64) delta_t tensor(-0.0821, dtype=torch.float64)
8 gae_duplicate tensor(-0.5629, dtype=torch.float64) tensor(1.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0831, dtype=torch.float64) delta_t tensor(-0.4988, dtype=torch.float64)
7 gae_duplicate tensor(-3.1618, dtype=torch.float64) tensor(10.0585, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0109, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
6 gae_duplicate tensor(-0.4911, dtype=torch.float64) tensor(2.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1390, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
5 gae_duplicate tensor(0.0337, dtype=torch.float64) tensor(-2.1636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2963, dtype=torch.float64) delta_t tensor(-0.1066, dtype=torch.float64)
4 gae_duplicate tensor(-0.1444, dtype=torch.float64) tensor(1.8832, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6910, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
3 gae_duplicate tensor(-0.1495, dtype=torch.float64) tensor(0.6704, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0489, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
2 gae_duplicate tensor(-0.2569, dtype=torch.float64) tensor(0.7557, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-890.8441162109375
value loss:35.97584915161133
entropies:355.92572021484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.752090215682983 seconds
19 rew tensor(1.1223, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
19 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(0.8843, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1357, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
18 gae_duplicate tensor(-0.0009, dtype=torch.float64) tensor(-2.0192, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9696, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
17 gae_duplicate tensor(-0.0730, dtype=torch.float64) tensor(0.0970, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9050, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
16 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-0.7850, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8679, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
15 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-1.4510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4351, dtype=torch.float64) delta_t tensor(-0.2526, dtype=torch.float64)
14 gae_duplicate tensor(-1.3759, dtype=torch.float64) tensor(4.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5868, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
13 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-2.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3810, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
12 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-2.1750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3570, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
11 gae_duplicate tensor(-0.1849, dtype=torch.float64) tensor(-1.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
10 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(-1.5716, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2931, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
9 gae_duplicate tensor(-0.0223, dtype=torch.float64) tensor(-1.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5644, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
8 gae_duplicate tensor(-0.1328, dtype=torch.float64) tensor(0.6887, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3943, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
7 gae_duplicate tensor(-0.2372, dtype=torch.float64) tensor(0.7440, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7315, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
6 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-2.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2898, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
5 gae_duplicate tensor(-0.0180, dtype=torch.float64) tensor(-1.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1955, dtype=torch.float64) delta_t tensor(0.0861, dtype=torch.float64)
4 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-1.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6884, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
3 gae_duplicate tensor(-0.2865, dtype=torch.float64) tensor(-0.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1366, dtype=torch.float64) delta_t tensor(0.0506, dtype=torch.float64)
2 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-1.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:636.7025756835938
value loss:6.413482189178467
entropies:355.920166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.630828142166138 seconds
19 rew tensor(1.1484, dtype=torch.float64) delta_t tensor(-0.0556, dtype=torch.float64)
19 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(1.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1356, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
18 gae_duplicate tensor(-0.0089, dtype=torch.float64) tensor(-1.1953, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0459, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
17 gae_duplicate tensor(-0.0483, dtype=torch.float64) tensor(-0.6386, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9695, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
16 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-0.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9566, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
15 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(-0.9601, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7781, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
14 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(-0.6201, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(-0.1457, dtype=torch.float64)
13 gae_duplicate tensor(-1.0688, dtype=torch.float64) tensor(2.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3694, dtype=torch.float64) delta_t tensor(-0.6045, dtype=torch.float64)
12 gae_duplicate tensor(-3.6514, dtype=torch.float64) tensor(12.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1001, dtype=torch.float64) delta_t tensor(-0.2633, dtype=torch.float64)
11 gae_duplicate tensor(-1.4172, dtype=torch.float64) tensor(6.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
10 gae_duplicate tensor(-0.0601, dtype=torch.float64) tensor(-1.6173, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4082, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
9 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(-1.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5768, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
8 gae_duplicate tensor(-0.3160, dtype=torch.float64) tensor(-0.6745, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6780, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
7 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(-1.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7692, dtype=torch.float64) delta_t tensor(0.1085, dtype=torch.float64)
6 gae_duplicate tensor(0.0803, dtype=torch.float64) tensor(-2.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4199, dtype=torch.float64) delta_t tensor(0.1759, dtype=torch.float64)
5 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-3.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0162, dtype=torch.float64) delta_t tensor(-0.0392, dtype=torch.float64)
4 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(0.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0486, dtype=torch.float64) delta_t tensor(-0.0084, dtype=torch.float64)
3 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(0.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3416, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
2 gae_duplicate tensor(-0.3084, dtype=torch.float64) tensor(1.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-559.3171997070312
value loss:28.65279197692871
entropies:355.9090270996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.678057909011841 seconds
19 rew tensor(1.1614, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
19 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(1.1140, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1234, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
18 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-1.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0208, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
17 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(0.1545, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9320, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
16 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(1.7764, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
15 gae_duplicate tensor(-0.3239, dtype=torch.float64) tensor(-0.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3696, dtype=torch.float64) delta_t tensor(0.0503, dtype=torch.float64)
14 gae_duplicate tensor(-0.8515, dtype=torch.float64) tensor(-1.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7140, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
13 gae_duplicate tensor(0.0502, dtype=torch.float64) tensor(-1.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0878, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
12 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(0.6084, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
11 gae_duplicate tensor(0.0011, dtype=torch.float64) tensor(-0.8762, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2199, dtype=torch.float64) delta_t tensor(-0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.2620, dtype=torch.float64) tensor(-0.0679, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
9 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.2235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6018, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
8 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-1.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1157, dtype=torch.float64) delta_t tensor(0.0891, dtype=torch.float64)
7 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(-1.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9360, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
6 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(-0.9811, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0099, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
5 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-1.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3993, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
4 gae_duplicate tensor(-0.1306, dtype=torch.float64) tensor(0.0850, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3960, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
3 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(0.7090, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
2 gae_duplicate tensor(-0.2258, dtype=torch.float64) tensor(0.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:210.70474243164062
value loss:4.670036315917969
entropies:355.89947509765625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3962.8120)
ToM Target loss= tensor(3964.6421)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.740483045578003 seconds
19 rew tensor(1.1488, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
19 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(0.3220, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0846, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
18 gae_duplicate tensor(-0.0109, dtype=torch.float64) tensor(-1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9316, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
17 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(1.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9060, dtype=torch.float64) delta_t tensor(-0.0710, dtype=torch.float64)
16 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(1.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
15 gae_duplicate tensor(-0.1125, dtype=torch.float64) tensor(-0.2189, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7139, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
14 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-3.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6893, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
13 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-1.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
12 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-0.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
11 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(-1.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0023, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
10 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(0.2956, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2169, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
9 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(-1.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3992, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
8 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(0.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7026, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
7 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(-0.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5146, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
6 gae_duplicate tensor(-0.0489, dtype=torch.float64) tensor(-3.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5727, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
5 gae_duplicate tensor(-0.1448, dtype=torch.float64) tensor(1.4548, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1185, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
4 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(0.9874, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8442, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
3 gae_duplicate tensor(-0.3536, dtype=torch.float64) tensor(1.7275, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
2 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(1.0145, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:161.88946533203125
value loss:3.164581775665283
entropies:355.87506103515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.499044895172119 seconds
19 rew tensor(1.2120, dtype=torch.float64) delta_t tensor(-0.0831, dtype=torch.float64)
19 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(1.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1869, dtype=torch.float64) delta_t tensor(0.0426, dtype=torch.float64)
18 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-0.6843, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0978, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
17 gae_duplicate tensor(-0.0937, dtype=torch.float64) tensor(-0.0641, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0978, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
16 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-0.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0081, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
15 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.3974, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5615, dtype=torch.float64) delta_t tensor(0.1984, dtype=torch.float64)
14 gae_duplicate tensor(-0.7600, dtype=torch.float64) tensor(-4.0960, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3795, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
13 gae_duplicate tensor(-1.2117, dtype=torch.float64) tensor(1.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2661, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
12 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(-3.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0614, dtype=torch.float64) delta_t tensor(-0.3898, dtype=torch.float64)
11 gae_duplicate tensor(-2.2571, dtype=torch.float64) tensor(7.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6242, dtype=torch.float64) delta_t tensor(-0.2053, dtype=torch.float64)
10 gae_duplicate tensor(-1.8131, dtype=torch.float64) tensor(4.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4331, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
9 gae_duplicate tensor(-0.3462, dtype=torch.float64) tensor(0.7091, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5255, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
8 gae_duplicate tensor(-0.2887, dtype=torch.float64) tensor(-0.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7701, dtype=torch.float64) delta_t tensor(0.0838, dtype=torch.float64)
7 gae_duplicate tensor(-0.1399, dtype=torch.float64) tensor(-1.7590, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7934, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
6 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-1.5457, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4993, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
5 gae_duplicate tensor(-0.1590, dtype=torch.float64) tensor(-2.2643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0150, dtype=torch.float64) delta_t tensor(-0.1043, dtype=torch.float64)
4 gae_duplicate tensor(-0.2482, dtype=torch.float64) tensor(1.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1271, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
3 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(-0.7404, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2793, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
2 gae_duplicate tensor(-0.2761, dtype=torch.float64) tensor(1.1618, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-228.235595703125
value loss:21.55144691467285
entropies:355.86761474609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8287999629974365 seconds
19 rew tensor(1.0588, dtype=torch.float64) delta_t tensor(-0.1346, dtype=torch.float64)
19 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(2.6287, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0590, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
18 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-0.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0212, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
17 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-0.0521, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9197, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
16 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(1.0503, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8550, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
15 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(1.2451, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6766, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
14 gae_duplicate tensor(-0.0124, dtype=torch.float64) tensor(-1.8764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7139, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
13 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-1.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3573, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
12 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(1.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
11 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(0.7500, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0274, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
10 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-1.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
9 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(0.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.0089, dtype=torch.float64)
8 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(0.1714, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8603, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
7 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-0.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4616, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
6 gae_duplicate tensor(0.0679, dtype=torch.float64) tensor(-2.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6527, dtype=torch.float64) delta_t tensor(-0.0414, dtype=torch.float64)
5 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(0.5825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0114, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
4 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(0.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9751, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
3 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(0.5692, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
2 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(1.2355, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-186.30459594726562
value loss:1.8664871454238892
entropies:355.8665771484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.74807596206665 seconds
19 rew tensor(1.2378, dtype=torch.float64) delta_t tensor(-0.0775, dtype=torch.float64)
19 gae_duplicate tensor(-0.1461, dtype=torch.float64) tensor(1.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1610, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
18 gae_duplicate tensor(-0.0227, dtype=torch.float64) tensor(-0.2605, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1355, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
17 gae_duplicate tensor(-0.0301, dtype=torch.float64) tensor(-0.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0459, dtype=torch.float64) delta_t tensor(-0.0452, dtype=torch.float64)
16 gae_duplicate tensor(-0.1351, dtype=torch.float64) tensor(0.8233, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9440, dtype=torch.float64) delta_t tensor(-0.0545, dtype=torch.float64)
15 gae_duplicate tensor(-0.1839, dtype=torch.float64) tensor(1.1466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3323, dtype=torch.float64) delta_t tensor(-0.1746, dtype=torch.float64)
14 gae_duplicate tensor(-2.1507, dtype=torch.float64) tensor(3.6030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1567, dtype=torch.float64) delta_t tensor(-0.2732, dtype=torch.float64)
13 gae_duplicate tensor(-2.0763, dtype=torch.float64) tensor(5.7942, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3173, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
12 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-3.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4457, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
11 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-2.3343, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1174, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
10 gae_duplicate tensor(-0.1888, dtype=torch.float64) tensor(-1.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
9 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-2.7753, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6143, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
8 gae_duplicate tensor(-0.2312, dtype=torch.float64) tensor(1.3691, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3798, dtype=torch.float64) delta_t tensor(-0.3110, dtype=torch.float64)
7 gae_duplicate tensor(-2.1392, dtype=torch.float64) tensor(6.3227, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8965, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
6 gae_duplicate tensor(-0.3387, dtype=torch.float64) tensor(0.9090, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4717, dtype=torch.float64) delta_t tensor(0.1691, dtype=torch.float64)
5 gae_duplicate tensor(-0.1947, dtype=torch.float64) tensor(-3.2975, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0599, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
4 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(0.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3030, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
3 gae_duplicate tensor(-0.4288, dtype=torch.float64) tensor(1.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3797, dtype=torch.float64) delta_t tensor(-0.1107, dtype=torch.float64)
2 gae_duplicate tensor(-0.2830, dtype=torch.float64) tensor(2.3649, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-741.9776611328125
value loss:26.24489974975586
entropies:355.87530517578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.818926811218262 seconds
19 rew tensor(1.1867, dtype=torch.float64) delta_t tensor(-0.0877, dtype=torch.float64)
19 gae_duplicate tensor(-0.1361, dtype=torch.float64) tensor(1.7411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1102, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
18 gae_duplicate tensor(-0.1103, dtype=torch.float64) tensor(0.6420, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1614, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
17 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-1.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0083, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
16 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(1.0160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
15 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(1.9494, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4938, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
14 gae_duplicate tensor(-1.6475, dtype=torch.float64) tensor(1.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5229, dtype=torch.float64) delta_t tensor(0.0948, dtype=torch.float64)
13 gae_duplicate tensor(-1.2153, dtype=torch.float64) tensor(-1.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1237, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
12 gae_duplicate tensor(-0.9306, dtype=torch.float64) tensor(0.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0512, dtype=torch.float64) delta_t tensor(-0.3294, dtype=torch.float64)
11 gae_duplicate tensor(-2.8486, dtype=torch.float64) tensor(6.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3067, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
10 gae_duplicate tensor(-1.2406, dtype=torch.float64) tensor(2.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4832, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
9 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-2.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7045, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
8 gae_duplicate tensor(-0.3513, dtype=torch.float64) tensor(1.9607, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2607, dtype=torch.float64) delta_t tensor(-0.3266, dtype=torch.float64)
7 gae_duplicate tensor(-2.0993, dtype=torch.float64) tensor(6.7292, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8070, dtype=torch.float64) delta_t tensor(0.2283, dtype=torch.float64)
6 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-3.7945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5481, dtype=torch.float64) delta_t tensor(0.1456, dtype=torch.float64)
5 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-3.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0345, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
4 gae_duplicate tensor(-0.2757, dtype=torch.float64) tensor(-0.3703, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2906, dtype=torch.float64) delta_t tensor(-0.0689, dtype=torch.float64)
3 gae_duplicate tensor(-0.2792, dtype=torch.float64) tensor(1.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3413, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
2 gae_duplicate tensor(-0.3098, dtype=torch.float64) tensor(-0.3106, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-825.9725341796875
value loss:36.34557342529297
entropies:355.8550720214844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.7036)
ToM Target loss= tensor(3962.5176)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.63291597366333 seconds
19 rew tensor(1.1487, dtype=torch.float64) delta_t tensor(-0.1397, dtype=torch.float64)
19 gae_duplicate tensor(-0.2176, dtype=torch.float64) tensor(2.7754, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1999, dtype=torch.float64) delta_t tensor(0.0867, dtype=torch.float64)
18 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-1.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0210, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
17 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(1.1523, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0213, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
16 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-0.1866, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9952, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
15 gae_duplicate tensor(-0.1309, dtype=torch.float64) tensor(-4.3772, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1281, dtype=torch.float64) delta_t tensor(-0.3593, dtype=torch.float64)
14 gae_duplicate tensor(-2.1674, dtype=torch.float64) tensor(6.7438, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2523, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
13 gae_duplicate tensor(-0.8501, dtype=torch.float64) tensor(3.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
12 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-2.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5225, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
11 gae_duplicate tensor(-0.1188, dtype=torch.float64) tensor(-1.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1164, dtype=torch.float64) delta_t tensor(0.1481, dtype=torch.float64)
10 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(-3.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7285, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
9 gae_duplicate tensor(0.0292, dtype=torch.float64) tensor(-4.6155, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7446, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
8 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(1.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5235, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
7 gae_duplicate tensor(-0.1527, dtype=torch.float64) tensor(-0.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8212, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
6 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(-0.6573, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3170, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
5 gae_duplicate tensor(-0.1580, dtype=torch.float64) tensor(-2.2431, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0411, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
4 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(0.6971, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9343, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
3 gae_duplicate tensor(-0.2112, dtype=torch.float64) tensor(-1.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3167, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
2 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(-0.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:286.97100830078125
value loss:13.18171215057373
entropies:355.8254089355469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.793065786361694 seconds
19 rew tensor(1.1611, dtype=torch.float64) delta_t tensor(-0.0716, dtype=torch.float64)
19 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(1.4249, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1616, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
18 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(-1.4051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1229, dtype=torch.float64) delta_t tensor(0.0397, dtype=torch.float64)
17 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-0.9079, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
16 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-0.3600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
15 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(-0.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7134, dtype=torch.float64) delta_t tensor(-0.0730, dtype=torch.float64)
14 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(1.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
13 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-0.7714, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
12 gae_duplicate tensor(-0.5451, dtype=torch.float64) tensor(2.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3781, dtype=torch.float64) delta_t tensor(-0.5578, dtype=torch.float64)
11 gae_duplicate tensor(-3.7730, dtype=torch.float64) tensor(11.4587, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0759, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
10 gae_duplicate tensor(-1.1852, dtype=torch.float64) tensor(2.6491, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1647, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
9 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(-0.1453, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5516, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
8 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(-0.9706, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6296, dtype=torch.float64) delta_t tensor(0.1236, dtype=torch.float64)
7 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-2.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
6 gae_duplicate tensor(-0.0438, dtype=torch.float64) tensor(-2.6769, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4472, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
5 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-0.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
4 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-2.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9867, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
3 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(0.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
2 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-3.3816, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-303.23272705078125
value loss:27.980541229248047
entropies:355.78936767578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9731268882751465 seconds
19 rew tensor(1.2123, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
19 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(1.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1482, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
18 gae_duplicate tensor(-0.0483, dtype=torch.float64) tensor(-1.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0585, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
17 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(0.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9690, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
16 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-1.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
15 gae_duplicate tensor(-0.1612, dtype=torch.float64) tensor(0.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6622, dtype=torch.float64) delta_t tensor(0.3570, dtype=torch.float64)
14 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-7.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4492, dtype=torch.float64) delta_t tensor(-0.0713, dtype=torch.float64)
13 gae_duplicate tensor(-1.1624, dtype=torch.float64) tensor(0.7186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1637, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
12 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(0.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4603, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
11 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-1.4256, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0788, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
10 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-1.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3054, dtype=torch.float64) delta_t tensor(0.0395, dtype=torch.float64)
9 gae_duplicate tensor(-0.0318, dtype=torch.float64) tensor(-0.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5006, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
8 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(0.8345, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8438, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
7 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(-2.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6923, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
6 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(-1.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5221, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
5 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-1.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0361, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
4 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(-0.5895, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0875, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
3 gae_duplicate tensor(-0.0724, dtype=torch.float64) tensor(-0.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3558, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
2 gae_duplicate tensor(-0.2958, dtype=torch.float64) tensor(0.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:704.5068969726562
value loss:6.6542229652404785
entropies:355.73193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.753515005111694 seconds
19 rew tensor(1.1872, dtype=torch.float64) delta_t tensor(-0.1146, dtype=torch.float64)
19 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(2.2579, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1615, dtype=torch.float64) delta_t tensor(0.0421, dtype=torch.float64)
18 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-0.5887, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8947, dtype=torch.float64) delta_t tensor(-0.1960, dtype=torch.float64)
17 gae_duplicate tensor(-1.3824, dtype=torch.float64) tensor(3.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0470, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
16 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-0.6415, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
15 gae_duplicate tensor(-0.2624, dtype=torch.float64) tensor(-1.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.4189, dtype=torch.float64) delta_t tensor(-0.6083, dtype=torch.float64)
14 gae_duplicate tensor(-2.2331, dtype=torch.float64) tensor(12.1056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6500, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
13 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-1.6604, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3179, dtype=torch.float64) delta_t tensor(0.1287, dtype=torch.float64)
12 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(-2.7480, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
11 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-3.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0364, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
10 gae_duplicate tensor(-0.0597, dtype=torch.float64) tensor(-2.6020, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3578, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
9 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-1.7234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5524, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
8 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(0.9515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5999, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
7 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-2.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6673, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
6 gae_duplicate tensor(0.0874, dtype=torch.float64) tensor(-3.5922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4200, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
5 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-0.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
4 gae_duplicate tensor(-0.1882, dtype=torch.float64) tensor(0.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9083, dtype=torch.float64) delta_t tensor(-0.0761, dtype=torch.float64)
3 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(1.5602, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2779, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
2 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(0.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-146.5249481201172
value loss:19.803813934326172
entropies:355.6678771972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.787439823150635 seconds
19 rew tensor(1.1995, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
19 gae_duplicate tensor(-0.1138, dtype=torch.float64) tensor(0.9637, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1869, dtype=torch.float64) delta_t tensor(0.1234, dtype=torch.float64)
18 gae_duplicate tensor(0.0829, dtype=torch.float64) tensor(-2.3226, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0205, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
17 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(0.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(-0.0539, dtype=torch.float64)
16 gae_duplicate tensor(-0.1988, dtype=torch.float64) tensor(1.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8805, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
15 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-1.6936, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6373, dtype=torch.float64) delta_t tensor(0.2814, dtype=torch.float64)
14 gae_duplicate tensor(0.0671, dtype=torch.float64) tensor(-5.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7536, dtype=torch.float64) delta_t tensor(0.2291, dtype=torch.float64)
13 gae_duplicate tensor(0.0030, dtype=torch.float64) tensor(-5.0623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3178, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
12 gae_duplicate tensor(-0.1447, dtype=torch.float64) tensor(-2.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1773, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
11 gae_duplicate tensor(-1.0800, dtype=torch.float64) tensor(0.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
10 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(-2.1951, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.0881, dtype=torch.float64)
9 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-1.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6024, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
8 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(0.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0339, dtype=torch.float64) delta_t tensor(-0.1570, dtype=torch.float64)
7 gae_duplicate tensor(-0.5940, dtype=torch.float64) tensor(3.1724, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6790, dtype=torch.float64) delta_t tensor(0.1077, dtype=torch.float64)
6 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-1.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5490, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
5 gae_duplicate tensor(-0.2667, dtype=torch.float64) tensor(-0.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0605, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
4 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-2.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1639, dtype=torch.float64) delta_t tensor(-0.0828, dtype=torch.float64)
3 gae_duplicate tensor(-0.2830, dtype=torch.float64) tensor(1.3607, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
2 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(-2.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:944.7479248046875
value loss:8.48132610321045
entropies:355.58160400390625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.7002)
ToM Target loss= tensor(3962.1758)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.809928894042969 seconds
19 rew tensor(1.1367, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
19 gae_duplicate tensor(-0.1389, dtype=torch.float64) tensor(0.9818, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0858, dtype=torch.float64) delta_t tensor(0.0578, dtype=torch.float64)
18 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(-1.0238, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0983, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
17 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-1.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9443, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
16 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-0.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9064, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
15 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-0.1656, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1756, dtype=torch.float64) delta_t tensor(-0.2630, dtype=torch.float64)
14 gae_duplicate tensor(-1.2596, dtype=torch.float64) tensor(4.9148, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4939, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
13 gae_duplicate tensor(-1.2766, dtype=torch.float64) tensor(1.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3438, dtype=torch.float64) delta_t tensor(0.1794, dtype=torch.float64)
12 gae_duplicate tensor(-0.1304, dtype=torch.float64) tensor(-3.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3299, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
11 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(-2.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0247, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
10 gae_duplicate tensor(-0.0332, dtype=torch.float64) tensor(-2.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2793, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
9 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(-0.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3728, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
8 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(0.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6134, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
7 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(-0.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5786, dtype=torch.float64) delta_t tensor(0.2375, dtype=torch.float64)
6 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-4.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4965, dtype=torch.float64) delta_t tensor(-0.1500, dtype=torch.float64)
5 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(2.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1699, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
4 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(0.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7672, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
3 gae_duplicate tensor(-0.1983, dtype=torch.float64) tensor(1.9307, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1234, dtype=torch.float64) delta_t tensor(-0.1672, dtype=torch.float64)
2 gae_duplicate tensor(-0.4065, dtype=torch.float64) tensor(3.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2.6996498107910156
value loss:10.353890419006348
entropies:355.4534912109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.862101793289185 seconds
19 rew tensor(1.1235, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
19 gae_duplicate tensor(-0.1129, dtype=torch.float64) tensor(1.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1237, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
18 gae_duplicate tensor(-0.0951, dtype=torch.float64) tensor(-0.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0982, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
17 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-1.1853, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9960, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
16 gae_duplicate tensor(-0.1083, dtype=torch.float64) tensor(0.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9319, dtype=torch.float64) delta_t tensor(-0.1014, dtype=torch.float64)
15 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(2.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7924, dtype=torch.float64) delta_t tensor(0.1884, dtype=torch.float64)
14 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-3.4680, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7398, dtype=torch.float64) delta_t tensor(0.1347, dtype=torch.float64)
13 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(-3.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4861, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
12 gae_duplicate tensor(-0.0900, dtype=torch.float64) tensor(-1.5914, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0971, dtype=torch.float64) delta_t tensor(-0.3931, dtype=torch.float64)
11 gae_duplicate tensor(-2.2936, dtype=torch.float64) tensor(7.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4775, dtype=torch.float64) delta_t tensor(-0.2445, dtype=torch.float64)
10 gae_duplicate tensor(-1.9163, dtype=torch.float64) tensor(5.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2273, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
9 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(0.2699, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5379, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
8 gae_duplicate tensor(-0.3427, dtype=torch.float64) tensor(0.0130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2405, dtype=torch.float64) delta_t tensor(-0.3742, dtype=torch.float64)
7 gae_duplicate tensor(-2.1758, dtype=torch.float64) tensor(7.5660, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7180, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
6 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(-1.3806, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5246, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
5 gae_duplicate tensor(-0.2079, dtype=torch.float64) tensor(-0.4609, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0366, dtype=torch.float64) delta_t tensor(0.0232, dtype=torch.float64)
4 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(-0.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1414, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
3 gae_duplicate tensor(-0.2164, dtype=torch.float64) tensor(0.8410, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
2 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-3.1959, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-666.3151245117188
value loss:25.059194564819336
entropies:355.3548889160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.84300422668457 seconds
19 rew tensor(1.1740, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
19 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(0.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1868, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
18 gae_duplicate tensor(0.0031, dtype=torch.float64) tensor(-1.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0462, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
17 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(-0.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9444, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
16 gae_duplicate tensor(-0.0823, dtype=torch.float64) tensor(0.0020, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
15 gae_duplicate tensor(-0.1767, dtype=torch.float64) tensor(-1.9462, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5871, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
14 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-0.7841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7787, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
13 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-3.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2165, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
12 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-0.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0452, dtype=torch.float64) delta_t tensor(-0.3712, dtype=torch.float64)
11 gae_duplicate tensor(-2.6854, dtype=torch.float64) tensor(7.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0264, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
10 gae_duplicate tensor(0.0545, dtype=torch.float64) tensor(-5.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5081, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
9 gae_duplicate tensor(0.1428, dtype=torch.float64) tensor(-3.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8950, dtype=torch.float64) delta_t tensor(-0.1816, dtype=torch.float64)
8 gae_duplicate tensor(-0.5045, dtype=torch.float64) tensor(3.2622, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5966, dtype=torch.float64) delta_t tensor(-0.3232, dtype=torch.float64)
7 gae_duplicate tensor(-2.0299, dtype=torch.float64) tensor(6.8756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9211, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
6 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(-0.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1670, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
5 gae_duplicate tensor(-0.2958, dtype=torch.float64) tensor(-0.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2719, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
4 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-1.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7043, dtype=torch.float64) delta_t tensor(-0.1565, dtype=torch.float64)
3 gae_duplicate tensor(-0.2978, dtype=torch.float64) tensor(3.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0861, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
2 gae_duplicate tensor(-0.1917, dtype=torch.float64) tensor(-0.7034, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-162.64865112304688
value loss:23.30607795715332
entropies:355.1971435546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.508197784423828 seconds
19 rew tensor(1.1739, dtype=torch.float64) delta_t tensor(-0.0660, dtype=torch.float64)
19 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(1.3400, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1487, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
18 gae_duplicate tensor(-0.0449, dtype=torch.float64) tensor(-1.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7632, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
17 gae_duplicate tensor(-1.3878, dtype=torch.float64) tensor(4.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0467, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
16 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(0.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8549, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
15 gae_duplicate tensor(-0.2243, dtype=torch.float64) tensor(-0.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2316, dtype=torch.float64) delta_t tensor(-0.1802, dtype=torch.float64)
14 gae_duplicate tensor(-2.2337, dtype=torch.float64) tensor(4.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5748, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
13 gae_duplicate tensor(-0.2622, dtype=torch.float64) tensor(-1.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3689, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
12 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(-1.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
11 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(-1.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0108, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
10 gae_duplicate tensor(-0.0521, dtype=torch.float64) tensor(-1.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.1042, dtype=torch.float64)
9 gae_duplicate tensor(-0.1109, dtype=torch.float64) tensor(-2.2153, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4744, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
8 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(1.3125, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8453, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
7 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(0.7473, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5639, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
6 gae_duplicate tensor(0.0224, dtype=torch.float64) tensor(-2.5236, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6004, dtype=torch.float64) delta_t tensor(-0.0795, dtype=torch.float64)
5 gae_duplicate tensor(-0.2190, dtype=torch.float64) tensor(1.2218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
4 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(0.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0754, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
3 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(2.6118, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3685, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
2 gae_duplicate tensor(-0.3222, dtype=torch.float64) tensor(1.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-417.9380798339844
value loss:14.934038162231445
entropies:354.9487609863281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.733536005020142 seconds
19 rew tensor(1.1877, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
19 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(0.9492, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8893, dtype=torch.float64) delta_t tensor(-0.1677, dtype=torch.float64)
18 gae_duplicate tensor(-1.5323, dtype=torch.float64) tensor(3.6368, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7506, dtype=torch.float64) delta_t tensor(-0.2386, dtype=torch.float64)
17 gae_duplicate tensor(-1.3046, dtype=torch.float64) tensor(4.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9582, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(1.0591, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
15 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(0.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8175, dtype=torch.float64) delta_t tensor(0.1892, dtype=torch.float64)
14 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(-3.7474, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7143, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
13 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(-2.0533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2801, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
12 gae_duplicate tensor(-0.2005, dtype=torch.float64) tensor(1.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4579, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
11 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(-0.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0624, dtype=torch.float64) delta_t tensor(0.1431, dtype=torch.float64)
10 gae_duplicate tensor(-0.0286, dtype=torch.float64) tensor(-2.8668, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2667, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
9 gae_duplicate tensor(-0.0905, dtype=torch.float64) tensor(0.0285, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4623, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
8 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(-0.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1437, dtype=torch.float64) delta_t tensor(-0.2129, dtype=torch.float64)
7 gae_duplicate tensor(-0.9420, dtype=torch.float64) tensor(4.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7560, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
6 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(0.0185, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3723, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
5 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-1.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
4 gae_duplicate tensor(-0.2477, dtype=torch.float64) tensor(1.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9262, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
3 gae_duplicate tensor(-0.3872, dtype=torch.float64) tensor(-0.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2806, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
2 gae_duplicate tensor(-0.6406, dtype=torch.float64) tensor(1.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-503.0441589355469
value loss:13.426492691040039
entropies:354.63983154296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.3599)
ToM Target loss= tensor(3963.2139)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.854071140289307 seconds
19 rew tensor(1.1368, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
19 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(1.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1114, dtype=torch.float64) delta_t tensor(0.0747, dtype=torch.float64)
18 gae_duplicate tensor(-0.0577, dtype=torch.float64) tensor(-1.3576, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
17 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(0.4945, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9969, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
16 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(0.9961, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
15 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(0.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7784, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
14 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(0.0540, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7403, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
13 gae_duplicate tensor(-0.1188, dtype=torch.float64) tensor(-1.3854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0844, dtype=torch.float64) delta_t tensor(-0.1892, dtype=torch.float64)
12 gae_duplicate tensor(-0.9497, dtype=torch.float64) tensor(3.4529, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0033, dtype=torch.float64) delta_t tensor(-0.4420, dtype=torch.float64)
11 gae_duplicate tensor(-2.5697, dtype=torch.float64) tensor(9.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0264, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
10 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-0.8697, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
9 gae_duplicate tensor(-0.0248, dtype=torch.float64) tensor(-1.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4760, dtype=torch.float64) delta_t tensor(-0.0222, dtype=torch.float64)
8 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(0.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4335, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
7 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-0.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6816, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
6 gae_duplicate tensor(-0.2176, dtype=torch.float64) tensor(-1.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3426, dtype=torch.float64) delta_t tensor(-0.0920, dtype=torch.float64)
5 gae_duplicate tensor(-0.3399, dtype=torch.float64) tensor(1.5806, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2215, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
4 gae_duplicate tensor(-0.1344, dtype=torch.float64) tensor(0.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6774, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
3 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(-0.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1492, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
2 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(0.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-678.216064453125
value loss:13.501323699951172
entropies:354.2756652832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.190551996231079 seconds
19 rew tensor(1.1608, dtype=torch.float64) delta_t tensor(-0.0969, dtype=torch.float64)
19 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(1.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1740, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
18 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-0.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1097, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
17 gae_duplicate tensor(-0.0473, dtype=torch.float64) tensor(-0.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0076, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
16 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(0.2675, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8039, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
15 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(1.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4226, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-0.7729, dtype=torch.float64) tensor(0.6548, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6508, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
13 gae_duplicate tensor(0.0154, dtype=torch.float64) tensor(-2.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3427, dtype=torch.float64) delta_t tensor(0.0782, dtype=torch.float64)
12 gae_duplicate tensor(-0.1138, dtype=torch.float64) tensor(-1.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5486, dtype=torch.float64) delta_t tensor(0.1836, dtype=torch.float64)
11 gae_duplicate tensor(0.1194, dtype=torch.float64) tensor(-3.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1170, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
10 gae_duplicate tensor(-0.1869, dtype=torch.float64) tensor(-0.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3700, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
9 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-2.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6037, dtype=torch.float64) delta_t tensor(-0.2075, dtype=torch.float64)
8 gae_duplicate tensor(-0.3865, dtype=torch.float64) tensor(3.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2849, dtype=torch.float64) delta_t tensor(-0.1900, dtype=torch.float64)
7 gae_duplicate tensor(-0.7702, dtype=torch.float64) tensor(4.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7948, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
6 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(0.6070, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3942, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
5 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-1.4960, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0590, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
4 gae_duplicate tensor(-0.1427, dtype=torch.float64) tensor(-2.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0848, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
3 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(1.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3790, dtype=torch.float64) delta_t tensor(0.0829, dtype=torch.float64)
2 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-1.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:115.40341186523438
value loss:7.133638858795166
entropies:353.93975830078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.937978982925415 seconds
19 rew tensor(1.2375, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
19 gae_duplicate tensor(-0.1525, dtype=torch.float64) tensor(1.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1606, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
18 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-0.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1221, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
17 gae_duplicate tensor(-0.1338, dtype=torch.float64) tensor(-0.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0586, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
16 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(0.5738, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0071, dtype=torch.float64) delta_t tensor(0.2755, dtype=torch.float64)
15 gae_duplicate tensor(-0.0591, dtype=torch.float64) tensor(-5.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6004, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
14 gae_duplicate tensor(-0.6941, dtype=torch.float64) tensor(-2.0324, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2413, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
13 gae_duplicate tensor(-1.0640, dtype=torch.float64) tensor(1.5295, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0866, dtype=torch.float64) delta_t tensor(-0.1370, dtype=torch.float64)
12 gae_duplicate tensor(-1.9364, dtype=torch.float64) tensor(2.3859, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0901, dtype=torch.float64) delta_t tensor(-0.2279, dtype=torch.float64)
11 gae_duplicate tensor(-1.7585, dtype=torch.float64) tensor(4.8692, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0364, dtype=torch.float64) delta_t tensor(0.1572, dtype=torch.float64)
10 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-2.6365, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(0.1426, dtype=torch.float64)
9 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-3.0196, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5496, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
8 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(0.6076, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2340, dtype=torch.float64) delta_t tensor(-0.6172, dtype=torch.float64)
7 gae_duplicate tensor(-3.2180, dtype=torch.float64) tensor(12.7793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8436, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
6 gae_duplicate tensor(-0.5936, dtype=torch.float64) tensor(1.3530, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7293, dtype=torch.float64) delta_t tensor(0.1996, dtype=torch.float64)
5 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-3.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(0.0113, dtype=torch.float64)
4 gae_duplicate tensor(-0.1275, dtype=torch.float64) tensor(-0.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7526, dtype=torch.float64) delta_t tensor(-0.0547, dtype=torch.float64)
3 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(0.8946, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6116, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
2 gae_duplicate tensor(-0.2707, dtype=torch.float64) tensor(-2.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-413.95721435546875
value loss:38.48381423950195
entropies:353.762939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.602308034896851 seconds
19 rew tensor(1.1989, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
19 gae_duplicate tensor(-0.0852, dtype=torch.float64) tensor(0.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1738, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
18 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-2.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0711, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
17 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-0.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0211, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
16 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-0.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8161, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
15 gae_duplicate tensor(-0.1803, dtype=torch.float64) tensor(-1.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7797, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
14 gae_duplicate tensor(-0.0633, dtype=torch.float64) tensor(-1.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4715, dtype=torch.float64) delta_t tensor(0.1703, dtype=torch.float64)
13 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-3.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5226, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
12 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-2.8010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1285, dtype=torch.float64) delta_t tensor(-0.2168, dtype=torch.float64)
11 gae_duplicate tensor(-1.2550, dtype=torch.float64) tensor(4.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2043, dtype=torch.float64) delta_t tensor(0.1585, dtype=torch.float64)
10 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-2.7930, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
9 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-2.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4475, dtype=torch.float64) delta_t tensor(-0.1909, dtype=torch.float64)
8 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(3.4022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4976, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
7 gae_duplicate tensor(-0.2117, dtype=torch.float64) tensor(-1.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5884, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
6 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-1.9005, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9066, dtype=torch.float64) delta_t tensor(0.1072, dtype=torch.float64)
5 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-2.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
4 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-2.5694, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7527, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
3 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(0.7023, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7270, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
2 gae_duplicate tensor(0.0880, dtype=torch.float64) tensor(-3.2427, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1073.0616455078125
value loss:8.102259635925293
entropies:353.5106201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.729623079299927 seconds
19 rew tensor(1.0334, dtype=torch.float64) delta_t tensor(-0.1194, dtype=torch.float64)
19 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(2.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0462, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
18 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(0.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0337, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
17 gae_duplicate tensor(-0.0877, dtype=torch.float64) tensor(-0.3297, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
16 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(0.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(-0.1191, dtype=torch.float64)
15 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(2.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8038, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
14 gae_duplicate tensor(-0.0381, dtype=torch.float64) tensor(-1.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6879, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
13 gae_duplicate tensor(0.0159, dtype=torch.float64) tensor(-2.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4598, dtype=torch.float64) delta_t tensor(-0.0872, dtype=torch.float64)
12 gae_duplicate tensor(-0.2237, dtype=torch.float64) tensor(1.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
11 gae_duplicate tensor(-0.2455, dtype=torch.float64) tensor(1.2245, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1268, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
10 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(0.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0873, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
9 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(-1.3855, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2948, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
8 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(0.7141, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9883, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
7 gae_duplicate tensor(-0.2248, dtype=torch.float64) tensor(-0.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5491, dtype=torch.float64) delta_t tensor(0.2211, dtype=torch.float64)
6 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-4.3014, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5513, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
5 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(0.0112, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0637, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
4 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-0.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9260, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
3 gae_duplicate tensor(-0.1527, dtype=torch.float64) tensor(-1.5101, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
2 gae_duplicate tensor(-0.4407, dtype=torch.float64) tensor(-0.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:127.37255096435547
value loss:3.7460765838623047
entropies:353.44268798828125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.6802)
ToM Target loss= tensor(3960.5554)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.948944807052612 seconds
19 rew tensor(1.2119, dtype=torch.float64) delta_t tensor(-0.0453, dtype=torch.float64)
19 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(0.9635, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1612, dtype=torch.float64) delta_t tensor(0.0351, dtype=torch.float64)
18 gae_duplicate tensor(-0.0276, dtype=torch.float64) tensor(-0.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1234, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
17 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(-0.4896, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0469, dtype=torch.float64) delta_t tensor(-0.0663, dtype=torch.float64)
16 gae_duplicate tensor(-0.1489, dtype=torch.float64) tensor(1.3361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9063, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
15 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(1.6873, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4001, dtype=torch.float64) delta_t tensor(-0.2921, dtype=torch.float64)
14 gae_duplicate tensor(-1.9820, dtype=torch.float64) tensor(6.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.2017, dtype=torch.float64)
13 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-3.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6119, dtype=torch.float64) delta_t tensor(0.1514, dtype=torch.float64)
12 gae_duplicate tensor(-0.1309, dtype=torch.float64) tensor(-3.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4562, dtype=torch.float64) delta_t tensor(-0.4703, dtype=torch.float64)
11 gae_duplicate tensor(-3.6869, dtype=torch.float64) tensor(8.0562, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2556, dtype=torch.float64) delta_t tensor(-0.2496, dtype=torch.float64)
10 gae_duplicate tensor(-2.1043, dtype=torch.float64) tensor(6.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.4700, dtype=torch.float64) delta_t tensor(-0.4350, dtype=torch.float64)
9 gae_duplicate tensor(-3.4688, dtype=torch.float64) tensor(10.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3734, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
8 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(1.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4502, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
7 gae_duplicate tensor(-0.8956, dtype=torch.float64) tensor(0.1331, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6549, dtype=torch.float64) delta_t tensor(0.1296, dtype=torch.float64)
6 gae_duplicate tensor(-0.1695, dtype=torch.float64) tensor(-2.6246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7775, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
5 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(-1.2169, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2170, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
4 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(-1.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5249, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
3 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(1.6189, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5492, dtype=torch.float64) delta_t tensor(0.1031, dtype=torch.float64)
2 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-1.8620, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1283.8270263671875
value loss:57.90160369873047
entropies:353.35748291015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.69554591178894 seconds
19 rew tensor(1.1344, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
19 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(1.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0965, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
18 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-0.7041, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0581, dtype=torch.float64) delta_t tensor(0.0155, dtype=torch.float64)
17 gae_duplicate tensor(-0.0489, dtype=torch.float64) tensor(-0.3182, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0333, dtype=torch.float64) delta_t tensor(-0.0056, dtype=torch.float64)
16 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(0.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
15 gae_duplicate tensor(-0.1486, dtype=torch.float64) tensor(-0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8042, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
14 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-0.3310, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6877, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
13 gae_duplicate tensor(0.0336, dtype=torch.float64) tensor(-3.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5733, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
12 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-0.4551, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6220, dtype=torch.float64) delta_t tensor(-0.6729, dtype=torch.float64)
11 gae_duplicate tensor(-3.8085, dtype=torch.float64) tensor(13.6592, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2929, dtype=torch.float64) delta_t tensor(-0.2580, dtype=torch.float64)
10 gae_duplicate tensor(-2.0772, dtype=torch.float64) tensor(6.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0134, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
9 gae_duplicate tensor(-0.2403, dtype=torch.float64) tensor(0.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2823, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
8 gae_duplicate tensor(-0.3571, dtype=torch.float64) tensor(1.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1266, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
7 gae_duplicate tensor(-0.2547, dtype=torch.float64) tensor(-0.4095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4229, dtype=torch.float64) delta_t tensor(0.2188, dtype=torch.float64)
6 gae_duplicate tensor(0.0373, dtype=torch.float64) tensor(-4.4596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8539, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
5 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(1.7046, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0888, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
4 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-1.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2672, dtype=torch.float64) delta_t tensor(-0.0952, dtype=torch.float64)
3 gae_duplicate tensor(-0.3198, dtype=torch.float64) tensor(1.6481, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4338, dtype=torch.float64) delta_t tensor(-0.0456, dtype=torch.float64)
2 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(0.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-956.1982421875
value loss:31.279800415039062
entropies:353.1412658691406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.943431854248047 seconds
19 rew tensor(1.2630, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
19 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(0.7975, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9325, dtype=torch.float64) delta_t tensor(-0.1552, dtype=torch.float64)
18 gae_duplicate tensor(-1.5165, dtype=torch.float64) tensor(2.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
17 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(1.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0203, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
16 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(0.7871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8417, dtype=torch.float64) delta_t tensor(-0.1394, dtype=torch.float64)
15 gae_duplicate tensor(-0.3081, dtype=torch.float64) tensor(2.6029, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5235, dtype=torch.float64) delta_t tensor(-0.1780, dtype=torch.float64)
14 gae_duplicate tensor(-1.6365, dtype=torch.float64) tensor(4.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0522, dtype=torch.float64) delta_t tensor(-0.2818, dtype=torch.float64)
13 gae_duplicate tensor(-1.1011, dtype=torch.float64) tensor(6.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3547, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
12 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-3.0619, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4093, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
11 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-1.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0469, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
10 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-3.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5244, dtype=torch.float64) delta_t tensor(0.1395, dtype=torch.float64)
9 gae_duplicate tensor(-0.0838, dtype=torch.float64) tensor(-2.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6147, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
8 gae_duplicate tensor(-0.2057, dtype=torch.float64) tensor(1.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4417, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
7 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-0.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9497, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
6 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(-0.8982, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1329, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
5 gae_duplicate tensor(-0.0453, dtype=torch.float64) tensor(-3.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1724, dtype=torch.float64) delta_t tensor(-0.0672, dtype=torch.float64)
4 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(0.9423, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7731, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
3 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-0.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1727, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
2 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(0.4593, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-343.39666748046875
value loss:15.60204029083252
entropies:352.81158447265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.691821098327637 seconds
19 rew tensor(1.1862, dtype=torch.float64) delta_t tensor(-0.0658, dtype=torch.float64)
19 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(1.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1481, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
18 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-1.4143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9951, dtype=torch.float64) delta_t tensor(-0.0525, dtype=torch.float64)
17 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9697, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
16 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(0.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8157, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
15 gae_duplicate tensor(-0.4047, dtype=torch.float64) tensor(2.0510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5737, dtype=torch.float64) delta_t tensor(0.2638, dtype=torch.float64)
14 gae_duplicate tensor(-0.0196, dtype=torch.float64) tensor(-5.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7014, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
13 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-2.1623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0630, dtype=torch.float64) delta_t tensor(-0.0991, dtype=torch.float64)
12 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(1.6289, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6889, dtype=torch.float64) delta_t tensor(0.0987, dtype=torch.float64)
11 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-1.7042, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3595, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
10 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(1.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5730, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
9 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-1.0287, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6775, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
8 gae_duplicate tensor(-0.4152, dtype=torch.float64) tensor(2.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5235, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
7 gae_duplicate tensor(-0.1586, dtype=torch.float64) tensor(-2.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8709, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
6 gae_duplicate tensor(-0.0676, dtype=torch.float64) tensor(-1.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2135, dtype=torch.float64) delta_t tensor(0.1584, dtype=torch.float64)
5 gae_duplicate tensor(-0.2100, dtype=torch.float64) tensor(-3.4897, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0159, dtype=torch.float64) delta_t tensor(0.0350, dtype=torch.float64)
4 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-1.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8803, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
3 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-0.6602, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3287, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
2 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-2.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:600.5139770507812
value loss:6.473963260650635
entropies:352.401611328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.633356094360352 seconds
19 rew tensor(1.1612, dtype=torch.float64) delta_t tensor(-0.0732, dtype=torch.float64)
19 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(1.4154, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1224, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
18 gae_duplicate tensor(-0.0380, dtype=torch.float64) tensor(-0.3292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0970, dtype=torch.float64) delta_t tensor(0.0106, dtype=torch.float64)
17 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-0.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0836, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
16 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(0.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0339, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
15 gae_duplicate tensor(-0.0746, dtype=torch.float64) tensor(-2.7019, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5695, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
14 gae_duplicate tensor(-0.8043, dtype=torch.float64) tensor(0.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1339, dtype=torch.float64) delta_t tensor(-0.4692, dtype=torch.float64)
13 gae_duplicate tensor(-3.7327, dtype=torch.float64) tensor(10.0895, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
12 gae_duplicate tensor(-0.9003, dtype=torch.float64) tensor(1.0061, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0883, dtype=torch.float64) delta_t tensor(-0.3827, dtype=torch.float64)
11 gae_duplicate tensor(-2.5735, dtype=torch.float64) tensor(7.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5000, dtype=torch.float64) delta_t tensor(-0.2123, dtype=torch.float64)
10 gae_duplicate tensor(-1.7958, dtype=torch.float64) tensor(5.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3561, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
9 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-0.9798, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5509, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
8 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-0.7294, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7675, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
7 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(0.6478, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6788, dtype=torch.float64) delta_t tensor(0.2091, dtype=torch.float64)
6 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-3.8155, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5987, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
5 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-1.6299, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0148, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
4 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(0.4088, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1642, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
3 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(0.2837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
2 gae_duplicate tensor(-0.3148, dtype=torch.float64) tensor(0.6693, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1085.6990966796875
value loss:42.20560073852539
entropies:352.1154479980469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3946.1292)
ToM Target loss= tensor(3958.4746)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9301769733428955 seconds
19 rew tensor(1.1605, dtype=torch.float64) delta_t tensor(-0.0433, dtype=torch.float64)
19 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(0.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1734, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
18 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-1.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0587, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
17 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-0.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0073, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
16 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-0.3784, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
15 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-0.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7387, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
14 gae_duplicate tensor(-0.1482, dtype=torch.float64) tensor(-0.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5978, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
13 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-0.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0421, dtype=torch.float64) delta_t tensor(-0.3424, dtype=torch.float64)
12 gae_duplicate tensor(-2.1653, dtype=torch.float64) tensor(7.2484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2646, dtype=torch.float64) delta_t tensor(-0.4227, dtype=torch.float64)
11 gae_duplicate tensor(-2.6863, dtype=torch.float64) tensor(9.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2294, dtype=torch.float64) delta_t tensor(0.2316, dtype=torch.float64)
10 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-3.9093, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1622, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
9 gae_duplicate tensor(-0.0919, dtype=torch.float64) tensor(-1.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5627, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
8 gae_duplicate tensor(-0.2638, dtype=torch.float64) tensor(0.9802, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9492, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
7 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(-0.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7409, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
6 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-0.6807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5492, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
5 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-2.4011, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1911, dtype=torch.float64) delta_t tensor(0.1218, dtype=torch.float64)
4 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-2.6047, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3574, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
3 gae_duplicate tensor(-0.3492, dtype=torch.float64) tensor(-0.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5488, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
2 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-3.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:38.10031509399414
value loss:22.517780303955078
entropies:351.5980224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.847439765930176 seconds
19 rew tensor(1.1480, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
19 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(0.2411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1098, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
18 gae_duplicate tensor(0.0015, dtype=torch.float64) tensor(-2.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1360, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
17 gae_duplicate tensor(0.0687, dtype=torch.float64) tensor(-2.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
16 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(-0.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(0.1571, dtype=torch.float64)
15 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-3.1469, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0824, dtype=torch.float64) delta_t tensor(-0.4021, dtype=torch.float64)
14 gae_duplicate tensor(-2.2015, dtype=torch.float64) tensor(6.9796, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5864, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
13 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-2.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3182, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
12 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-3.1195, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4977, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
11 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(-1.1550, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1282, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
10 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-0.7713, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3949, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
9 gae_duplicate tensor(-0.1115, dtype=torch.float64) tensor(0.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4493, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
8 gae_duplicate tensor(-0.1321, dtype=torch.float64) tensor(-0.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8923, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
7 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(-0.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5514, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
6 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-1.3064, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6223, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
5 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(0.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
4 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(0.5633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1363, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
3 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(0.5116, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4439, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
2 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(1.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:374.8117980957031
value loss:11.636801719665527
entropies:350.9243469238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.921220779418945 seconds
19 rew tensor(1.1352, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
19 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(0.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1228, dtype=torch.float64) delta_t tensor(0.1070, dtype=torch.float64)
18 gae_duplicate tensor(-0.0171, dtype=torch.float64) tensor(-2.1571, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7774, dtype=torch.float64) delta_t tensor(-0.1837, dtype=torch.float64)
17 gae_duplicate tensor(-1.4141, dtype=torch.float64) tensor(3.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9309, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
16 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-0.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
15 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-0.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6252, dtype=torch.float64) delta_t tensor(0.1391, dtype=torch.float64)
14 gae_duplicate tensor(-0.0169, dtype=torch.float64) tensor(-2.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3965, dtype=torch.float64) delta_t tensor(-0.0511, dtype=torch.float64)
13 gae_duplicate tensor(-1.0288, dtype=torch.float64) tensor(0.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
12 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-2.8322, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5870, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
11 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-2.4380, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2434, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
10 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-1.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5985, dtype=torch.float64) delta_t tensor(0.1583, dtype=torch.float64)
9 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-3.1912, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6532, dtype=torch.float64) delta_t tensor(-0.1275, dtype=torch.float64)
8 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(2.3677, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6622, dtype=torch.float64) delta_t tensor(0.0428, dtype=torch.float64)
7 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-0.6628, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7422, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
6 gae_duplicate tensor(-0.0555, dtype=torch.float64) tensor(-1.4124, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4437, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
5 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-0.7522, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0091, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
4 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(1.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0587, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
3 gae_duplicate tensor(-0.2442, dtype=torch.float64) tensor(1.3031, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
2 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(0.1929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:345.7401123046875
value loss:9.156676292419434
entropies:350.3240966796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.755434989929199 seconds
19 rew tensor(1.2125, dtype=torch.float64) delta_t tensor(-0.0066, dtype=torch.float64)
19 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(0.2245, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2127, dtype=torch.float64) delta_t tensor(0.2014, dtype=torch.float64)
18 gae_duplicate tensor(0.1139, dtype=torch.float64) tensor(-3.9342, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0848, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
17 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-2.3233, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
16 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-1.1167, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8799, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
15 gae_duplicate tensor(-0.2447, dtype=torch.float64) tensor(-0.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5857, dtype=torch.float64) delta_t tensor(0.1917, dtype=torch.float64)
14 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-3.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4988, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
13 gae_duplicate tensor(-1.1518, dtype=torch.float64) tensor(1.4460, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1502, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
12 gae_duplicate tensor(-0.2390, dtype=torch.float64) tensor(1.1771, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5753, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
11 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-1.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
10 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(-2.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3968, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
9 gae_duplicate tensor(-0.0736, dtype=torch.float64) tensor(-0.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5894, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
8 gae_duplicate tensor(-0.2562, dtype=torch.float64) tensor(-0.7888, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2649, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
7 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(-1.0420, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9508, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
6 gae_duplicate tensor(-0.2559, dtype=torch.float64) tensor(0.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0304, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
5 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-0.8948, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3768, dtype=torch.float64) delta_t tensor(-0.0651, dtype=torch.float64)
4 gae_duplicate tensor(-0.3445, dtype=torch.float64) tensor(1.2038, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4540, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
3 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-0.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0062, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
2 gae_duplicate tensor(-0.4617, dtype=torch.float64) tensor(-0.7867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:725.346435546875
value loss:7.441817760467529
entropies:349.435302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.690378904342651 seconds
19 rew tensor(1.1482, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
19 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(0.1678, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0721, dtype=torch.float64) delta_t tensor(0.0481, dtype=torch.float64)
18 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-1.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1490, dtype=torch.float64) delta_t tensor(0.1350, dtype=torch.float64)
17 gae_duplicate tensor(0.0791, dtype=torch.float64) tensor(-2.8225, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0213, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
16 gae_duplicate tensor(-0.0534, dtype=torch.float64) tensor(-0.6658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9065, dtype=torch.float64) delta_t tensor(0.1137, dtype=torch.float64)
15 gae_duplicate tensor(-0.2719, dtype=torch.float64) tensor(-2.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6632, dtype=torch.float64) delta_t tensor(0.1879, dtype=torch.float64)
14 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-3.6041, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.1401, dtype=torch.float64)
13 gae_duplicate tensor(0.0365, dtype=torch.float64) tensor(-3.3477, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.0789, dtype=torch.float64)
12 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-1.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5213, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
11 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(-2.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0643, dtype=torch.float64) delta_t tensor(-0.0081, dtype=torch.float64)
10 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-0.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4315, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
9 gae_duplicate tensor(-0.0778, dtype=torch.float64) tensor(-2.3885, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5504, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
8 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(-0.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5195, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
7 gae_duplicate tensor(-0.0178, dtype=torch.float64) tensor(-1.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8816, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
6 gae_duplicate tensor(-0.2201, dtype=torch.float64) tensor(0.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1690, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
5 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-0.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2142, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
4 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(0.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6739, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
3 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-0.7800, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1563, dtype=torch.float64) delta_t tensor(-0.0506, dtype=torch.float64)
2 gae_duplicate tensor(-0.3512, dtype=torch.float64) tensor(0.4106, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1139.0799560546875
value loss:5.574326515197754
entropies:348.58538818359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3930.1934)
ToM Target loss= tensor(3961.9385)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.719712018966675 seconds
19 rew tensor(1.1357, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
19 gae_duplicate tensor(-0.0940, dtype=torch.float64) tensor(-0.1160, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0977, dtype=torch.float64) delta_t tensor(0.1232, dtype=torch.float64)
18 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-2.3487, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9695, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
17 gae_duplicate tensor(-0.0594, dtype=torch.float64) tensor(-1.0572, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9316, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
16 gae_duplicate tensor(-0.0796, dtype=torch.float64) tensor(-0.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
15 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(0.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8299, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
14 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-0.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6244, dtype=torch.float64) delta_t tensor(0.2361, dtype=torch.float64)
13 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-4.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(-0.0190, dtype=torch.float64)
12 gae_duplicate tensor(-0.1573, dtype=torch.float64) tensor(0.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2535, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
11 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(-0.4296, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0758, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
10 gae_duplicate tensor(0.0031, dtype=torch.float64) tensor(-1.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1510, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
9 gae_duplicate tensor(0.0253, dtype=torch.float64) tensor(-2.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3467, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
8 gae_duplicate tensor(-0.1185, dtype=torch.float64) tensor(0.8848, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0536, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
7 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-2.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5632, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
6 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-1.3779, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6532, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
5 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(0.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0901, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
4 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-0.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1569, dtype=torch.float64) delta_t tensor(-0.0072, dtype=torch.float64)
3 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(-0.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4225, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
2 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(0.5977, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:679.2957153320312
value loss:2.812741994857788
entropies:347.9549865722656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.688522100448608 seconds
19 rew tensor(1.1102, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
19 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(0.1282, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0846, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
18 gae_duplicate tensor(0.0037, dtype=torch.float64) tensor(-1.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9445, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
17 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-0.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9569, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
16 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(0.4658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8290, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
15 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(1.3221, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
14 gae_duplicate tensor(-0.0351, dtype=torch.float64) tensor(-0.7206, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7016, dtype=torch.float64) delta_t tensor(0.2123, dtype=torch.float64)
13 gae_duplicate tensor(0.0999, dtype=torch.float64) tensor(-4.2103, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
12 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-1.1977, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3572, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
11 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-0.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0269, dtype=torch.float64) delta_t tensor(0.1306, dtype=torch.float64)
10 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-2.6170, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
9 gae_duplicate tensor(-0.1822, dtype=torch.float64) tensor(-0.7753, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5642, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
8 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(1.5009, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3532, dtype=torch.float64) delta_t tensor(-0.4376, dtype=torch.float64)
7 gae_duplicate tensor(-2.4934, dtype=torch.float64) tensor(7.9688, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6668, dtype=torch.float64) delta_t tensor(0.0861, dtype=torch.float64)
6 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(-0.7325, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6005, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
5 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(0.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
4 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-0.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2069, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
3 gae_duplicate tensor(-0.3817, dtype=torch.float64) tensor(0.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4088, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
2 gae_duplicate tensor(-0.1440, dtype=torch.float64) tensor(-1.6703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:67.7181396484375
value loss:12.3832368850708
entropies:347.3587341308594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.68307089805603 seconds
19 rew tensor(1.1350, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
19 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(1.6640, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1352, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
18 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-1.0558, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0584, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
17 gae_duplicate tensor(-0.0275, dtype=torch.float64) tensor(-0.8630, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7531, dtype=torch.float64) delta_t tensor(-0.2521, dtype=torch.float64)
16 gae_duplicate tensor(-1.3156, dtype=torch.float64) tensor(5.2963, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9055, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
15 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(0.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2832, dtype=torch.float64) delta_t tensor(-0.2301, dtype=torch.float64)
14 gae_duplicate tensor(-2.2114, dtype=torch.float64) tensor(5.2269, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6886, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
13 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-3.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
12 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-0.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6113, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
11 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-1.2680, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0776, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
10 gae_duplicate tensor(-0.0355, dtype=torch.float64) tensor(-2.9489, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4318, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
9 gae_duplicate tensor(0.0176, dtype=torch.float64) tensor(-1.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5757, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
8 gae_duplicate tensor(-0.1066, dtype=torch.float64) tensor(0.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1242, dtype=torch.float64) delta_t tensor(-0.3605, dtype=torch.float64)
7 gae_duplicate tensor(-1.9486, dtype=torch.float64) tensor(7.6192, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8187, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
6 gae_duplicate tensor(-0.2344, dtype=torch.float64) tensor(-0.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3194, dtype=torch.float64) delta_t tensor(0.1229, dtype=torch.float64)
5 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-2.1436, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0401, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
4 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(0.8901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9349, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
3 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(0.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
2 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(0.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-450.7425537109375
value loss:20.057266235351562
entropies:347.0863342285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741113185882568 seconds
19 rew tensor(1.1739, dtype=torch.float64) delta_t tensor(-0.0420, dtype=torch.float64)
19 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(0.7451, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1613, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
18 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-1.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8168, dtype=torch.float64) delta_t tensor(-0.2094, dtype=torch.float64)
17 gae_duplicate tensor(-1.4765, dtype=torch.float64) tensor(3.2073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0469, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(-0.3114, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9963, dtype=torch.float64) delta_t tensor(0.0293, dtype=torch.float64)
15 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(-0.5916, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5951, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
14 gae_duplicate tensor(-0.6846, dtype=torch.float64) tensor(1.5813, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7394, dtype=torch.float64) delta_t tensor(0.2031, dtype=torch.float64)
13 gae_duplicate tensor(-0.0767, dtype=torch.float64) tensor(-3.9424, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4974, dtype=torch.float64) delta_t tensor(0.2112, dtype=torch.float64)
12 gae_duplicate tensor(-0.0207, dtype=torch.float64) tensor(-3.9032, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9948, dtype=torch.float64) delta_t tensor(-1.2659, dtype=torch.float64)
11 gae_duplicate tensor(-8.0680, dtype=torch.float64) tensor(27.0262, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4803, dtype=torch.float64) delta_t tensor(-0.2606, dtype=torch.float64)
10 gae_duplicate tensor(-2.4911, dtype=torch.float64) tensor(8.8737, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3960, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
9 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(0.2494, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4118, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
8 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-2.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7297, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
7 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(-2.5874, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8209, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
6 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-2.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2418, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
5 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-2.9940, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0897, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
4 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(1.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8746, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
3 gae_duplicate tensor(-0.1866, dtype=torch.float64) tensor(-0.6775, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2299, dtype=torch.float64) delta_t tensor(-0.1775, dtype=torch.float64)
2 gae_duplicate tensor(-0.5264, dtype=torch.float64) tensor(3.1127, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1451.0760498046875
value loss:119.0571517944336
entropies:346.5538330078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6035120487213135 seconds
19 rew tensor(1.1846, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
19 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(0.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(0.1148, dtype=torch.float64)
18 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-1.9749, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
17 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-1.2489, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0708, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
16 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-1.2026, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0070, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
15 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-0.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5245, dtype=torch.float64) delta_t tensor(-0.1171, dtype=torch.float64)
14 gae_duplicate tensor(-1.3821, dtype=torch.float64) tensor(2.5956, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
13 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(-4.6555, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4086, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
12 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-3.0270, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0545, dtype=torch.float64) delta_t tensor(-0.2948, dtype=torch.float64)
11 gae_duplicate tensor(-2.1415, dtype=torch.float64) tensor(4.7492, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2590, dtype=torch.float64) delta_t tensor(-0.9941, dtype=torch.float64)
10 gae_duplicate tensor(-6.1358, dtype=torch.float64) tensor(17.2872, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0479, dtype=torch.float64) delta_t tensor(-0.2251, dtype=torch.float64)
9 gae_duplicate tensor(-2.0762, dtype=torch.float64) tensor(7.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5236, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
8 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(-0.0067, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3213, dtype=torch.float64) delta_t tensor(-0.2077, dtype=torch.float64)
7 gae_duplicate tensor(-2.1884, dtype=torch.float64) tensor(3.0842, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7547, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
6 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(-1.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5201, dtype=torch.float64) delta_t tensor(-0.1017, dtype=torch.float64)
5 gae_duplicate tensor(-0.6408, dtype=torch.float64) tensor(1.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0080, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
4 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-0.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1980, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
3 gae_duplicate tensor(-0.2694, dtype=torch.float64) tensor(2.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3403, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
2 gae_duplicate tensor(-0.3098, dtype=torch.float64) tensor(0.9179, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1562.9547119140625
value loss:87.00275421142578
entropies:345.7515869140625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3911.1829)
ToM Target loss= tensor(3958.8042)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.043848037719727 seconds
19 rew tensor(1.2237, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
19 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(1.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1985, dtype=torch.float64) delta_t tensor(0.0945, dtype=torch.float64)
18 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-1.5807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0327, dtype=torch.float64) delta_t tensor(0.0305, dtype=torch.float64)
17 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(-0.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0203, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
16 gae_duplicate tensor(-0.2446, dtype=torch.float64) tensor(0.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
15 gae_duplicate tensor(-0.3808, dtype=torch.float64) tensor(-2.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4712, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
14 gae_duplicate tensor(-0.8701, dtype=torch.float64) tensor(-0.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
13 gae_duplicate tensor(-0.0088, dtype=torch.float64) tensor(-2.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2686, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
12 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-4.6743, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3561, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
11 gae_duplicate tensor(-0.3159, dtype=torch.float64) tensor(1.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0369, dtype=torch.float64) delta_t tensor(0.1186, dtype=torch.float64)
10 gae_duplicate tensor(-0.2886, dtype=torch.float64) tensor(-2.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
9 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(-1.3536, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7138, dtype=torch.float64) delta_t tensor(-0.0295, dtype=torch.float64)
8 gae_duplicate tensor(-0.3226, dtype=torch.float64) tensor(0.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9211, dtype=torch.float64) delta_t tensor(-0.3745, dtype=torch.float64)
7 gae_duplicate tensor(-3.2218, dtype=torch.float64) tensor(6.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1774, dtype=torch.float64) delta_t tensor(-0.1265, dtype=torch.float64)
6 gae_duplicate tensor(-0.9201, dtype=torch.float64) tensor(2.8256, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0105, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
5 gae_duplicate tensor(-0.5340, dtype=torch.float64) tensor(-0.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3175, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
4 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-0.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7216, dtype=torch.float64) delta_t tensor(-0.1733, dtype=torch.float64)
3 gae_duplicate tensor(-0.3779, dtype=torch.float64) tensor(3.5152, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0110, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
2 gae_duplicate tensor(-0.3153, dtype=torch.float64) tensor(1.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-149.8098907470703
value loss:28.233461380004883
entropies:345.170166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.605846166610718 seconds
19 rew tensor(1.1469, dtype=torch.float64) delta_t tensor(-0.1680, dtype=torch.float64)
19 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(3.3218, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1472, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
18 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(0.6735, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
17 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(0.7243, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0578, dtype=torch.float64) delta_t tensor(-0.0226, dtype=torch.float64)
16 gae_duplicate tensor(-0.2623, dtype=torch.float64) tensor(0.4664, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9178, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
15 gae_duplicate tensor(-0.3995, dtype=torch.float64) tensor(-1.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5861, dtype=torch.float64) delta_t tensor(0.2001, dtype=torch.float64)
14 gae_duplicate tensor(-0.2498, dtype=torch.float64) tensor(-4.7861, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
13 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-4.4027, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0124, dtype=torch.float64) delta_t tensor(-0.2187, dtype=torch.float64)
12 gae_duplicate tensor(-1.1511, dtype=torch.float64) tensor(4.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0289, dtype=torch.float64) delta_t tensor(-0.4166, dtype=torch.float64)
11 gae_duplicate tensor(-2.7631, dtype=torch.float64) tensor(10.0440, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1939, dtype=torch.float64) delta_t tensor(0.1891, dtype=torch.float64)
10 gae_duplicate tensor(-0.0911, dtype=torch.float64) tensor(-2.4108, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4458, dtype=torch.float64) delta_t tensor(-0.0673, dtype=torch.float64)
9 gae_duplicate tensor(-0.2888, dtype=torch.float64) tensor(0.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6406, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
8 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-2.3941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7225, dtype=torch.float64) delta_t tensor(0.0746, dtype=torch.float64)
7 gae_duplicate tensor(-0.5253, dtype=torch.float64) tensor(-1.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8822, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
6 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-2.8339, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2923, dtype=torch.float64) delta_t tensor(0.0672, dtype=torch.float64)
5 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(-1.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1392, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
4 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-0.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8871, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
3 gae_duplicate tensor(-0.2780, dtype=torch.float64) tensor(0.8933, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1671, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
2 gae_duplicate tensor(-0.1779, dtype=torch.float64) tensor(0.7125, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-44.01087188720703
value loss:23.194107055664062
entropies:344.7496337890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.975344181060791 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
19 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(3.9170, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2103, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
18 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(0.4662, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1593, dtype=torch.float64) delta_t tensor(-0.0398, dtype=torch.float64)
17 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(0.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0186, dtype=torch.float64) delta_t tensor(-0.1019, dtype=torch.float64)
16 gae_duplicate tensor(-0.2990, dtype=torch.float64) tensor(2.1604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5443, dtype=torch.float64) delta_t tensor(-0.4839, dtype=torch.float64)
15 gae_duplicate tensor(-2.9238, dtype=torch.float64) tensor(10.7466, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5104, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
14 gae_duplicate tensor(-1.7878, dtype=torch.float64) tensor(2.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2733, dtype=torch.float64) delta_t tensor(-0.6963, dtype=torch.float64)
13 gae_duplicate tensor(-4.0669, dtype=torch.float64) tensor(15.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2402, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
12 gae_duplicate tensor(-0.3299, dtype=torch.float64) tensor(1.1011, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6248, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
11 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-1.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0907, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
10 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(-2.3937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4697, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
9 gae_duplicate tensor(-0.0684, dtype=torch.float64) tensor(-2.1209, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7026, dtype=torch.float64) delta_t tensor(-0.1626, dtype=torch.float64)
8 gae_duplicate tensor(-0.4540, dtype=torch.float64) tensor(2.8731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2402, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
7 gae_duplicate tensor(-1.8017, dtype=torch.float64) tensor(1.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8563, dtype=torch.float64) delta_t tensor(0.1944, dtype=torch.float64)
6 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-3.4989, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4177, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
5 gae_duplicate tensor(0.0996, dtype=torch.float64) tensor(-5.7768, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1380, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
4 gae_duplicate tensor(-0.2038, dtype=torch.float64) tensor(-0.5162, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3147, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-0.7463, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4827, dtype=torch.float64) delta_t tensor(0.0781, dtype=torch.float64)
2 gae_duplicate tensor(-0.3071, dtype=torch.float64) tensor(-1.8179, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1350.4013671875
value loss:58.013973236083984
entropies:344.3811950683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.763966083526611 seconds
19 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(-0.1708, dtype=torch.float64)
19 gae_duplicate tensor(-0.2469, dtype=torch.float64) tensor(3.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2102, dtype=torch.float64) delta_t tensor(-0.0008, dtype=torch.float64)
18 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(0.4789, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1077, dtype=torch.float64) delta_t tensor(-0.0490, dtype=torch.float64)
17 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(0.8564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7907, dtype=torch.float64) delta_t tensor(-0.2991, dtype=torch.float64)
16 gae_duplicate tensor(-1.3175, dtype=torch.float64) tensor(6.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9424, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
15 gae_duplicate tensor(-0.2003, dtype=torch.float64) tensor(2.3081, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7511, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
14 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(-5.0334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6752, dtype=torch.float64) delta_t tensor(0.2642, dtype=torch.float64)
13 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-5.3971, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3051, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
12 gae_duplicate tensor(-0.2291, dtype=torch.float64) tensor(-0.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4578, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
11 gae_duplicate tensor(-0.2960, dtype=torch.float64) tensor(-0.0587, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1157, dtype=torch.float64) delta_t tensor(0.0508, dtype=torch.float64)
10 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-0.9467, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4057, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
9 gae_duplicate tensor(-0.3352, dtype=torch.float64) tensor(0.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7401, dtype=torch.float64) delta_t tensor(-0.0383, dtype=torch.float64)
8 gae_duplicate tensor(-0.2240, dtype=torch.float64) tensor(0.9805, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2841, dtype=torch.float64) delta_t tensor(0.0483, dtype=torch.float64)
7 gae_duplicate tensor(-0.2981, dtype=torch.float64) tensor(-0.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9057, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
6 gae_duplicate tensor(-0.1043, dtype=torch.float64) tensor(-1.8427, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4178, dtype=torch.float64) delta_t tensor(0.3417, dtype=torch.float64)
5 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-6.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
4 gae_duplicate tensor(-0.0452, dtype=torch.float64) tensor(-1.9161, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3896, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
3 gae_duplicate tensor(-0.0139, dtype=torch.float64) tensor(-2.1778, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5329, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
2 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(-3.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:631.3968505859375
value loss:12.015456199645996
entropies:343.59149169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.692166090011597 seconds
19 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(-0.0940, dtype=torch.float64)
19 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(1.8668, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1601, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
18 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(-0.3879, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0196, dtype=torch.float64) delta_t tensor(-0.0873, dtype=torch.float64)
17 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(1.9064, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(-0.1123, dtype=torch.float64)
16 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(2.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6237, dtype=torch.float64) delta_t tensor(-0.2458, dtype=torch.float64)
15 gae_duplicate tensor(-1.5292, dtype=torch.float64) tensor(5.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(-0.3748, dtype=torch.float64)
14 gae_duplicate tensor(-1.4008, dtype=torch.float64) tensor(7.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3015, dtype=torch.float64) delta_t tensor(-0.1809, dtype=torch.float64)
13 gae_duplicate tensor(-1.3737, dtype=torch.float64) tensor(5.0069, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4204, dtype=torch.float64) delta_t tensor(0.1659, dtype=torch.float64)
12 gae_duplicate tensor(-0.0920, dtype=torch.float64) tensor(-2.7660, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
11 gae_duplicate tensor(-0.2932, dtype=torch.float64) tensor(-1.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0632, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
10 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(-2.7609, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
9 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(1.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5241, dtype=torch.float64) delta_t tensor(0.1092, dtype=torch.float64)
8 gae_duplicate tensor(-0.2766, dtype=torch.float64) tensor(-1.5672, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7165, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
7 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(-0.7722, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6263, dtype=torch.float64) delta_t tensor(0.3031, dtype=torch.float64)
6 gae_duplicate tensor(-0.0365, dtype=torch.float64) tensor(-5.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5968, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
5 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-2.0082, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
4 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-0.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0866, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
3 gae_duplicate tensor(-0.0491, dtype=torch.float64) tensor(-0.7826, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
2 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(-0.0611, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-443.4403076171875
value loss:17.60855484008789
entropies:342.9127197265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3880.1035)
ToM Target loss= tensor(3951.1829)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.7588417530059814 seconds
19 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(-0.0839, dtype=torch.float64)
19 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(1.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0962, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
18 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-0.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9559, dtype=torch.float64) delta_t tensor(-0.0633, dtype=torch.float64)
17 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(1.2763, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9432, dtype=torch.float64) delta_t tensor(-0.0588, dtype=torch.float64)
16 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(1.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
15 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(0.9190, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(-0.1366, dtype=torch.float64)
14 gae_duplicate tensor(-0.2469, dtype=torch.float64) tensor(2.5474, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6239, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
13 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(-0.5541, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(-0.0911, dtype=torch.float64)
12 gae_duplicate tensor(-0.2377, dtype=torch.float64) tensor(1.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3312, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
11 gae_duplicate tensor(-0.2476, dtype=torch.float64) tensor(2.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0995, dtype=torch.float64) delta_t tensor(0.1680, dtype=torch.float64)
10 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-3.5439, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2546, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
9 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(-1.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4100, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
8 gae_duplicate tensor(-0.4154, dtype=torch.float64) tensor(1.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7421, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
7 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(0.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6641, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
6 gae_duplicate tensor(-0.2405, dtype=torch.float64) tensor(-1.7808, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3179, dtype=torch.float64) delta_t tensor(-0.0649, dtype=torch.float64)
5 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(0.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1911, dtype=torch.float64) delta_t tensor(-0.1099, dtype=torch.float64)
4 gae_duplicate tensor(-0.4140, dtype=torch.float64) tensor(2.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6932, dtype=torch.float64) delta_t tensor(0.0214, dtype=torch.float64)
3 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(-0.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1536, dtype=torch.float64) delta_t tensor(-0.1936, dtype=torch.float64)
2 gae_duplicate tensor(-0.5826, dtype=torch.float64) tensor(3.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-700.7455444335938
value loss:6.451229095458984
entropies:341.88458251953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.740410089492798 seconds
19 rew tensor(1.2110, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
19 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(1.5357, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2239, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
18 gae_duplicate tensor(0.0160, dtype=torch.float64) tensor(-2.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0966, dtype=torch.float64) delta_t tensor(0.0141, dtype=torch.float64)
17 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(-0.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0712, dtype=torch.float64) delta_t tensor(0.0648, dtype=torch.float64)
16 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(-1.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
15 gae_duplicate tensor(-0.3664, dtype=torch.float64) tensor(-2.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3414, dtype=torch.float64) delta_t tensor(-0.1015, dtype=torch.float64)
14 gae_duplicate tensor(-1.4977, dtype=torch.float64) tensor(0.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3182, dtype=torch.float64) delta_t tensor(-0.1950, dtype=torch.float64)
13 gae_duplicate tensor(-1.2988, dtype=torch.float64) tensor(4.6951, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2269, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
12 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(-0.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4848, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
11 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-2.7956, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0779, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
10 gae_duplicate tensor(-0.2486, dtype=torch.float64) tensor(-2.6725, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5728, dtype=torch.float64) delta_t tensor(0.1400, dtype=torch.float64)
9 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-2.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(0.0491, dtype=torch.float64)
8 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(-0.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1773, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
7 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(1.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0371, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
6 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(-0.3291, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9554, dtype=torch.float64) delta_t tensor(0.0983, dtype=torch.float64)
5 gae_duplicate tensor(-0.0806, dtype=torch.float64) tensor(-2.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4258, dtype=torch.float64) delta_t tensor(-0.0648, dtype=torch.float64)
4 gae_duplicate tensor(-0.2930, dtype=torch.float64) tensor(1.2563, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4053, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
3 gae_duplicate tensor(-0.2487, dtype=torch.float64) tensor(-1.8591, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0810, dtype=torch.float64) delta_t tensor(-0.1269, dtype=torch.float64)
2 gae_duplicate tensor(-0.4182, dtype=torch.float64) tensor(2.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:387.2674865722656
value loss:11.890732765197754
entropies:340.9610290527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.895350933074951 seconds
19 rew tensor(1.1726, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
19 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(0.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1599, dtype=torch.float64) delta_t tensor(0.0823, dtype=torch.float64)
18 gae_duplicate tensor(-0.0296, dtype=torch.float64) tensor(-1.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1341, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
17 gae_duplicate tensor(0.0108, dtype=torch.float64) tensor(-1.6922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0061, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
16 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-0.9270, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6610, dtype=torch.float64) delta_t tensor(-0.1632, dtype=torch.float64)
15 gae_duplicate tensor(-1.6987, dtype=torch.float64) tensor(2.1497, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
14 gae_duplicate tensor(-0.2323, dtype=torch.float64) tensor(-2.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2057, dtype=torch.float64) delta_t tensor(-0.1708, dtype=torch.float64)
13 gae_duplicate tensor(-2.3756, dtype=torch.float64) tensor(4.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0005, dtype=torch.float64) delta_t tensor(-0.1383, dtype=torch.float64)
12 gae_duplicate tensor(-2.3817, dtype=torch.float64) tensor(0.9359, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0477, dtype=torch.float64) delta_t tensor(-0.3462, dtype=torch.float64)
11 gae_duplicate tensor(-1.3159, dtype=torch.float64) tensor(7.1183, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0147, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
10 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-3.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(0.1299, dtype=torch.float64)
9 gae_duplicate tensor(-0.0146, dtype=torch.float64) tensor(-2.8751, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6401, dtype=torch.float64) delta_t tensor(-0.1028, dtype=torch.float64)
8 gae_duplicate tensor(-0.3154, dtype=torch.float64) tensor(1.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1594, dtype=torch.float64) delta_t tensor(-0.3714, dtype=torch.float64)
7 gae_duplicate tensor(-2.1644, dtype=torch.float64) tensor(6.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8187, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
6 gae_duplicate tensor(-0.2770, dtype=torch.float64) tensor(-1.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4429, dtype=torch.float64) delta_t tensor(0.1778, dtype=torch.float64)
5 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-3.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0109, dtype=torch.float64) delta_t tensor(-0.0725, dtype=torch.float64)
4 gae_duplicate tensor(-0.1484, dtype=torch.float64) tensor(1.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1748, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
3 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(-0.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3556, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
2 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(-1.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-423.15631103515625
value loss:41.31150817871094
entropies:340.4517822265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.650874137878418 seconds
19 rew tensor(1.2362, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
19 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(0.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2237, dtype=torch.float64) delta_t tensor(0.1754, dtype=torch.float64)
18 gae_duplicate tensor(0.0522, dtype=torch.float64) tensor(-3.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0453, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
17 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-0.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0203, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
16 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-0.5588, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9058, dtype=torch.float64) delta_t tensor(-0.0718, dtype=torch.float64)
15 gae_duplicate tensor(-0.2980, dtype=torch.float64) tensor(1.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9053, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
14 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(-1.7818, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6641, dtype=torch.float64) delta_t tensor(0.2314, dtype=torch.float64)
13 gae_duplicate tensor(0.0607, dtype=torch.float64) tensor(-3.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0198, dtype=torch.float64) delta_t tensor(-0.2873, dtype=torch.float64)
12 gae_duplicate tensor(-2.2009, dtype=torch.float64) tensor(6.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7146, dtype=torch.float64) delta_t tensor(-0.9741, dtype=torch.float64)
11 gae_duplicate tensor(-5.6898, dtype=torch.float64) tensor(16.4220, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2090, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
10 gae_duplicate tensor(-1.2259, dtype=torch.float64) tensor(3.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
9 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-1.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5761, dtype=torch.float64) delta_t tensor(-0.0554, dtype=torch.float64)
8 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(0.6152, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9430, dtype=torch.float64) delta_t tensor(0.1786, dtype=torch.float64)
7 gae_duplicate tensor(-0.2739, dtype=torch.float64) tensor(-2.8300, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8963, dtype=torch.float64) delta_t tensor(-0.1115, dtype=torch.float64)
6 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(1.8936, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4676, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
5 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-3.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1375, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
4 gae_duplicate tensor(-0.2336, dtype=torch.float64) tensor(0.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3533, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
3 gae_duplicate tensor(-0.0741, dtype=torch.float64) tensor(-0.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4821, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
2 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(-0.7676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-706.9282836914062
value loss:63.850807189941406
entropies:340.3511047363281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7286341190338135 seconds
19 rew tensor(1.1591, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
19 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-0.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1464, dtype=torch.float64) delta_t tensor(0.1615, dtype=torch.float64)
18 gae_duplicate tensor(0.0515, dtype=torch.float64) tensor(-3.1549, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1338, dtype=torch.float64) delta_t tensor(0.1605, dtype=torch.float64)
17 gae_duplicate tensor(0.1156, dtype=torch.float64) tensor(-3.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.5225, dtype=torch.float64) delta_t tensor(-0.4296, dtype=torch.float64)
16 gae_duplicate tensor(-1.3887, dtype=torch.float64) tensor(8.0343, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9681, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
15 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-1.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7763, dtype=torch.float64) delta_t tensor(0.2090, dtype=torch.float64)
14 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-3.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7777, dtype=torch.float64) delta_t tensor(0.1760, dtype=torch.float64)
13 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(-3.2191, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3294, dtype=torch.float64) delta_t tensor(-0.0516, dtype=torch.float64)
12 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(0.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0092, dtype=torch.float64) delta_t tensor(-0.3184, dtype=torch.float64)
11 gae_duplicate tensor(-2.2614, dtype=torch.float64) tensor(7.5231, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2555, dtype=torch.float64) delta_t tensor(-0.0003, dtype=torch.float64)
10 gae_duplicate tensor(-0.4414, dtype=torch.float64) tensor(0.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
9 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(0.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5624, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
8 gae_duplicate tensor(-0.1092, dtype=torch.float64) tensor(-0.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9856, dtype=torch.float64) delta_t tensor(-0.3054, dtype=torch.float64)
7 gae_duplicate tensor(-1.9813, dtype=torch.float64) tensor(4.8399, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7155, dtype=torch.float64) delta_t tensor(-0.0084, dtype=torch.float64)
6 gae_duplicate tensor(-0.3584, dtype=torch.float64) tensor(0.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3928, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
5 gae_duplicate tensor(-0.6162, dtype=torch.float64) tensor(1.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0900, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
4 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(1.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8829, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
3 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(1.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
2 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(0.3450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-690.6586303710938
value loss:24.466960906982422
entropies:340.1708984375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3868.5945)
ToM Target loss= tensor(3956.0789)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8905348777771 seconds
19 rew tensor(1.1724, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
19 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-0.2870, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1852, dtype=torch.float64) delta_t tensor(0.1702, dtype=torch.float64)
18 gae_duplicate tensor(0.1150, dtype=torch.float64) tensor(-3.4757, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1217, dtype=torch.float64) delta_t tensor(0.1257, dtype=torch.float64)
17 gae_duplicate tensor(0.0547, dtype=torch.float64) tensor(-2.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.1342, dtype=torch.float64)
16 gae_duplicate tensor(0.0223, dtype=torch.float64) tensor(-2.7040, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8792, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
15 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(-4.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5345, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
14 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-2.9020, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.2170, dtype=torch.float64)
13 gae_duplicate tensor(0.0543, dtype=torch.float64) tensor(-4.6519, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4450, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
12 gae_duplicate tensor(-0.1386, dtype=torch.float64) tensor(-3.1510, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1340, dtype=torch.float64) delta_t tensor(-0.3702, dtype=torch.float64)
11 gae_duplicate tensor(-2.4070, dtype=torch.float64) tensor(8.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0390, dtype=torch.float64) delta_t tensor(0.1349, dtype=torch.float64)
10 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-2.0269, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
9 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-2.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6529, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
8 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(0.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8780, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
7 gae_duplicate tensor(-0.0072, dtype=torch.float64) tensor(-2.4221, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7549, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
6 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5692, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
5 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(-0.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1115, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
4 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-0.7297, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3007, dtype=torch.float64) delta_t tensor(-0.1341, dtype=torch.float64)
3 gae_duplicate tensor(-0.3111, dtype=torch.float64) tensor(2.4741, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4558, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
2 gae_duplicate tensor(-0.1949, dtype=torch.float64) tensor(-0.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1008.2943725585938
value loss:15.02658748626709
entropies:340.13702392578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.704250812530518 seconds
19 rew tensor(1.1719, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
19 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-0.6566, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.1863, dtype=torch.float64)
18 gae_duplicate tensor(0.1054, dtype=torch.float64) tensor(-3.5075, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1212, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
17 gae_duplicate tensor(0.0773, dtype=torch.float64) tensor(-4.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9808, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
16 gae_duplicate tensor(-0.1161, dtype=torch.float64) tensor(-3.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.2609, dtype=torch.float64)
15 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-4.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(-0.1451, dtype=torch.float64)
14 gae_duplicate tensor(-1.5981, dtype=torch.float64) tensor(1.8432, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1160, dtype=torch.float64) delta_t tensor(-0.5291, dtype=torch.float64)
13 gae_duplicate tensor(-4.0658, dtype=torch.float64) tensor(8.7919, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5087, dtype=torch.float64) delta_t tensor(0.1890, dtype=torch.float64)
12 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(-2.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4083, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
11 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(-1.2065, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3173, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
10 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-4.8527, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1148, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
9 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-1.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4100, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
8 gae_duplicate tensor(-0.2527, dtype=torch.float64) tensor(-0.2266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6333, dtype=torch.float64) delta_t tensor(-0.5594, dtype=torch.float64)
7 gae_duplicate tensor(-3.2566, dtype=torch.float64) tensor(12.2729, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7429, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
6 gae_duplicate tensor(-1.1088, dtype=torch.float64) tensor(2.9246, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4920, dtype=torch.float64) delta_t tensor(0.1479, dtype=torch.float64)
5 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-2.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1633, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
4 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(-0.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2888, dtype=torch.float64) delta_t tensor(-0.1997, dtype=torch.float64)
3 gae_duplicate tensor(-0.4652, dtype=torch.float64) tensor(3.6839, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5204, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
2 gae_duplicate tensor(-0.3159, dtype=torch.float64) tensor(-0.9067, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-43.6632080078125
value loss:57.22501754760742
entropies:340.2470397949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.860964059829712 seconds
19 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
19 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-0.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
18 gae_duplicate tensor(0.0935, dtype=torch.float64) tensor(-2.9938, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0574, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
17 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-2.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0446, dtype=torch.float64) delta_t tensor(0.1233, dtype=torch.float64)
16 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-2.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9560, dtype=torch.float64) delta_t tensor(0.1539, dtype=torch.float64)
15 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-3.1825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2004, dtype=torch.float64) delta_t tensor(-0.2480, dtype=torch.float64)
14 gae_duplicate tensor(-2.2023, dtype=torch.float64) tensor(5.4722, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.1344, dtype=torch.float64)
13 gae_duplicate tensor(-0.0572, dtype=torch.float64) tensor(-2.3813, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
12 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-0.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0886, dtype=torch.float64) delta_t tensor(-0.3470, dtype=torch.float64)
11 gae_duplicate tensor(-2.1765, dtype=torch.float64) tensor(7.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2304, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
10 gae_duplicate tensor(-0.7735, dtype=torch.float64) tensor(1.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3430, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
9 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(0.0231, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4719, dtype=torch.float64) delta_t tensor(-0.0484, dtype=torch.float64)
8 gae_duplicate tensor(-0.2216, dtype=torch.float64) tensor(1.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4343, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
7 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(0.6780, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7547, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
6 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-0.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2880, dtype=torch.float64) delta_t tensor(-0.1514, dtype=torch.float64)
5 gae_duplicate tensor(-0.4331, dtype=torch.float64) tensor(2.9694, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2194, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
4 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(0.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6364, dtype=torch.float64) delta_t tensor(-0.0726, dtype=torch.float64)
3 gae_duplicate tensor(-0.2301, dtype=torch.float64) tensor(1.2709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0473, dtype=torch.float64) delta_t tensor(-0.1564, dtype=torch.float64)
2 gae_duplicate tensor(-0.5970, dtype=torch.float64) tensor(3.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-674.474609375
value loss:19.474760055541992
entropies:340.2043151855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.785468816757202 seconds
19 rew tensor(1.1721, dtype=torch.float64) delta_t tensor(0.0251, dtype=torch.float64)
19 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-0.5240, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1086, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
18 gae_duplicate tensor(0.0483, dtype=torch.float64) tensor(-2.0856, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0194, dtype=torch.float64) delta_t tensor(0.0878, dtype=torch.float64)
17 gae_duplicate tensor(-0.0885, dtype=torch.float64) tensor(-2.0751, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0448, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
16 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-1.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8799, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
15 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-2.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2269, dtype=torch.float64) delta_t tensor(-0.2211, dtype=torch.float64)
14 gae_duplicate tensor(-1.1782, dtype=torch.float64) tensor(5.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4827, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
13 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-2.3782, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(0.1214, dtype=torch.float64)
12 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-2.0862, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4322, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
11 gae_duplicate tensor(-0.1248, dtype=torch.float64) tensor(-1.9303, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
10 gae_duplicate tensor(-0.1629, dtype=torch.float64) tensor(-0.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
9 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-0.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3455, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
8 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(0.1383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2392, dtype=torch.float64) delta_t tensor(-0.0831, dtype=torch.float64)
7 gae_duplicate tensor(-0.4625, dtype=torch.float64) tensor(1.8247, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4732, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
6 gae_duplicate tensor(-0.1290, dtype=torch.float64) tensor(-1.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8003, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
5 gae_duplicate tensor(-0.3553, dtype=torch.float64) tensor(1.1396, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2412, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
4 gae_duplicate tensor(-0.1383, dtype=torch.float64) tensor(1.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3800, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
3 gae_duplicate tensor(-0.1801, dtype=torch.float64) tensor(0.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5981, dtype=torch.float64) delta_t tensor(-0.0707, dtype=torch.float64)
2 gae_duplicate tensor(-0.2162, dtype=torch.float64) tensor(1.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:193.0696258544922
value loss:6.985179901123047
entropies:339.7166748046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.791409015655518 seconds
19 rew tensor(1.2229, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
19 gae_duplicate tensor(-0.0855, dtype=torch.float64) tensor(0.1477, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1842, dtype=torch.float64) delta_t tensor(0.1137, dtype=torch.float64)
18 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-2.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1078, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
17 gae_duplicate tensor(0.0322, dtype=torch.float64) tensor(-1.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0572, dtype=torch.float64) delta_t tensor(0.1134, dtype=torch.float64)
16 gae_duplicate tensor(-0.0194, dtype=torch.float64) tensor(-2.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9166, dtype=torch.float64) delta_t tensor(0.0420, dtype=torch.float64)
15 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(-0.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5627, dtype=torch.float64) delta_t tensor(-0.0688, dtype=torch.float64)
14 gae_duplicate tensor(-1.1194, dtype=torch.float64) tensor(1.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0114, dtype=torch.float64) delta_t tensor(-0.3250, dtype=torch.float64)
13 gae_duplicate tensor(-1.3674, dtype=torch.float64) tensor(6.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0746, dtype=torch.float64) delta_t tensor(-0.1772, dtype=torch.float64)
12 gae_duplicate tensor(-2.3965, dtype=torch.float64) tensor(5.5006, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4306, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
11 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-1.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0129, dtype=torch.float64) delta_t tensor(0.1407, dtype=torch.float64)
10 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-2.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4430, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
9 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-3.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5990, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
8 gae_duplicate tensor(-0.3366, dtype=torch.float64) tensor(1.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8824, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
7 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(-3.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7267, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
6 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-0.4351, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5461, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
5 gae_duplicate tensor(-0.2552, dtype=torch.float64) tensor(-1.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1642, dtype=torch.float64) delta_t tensor(-0.0114, dtype=torch.float64)
4 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(0.0682, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2893, dtype=torch.float64) delta_t tensor(-0.0509, dtype=torch.float64)
3 gae_duplicate tensor(-0.2797, dtype=torch.float64) tensor(0.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
2 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(1.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:95.33318328857422
value loss:21.56314468383789
entropies:339.1289978027344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3822.4839)
ToM Target loss= tensor(3954.6675)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.100171804428101 seconds
19 rew tensor(1.0954, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
19 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(1.0169, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
18 gae_duplicate tensor(-0.0066, dtype=torch.float64) tensor(-1.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
17 gae_duplicate tensor(-0.0076, dtype=torch.float64) tensor(-0.8784, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
16 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.1368, dtype=torch.float64)
15 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-2.9121, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7751, dtype=torch.float64) delta_t tensor(0.0292, dtype=torch.float64)
14 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-1.0129, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1227, dtype=torch.float64) delta_t tensor(-0.6018, dtype=torch.float64)
13 gae_duplicate tensor(-3.7978, dtype=torch.float64) tensor(9.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1138, dtype=torch.float64) delta_t tensor(-0.1262, dtype=torch.float64)
12 gae_duplicate tensor(-1.1035, dtype=torch.float64) tensor(2.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2566, dtype=torch.float64) delta_t tensor(-0.1982, dtype=torch.float64)
11 gae_duplicate tensor(-1.2838, dtype=torch.float64) tensor(5.0768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0613, dtype=torch.float64) delta_t tensor(0.1864, dtype=torch.float64)
10 gae_duplicate tensor(0.0145, dtype=torch.float64) tensor(-3.1859, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4594, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
9 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(-1.8414, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6788, dtype=torch.float64) delta_t tensor(-0.0680, dtype=torch.float64)
8 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(1.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3799, dtype=torch.float64) delta_t tensor(-0.1319, dtype=torch.float64)
7 gae_duplicate tensor(-0.2655, dtype=torch.float64) tensor(2.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7293, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
6 gae_duplicate tensor(-0.0142, dtype=torch.float64) tensor(-0.8435, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2875, dtype=torch.float64) delta_t tensor(-0.0141, dtype=torch.float64)
5 gae_duplicate tensor(-0.2439, dtype=torch.float64) tensor(-0.2761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1439, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
4 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(0.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7379, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
3 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(0.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2261, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
2 gae_duplicate tensor(-0.2554, dtype=torch.float64) tensor(0.4991, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-674.8685302734375
value loss:28.89690589904785
entropies:338.263427734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.043251991271973 seconds
19 rew tensor(1.1343, dtype=torch.float64) delta_t tensor(-0.0239, dtype=torch.float64)
19 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(0.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
18 gae_duplicate tensor(-0.0243, dtype=torch.float64) tensor(-1.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0704, dtype=torch.float64) delta_t tensor(0.0366, dtype=torch.float64)
17 gae_duplicate tensor(-0.0614, dtype=torch.float64) tensor(-0.9952, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0197, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
16 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-0.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6848, dtype=torch.float64) delta_t tensor(-0.1702, dtype=torch.float64)
15 gae_duplicate tensor(-1.3007, dtype=torch.float64) tensor(2.8378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6374, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
14 gae_duplicate tensor(-0.1521, dtype=torch.float64) tensor(-0.2204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4846, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
13 gae_duplicate tensor(-1.0281, dtype=torch.float64) tensor(1.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2153, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
12 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-0.2206, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1395, dtype=torch.float64) delta_t tensor(-0.1515, dtype=torch.float64)
11 gae_duplicate tensor(-0.9901, dtype=torch.float64) tensor(3.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0269, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
10 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-1.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.1751, dtype=torch.float64)
9 gae_duplicate tensor(0.0760, dtype=torch.float64) tensor(-3.2966, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6518, dtype=torch.float64) delta_t tensor(-0.0501, dtype=torch.float64)
8 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(0.5525, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4897, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
7 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(-0.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7543, dtype=torch.float64) delta_t tensor(0.0889, dtype=torch.float64)
6 gae_duplicate tensor(-0.0073, dtype=torch.float64) tensor(-1.8046, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3681, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
5 gae_duplicate tensor(-0.1780, dtype=torch.float64) tensor(1.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1652, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
4 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(-0.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8222, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
3 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(2.2739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1919, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
2 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(-0.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-156.9239501953125
value loss:9.154454231262207
entropies:337.7418518066406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.844472169876099 seconds
19 rew tensor(1.0960, dtype=torch.float64) delta_t tensor(-0.0846, dtype=torch.float64)
19 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(1.6682, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0956, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
18 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-1.2624, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9557, dtype=torch.float64) delta_t tensor(-0.0361, dtype=torch.float64)
17 gae_duplicate tensor(-0.1163, dtype=torch.float64) tensor(0.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8793, dtype=torch.float64) delta_t tensor(-0.0835, dtype=torch.float64)
16 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(1.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
15 gae_duplicate tensor(-0.2037, dtype=torch.float64) tensor(0.4399, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6504, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
14 gae_duplicate tensor(-0.0966, dtype=torch.float64) tensor(0.2390, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6618, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
13 gae_duplicate tensor(-0.1083, dtype=torch.float64) tensor(-0.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(-0.0725, dtype=torch.float64)
12 gae_duplicate tensor(-0.2708, dtype=torch.float64) tensor(0.7825, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5982, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
11 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-0.8714, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1290, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
10 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(1.1438, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4705, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
9 gae_duplicate tensor(-0.0924, dtype=torch.float64) tensor(-2.0532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6508, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
8 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(1.4953, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1423, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
7 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(0.9169, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8059, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
6 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(-1.7121, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1110, dtype=torch.float64) delta_t tensor(-0.0482, dtype=torch.float64)
5 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(0.8518, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3464, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
4 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(0.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4222, dtype=torch.float64) delta_t tensor(-0.0090, dtype=torch.float64)
3 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(0.4748, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0236, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
2 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(0.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-338.8150939941406
value loss:2.5305862426757812
entropies:337.040283203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.851871013641357 seconds
19 rew tensor(1.1855, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
19 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(1.8919, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1473, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
18 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-0.3132, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8496, dtype=torch.float64) delta_t tensor(-0.2269, dtype=torch.float64)
17 gae_duplicate tensor(-1.3952, dtype=torch.float64) tensor(3.5740, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0196, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
16 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
15 gae_duplicate tensor(-0.3497, dtype=torch.float64) tensor(0.7595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(0.2994, dtype=torch.float64)
14 gae_duplicate tensor(-0.0294, dtype=torch.float64) tensor(-6.5325, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3194, dtype=torch.float64) delta_t tensor(-0.1078, dtype=torch.float64)
13 gae_duplicate tensor(-0.9760, dtype=torch.float64) tensor(2.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2286, dtype=torch.float64) delta_t tensor(0.1838, dtype=torch.float64)
12 gae_duplicate tensor(0.0198, dtype=torch.float64) tensor(-3.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
11 gae_duplicate tensor(-0.0016, dtype=torch.float64) tensor(-1.1573, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1032, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
10 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-1.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5346, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
9 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-0.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6520, dtype=torch.float64) delta_t tensor(-0.0318, dtype=torch.float64)
8 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(0.6495, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3829, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
7 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-0.4830, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8437, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
6 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-2.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2644, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
5 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-0.7204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2197, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
4 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(0.0801, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7655, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
3 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(-0.3575, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0865, dtype=torch.float64) delta_t tensor(-0.1628, dtype=torch.float64)
2 gae_duplicate tensor(-0.3467, dtype=torch.float64) tensor(3.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:102.94991302490234
value loss:9.004359245300293
entropies:336.3119812011719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.614078760147095 seconds
19 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
19 gae_duplicate tensor(-0.1036, dtype=torch.float64) tensor(0.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1600, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
18 gae_duplicate tensor(-0.0993, dtype=torch.float64) tensor(-0.9727, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0969, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
17 gae_duplicate tensor(-0.0747, dtype=torch.float64) tensor(-0.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7619, dtype=torch.float64) delta_t tensor(-0.2106, dtype=torch.float64)
16 gae_duplicate tensor(-1.2557, dtype=torch.float64) tensor(3.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
15 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(0.7300, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
14 gae_duplicate tensor(-1.1013, dtype=torch.float64) tensor(1.1987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(-0.1275, dtype=torch.float64)
13 gae_duplicate tensor(-1.2833, dtype=torch.float64) tensor(1.6904, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2392, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
12 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(-0.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5359, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
11 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-2.7937, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0348, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
10 gae_duplicate tensor(-0.2058, dtype=torch.float64) tensor(0.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3190, dtype=torch.float64) delta_t tensor(0.1150, dtype=torch.float64)
9 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(-1.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6659, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
8 gae_duplicate tensor(-0.2539, dtype=torch.float64) tensor(0.6365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8094, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
7 gae_duplicate tensor(-0.7227, dtype=torch.float64) tensor(0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8966, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
6 gae_duplicate tensor(0.0136, dtype=torch.float64) tensor(-3.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2392, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
5 gae_duplicate tensor(-0.3389, dtype=torch.float64) tensor(0.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1674, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
4 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-1.0662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8327, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
3 gae_duplicate tensor(-0.3353, dtype=torch.float64) tensor(-0.7702, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
2 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-1.0546, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:98.33328247070312
value loss:12.776220321655273
entropies:335.46490478515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3878.6697)
ToM Target loss= tensor(3959.9448)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.869841814041138 seconds
19 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(-0.1124, dtype=torch.float64)
19 gae_duplicate tensor(-0.2031, dtype=torch.float64) tensor(2.1775, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
18 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-0.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
17 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(0.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9308, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
16 gae_duplicate tensor(-0.2180, dtype=torch.float64) tensor(0.7309, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8666, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
15 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(-0.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5993, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
14 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(-1.0218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6622, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
13 gae_duplicate tensor(-0.0341, dtype=torch.float64) tensor(-2.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2797, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
12 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(0.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(0.0155, dtype=torch.float64)
11 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-0.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1669, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
10 gae_duplicate tensor(-0.0734, dtype=torch.float64) tensor(-0.4168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4195, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
9 gae_duplicate tensor(-0.2302, dtype=torch.float64) tensor(0.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5879, dtype=torch.float64) delta_t tensor(-0.0084, dtype=torch.float64)
8 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(0.0308, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6279, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
7 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(0.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6518, dtype=torch.float64) delta_t tensor(0.1270, dtype=torch.float64)
6 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-2.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4448, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
5 gae_duplicate tensor(-0.1142, dtype=torch.float64) tensor(-0.6968, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0143, dtype=torch.float64) delta_t tensor(0.0136, dtype=torch.float64)
4 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-0.5060, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9464, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
3 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-0.3266, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3432, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
2 gae_duplicate tensor(-0.1512, dtype=torch.float64) tensor(-0.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:167.03683471679688
value loss:3.019178867340088
entropies:335.11517333984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.925893068313599 seconds
19 rew tensor(1.1857, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
19 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(1.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1859, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
18 gae_duplicate tensor(-0.0347, dtype=torch.float64) tensor(-1.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0074, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
17 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(0.8954, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0204, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
16 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(0.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8931, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
15 gae_duplicate tensor(-0.2900, dtype=torch.float64) tensor(-2.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1500, dtype=torch.float64) delta_t tensor(-0.4045, dtype=torch.float64)
14 gae_duplicate tensor(-1.4383, dtype=torch.float64) tensor(6.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5725, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
13 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(-0.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
12 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(0.3240, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4852, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
11 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-1.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0676, dtype=torch.float64) delta_t tensor(0.1795, dtype=torch.float64)
10 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-2.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5997, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
9 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-2.4651, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6787, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
8 gae_duplicate tensor(-0.1261, dtype=torch.float64) tensor(-1.3593, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1686, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
7 gae_duplicate tensor(-0.1449, dtype=torch.float64) tensor(-0.0879, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0103, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
6 gae_duplicate tensor(-0.1010, dtype=torch.float64) tensor(-1.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9089, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
5 gae_duplicate tensor(-0.3897, dtype=torch.float64) tensor(-0.2143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3834, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
4 gae_duplicate tensor(-0.0765, dtype=torch.float64) tensor(-0.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3106, dtype=torch.float64) delta_t tensor(0.0679, dtype=torch.float64)
3 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(-1.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0893, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
2 gae_duplicate tensor(-0.5657, dtype=torch.float64) tensor(0.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:205.35948181152344
value loss:10.529839515686035
entropies:334.9169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.610231876373291 seconds
19 rew tensor(1.2615, dtype=torch.float64) delta_t tensor(-0.0996, dtype=torch.float64)
19 gae_duplicate tensor(-0.1599, dtype=torch.float64) tensor(1.6900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2617, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
18 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-1.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2363, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
17 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-2.1276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8803, dtype=torch.float64) delta_t tensor(-0.2419, dtype=torch.float64)
16 gae_duplicate tensor(-1.4344, dtype=torch.float64) tensor(5.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0583, dtype=torch.float64) delta_t tensor(0.2151, dtype=torch.float64)
15 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-3.9337, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5993, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
14 gae_duplicate tensor(-0.7158, dtype=torch.float64) tensor(-1.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6111, dtype=torch.float64) delta_t tensor(0.2261, dtype=torch.float64)
13 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-4.6935, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
12 gae_duplicate tensor(-0.0270, dtype=torch.float64) tensor(-5.5179, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0348, dtype=torch.float64) delta_t tensor(-0.3015, dtype=torch.float64)
11 gae_duplicate tensor(-2.6035, dtype=torch.float64) tensor(7.1569, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5717, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
10 gae_duplicate tensor(-2.4182, dtype=torch.float64) tensor(4.6929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(0.1058, dtype=torch.float64)
9 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-1.3353, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7290, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
8 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(0.1735, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2075, dtype=torch.float64) delta_t tensor(-0.7672, dtype=torch.float64)
7 gae_duplicate tensor(-3.4240, dtype=torch.float64) tensor(12.1308, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9476, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
6 gae_duplicate tensor(-0.4742, dtype=torch.float64) tensor(-0.3603, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5211, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
5 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-4.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2175, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
4 gae_duplicate tensor(-0.1848, dtype=torch.float64) tensor(-1.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5627, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
3 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(0.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.1517, dtype=torch.float64)
2 gae_duplicate tensor(-0.0220, dtype=torch.float64) tensor(-3.1990, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-234.33154296875
value loss:55.33348083496094
entropies:335.0354309082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.820713043212891 seconds
19 rew tensor(1.1846, dtype=torch.float64) delta_t tensor(-0.1003, dtype=torch.float64)
19 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(1.8546, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1721, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
18 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-0.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1084, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
17 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-0.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0451, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
16 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(0.3064, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9553, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
15 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-2.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8153, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
14 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-4.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3660, dtype=torch.float64) delta_t tensor(-0.7309, dtype=torch.float64)
13 gae_duplicate tensor(-3.7665, dtype=torch.float64) tensor(14.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3831, dtype=torch.float64) delta_t tensor(0.2389, dtype=torch.float64)
12 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(-3.5643, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3169, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
11 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1025, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
10 gae_duplicate tensor(-0.0510, dtype=torch.float64) tensor(-2.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3288, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
9 gae_duplicate tensor(-0.4014, dtype=torch.float64) tensor(-0.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6004, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
8 gae_duplicate tensor(-0.1184, dtype=torch.float64) tensor(-0.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2077, dtype=torch.float64) delta_t tensor(-0.3259, dtype=torch.float64)
7 gae_duplicate tensor(-1.8125, dtype=torch.float64) tensor(7.2201, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8572, dtype=torch.float64) delta_t tensor(0.0806, dtype=torch.float64)
6 gae_duplicate tensor(-0.5584, dtype=torch.float64) tensor(-0.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4184, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
5 gae_duplicate tensor(0.0093, dtype=torch.float64) tensor(-3.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0133, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
4 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-1.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1660, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
3 gae_duplicate tensor(-0.3194, dtype=torch.float64) tensor(0.4479, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3451, dtype=torch.float64) delta_t tensor(0.0873, dtype=torch.float64)
2 gae_duplicate tensor(-0.2730, dtype=torch.float64) tensor(-1.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-280.5572814941406
value loss:36.02591323852539
entropies:335.2498779296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1628828048706055 seconds
19 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(-0.1149, dtype=torch.float64)
19 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(2.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1076, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
18 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0697, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
17 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(0.5844, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0179, dtype=torch.float64) delta_t tensor(-0.0828, dtype=torch.float64)
16 gae_duplicate tensor(-0.2326, dtype=torch.float64) tensor(1.8204, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0060, dtype=torch.float64) delta_t tensor(0.0553, dtype=torch.float64)
15 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9410, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
14 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(0.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7895, dtype=torch.float64) delta_t tensor(0.1938, dtype=torch.float64)
13 gae_duplicate tensor(-0.0373, dtype=torch.float64) tensor(-3.4751, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0531, dtype=torch.float64) delta_t tensor(-0.1805, dtype=torch.float64)
12 gae_duplicate tensor(-1.4584, dtype=torch.float64) tensor(2.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3172, dtype=torch.float64) delta_t tensor(-0.5390, dtype=torch.float64)
11 gae_duplicate tensor(-2.0896, dtype=torch.float64) tensor(8.4847, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.8316, dtype=torch.float64) delta_t tensor(-0.6559, dtype=torch.float64)
10 gae_duplicate tensor(-4.8623, dtype=torch.float64) tensor(16.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1813, dtype=torch.float64) delta_t tensor(-0.2841, dtype=torch.float64)
9 gae_duplicate tensor(-3.1823, dtype=torch.float64) tensor(5.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5884, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
8 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-0.4065, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5469, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
7 gae_duplicate tensor(-0.1357, dtype=torch.float64) tensor(-1.9819, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8054, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
6 gae_duplicate tensor(0.0100, dtype=torch.float64) tensor(-2.7352, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4419, dtype=torch.float64) delta_t tensor(0.0534, dtype=torch.float64)
5 gae_duplicate tensor(-0.1246, dtype=torch.float64) tensor(-1.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0927, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
4 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(-0.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0066, dtype=torch.float64) delta_t tensor(0.1695, dtype=torch.float64)
3 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-3.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2646, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
2 gae_duplicate tensor(-0.2187, dtype=torch.float64) tensor(-1.0855, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1298.760498046875
value loss:69.320068359375
entropies:335.05731201171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3822.0137)
ToM Target loss= tensor(3956.7068)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.995577096939087 seconds
19 rew tensor(1.1087, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
19 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(1.8453, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0833, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
18 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-1.0799, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9421, dtype=torch.float64) delta_t tensor(-0.0617, dtype=torch.float64)
17 gae_duplicate tensor(-0.1544, dtype=torch.float64) tensor(1.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9298, dtype=torch.float64) delta_t tensor(-0.0736, dtype=torch.float64)
16 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(1.4287, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
15 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(1.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
14 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-0.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6231, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
13 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(0.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3564, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
12 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(-0.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
11 gae_duplicate tensor(-0.2284, dtype=torch.float64) tensor(-0.2207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1287, dtype=torch.float64) delta_t tensor(-0.0695, dtype=torch.float64)
10 gae_duplicate tensor(-0.3607, dtype=torch.float64) tensor(1.2357, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
9 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-1.7783, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4982, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
8 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(0.7533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3976, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
7 gae_duplicate tensor(-0.1990, dtype=torch.float64) tensor(0.1843, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(0.1806, dtype=torch.float64)
6 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-3.4395, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3154, dtype=torch.float64) delta_t tensor(-0.1114, dtype=torch.float64)
5 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(1.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2695, dtype=torch.float64) delta_t tensor(0.0044, dtype=torch.float64)
4 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(0.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5885, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
3 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-0.3605, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0877, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
2 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(0.0066, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-229.43972778320312
value loss:3.300365924835205
entropies:334.6534729003906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.797567129135132 seconds
19 rew tensor(1.1844, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
19 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(1.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8545, dtype=torch.float64) delta_t tensor(-0.2052, dtype=torch.float64)
18 gae_duplicate tensor(-1.3325, dtype=torch.float64) tensor(4.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0952, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
17 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-0.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9679, dtype=torch.float64) delta_t tensor(-0.0020, dtype=torch.float64)
16 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.2697, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9165, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
15 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(-0.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6117, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
14 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-0.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1906, dtype=torch.float64) delta_t tensor(-0.3381, dtype=torch.float64)
13 gae_duplicate tensor(-2.4466, dtype=torch.float64) tensor(4.8167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3438, dtype=torch.float64) delta_t tensor(0.0842, dtype=torch.float64)
12 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(-0.7820, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4578, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
11 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-1.7869, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0368, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
10 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-1.4498, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2785, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
9 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-2.0275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5746, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
8 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2207, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
7 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(-1.2104, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8039, dtype=torch.float64) delta_t tensor(0.1977, dtype=torch.float64)
6 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(-3.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1901, dtype=torch.float64) delta_t tensor(0.0018, dtype=torch.float64)
5 gae_duplicate tensor(-0.1496, dtype=torch.float64) tensor(-0.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3958, dtype=torch.float64) delta_t tensor(0.0560, dtype=torch.float64)
4 gae_duplicate tensor(-0.2239, dtype=torch.float64) tensor(-0.9781, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4631, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
3 gae_duplicate tensor(-0.2586, dtype=torch.float64) tensor(-0.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0514, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
2 gae_duplicate tensor(-0.3728, dtype=torch.float64) tensor(1.7036, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17.09547233581543
value loss:16.42764663696289
entropies:334.40093994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.547721862792969 seconds
19 rew tensor(1.1597, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
19 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(1.6370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1469, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
18 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-1.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8544, dtype=torch.float64) delta_t tensor(-0.2080, dtype=torch.float64)
17 gae_duplicate tensor(-1.4906, dtype=torch.float64) tensor(3.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0066, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
16 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(0.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
15 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-1.1885, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1775, dtype=torch.float64) delta_t tensor(-0.4271, dtype=torch.float64)
14 gae_duplicate tensor(-1.2946, dtype=torch.float64) tensor(6.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.2644, dtype=torch.float64)
13 gae_duplicate tensor(0.1218, dtype=torch.float64) tensor(-4.8392, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1618, dtype=torch.float64) delta_t tensor(-0.1317, dtype=torch.float64)
12 gae_duplicate tensor(-1.0533, dtype=torch.float64) tensor(2.9900, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0342, dtype=torch.float64) delta_t tensor(-0.1389, dtype=torch.float64)
11 gae_duplicate tensor(-1.2106, dtype=torch.float64) tensor(3.6920, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0375, dtype=torch.float64) delta_t tensor(0.1527, dtype=torch.float64)
10 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-3.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3308, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
9 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-2.1505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5255, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
8 gae_duplicate tensor(0.0109, dtype=torch.float64) tensor(-1.7802, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4590, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
7 gae_duplicate tensor(-0.0209, dtype=torch.float64) tensor(-2.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6021, dtype=torch.float64) delta_t tensor(0.2356, dtype=torch.float64)
6 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-4.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4937, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
5 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(1.1931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1940, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
4 gae_duplicate tensor(-0.1041, dtype=torch.float64) tensor(-0.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8302, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
3 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-0.5735, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1376, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
2 gae_duplicate tensor(-0.2610, dtype=torch.float64) tensor(1.1490, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-9.680623054504395
value loss:16.515260696411133
entropies:334.0845642089844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.962138891220093 seconds
19 rew tensor(1.1847, dtype=torch.float64) delta_t tensor(-0.0753, dtype=torch.float64)
19 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(1.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1722, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
18 gae_duplicate tensor(-0.0002, dtype=torch.float64) tensor(-1.7573, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0316, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
17 gae_duplicate tensor(-0.1438, dtype=torch.float64) tensor(0.4429, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0058, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
16 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(0.0999, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9806, dtype=torch.float64) delta_t tensor(0.0362, dtype=torch.float64)
15 gae_duplicate tensor(-0.1372, dtype=torch.float64) tensor(-0.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7628, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
14 gae_duplicate tensor(-0.2132, dtype=torch.float64) tensor(-2.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3398, dtype=torch.float64) delta_t tensor(-0.8135, dtype=torch.float64)
13 gae_duplicate tensor(-2.7223, dtype=torch.float64) tensor(12.6288, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0498, dtype=torch.float64) delta_t tensor(-0.1131, dtype=torch.float64)
12 gae_duplicate tensor(-1.0273, dtype=torch.float64) tensor(3.2608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2558, dtype=torch.float64) delta_t tensor(-0.1468, dtype=torch.float64)
11 gae_duplicate tensor(-1.1858, dtype=torch.float64) tensor(4.0944, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1000, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
10 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-4.3532, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4582, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
9 gae_duplicate tensor(-0.0490, dtype=torch.float64) tensor(-2.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6660, dtype=torch.float64) delta_t tensor(0.1368, dtype=torch.float64)
8 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-3.2891, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0382, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
7 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(-2.0643, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8956, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
6 gae_duplicate tensor(-0.0089, dtype=torch.float64) tensor(-1.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9323, dtype=torch.float64) delta_t tensor(-0.0629, dtype=torch.float64)
5 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(1.0185, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4877, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
4 gae_duplicate tensor(-0.3313, dtype=torch.float64) tensor(-0.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.2424, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
3 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-3.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1558, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
2 gae_duplicate tensor(-0.4532, dtype=torch.float64) tensor(1.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-248.56240844726562
value loss:31.27374267578125
entropies:334.04779052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.682829856872559 seconds
19 rew tensor(1.1726, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
19 gae_duplicate tensor(-0.0892, dtype=torch.float64) tensor(0.3814, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(-0.1545, dtype=torch.float64)
18 gae_duplicate tensor(-1.2770, dtype=torch.float64) tensor(2.4993, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7357, dtype=torch.float64) delta_t tensor(-0.2184, dtype=torch.float64)
17 gae_duplicate tensor(-1.4736, dtype=torch.float64) tensor(3.8845, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
16 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(0.4679, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
15 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(0.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7006, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
14 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-1.2935, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
13 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-4.1346, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
12 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(-0.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
11 gae_duplicate tensor(-0.1960, dtype=torch.float64) tensor(-1.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1547, dtype=torch.float64) delta_t tensor(-0.1037, dtype=torch.float64)
10 gae_duplicate tensor(-0.2033, dtype=torch.float64) tensor(1.6370, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3174, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
9 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(1.2522, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4995, dtype=torch.float64) delta_t tensor(-0.1118, dtype=torch.float64)
8 gae_duplicate tensor(-0.3107, dtype=torch.float64) tensor(2.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5901, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
7 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(-1.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6901, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
6 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-2.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4204, dtype=torch.float64) delta_t tensor(-0.0021, dtype=torch.float64)
5 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-0.2053, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1161, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
4 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-0.4940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8717, dtype=torch.float64) delta_t tensor(-0.0225, dtype=torch.float64)
3 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(0.4076, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2032, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
2 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(0.6702, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-217.67391967773438
value loss:9.39864730834961
entropies:334.6107482910156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3872.0740)
ToM Target loss= tensor(3960.1550)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.918581008911133 seconds
19 rew tensor(1.1725, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
19 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(0.2425, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1346, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
18 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-2.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0201, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
17 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-0.3067, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9691, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-0.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9179, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
15 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-0.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5992, dtype=torch.float64) delta_t tensor(0.1025, dtype=torch.float64)
14 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-2.6232, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6879, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
13 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-3.5025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0093, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
12 gae_duplicate tensor(-1.2429, dtype=torch.float64) tensor(2.6192, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0071, dtype=torch.float64) delta_t tensor(-0.2653, dtype=torch.float64)
11 gae_duplicate tensor(-2.5832, dtype=torch.float64) tensor(7.9060, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0772, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
10 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(0.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
9 gae_duplicate tensor(-0.0893, dtype=torch.float64) tensor(-2.6904, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7039, dtype=torch.float64) delta_t tensor(-0.1542, dtype=torch.float64)
8 gae_duplicate tensor(-0.2910, dtype=torch.float64) tensor(2.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4224, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
7 gae_duplicate tensor(-0.0605, dtype=torch.float64) tensor(-1.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7423, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
6 gae_duplicate tensor(0.0266, dtype=torch.float64) tensor(-2.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3425, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
5 gae_duplicate tensor(-0.2005, dtype=torch.float64) tensor(0.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1429, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
4 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-1.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8314, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
3 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(2.0190, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2146, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
2 gae_duplicate tensor(-0.3671, dtype=torch.float64) tensor(-0.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:42.95675277709961
value loss:17.00814437866211
entropies:335.2542724609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.790163993835449 seconds
19 rew tensor(1.1853, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
19 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-0.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1731, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
18 gae_duplicate tensor(0.0327, dtype=torch.float64) tensor(-3.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0582, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
17 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-1.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0070, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
16 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(-1.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9181, dtype=torch.float64) delta_t tensor(0.1808, dtype=torch.float64)
15 gae_duplicate tensor(-0.3070, dtype=torch.float64) tensor(-2.9832, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1099, dtype=torch.float64) delta_t tensor(-0.3971, dtype=torch.float64)
14 gae_duplicate tensor(-2.5227, dtype=torch.float64) tensor(9.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6237, dtype=torch.float64) delta_t tensor(0.1102, dtype=torch.float64)
13 gae_duplicate tensor(-0.0137, dtype=torch.float64) tensor(-1.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1516, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
12 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5352, dtype=torch.float64) delta_t tensor(0.1402, dtype=torch.float64)
11 gae_duplicate tensor(0.0138, dtype=torch.float64) tensor(-2.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(0.0353, dtype=torch.float64)
10 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(-0.5870, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
9 gae_duplicate tensor(0.0007, dtype=torch.float64) tensor(-2.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7051, dtype=torch.float64) delta_t tensor(-0.1413, dtype=torch.float64)
8 gae_duplicate tensor(-0.3980, dtype=torch.float64) tensor(1.9348, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5094, dtype=torch.float64) delta_t tensor(0.0366, dtype=torch.float64)
7 gae_duplicate tensor(-0.1771, dtype=torch.float64) tensor(-0.3706, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
6 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-0.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3409, dtype=torch.float64) delta_t tensor(-0.0187, dtype=torch.float64)
5 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(0.2983, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0674, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
4 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-0.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9059, dtype=torch.float64) delta_t tensor(-0.1251, dtype=torch.float64)
3 gae_duplicate tensor(-0.3029, dtype=torch.float64) tensor(2.2016, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
2 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(-0.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:112.73649597167969
value loss:13.846034049987793
entropies:335.60797119140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.614835977554321 seconds
19 rew tensor(1.1985, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
19 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-0.5727, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1605, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
18 gae_duplicate tensor(0.0553, dtype=torch.float64) tensor(-2.4869, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0841, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
17 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-1.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0199, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
16 gae_duplicate tensor(-0.1376, dtype=torch.float64) tensor(-1.0203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9439, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
15 gae_duplicate tensor(-0.1298, dtype=torch.float64) tensor(-3.4258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(-0.2149, dtype=torch.float64)
14 gae_duplicate tensor(-1.3697, dtype=torch.float64) tensor(4.9212, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4188, dtype=torch.float64) delta_t tensor(-0.0397, dtype=torch.float64)
13 gae_duplicate tensor(-0.9565, dtype=torch.float64) tensor(1.9570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0958, dtype=torch.float64) delta_t tensor(-0.2425, dtype=torch.float64)
12 gae_duplicate tensor(-1.7692, dtype=torch.float64) tensor(3.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0988, dtype=torch.float64) delta_t tensor(-0.0329, dtype=torch.float64)
11 gae_duplicate tensor(-1.2712, dtype=torch.float64) tensor(0.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0494, dtype=torch.float64) delta_t tensor(0.1975, dtype=torch.float64)
10 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-3.4140, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4210, dtype=torch.float64) delta_t tensor(0.1698, dtype=torch.float64)
9 gae_duplicate tensor(0.0396, dtype=torch.float64) tensor(-4.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5903, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
8 gae_duplicate tensor(-0.3374, dtype=torch.float64) tensor(2.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9718, dtype=torch.float64) delta_t tensor(-0.1910, dtype=torch.float64)
7 gae_duplicate tensor(-1.0576, dtype=torch.float64) tensor(4.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7441, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
6 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-1.3787, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5199, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
5 gae_duplicate tensor(-0.2937, dtype=torch.float64) tensor(-0.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0096, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
4 gae_duplicate tensor(-0.1849, dtype=torch.float64) tensor(0.9375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1502, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
3 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(0.0957, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3542, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
2 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(0.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-156.39585876464844
value loss:18.951871871948242
entropies:335.4485778808594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832850933074951 seconds
19 rew tensor(1.1343, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
19 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-0.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
18 gae_duplicate tensor(0.0272, dtype=torch.float64) tensor(-1.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
17 gae_duplicate tensor(0.0963, dtype=torch.float64) tensor(-2.1579, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9428, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
16 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-0.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
15 gae_duplicate tensor(-0.0457, dtype=torch.float64) tensor(-0.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
14 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(0.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
13 gae_duplicate tensor(0.0060, dtype=torch.float64) tensor(-2.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
12 gae_duplicate tensor(-0.1621, dtype=torch.float64) tensor(-0.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2375, dtype=torch.float64) delta_t tensor(-0.5896, dtype=torch.float64)
11 gae_duplicate tensor(-3.6287, dtype=torch.float64) tensor(13.6107, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5594, dtype=torch.float64) delta_t tensor(-0.3574, dtype=torch.float64)
10 gae_duplicate tensor(-2.3729, dtype=torch.float64) tensor(9.6622, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0260, dtype=torch.float64) delta_t tensor(-0.1977, dtype=torch.float64)
9 gae_duplicate tensor(-1.6868, dtype=torch.float64) tensor(3.6736, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4225, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
8 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(0.0524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8949, dtype=torch.float64) delta_t tensor(-0.1256, dtype=torch.float64)
7 gae_duplicate tensor(-0.7173, dtype=torch.float64) tensor(1.9814, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6134, dtype=torch.float64) delta_t tensor(0.1219, dtype=torch.float64)
6 gae_duplicate tensor(0.0040, dtype=torch.float64) tensor(-2.3278, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5226, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
5 gae_duplicate tensor(-0.2349, dtype=torch.float64) tensor(0.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0906, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
4 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(0.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9727, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
3 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(0.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2798, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
2 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-0.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1153.168212890625
value loss:35.81642150878906
entropies:335.13189697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.779612064361572 seconds
19 rew tensor(1.0575, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
19 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(0.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
18 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-1.3906, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0452, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
17 gae_duplicate tensor(0.0474, dtype=torch.float64) tensor(-1.9631, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8038, dtype=torch.float64) delta_t tensor(-0.1261, dtype=torch.float64)
16 gae_duplicate tensor(-1.2045, dtype=torch.float64) tensor(3.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
15 gae_duplicate tensor(-0.0367, dtype=torch.float64) tensor(-1.2414, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7892, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
14 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-2.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.2127, dtype=torch.float64)
13 gae_duplicate tensor(0.1217, dtype=torch.float64) tensor(-4.3863, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
12 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-2.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3691, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
11 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-0.6393, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0024, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
10 gae_duplicate tensor(-0.1837, dtype=torch.float64) tensor(0.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3309, dtype=torch.float64) delta_t tensor(0.0978, dtype=torch.float64)
9 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4228, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
8 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(0.3754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5666, dtype=torch.float64) delta_t tensor(-0.5385, dtype=torch.float64)
7 gae_duplicate tensor(-3.1454, dtype=torch.float64) tensor(12.4992, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7036, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
6 gae_duplicate tensor(-0.5813, dtype=torch.float64) tensor(0.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4956, dtype=torch.float64) delta_t tensor(-0.0185, dtype=torch.float64)
5 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(0.8080, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0353, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
4 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(0.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0599, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
3 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(1.1900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4056, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
2 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(1.4141, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-413.70965576171875
value loss:21.241661071777344
entropies:334.4477233886719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3861.7998)
ToM Target loss= tensor(3964.9978)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.794490098953247 seconds
19 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
19 gae_duplicate tensor(-0.0783, dtype=torch.float64) tensor(-0.2031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
18 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-1.4883, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1212, dtype=torch.float64) delta_t tensor(0.1147, dtype=torch.float64)
17 gae_duplicate tensor(0.0362, dtype=torch.float64) tensor(-2.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0317, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
16 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-0.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
15 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(0.0563, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(-0.0924, dtype=torch.float64)
14 gae_duplicate tensor(-1.2232, dtype=torch.float64) tensor(0.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7247, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
13 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-1.8200, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5847, dtype=torch.float64) delta_t tensor(0.1503, dtype=torch.float64)
12 gae_duplicate tensor(-0.0507, dtype=torch.float64) tensor(-3.3793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0032, dtype=torch.float64) delta_t tensor(-0.2522, dtype=torch.float64)
11 gae_duplicate tensor(-1.7307, dtype=torch.float64) tensor(5.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4686, dtype=torch.float64) delta_t tensor(-0.3228, dtype=torch.float64)
10 gae_duplicate tensor(-2.2638, dtype=torch.float64) tensor(8.0743, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.7428, dtype=torch.float64) delta_t tensor(-0.9728, dtype=torch.float64)
9 gae_duplicate tensor(-6.0761, dtype=torch.float64) tensor(23.3928, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4624, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
8 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(0.1718, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9770, dtype=torch.float64) delta_t tensor(-0.2510, dtype=torch.float64)
7 gae_duplicate tensor(-1.8874, dtype=torch.float64) tensor(6.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8970, dtype=torch.float64) delta_t tensor(0.0915, dtype=torch.float64)
6 gae_duplicate tensor(-0.3846, dtype=torch.float64) tensor(-1.3406, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2395, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
5 gae_duplicate tensor(-0.3606, dtype=torch.float64) tensor(0.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1413, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
4 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-0.8322, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9094, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
3 gae_duplicate tensor(-0.2533, dtype=torch.float64) tensor(0.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
2 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(0.0170, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1892.914794921875
value loss:79.7486343383789
entropies:333.2889099121094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.677382946014404 seconds
19 rew tensor(1.1847, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
19 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(0.5966, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2107, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
18 gae_duplicate tensor(0.0316, dtype=torch.float64) tensor(-2.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0452, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
17 gae_duplicate tensor(-0.0553, dtype=torch.float64) tensor(-0.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9944, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
16 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9568, dtype=torch.float64) delta_t tensor(0.2850, dtype=torch.float64)
15 gae_duplicate tensor(0.1371, dtype=torch.float64) tensor(-5.0124, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1412, dtype=torch.float64) delta_t tensor(-0.3417, dtype=torch.float64)
14 gae_duplicate tensor(-1.3536, dtype=torch.float64) tensor(4.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(-0.2388, dtype=torch.float64)
13 gae_duplicate tensor(-2.2967, dtype=torch.float64) tensor(3.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1607, dtype=torch.float64) delta_t tensor(0.0190, dtype=torch.float64)
12 gae_duplicate tensor(-0.8791, dtype=torch.float64) tensor(0.1095, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2940, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
11 gae_duplicate tensor(-0.0612, dtype=torch.float64) tensor(-2.9581, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1370, dtype=torch.float64) delta_t tensor(0.1916, dtype=torch.float64)
10 gae_duplicate tensor(0.1261, dtype=torch.float64) tensor(-3.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3470, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
9 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-1.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7052, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
8 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(0.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6594, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
7 gae_duplicate tensor(-0.0528, dtype=torch.float64) tensor(-0.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(0.0855, dtype=torch.float64)
6 gae_duplicate tensor(-0.1018, dtype=torch.float64) tensor(-1.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4917, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
5 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(0.0732, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0426, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
4 gae_duplicate tensor(0.0633, dtype=torch.float64) tensor(-2.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0822, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
3 gae_duplicate tensor(-0.3303, dtype=torch.float64) tensor(0.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2893, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
2 gae_duplicate tensor(-0.2816, dtype=torch.float64) tensor(-1.3747, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:550.3817749023438
value loss:17.63937759399414
entropies:331.7503662109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6068079471588135 seconds
19 rew tensor(1.1851, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
19 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(0.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1596, dtype=torch.float64) delta_t tensor(0.1106, dtype=torch.float64)
18 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-1.7183, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8421, dtype=torch.float64) delta_t tensor(-0.1863, dtype=torch.float64)
17 gae_duplicate tensor(-1.4325, dtype=torch.float64) tensor(2.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9685, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
16 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-0.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
15 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-2.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6371, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
14 gae_duplicate tensor(-0.0158, dtype=torch.float64) tensor(-3.6337, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
13 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-1.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4335, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
12 gae_duplicate tensor(-0.1654, dtype=torch.float64) tensor(-1.8438, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5429, dtype=torch.float64) delta_t tensor(-0.6208, dtype=torch.float64)
11 gae_duplicate tensor(-4.3038, dtype=torch.float64) tensor(9.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0920, dtype=torch.float64) delta_t tensor(0.0062, dtype=torch.float64)
10 gae_duplicate tensor(-0.6369, dtype=torch.float64) tensor(0.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1125, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
9 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-1.8039, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6008, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
8 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-1.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7048, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
7 gae_duplicate tensor(-0.0672, dtype=torch.float64) tensor(-0.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7030, dtype=torch.float64) delta_t tensor(0.2166, dtype=torch.float64)
6 gae_duplicate tensor(-0.1836, dtype=torch.float64) tensor(-4.1034, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5985, dtype=torch.float64) delta_t tensor(-0.0679, dtype=torch.float64)
5 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(0.9848, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1163, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
4 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-2.0187, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0751, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
3 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(1.2677, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2156, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
2 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(-1.7127, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:359.828369140625
value loss:36.17060852050781
entropies:330.83837890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859739065170288 seconds
19 rew tensor(1.0840, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
19 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(1.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8646, dtype=torch.float64) delta_t tensor(-0.1506, dtype=torch.float64)
18 gae_duplicate tensor(-1.2044, dtype=torch.float64) tensor(2.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9945, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
17 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(0.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
16 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(0.6172, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
15 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-1.3952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4055, dtype=torch.float64) delta_t tensor(-0.1146, dtype=torch.float64)
14 gae_duplicate tensor(-0.8558, dtype=torch.float64) tensor(1.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6613, dtype=torch.float64) delta_t tensor(0.2139, dtype=torch.float64)
13 gae_duplicate tensor(-0.0851, dtype=torch.float64) tensor(-4.2749, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3308, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
12 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-3.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(0.1488, dtype=torch.float64)
11 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-2.8934, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1800, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
10 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(0.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3820, dtype=torch.float64) delta_t tensor(0.1114, dtype=torch.float64)
9 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-1.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6146, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
8 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(-1.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3084, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
7 gae_duplicate tensor(-0.2612, dtype=torch.float64) tensor(-1.3781, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7548, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
6 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-4.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3168, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
5 gae_duplicate tensor(-0.3628, dtype=torch.float64) tensor(0.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2693, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
4 gae_duplicate tensor(-0.1021, dtype=torch.float64) tensor(-0.6059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6922, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
3 gae_duplicate tensor(-0.0449, dtype=torch.float64) tensor(-0.2440, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0243, dtype=torch.float64) delta_t tensor(-0.0890, dtype=torch.float64)
2 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(1.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:602.5015869140625
value loss:7.8106513023376465
entropies:330.3122253417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832696914672852 seconds
19 rew tensor(1.2106, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
19 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(0.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1726, dtype=torch.float64) delta_t tensor(0.0906, dtype=torch.float64)
18 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-1.8479, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(-0.1534, dtype=torch.float64)
17 gae_duplicate tensor(-1.4693, dtype=torch.float64) tensor(4.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9806, dtype=torch.float64) delta_t tensor(0.1476, dtype=torch.float64)
16 gae_duplicate tensor(-0.1962, dtype=torch.float64) tensor(-1.8248, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(0.2532, dtype=torch.float64)
15 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-6.0072, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6620, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
14 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-1.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6761, dtype=torch.float64) delta_t tensor(0.2198, dtype=torch.float64)
13 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-4.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4693, dtype=torch.float64) delta_t tensor(0.1581, dtype=torch.float64)
12 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-3.0233, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3191, dtype=torch.float64) delta_t tensor(2.5226e-05, dtype=torch.float64)
11 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(0.0400, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1508, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
10 gae_duplicate tensor(-0.0451, dtype=torch.float64) tensor(-2.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1394, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
9 gae_duplicate tensor(-0.0973, dtype=torch.float64) tensor(-1.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4614, dtype=torch.float64) delta_t tensor(-0.0276, dtype=torch.float64)
8 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-0.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2049, dtype=torch.float64) delta_t tensor(-0.5376, dtype=torch.float64)
7 gae_duplicate tensor(-3.0728, dtype=torch.float64) tensor(12.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7926, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
6 gae_duplicate tensor(-0.7143, dtype=torch.float64) tensor(2.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6223, dtype=torch.float64) delta_t tensor(0.2105, dtype=torch.float64)
5 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-3.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3424, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
4 gae_duplicate tensor(-0.1471, dtype=torch.float64) tensor(-2.8763, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6598, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
3 gae_duplicate tensor(-0.3593, dtype=torch.float64) tensor(2.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6743, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
2 gae_duplicate tensor(-0.2589, dtype=torch.float64) tensor(-2.1915, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:353.7421569824219
value loss:29.928478240966797
entropies:330.0715637207031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3817.7407)
ToM Target loss= tensor(3961.9673)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.883899211883545 seconds
19 rew tensor(1.1470, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
19 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(1.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1728, dtype=torch.float64) delta_t tensor(0.0911, dtype=torch.float64)
18 gae_duplicate tensor(-0.0168, dtype=torch.float64) tensor(-1.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0196, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
17 gae_duplicate tensor(-0.1014, dtype=torch.float64) tensor(0.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9564, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
16 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(0.3654, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6362, dtype=torch.float64) delta_t tensor(-0.1954, dtype=torch.float64)
15 gae_duplicate tensor(-1.3935, dtype=torch.float64) tensor(3.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6491, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
14 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-1.6000, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3653, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
13 gae_duplicate tensor(-1.2454, dtype=torch.float64) tensor(0.6700, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2156, dtype=torch.float64) delta_t tensor(0.0327, dtype=torch.float64)
12 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-0.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.1033, dtype=torch.float64)
11 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(-2.3183, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0899, dtype=torch.float64) delta_t tensor(0.1458, dtype=torch.float64)
10 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-2.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5362, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
9 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-2.7901, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7813, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
8 gae_duplicate tensor(-0.1368, dtype=torch.float64) tensor(0.6025, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7012, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
7 gae_duplicate tensor(-1.3162, dtype=torch.float64) tensor(1.4100, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8579, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
6 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-2.2485, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2887, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
5 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-2.2985, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
4 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(-0.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9574, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
3 gae_duplicate tensor(-0.2519, dtype=torch.float64) tensor(2.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2905, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
2 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(-1.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:321.0424499511719
value loss:13.873067855834961
entropies:329.3962097167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.129554986953735 seconds
19 rew tensor(1.1077, dtype=torch.float64) delta_t tensor(-0.1065, dtype=torch.float64)
19 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(1.9673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
18 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-2.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0184, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
17 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-0.6065, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
16 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(0.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8786, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
15 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(0.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6739, dtype=torch.float64) delta_t tensor(0.1051, dtype=torch.float64)
14 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(-2.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7263, dtype=torch.float64) delta_t tensor(0.1853, dtype=torch.float64)
13 gae_duplicate tensor(0.0319, dtype=torch.float64) tensor(-3.8166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3411, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
12 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(-0.9792, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
11 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.7999, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1119, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
10 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(-0.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2162, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
9 gae_duplicate tensor(-0.2603, dtype=torch.float64) tensor(0.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5120, dtype=torch.float64) delta_t tensor(0.0624, dtype=torch.float64)
8 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-1.0279, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6894, dtype=torch.float64) delta_t tensor(-1.0759, dtype=torch.float64)
7 gae_duplicate tensor(-6.1245, dtype=torch.float64) tensor(16.5495, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8302, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
6 gae_duplicate tensor(-0.6709, dtype=torch.float64) tensor(1.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2388, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
5 gae_duplicate tensor(-0.0607, dtype=torch.float64) tensor(-2.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1439, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
4 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(-3.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8776, dtype=torch.float64) delta_t tensor(-0.0132, dtype=torch.float64)
3 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(-0.2251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1879, dtype=torch.float64) delta_t tensor(0.1873, dtype=torch.float64)
2 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-3.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2.0630393028259277
value loss:64.6396255493164
entropies:328.83612060546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.927876234054565 seconds
19 rew tensor(1.1979, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
19 gae_duplicate tensor(-0.1879, dtype=torch.float64) tensor(1.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1850, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
18 gae_duplicate tensor(-0.0619, dtype=torch.float64) tensor(-1.4147, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0571, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
17 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(0.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9303, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
16 gae_duplicate tensor(-0.2448, dtype=torch.float64) tensor(1.4392, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
15 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(0.5549, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1392, dtype=torch.float64) delta_t tensor(-0.2242, dtype=torch.float64)
14 gae_duplicate tensor(-0.7643, dtype=torch.float64) tensor(3.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6733, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
13 gae_duplicate tensor(-0.2621, dtype=torch.float64) tensor(-2.5308, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
12 gae_duplicate tensor(-0.2082, dtype=torch.float64) tensor(-1.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5969, dtype=torch.float64) delta_t tensor(0.1579, dtype=torch.float64)
11 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(-2.5525, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2692, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
10 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(0.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3812, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
9 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(-1.2611, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5999, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
8 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-1.8858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1143, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
7 gae_duplicate tensor(-0.7679, dtype=torch.float64) tensor(-1.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7150, dtype=torch.float64) delta_t tensor(0.1273, dtype=torch.float64)
6 gae_duplicate tensor(-0.2470, dtype=torch.float64) tensor(-1.6240, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6240, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
5 gae_duplicate tensor(-0.2029, dtype=torch.float64) tensor(-2.1827, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0636, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
4 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(0.1733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2804, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
3 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-0.0977, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4079, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
2 gae_duplicate tensor(-0.2611, dtype=torch.float64) tensor(-0.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:349.5046691894531
value loss:9.254354476928711
entropies:328.7702331542969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.012876033782959 seconds
19 rew tensor(1.0571, dtype=torch.float64) delta_t tensor(-0.1169, dtype=torch.float64)
19 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(1.9907, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8152, dtype=torch.float64) delta_t tensor(-0.2280, dtype=torch.float64)
18 gae_duplicate tensor(-1.5124, dtype=torch.float64) tensor(3.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9556, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
17 gae_duplicate tensor(-0.2143, dtype=torch.float64) tensor(1.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9561, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
16 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(1.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8407, dtype=torch.float64) delta_t tensor(-0.1643, dtype=torch.float64)
15 gae_duplicate tensor(-0.2984, dtype=torch.float64) tensor(4.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(-0.0427, dtype=torch.float64)
14 gae_duplicate tensor(-0.2419, dtype=torch.float64) tensor(1.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7253, dtype=torch.float64) delta_t tensor(0.1729, dtype=torch.float64)
13 gae_duplicate tensor(0.0215, dtype=torch.float64) tensor(-3.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3691, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
12 gae_duplicate tensor(-0.1921, dtype=torch.float64) tensor(1.2628, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3936, dtype=torch.float64) delta_t tensor(-0.0129, dtype=torch.float64)
11 gae_duplicate tensor(-0.1957, dtype=torch.float64) tensor(0.2374, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0522, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
10 gae_duplicate tensor(-0.2113, dtype=torch.float64) tensor(0.9711, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2157, dtype=torch.float64) delta_t tensor(-0.0946, dtype=torch.float64)
9 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(1.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4464, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
8 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(0.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6048, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
7 gae_duplicate tensor(-0.1290, dtype=torch.float64) tensor(0.1182, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5486, dtype=torch.float64) delta_t tensor(0.1531, dtype=torch.float64)
6 gae_duplicate tensor(0.1044, dtype=torch.float64) tensor(-2.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5216, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
5 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-0.7994, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0892, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
4 gae_duplicate tensor(-0.1323, dtype=torch.float64) tensor(0.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8712, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
3 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-1.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2808, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
2 gae_duplicate tensor(-0.2735, dtype=torch.float64) tensor(0.6331, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-686.094482421875
value loss:6.544734001159668
entropies:329.15753173828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.680330038070679 seconds
19 rew tensor(1.1340, dtype=torch.float64) delta_t tensor(-0.1103, dtype=torch.float64)
19 gae_duplicate tensor(-0.2035, dtype=torch.float64) tensor(2.0554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1595, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
18 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-1.7645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(-0.2390, dtype=torch.float64)
17 gae_duplicate tensor(-1.4033, dtype=torch.float64) tensor(5.4698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9293, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
16 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(1.8572, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8409, dtype=torch.float64) delta_t tensor(-0.0897, dtype=torch.float64)
15 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(1.4768, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6106, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
14 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5011, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
13 gae_duplicate tensor(-1.2808, dtype=torch.float64) tensor(3.0147, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
12 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(0.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4971, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
11 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-1.5463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0906, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
10 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(-1.3904, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4563, dtype=torch.float64) delta_t tensor(0.0551, dtype=torch.float64)
9 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-1.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6517, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
8 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(2.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0035, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
7 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(0.0697, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9182, dtype=torch.float64) delta_t tensor(0.2210, dtype=torch.float64)
6 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(-4.0933, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9868, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
5 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-0.6844, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.5228, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
4 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(0.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.1579, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
3 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(0.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.2800, dtype=torch.float64) delta_t tensor(-0.1968, dtype=torch.float64)
2 gae_duplicate tensor(-0.4722, dtype=torch.float64) tensor(3.6509, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-614.5301513671875
value loss:11.12301254272461
entropies:329.7410888671875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3818.0967)
ToM Target loss= tensor(3968.8591)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.742776155471802 seconds
19 rew tensor(1.1473, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
19 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(0.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(-0.1967, dtype=torch.float64)
18 gae_duplicate tensor(-1.4929, dtype=torch.float64) tensor(3.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9946, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
17 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(0.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9686, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
16 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(0.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8155, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
15 gae_duplicate tensor(-0.2729, dtype=torch.float64) tensor(0.7224, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7005, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
14 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-1.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
13 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-1.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0358, dtype=torch.float64) delta_t tensor(-0.2366, dtype=torch.float64)
12 gae_duplicate tensor(-1.3857, dtype=torch.float64) tensor(3.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4322, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
11 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-0.6174, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0399, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
10 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-1.3044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5091, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
9 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-0.8434, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7034, dtype=torch.float64) delta_t tensor(-0.1267, dtype=torch.float64)
8 gae_duplicate tensor(-0.2394, dtype=torch.float64) tensor(2.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3216, dtype=torch.float64) delta_t tensor(-0.0331, dtype=torch.float64)
7 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(0.9498, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7291, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
6 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-1.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2914, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
5 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(0.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
4 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(-0.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7052, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
3 gae_duplicate tensor(-0.2645, dtype=torch.float64) tensor(-0.1292, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
2 gae_duplicate tensor(-0.3302, dtype=torch.float64) tensor(-0.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-351.2181091308594
value loss:8.7791748046875
entropies:329.8906555175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.898873805999756 seconds
19 rew tensor(1.2109, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
19 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(0.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1473, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
18 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-0.6765, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0964, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
17 gae_duplicate tensor(-0.0954, dtype=torch.float64) tensor(-0.3770, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1475, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
16 gae_duplicate tensor(-0.0058, dtype=torch.float64) tensor(-1.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9691, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
15 gae_duplicate tensor(-0.3808, dtype=torch.float64) tensor(0.8713, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9556, dtype=torch.float64) delta_t tensor(0.1930, dtype=torch.float64)
14 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-3.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0904, dtype=torch.float64) delta_t tensor(-0.3708, dtype=torch.float64)
13 gae_duplicate tensor(-2.5346, dtype=torch.float64) tensor(4.6055, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3388, dtype=torch.float64) delta_t tensor(-0.5274, dtype=torch.float64)
12 gae_duplicate tensor(-3.1300, dtype=torch.float64) tensor(9.0337, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0273, dtype=torch.float64) delta_t tensor(-0.1392, dtype=torch.float64)
11 gae_duplicate tensor(-1.3265, dtype=torch.float64) tensor(5.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
10 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-1.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3447, dtype=torch.float64) delta_t tensor(0.1703, dtype=torch.float64)
9 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-3.5040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4750, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
8 gae_duplicate tensor(-0.4152, dtype=torch.float64) tensor(1.2863, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1625, dtype=torch.float64) delta_t tensor(0.2384, dtype=torch.float64)
7 gae_duplicate tensor(0.0285, dtype=torch.float64) tensor(-3.8310, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6285, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
6 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(-1.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7495, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
5 gae_duplicate tensor(-0.0995, dtype=torch.float64) tensor(-1.9446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2157, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
4 gae_duplicate tensor(-0.1396, dtype=torch.float64) tensor(0.3193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4581, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
3 gae_duplicate tensor(-0.2736, dtype=torch.float64) tensor(0.3091, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5347, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
2 gae_duplicate tensor(-0.3076, dtype=torch.float64) tensor(2.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-453.9347839355469
value loss:33.071449279785156
entropies:330.3193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6209800243377686 seconds
19 rew tensor(1.2357, dtype=torch.float64) delta_t tensor(-0.0149, dtype=torch.float64)
19 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(0.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9305, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
18 gae_duplicate tensor(-1.4489, dtype=torch.float64) tensor(2.5264, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1339, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
17 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-1.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0832, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
16 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-1.0477, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9438, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
15 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(-1.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3451, dtype=torch.float64) delta_t tensor(-0.3048, dtype=torch.float64)
14 gae_duplicate tensor(-2.1923, dtype=torch.float64) tensor(4.6376, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6009, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
13 gae_duplicate tensor(-0.2398, dtype=torch.float64) tensor(-1.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.2002, dtype=torch.float64)
12 gae_duplicate tensor(-0.0102, dtype=torch.float64) tensor(-4.3788, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1064, dtype=torch.float64) delta_t tensor(-0.2333, dtype=torch.float64)
11 gae_duplicate tensor(-2.0046, dtype=torch.float64) tensor(3.3107, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3390, dtype=torch.float64) delta_t tensor(-0.2530, dtype=torch.float64)
10 gae_duplicate tensor(-1.8242, dtype=torch.float64) tensor(6.9650, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.9291, dtype=torch.float64) delta_t tensor(-0.9202, dtype=torch.float64)
9 gae_duplicate tensor(-5.8904, dtype=torch.float64) tensor(14.7618, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5251, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
8 gae_duplicate tensor(-0.3317, dtype=torch.float64) tensor(0.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7875, dtype=torch.float64) delta_t tensor(0.3322, dtype=torch.float64)
7 gae_duplicate tensor(0.1451, dtype=torch.float64) tensor(-5.3142, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7691, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
6 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-1.6319, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5695, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
5 gae_duplicate tensor(-0.8357, dtype=torch.float64) tensor(1.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0335, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
4 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-1.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2622, dtype=torch.float64) delta_t tensor(-0.0927, dtype=torch.float64)
3 gae_duplicate tensor(-0.1985, dtype=torch.float64) tensor(2.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3523, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
2 gae_duplicate tensor(-0.3229, dtype=torch.float64) tensor(0.3832, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1195.83642578125
value loss:80.29730987548828
entropies:330.9913330078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.717555046081543 seconds
19 rew tensor(1.1846, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
19 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(0.4422, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1717, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
18 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-1.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0569, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
17 gae_duplicate tensor(-0.0732, dtype=torch.float64) tensor(-1.0239, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9545, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
16 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(0.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9417, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
15 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(-0.3765, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(-0.2189, dtype=torch.float64)
14 gae_duplicate tensor(-1.2614, dtype=torch.float64) tensor(5.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1977, dtype=torch.float64) delta_t tensor(-0.3030, dtype=torch.float64)
13 gae_duplicate tensor(-2.2358, dtype=torch.float64) tensor(7.9810, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0145, dtype=torch.float64) delta_t tensor(-0.1515, dtype=torch.float64)
12 gae_duplicate tensor(-0.8507, dtype=torch.float64) tensor(2.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(0.0832, dtype=torch.float64)
11 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-1.5396, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1166, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
10 gae_duplicate tensor(-0.2093, dtype=torch.float64) tensor(0.4259, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4441, dtype=torch.float64) delta_t tensor(0.0908, dtype=torch.float64)
9 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-1.6683, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6255, dtype=torch.float64) delta_t tensor(-0.0162, dtype=torch.float64)
8 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(0.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6004, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
7 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-1.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6894, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
6 gae_duplicate tensor(-0.0985, dtype=torch.float64) tensor(-1.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4177, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
5 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-0.5401, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0403, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
4 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(0.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9571, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
3 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(0.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3169, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
2 gae_duplicate tensor(-0.2835, dtype=torch.float64) tensor(-0.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-585.3203125
value loss:14.05459976196289
entropies:331.5555419921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9260289669036865 seconds
19 rew tensor(1.1592, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
19 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(0.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1206, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
18 gae_duplicate tensor(0.0345, dtype=torch.float64) tensor(-1.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0696, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
17 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-1.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
16 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-1.4243, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7889, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
15 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-0.5731, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4980, dtype=torch.float64) delta_t tensor(-0.0575, dtype=torch.float64)
14 gae_duplicate tensor(-1.2670, dtype=torch.float64) tensor(0.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2192, dtype=torch.float64) delta_t tensor(-0.1465, dtype=torch.float64)
13 gae_duplicate tensor(-0.8845, dtype=torch.float64) tensor(3.3866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5100, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
12 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-2.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
11 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-1.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0390, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
10 gae_duplicate tensor(0.0348, dtype=torch.float64) tensor(-2.1224, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1880, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
9 gae_duplicate tensor(0.0829, dtype=torch.float64) tensor(-2.8316, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4456, dtype=torch.float64) delta_t tensor(-0.0760, dtype=torch.float64)
8 gae_duplicate tensor(-0.1534, dtype=torch.float64) tensor(1.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3658, dtype=torch.float64) delta_t tensor(0.3388, dtype=torch.float64)
7 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-6.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5861, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
6 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-1.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8517, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
5 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(-0.8110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3166, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
4 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-0.7265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5939, dtype=torch.float64) delta_t tensor(-0.0361, dtype=torch.float64)
3 gae_duplicate tensor(-0.2220, dtype=torch.float64) tensor(0.6937, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6483, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
2 gae_duplicate tensor(-0.2649, dtype=torch.float64) tensor(0.8471, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:751.6663818359375
value loss:9.944724082946777
entropies:331.8896179199219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3802.8176)
ToM Target loss= tensor(3963.3511)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.526153802871704 seconds
19 rew tensor(1.1591, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
19 gae_duplicate tensor(-0.0438, dtype=torch.float64) tensor(0.0593, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
18 gae_duplicate tensor(0.0531, dtype=torch.float64) tensor(-2.3312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
17 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-0.9871, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9944, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
16 gae_duplicate tensor(-0.1122, dtype=torch.float64) tensor(-0.1163, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8408, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
15 gae_duplicate tensor(-0.2583, dtype=torch.float64) tensor(-1.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(-0.1530, dtype=torch.float64)
14 gae_duplicate tensor(-1.0138, dtype=torch.float64) tensor(3.7709, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5096, dtype=torch.float64) delta_t tensor(0.1796, dtype=torch.float64)
13 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-3.3503, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3437, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
12 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-2.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
11 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-1.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1033, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
10 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(-0.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5597, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
9 gae_duplicate tensor(0.0350, dtype=torch.float64) tensor(-2.8649, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6006, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
8 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(0.3801, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3897, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
7 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-1.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9180, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
6 gae_duplicate tensor(-0.0895, dtype=torch.float64) tensor(-0.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1155, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
5 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-1.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2145, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
4 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(-0.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6586, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
3 gae_duplicate tensor(-0.2593, dtype=torch.float64) tensor(-1.6690, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1554, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
2 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(0.7100, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:812.1539306640625
value loss:6.06533670425415
entropies:331.847412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.836661100387573 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
19 gae_duplicate tensor(-0.1018, dtype=torch.float64) tensor(0.1227, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
18 gae_duplicate tensor(0.0113, dtype=torch.float64) tensor(-2.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0832, dtype=torch.float64) delta_t tensor(0.0763, dtype=torch.float64)
17 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-1.3925, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9559, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
16 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-0.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
15 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-1.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7262, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
14 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-0.8642, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(-0.0596, dtype=torch.float64)
13 gae_duplicate tensor(-0.6232, dtype=torch.float64) tensor(0.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0866, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
12 gae_duplicate tensor(-0.3434, dtype=torch.float64) tensor(2.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
11 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(-1.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1250, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
10 gae_duplicate tensor(-0.0374, dtype=torch.float64) tensor(-3.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3826, dtype=torch.float64) delta_t tensor(0.1172, dtype=torch.float64)
9 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-2.6280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5514, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
8 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-1.3096, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4994, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
7 gae_duplicate tensor(-0.1552, dtype=torch.float64) tensor(-0.5993, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7535, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
6 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-2.1974, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2161, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
5 gae_duplicate tensor(-0.2587, dtype=torch.float64) tensor(0.8785, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1666, dtype=torch.float64) delta_t tensor(-0.0170, dtype=torch.float64)
4 gae_duplicate tensor(-0.1351, dtype=torch.float64) tensor(0.8459, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6679, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
3 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(0.0409, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1152, dtype=torch.float64) delta_t tensor(-0.1032, dtype=torch.float64)
2 gae_duplicate tensor(-0.6015, dtype=torch.float64) tensor(1.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:549.5263061523438
value loss:5.508732318878174
entropies:331.58648681640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.821979999542236 seconds
19 rew tensor(1.1975, dtype=torch.float64) delta_t tensor(-0.0089, dtype=torch.float64)
19 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(0.2210, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2359, dtype=torch.float64) delta_t tensor(0.1878, dtype=torch.float64)
18 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-2.9252, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8054, dtype=torch.float64) delta_t tensor(-0.2140, dtype=torch.float64)
17 gae_duplicate tensor(-1.3223, dtype=torch.float64) tensor(5.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9805, dtype=torch.float64) delta_t tensor(0.0487, dtype=torch.float64)
16 gae_duplicate tensor(-0.0878, dtype=torch.float64) tensor(-0.3949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(0.2976, dtype=torch.float64)
15 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-6.4184, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6488, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
14 gae_duplicate tensor(-0.1985, dtype=torch.float64) tensor(-2.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6879, dtype=torch.float64) delta_t tensor(0.2851, dtype=torch.float64)
13 gae_duplicate tensor(-0.0238, dtype=torch.float64) tensor(-4.9259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1619, dtype=torch.float64) delta_t tensor(0.0779, dtype=torch.float64)
12 gae_duplicate tensor(-0.8259, dtype=torch.float64) tensor(-1.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1305, dtype=torch.float64) delta_t tensor(-0.4507, dtype=torch.float64)
11 gae_duplicate tensor(-2.8681, dtype=torch.float64) tensor(6.6136, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0087, dtype=torch.float64) delta_t tensor(0.3180, dtype=torch.float64)
10 gae_duplicate tensor(-0.2025, dtype=torch.float64) tensor(-4.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3967, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
9 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(-2.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7554, dtype=torch.float64) delta_t tensor(-0.1836, dtype=torch.float64)
8 gae_duplicate tensor(-0.8248, dtype=torch.float64) tensor(3.1711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2294, dtype=torch.float64) delta_t tensor(-0.0944, dtype=torch.float64)
7 gae_duplicate tensor(-1.6243, dtype=torch.float64) tensor(1.7386, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9957, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
6 gae_duplicate tensor(-0.9259, dtype=torch.float64) tensor(0.1202, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3931, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
5 gae_duplicate tensor(-0.0937, dtype=torch.float64) tensor(-3.2057, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1107, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
4 gae_duplicate tensor(-0.3127, dtype=torch.float64) tensor(-2.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4022, dtype=torch.float64) delta_t tensor(-0.1075, dtype=torch.float64)
3 gae_duplicate tensor(-0.3168, dtype=torch.float64) tensor(1.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4552, dtype=torch.float64) delta_t tensor(0.1887, dtype=torch.float64)
2 gae_duplicate tensor(-0.0839, dtype=torch.float64) tensor(-2.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:739.3192138671875
value loss:35.24031066894531
entropies:331.656005859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.81109094619751 seconds
19 rew tensor(1.1339, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
19 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(0.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.1410, dtype=torch.float64)
18 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-2.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
17 gae_duplicate tensor(0.0720, dtype=torch.float64) tensor(-2.3591, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9945, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
16 gae_duplicate tensor(-0.1819, dtype=torch.float64) tensor(-0.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9300, dtype=torch.float64) delta_t tensor(0.0452, dtype=torch.float64)
15 gae_duplicate tensor(-0.0429, dtype=torch.float64) tensor(-1.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5357, dtype=torch.float64) delta_t tensor(-0.1337, dtype=torch.float64)
14 gae_duplicate tensor(-1.1801, dtype=torch.float64) tensor(3.4052, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2399, dtype=torch.float64) delta_t tensor(-0.3160, dtype=torch.float64)
13 gae_duplicate tensor(-1.2246, dtype=torch.float64) tensor(6.1461, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3952, dtype=torch.float64) delta_t tensor(-0.0275, dtype=torch.float64)
12 gae_duplicate tensor(-0.9393, dtype=torch.float64) tensor(1.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4781, dtype=torch.float64) delta_t tensor(-0.5734, dtype=torch.float64)
11 gae_duplicate tensor(-3.7506, dtype=torch.float64) tensor(13.3066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2548, dtype=torch.float64) delta_t tensor(0.1690, dtype=torch.float64)
10 gae_duplicate tensor(-0.0165, dtype=torch.float64) tensor(-1.7392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(0.0785, dtype=torch.float64)
9 gae_duplicate tensor(-4.4992e-05, dtype=torch.float64) tensor(-2.0038, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4346, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
8 gae_duplicate tensor(-0.2865, dtype=torch.float64) tensor(0.5856, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2296, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
7 gae_duplicate tensor(-0.4002, dtype=torch.float64) tensor(-0.0920, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6523, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
6 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-2.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5970, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
5 gae_duplicate tensor(-0.1732, dtype=torch.float64) tensor(-3.1114, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1658, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
4 gae_duplicate tensor(-0.1365, dtype=torch.float64) tensor(-0.2766, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3185, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
3 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(0.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5230, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
2 gae_duplicate tensor(-0.1949, dtype=torch.float64) tensor(-1.3226, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-580.6680297851562
value loss:33.86067199707031
entropies:331.5660400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.5799338817596436 seconds
19 rew tensor(1.1082, dtype=torch.float64) delta_t tensor(-0.0508, dtype=torch.float64)
19 gae_duplicate tensor(-0.1384, dtype=torch.float64) tensor(0.8840, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1082, dtype=torch.float64) delta_t tensor(0.1381, dtype=torch.float64)
18 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-2.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0068, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
17 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-1.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9297, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
16 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(0.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8405, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
15 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(0.9862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7894, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
14 gae_duplicate tensor(-0.0327, dtype=torch.float64) tensor(-1.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6751, dtype=torch.float64) delta_t tensor(0.2559, dtype=torch.float64)
13 gae_duplicate tensor(0.1012, dtype=torch.float64) tensor(-4.5501, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(0.1283, dtype=torch.float64)
12 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(-2.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
11 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(-1.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0387, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
10 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(1.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3037, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
9 gae_duplicate tensor(-0.1721, dtype=torch.float64) tensor(-0.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4471, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
8 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(0.9274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8943, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
7 gae_duplicate tensor(-0.0302, dtype=torch.float64) tensor(-2.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5494, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
6 gae_duplicate tensor(-0.0635, dtype=torch.float64) tensor(-1.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6471, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
5 gae_duplicate tensor(-0.2319, dtype=torch.float64) tensor(0.3277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0623, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
4 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(1.0361, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1620, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
3 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(1.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
2 gae_duplicate tensor(-0.3059, dtype=torch.float64) tensor(1.3486, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:446.6543884277344
value loss:5.169454574584961
entropies:331.02227783203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3774.0632)
ToM Target loss= tensor(3967.3064)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.809738874435425 seconds
19 rew tensor(1.1601, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
19 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(0.9470, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1601, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
18 gae_duplicate tensor(0.0089, dtype=torch.float64) tensor(-1.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0711, dtype=torch.float64) delta_t tensor(0.0343, dtype=torch.float64)
17 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-0.7205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0580, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
16 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(-0.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6484, dtype=torch.float64) delta_t tensor(-0.2235, dtype=torch.float64)
15 gae_duplicate tensor(-1.4024, dtype=torch.float64) tensor(5.5286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6218, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
14 gae_duplicate tensor(-1.5848, dtype=torch.float64) tensor(1.1043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0860, dtype=torch.float64) delta_t tensor(-0.3282, dtype=torch.float64)
13 gae_duplicate tensor(-2.4944, dtype=torch.float64) tensor(8.5458, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(-0.2919, dtype=torch.float64)
12 gae_duplicate tensor(-2.6739, dtype=torch.float64) tensor(4.2276, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2917, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
11 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-0.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1655, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
10 gae_duplicate tensor(-0.2056, dtype=torch.float64) tensor(-5.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4706, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
9 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(-1.0027, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6906, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
8 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-0.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2698, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
7 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-0.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9580, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
6 gae_duplicate tensor(0.0600, dtype=torch.float64) tensor(-3.1607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0871, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
5 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-0.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4219, dtype=torch.float64) delta_t tensor(-0.1345, dtype=torch.float64)
4 gae_duplicate tensor(-0.3172, dtype=torch.float64) tensor(2.4718, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5135, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
3 gae_duplicate tensor(-0.3428, dtype=torch.float64) tensor(-0.5179, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(-0.1767, dtype=torch.float64)
2 gae_duplicate tensor(-0.5451, dtype=torch.float64) tensor(3.0012, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-661.2003173828125
value loss:34.364463806152344
entropies:330.73529052734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.87558913230896 seconds
19 rew tensor(1.1718, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
19 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(0.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.1538, dtype=torch.float64)
18 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-2.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0826, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
17 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-1.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6394, dtype=torch.float64) delta_t tensor(-0.2629, dtype=torch.float64)
16 gae_duplicate tensor(-1.2998, dtype=torch.float64) tensor(3.8755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0065, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
15 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-2.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6234, dtype=torch.float64) delta_t tensor(0.0414, dtype=torch.float64)
14 gae_duplicate tensor(-0.0833, dtype=torch.float64) tensor(-0.7401, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7378, dtype=torch.float64) delta_t tensor(0.2403, dtype=torch.float64)
13 gae_duplicate tensor(0.1226, dtype=torch.float64) tensor(-4.9701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2037, dtype=torch.float64) delta_t tensor(0.0005, dtype=torch.float64)
12 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-0.4125, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5084, dtype=torch.float64) delta_t tensor(0.0867, dtype=torch.float64)
11 gae_duplicate tensor(-0.0835, dtype=torch.float64) tensor(-1.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1281, dtype=torch.float64) delta_t tensor(-0.0305, dtype=torch.float64)
10 gae_duplicate tensor(-0.2686, dtype=torch.float64) tensor(0.2836, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4573, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
9 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-1.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7278, dtype=torch.float64) delta_t tensor(-0.1176, dtype=torch.float64)
8 gae_duplicate tensor(-0.3332, dtype=torch.float64) tensor(1.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0138, dtype=torch.float64) delta_t tensor(-0.2239, dtype=torch.float64)
7 gae_duplicate tensor(-1.8545, dtype=torch.float64) tensor(3.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8042, dtype=torch.float64) delta_t tensor(0.1249, dtype=torch.float64)
6 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(-1.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3414, dtype=torch.float64) delta_t tensor(0.0754, dtype=torch.float64)
5 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-1.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0152, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
4 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(-0.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0206, dtype=torch.float64) delta_t tensor(-0.1541, dtype=torch.float64)
3 gae_duplicate tensor(-0.2982, dtype=torch.float64) tensor(2.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3296, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
2 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-1.8217, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:416.1486511230469
value loss:13.221837997436523
entropies:330.0327453613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.592444896697998 seconds
19 rew tensor(1.2357, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
19 gae_duplicate tensor(-0.0959, dtype=torch.float64) tensor(0.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(0.0870, dtype=torch.float64)
18 gae_duplicate tensor(0.0256, dtype=torch.float64) tensor(-1.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1845, dtype=torch.float64) delta_t tensor(0.1084, dtype=torch.float64)
17 gae_duplicate tensor(0.0428, dtype=torch.float64) tensor(-2.2336, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0691, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
16 gae_duplicate tensor(-0.1858, dtype=torch.float64) tensor(-1.7371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(-0.2045, dtype=torch.float64)
15 gae_duplicate tensor(-1.1046, dtype=torch.float64) tensor(3.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6112, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
14 gae_duplicate tensor(-0.6582, dtype=torch.float64) tensor(0.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1409, dtype=torch.float64) delta_t tensor(-0.5367, dtype=torch.float64)
13 gae_duplicate tensor(-2.6004, dtype=torch.float64) tensor(7.9569, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0608, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
12 gae_duplicate tensor(-1.4130, dtype=torch.float64) tensor(2.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3453, dtype=torch.float64) delta_t tensor(0.1227, dtype=torch.float64)
11 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-1.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0731, dtype=torch.float64) delta_t tensor(0.1644, dtype=torch.float64)
10 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-2.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3593, dtype=torch.float64) delta_t tensor(0.1146, dtype=torch.float64)
9 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-2.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5892, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
8 gae_duplicate tensor(-0.2070, dtype=torch.float64) tensor(0.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3988, dtype=torch.float64) delta_t tensor(-0.0905, dtype=torch.float64)
7 gae_duplicate tensor(-0.6788, dtype=torch.float64) tensor(1.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7298, dtype=torch.float64) delta_t tensor(0.0770, dtype=torch.float64)
6 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-1.1218, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6958, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
5 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-1.1688, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2645, dtype=torch.float64) delta_t tensor(0.0284, dtype=torch.float64)
4 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-0.3676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5550, dtype=torch.float64) delta_t tensor(-0.0530, dtype=torch.float64)
3 gae_duplicate tensor(-0.3446, dtype=torch.float64) tensor(0.5434, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5964, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
2 gae_duplicate tensor(-0.4028, dtype=torch.float64) tensor(-0.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-147.56700134277344
value loss:23.106361389160156
entropies:329.60772705078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7441020011901855 seconds
19 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
19 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(1.0931, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1087, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
18 gae_duplicate tensor(0.0266, dtype=torch.float64) tensor(-1.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
17 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-1.0986, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9553, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
16 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-0.0302, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8661, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
15 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-0.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6878, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
14 gae_duplicate tensor(-0.0968, dtype=torch.float64) tensor(-1.4641, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6625, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
13 gae_duplicate tensor(-0.0289, dtype=torch.float64) tensor(-1.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
12 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(0.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.0802, dtype=torch.float64)
11 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(-1.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0373, dtype=torch.float64) delta_t tensor(0.0680, dtype=torch.float64)
10 gae_duplicate tensor(-0.0411, dtype=torch.float64) tensor(-1.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3177, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
9 gae_duplicate tensor(-0.0829, dtype=torch.float64) tensor(-1.2922, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5888, dtype=torch.float64) delta_t tensor(-0.1157, dtype=torch.float64)
8 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(1.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5227, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
7 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(-0.3791, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6910, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
6 gae_duplicate tensor(-0.0958, dtype=torch.float64) tensor(-1.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3655, dtype=torch.float64) delta_t tensor(-0.0372, dtype=torch.float64)
5 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(0.6828, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1169, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
4 gae_duplicate tensor(-0.1078, dtype=torch.float64) tensor(-0.2792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7663, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
3 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(0.3732, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
2 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(-0.4953, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:324.0697326660156
value loss:2.2266979217529297
entropies:329.57373046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.590983152389526 seconds
19 rew tensor(1.1466, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
19 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(0.7716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1472, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
18 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-2.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0575, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
17 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-0.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(-0.0159, dtype=torch.float64)
16 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(0.0561, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8921, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
15 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-2.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4319, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
14 gae_duplicate tensor(-1.1341, dtype=torch.float64) tensor(1.2801, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
13 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-2.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2015, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
12 gae_duplicate tensor(-0.0830, dtype=torch.float64) tensor(-1.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5616, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
11 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-1.2273, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1300, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
10 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-0.5112, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4985, dtype=torch.float64) delta_t tensor(0.0466, dtype=torch.float64)
9 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-0.8935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7054, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
8 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(0.9761, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8396, dtype=torch.float64) delta_t tensor(-0.2317, dtype=torch.float64)
7 gae_duplicate tensor(-0.8713, dtype=torch.float64) tensor(3.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7687, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
6 gae_duplicate tensor(-0.0324, dtype=torch.float64) tensor(-0.6125, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3637, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
5 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-0.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0165, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
4 gae_duplicate tensor(-0.0210, dtype=torch.float64) tensor(-0.3679, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9679, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
3 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(0.6674, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3407, dtype=torch.float64) delta_t tensor(0.0548, dtype=torch.float64)
2 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-0.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:209.79083251953125
value loss:6.696583271026611
entropies:329.43359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3791.6040)
ToM Target loss= tensor(3966.8079)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.731109857559204 seconds
19 rew tensor(1.1843, dtype=torch.float64) delta_t tensor(-0.0519, dtype=torch.float64)
19 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(1.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1971, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
18 gae_duplicate tensor(-0.0252, dtype=torch.float64) tensor(-1.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1718, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
17 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-2.2817, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(-0.2344, dtype=torch.float64)
16 gae_duplicate tensor(-1.2380, dtype=torch.float64) tensor(3.4001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9178, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
15 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(0.8690, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(-0.2199, dtype=torch.float64)
14 gae_duplicate tensor(-2.2248, dtype=torch.float64) tensor(2.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6370, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
13 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-1.5725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4306, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
12 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-1.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3318, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
11 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-2.0988, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1109, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
10 gae_duplicate tensor(-0.1973, dtype=torch.float64) tensor(-1.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1789, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
9 gae_duplicate tensor(-0.2736, dtype=torch.float64) tensor(0.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5245, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
8 gae_duplicate tensor(-0.2533, dtype=torch.float64) tensor(0.9865, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0831, dtype=torch.float64) delta_t tensor(-0.5758, dtype=torch.float64)
7 gae_duplicate tensor(-3.1802, dtype=torch.float64) tensor(8.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7401, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
6 gae_duplicate tensor(-0.4512, dtype=torch.float64) tensor(0.3332, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6228, dtype=torch.float64) delta_t tensor(0.1234, dtype=torch.float64)
5 gae_duplicate tensor(-0.1996, dtype=torch.float64) tensor(-1.9282, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2654, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
4 gae_duplicate tensor(-0.1737, dtype=torch.float64) tensor(-2.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5189, dtype=torch.float64) delta_t tensor(-0.1429, dtype=torch.float64)
3 gae_duplicate tensor(-0.3508, dtype=torch.float64) tensor(2.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6099, dtype=torch.float64) delta_t tensor(0.0715, dtype=torch.float64)
2 gae_duplicate tensor(-0.2578, dtype=torch.float64) tensor(-0.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-347.6900634765625
value loss:31.071760177612305
entropies:329.6471252441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.739023685455322 seconds
19 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(-0.0734, dtype=torch.float64)
19 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(1.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
18 gae_duplicate tensor(-0.0824, dtype=torch.float64) tensor(-0.6988, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0825, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
17 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-0.8289, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
16 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-0.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6495, dtype=torch.float64) delta_t tensor(-0.2829, dtype=torch.float64)
15 gae_duplicate tensor(-1.3383, dtype=torch.float64) tensor(4.8962, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7254, dtype=torch.float64) delta_t tensor(0.1308, dtype=torch.float64)
14 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(-2.1209, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(0.2084, dtype=torch.float64)
13 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-4.5553, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3933, dtype=torch.float64) delta_t tensor(0.1034, dtype=torch.float64)
12 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(-2.2449, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(-0.1960, dtype=torch.float64)
11 gae_duplicate tensor(-1.0996, dtype=torch.float64) tensor(4.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1003, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
10 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(-0.1454, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3445, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
9 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-1.6616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5880, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
8 gae_duplicate tensor(-0.3407, dtype=torch.float64) tensor(1.3110, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3492, dtype=torch.float64) delta_t tensor(-0.8480, dtype=torch.float64)
7 gae_duplicate tensor(-4.7007, dtype=torch.float64) tensor(20.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8952, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
6 gae_duplicate tensor(-0.6181, dtype=torch.float64) tensor(-0.1509, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0582, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
5 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(-0.7072, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2193, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
4 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-0.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6237, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
3 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(-0.9420, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0739, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
2 gae_duplicate tensor(-0.3436, dtype=torch.float64) tensor(-0.7735, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-976.2357177734375
value loss:44.47158432006836
entropies:330.27313232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.813756942749023 seconds
19 rew tensor(1.1586, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
19 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(0.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
18 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-1.3681, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0827, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
17 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-0.9381, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
16 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(0.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(-0.0924, dtype=torch.float64)
15 gae_duplicate tensor(-0.1597, dtype=torch.float64) tensor(1.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4315, dtype=torch.float64) delta_t tensor(-0.2452, dtype=torch.float64)
14 gae_duplicate tensor(-1.2144, dtype=torch.float64) tensor(3.8378, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(-0.0660, dtype=torch.float64)
13 gae_duplicate tensor(-1.2500, dtype=torch.float64) tensor(0.7948, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
12 gae_duplicate tensor(-0.1274, dtype=torch.float64) tensor(-0.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3559, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
11 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(-0.4480, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0774, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
10 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(0.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2539, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
9 gae_duplicate tensor(-0.2410, dtype=torch.float64) tensor(-0.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4854, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
8 gae_duplicate tensor(-0.1180, dtype=torch.float64) tensor(1.4964, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1352, dtype=torch.float64) delta_t tensor(-0.1193, dtype=torch.float64)
7 gae_duplicate tensor(-0.6748, dtype=torch.float64) tensor(2.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5878, dtype=torch.float64) delta_t tensor(0.1968, dtype=torch.float64)
6 gae_duplicate tensor(0.0673, dtype=torch.float64) tensor(-3.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6466, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
5 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(0.1874, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0622, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
4 gae_duplicate tensor(-0.1726, dtype=torch.float64) tensor(-0.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1615, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
3 gae_duplicate tensor(-0.1890, dtype=torch.float64) tensor(-0.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3939, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
2 gae_duplicate tensor(-0.3035, dtype=torch.float64) tensor(-0.0256, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-328.578369140625
value loss:9.149225234985352
entropies:330.38995361328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.768536806106567 seconds
19 rew tensor(1.1717, dtype=torch.float64) delta_t tensor(-0.1220, dtype=torch.float64)
19 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(2.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1463, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
18 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-0.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1206, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
17 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-1.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(0.0168, dtype=torch.float64)
16 gae_duplicate tensor(-0.1454, dtype=torch.float64) tensor(-0.4304, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9164, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
15 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(-2.8012, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6887, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
14 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(-1.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4942, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
13 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-4.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
12 gae_duplicate tensor(-1.3553, dtype=torch.float64) tensor(2.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3527, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
11 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-0.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1409, dtype=torch.float64) delta_t tensor(0.2708, dtype=torch.float64)
10 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-5.0101, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2890, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
9 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-0.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6514, dtype=torch.float64) delta_t tensor(0.0504, dtype=torch.float64)
8 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-1.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4641, dtype=torch.float64) delta_t tensor(0.1870, dtype=torch.float64)
7 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-3.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8787, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
6 gae_duplicate tensor(-0.1359, dtype=torch.float64) tensor(-2.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2435, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
5 gae_duplicate tensor(-0.1980, dtype=torch.float64) tensor(-0.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2151, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
4 gae_duplicate tensor(-0.2420, dtype=torch.float64) tensor(-0.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7981, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
3 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(-1.0860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1290, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
2 gae_duplicate tensor(-0.3180, dtype=torch.float64) tensor(0.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1057.9307861328125
value loss:9.88492488861084
entropies:330.82708740234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.626723051071167 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(-0.0649, dtype=torch.float64)
19 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(1.0467, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1967, dtype=torch.float64) delta_t tensor(0.0825, dtype=torch.float64)
18 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-1.3978, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0315, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
17 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(-0.0460, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
16 gae_duplicate tensor(-0.1834, dtype=torch.float64) tensor(1.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
15 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(0.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5864, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
14 gae_duplicate tensor(-0.4827, dtype=torch.float64) tensor(-0.1029, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6486, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
13 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(-2.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
12 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-1.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1296, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
11 gae_duplicate tensor(-1.0493, dtype=torch.float64) tensor(1.8698, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0523, dtype=torch.float64) delta_t tensor(-0.0230, dtype=torch.float64)
10 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(0.5690, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3302, dtype=torch.float64) delta_t tensor(0.1731, dtype=torch.float64)
9 gae_duplicate tensor(-0.0536, dtype=torch.float64) tensor(-3.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5610, dtype=torch.float64) delta_t tensor(-0.1724, dtype=torch.float64)
8 gae_duplicate tensor(-0.3579, dtype=torch.float64) tensor(2.7601, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3270, dtype=torch.float64) delta_t tensor(-0.4419, dtype=torch.float64)
7 gae_duplicate tensor(-2.0063, dtype=torch.float64) tensor(7.5018, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7021, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
6 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-1.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5456, dtype=torch.float64) delta_t tensor(-0.0824, dtype=torch.float64)
5 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(2.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0117, dtype=torch.float64) delta_t tensor(0.0243, dtype=torch.float64)
4 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1116, dtype=torch.float64) delta_t tensor(-0.0408, dtype=torch.float64)
3 gae_duplicate tensor(-0.3153, dtype=torch.float64) tensor(0.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3562, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
2 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(0.1374, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-540.5912475585938
value loss:12.847707748413086
entropies:331.1259460449219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3764.9116)
ToM Target loss= tensor(3967.3254)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.812618017196655 seconds
19 rew tensor(1.2100, dtype=torch.float64) delta_t tensor(-0.0824, dtype=torch.float64)
19 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(1.5342, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
18 gae_duplicate tensor(0.0194, dtype=torch.float64) tensor(-1.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8251, dtype=torch.float64) delta_t tensor(-0.2161, dtype=torch.float64)
17 gae_duplicate tensor(-1.5070, dtype=torch.float64) tensor(2.8242, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9295, dtype=torch.float64) delta_t tensor(-0.0691, dtype=torch.float64)
16 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(1.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9164, dtype=torch.float64) delta_t tensor(-0.0577, dtype=torch.float64)
15 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(1.0776, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0983, dtype=torch.float64) delta_t tensor(-0.5717, dtype=torch.float64)
14 gae_duplicate tensor(-2.1493, dtype=torch.float64) tensor(12.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7136, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
13 gae_duplicate tensor(-0.0541, dtype=torch.float64) tensor(-1.9777, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
12 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-0.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4708, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
11 gae_duplicate tensor(-0.2463, dtype=torch.float64) tensor(-0.1979, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1676, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
10 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(0.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4064, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
9 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(1.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4978, dtype=torch.float64) delta_t tensor(-0.0786, dtype=torch.float64)
8 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(1.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7420, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
7 gae_duplicate tensor(-0.2080, dtype=torch.float64) tensor(-0.9354, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5617, dtype=torch.float64) delta_t tensor(0.1364, dtype=torch.float64)
6 gae_duplicate tensor(0.0371, dtype=torch.float64) tensor(-2.7045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5707, dtype=torch.float64) delta_t tensor(-0.0642, dtype=torch.float64)
5 gae_duplicate tensor(-0.1985, dtype=torch.float64) tensor(0.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0140, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
4 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(2.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0348, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
3 gae_duplicate tensor(-0.3087, dtype=torch.float64) tensor(1.5962, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3304, dtype=torch.float64) delta_t tensor(-0.1643, dtype=torch.float64)
2 gae_duplicate tensor(-0.3079, dtype=torch.float64) tensor(3.3452, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1336.1351318359375
value loss:15.162273406982422
entropies:331.50445556640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.564788103103638 seconds
19 rew tensor(1.1327, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
19 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(2.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1718, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
18 gae_duplicate tensor(-0.0060, dtype=torch.float64) tensor(-0.6247, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
17 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-0.7238, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0696, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
16 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(0.5169, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9556, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
15 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-0.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3315, dtype=torch.float64) delta_t tensor(-0.3784, dtype=torch.float64)
14 gae_duplicate tensor(-2.1380, dtype=torch.float64) tensor(8.7904, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3041, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
13 gae_duplicate tensor(-0.5815, dtype=torch.float64) tensor(0.4612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4953, dtype=torch.float64) delta_t tensor(0.1360, dtype=torch.float64)
12 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-2.1468, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
11 gae_duplicate tensor(-0.2819, dtype=torch.float64) tensor(0.1013, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0871, dtype=torch.float64) delta_t tensor(0.1577, dtype=torch.float64)
10 gae_duplicate tensor(0.0679, dtype=torch.float64) tensor(-2.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3835, dtype=torch.float64) delta_t tensor(0.1697, dtype=torch.float64)
9 gae_duplicate tensor(-0.0574, dtype=torch.float64) tensor(-3.1986, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6275, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
8 gae_duplicate tensor(-0.1402, dtype=torch.float64) tensor(-0.9306, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7553, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
7 gae_duplicate tensor(-1.6427, dtype=torch.float64) tensor(5.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7930, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
6 gae_duplicate tensor(-0.2788, dtype=torch.float64) tensor(0.0311, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6189, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
5 gae_duplicate tensor(-0.4783, dtype=torch.float64) tensor(0.2300, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1621, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
4 gae_duplicate tensor(-0.1507, dtype=torch.float64) tensor(-0.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4267, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
3 gae_duplicate tensor(-0.2870, dtype=torch.float64) tensor(-0.6048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5064, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
2 gae_duplicate tensor(-0.1573, dtype=torch.float64) tensor(0.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-408.5315856933594
value loss:17.180797576904297
entropies:331.9085998535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.619543075561523 seconds
19 rew tensor(1.0825, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
19 gae_duplicate tensor(-0.1531, dtype=torch.float64) tensor(2.4021, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0699, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
18 gae_duplicate tensor(-0.0834, dtype=torch.float64) tensor(0.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0314, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
17 gae_duplicate tensor(-0.0482, dtype=torch.float64) tensor(-0.0983, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9814, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
16 gae_duplicate tensor(-0.2539, dtype=torch.float64) tensor(1.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.1535, dtype=torch.float64)
15 gae_duplicate tensor(-0.3699, dtype=torch.float64) tensor(2.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
14 gae_duplicate tensor(-0.2365, dtype=torch.float64) tensor(-0.6651, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7246, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
13 gae_duplicate tensor(-0.0297, dtype=torch.float64) tensor(-0.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2417, dtype=torch.float64) delta_t tensor(-0.1142, dtype=torch.float64)
12 gae_duplicate tensor(-0.2587, dtype=torch.float64) tensor(2.1528, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
11 gae_duplicate tensor(-0.3028, dtype=torch.float64) tensor(0.9028, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1411, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
10 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(0.9226, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4077, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
9 gae_duplicate tensor(-0.1493, dtype=torch.float64) tensor(-0.4015, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4348, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
8 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-0.5970, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4486, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
7 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-0.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7547, dtype=torch.float64) delta_t tensor(0.1220, dtype=torch.float64)
6 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-2.2526, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1867, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
5 gae_duplicate tensor(-0.2260, dtype=torch.float64) tensor(0.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2951, dtype=torch.float64) delta_t tensor(-0.0618, dtype=torch.float64)
4 gae_duplicate tensor(-0.2205, dtype=torch.float64) tensor(1.4422, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4862, dtype=torch.float64) delta_t tensor(-7.9556e-05, dtype=torch.float64)
3 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(0.5332, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0621, dtype=torch.float64) delta_t tensor(-0.1675, dtype=torch.float64)
2 gae_duplicate tensor(-0.3084, dtype=torch.float64) tensor(2.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-675.349853515625
value loss:3.2372636795043945
entropies:331.78094482421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.831329107284546 seconds
19 rew tensor(1.2349, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
19 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(1.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2102, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
18 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-1.4174, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0827, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
17 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-0.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0062, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
16 gae_duplicate tensor(-0.1048, dtype=torch.float64) tensor(-0.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8912, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
15 gae_duplicate tensor(-0.3308, dtype=torch.float64) tensor(0.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3661, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
14 gae_duplicate tensor(-0.7205, dtype=torch.float64) tensor(2.8117, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7375, dtype=torch.float64) delta_t tensor(0.2343, dtype=torch.float64)
13 gae_duplicate tensor(-0.0157, dtype=torch.float64) tensor(-3.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1772, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
12 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-0.7488, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5731, dtype=torch.float64) delta_t tensor(0.2171, dtype=torch.float64)
11 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-4.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(-0.1247, dtype=torch.float64)
10 gae_duplicate tensor(-0.4108, dtype=torch.float64) tensor(2.3180, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
9 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-0.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7293, dtype=torch.float64) delta_t tensor(-0.1436, dtype=torch.float64)
8 gae_duplicate tensor(-0.4051, dtype=torch.float64) tensor(2.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5694, dtype=torch.float64) delta_t tensor(-0.3250, dtype=torch.float64)
7 gae_duplicate tensor(-2.0899, dtype=torch.float64) tensor(7.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9330, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
6 gae_duplicate tensor(-0.2201, dtype=torch.float64) tensor(0.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3913, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
5 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(-2.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0631, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
4 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-0.9304, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2528, dtype=torch.float64) delta_t tensor(-0.1478, dtype=torch.float64)
3 gae_duplicate tensor(-0.2850, dtype=torch.float64) tensor(3.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3947, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
2 gae_duplicate tensor(-0.4170, dtype=torch.float64) tensor(0.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.6191711425781
value loss:12.974050521850586
entropies:332.1617126464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.444050073623657 seconds
19 rew tensor(1.1583, dtype=torch.float64) delta_t tensor(-0.0773, dtype=torch.float64)
19 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(1.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1711, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
18 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-1.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8634, dtype=torch.float64) delta_t tensor(-0.1101, dtype=torch.float64)
17 gae_duplicate tensor(-1.1268, dtype=torch.float64) tensor(1.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9807, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
16 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(0.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8278, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
15 gae_duplicate tensor(-0.2678, dtype=torch.float64) tensor(-0.5912, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7385, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
14 gae_duplicate tensor(-0.1292, dtype=torch.float64) tensor(-2.9834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5608, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
13 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(0.1063, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4704, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
12 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(-1.6993, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3177, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
11 gae_duplicate tensor(-0.3365, dtype=torch.float64) tensor(1.6579, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2149, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
10 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(0.3204, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
9 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(-0.4209, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4593, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
8 gae_duplicate tensor(-0.2898, dtype=torch.float64) tensor(-0.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4846, dtype=torch.float64) delta_t tensor(-0.4776, dtype=torch.float64)
7 gae_duplicate tensor(-3.0655, dtype=torch.float64) tensor(7.4598, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8444, dtype=torch.float64) delta_t tensor(-0.0024, dtype=torch.float64)
6 gae_duplicate tensor(-0.6213, dtype=torch.float64) tensor(0.7524, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3389, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
5 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-2.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0364, dtype=torch.float64) delta_t tensor(0.1322, dtype=torch.float64)
4 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-2.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0470, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
3 gae_duplicate tensor(-0.3470, dtype=torch.float64) tensor(1.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3804, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
2 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(-0.8426, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-199.05218505859375
value loss:22.284610748291016
entropies:331.9683837890625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3780.7842)
ToM Target loss= tensor(3969.8398)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.98225998878479 seconds
19 rew tensor(1.1452, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
19 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(1.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1582, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
18 gae_duplicate tensor(-0.0165, dtype=torch.float64) tensor(-1.6937, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0555, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
17 gae_duplicate tensor(-0.1160, dtype=torch.float64) tensor(-1.2394, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0050, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
16 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(-0.7376, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8773, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
15 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(-2.4350, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6870, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
14 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(-2.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6368, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
13 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(-1.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4426, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
12 gae_duplicate tensor(-0.2288, dtype=torch.float64) tensor(-2.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3957, dtype=torch.float64) delta_t tensor(-0.0954, dtype=torch.float64)
11 gae_duplicate tensor(-0.3154, dtype=torch.float64) tensor(1.2288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0724, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
10 gae_duplicate tensor(-0.2140, dtype=torch.float64) tensor(0.2157, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2809, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
9 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(0.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
8 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(-1.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0723, dtype=torch.float64) delta_t tensor(-0.2645, dtype=torch.float64)
7 gae_duplicate tensor(-1.5438, dtype=torch.float64) tensor(6.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7775, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
6 gae_duplicate tensor(-0.3276, dtype=torch.float64) tensor(-0.4947, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3900, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
5 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-0.9511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0177, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
4 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-0.4003, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0411, dtype=torch.float64) delta_t tensor(-0.0531, dtype=torch.float64)
3 gae_duplicate tensor(-0.2481, dtype=torch.float64) tensor(0.8850, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3395, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
2 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(-0.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:275.01165771484375
value loss:11.645829200744629
entropies:332.2548522949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.534480810165405 seconds
19 rew tensor(1.1714, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
19 gae_duplicate tensor(-0.1690, dtype=torch.float64) tensor(1.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
18 gae_duplicate tensor(-0.0241, dtype=torch.float64) tensor(-0.7385, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
17 gae_duplicate tensor(-0.0403, dtype=torch.float64) tensor(-1.9529, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0314, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
16 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(-0.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8010, dtype=torch.float64) delta_t tensor(-0.0175, dtype=torch.float64)
15 gae_duplicate tensor(-0.2031, dtype=torch.float64) tensor(-0.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7130, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
14 gae_duplicate tensor(-0.0656, dtype=torch.float64) tensor(-2.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3797, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
13 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(-0.3631, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5727, dtype=torch.float64) delta_t tensor(0.0272, dtype=torch.float64)
12 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-0.3177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
11 gae_duplicate tensor(-0.2289, dtype=torch.float64) tensor(-0.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3068, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
10 gae_duplicate tensor(-0.2244, dtype=torch.float64) tensor(-0.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0542, dtype=torch.float64) delta_t tensor(0.0990, dtype=torch.float64)
9 gae_duplicate tensor(-0.2640, dtype=torch.float64) tensor(-1.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3447, dtype=torch.float64) delta_t tensor(0.0981, dtype=torch.float64)
8 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-2.4210, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4320, dtype=torch.float64) delta_t tensor(0.1761, dtype=torch.float64)
7 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(-3.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4851, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
6 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-1.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9023, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
5 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(-1.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3443, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
4 gae_duplicate tensor(-0.0487, dtype=torch.float64) tensor(-2.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5850, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
3 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(-0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6883, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
2 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-2.0632, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1025.4365234375
value loss:5.748051166534424
entropies:332.7817077636719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.802064895629883 seconds
19 rew tensor(1.1581, dtype=torch.float64) delta_t tensor(-0.0810, dtype=torch.float64)
19 gae_duplicate tensor(-0.1854, dtype=torch.float64) tensor(1.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1458, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
18 gae_duplicate tensor(-0.0051, dtype=torch.float64) tensor(-0.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0057, dtype=torch.float64) delta_t tensor(-0.0677, dtype=torch.float64)
17 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(1.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
16 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(0.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9426, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
15 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(0.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8032, dtype=torch.float64) delta_t tensor(0.2834, dtype=torch.float64)
14 gae_duplicate tensor(-0.0305, dtype=torch.float64) tensor(-6.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4176, dtype=torch.float64) delta_t tensor(-0.8162, dtype=torch.float64)
13 gae_duplicate tensor(-3.8327, dtype=torch.float64) tensor(17.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2545, dtype=torch.float64) delta_t tensor(0.2286, dtype=torch.float64)
12 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-2.9023, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
11 gae_duplicate tensor(-0.2564, dtype=torch.float64) tensor(0.9214, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1923, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
10 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(0.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5207, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
9 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(-0.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6512, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
8 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(0.0397, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7431, dtype=torch.float64) delta_t tensor(0.1343, dtype=torch.float64)
7 gae_duplicate tensor(-0.2179, dtype=torch.float64) tensor(-1.8311, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7911, dtype=torch.float64) delta_t tensor(0.0622, dtype=torch.float64)
6 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-1.0812, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5206, dtype=torch.float64) delta_t tensor(0.0568, dtype=torch.float64)
5 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(-1.5121, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0384, dtype=torch.float64) delta_t tensor(-0.1140, dtype=torch.float64)
4 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(1.8365, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1523, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
3 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-0.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3183, dtype=torch.float64) delta_t tensor(-0.0050, dtype=torch.float64)
2 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(-0.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-608.9130249023438
value loss:27.879182815551758
entropies:332.87237548828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658827066421509 seconds
19 rew tensor(1.0691, dtype=torch.float64) delta_t tensor(-0.1060, dtype=torch.float64)
19 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(2.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0947, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
18 gae_duplicate tensor(-0.0110, dtype=torch.float64) tensor(-1.3539, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0566, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
17 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-0.8511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8783, dtype=torch.float64) delta_t tensor(-0.0551, dtype=torch.float64)
16 gae_duplicate tensor(-0.1129, dtype=torch.float64) tensor(0.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8528, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
15 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(0.5614, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6489, dtype=torch.float64) delta_t tensor(-0.0445, dtype=torch.float64)
14 gae_duplicate tensor(-0.1268, dtype=torch.float64) tensor(0.9201, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6994, dtype=torch.float64) delta_t tensor(0.0345, dtype=torch.float64)
13 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-0.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3176, dtype=torch.float64) delta_t tensor(-0.1425, dtype=torch.float64)
12 gae_duplicate tensor(-0.2370, dtype=torch.float64) tensor(2.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4063, dtype=torch.float64) delta_t tensor(-0.0610, dtype=torch.float64)
11 gae_duplicate tensor(-0.2489, dtype=torch.float64) tensor(1.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0758, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
10 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(1.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1518, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
9 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(0.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4733, dtype=torch.float64) delta_t tensor(-0.0700, dtype=torch.float64)
8 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(1.1707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6898, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
7 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(-2.9143, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5625, dtype=torch.float64) delta_t tensor(0.0527, dtype=torch.float64)
6 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-1.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5179, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
5 gae_duplicate tensor(-0.0716, dtype=torch.float64) tensor(-0.7322, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0138, dtype=torch.float64) delta_t tensor(-0.0245, dtype=torch.float64)
4 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(0.6913, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9453, dtype=torch.float64) delta_t tensor(-0.0513, dtype=torch.float64)
3 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(0.8383, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3685, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
2 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(-1.1932, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-308.68743896484375
value loss:2.500927686691284
entropies:332.5894470214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.673140048980713 seconds
19 rew tensor(1.1836, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
19 gae_duplicate tensor(-0.1380, dtype=torch.float64) tensor(1.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1709, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
18 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-1.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0951, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
17 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(-1.1395, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9673, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.1878, dtype=torch.float64) tensor(0.2445, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9293, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
15 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-0.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3444, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
14 gae_duplicate tensor(-0.8217, dtype=torch.float64) tensor(0.5179, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6503, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
13 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-1.7494, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(0.1565, dtype=torch.float64)
12 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-2.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6229, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
11 gae_duplicate tensor(0.0091, dtype=torch.float64) tensor(-2.5297, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1656, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
10 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(0.8395, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4178, dtype=torch.float64) delta_t tensor(-0.0884, dtype=torch.float64)
9 gae_duplicate tensor(-0.3055, dtype=torch.float64) tensor(2.1424, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6515, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
8 gae_duplicate tensor(0.0300, dtype=torch.float64) tensor(-1.7951, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3045, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
7 gae_duplicate tensor(-0.2146, dtype=torch.float64) tensor(-0.6431, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7406, dtype=torch.float64) delta_t tensor(0.0659, dtype=torch.float64)
6 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-1.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3134, dtype=torch.float64) delta_t tensor(0.1176, dtype=torch.float64)
5 gae_duplicate tensor(0.0523, dtype=torch.float64) tensor(-2.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1689, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
4 gae_duplicate tensor(-0.1228, dtype=torch.float64) tensor(0.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7764, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
3 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(-0.3315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2008, dtype=torch.float64) delta_t tensor(-0.0044, dtype=torch.float64)
2 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(-0.0867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:557.5772705078125
value loss:4.9366655349731445
entropies:332.4871826171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3832.2839)
ToM Target loss= tensor(3974.0300)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.062162160873413 seconds
19 rew tensor(1.1846, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
19 gae_duplicate tensor(-0.1006, dtype=torch.float64) tensor(0.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0824, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
18 gae_duplicate tensor(-0.0052, dtype=torch.float64) tensor(-0.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0321, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
17 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-0.0666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
16 gae_duplicate tensor(-0.0850, dtype=torch.float64) tensor(-0.1127, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
15 gae_duplicate tensor(-0.3678, dtype=torch.float64) tensor(0.8495, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7134, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
14 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(-1.0820, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8019, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
13 gae_duplicate tensor(-0.0352, dtype=torch.float64) tensor(-2.0383, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
12 gae_duplicate tensor(-0.2349, dtype=torch.float64) tensor(0.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2380, dtype=torch.float64) delta_t tensor(-0.6360, dtype=torch.float64)
11 gae_duplicate tensor(-3.6415, dtype=torch.float64) tensor(10.4078, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4624, dtype=torch.float64) delta_t tensor(-0.3500, dtype=torch.float64)
10 gae_duplicate tensor(-1.9813, dtype=torch.float64) tensor(9.2438, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1248, dtype=torch.float64) delta_t tensor(-0.0541, dtype=torch.float64)
9 gae_duplicate tensor(-0.2900, dtype=torch.float64) tensor(1.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4469, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
8 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(0.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4741, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
7 gae_duplicate tensor(-0.0147, dtype=torch.float64) tensor(-2.0506, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6519, dtype=torch.float64) delta_t tensor(0.0464, dtype=torch.float64)
6 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(-1.1705, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4686, dtype=torch.float64) delta_t tensor(-0.0831, dtype=torch.float64)
5 gae_duplicate tensor(-0.4138, dtype=torch.float64) tensor(2.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1417, dtype=torch.float64) delta_t tensor(-0.0415, dtype=torch.float64)
4 gae_duplicate tensor(-0.2004, dtype=torch.float64) tensor(0.7296, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8825, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
3 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-0.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1895, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
2 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(-0.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1078.615234375
value loss:29.365015029907227
entropies:332.0525207519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.724946975708008 seconds
19 rew tensor(1.1713, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
19 gae_duplicate tensor(-0.1140, dtype=torch.float64) tensor(1.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
18 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-1.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
17 gae_duplicate tensor(-0.0136, dtype=torch.float64) tensor(-1.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
16 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(-0.5440, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(0.0650, dtype=torch.float64)
15 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(-1.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4694, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
14 gae_duplicate tensor(-0.8296, dtype=torch.float64) tensor(2.4640, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5345, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
13 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-0.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4318, dtype=torch.float64) delta_t tensor(0.1190, dtype=torch.float64)
12 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-2.5752, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4275, dtype=torch.float64) delta_t tensor(-0.6632, dtype=torch.float64)
11 gae_duplicate tensor(-3.9620, dtype=torch.float64) tensor(10.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4649, dtype=torch.float64) delta_t tensor(-0.3470, dtype=torch.float64)
10 gae_duplicate tensor(-2.5438, dtype=torch.float64) tensor(6.5198, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
9 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(-1.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5505, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
8 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(0.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8933, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
7 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-3.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6913, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
6 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(-0.6026, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5948, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
5 gae_duplicate tensor(-0.0964, dtype=torch.float64) tensor(-1.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0876, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
4 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(1.1126, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2395, dtype=torch.float64) delta_t tensor(0.0427, dtype=torch.float64)
3 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-1.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4444, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
2 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-0.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-412.88226318359375
value loss:37.541927337646484
entropies:331.8504638671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.664031982421875 seconds
19 rew tensor(1.1839, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
19 gae_duplicate tensor(-0.1145, dtype=torch.float64) tensor(0.5616, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1462, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
18 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-1.9726, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0822, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
17 gae_duplicate tensor(-0.0539, dtype=torch.float64) tensor(-0.6129, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0315, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(-0.3117, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6726, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
15 gae_duplicate tensor(-1.4176, dtype=torch.float64) tensor(3.8574, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2275, dtype=torch.float64) delta_t tensor(-0.2812, dtype=torch.float64)
14 gae_duplicate tensor(-1.1039, dtype=torch.float64) tensor(7.5971, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3151, dtype=torch.float64) delta_t tensor(-0.2042, dtype=torch.float64)
13 gae_duplicate tensor(-1.3710, dtype=torch.float64) tensor(3.4174, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(0.1928, dtype=torch.float64)
12 gae_duplicate tensor(-0.1952, dtype=torch.float64) tensor(-3.4010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5341, dtype=torch.float64) delta_t tensor(0.1062, dtype=torch.float64)
11 gae_duplicate tensor(-0.1309, dtype=torch.float64) tensor(-2.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1279, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
10 gae_duplicate tensor(-0.3975, dtype=torch.float64) tensor(-0.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5082, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
9 gae_duplicate tensor(-0.0788, dtype=torch.float64) tensor(-0.3786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5246, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
8 gae_duplicate tensor(-0.2283, dtype=torch.float64) tensor(-0.6581, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2819, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
7 gae_duplicate tensor(-0.1506, dtype=torch.float64) tensor(-0.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8548, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
6 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-2.0858, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1117, dtype=torch.float64) delta_t tensor(-3.9678e-05, dtype=torch.float64)
5 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-0.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3197, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
4 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(1.5920, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4875, dtype=torch.float64) delta_t tensor(0.0489, dtype=torch.float64)
3 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-0.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0120, dtype=torch.float64) delta_t tensor(-0.2277, dtype=torch.float64)
2 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(4.6964, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-567.53662109375
value loss:12.924924850463867
entropies:331.9653625488281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.926785945892334 seconds
19 rew tensor(1.2350, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
19 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-0.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
18 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-3.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(0.1137, dtype=torch.float64)
17 gae_duplicate tensor(-0.0622, dtype=torch.float64) tensor(-2.4818, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0693, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
16 gae_duplicate tensor(-0.0849, dtype=torch.float64) tensor(-1.9743, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7633, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
15 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(-0.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7125, dtype=torch.float64) delta_t tensor(0.1782, dtype=torch.float64)
14 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-3.6111, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.1157, dtype=torch.float64)
13 gae_duplicate tensor(-0.2393, dtype=torch.float64) tensor(-2.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3312, dtype=torch.float64) delta_t tensor(0.0112, dtype=torch.float64)
12 gae_duplicate tensor(-0.0547, dtype=torch.float64) tensor(-0.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2394, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
11 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(0.0556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1156, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
10 gae_duplicate tensor(-0.3284, dtype=torch.float64) tensor(0.2382, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1374, dtype=torch.float64) delta_t tensor(0.0847, dtype=torch.float64)
9 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(-1.4913, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(-0.0767, dtype=torch.float64)
8 gae_duplicate tensor(-0.4168, dtype=torch.float64) tensor(1.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8210, dtype=torch.float64) delta_t tensor(0.1244, dtype=torch.float64)
7 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-2.2578, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8283, dtype=torch.float64) delta_t tensor(0.0299, dtype=torch.float64)
6 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-0.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3436, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
5 gae_duplicate tensor(-0.1188, dtype=torch.float64) tensor(-0.1214, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0376, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
4 gae_duplicate tensor(-0.1065, dtype=torch.float64) tensor(-1.7285, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9621, dtype=torch.float64) delta_t tensor(-0.1353, dtype=torch.float64)
3 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(2.5834, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2683, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
2 gae_duplicate tensor(-0.1831, dtype=torch.float64) tensor(-0.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:891.6233520507812
value loss:5.599082946777344
entropies:331.8370056152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.638899087905884 seconds
19 rew tensor(1.1578, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
19 gae_duplicate tensor(-0.1178, dtype=torch.float64) tensor(-0.2766, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1070, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
18 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-1.6722, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0053, dtype=torch.float64) delta_t tensor(0.0275, dtype=torch.float64)
17 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-0.6780, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0439, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
16 gae_duplicate tensor(0.0273, dtype=torch.float64) tensor(-2.0119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8780, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
15 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-1.2166, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(-0.1445, dtype=torch.float64)
14 gae_duplicate tensor(-1.4001, dtype=torch.float64) tensor(3.6043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3156, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
13 gae_duplicate tensor(-1.0000, dtype=torch.float64) tensor(1.8747, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4325, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
12 gae_duplicate tensor(-0.1382, dtype=torch.float64) tensor(-0.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2290, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
11 gae_duplicate tensor(-0.1369, dtype=torch.float64) tensor(-0.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2018, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
10 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-1.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1270, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
9 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-1.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4219, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
8 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(2.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0325, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
7 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(-0.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5749, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
6 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(0.2220, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6712, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
5 gae_duplicate tensor(-0.2095, dtype=torch.float64) tensor(0.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1122, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
4 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-0.3599, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2240, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
3 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-0.1032, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4566, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
2 gae_duplicate tensor(-0.1149, dtype=torch.float64) tensor(-0.5087, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:92.58080291748047
value loss:7.662920951843262
entropies:332.0091552734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3786.5576)
ToM Target loss= tensor(3968.4250)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.849015235900879 seconds
19 rew tensor(1.0688, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
19 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(0.9685, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1199, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
18 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-1.8342, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0306, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
17 gae_duplicate tensor(-0.0522, dtype=torch.float64) tensor(-2.2503, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
16 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-0.6752, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7893, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
15 gae_duplicate tensor(-0.2845, dtype=torch.float64) tensor(0.5822, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6744, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
14 gae_duplicate tensor(-0.0696, dtype=torch.float64) tensor(-2.0941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5732, dtype=torch.float64) delta_t tensor(0.0670, dtype=torch.float64)
13 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-1.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
12 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-1.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3566, dtype=torch.float64) delta_t tensor(0.0579, dtype=torch.float64)
11 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-1.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0863, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
10 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(-0.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
9 gae_duplicate tensor(0.0413, dtype=torch.float64) tensor(-1.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6266, dtype=torch.float64) delta_t tensor(-0.1264, dtype=torch.float64)
8 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(2.1803, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4582, dtype=torch.float64) delta_t tensor(0.0310, dtype=torch.float64)
7 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-0.6758, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6775, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
6 gae_duplicate tensor(-0.1058, dtype=torch.float64) tensor(-0.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3650, dtype=torch.float64) delta_t tensor(-0.0747, dtype=torch.float64)
5 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(1.1145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1687, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
4 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-0.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7649, dtype=torch.float64) delta_t tensor(-0.1882, dtype=torch.float64)
3 gae_duplicate tensor(-0.2712, dtype=torch.float64) tensor(3.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1883, dtype=torch.float64) delta_t tensor(0.0059, dtype=torch.float64)
2 gae_duplicate tensor(-0.2368, dtype=torch.float64) tensor(0.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:271.0722351074219
value loss:3.0821738243103027
entropies:331.5791015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.731649160385132 seconds
19 rew tensor(1.1711, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
19 gae_duplicate tensor(-0.0590, dtype=torch.float64) tensor(-0.6336, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
18 gae_duplicate tensor(0.1557, dtype=torch.float64) tensor(-3.9311, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1078, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
17 gae_duplicate tensor(0.0799, dtype=torch.float64) tensor(-2.4226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9540, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
16 gae_duplicate tensor(-0.0998, dtype=torch.float64) tensor(-1.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8659, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
15 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-1.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7120, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
14 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(-0.8016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
13 gae_duplicate tensor(0.0182, dtype=torch.float64) tensor(-2.2698, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4058, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
12 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-0.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2804, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
11 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-0.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1386, dtype=torch.float64) delta_t tensor(0.0613, dtype=torch.float64)
10 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-1.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0011, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
9 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-1.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4740, dtype=torch.float64) delta_t tensor(-0.1272, dtype=torch.float64)
8 gae_duplicate tensor(-0.4159, dtype=torch.float64) tensor(2.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2489, dtype=torch.float64) delta_t tensor(0.2469, dtype=torch.float64)
7 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-4.0447, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5889, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
6 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-2.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7728, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
5 gae_duplicate tensor(-0.2015, dtype=torch.float64) tensor(-0.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2907, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
4 gae_duplicate tensor(-0.2269, dtype=torch.float64) tensor(-1.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5308, dtype=torch.float64) delta_t tensor(-0.1293, dtype=torch.float64)
3 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(2.1022, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6476, dtype=torch.float64) delta_t tensor(0.1319, dtype=torch.float64)
2 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(-2.2798, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1180.6217041015625
value loss:5.446465015411377
entropies:331.4299011230469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.847730875015259 seconds
19 rew tensor(1.1330, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
19 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1074, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
18 gae_duplicate tensor(-0.0159, dtype=torch.float64) tensor(-2.4833, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0314, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
17 gae_duplicate tensor(-0.0010, dtype=torch.float64) tensor(-1.3011, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8911, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
16 gae_duplicate tensor(-0.0840, dtype=torch.float64) tensor(-0.5600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(-0.0522, dtype=torch.float64)
15 gae_duplicate tensor(-0.2912, dtype=torch.float64) tensor(0.7675, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(0.0884, dtype=torch.float64)
14 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-1.8820, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8785, dtype=torch.float64) delta_t tensor(0.1650, dtype=torch.float64)
13 gae_duplicate tensor(0.0333, dtype=torch.float64) tensor(-2.7179, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0744, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
12 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(0.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5463, dtype=torch.float64) delta_t tensor(0.1487, dtype=torch.float64)
11 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-2.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2313, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
10 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(1.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
9 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-0.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6646, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
8 gae_duplicate tensor(-0.4692, dtype=torch.float64) tensor(0.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3233, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
7 gae_duplicate tensor(-0.2581, dtype=torch.float64) tensor(-1.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8175, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
6 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-0.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2658, dtype=torch.float64) delta_t tensor(-0.0363, dtype=torch.float64)
5 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(0.6865, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2171, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
4 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(-1.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7191, dtype=torch.float64) delta_t tensor(-0.0953, dtype=torch.float64)
3 gae_duplicate tensor(-0.3306, dtype=torch.float64) tensor(1.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1142, dtype=torch.float64) delta_t tensor(0.0313, dtype=torch.float64)
2 gae_duplicate tensor(-0.2100, dtype=torch.float64) tensor(-0.3532, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:376.18206787109375
value loss:4.985812187194824
entropies:331.54217529296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.017032861709595 seconds
19 rew tensor(1.1843, dtype=torch.float64) delta_t tensor(-0.0338, dtype=torch.float64)
19 gae_duplicate tensor(-0.1158, dtype=torch.float64) tensor(0.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.0844, dtype=torch.float64)
18 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-2.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9932, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
17 gae_duplicate tensor(-0.0710, dtype=torch.float64) tensor(-0.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9428, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
16 gae_duplicate tensor(-0.0681, dtype=torch.float64) tensor(0.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8403, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
15 gae_duplicate tensor(-0.1973, dtype=torch.float64) tensor(1.7663, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(0.2106, dtype=torch.float64)
14 gae_duplicate tensor(0.0749, dtype=torch.float64) tensor(-4.3355, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3530, dtype=torch.float64) delta_t tensor(-0.1967, dtype=torch.float64)
13 gae_duplicate tensor(-1.3345, dtype=torch.float64) tensor(2.8118, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2918, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
12 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-1.0954, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4189, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
11 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(0.1171, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1037, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
10 gae_duplicate tensor(-0.0453, dtype=torch.float64) tensor(-0.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3431, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
9 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(-0.3247, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4735, dtype=torch.float64) delta_t tensor(0.0256, dtype=torch.float64)
8 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(-0.5216, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5393, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
7 gae_duplicate tensor(-0.1923, dtype=torch.float64) tensor(1.7647, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7918, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
6 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(1.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2659, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
5 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(0.2540, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1666, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
4 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(0.1355, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
3 gae_duplicate tensor(-0.0306, dtype=torch.float64) tensor(-1.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1780, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
2 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(0.6532, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-22.595720291137695
value loss:5.190664291381836
entropies:331.3389892578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.601164102554321 seconds
19 rew tensor(1.1074, dtype=torch.float64) delta_t tensor(-0.0597, dtype=torch.float64)
19 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(1.2226, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8507, dtype=torch.float64) delta_t tensor(-0.1927, dtype=torch.float64)
18 gae_duplicate tensor(-1.6055, dtype=torch.float64) tensor(2.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(-0.0624, dtype=torch.float64)
17 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(1.7047, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0053, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
16 gae_duplicate tensor(-0.1070, dtype=torch.float64) tensor(-0.2906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
15 gae_duplicate tensor(-0.2963, dtype=torch.float64) tensor(1.2695, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6745, dtype=torch.float64) delta_t tensor(0.2913, dtype=torch.float64)
14 gae_duplicate tensor(-0.0118, dtype=torch.float64) tensor(-5.0182, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
13 gae_duplicate tensor(-0.0008, dtype=torch.float64) tensor(-2.2099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2407, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
12 gae_duplicate tensor(-0.0961, dtype=torch.float64) tensor(-0.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5470, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
11 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(-2.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(-0.0289, dtype=torch.float64)
10 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(0.6261, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4445, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
9 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-0.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6142, dtype=torch.float64) delta_t tensor(-0.1328, dtype=torch.float64)
8 gae_duplicate tensor(-0.4235, dtype=torch.float64) tensor(2.0793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3421, dtype=torch.float64) delta_t tensor(-0.1017, dtype=torch.float64)
7 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(1.7895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8700, dtype=torch.float64) delta_t tensor(0.0850, dtype=torch.float64)
6 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(-1.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0830, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
5 gae_duplicate tensor(-0.2961, dtype=torch.float64) tensor(0.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
4 gae_duplicate tensor(-0.1160, dtype=torch.float64) tensor(-0.9833, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4039, dtype=torch.float64) delta_t tensor(0.1947, dtype=torch.float64)
3 gae_duplicate tensor(-0.1939, dtype=torch.float64) tensor(-4.9529, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0568, dtype=torch.float64) delta_t tensor(-0.1108, dtype=torch.float64)
2 gae_duplicate tensor(-0.5402, dtype=torch.float64) tensor(1.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:145.54222106933594
value loss:11.803604125976562
entropies:331.726806640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3825.2866)
ToM Target loss= tensor(3975.2205)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.975764989852905 seconds
19 rew tensor(1.0956, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
19 gae_duplicate tensor(-0.1935, dtype=torch.float64) tensor(1.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0825, dtype=torch.float64) delta_t tensor(0.0556, dtype=torch.float64)
18 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-0.9102, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
17 gae_duplicate tensor(-0.1084, dtype=torch.float64) tensor(0.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9295, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
16 gae_duplicate tensor(-0.1755, dtype=torch.float64) tensor(0.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8787, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
15 gae_duplicate tensor(-0.1400, dtype=torch.float64) tensor(-0.1054, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.2189, dtype=torch.float64)
14 gae_duplicate tensor(-0.0853, dtype=torch.float64) tensor(-3.8522, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3917, dtype=torch.float64) delta_t tensor(-0.1133, dtype=torch.float64)
13 gae_duplicate tensor(-1.3120, dtype=torch.float64) tensor(1.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(0.0949, dtype=torch.float64)
12 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-1.5487, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3682, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
11 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-1.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0623, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
10 gae_duplicate tensor(-0.0366, dtype=torch.float64) tensor(-1.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2530, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
9 gae_duplicate tensor(-0.0409, dtype=torch.float64) tensor(-1.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5249, dtype=torch.float64) delta_t tensor(-0.1326, dtype=torch.float64)
8 gae_duplicate tensor(-0.3588, dtype=torch.float64) tensor(2.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5235, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
7 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(1.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6015, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
6 gae_duplicate tensor(-0.0285, dtype=torch.float64) tensor(-1.0310, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4688, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
5 gae_duplicate tensor(-0.3206, dtype=torch.float64) tensor(1.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1432, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
4 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-0.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8176, dtype=torch.float64) delta_t tensor(-0.1492, dtype=torch.float64)
3 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(2.7032, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2138, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
2 gae_duplicate tensor(-0.2050, dtype=torch.float64) tensor(-0.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-25.48822593688965
value loss:6.3776373863220215
entropies:332.5088806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.75064492225647 seconds
19 rew tensor(1.1715, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
19 gae_duplicate tensor(-0.1846, dtype=torch.float64) tensor(0.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1077, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
18 gae_duplicate tensor(-0.0562, dtype=torch.float64) tensor(-0.2636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0690, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
17 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-0.8031, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9935, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
16 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(0.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
15 gae_duplicate tensor(-0.2811, dtype=torch.float64) tensor(0.4331, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7509, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
14 gae_duplicate tensor(-0.2975, dtype=torch.float64) tensor(-0.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5218, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
13 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(0.0214, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3930, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
12 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2034, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
11 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(0.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1493, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
10 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-0.8676, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1277, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
9 gae_duplicate tensor(-0.1047, dtype=torch.float64) tensor(-0.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(-0.0809, dtype=torch.float64)
8 gae_duplicate tensor(-0.3449, dtype=torch.float64) tensor(1.2242, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1741, dtype=torch.float64) delta_t tensor(0.0074, dtype=torch.float64)
7 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(-0.2412, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5757, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
6 gae_duplicate tensor(-0.2230, dtype=torch.float64) tensor(1.0874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6986, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
5 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(0.4831, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0865, dtype=torch.float64) delta_t tensor(-0.0028, dtype=torch.float64)
4 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(-0.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2130, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
3 gae_duplicate tensor(-0.2497, dtype=torch.float64) tensor(0.4795, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4437, dtype=torch.float64) delta_t tensor(-0.0876, dtype=torch.float64)
2 gae_duplicate tensor(-0.3361, dtype=torch.float64) tensor(1.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-310.5738525390625
value loss:2.8256523609161377
entropies:333.5194091796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6215198040008545 seconds
19 rew tensor(1.1970, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
19 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(1.7928, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1716, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
18 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-0.7302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1202, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
17 gae_duplicate tensor(-0.0237, dtype=torch.float64) tensor(-0.3255, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(-0.1880, dtype=torch.float64)
16 gae_duplicate tensor(-1.3649, dtype=torch.float64) tensor(2.9604, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0315, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
15 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(-0.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1126, dtype=torch.float64) delta_t tensor(-0.6694, dtype=torch.float64)
14 gae_duplicate tensor(-2.0832, dtype=torch.float64) tensor(13.1595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4180, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
13 gae_duplicate tensor(-0.8229, dtype=torch.float64) tensor(-0.7011, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3945, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
12 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(-1.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4053, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
11 gae_duplicate tensor(-0.2103, dtype=torch.float64) tensor(-1.4881, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0248, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
10 gae_duplicate tensor(0.0162, dtype=torch.float64) tensor(-1.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3160, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
9 gae_duplicate tensor(-0.0034, dtype=torch.float64) tensor(-0.7935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(-0.1438, dtype=torch.float64)
8 gae_duplicate tensor(-0.2827, dtype=torch.float64) tensor(2.4315, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1617, dtype=torch.float64) delta_t tensor(-0.5851, dtype=torch.float64)
7 gae_duplicate tensor(-1.8892, dtype=torch.float64) tensor(9.4932, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7809, dtype=torch.float64) delta_t tensor(-0.0458, dtype=torch.float64)
6 gae_duplicate tensor(-0.4867, dtype=torch.float64) tensor(1.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5973, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
5 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-2.9177, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3438, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
4 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-0.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5867, dtype=torch.float64) delta_t tensor(-0.0976, dtype=torch.float64)
3 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(1.7869, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6881, dtype=torch.float64) delta_t tensor(0.0300, dtype=torch.float64)
2 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(-0.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1260.7689208984375
value loss:31.67969512939453
entropies:334.07611083984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.954577922821045 seconds
19 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(-0.1068, dtype=torch.float64)
19 gae_duplicate tensor(-0.1820, dtype=torch.float64) tensor(1.8221, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
18 gae_duplicate tensor(-0.0603, dtype=torch.float64) tensor(-0.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0310, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
17 gae_duplicate tensor(-0.1319, dtype=torch.float64) tensor(0.3149, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
16 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(0.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
15 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-1.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4096, dtype=torch.float64) delta_t tensor(-0.1617, dtype=torch.float64)
14 gae_duplicate tensor(-1.2777, dtype=torch.float64) tensor(4.0128, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5348, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
13 gae_duplicate tensor(-0.0115, dtype=torch.float64) tensor(-0.9752, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3036, dtype=torch.float64) delta_t tensor(0.0794, dtype=torch.float64)
12 gae_duplicate tensor(-0.0882, dtype=torch.float64) tensor(-1.2732, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0887, dtype=torch.float64) delta_t tensor(-0.4538, dtype=torch.float64)
11 gae_duplicate tensor(-2.8513, dtype=torch.float64) tensor(7.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0649, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
10 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-3.1326, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4707, dtype=torch.float64) delta_t tensor(0.0752, dtype=torch.float64)
9 gae_duplicate tensor(-0.1625, dtype=torch.float64) tensor(-1.8867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7935, dtype=torch.float64) delta_t tensor(-0.1171, dtype=torch.float64)
8 gae_duplicate tensor(-0.2985, dtype=torch.float64) tensor(2.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3057, dtype=torch.float64) delta_t tensor(0.1388, dtype=torch.float64)
7 gae_duplicate tensor(-0.1828, dtype=torch.float64) tensor(-2.2765, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8314, dtype=torch.float64) delta_t tensor(-0.0219, dtype=torch.float64)
6 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(-0.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2886, dtype=torch.float64) delta_t tensor(0.0218, dtype=torch.float64)
5 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-0.3338, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1942, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
4 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-1.1233, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8163, dtype=torch.float64) delta_t tensor(-0.1081, dtype=torch.float64)
3 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(2.1567, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1503, dtype=torch.float64) delta_t tensor(0.0497, dtype=torch.float64)
2 gae_duplicate tensor(-0.1435, dtype=torch.float64) tensor(-0.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-323.4374084472656
value loss:18.31353759765625
entropies:335.0644836425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.4907920360565186 seconds
19 rew tensor(1.1082, dtype=torch.float64) delta_t tensor(-0.1531, dtype=torch.float64)
19 gae_duplicate tensor(-0.1771, dtype=torch.float64) tensor(3.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
18 gae_duplicate tensor(-0.0942, dtype=torch.float64) tensor(-0.5398, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0823, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
17 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-0.0068, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9925, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
16 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-0.5131, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
15 gae_duplicate tensor(-0.1112, dtype=torch.float64) tensor(-1.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3911, dtype=torch.float64) delta_t tensor(-0.2703, dtype=torch.float64)
14 gae_duplicate tensor(-1.2373, dtype=torch.float64) tensor(4.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5972, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
13 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-1.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3679, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
12 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(-2.1183, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4588, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
11 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(-0.4130, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0110, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
10 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-1.3357, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3437, dtype=torch.float64) delta_t tensor(0.0523, dtype=torch.float64)
9 gae_duplicate tensor(-0.0049, dtype=torch.float64) tensor(-0.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5001, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
8 gae_duplicate tensor(-0.1136, dtype=torch.float64) tensor(0.3098, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5016, dtype=torch.float64) delta_t tensor(-0.4956, dtype=torch.float64)
7 gae_duplicate tensor(-3.2175, dtype=torch.float64) tensor(7.9994, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7424, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
6 gae_duplicate tensor(-0.5457, dtype=torch.float64) tensor(-0.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4932, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
5 gae_duplicate tensor(-0.1886, dtype=torch.float64) tensor(-0.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0611, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
4 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-0.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1617, dtype=torch.float64) delta_t tensor(-0.0774, dtype=torch.float64)
3 gae_duplicate tensor(-0.3748, dtype=torch.float64) tensor(1.6948, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4182, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
2 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(0.1760, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-467.9478454589844
value loss:22.067197799682617
entropies:336.0111999511719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3807.6523)
ToM Target loss= tensor(3969.9348)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.8477208614349365 seconds
19 rew tensor(1.1079, dtype=torch.float64) delta_t tensor(-0.1587, dtype=torch.float64)
19 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(2.6965, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
18 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(0.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1208, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
17 gae_duplicate tensor(-0.0569, dtype=torch.float64) tensor(0.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0444, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
16 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(1.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4983, dtype=torch.float64) delta_t tensor(-0.5224, dtype=torch.float64)
15 gae_duplicate tensor(-2.8550, dtype=torch.float64) tensor(12.4361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7896, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
14 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(-1.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1990, dtype=torch.float64) delta_t tensor(-0.2753, dtype=torch.float64)
13 gae_duplicate tensor(-2.3038, dtype=torch.float64) tensor(6.9596, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0087, dtype=torch.float64) delta_t tensor(-0.2214, dtype=torch.float64)
12 gae_duplicate tensor(-1.4137, dtype=torch.float64) tensor(5.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.0159, dtype=torch.float64)
11 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(0.3828, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1552, dtype=torch.float64) delta_t tensor(-0.0523, dtype=torch.float64)
10 gae_duplicate tensor(-0.2145, dtype=torch.float64) tensor(0.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4074, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
9 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-0.7060, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5500, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
8 gae_duplicate tensor(-0.0981, dtype=torch.float64) tensor(-0.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0437, dtype=torch.float64) delta_t tensor(-0.2314, dtype=torch.float64)
7 gae_duplicate tensor(-1.7953, dtype=torch.float64) tensor(3.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(0.1440, dtype=torch.float64)
6 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(-2.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3654, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
5 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(-0.6510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1178, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
4 gae_duplicate tensor(-0.1738, dtype=torch.float64) tensor(0.3588, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9312, dtype=torch.float64) delta_t tensor(-0.0194, dtype=torch.float64)
3 gae_duplicate tensor(-0.1469, dtype=torch.float64) tensor(0.4502, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
2 gae_duplicate tensor(-0.2782, dtype=torch.float64) tensor(1.1464, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1739.06201171875
value loss:32.01085662841797
entropies:337.2513732910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.011767148971558 seconds
19 rew tensor(0.9302, dtype=torch.float64) delta_t tensor(-0.3614, dtype=torch.float64)
19 gae_duplicate tensor(-1.5042, dtype=torch.float64) tensor(6.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1974, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
18 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-1.4633, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0955, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
17 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(-0.7739, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(-0.1228, dtype=torch.float64)
16 gae_duplicate tensor(-0.2245, dtype=torch.float64) tensor(2.2541, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8657, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
15 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-0.5791, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7008, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
14 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-6.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.1747, dtype=torch.float64)
13 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(-3.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
12 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(-0.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
11 gae_duplicate tensor(-0.0012, dtype=torch.float64) tensor(-1.9066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0012, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
10 gae_duplicate tensor(-0.1211, dtype=torch.float64) tensor(-0.9732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2537, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
9 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-1.0971, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5498, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
8 gae_duplicate tensor(-0.2085, dtype=torch.float64) tensor(0.1089, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0272, dtype=torch.float64) delta_t tensor(-0.1575, dtype=torch.float64)
7 gae_duplicate tensor(-0.9807, dtype=torch.float64) tensor(2.6541, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7163, dtype=torch.float64) delta_t tensor(0.1015, dtype=torch.float64)
6 gae_duplicate tensor(-0.2829, dtype=torch.float64) tensor(-1.1575, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4953, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
5 gae_duplicate tensor(-0.0518, dtype=torch.float64) tensor(-1.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0900, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
4 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-2.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1667, dtype=torch.float64) delta_t tensor(-0.1707, dtype=torch.float64)
3 gae_duplicate tensor(-0.8174, dtype=torch.float64) tensor(2.4948, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4470, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
2 gae_duplicate tensor(-0.0930, dtype=torch.float64) tensor(-3.6832, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:621.8597412109375
value loss:15.653831481933594
entropies:338.0125732421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.666319847106934 seconds
19 rew tensor(1.0951, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
19 gae_duplicate tensor(-0.2007, dtype=torch.float64) tensor(2.4642, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1334, dtype=torch.float64) delta_t tensor(0.0698, dtype=torch.float64)
18 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-1.1271, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0569, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
17 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-0.0301, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8787, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
16 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(1.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9932, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
15 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-1.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0214, dtype=torch.float64) delta_t tensor(-0.4001, dtype=torch.float64)
14 gae_duplicate tensor(-2.1498, dtype=torch.float64) tensor(6.4194, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6875, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
13 gae_duplicate tensor(-0.3166, dtype=torch.float64) tensor(0.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1514, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
12 gae_duplicate tensor(-0.2378, dtype=torch.float64) tensor(-0.5102, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6238, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
11 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-1.2533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1675, dtype=torch.float64) delta_t tensor(-0.0361, dtype=torch.float64)
10 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(0.5875, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4578, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
9 gae_duplicate tensor(-0.2485, dtype=torch.float64) tensor(-1.0499, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6909, dtype=torch.float64) delta_t tensor(-0.0073, dtype=torch.float64)
8 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(0.3181, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3069, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
7 gae_duplicate tensor(-0.1147, dtype=torch.float64) tensor(-0.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7547, dtype=torch.float64) delta_t tensor(0.1143, dtype=torch.float64)
6 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-2.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3150, dtype=torch.float64) delta_t tensor(-0.0254, dtype=torch.float64)
5 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(0.2366, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1933, dtype=torch.float64) delta_t tensor(0.0438, dtype=torch.float64)
4 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(-0.8182, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7540, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
3 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(0.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1384, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
2 gae_duplicate tensor(-0.1881, dtype=torch.float64) tensor(0.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-261.4925842285156
value loss:9.864103317260742
entropies:339.0941162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.83060622215271 seconds
19 rew tensor(1.1456, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
19 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(1.7284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1970, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
18 gae_duplicate tensor(-0.0046, dtype=torch.float64) tensor(-1.2996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8685, dtype=torch.float64) delta_t tensor(-0.2103, dtype=torch.float64)
17 gae_duplicate tensor(-1.3952, dtype=torch.float64) tensor(3.1564, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7511, dtype=torch.float64) delta_t tensor(-0.2816, dtype=torch.float64)
16 gae_duplicate tensor(-1.4143, dtype=torch.float64) tensor(5.1943, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9293, dtype=torch.float64) delta_t tensor(0.0311, dtype=torch.float64)
15 gae_duplicate tensor(-0.3254, dtype=torch.float64) tensor(-0.0515, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4412, dtype=torch.float64) delta_t tensor(-0.0920, dtype=torch.float64)
14 gae_duplicate tensor(-0.7984, dtype=torch.float64) tensor(2.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(-0.1199, dtype=torch.float64)
13 gae_duplicate tensor(-1.2113, dtype=torch.float64) tensor(1.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4183, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
12 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(-1.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3571, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
11 gae_duplicate tensor(-0.0165, dtype=torch.float64) tensor(-2.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0856, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
10 gae_duplicate tensor(-0.2229, dtype=torch.float64) tensor(-2.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(0.0136, dtype=torch.float64)
9 gae_duplicate tensor(-0.2843, dtype=torch.float64) tensor(-0.8432, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6523, dtype=torch.float64) delta_t tensor(-0.0765, dtype=torch.float64)
8 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(1.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6918, dtype=torch.float64) delta_t tensor(-0.7051, dtype=torch.float64)
7 gae_duplicate tensor(-4.6366, dtype=torch.float64) tensor(11.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8425, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
6 gae_duplicate tensor(-0.6421, dtype=torch.float64) tensor(1.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4677, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
5 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-2.4635, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
4 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-1.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2099, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
3 gae_duplicate tensor(-0.3360, dtype=torch.float64) tensor(1.5019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3793, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
2 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-1.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-885.869873046875
value loss:46.21977233886719
entropies:340.33203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.567981719970703 seconds
19 rew tensor(1.1454, dtype=torch.float64) delta_t tensor(-0.0823, dtype=torch.float64)
19 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(1.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(0.1045, dtype=torch.float64)
18 gae_duplicate tensor(0.0150, dtype=torch.float64) tensor(-1.8632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7290, dtype=torch.float64) delta_t tensor(-0.2557, dtype=torch.float64)
17 gae_duplicate tensor(-1.4501, dtype=torch.float64) tensor(4.0921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9555, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
16 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(1.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8402, dtype=torch.float64) delta_t tensor(-0.0590, dtype=torch.float64)
15 gae_duplicate tensor(-0.2506, dtype=torch.float64) tensor(0.9943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7908, dtype=torch.float64) delta_t tensor(0.0985, dtype=torch.float64)
14 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-1.5652, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3791, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
13 gae_duplicate tensor(-0.7550, dtype=torch.float64) tensor(1.4145, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
12 gae_duplicate tensor(-0.2241, dtype=torch.float64) tensor(-0.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4695, dtype=torch.float64) delta_t tensor(-0.0145, dtype=torch.float64)
11 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(0.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
10 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-1.4648, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
9 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-2.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5369, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
8 gae_duplicate tensor(-0.1172, dtype=torch.float64) tensor(-0.1298, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5666, dtype=torch.float64) delta_t tensor(0.0074, dtype=torch.float64)
7 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-0.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7794, dtype=torch.float64) delta_t tensor(0.0741, dtype=torch.float64)
6 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(-1.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3425, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
5 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-1.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0887, dtype=torch.float64) delta_t tensor(-0.0626, dtype=torch.float64)
4 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(0.9673, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8598, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
3 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-1.7259, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2685, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
2 gae_duplicate tensor(-0.2014, dtype=torch.float64) tensor(0.3040, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-20.633926391601562
value loss:7.2922282218933105
entropies:341.9021301269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3885.1885)
ToM Target loss= tensor(3972.9624)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.963043928146362 seconds
19 rew tensor(1.1964, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
19 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(0.6949, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(0.1008, dtype=torch.float64)
18 gae_duplicate tensor(-0.0217, dtype=torch.float64) tensor(-1.8711, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1203, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
17 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-1.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0692, dtype=torch.float64) delta_t tensor(0.0732, dtype=torch.float64)
16 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-1.5125, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8783, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
15 gae_duplicate tensor(-0.0579, dtype=torch.float64) tensor(-1.4265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4682, dtype=torch.float64) delta_t tensor(-0.1878, dtype=torch.float64)
14 gae_duplicate tensor(-1.4349, dtype=torch.float64) tensor(3.2164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3950, dtype=torch.float64) delta_t tensor(-0.1563, dtype=torch.float64)
13 gae_duplicate tensor(-1.5182, dtype=torch.float64) tensor(4.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1907, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
12 gae_duplicate tensor(-0.7553, dtype=torch.float64) tensor(2.2925, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3816, dtype=torch.float64) delta_t tensor(-0.5545, dtype=torch.float64)
11 gae_duplicate tensor(-3.8643, dtype=torch.float64) tensor(9.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1008, dtype=torch.float64) delta_t tensor(0.0959, dtype=torch.float64)
10 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-0.8102, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3173, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
9 gae_duplicate tensor(-0.0341, dtype=torch.float64) tensor(-1.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6265, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
8 gae_duplicate tensor(-0.1910, dtype=torch.float64) tensor(0.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8735, dtype=torch.float64) delta_t tensor(-0.0893, dtype=torch.float64)
7 gae_duplicate tensor(-0.4503, dtype=torch.float64) tensor(1.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7535, dtype=torch.float64) delta_t tensor(0.1440, dtype=torch.float64)
6 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-2.5079, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4418, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
5 gae_duplicate tensor(-0.1467, dtype=torch.float64) tensor(-1.5607, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0176, dtype=torch.float64) delta_t tensor(0.0582, dtype=torch.float64)
4 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-1.5007, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0554, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
3 gae_duplicate tensor(-0.2090, dtype=torch.float64) tensor(1.4769, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3142, dtype=torch.float64) delta_t tensor(-0.0459, dtype=torch.float64)
2 gae_duplicate tensor(-0.3632, dtype=torch.float64) tensor(1.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-680.8930053710938
value loss:33.760406494140625
entropies:343.4039001464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.838550090789795 seconds
19 rew tensor(1.1209, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
19 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(1.3463, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1207, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
18 gae_duplicate tensor(3.1358e-05, dtype=torch.float64) tensor(-1.6593, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1081, dtype=torch.float64) delta_t tensor(0.0858, dtype=torch.float64)
17 gae_duplicate tensor(0.0198, dtype=torch.float64) tensor(-1.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9547, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
16 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(0.1009, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9421, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
15 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(0.2372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4556, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
14 gae_duplicate tensor(-0.9275, dtype=torch.float64) tensor(-0.5208, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2429, dtype=torch.float64) delta_t tensor(-0.3830, dtype=torch.float64)
13 gae_duplicate tensor(-2.6618, dtype=torch.float64) tensor(6.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2148, dtype=torch.float64) delta_t tensor(-0.0524, dtype=torch.float64)
12 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(1.7396, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.0126, dtype=torch.float64)
11 gae_duplicate tensor(-0.1321, dtype=torch.float64) tensor(-0.1626, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(0.0368, dtype=torch.float64)
10 gae_duplicate tensor(-0.0828, dtype=torch.float64) tensor(-0.8206, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
9 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-0.3817, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4482, dtype=torch.float64) delta_t tensor(-0.0054, dtype=torch.float64)
8 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(0.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6772, dtype=torch.float64) delta_t tensor(-0.0181, dtype=torch.float64)
7 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(0.2641, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5373, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
6 gae_duplicate tensor(-0.0017, dtype=torch.float64) tensor(-2.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5447, dtype=torch.float64) delta_t tensor(-0.1056, dtype=torch.float64)
5 gae_duplicate tensor(-0.1907, dtype=torch.float64) tensor(1.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0657, dtype=torch.float64) delta_t tensor(-0.1414, dtype=torch.float64)
4 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(2.8803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8816, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
3 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(1.6334, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3041, dtype=torch.float64) delta_t tensor(-0.1546, dtype=torch.float64)
2 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(3.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-717.1952514648438
value loss:15.1627197265625
entropies:344.9741516113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.647952079772949 seconds
19 rew tensor(1.2353, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
19 gae_duplicate tensor(-0.1091, dtype=torch.float64) tensor(0.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2100, dtype=torch.float64) delta_t tensor(0.1192, dtype=torch.float64)
18 gae_duplicate tensor(0.0373, dtype=torch.float64) tensor(-2.3154, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
17 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.7973, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1589, dtype=torch.float64) delta_t tensor(0.0683, dtype=torch.float64)
16 gae_duplicate tensor(0.0096, dtype=torch.float64) tensor(-1.2566, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9291, dtype=torch.float64) delta_t tensor(-0.0709, dtype=torch.float64)
15 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(1.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8277, dtype=torch.float64) delta_t tensor(0.1926, dtype=torch.float64)
14 gae_duplicate tensor(-0.1473, dtype=torch.float64) tensor(-3.8172, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0689, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
13 gae_duplicate tensor(-2.3134, dtype=torch.float64) tensor(2.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0459, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
12 gae_duplicate tensor(-0.7536, dtype=torch.float64) tensor(-0.5489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3599, dtype=torch.float64) delta_t tensor(-0.5285, dtype=torch.float64)
11 gae_duplicate tensor(-3.8477, dtype=torch.float64) tensor(11.8879, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4135, dtype=torch.float64) delta_t tensor(-0.2001, dtype=torch.float64)
10 gae_duplicate tensor(-2.4995, dtype=torch.float64) tensor(4.1123, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(0.1607, dtype=torch.float64)
9 gae_duplicate tensor(-0.2356, dtype=torch.float64) tensor(-2.3381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6514, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
8 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(0.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9092, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
7 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-3.5288, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8166, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
6 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-1.5786, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5716, dtype=torch.float64) delta_t tensor(0.1181, dtype=torch.float64)
5 gae_duplicate tensor(-0.1028, dtype=torch.float64) tensor(-2.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1396, dtype=torch.float64) delta_t tensor(-0.0909, dtype=torch.float64)
4 gae_duplicate tensor(-0.2609, dtype=torch.float64) tensor(1.3201, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4184, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
3 gae_duplicate tensor(-0.1979, dtype=torch.float64) tensor(-1.1982, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4712, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
2 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(0.6893, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-229.7454376220703
value loss:47.48805236816406
entropies:346.71343994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965433120727539 seconds
19 rew tensor(1.1464, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
19 gae_duplicate tensor(-0.0470, dtype=torch.float64) tensor(-0.2370, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0958, dtype=torch.float64) delta_t tensor(0.1029, dtype=torch.float64)
18 gae_duplicate tensor(0.0078, dtype=torch.float64) tensor(-1.8727, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1086, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
17 gae_duplicate tensor(0.0498, dtype=torch.float64) tensor(-2.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6984, dtype=torch.float64) delta_t tensor(-0.2360, dtype=torch.float64)
16 gae_duplicate tensor(-1.4134, dtype=torch.float64) tensor(3.7600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9428, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
15 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(0.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1975, dtype=torch.float64) delta_t tensor(-0.2868, dtype=torch.float64)
14 gae_duplicate tensor(-2.1242, dtype=torch.float64) tensor(4.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6741, dtype=torch.float64) delta_t tensor(0.1307, dtype=torch.float64)
13 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-2.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3433, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
12 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-1.2748, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2915, dtype=torch.float64) delta_t tensor(0.1093, dtype=torch.float64)
11 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-1.9157, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0124, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
10 gae_duplicate tensor(-0.0677, dtype=torch.float64) tensor(-0.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2787, dtype=torch.float64) delta_t tensor(-0.0143, dtype=torch.float64)
9 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(0.2487, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3974, dtype=torch.float64) delta_t tensor(-0.0360, dtype=torch.float64)
8 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8445, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
7 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-1.1194, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6013, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
6 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(-1.1422, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5455, dtype=torch.float64) delta_t tensor(-0.0776, dtype=torch.float64)
5 gae_duplicate tensor(-0.2374, dtype=torch.float64) tensor(1.3457, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0719, dtype=torch.float64)
4 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(1.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9732, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
3 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(1.1830, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3052, dtype=torch.float64) delta_t tensor(-0.1682, dtype=torch.float64)
2 gae_duplicate tensor(-0.3638, dtype=torch.float64) tensor(3.4475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-308.2467346191406
value loss:12.89176082611084
entropies:347.9106750488281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.721897125244141 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
19 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(0.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1838, dtype=torch.float64) delta_t tensor(0.1337, dtype=torch.float64)
18 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-2.7212, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1067, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
17 gae_duplicate tensor(-0.0386, dtype=torch.float64) tensor(-2.1529, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0441, dtype=torch.float64) delta_t tensor(0.0911, dtype=torch.float64)
16 gae_duplicate tensor(0.0193, dtype=torch.float64) tensor(-2.0538, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8782, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
15 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(-1.8440, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
14 gae_duplicate tensor(-0.8796, dtype=torch.float64) tensor(-0.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
13 gae_duplicate tensor(-0.0599, dtype=torch.float64) tensor(-1.5532, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3297, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
12 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(-1.7311, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
11 gae_duplicate tensor(-0.1430, dtype=torch.float64) tensor(-2.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1171, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
10 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(-0.6165, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3823, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
9 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-0.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5510, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
8 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(1.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9821, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
7 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(0.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6403, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
6 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-1.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5945, dtype=torch.float64) delta_t tensor(-0.0095, dtype=torch.float64)
5 gae_duplicate tensor(-0.1925, dtype=torch.float64) tensor(0.3230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
4 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-0.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2637, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
3 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(1.8349, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5210, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
2 gae_duplicate tensor(-0.1849, dtype=torch.float64) tensor(-0.0050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:617.5171508789062
value loss:5.411609649658203
entropies:349.2432861328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3991.2368)
ToM Target loss= tensor(3972.8232)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.976009130477905 seconds
19 rew tensor(1.1838, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
19 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(0.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1458, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
18 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-1.7701, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1459, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
17 gae_duplicate tensor(0.0439, dtype=torch.float64) tensor(-3.0786, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9674, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
16 gae_duplicate tensor(-0.1066, dtype=torch.float64) tensor(-0.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8783, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
15 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-2.2976, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2135, dtype=torch.float64) delta_t tensor(-0.2630, dtype=torch.float64)
14 gae_duplicate tensor(-1.2589, dtype=torch.float64) tensor(5.7010, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0585, dtype=torch.float64) delta_t tensor(-0.2871, dtype=torch.float64)
13 gae_duplicate tensor(-2.3304, dtype=torch.float64) tensor(6.9014, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3290, dtype=torch.float64) delta_t tensor(0.3093, dtype=torch.float64)
12 gae_duplicate tensor(-0.1183, dtype=torch.float64) tensor(-5.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5090, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
11 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(-1.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
10 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-3.1165, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4691, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
9 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(-0.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5489, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
8 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-0.1971, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7549, dtype=torch.float64) delta_t tensor(-0.0411, dtype=torch.float64)
7 gae_duplicate tensor(-0.1510, dtype=torch.float64) tensor(0.8095, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6511, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
6 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-1.7342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5201, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
5 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(-0.0148, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
4 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(1.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0984, dtype=torch.float64) delta_t tensor(-0.0463, dtype=torch.float64)
3 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(1.1371, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3812, dtype=torch.float64) delta_t tensor(-0.1292, dtype=torch.float64)
2 gae_duplicate tensor(-0.3508, dtype=torch.float64) tensor(2.7475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:25.145423889160156
value loss:17.113759994506836
entropies:350.2038269042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.6800758838653564 seconds
19 rew tensor(1.2225, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
19 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(0.0758, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2098, dtype=torch.float64) delta_t tensor(0.1571, dtype=torch.float64)
18 gae_duplicate tensor(0.0368, dtype=torch.float64) tensor(-3.0439, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1200, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
17 gae_duplicate tensor(-0.0007, dtype=torch.float64) tensor(-2.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0315, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
16 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(0.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9676, dtype=torch.float64) delta_t tensor(0.0421, dtype=torch.float64)
15 gae_duplicate tensor(-0.2608, dtype=torch.float64) tensor(-0.8723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3842, dtype=torch.float64) delta_t tensor(-0.2003, dtype=torch.float64)
14 gae_duplicate tensor(-2.1176, dtype=torch.float64) tensor(4.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4298, dtype=torch.float64) delta_t tensor(0.1719, dtype=torch.float64)
13 gae_duplicate tensor(-0.6040, dtype=torch.float64) tensor(-2.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1497, dtype=torch.float64) delta_t tensor(0.0640, dtype=torch.float64)
12 gae_duplicate tensor(-0.3651, dtype=torch.float64) tensor(-1.4682, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1743, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
11 gae_duplicate tensor(-1.4867, dtype=torch.float64) tensor(0.6728, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0917, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
10 gae_duplicate tensor(-0.3547, dtype=torch.float64) tensor(-3.1391, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4211, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
9 gae_duplicate tensor(0.0512, dtype=torch.float64) tensor(-3.4298, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7423, dtype=torch.float64) delta_t tensor(-0.0401, dtype=torch.float64)
8 gae_duplicate tensor(-0.3737, dtype=torch.float64) tensor(0.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9626, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
7 gae_duplicate tensor(-2.2197, dtype=torch.float64) tensor(4.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0233, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
6 gae_duplicate tensor(-0.3814, dtype=torch.float64) tensor(0.7014, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2625, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
5 gae_duplicate tensor(-0.4400, dtype=torch.float64) tensor(-1.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1212, dtype=torch.float64) delta_t tensor(-0.0995, dtype=torch.float64)
4 gae_duplicate tensor(-0.5068, dtype=torch.float64) tensor(1.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0297, dtype=torch.float64) delta_t tensor(0.0546, dtype=torch.float64)
3 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-0.6889, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2105, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
2 gae_duplicate tensor(-0.2465, dtype=torch.float64) tensor(0.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:229.99395751953125
value loss:26.967758178710938
entropies:350.7527770996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.687705039978027 seconds
19 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
19 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.7333, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1591, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
18 gae_duplicate tensor(0.0577, dtype=torch.float64) tensor(-2.2880, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
17 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-1.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9939, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
16 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-0.9782, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9172, dtype=torch.float64) delta_t tensor(0.1315, dtype=torch.float64)
15 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-2.9266, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
14 gae_duplicate tensor(-1.0792, dtype=torch.float64) tensor(0.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1094, dtype=torch.float64) delta_t tensor(-0.2770, dtype=torch.float64)
13 gae_duplicate tensor(-1.3599, dtype=torch.float64) tensor(6.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1754, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
12 gae_duplicate tensor(-0.7589, dtype=torch.float64) tensor(-1.4016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0247, dtype=torch.float64) delta_t tensor(-0.2391, dtype=torch.float64)
11 gae_duplicate tensor(-2.6049, dtype=torch.float64) tensor(5.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1019, dtype=torch.float64) delta_t tensor(0.2603, dtype=torch.float64)
10 gae_duplicate tensor(-0.0658, dtype=torch.float64) tensor(-4.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3673, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
9 gae_duplicate tensor(-0.2012, dtype=torch.float64) tensor(-1.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6513, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
8 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(0.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2445, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
7 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-0.2818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7155, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
6 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-2.2665, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3415, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
5 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(-0.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2691, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
4 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-1.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6786, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
3 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-0.1422, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0752, dtype=torch.float64) delta_t tensor(-0.0582, dtype=torch.float64)
2 gae_duplicate tensor(-0.1672, dtype=torch.float64) tensor(1.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:155.42706298828125
value loss:22.438549041748047
entropies:351.0641174316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.832452058792114 seconds
19 rew tensor(1.1086, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
19 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(0.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8249, dtype=torch.float64) delta_t tensor(-0.1701, dtype=torch.float64)
18 gae_duplicate tensor(-1.4420, dtype=torch.float64) tensor(3.0402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9805, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
17 gae_duplicate tensor(-0.1251, dtype=torch.float64) tensor(-0.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9425, dtype=torch.float64) delta_t tensor(0.0314, dtype=torch.float64)
16 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-0.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
15 gae_duplicate tensor(-0.2040, dtype=torch.float64) tensor(0.8639, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6495, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
14 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-0.4427, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
13 gae_duplicate tensor(0.0288, dtype=torch.float64) tensor(-1.7719, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3306, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
12 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-0.3858, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3936, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
11 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-0.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0390, dtype=torch.float64) delta_t tensor(-0.0543, dtype=torch.float64)
10 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(0.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3298, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
9 gae_duplicate tensor(-0.2664, dtype=torch.float64) tensor(0.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6013, dtype=torch.float64) delta_t tensor(-0.0802, dtype=torch.float64)
8 gae_duplicate tensor(-0.1868, dtype=torch.float64) tensor(1.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3463, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
7 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(-0.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6396, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
6 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-0.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3670, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
5 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(0.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2185, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
4 gae_duplicate tensor(-0.1285, dtype=torch.float64) tensor(-0.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6912, dtype=torch.float64) delta_t tensor(-0.1222, dtype=torch.float64)
3 gae_duplicate tensor(-0.2882, dtype=torch.float64) tensor(2.5961, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1385, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
2 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(1.0731, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-398.0535583496094
value loss:5.579715251922607
entropies:351.14581298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.998710870742798 seconds
19 rew tensor(1.1594, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
19 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(0.3412, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1210, dtype=torch.float64) delta_t tensor(0.0692, dtype=torch.float64)
18 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-1.3029, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0061, dtype=torch.float64) delta_t tensor(0.0387, dtype=torch.float64)
17 gae_duplicate tensor(-0.0780, dtype=torch.float64) tensor(-0.9666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0195, dtype=torch.float64) delta_t tensor(0.0374, dtype=torch.float64)
16 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-0.8492, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5830, dtype=torch.float64) delta_t tensor(-0.2850, dtype=torch.float64)
15 gae_duplicate tensor(-1.4072, dtype=torch.float64) tensor(5.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8407, dtype=torch.float64) delta_t tensor(0.1823, dtype=torch.float64)
14 gae_duplicate tensor(0.0365, dtype=torch.float64) tensor(-2.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3702, dtype=torch.float64) delta_t tensor(-0.1153, dtype=torch.float64)
13 gae_duplicate tensor(-1.1892, dtype=torch.float64) tensor(2.1725, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4050, dtype=torch.float64) delta_t tensor(0.1061, dtype=torch.float64)
12 gae_duplicate tensor(-0.0289, dtype=torch.float64) tensor(-1.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2678, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
11 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(-1.0491, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1121, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
10 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-0.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1013, dtype=torch.float64) delta_t tensor(0.0783, dtype=torch.float64)
9 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(-1.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4491, dtype=torch.float64) delta_t tensor(-0.0822, dtype=torch.float64)
8 gae_duplicate tensor(-0.2772, dtype=torch.float64) tensor(1.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1633, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
7 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(-1.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5768, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
6 gae_duplicate tensor(-0.0750, dtype=torch.float64) tensor(-0.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7750, dtype=torch.float64) delta_t tensor(0.0667, dtype=torch.float64)
5 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-1.5318, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2160, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
4 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-1.7857, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4455, dtype=torch.float64) delta_t tensor(-0.0858, dtype=torch.float64)
3 gae_duplicate tensor(-0.3645, dtype=torch.float64) tensor(1.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5731, dtype=torch.float64) delta_t tensor(0.0634, dtype=torch.float64)
2 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(-1.0959, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:334.93499755859375
value loss:9.452513694763184
entropies:351.1080017089844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3918.)
ToM Target loss= tensor(3982.0757)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.242871999740601 seconds
19 rew tensor(1.1844, dtype=torch.float64) delta_t tensor(0.0114, dtype=torch.float64)
19 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-0.2382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.1086, dtype=torch.float64)
18 gae_duplicate tensor(0.0350, dtype=torch.float64) tensor(-2.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
17 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-1.0602, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(7.2122e-05, dtype=torch.float64)
16 gae_duplicate tensor(-0.1042, dtype=torch.float64) tensor(-0.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8021, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
15 gae_duplicate tensor(-0.1480, dtype=torch.float64) tensor(-1.0540, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6615, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
14 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-0.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5094, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
13 gae_duplicate tensor(-0.1373, dtype=torch.float64) tensor(-0.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3935, dtype=torch.float64) delta_t tensor(-0.0163, dtype=torch.float64)
12 gae_duplicate tensor(-0.1708, dtype=torch.float64) tensor(0.3510, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3436, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
11 gae_duplicate tensor(-0.0781, dtype=torch.float64) tensor(-1.0833, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0759, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
10 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-1.2384, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(0.1224, dtype=torch.float64)
9 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(-2.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5513, dtype=torch.float64) delta_t tensor(-0.0945, dtype=torch.float64)
8 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(1.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6885, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
7 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(0.1105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6149, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
6 gae_duplicate tensor(0.0199, dtype=torch.float64) tensor(-2.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4929, dtype=torch.float64) delta_t tensor(-0.0472, dtype=torch.float64)
5 gae_duplicate tensor(-0.2074, dtype=torch.float64) tensor(0.8150, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0406, dtype=torch.float64) delta_t tensor(0.1158, dtype=torch.float64)
4 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-2.3509, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9194, dtype=torch.float64) delta_t tensor(-0.1757, dtype=torch.float64)
3 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(2.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3294, dtype=torch.float64) delta_t tensor(0.0612, dtype=torch.float64)
2 gae_duplicate tensor(-0.1676, dtype=torch.float64) tensor(-1.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:442.0083312988281
value loss:2.8623719215393066
entropies:351.18310546875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.823914051055908 seconds
19 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-0.3116, dtype=torch.float64)
19 gae_duplicate tensor(-1.4588, dtype=torch.float64) tensor(5.5713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
18 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-2.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0192, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
17 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-1.3638, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8908, dtype=torch.float64) delta_t tensor(-0.0623, dtype=torch.float64)
16 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(1.0985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8025, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
15 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(0.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8026, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
14 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(-1.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
13 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-1.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
12 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(-0.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3044, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
11 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1011, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
10 gae_duplicate tensor(-0.3882, dtype=torch.float64) tensor(1.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
9 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-1.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4229, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
8 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(-0.1485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8455, dtype=torch.float64) delta_t tensor(0.0967, dtype=torch.float64)
7 gae_duplicate tensor(-0.0938, dtype=torch.float64) tensor(-1.9359, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6509, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
6 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-1.7506, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5228, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
5 gae_duplicate tensor(-0.1295, dtype=torch.float64) tensor(-0.7016, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0126, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
4 gae_duplicate tensor(-0.1520, dtype=torch.float64) tensor(-1.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0387, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
3 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(-0.7720, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3825, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
2 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(-1.5370, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:275.02667236328125
value loss:6.098710060119629
entropies:351.22650146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8022260665893555 seconds
19 rew tensor(1.1331, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
19 gae_duplicate tensor(-0.1538, dtype=torch.float64) tensor(1.4591, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
18 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-1.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0692, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
17 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(-2.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9543, dtype=torch.float64) delta_t tensor(-0.0238, dtype=torch.float64)
16 gae_duplicate tensor(-0.2134, dtype=torch.float64) tensor(0.4338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8415, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
15 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-0.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7128, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
14 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(-1.9597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(0.0647, dtype=torch.float64)
13 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-1.3619, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3160, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
12 gae_duplicate tensor(-0.1867, dtype=torch.float64) tensor(0.4204, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3201, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
11 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-0.9368, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0346, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
10 gae_duplicate tensor(-0.1672, dtype=torch.float64) tensor(0.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1408, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
9 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-1.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4235, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
8 gae_duplicate tensor(-0.1024, dtype=torch.float64) tensor(-1.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5978, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
7 gae_duplicate tensor(-0.5187, dtype=torch.float64) tensor(1.0674, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7544, dtype=torch.float64) delta_t tensor(0.1505, dtype=torch.float64)
6 gae_duplicate tensor(-0.2192, dtype=torch.float64) tensor(-3.1311, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3659, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
5 gae_duplicate tensor(-0.0350, dtype=torch.float64) tensor(-0.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1943, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
4 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(-2.2931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7652, dtype=torch.float64) delta_t tensor(-0.0500, dtype=torch.float64)
3 gae_duplicate tensor(-0.2990, dtype=torch.float64) tensor(0.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0868, dtype=torch.float64) delta_t tensor(-0.0153, dtype=torch.float64)
2 gae_duplicate tensor(-0.4369, dtype=torch.float64) tensor(0.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:663.2249145507812
value loss:5.041993141174316
entropies:351.5361633300781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.151059865951538 seconds
19 rew tensor(1.1847, dtype=torch.float64) delta_t tensor(-0.0474, dtype=torch.float64)
19 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(0.9080, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
18 gae_duplicate tensor(-0.0561, dtype=torch.float64) tensor(-0.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9815, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
17 gae_duplicate tensor(-0.1025, dtype=torch.float64) tensor(0.5853, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0065, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
16 gae_duplicate tensor(-0.0788, dtype=torch.float64) tensor(0.2436, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8406, dtype=torch.float64) delta_t tensor(-0.1134, dtype=torch.float64)
15 gae_duplicate tensor(-0.3207, dtype=torch.float64) tensor(2.2831, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4807, dtype=torch.float64) delta_t tensor(0.1682, dtype=torch.float64)
14 gae_duplicate tensor(-1.0061, dtype=torch.float64) tensor(-2.8248, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5475, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
13 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-1.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1902, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
12 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-1.5557, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
11 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-0.8390, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2830, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
10 gae_duplicate tensor(-0.2490, dtype=torch.float64) tensor(0.2991, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4575, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
9 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(1.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5247, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
8 gae_duplicate tensor(-0.2783, dtype=torch.float64) tensor(-0.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9436, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
7 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(-1.8957, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7424, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
6 gae_duplicate tensor(-0.1283, dtype=torch.float64) tensor(-0.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5703, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
5 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(0.0974, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0599, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
4 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(0.2723, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2243, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
3 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(-0.6394, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3662, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
2 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(2.2212, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:36.71390914916992
value loss:6.832117080688477
entropies:351.7882995605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.196741819381714 seconds
19 rew tensor(1.2364, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
19 gae_duplicate tensor(-0.0836, dtype=torch.float64) tensor(1.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2234, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
18 gae_duplicate tensor(0.0173, dtype=torch.float64) tensor(-1.8794, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1478, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
17 gae_duplicate tensor(-0.0827, dtype=torch.float64) tensor(-0.3295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0712, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
16 gae_duplicate tensor(-0.2188, dtype=torch.float64) tensor(-1.0228, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0455, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
15 gae_duplicate tensor(0.0391, dtype=torch.float64) tensor(-2.9134, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1160, dtype=torch.float64) delta_t tensor(-0.5510, dtype=torch.float64)
14 gae_duplicate tensor(-1.3276, dtype=torch.float64) tensor(10.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1922, dtype=torch.float64) delta_t tensor(-0.3587, dtype=torch.float64)
13 gae_duplicate tensor(-2.8443, dtype=torch.float64) tensor(8.6774, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0163, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
12 gae_duplicate tensor(-0.9002, dtype=torch.float64) tensor(2.4819, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0459, dtype=torch.float64) delta_t tensor(-0.3340, dtype=torch.float64)
11 gae_duplicate tensor(-2.4577, dtype=torch.float64) tensor(7.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1016, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
10 gae_duplicate tensor(-0.0810, dtype=torch.float64) tensor(-3.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4692, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
9 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-2.5950, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7794, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
8 gae_duplicate tensor(-0.1224, dtype=torch.float64) tensor(-0.3192, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4370, dtype=torch.float64) delta_t tensor(0.2871, dtype=torch.float64)
7 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(-5.7630, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8822, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
6 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-1.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2919, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
5 gae_duplicate tensor(-0.2238, dtype=torch.float64) tensor(-0.1447, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1162, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
4 gae_duplicate tensor(-0.0204, dtype=torch.float64) tensor(-1.5836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9480, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
3 gae_duplicate tensor(-0.2682, dtype=torch.float64) tensor(1.7317, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2282, dtype=torch.float64) delta_t tensor(0.0505, dtype=torch.float64)
2 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-0.8847, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-611.57373046875
value loss:32.76876449584961
entropies:351.95587158203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.4568)
ToM Target loss= tensor(3997.5447)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.004877805709839 seconds
19 rew tensor(0.9663, dtype=torch.float64) delta_t tensor(-0.2590, dtype=torch.float64)
19 gae_duplicate tensor(-1.4788, dtype=torch.float64) tensor(4.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1591, dtype=torch.float64) delta_t tensor(0.1130, dtype=torch.float64)
18 gae_duplicate tensor(0.0005, dtype=torch.float64) tensor(-1.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8121, dtype=torch.float64) delta_t tensor(-0.1906, dtype=torch.float64)
17 gae_duplicate tensor(-1.4482, dtype=torch.float64) tensor(3.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7040, dtype=torch.float64) delta_t tensor(-0.1963, dtype=torch.float64)
16 gae_duplicate tensor(-1.3719, dtype=torch.float64) tensor(3.8638, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8794, dtype=torch.float64) delta_t tensor(-0.0512, dtype=torch.float64)
15 gae_duplicate tensor(-0.2989, dtype=torch.float64) tensor(1.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5979, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
14 gae_duplicate tensor(-0.2124, dtype=torch.float64) tensor(0.9551, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3091, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
13 gae_duplicate tensor(-1.1807, dtype=torch.float64) tensor(1.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
12 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-1.6648, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2798, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
11 gae_duplicate tensor(-0.1697, dtype=torch.float64) tensor(-2.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1253, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
10 gae_duplicate tensor(-0.0956, dtype=torch.float64) tensor(-0.8733, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3563, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
9 gae_duplicate tensor(-0.0990, dtype=torch.float64) tensor(-1.6345, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7296, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
8 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(0.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2675, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
7 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-1.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7679, dtype=torch.float64) delta_t tensor(0.1736, dtype=torch.float64)
6 gae_duplicate tensor(-0.0216, dtype=torch.float64) tensor(-3.2490, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3151, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
5 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(0.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2452, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
4 gae_duplicate tensor(0.0538, dtype=torch.float64) tensor(-2.4471, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7405, dtype=torch.float64) delta_t tensor(-0.1207, dtype=torch.float64)
3 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(2.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0867, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
2 gae_duplicate tensor(0.0037, dtype=torch.float64) tensor(-2.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-212.441650390625
value loss:15.333860397338867
entropies:351.9762878417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.949973106384277 seconds
19 rew tensor(1.1335, dtype=torch.float64) delta_t tensor(-0.0570, dtype=torch.float64)
19 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(1.0989, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0825, dtype=torch.float64) delta_t tensor(0.0784, dtype=torch.float64)
18 gae_duplicate tensor(-0.0166, dtype=torch.float64) tensor(-1.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0576, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
17 gae_duplicate tensor(0.0046, dtype=torch.float64) tensor(-1.1902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9177, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
16 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(-1.9600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.0034, dtype=torch.float64)
15 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-0.2777, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4972, dtype=torch.float64) delta_t tensor(-0.0388, dtype=torch.float64)
14 gae_duplicate tensor(-0.1456, dtype=torch.float64) tensor(0.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8785, dtype=torch.float64) delta_t tensor(0.1835, dtype=torch.float64)
13 gae_duplicate tensor(0.0841, dtype=torch.float64) tensor(-3.4189, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0762, dtype=torch.float64) delta_t tensor(-0.1169, dtype=torch.float64)
12 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(1.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5477, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
11 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-1.0432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1798, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
10 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(0.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3429, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
9 gae_duplicate tensor(-0.1449, dtype=torch.float64) tensor(0.5940, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4738, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
8 gae_duplicate tensor(-0.0371, dtype=torch.float64) tensor(-1.6032, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2607, dtype=torch.float64) delta_t tensor(0.0680, dtype=torch.float64)
7 gae_duplicate tensor(-0.0501, dtype=torch.float64) tensor(-1.3983, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7265, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
6 gae_duplicate tensor(0.0639, dtype=torch.float64) tensor(-3.1179, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2180, dtype=torch.float64) delta_t tensor(-0.1068, dtype=torch.float64)
5 gae_duplicate tensor(-0.2057, dtype=torch.float64) tensor(1.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3437, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
4 gae_duplicate tensor(-0.1137, dtype=torch.float64) tensor(0.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4272, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
3 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(0.2835, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0362, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
2 gae_duplicate tensor(-0.5246, dtype=torch.float64) tensor(3.1414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:158.96194458007812
value loss:3.5298547744750977
entropies:351.9543151855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881136178970337 seconds
19 rew tensor(0.9656, dtype=torch.float64) delta_t tensor(-0.2768, dtype=torch.float64)
19 gae_duplicate tensor(-1.4456, dtype=torch.float64) tensor(5.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2110, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
18 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-1.5846, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1220, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
17 gae_duplicate tensor(0.0271, dtype=torch.float64) tensor(-1.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0193, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
16 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-2.1207, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(0.0127, dtype=torch.float64)
15 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(-0.4692, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7129, dtype=torch.float64) delta_t tensor(0.2187, dtype=torch.float64)
14 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-3.9417, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1640, dtype=torch.float64) delta_t tensor(-0.2495, dtype=torch.float64)
13 gae_duplicate tensor(-1.1427, dtype=torch.float64) tensor(4.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1900, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
12 gae_duplicate tensor(-0.2110, dtype=torch.float64) tensor(-0.5515, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4074, dtype=torch.float64) delta_t tensor(0.0477, dtype=torch.float64)
11 gae_duplicate tensor(-0.1409, dtype=torch.float64) tensor(-0.8503, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1293, dtype=torch.float64) delta_t tensor(-0.0074, dtype=torch.float64)
10 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(-0.0335, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5092, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
9 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-1.5799, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7044, dtype=torch.float64) delta_t tensor(-0.0277, dtype=torch.float64)
8 gae_duplicate tensor(-0.2071, dtype=torch.float64) tensor(0.4443, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5470, dtype=torch.float64) delta_t tensor(0.1674, dtype=torch.float64)
7 gae_duplicate tensor(-0.1213, dtype=torch.float64) tensor(-3.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8191, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
6 gae_duplicate tensor(-0.1101, dtype=torch.float64) tensor(-0.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3926, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
5 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-0.5071, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0935, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
4 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(0.2949, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0206, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
3 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(0.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2510, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
2 gae_duplicate tensor(-0.2544, dtype=torch.float64) tensor(0.2068, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:257.0669860839844
value loss:10.75722885131836
entropies:351.9581604003906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.658452987670898 seconds
19 rew tensor(1.1725, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
19 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(0.6833, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1726, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
18 gae_duplicate tensor(0.0173, dtype=torch.float64) tensor(-1.8199, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1340, dtype=torch.float64) delta_t tensor(0.1578, dtype=torch.float64)
17 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-3.3021, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0189, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
16 gae_duplicate tensor(-0.0203, dtype=torch.float64) tensor(-1.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
15 gae_duplicate tensor(-0.1236, dtype=torch.float64) tensor(0.3808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9164, dtype=torch.float64) delta_t tensor(0.2372, dtype=torch.float64)
14 gae_duplicate tensor(0.0631, dtype=torch.float64) tensor(-4.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0584, dtype=torch.float64) delta_t tensor(-0.3534, dtype=torch.float64)
13 gae_duplicate tensor(-2.5864, dtype=torch.float64) tensor(7.0966, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.1228, dtype=torch.float64)
12 gae_duplicate tensor(-0.0108, dtype=torch.float64) tensor(-1.6724, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0789, dtype=torch.float64) delta_t tensor(-0.2176, dtype=torch.float64)
11 gae_duplicate tensor(-1.3398, dtype=torch.float64) tensor(4.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
10 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-2.4443, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1387, dtype=torch.float64) delta_t tensor(0.1183, dtype=torch.float64)
9 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-2.6321, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4490, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
8 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(1.3956, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5230, dtype=torch.float64) delta_t tensor(-0.0989, dtype=torch.float64)
7 gae_duplicate tensor(-0.7632, dtype=torch.float64) tensor(2.3256, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5642, dtype=torch.float64) delta_t tensor(0.0152, dtype=torch.float64)
6 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(0.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8272, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
5 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(1.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2408, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
4 gae_duplicate tensor(-0.2865, dtype=torch.float64) tensor(0.0025, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5217, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
3 gae_duplicate tensor(-0.2599, dtype=torch.float64) tensor(0.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
2 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(-0.3815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-90.98995971679688
value loss:18.80144691467285
entropies:351.8969421386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.666018009185791 seconds
19 rew tensor(1.1724, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
19 gae_duplicate tensor(-0.1167, dtype=torch.float64) tensor(-0.0399, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1086, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
18 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-2.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8123, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
17 gae_duplicate tensor(-1.3844, dtype=torch.float64) tensor(3.7524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9424, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
16 gae_duplicate tensor(-0.1012, dtype=torch.float64) tensor(-0.1258, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9679, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
15 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-0.2813, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7503, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
14 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-1.9514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1916, dtype=torch.float64) delta_t tensor(-0.2583, dtype=torch.float64)
13 gae_duplicate tensor(-1.3541, dtype=torch.float64) tensor(5.3533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1175, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
12 gae_duplicate tensor(-0.3721, dtype=torch.float64) tensor(0.2100, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4961, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
11 gae_duplicate tensor(0.0116, dtype=torch.float64) tensor(-2.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0145, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
10 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-0.9942, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
9 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(-0.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5496, dtype=torch.float64) delta_t tensor(0.1247, dtype=torch.float64)
8 gae_duplicate tensor(0.0077, dtype=torch.float64) tensor(-2.5350, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5116, dtype=torch.float64) delta_t tensor(0.0167, dtype=torch.float64)
7 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-0.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6263, dtype=torch.float64) delta_t tensor(0.0775, dtype=torch.float64)
6 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-1.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4702, dtype=torch.float64) delta_t tensor(-0.1078, dtype=torch.float64)
5 gae_duplicate tensor(-0.3272, dtype=torch.float64) tensor(2.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1175, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
4 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-0.5942, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8811, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
3 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(0.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2273, dtype=torch.float64) delta_t tensor(-0.1308, dtype=torch.float64)
2 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(2.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-153.0095977783203
value loss:9.339205741882324
entropies:351.6352233886719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3905.4346)
ToM Target loss= tensor(4001.6057)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.734622001647949 seconds
19 rew tensor(1.1984, dtype=torch.float64) delta_t tensor(0.0229, dtype=torch.float64)
19 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-0.4388, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0964, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
18 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-1.3568, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0835, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
17 gae_duplicate tensor(0.0752, dtype=torch.float64) tensor(-2.8121, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
16 gae_duplicate tensor(-0.0456, dtype=torch.float64) tensor(-1.1024, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8802, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
15 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(-0.2447, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0032, dtype=torch.float64) delta_t tensor(-0.4708, dtype=torch.float64)
14 gae_duplicate tensor(-2.1522, dtype=torch.float64) tensor(8.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5736, dtype=torch.float64) delta_t tensor(0.0349, dtype=torch.float64)
13 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(0.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2794, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
12 gae_duplicate tensor(-0.1463, dtype=torch.float64) tensor(-1.2723, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4713, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
11 gae_duplicate tensor(-0.1531, dtype=torch.float64) tensor(-0.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0529, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
10 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(-0.4117, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2671, dtype=torch.float64) delta_t tensor(-0.0526, dtype=torch.float64)
9 gae_duplicate tensor(-0.2057, dtype=torch.float64) tensor(0.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4742, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
8 gae_duplicate tensor(-0.1946, dtype=torch.float64) tensor(0.4325, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9063, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
7 gae_duplicate tensor(-0.1553, dtype=torch.float64) tensor(0.8186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5891, dtype=torch.float64) delta_t tensor(0.0404, dtype=torch.float64)
6 gae_duplicate tensor(-0.0564, dtype=torch.float64) tensor(-0.8024, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6482, dtype=torch.float64) delta_t tensor(-0.0868, dtype=torch.float64)
5 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(1.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
4 gae_duplicate tensor(-0.1273, dtype=torch.float64) tensor(0.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2132, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
3 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(-0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
2 gae_duplicate tensor(-0.2191, dtype=torch.float64) tensor(-0.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-331.3372497558594
value loss:10.070905685424805
entropies:351.1817626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.891909837722778 seconds
19 rew tensor(1.1350, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
19 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(1.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1604, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
18 gae_duplicate tensor(0.0347, dtype=torch.float64) tensor(-1.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0715, dtype=torch.float64) delta_t tensor(0.0902, dtype=torch.float64)
17 gae_duplicate tensor(0.0083, dtype=torch.float64) tensor(-1.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7657, dtype=torch.float64) delta_t tensor(-0.1978, dtype=torch.float64)
16 gae_duplicate tensor(-1.3259, dtype=torch.float64) tensor(3.2216, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.0447, dtype=torch.float64)
15 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(-0.5929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3011, dtype=torch.float64) delta_t tensor(-0.2312, dtype=torch.float64)
14 gae_duplicate tensor(-2.2350, dtype=torch.float64) tensor(5.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1005, dtype=torch.float64) delta_t tensor(-0.3015, dtype=torch.float64)
13 gae_duplicate tensor(-1.1886, dtype=torch.float64) tensor(6.4473, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4196, dtype=torch.float64) delta_t tensor(0.2134, dtype=torch.float64)
12 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-3.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4722, dtype=torch.float64) delta_t tensor(0.1976, dtype=torch.float64)
11 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(-4.2066, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0153, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
10 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-2.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
9 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-1.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5894, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
8 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(1.6707, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2052, dtype=torch.float64) delta_t tensor(-0.3624, dtype=torch.float64)
7 gae_duplicate tensor(-1.7275, dtype=torch.float64) tensor(7.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7949, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
6 gae_duplicate tensor(-0.5355, dtype=torch.float64) tensor(1.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4440, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
5 gae_duplicate tensor(-0.2166, dtype=torch.float64) tensor(-0.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0369, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
4 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-0.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1398, dtype=torch.float64) delta_t tensor(-0.0561, dtype=torch.float64)
3 gae_duplicate tensor(-0.1558, dtype=torch.float64) tensor(0.8937, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
2 gae_duplicate tensor(-0.0909, dtype=torch.float64) tensor(-1.1810, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-686.0872192382812
value loss:22.200729370117188
entropies:350.8791809082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.735668897628784 seconds
19 rew tensor(1.1859, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
19 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-0.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0327, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
18 gae_duplicate tensor(-0.0700, dtype=torch.float64) tensor(-0.6389, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0201, dtype=torch.float64) delta_t tensor(0.0219, dtype=torch.float64)
17 gae_duplicate tensor(-0.0343, dtype=torch.float64) tensor(-0.5122, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.0201, dtype=torch.float64)
16 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-0.4431, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8929, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
15 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(-1.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0485, dtype=torch.float64) delta_t tensor(-0.4601, dtype=torch.float64)
14 gae_duplicate tensor(-1.4463, dtype=torch.float64) tensor(8.7455, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4465, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
13 gae_duplicate tensor(-0.9904, dtype=torch.float64) tensor(0.8728, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3809, dtype=torch.float64) delta_t tensor(0.1814, dtype=torch.float64)
12 gae_duplicate tensor(-0.1827, dtype=torch.float64) tensor(-3.4881, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4971, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
11 gae_duplicate tensor(0.0214, dtype=torch.float64) tensor(-3.7081, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0399, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
10 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(-0.1245, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3055, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
9 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(-0.3594, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6022, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
8 gae_duplicate tensor(-0.0155, dtype=torch.float64) tensor(-1.8800, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1020, dtype=torch.float64) delta_t tensor(-0.0335, dtype=torch.float64)
7 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(0.5126, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7946, dtype=torch.float64) delta_t tensor(0.1097, dtype=torch.float64)
6 gae_duplicate tensor(-0.2401, dtype=torch.float64) tensor(-2.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2132, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
5 gae_duplicate tensor(-0.2325, dtype=torch.float64) tensor(1.9190, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3988, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
4 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(-1.2523, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4981, dtype=torch.float64) delta_t tensor(-0.0229, dtype=torch.float64)
3 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(0.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0667, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
2 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(-0.3019, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:168.42420959472656
value loss:10.854153633117676
entropies:350.5041198730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.160300016403198 seconds
19 rew tensor(1.1994, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
19 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(-0.6307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1605, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
18 gae_duplicate tensor(0.0794, dtype=torch.float64) tensor(-3.0458, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0712, dtype=torch.float64) delta_t tensor(0.0691, dtype=torch.float64)
17 gae_duplicate tensor(-0.0469, dtype=torch.float64) tensor(-1.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9186, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
16 gae_duplicate tensor(-0.1406, dtype=torch.float64) tensor(-0.5010, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9437, dtype=torch.float64) delta_t tensor(0.0861, dtype=torch.float64)
15 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-1.9237, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1412, dtype=torch.float64) delta_t tensor(-0.3596, dtype=torch.float64)
14 gae_duplicate tensor(-2.1201, dtype=torch.float64) tensor(7.4455, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7126, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
13 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-1.4178, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2548, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
12 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-0.4224, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3795, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
11 gae_duplicate tensor(-0.2112, dtype=torch.float64) tensor(-1.3736, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
10 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-0.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(-0.0350, dtype=torch.float64)
9 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
8 gae_duplicate tensor(-0.3985, dtype=torch.float64) tensor(1.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9135, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
7 gae_duplicate tensor(-0.3124, dtype=torch.float64) tensor(0.5160, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6013, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
6 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-0.2607, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6523, dtype=torch.float64) delta_t tensor(-0.1439, dtype=torch.float64)
5 gae_duplicate tensor(-0.3718, dtype=torch.float64) tensor(2.5116, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0643, dtype=torch.float64) delta_t tensor(0.0644, dtype=torch.float64)
4 gae_duplicate tensor(-0.0915, dtype=torch.float64) tensor(-0.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1942, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
3 gae_duplicate tensor(-0.3837, dtype=torch.float64) tensor(1.4075, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4090, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
2 gae_duplicate tensor(-0.2305, dtype=torch.float64) tensor(0.9649, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-227.52999877929688
value loss:10.933476448059082
entropies:350.14935302734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.897331953048706 seconds
19 rew tensor(1.1978, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
19 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(1.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1725, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
18 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(-1.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1341, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
17 gae_duplicate tensor(-0.0304, dtype=torch.float64) tensor(-1.5442, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0710, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
16 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-0.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0576, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
15 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-0.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4416, dtype=torch.float64) delta_t tensor(-0.2976, dtype=torch.float64)
14 gae_duplicate tensor(-2.1423, dtype=torch.float64) tensor(4.7497, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7905, dtype=torch.float64) delta_t tensor(0.2102, dtype=torch.float64)
13 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(-3.1296, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6383, dtype=torch.float64) delta_t tensor(0.2487, dtype=torch.float64)
12 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-5.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4886, dtype=torch.float64) delta_t tensor(-0.5555, dtype=torch.float64)
11 gae_duplicate tensor(-2.0076, dtype=torch.float64) tensor(10.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.6322, dtype=torch.float64) delta_t tensor(-1.3415, dtype=torch.float64)
10 gae_duplicate tensor(-6.4537, dtype=torch.float64) tensor(30.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0433, dtype=torch.float64) delta_t tensor(-0.2219, dtype=torch.float64)
9 gae_duplicate tensor(-1.5628, dtype=torch.float64) tensor(6.2410, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4096, dtype=torch.float64) delta_t tensor(0.1439, dtype=torch.float64)
8 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(-2.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4629, dtype=torch.float64) delta_t tensor(0.1577, dtype=torch.float64)
7 gae_duplicate tensor(-0.0171, dtype=torch.float64) tensor(-3.4486, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8570, dtype=torch.float64) delta_t tensor(0.0171, dtype=torch.float64)
6 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-0.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2926, dtype=torch.float64) delta_t tensor(-0.0951, dtype=torch.float64)
5 gae_duplicate tensor(-0.3097, dtype=torch.float64) tensor(1.9339, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1922, dtype=torch.float64) delta_t tensor(0.0076, dtype=torch.float64)
4 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(0.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8337, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
3 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(-0.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1274, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
2 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(0.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2016.171142578125
value loss:95.41644287109375
entropies:349.53961181640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3913.4504)
ToM Target loss= tensor(4003.7327)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.80952000617981 seconds
19 rew tensor(1.2103, dtype=torch.float64) delta_t tensor(-0.0428, dtype=torch.float64)
19 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(0.8543, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(0.1339, dtype=torch.float64)
18 gae_duplicate tensor(0.0308, dtype=torch.float64) tensor(-2.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0187, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
17 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-0.3985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9806, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
16 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-0.5936, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8785, dtype=torch.float64) delta_t tensor(-0.0408, dtype=torch.float64)
15 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(0.6586, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6100, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
14 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-4.5788, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
13 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-0.5484, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1631, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
12 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-1.4144, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5991, dtype=torch.float64) delta_t tensor(0.1139, dtype=torch.float64)
11 gae_duplicate tensor(0.0128, dtype=torch.float64) tensor(-2.3933, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2071, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
10 gae_duplicate tensor(-0.1684, dtype=torch.float64) tensor(0.2074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5484, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
9 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-1.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6778, dtype=torch.float64) delta_t tensor(-0.1160, dtype=torch.float64)
8 gae_duplicate tensor(-0.2120, dtype=torch.float64) tensor(2.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7179, dtype=torch.float64) delta_t tensor(-0.7796, dtype=torch.float64)
7 gae_duplicate tensor(-4.6403, dtype=torch.float64) tensor(16.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9949, dtype=torch.float64) delta_t tensor(-0.0974, dtype=torch.float64)
6 gae_duplicate tensor(-0.6764, dtype=torch.float64) tensor(3.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2918, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
5 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-2.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0614, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
4 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-0.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1736, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
3 gae_duplicate tensor(-0.3703, dtype=torch.float64) tensor(0.7510, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
2 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-1.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-456.7060241699219
value loss:36.91093826293945
entropies:348.706298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8120551109313965 seconds
19 rew tensor(1.1971, dtype=torch.float64) delta_t tensor(-0.1136, dtype=torch.float64)
19 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(2.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1589, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
18 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(0.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1849, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
17 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-2.2826, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7783, dtype=torch.float64) delta_t tensor(-0.2333, dtype=torch.float64)
16 gae_duplicate tensor(-1.2536, dtype=torch.float64) tensor(3.8266, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0069, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
15 gae_duplicate tensor(-0.1761, dtype=torch.float64) tensor(-1.8767, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0706, dtype=torch.float64) delta_t tensor(-0.3653, dtype=torch.float64)
14 gae_duplicate tensor(-1.4038, dtype=torch.float64) tensor(7.7124, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0818, dtype=torch.float64) delta_t tensor(-0.2552, dtype=torch.float64)
13 gae_duplicate tensor(-2.5769, dtype=torch.float64) tensor(4.8742, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5220, dtype=torch.float64) delta_t tensor(0.2683, dtype=torch.float64)
12 gae_duplicate tensor(-0.1022, dtype=torch.float64) tensor(-4.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3164, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
11 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-1.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(0.0519, dtype=torch.float64)
10 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-1.0022, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2532, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
9 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(0.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4098, dtype=torch.float64) delta_t tensor(0.0666, dtype=torch.float64)
8 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-1.3003, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.0492, dtype=torch.float64) delta_t tensor(-0.9754, dtype=torch.float64)
7 gae_duplicate tensor(-6.1096, dtype=torch.float64) tensor(16.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6523, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
6 gae_duplicate tensor(-0.5500, dtype=torch.float64) tensor(1.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4705, dtype=torch.float64) delta_t tensor(0.0908, dtype=torch.float64)
5 gae_duplicate tensor(-0.1842, dtype=torch.float64) tensor(-1.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0367, dtype=torch.float64) delta_t tensor(0.0896, dtype=torch.float64)
4 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-1.6626, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1892, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
3 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(-0.1243, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3812, dtype=torch.float64) delta_t tensor(0.0938, dtype=torch.float64)
2 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(-2.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1093.84765625
value loss:80.35563659667969
entropies:347.6236877441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.956435918807983 seconds
19 rew tensor(1.2097, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
19 gae_duplicate tensor(-0.1888, dtype=torch.float64) tensor(1.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(0.0056, dtype=torch.float64)
18 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(0.1154, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0817, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
17 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(0.1420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9670, dtype=torch.float64) delta_t tensor(-0.0619, dtype=torch.float64)
16 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(1.0731, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9165, dtype=torch.float64) delta_t tensor(0.0144, dtype=torch.float64)
15 gae_duplicate tensor(-0.2512, dtype=torch.float64) tensor(-0.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4114, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
14 gae_duplicate tensor(-0.9807, dtype=torch.float64) tensor(1.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
13 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-1.8162, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3039, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
12 gae_duplicate tensor(-0.1934, dtype=torch.float64) tensor(-0.8565, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4304, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
11 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-1.4242, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1154, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
10 gae_duplicate tensor(-0.0790, dtype=torch.float64) tensor(-0.6731, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4045, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
9 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(-1.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6246, dtype=torch.float64) delta_t tensor(-0.0825, dtype=torch.float64)
8 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(1.4610, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5518, dtype=torch.float64) delta_t tensor(-0.1137, dtype=torch.float64)
7 gae_duplicate tensor(-2.1051, dtype=torch.float64) tensor(1.7084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7651, dtype=torch.float64) delta_t tensor(0.0119, dtype=torch.float64)
6 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-0.0036, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6222, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
5 gae_duplicate tensor(-0.2516, dtype=torch.float64) tensor(-2.4055, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2124, dtype=torch.float64) delta_t tensor(0.0529, dtype=torch.float64)
4 gae_duplicate tensor(-0.1218, dtype=torch.float64) tensor(-1.1584, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4517, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
3 gae_duplicate tensor(-0.2739, dtype=torch.float64) tensor(1.4047, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5442, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
2 gae_duplicate tensor(-0.2532, dtype=torch.float64) tensor(-0.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-35.91716003417969
value loss:13.408775329589844
entropies:346.9342041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.903818845748901 seconds
19 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
19 gae_duplicate tensor(-0.1664, dtype=torch.float64) tensor(2.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0573, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
18 gae_duplicate tensor(-0.1358, dtype=torch.float64) tensor(0.5449, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9549, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
17 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(1.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(-0.0851, dtype=torch.float64)
16 gae_duplicate tensor(-0.1871, dtype=torch.float64) tensor(1.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8530, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
15 gae_duplicate tensor(-0.2865, dtype=torch.float64) tensor(2.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
14 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-3.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6871, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
13 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(-2.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0252, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
12 gae_duplicate tensor(-0.3826, dtype=torch.float64) tensor(0.3907, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6106, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
11 gae_duplicate tensor(-0.0817, dtype=torch.float64) tensor(-0.4914, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0912, dtype=torch.float64) delta_t tensor(0.0318, dtype=torch.float64)
10 gae_duplicate tensor(-0.1346, dtype=torch.float64) tensor(-0.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4583, dtype=torch.float64) delta_t tensor(0.0212, dtype=torch.float64)
9 gae_duplicate tensor(-0.0982, dtype=torch.float64) tensor(-0.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6777, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
8 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(0.9174, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4241, dtype=torch.float64) delta_t tensor(-0.0374, dtype=torch.float64)
7 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(0.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7414, dtype=torch.float64) delta_t tensor(0.1285, dtype=torch.float64)
6 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-2.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3415, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
5 gae_duplicate tensor(-0.1065, dtype=torch.float64) tensor(-2.1952, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1156, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
4 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(-1.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8576, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
3 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-0.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2159, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
2 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-1.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:108.28002166748047
value loss:5.006239414215088
entropies:346.5489196777344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.821020841598511 seconds
19 rew tensor(1.1728, dtype=torch.float64) delta_t tensor(-0.1352, dtype=torch.float64)
19 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(2.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1857, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
18 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-0.5435, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1088, dtype=torch.float64) delta_t tensor(0.0143, dtype=torch.float64)
17 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-0.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9427, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
16 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(1.4362, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8147, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
15 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(0.4734, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(-0.1528, dtype=torch.float64)
14 gae_duplicate tensor(-0.9050, dtype=torch.float64) tensor(2.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6234, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
13 gae_duplicate tensor(-0.0524, dtype=torch.float64) tensor(-0.3548, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3048, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
12 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(1.4457, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
11 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(0.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0248, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
10 gae_duplicate tensor(-0.0627, dtype=torch.float64) tensor(-0.5655, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2285, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
9 gae_duplicate tensor(-0.1783, dtype=torch.float64) tensor(0.5867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4997, dtype=torch.float64) delta_t tensor(0.0224, dtype=torch.float64)
8 gae_duplicate tensor(-0.1719, dtype=torch.float64) tensor(-0.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8299, dtype=torch.float64) delta_t tensor(0.1941, dtype=torch.float64)
7 gae_duplicate tensor(-0.0568, dtype=torch.float64) tensor(-3.3146, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5762, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
6 gae_duplicate tensor(-0.0394, dtype=torch.float64) tensor(-2.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5703, dtype=torch.float64) delta_t tensor(0.0406, dtype=torch.float64)
5 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(-0.8198, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0618, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
4 gae_duplicate tensor(-0.1415, dtype=torch.float64) tensor(-0.7358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0985, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
3 gae_duplicate tensor(-0.2066, dtype=torch.float64) tensor(0.5161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4190, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
2 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(-0.7489, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-49.99897003173828
value loss:4.2305684089660645
entropies:346.3013610839844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3904.4939)
ToM Target loss= tensor(4005.3809)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.526615858078003 seconds
19 rew tensor(1.1599, dtype=torch.float64) delta_t tensor(-0.1903, dtype=torch.float64)
19 gae_duplicate tensor(-0.2718, dtype=torch.float64) tensor(3.2108, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1727, dtype=torch.float64) delta_t tensor(0.0312, dtype=torch.float64)
18 gae_duplicate tensor(-0.0822, dtype=torch.float64) tensor(-0.1230, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5800, dtype=torch.float64) delta_t tensor(-0.5222, dtype=torch.float64)
17 gae_duplicate tensor(-1.5389, dtype=torch.float64) tensor(11.4086, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(-0.0692, dtype=torch.float64)
16 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(2.4550, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8914, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
15 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(1.7684, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.4013, dtype=torch.float64)
14 gae_duplicate tensor(-0.1492, dtype=torch.float64) tensor(-8.4123, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
13 gae_duplicate tensor(0.0228, dtype=torch.float64) tensor(-3.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2039, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
12 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-0.6467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5080, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
11 gae_duplicate tensor(-0.0847, dtype=torch.float64) tensor(-1.6078, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1669, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
10 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-0.6215, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3685, dtype=torch.float64) delta_t tensor(-0.1040, dtype=torch.float64)
9 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(1.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4979, dtype=torch.float64) delta_t tensor(0.0400, dtype=torch.float64)
8 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-0.8072, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9337, dtype=torch.float64) delta_t tensor(0.0614, dtype=torch.float64)
7 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-1.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6000, dtype=torch.float64) delta_t tensor(0.1317, dtype=torch.float64)
6 gae_duplicate tensor(-0.0626, dtype=torch.float64) tensor(-2.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6485, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
5 gae_duplicate tensor(-0.1405, dtype=torch.float64) tensor(-1.4965, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0876, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
4 gae_duplicate tensor(-0.1349, dtype=torch.float64) tensor(-0.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2266, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
3 gae_duplicate tensor(-0.0375, dtype=torch.float64) tensor(-1.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4192, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
2 gae_duplicate tensor(-0.3122, dtype=torch.float64) tensor(1.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-76.57930755615234
value loss:12.477590560913086
entropies:346.00341796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.936399698257446 seconds
19 rew tensor(1.0955, dtype=torch.float64) delta_t tensor(-0.1374, dtype=torch.float64)
19 gae_duplicate tensor(-0.1893, dtype=torch.float64) tensor(2.6585, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1084, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
18 gae_duplicate tensor(-0.1122, dtype=torch.float64) tensor(-0.5176, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0320, dtype=torch.float64) delta_t tensor(-0.0370, dtype=torch.float64)
17 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(0.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8659, dtype=torch.float64) delta_t tensor(-0.1085, dtype=torch.float64)
16 gae_duplicate tensor(-0.2384, dtype=torch.float64) tensor(2.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8918, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
15 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(0.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(-0.1607, dtype=torch.float64)
14 gae_duplicate tensor(-0.4940, dtype=torch.float64) tensor(2.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7529, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
13 gae_duplicate tensor(-0.2629, dtype=torch.float64) tensor(0.8802, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1513, dtype=torch.float64) delta_t tensor(-0.0231, dtype=torch.float64)
12 gae_duplicate tensor(-0.1465, dtype=torch.float64) tensor(0.9151, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
11 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(-0.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
10 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-1.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4565, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
9 gae_duplicate tensor(-0.0924, dtype=torch.float64) tensor(0.3682, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6767, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
8 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(1.8539, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1304, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
7 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(1.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7025, dtype=torch.float64) delta_t tensor(0.1631, dtype=torch.float64)
6 gae_duplicate tensor(0.0252, dtype=torch.float64) tensor(-2.7131, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2151, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
5 gae_duplicate tensor(-0.1359, dtype=torch.float64) tensor(-0.0493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2947, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
4 gae_duplicate tensor(-0.1083, dtype=torch.float64) tensor(-0.7160, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5128, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
3 gae_duplicate tensor(-0.1419, dtype=torch.float64) tensor(0.2097, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0882, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
2 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(-0.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-524.3920288085938
value loss:3.1307802200317383
entropies:345.7088623046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.650075197219849 seconds
19 rew tensor(1.0819, dtype=torch.float64) delta_t tensor(-0.1612, dtype=torch.float64)
19 gae_duplicate tensor(-0.3533, dtype=torch.float64) tensor(3.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
18 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-1.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
17 gae_duplicate tensor(-0.1364, dtype=torch.float64) tensor(-0.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9424, dtype=torch.float64) delta_t tensor(-0.0903, dtype=torch.float64)
16 gae_duplicate tensor(-0.2952, dtype=torch.float64) tensor(1.6001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9689, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
15 gae_duplicate tensor(-0.1936, dtype=torch.float64) tensor(0.0607, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7138, dtype=torch.float64) delta_t tensor(0.0751, dtype=torch.float64)
14 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-1.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3954, dtype=torch.float64) delta_t tensor(-0.2027, dtype=torch.float64)
13 gae_duplicate tensor(-1.3708, dtype=torch.float64) tensor(3.3399, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3190, dtype=torch.float64) delta_t tensor(0.0037, dtype=torch.float64)
12 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(0.4416, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3926, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
11 gae_duplicate tensor(0.0003, dtype=torch.float64) tensor(-0.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0639, dtype=torch.float64) delta_t tensor(-0.0122, dtype=torch.float64)
10 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(0.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3287, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
9 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-1.4402, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5481, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
8 gae_duplicate tensor(-0.2039, dtype=torch.float64) tensor(0.8950, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2737, dtype=torch.float64) delta_t tensor(0.0084, dtype=torch.float64)
7 gae_duplicate tensor(-0.5206, dtype=torch.float64) tensor(-0.5707, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6249, dtype=torch.float64) delta_t tensor(0.1032, dtype=torch.float64)
6 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-1.9723, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6498, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
5 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(-1.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1631, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
4 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(-0.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3278, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
3 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(0.2198, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4950, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
2 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-0.1017, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-69.75495147705078
value loss:6.891184329986572
entropies:345.2507629394531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.922675132751465 seconds
19 rew tensor(1.1472, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
19 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(1.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1346, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
18 gae_duplicate tensor(-0.0756, dtype=torch.float64) tensor(-0.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8388, dtype=torch.float64) delta_t tensor(-0.1935, dtype=torch.float64)
17 gae_duplicate tensor(-1.3558, dtype=torch.float64) tensor(3.0044, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0699, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
16 gae_duplicate tensor(-0.0562, dtype=torch.float64) tensor(-0.2823, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8533, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
15 gae_duplicate tensor(-0.2749, dtype=torch.float64) tensor(1.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.1889, dtype=torch.float64)
14 gae_duplicate tensor(-0.1955, dtype=torch.float64) tensor(-3.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6602, dtype=torch.float64) delta_t tensor(0.1737, dtype=torch.float64)
13 gae_duplicate tensor(0.1264, dtype=torch.float64) tensor(-3.2126, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4208, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
12 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(0.8713, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3668, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
11 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-0.1105, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0385, dtype=torch.float64) delta_t tensor(0.0228, dtype=torch.float64)
10 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-0.5377, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1882, dtype=torch.float64) delta_t tensor(-0.0001, dtype=torch.float64)
9 gae_duplicate tensor(-0.1185, dtype=torch.float64) tensor(0.0139, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4223, dtype=torch.float64) delta_t tensor(-0.1193, dtype=torch.float64)
8 gae_duplicate tensor(-0.2086, dtype=torch.float64) tensor(2.1587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5836, dtype=torch.float64) delta_t tensor(-0.2703, dtype=torch.float64)
7 gae_duplicate tensor(-2.0411, dtype=torch.float64) tensor(6.5242, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6626, dtype=torch.float64) delta_t tensor(0.2310, dtype=torch.float64)
6 gae_duplicate tensor(-0.0103, dtype=torch.float64) tensor(-3.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5505, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
5 gae_duplicate tensor(-0.1618, dtype=torch.float64) tensor(-0.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1411, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
4 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(-0.7494, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1309, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
3 gae_duplicate tensor(-0.2665, dtype=torch.float64) tensor(0.3784, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4232, dtype=torch.float64) delta_t tensor(-0.0491, dtype=torch.float64)
2 gae_duplicate tensor(-0.4081, dtype=torch.float64) tensor(0.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-289.1803894042969
value loss:14.458969116210938
entropies:344.9610290527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.190732955932617 seconds
19 rew tensor(1.2102, dtype=torch.float64) delta_t tensor(-0.0571, dtype=torch.float64)
19 gae_duplicate tensor(-0.1217, dtype=torch.float64) tensor(1.1716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1971, dtype=torch.float64) delta_t tensor(0.0863, dtype=torch.float64)
18 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-1.4942, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1338, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
17 gae_duplicate tensor(-0.0503, dtype=torch.float64) tensor(-1.7686, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0692, dtype=torch.float64) delta_t tensor(0.1206, dtype=torch.float64)
16 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-2.0438, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
15 gae_duplicate tensor(-0.1991, dtype=torch.float64) tensor(-0.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7642, dtype=torch.float64) delta_t tensor(0.2757, dtype=torch.float64)
14 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(-6.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7123, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
13 gae_duplicate tensor(-0.0520, dtype=torch.float64) tensor(-2.8626, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
12 gae_duplicate tensor(-0.1576, dtype=torch.float64) tensor(-0.5787, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5842, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
11 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-2.6825, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1663, dtype=torch.float64) delta_t tensor(-0.0914, dtype=torch.float64)
10 gae_duplicate tensor(-0.2052, dtype=torch.float64) tensor(1.4823, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3814, dtype=torch.float64) delta_t tensor(0.1449, dtype=torch.float64)
9 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(-2.5540, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5759, dtype=torch.float64) delta_t tensor(-0.1269, dtype=torch.float64)
8 gae_duplicate tensor(-0.3069, dtype=torch.float64) tensor(2.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.5384, dtype=torch.float64) delta_t tensor(-1.0566, dtype=torch.float64)
7 gae_duplicate tensor(-3.4025, dtype=torch.float64) tensor(18.4167, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9833, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
6 gae_duplicate tensor(-0.2390, dtype=torch.float64) tensor(1.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3177, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
5 gae_duplicate tensor(-0.1340, dtype=torch.float64) tensor(-4.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1907, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
4 gae_duplicate tensor(-0.0769, dtype=torch.float64) tensor(-3.1107, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2177, dtype=torch.float64) delta_t tensor(-0.1069, dtype=torch.float64)
3 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(1.8908, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
2 gae_duplicate tensor(-0.4346, dtype=torch.float64) tensor(-1.3401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:63.973487854003906
value loss:32.174705505371094
entropies:344.3333740234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3908.6992)
ToM Target loss= tensor(4008.1184)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.669579029083252 seconds
19 rew tensor(1.0958, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
19 gae_duplicate tensor(-0.1592, dtype=torch.float64) tensor(1.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
18 gae_duplicate tensor(-0.0464, dtype=torch.float64) tensor(-0.6785, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0317, dtype=torch.float64) delta_t tensor(0.0389, dtype=torch.float64)
17 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-0.7278, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
16 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-1.6165, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8915, dtype=torch.float64) delta_t tensor(0.0535, dtype=torch.float64)
15 gae_duplicate tensor(-0.0663, dtype=torch.float64) tensor(-1.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7134, dtype=torch.float64) delta_t tensor(0.1054, dtype=torch.float64)
14 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-2.5151, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7129, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
13 gae_duplicate tensor(-0.0038, dtype=torch.float64) tensor(-2.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2275, dtype=torch.float64) delta_t tensor(-0.0424, dtype=torch.float64)
12 gae_duplicate tensor(-0.2000, dtype=torch.float64) tensor(0.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4968, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
11 gae_duplicate tensor(-0.1653, dtype=torch.float64) tensor(0.5378, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1417, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
10 gae_duplicate tensor(-0.0466, dtype=torch.float64) tensor(-0.7523, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4069, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
9 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(-0.0761, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5249, dtype=torch.float64) delta_t tensor(-0.1219, dtype=torch.float64)
8 gae_duplicate tensor(-0.1961, dtype=torch.float64) tensor(2.0288, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4628, dtype=torch.float64) delta_t tensor(-0.3483, dtype=torch.float64)
7 gae_duplicate tensor(-2.0127, dtype=torch.float64) tensor(6.2111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6150, dtype=torch.float64) delta_t tensor(0.0831, dtype=torch.float64)
6 gae_duplicate tensor(-0.0792, dtype=torch.float64) tensor(-1.1488, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5969, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
5 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-1.3421, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1410, dtype=torch.float64) delta_t tensor(-0.0209, dtype=torch.float64)
4 gae_duplicate tensor(-0.1057, dtype=torch.float64) tensor(0.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2049, dtype=torch.float64) delta_t tensor(0.0266, dtype=torch.float64)
3 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-0.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5108, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
2 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-0.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:31.480587005615234
value loss:9.225668907165527
entropies:344.18133544921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.712552785873413 seconds
19 rew tensor(1.0819, dtype=torch.float64) delta_t tensor(-0.0853, dtype=torch.float64)
19 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(1.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0957, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
18 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-1.3335, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9938, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
17 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-0.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0191, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
16 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-0.7872, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8797, dtype=torch.float64) delta_t tensor(-0.0567, dtype=torch.float64)
15 gae_duplicate tensor(-0.1668, dtype=torch.float64) tensor(1.0325, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5184, dtype=torch.float64) delta_t tensor(-0.1187, dtype=torch.float64)
14 gae_duplicate tensor(-0.7608, dtype=torch.float64) tensor(2.7247, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(-0.1507, dtype=torch.float64)
13 gae_duplicate tensor(-1.0780, dtype=torch.float64) tensor(2.7183, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4692, dtype=torch.float64) delta_t tensor(0.0868, dtype=torch.float64)
12 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(-1.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2173, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
11 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(1.0670, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0747, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
10 gae_duplicate tensor(-0.0798, dtype=torch.float64) tensor(-0.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3072, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
9 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(-0.9488, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4247, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
8 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(0.6058, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8895, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
7 gae_duplicate tensor(-0.2108, dtype=torch.float64) tensor(1.8919, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5263, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
6 gae_duplicate tensor(-0.1363, dtype=torch.float64) tensor(-0.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6440, dtype=torch.float64) delta_t tensor(-0.0536, dtype=torch.float64)
5 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(1.0000, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
4 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(1.1648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0574, dtype=torch.float64) delta_t tensor(0.0393, dtype=torch.float64)
3 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-0.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3792, dtype=torch.float64) delta_t tensor(-0.0831, dtype=torch.float64)
2 gae_duplicate tensor(-0.2063, dtype=torch.float64) tensor(1.7468, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-584.5379638671875
value loss:5.046864986419678
entropies:344.40142822265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.008522987365723 seconds
19 rew tensor(1.2227, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
19 gae_duplicate tensor(-0.0095, dtype=torch.float64) tensor(-1.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
18 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-2.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0317, dtype=torch.float64) delta_t tensor(0.0179, dtype=torch.float64)
17 gae_duplicate tensor(-0.0193, dtype=torch.float64) tensor(-0.5808, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
16 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-0.2013, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0055, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
15 gae_duplicate tensor(-0.2532, dtype=torch.float64) tensor(-0.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7135, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
14 gae_duplicate tensor(-0.2752, dtype=torch.float64) tensor(-1.2539, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3145, dtype=torch.float64) delta_t tensor(-0.1080, dtype=torch.float64)
13 gae_duplicate tensor(-1.2666, dtype=torch.float64) tensor(2.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3799, dtype=torch.float64) delta_t tensor(0.0830, dtype=torch.float64)
12 gae_duplicate tensor(0.0274, dtype=torch.float64) tensor(-1.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2938, dtype=torch.float64) delta_t tensor(0.0335, dtype=torch.float64)
11 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-0.6038, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0477, dtype=torch.float64) delta_t tensor(0.0460, dtype=torch.float64)
10 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(-1.2257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4093, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
9 gae_duplicate tensor(-0.0078, dtype=torch.float64) tensor(-1.8047, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6782, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
8 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(0.2379, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3112, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
7 gae_duplicate tensor(-0.2523, dtype=torch.float64) tensor(-2.5683, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9477, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
6 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(0.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1060, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
5 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-2.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2498, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
4 gae_duplicate tensor(-0.0916, dtype=torch.float64) tensor(-1.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6558, dtype=torch.float64) delta_t tensor(0.0533, dtype=torch.float64)
3 gae_duplicate tensor(-0.1848, dtype=torch.float64) tensor(-1.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1077, dtype=torch.float64) delta_t tensor(0.0568, dtype=torch.float64)
2 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(-1.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:821.35888671875
value loss:7.069026470184326
entropies:344.37994384765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.954714775085449 seconds
19 rew tensor(1.1719, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
19 gae_duplicate tensor(-0.0879, dtype=torch.float64) tensor(1.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1591, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
18 gae_duplicate tensor(0.0005, dtype=torch.float64) tensor(-2.0414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1212, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
17 gae_duplicate tensor(-0.0036, dtype=torch.float64) tensor(-1.5214, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(-0.0115, dtype=torch.float64)
16 gae_duplicate tensor(-0.1671, dtype=torch.float64) tensor(0.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9422, dtype=torch.float64) delta_t tensor(0.0784, dtype=torch.float64)
15 gae_duplicate tensor(-0.0920, dtype=torch.float64) tensor(-1.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4809, dtype=torch.float64) delta_t tensor(-0.1894, dtype=torch.float64)
14 gae_duplicate tensor(-1.2531, dtype=torch.float64) tensor(4.4000, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2793, dtype=torch.float64) delta_t tensor(-0.1886, dtype=torch.float64)
13 gae_duplicate tensor(-1.9147, dtype=torch.float64) tensor(3.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1513, dtype=torch.float64) delta_t tensor(-0.3367, dtype=torch.float64)
12 gae_duplicate tensor(-2.3177, dtype=torch.float64) tensor(7.9577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.1502, dtype=torch.float64)
11 gae_duplicate tensor(-1.2679, dtype=torch.float64) tensor(3.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0782, dtype=torch.float64) delta_t tensor(0.0326, dtype=torch.float64)
10 gae_duplicate tensor(-0.1721, dtype=torch.float64) tensor(-0.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3817, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
9 gae_duplicate tensor(-0.0015, dtype=torch.float64) tensor(-2.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5877, dtype=torch.float64) delta_t tensor(-0.1039, dtype=torch.float64)
8 gae_duplicate tensor(-0.3134, dtype=torch.float64) tensor(1.6266, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7812, dtype=torch.float64) delta_t tensor(-0.5688, dtype=torch.float64)
7 gae_duplicate tensor(-2.2396, dtype=torch.float64) tensor(9.5333, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7793, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
6 gae_duplicate tensor(-0.2219, dtype=torch.float64) tensor(0.3928, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4964, dtype=torch.float64) delta_t tensor(0.1611, dtype=torch.float64)
5 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(-3.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0902, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
4 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-0.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2562, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
3 gae_duplicate tensor(-0.2715, dtype=torch.float64) tensor(-0.2580, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4344, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
2 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(-0.6340, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1208.275146484375
value loss:33.57413101196289
entropies:344.6618347167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.029881000518799 seconds
19 rew tensor(1.1709, dtype=torch.float64) delta_t tensor(-0.0338, dtype=torch.float64)
19 gae_duplicate tensor(-0.0979, dtype=torch.float64) tensor(0.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1583, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
18 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-2.8895, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7859, dtype=torch.float64) delta_t tensor(-0.1629, dtype=torch.float64)
17 gae_duplicate tensor(-1.3020, dtype=torch.float64) tensor(2.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0319, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
16 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-0.7001, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8150, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
15 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(0.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
14 gae_duplicate tensor(-0.0721, dtype=torch.float64) tensor(-2.2652, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
13 gae_duplicate tensor(-0.7201, dtype=torch.float64) tensor(0.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3695, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
12 gae_duplicate tensor(-0.1332, dtype=torch.float64) tensor(-1.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3805, dtype=torch.float64) delta_t tensor(0.0129, dtype=torch.float64)
11 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-0.5253, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0244, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
10 gae_duplicate tensor(-0.2865, dtype=torch.float64) tensor(-0.4895, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
9 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(-1.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4846, dtype=torch.float64) delta_t tensor(-0.1031, dtype=torch.float64)
8 gae_duplicate tensor(-0.1982, dtype=torch.float64) tensor(1.9287, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8207, dtype=torch.float64) delta_t tensor(0.0107, dtype=torch.float64)
7 gae_duplicate tensor(-0.2755, dtype=torch.float64) tensor(-0.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7124, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
6 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-1.5945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4467, dtype=torch.float64) delta_t tensor(0.0828, dtype=torch.float64)
5 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-1.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0122, dtype=torch.float64) delta_t tensor(-0.0576, dtype=torch.float64)
4 gae_duplicate tensor(-0.1356, dtype=torch.float64) tensor(0.9265, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0252, dtype=torch.float64) delta_t tensor(0.1018, dtype=torch.float64)
3 gae_duplicate tensor(-0.0969, dtype=torch.float64) tensor(-1.8035, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3448, dtype=torch.float64) delta_t tensor(-0.1245, dtype=torch.float64)
2 gae_duplicate tensor(-0.3359, dtype=torch.float64) tensor(2.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:275.3632507324219
value loss:7.525430679321289
entropies:344.86309814453125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3917.4795)
ToM Target loss= tensor(4010.0425)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.787900924682617 seconds
19 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
19 gae_duplicate tensor(-0.1410, dtype=torch.float64) tensor(-0.6081, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1208, dtype=torch.float64) delta_t tensor(0.1597, dtype=torch.float64)
18 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-3.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0571, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
17 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-3.6315, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0051, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
16 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-2.0272, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8906, dtype=torch.float64) delta_t tensor(0.0703, dtype=torch.float64)
15 gae_duplicate tensor(-0.1233, dtype=torch.float64) tensor(-1.1899, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5435, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
14 gae_duplicate tensor(-0.9355, dtype=torch.float64) tensor(-2.9012, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6624, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
13 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-2.1354, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3300, dtype=torch.float64) delta_t tensor(-0.0061, dtype=torch.float64)
12 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(-0.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4451, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
11 gae_duplicate tensor(-0.0519, dtype=torch.float64) tensor(-1.5904, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1158, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
10 gae_duplicate tensor(-0.0883, dtype=torch.float64) tensor(-0.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
9 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(-0.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4470, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
8 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(1.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5493, dtype=torch.float64) delta_t tensor(-0.3119, dtype=torch.float64)
7 gae_duplicate tensor(-1.8360, dtype=torch.float64) tensor(7.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5619, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
6 gae_duplicate tensor(-0.0913, dtype=torch.float64) tensor(-1.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7223, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
5 gae_duplicate tensor(-0.1701, dtype=torch.float64) tensor(-1.1590, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1369, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
4 gae_duplicate tensor(-0.1964, dtype=torch.float64) tensor(0.1225, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2738, dtype=torch.float64) delta_t tensor(-0.0098, dtype=torch.float64)
3 gae_duplicate tensor(-0.2624, dtype=torch.float64) tensor(0.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4940, dtype=torch.float64) delta_t tensor(-0.0717, dtype=torch.float64)
2 gae_duplicate tensor(-0.1857, dtype=torch.float64) tensor(1.5285, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:466.0971984863281
value loss:12.974441528320312
entropies:345.4068603515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.693811893463135 seconds
19 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
19 gae_duplicate tensor(-0.1093, dtype=torch.float64) tensor(0.6906, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0958, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
18 gae_duplicate tensor(0.0151, dtype=torch.float64) tensor(-1.6502, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0322, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
17 gae_duplicate tensor(-0.0864, dtype=torch.float64) tensor(-1.4543, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8916, dtype=torch.float64) delta_t tensor(-0.0173, dtype=torch.float64)
16 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(0.2568, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(0.0006, dtype=torch.float64)
15 gae_duplicate tensor(-0.1327, dtype=torch.float64) tensor(0.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6733, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
14 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-0.0564, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7389, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
13 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-1.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3027, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
12 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-0.4576, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3295, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
11 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-1.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0363, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
10 gae_duplicate tensor(-0.1973, dtype=torch.float64) tensor(0.9852, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1656, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
9 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(-0.5621, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4747, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
8 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(2.0631, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8424, dtype=torch.float64) delta_t tensor(0.0306, dtype=torch.float64)
7 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(-0.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5510, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
6 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-0.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6465, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
5 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(-0.1906, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0108, dtype=torch.float64) delta_t tensor(0.0340, dtype=torch.float64)
4 gae_duplicate tensor(-0.1760, dtype=torch.float64) tensor(-0.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0991, dtype=torch.float64) delta_t tensor(0.0319, dtype=torch.float64)
3 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(-0.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3551, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
2 gae_duplicate tensor(-0.2250, dtype=torch.float64) tensor(1.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:145.39527893066406
value loss:2.520768642425537
entropies:345.8482666015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.883983135223389 seconds
19 rew tensor(1.1085, dtype=torch.float64) delta_t tensor(-0.0970, dtype=torch.float64)
19 gae_duplicate tensor(-0.2901, dtype=torch.float64) tensor(2.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1345, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
18 gae_duplicate tensor(-0.0267, dtype=torch.float64) tensor(-1.7414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0950, dtype=torch.float64) delta_t tensor(0.0521, dtype=torch.float64)
17 gae_duplicate tensor(-0.0632, dtype=torch.float64) tensor(-1.2647, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9803, dtype=torch.float64) delta_t tensor(-0.0152, dtype=torch.float64)
16 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(0.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9673, dtype=torch.float64) delta_t tensor(0.1101, dtype=torch.float64)
15 gae_duplicate tensor(-0.2787, dtype=torch.float64) tensor(-1.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3532, dtype=torch.float64) delta_t tensor(-0.0646, dtype=torch.float64)
14 gae_duplicate tensor(-0.9602, dtype=torch.float64) tensor(1.7519, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
13 gae_duplicate tensor(-0.0718, dtype=torch.float64) tensor(-0.2289, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3044, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
12 gae_duplicate tensor(-0.1346, dtype=torch.float64) tensor(-3.2077, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5859, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
11 gae_duplicate tensor(-0.0335, dtype=torch.float64) tensor(-3.1865, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2566, dtype=torch.float64) delta_t tensor(-0.0889, dtype=torch.float64)
10 gae_duplicate tensor(-0.3871, dtype=torch.float64) tensor(1.6265, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5606, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
9 gae_duplicate tensor(-0.2483, dtype=torch.float64) tensor(-0.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6153, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
8 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(0.4547, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5203, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
7 gae_duplicate tensor(-0.2332, dtype=torch.float64) tensor(-1.7829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8202, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
6 gae_duplicate tensor(-0.0992, dtype=torch.float64) tensor(-0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3123, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
5 gae_duplicate tensor(-0.0869, dtype=torch.float64) tensor(-1.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1184, dtype=torch.float64) delta_t tensor(-0.0498, dtype=torch.float64)
4 gae_duplicate tensor(-0.1418, dtype=torch.float64) tensor(0.7692, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8787, dtype=torch.float64) delta_t tensor(0.1094, dtype=torch.float64)
3 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-2.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2260, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
2 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(1.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:431.0299377441406
value loss:6.866846084594727
entropies:346.2301330566406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.856533050537109 seconds
19 rew tensor(1.1600, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
19 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(0.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1341, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
18 gae_duplicate tensor(-0.0386, dtype=torch.float64) tensor(-1.8157, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0701, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
17 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-1.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9424, dtype=torch.float64) delta_t tensor(0.0158, dtype=torch.float64)
16 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-0.3217, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9302, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
15 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-2.7458, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6234, dtype=torch.float64) delta_t tensor(-0.1252, dtype=torch.float64)
14 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(2.2730, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(0.0518, dtype=torch.float64)
13 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-0.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4592, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
12 gae_duplicate tensor(-0.1995, dtype=torch.float64) tensor(1.1771, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1241, dtype=torch.float64) delta_t tensor(0.0187, dtype=torch.float64)
11 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(-0.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2036, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
10 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(-0.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0860, dtype=torch.float64) delta_t tensor(0.0085, dtype=torch.float64)
9 gae_duplicate tensor(-0.3233, dtype=torch.float64) tensor(-0.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3693, dtype=torch.float64) delta_t tensor(-0.0860, dtype=torch.float64)
8 gae_duplicate tensor(-0.1533, dtype=torch.float64) tensor(1.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9227, dtype=torch.float64) delta_t tensor(0.1961, dtype=torch.float64)
7 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(-3.1720, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6135, dtype=torch.float64) delta_t tensor(0.1600, dtype=torch.float64)
6 gae_duplicate tensor(0.0529, dtype=torch.float64) tensor(-3.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5724, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
5 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(0.0810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0141, dtype=torch.float64) delta_t tensor(0.0494, dtype=torch.float64)
4 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(-1.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9854, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
3 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(-0.5639, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2914, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
2 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(0.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:458.7137451171875
value loss:5.4624738693237305
entropies:346.3287353515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.846073150634766 seconds
19 rew tensor(1.1713, dtype=torch.float64) delta_t tensor(-0.0896, dtype=torch.float64)
19 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(1.7112, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
18 gae_duplicate tensor(-0.0020, dtype=torch.float64) tensor(-1.4501, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7801, dtype=torch.float64) delta_t tensor(-0.2289, dtype=torch.float64)
17 gae_duplicate tensor(-1.4290, dtype=torch.float64) tensor(3.7245, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
16 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(0.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9167, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
15 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-0.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1776, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
14 gae_duplicate tensor(-0.7588, dtype=torch.float64) tensor(2.5677, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5081, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
13 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-2.4825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
12 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-2.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5210, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
11 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-1.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2171, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
10 gae_duplicate tensor(-0.1787, dtype=torch.float64) tensor(0.8706, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(-0.0832, dtype=torch.float64)
9 gae_duplicate tensor(-0.2461, dtype=torch.float64) tensor(1.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4729, dtype=torch.float64) delta_t tensor(0.0042, dtype=torch.float64)
8 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1367, dtype=torch.float64) delta_t tensor(0.0780, dtype=torch.float64)
7 gae_duplicate tensor(-0.1219, dtype=torch.float64) tensor(-1.3194, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6006, dtype=torch.float64) delta_t tensor(-0.0176, dtype=torch.float64)
6 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6983, dtype=torch.float64) delta_t tensor(0.1463, dtype=torch.float64)
5 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-2.4856, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2405, dtype=torch.float64) delta_t tensor(-0.0938, dtype=torch.float64)
4 gae_duplicate tensor(-0.2164, dtype=torch.float64) tensor(1.3382, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3913, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
3 gae_duplicate tensor(-0.0140, dtype=torch.float64) tensor(-2.2868, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5724, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
2 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(1.2273, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:12.023625373840332
value loss:7.899763107299805
entropies:346.36492919921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3908.3489)
ToM Target loss= tensor(4016.0059)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.864837169647217 seconds
19 rew tensor(1.1973, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
19 gae_duplicate tensor(-0.1260, dtype=torch.float64) tensor(1.8438, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1846, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
18 gae_duplicate tensor(-0.0288, dtype=torch.float64) tensor(-1.1652, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1343, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
17 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-0.9772, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7998, dtype=torch.float64) delta_t tensor(-0.2338, dtype=torch.float64)
16 gae_duplicate tensor(-1.3835, dtype=torch.float64) tensor(3.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7153, dtype=torch.float64) delta_t tensor(-0.2795, dtype=torch.float64)
15 gae_duplicate tensor(-1.2795, dtype=torch.float64) tensor(5.2771, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8413, dtype=torch.float64) delta_t tensor(0.0207, dtype=torch.float64)
14 gae_duplicate tensor(-0.1850, dtype=torch.float64) tensor(0.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2640, dtype=torch.float64) delta_t tensor(-0.1611, dtype=torch.float64)
13 gae_duplicate tensor(-1.1954, dtype=torch.float64) tensor(3.1551, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3870, dtype=torch.float64) delta_t tensor(-0.5040, dtype=torch.float64)
12 gae_duplicate tensor(-3.4560, dtype=torch.float64) tensor(11.7231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4164, dtype=torch.float64) delta_t tensor(-0.6288, dtype=torch.float64)
11 gae_duplicate tensor(-4.3780, dtype=torch.float64) tensor(14.6953, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0507, dtype=torch.float64) delta_t tensor(0.2191, dtype=torch.float64)
10 gae_duplicate tensor(-0.1099, dtype=torch.float64) tensor(-3.3856, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
9 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-3.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6643, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
8 gae_duplicate tensor(-0.2244, dtype=torch.float64) tensor(-0.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7658, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
7 gae_duplicate tensor(-0.0480, dtype=torch.float64) tensor(-7.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7920, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
6 gae_duplicate tensor(0.0495, dtype=torch.float64) tensor(-3.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5455, dtype=torch.float64) delta_t tensor(0.1999, dtype=torch.float64)
5 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-4.0039, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0353, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
4 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(-0.8807, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2634, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
3 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(-1.8301, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3669, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
2 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-0.4290, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-865.3533935546875
value loss:61.963890075683594
entropies:346.4556579589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.987145185470581 seconds
19 rew tensor(1.2360, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
19 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(0.4182, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2357, dtype=torch.float64) delta_t tensor(0.2010, dtype=torch.float64)
18 gae_duplicate tensor(0.1360, dtype=torch.float64) tensor(-3.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0439, dtype=torch.float64) delta_t tensor(0.0600, dtype=torch.float64)
17 gae_duplicate tensor(-0.0125, dtype=torch.float64) tensor(-1.4352, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9671, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
16 gae_duplicate tensor(-0.0600, dtype=torch.float64) tensor(-0.5500, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9036, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
15 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(0.4521, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5368, dtype=torch.float64) delta_t tensor(-0.1011, dtype=torch.float64)
14 gae_duplicate tensor(-1.2866, dtype=torch.float64) tensor(1.6927, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6880, dtype=torch.float64) delta_t tensor(0.1418, dtype=torch.float64)
13 gae_duplicate tensor(0.0340, dtype=torch.float64) tensor(-2.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(0.0035, dtype=torch.float64)
12 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.3174, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2545, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
11 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(0.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0268, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
10 gae_duplicate tensor(-0.1309, dtype=torch.float64) tensor(-0.5324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1903, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
9 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(-0.3378, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5115, dtype=torch.float64) delta_t tensor(-0.1110, dtype=torch.float64)
8 gae_duplicate tensor(-0.3198, dtype=torch.float64) tensor(1.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1977, dtype=torch.float64) delta_t tensor(0.2300, dtype=torch.float64)
7 gae_duplicate tensor(-0.2153, dtype=torch.float64) tensor(-4.3007, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6135, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
6 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-1.6154, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7478, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
5 gae_duplicate tensor(-0.2130, dtype=torch.float64) tensor(-1.6737, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2649, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
4 gae_duplicate tensor(-0.1596, dtype=torch.float64) tensor(-1.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5170, dtype=torch.float64) delta_t tensor(-0.0543, dtype=torch.float64)
3 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(0.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5837, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
2 gae_duplicate tensor(-0.2906, dtype=torch.float64) tensor(-0.7076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:636.933837890625
value loss:8.854691505432129
entropies:346.3568420410156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.293868780136108 seconds
19 rew tensor(1.2355, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
19 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(0.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1970, dtype=torch.float64) delta_t tensor(0.1575, dtype=torch.float64)
18 gae_duplicate tensor(0.0401, dtype=torch.float64) tensor(-3.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8236, dtype=torch.float64) delta_t tensor(-0.1862, dtype=torch.float64)
17 gae_duplicate tensor(-1.3022, dtype=torch.float64) tensor(3.9104, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0054, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
16 gae_duplicate tensor(-0.0659, dtype=torch.float64) tensor(-1.0869, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9417, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
15 gae_duplicate tensor(-0.1686, dtype=torch.float64) tensor(0.0723, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4841, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
14 gae_duplicate tensor(-1.5348, dtype=torch.float64) tensor(3.1776, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.7403, dtype=torch.float64) delta_t tensor(-1.1277, dtype=torch.float64)
13 gae_duplicate tensor(-3.9930, dtype=torch.float64) tensor(22.4461, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3798, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
12 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(-1.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5222, dtype=torch.float64) delta_t tensor(0.2355, dtype=torch.float64)
11 gae_duplicate tensor(0.0425, dtype=torch.float64) tensor(-4.7644, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0614, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
10 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-2.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3425, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
9 gae_duplicate tensor(-0.0996, dtype=torch.float64) tensor(-0.3163, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5493, dtype=torch.float64) delta_t tensor(-0.1752, dtype=torch.float64)
8 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(3.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4487, dtype=torch.float64) delta_t tensor(0.0576, dtype=torch.float64)
7 gae_duplicate tensor(-0.1155, dtype=torch.float64) tensor(-0.9639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6259, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
6 gae_duplicate tensor(-0.0183, dtype=torch.float64) tensor(-1.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4436, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
5 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-0.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1673, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
4 gae_duplicate tensor(-0.1159, dtype=torch.float64) tensor(-0.2600, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8054, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
3 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-0.2710, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1642, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
2 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(3.6330, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1087.3409423828125
value loss:44.983863830566406
entropies:346.5342102050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9357099533081055 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(-0.0154, dtype=torch.float64)
19 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(0.3900, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1843, dtype=torch.float64) delta_t tensor(0.1489, dtype=torch.float64)
18 gae_duplicate tensor(0.0488, dtype=torch.float64) tensor(-2.6249, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(-0.1776, dtype=torch.float64)
17 gae_duplicate tensor(-1.2627, dtype=torch.float64) tensor(2.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9804, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
16 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(-0.9801, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8655, dtype=torch.float64) delta_t tensor(0.0718, dtype=torch.float64)
15 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-1.7609, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5723, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
14 gae_duplicate tensor(-0.0382, dtype=torch.float64) tensor(-3.4882, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6135, dtype=torch.float64) delta_t tensor(0.1820, dtype=torch.float64)
13 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-3.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2520, dtype=torch.float64) delta_t tensor(0.0803, dtype=torch.float64)
12 gae_duplicate tensor(-0.1672, dtype=torch.float64) tensor(-1.5537, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6001, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
11 gae_duplicate tensor(0.0251, dtype=torch.float64) tensor(-5.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1925, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
10 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-1.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5982, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
9 gae_duplicate tensor(0.0007, dtype=torch.float64) tensor(-1.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6769, dtype=torch.float64) delta_t tensor(-0.1460, dtype=torch.float64)
8 gae_duplicate tensor(-0.6815, dtype=torch.float64) tensor(3.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4208, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
7 gae_duplicate tensor(-0.0800, dtype=torch.float64) tensor(-0.7486, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8695, dtype=torch.float64) delta_t tensor(0.0723, dtype=torch.float64)
6 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(-1.4043, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1851, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
5 gae_duplicate tensor(-0.1033, dtype=torch.float64) tensor(-0.9660, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2453, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
4 gae_duplicate tensor(-0.1038, dtype=torch.float64) tensor(-0.4110, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5838, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
3 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-2.2347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0091, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
2 gae_duplicate tensor(-0.4854, dtype=torch.float64) tensor(1.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:978.0480346679688
value loss:8.832743644714355
entropies:346.8527526855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.847366809844971 seconds
19 rew tensor(1.1593, dtype=torch.float64) delta_t tensor(-0.0196, dtype=torch.float64)
19 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(0.3716, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1339, dtype=torch.float64) delta_t tensor(0.1683, dtype=torch.float64)
18 gae_duplicate tensor(0.0395, dtype=torch.float64) tensor(-3.3126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7909, dtype=torch.float64) delta_t tensor(-0.1338, dtype=torch.float64)
17 gae_duplicate tensor(-1.2684, dtype=torch.float64) tensor(1.9902, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0071, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
16 gae_duplicate tensor(-0.0190, dtype=torch.float64) tensor(-0.9189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
15 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(-0.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7778, dtype=torch.float64) delta_t tensor(0.1518, dtype=torch.float64)
14 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-2.9587, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6492, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
13 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-2.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1115, dtype=torch.float64) delta_t tensor(-0.0404, dtype=torch.float64)
12 gae_duplicate tensor(-0.7171, dtype=torch.float64) tensor(0.9963, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2235, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
11 gae_duplicate tensor(-0.9610, dtype=torch.float64) tensor(1.3198, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
10 gae_duplicate tensor(-0.3753, dtype=torch.float64) tensor(0.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3168, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
9 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(0.1708, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4732, dtype=torch.float64) delta_t tensor(-0.0211, dtype=torch.float64)
8 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(0.5360, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3875, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
7 gae_duplicate tensor(-0.1232, dtype=torch.float64) tensor(-0.1630, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6759, dtype=torch.float64) delta_t tensor(-0.0198, dtype=torch.float64)
6 gae_duplicate tensor(-0.1477, dtype=torch.float64) tensor(0.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3190, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
5 gae_duplicate tensor(-0.2418, dtype=torch.float64) tensor(2.3859, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2420, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
4 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(0.6196, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6303, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
3 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-0.3838, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1152, dtype=torch.float64) delta_t tensor(-0.1024, dtype=torch.float64)
2 gae_duplicate tensor(-0.3190, dtype=torch.float64) tensor(2.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-147.95584106445312
value loss:7.865420341491699
entropies:347.1127014160156
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3888.5811)
ToM Target loss= tensor(4006.9707)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0932042598724365 seconds
19 rew tensor(1.1594, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
19 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-0.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1594, dtype=torch.float64) delta_t tensor(0.2175, dtype=torch.float64)
18 gae_duplicate tensor(0.0715, dtype=torch.float64) tensor(-4.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9687, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
17 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-1.5679, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8519, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
16 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.9479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8543, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
15 gae_duplicate tensor(-0.2460, dtype=torch.float64) tensor(0.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5840, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
14 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(0.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7908, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
13 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-2.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1763, dtype=torch.float64) delta_t tensor(-0.1000, dtype=torch.float64)
12 gae_duplicate tensor(-0.2677, dtype=torch.float64) tensor(1.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5476, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
11 gae_duplicate tensor(-0.1532, dtype=torch.float64) tensor(-0.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1169, dtype=torch.float64) delta_t tensor(-0.0950, dtype=torch.float64)
10 gae_duplicate tensor(-0.3560, dtype=torch.float64) tensor(1.6619, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3178, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
9 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(0.1723, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6414, dtype=torch.float64) delta_t tensor(-0.0973, dtype=torch.float64)
8 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(1.8002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2542, dtype=torch.float64) delta_t tensor(0.0625, dtype=torch.float64)
7 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(-1.1134, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8052, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
6 gae_duplicate tensor(-0.1264, dtype=torch.float64) tensor(-1.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2141, dtype=torch.float64) delta_t tensor(-0.0965, dtype=torch.float64)
5 gae_duplicate tensor(-0.3237, dtype=torch.float64) tensor(1.6563, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2702, dtype=torch.float64) delta_t tensor(-0.0223, dtype=torch.float64)
4 gae_duplicate tensor(-0.1975, dtype=torch.float64) tensor(0.5276, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6012, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
3 gae_duplicate tensor(-0.2768, dtype=torch.float64) tensor(0.4603, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0870, dtype=torch.float64) delta_t tensor(-0.0449, dtype=torch.float64)
2 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(1.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:22.554916381835938
value loss:3.5848124027252197
entropies:347.3259582519531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.979838848114014 seconds
19 rew tensor(1.2105, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
19 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-0.2807, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1472, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
18 gae_duplicate tensor(0.0291, dtype=torch.float64) tensor(-1.8984, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0579, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
17 gae_duplicate tensor(-0.0198, dtype=torch.float64) tensor(-1.0016, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0828, dtype=torch.float64) delta_t tensor(0.0767, dtype=torch.float64)
16 gae_duplicate tensor(0.0237, dtype=torch.float64) tensor(-1.6044, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9424, dtype=torch.float64) delta_t tensor(0.0070, dtype=torch.float64)
15 gae_duplicate tensor(-0.2664, dtype=torch.float64) tensor(-0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2330, dtype=torch.float64) delta_t tensor(-0.2087, dtype=torch.float64)
14 gae_duplicate tensor(-2.0924, dtype=torch.float64) tensor(2.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1468, dtype=torch.float64) delta_t tensor(-0.2384, dtype=torch.float64)
13 gae_duplicate tensor(-2.3678, dtype=torch.float64) tensor(4.3003, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2374, dtype=torch.float64) delta_t tensor(-0.3134, dtype=torch.float64)
12 gae_duplicate tensor(-2.5013, dtype=torch.float64) tensor(7.7951, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4966, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
11 gae_duplicate tensor(-0.0259, dtype=torch.float64) tensor(-3.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0649, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
10 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-1.9069, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5744, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
9 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(-0.7982, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6798, dtype=torch.float64) delta_t tensor(-0.0866, dtype=torch.float64)
8 gae_duplicate tensor(-0.2818, dtype=torch.float64) tensor(1.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0111, dtype=torch.float64) delta_t tensor(-0.3672, dtype=torch.float64)
7 gae_duplicate tensor(-1.7059, dtype=torch.float64) tensor(6.5606, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9601, dtype=torch.float64) delta_t tensor(-0.1082, dtype=torch.float64)
6 gae_duplicate tensor(-0.3907, dtype=torch.float64) tensor(2.5350, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2110, dtype=torch.float64) delta_t tensor(0.0765, dtype=torch.float64)
5 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-1.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1208, dtype=torch.float64) delta_t tensor(-0.0026, dtype=torch.float64)
4 gae_duplicate tensor(-0.1998, dtype=torch.float64) tensor(-0.1148, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9018, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
3 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-0.0912, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2112, dtype=torch.float64) delta_t tensor(-0.0874, dtype=torch.float64)
2 gae_duplicate tensor(-0.3426, dtype=torch.float64) tensor(1.4031, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-848.2094116210938
value loss:34.12584686279297
entropies:347.51702880859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.02846622467041 seconds
19 rew tensor(1.2098, dtype=torch.float64) delta_t tensor(-0.0037, dtype=torch.float64)
19 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(0.1597, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2099, dtype=torch.float64) delta_t tensor(0.1604, dtype=torch.float64)
18 gae_duplicate tensor(0.0365, dtype=torch.float64) tensor(-2.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(0.1458, dtype=torch.float64)
17 gae_duplicate tensor(0.0657, dtype=torch.float64) tensor(-3.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0945, dtype=torch.float64) delta_t tensor(0.2414, dtype=torch.float64)
16 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-5.5147, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9554, dtype=torch.float64) delta_t tensor(0.2267, dtype=torch.float64)
15 gae_duplicate tensor(-0.3120, dtype=torch.float64) tensor(-4.5334, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1190, dtype=torch.float64) delta_t tensor(-0.2914, dtype=torch.float64)
14 gae_duplicate tensor(-2.3710, dtype=torch.float64) tensor(6.2159, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4817, dtype=torch.float64) delta_t tensor(0.0173, dtype=torch.float64)
13 gae_duplicate tensor(-0.9853, dtype=torch.float64) tensor(0.2655, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3688, dtype=torch.float64) delta_t tensor(0.2147, dtype=torch.float64)
12 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-3.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1746, dtype=torch.float64) delta_t tensor(-0.0891, dtype=torch.float64)
11 gae_duplicate tensor(-0.9428, dtype=torch.float64) tensor(0.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1520, dtype=torch.float64) delta_t tensor(0.2087, dtype=torch.float64)
10 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(-4.3012, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3546, dtype=torch.float64) delta_t tensor(0.0732, dtype=torch.float64)
9 gae_duplicate tensor(-0.1176, dtype=torch.float64) tensor(-1.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4610, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
8 gae_duplicate tensor(-0.0971, dtype=torch.float64) tensor(-0.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4740, dtype=torch.float64) delta_t tensor(-0.4960, dtype=torch.float64)
7 gae_duplicate tensor(-3.1049, dtype=torch.float64) tensor(8.4506, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7789, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
6 gae_duplicate tensor(-0.5169, dtype=torch.float64) tensor(1.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4178, dtype=torch.float64) delta_t tensor(0.0030, dtype=torch.float64)
5 gae_duplicate tensor(-0.2908, dtype=torch.float64) tensor(0.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0346, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
4 gae_duplicate tensor(-0.1927, dtype=torch.float64) tensor(0.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1976, dtype=torch.float64) delta_t tensor(-0.1113, dtype=torch.float64)
3 gae_duplicate tensor(-0.4289, dtype=torch.float64) tensor(1.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3666, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
2 gae_duplicate tensor(-0.2924, dtype=torch.float64) tensor(-0.2354, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:251.63304138183594
value loss:38.014503479003906
entropies:348.01910400390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.731317043304443 seconds
19 rew tensor(1.1725, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
19 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(0.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1852, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
18 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-2.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0574, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
17 gae_duplicate tensor(-0.0754, dtype=torch.float64) tensor(-1.4890, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9694, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
16 gae_duplicate tensor(-0.0731, dtype=torch.float64) tensor(-0.8406, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8920, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
15 gae_duplicate tensor(-0.0650, dtype=torch.float64) tensor(-0.8372, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1723, dtype=torch.float64) delta_t tensor(-0.3675, dtype=torch.float64)
14 gae_duplicate tensor(-1.3229, dtype=torch.float64) tensor(6.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6359, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
13 gae_duplicate tensor(-0.0691, dtype=torch.float64) tensor(-0.7408, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2422, dtype=torch.float64) delta_t tensor(0.0448, dtype=torch.float64)
12 gae_duplicate tensor(-0.1267, dtype=torch.float64) tensor(-1.1614, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5340, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
11 gae_duplicate tensor(-0.0759, dtype=torch.float64) tensor(-1.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1037, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
10 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(0.2805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
9 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-1.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6773, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
8 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(1.2387, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4744, dtype=torch.float64) delta_t tensor(0.0339, dtype=torch.float64)
7 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-0.5972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7414, dtype=torch.float64) delta_t tensor(-0.0057, dtype=torch.float64)
6 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(0.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3678, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
5 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-0.2812, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
4 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-1.1062, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9215, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
3 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(0.2843, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2664, dtype=torch.float64) delta_t tensor(0.0731, dtype=torch.float64)
2 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-1.2770, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:152.4068603515625
value loss:5.740708351135254
entropies:348.3518981933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.476953029632568 seconds
19 rew tensor(1.1201, dtype=torch.float64) delta_t tensor(-0.0922, dtype=torch.float64)
19 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(1.8669, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1202, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
18 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-0.6198, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1203, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
17 gae_duplicate tensor(-0.0441, dtype=torch.float64) tensor(-0.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0559, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
16 gae_duplicate tensor(-0.0515, dtype=torch.float64) tensor(-1.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0048, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
15 gae_duplicate tensor(-0.0326, dtype=torch.float64) tensor(-3.2172, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
14 gae_duplicate tensor(-0.8328, dtype=torch.float64) tensor(-2.8374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6611, dtype=torch.float64) delta_t tensor(0.2121, dtype=torch.float64)
13 gae_duplicate tensor(-0.0107, dtype=torch.float64) tensor(-4.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(0.1875, dtype=torch.float64)
12 gae_duplicate tensor(-0.0393, dtype=torch.float64) tensor(-3.9630, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5465, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
11 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-3.9810, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1657, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
10 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(0.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3793, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
9 gae_duplicate tensor(-0.1292, dtype=torch.float64) tensor(-1.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5873, dtype=torch.float64) delta_t tensor(-0.1051, dtype=torch.float64)
8 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(1.8979, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.8547, dtype=torch.float64) delta_t tensor(-0.3554, dtype=torch.float64)
7 gae_duplicate tensor(-2.9180, dtype=torch.float64) tensor(7.9836, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8035, dtype=torch.float64) delta_t tensor(-0.0469, dtype=torch.float64)
6 gae_duplicate tensor(-0.4882, dtype=torch.float64) tensor(1.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6223, dtype=torch.float64) delta_t tensor(0.1497, dtype=torch.float64)
5 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(-2.6381, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2917, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
4 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-2.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5694, dtype=torch.float64) delta_t tensor(-0.0601, dtype=torch.float64)
3 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(0.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6364, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
2 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-2.1241, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:689.5595703125
value loss:22.42818832397461
entropies:348.8263244628906
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3884.2209)
ToM Target loss= tensor(4016.6284)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.227028846740723 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
19 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(2.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2102, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
18 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-0.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8927, dtype=torch.float64) delta_t tensor(-0.1905, dtype=torch.float64)
17 gae_duplicate tensor(-1.2964, dtype=torch.float64) tensor(3.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0449, dtype=torch.float64) delta_t tensor(-0.0171, dtype=torch.float64)
16 gae_duplicate tensor(-0.1718, dtype=torch.float64) tensor(0.6187, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9425, dtype=torch.float64) delta_t tensor(0.1765, dtype=torch.float64)
15 gae_duplicate tensor(-0.1492, dtype=torch.float64) tensor(-3.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0275, dtype=torch.float64) delta_t tensor(-0.4418, dtype=torch.float64)
14 gae_duplicate tensor(-1.2400, dtype=torch.float64) tensor(8.5619, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4954, dtype=torch.float64) delta_t tensor(0.1920, dtype=torch.float64)
13 gae_duplicate tensor(-0.0707, dtype=torch.float64) tensor(-2.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4078, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
12 gae_duplicate tensor(-0.1712, dtype=torch.float64) tensor(-2.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4435, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
11 gae_duplicate tensor(-0.2350, dtype=torch.float64) tensor(0.4848, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(-0.1008, dtype=torch.float64)
10 gae_duplicate tensor(-0.2210, dtype=torch.float64) tensor(1.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3295, dtype=torch.float64) delta_t tensor(0.0700, dtype=torch.float64)
9 gae_duplicate tensor(-0.0047, dtype=torch.float64) tensor(-1.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5743, dtype=torch.float64) delta_t tensor(-0.0627, dtype=torch.float64)
8 gae_duplicate tensor(-0.2125, dtype=torch.float64) tensor(1.0083, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3306, dtype=torch.float64) delta_t tensor(0.0235, dtype=torch.float64)
7 gae_duplicate tensor(-0.2565, dtype=torch.float64) tensor(-0.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7911, dtype=torch.float64) delta_t tensor(-0.1185, dtype=torch.float64)
6 gae_duplicate tensor(-0.2957, dtype=torch.float64) tensor(2.1304, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5733, dtype=torch.float64) delta_t tensor(0.2127, dtype=torch.float64)
5 gae_duplicate tensor(-0.1017, dtype=torch.float64) tensor(-4.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3186, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
4 gae_duplicate tensor(-0.0621, dtype=torch.float64) tensor(-1.7792, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5477, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
3 gae_duplicate tensor(-0.3195, dtype=torch.float64) tensor(1.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6630, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
2 gae_duplicate tensor(-0.0852, dtype=torch.float64) tensor(-2.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-113.77777099609375
value loss:13.034917831420898
entropies:349.19403076171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7624289989471436 seconds
19 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(-0.0898, dtype=torch.float64)
19 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(1.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
18 gae_duplicate tensor(-0.0513, dtype=torch.float64) tensor(-0.6191, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
17 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(1.1884, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0061, dtype=torch.float64) delta_t tensor(-0.0307, dtype=torch.float64)
16 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(0.8237, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
15 gae_duplicate tensor(-0.0957, dtype=torch.float64) tensor(0.1013, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7497, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
14 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(-0.5204, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8012, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
13 gae_duplicate tensor(-0.1425, dtype=torch.float64) tensor(-0.0851, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(0.0492, dtype=torch.float64)
12 gae_duplicate tensor(-0.1027, dtype=torch.float64) tensor(-0.7979, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2346, dtype=torch.float64) delta_t tensor(-0.2495, dtype=torch.float64)
11 gae_duplicate tensor(-1.7777, dtype=torch.float64) tensor(4.2286, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5450, dtype=torch.float64) delta_t tensor(-0.3962, dtype=torch.float64)
10 gae_duplicate tensor(-2.3153, dtype=torch.float64) tensor(9.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3346, dtype=torch.float64) delta_t tensor(-0.6718, dtype=torch.float64)
9 gae_duplicate tensor(-4.5326, dtype=torch.float64) tensor(15.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9443, dtype=torch.float64) delta_t tensor(-0.2103, dtype=torch.float64)
8 gae_duplicate tensor(-1.2360, dtype=torch.float64) tensor(5.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6856, dtype=torch.float64) delta_t tensor(-0.3094, dtype=torch.float64)
7 gae_duplicate tensor(-1.8489, dtype=torch.float64) tensor(6.0383, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8953, dtype=torch.float64) delta_t tensor(0.0467, dtype=torch.float64)
6 gae_duplicate tensor(-0.1950, dtype=torch.float64) tensor(-0.0880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1371, dtype=torch.float64) delta_t tensor(0.0716, dtype=torch.float64)
5 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(-1.0634, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2671, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
4 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-1.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7311, dtype=torch.float64) delta_t tensor(-0.0443, dtype=torch.float64)
3 gae_duplicate tensor(-0.1771, dtype=torch.float64) tensor(0.5675, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0775, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
2 gae_duplicate tensor(-0.0413, dtype=torch.float64) tensor(-2.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2069.57568359375
value loss:53.97886657714844
entropies:349.7837219238281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.582441091537476 seconds
19 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(-0.1237, dtype=torch.float64)
19 gae_duplicate tensor(-0.2092, dtype=torch.float64) tensor(2.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(0.0369, dtype=torch.float64)
18 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-0.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(-0.0727, dtype=torch.float64)
17 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(1.2228, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(-0.0961, dtype=torch.float64)
16 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(1.8696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8662, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
15 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(2.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6477, dtype=torch.float64) delta_t tensor(-0.0125, dtype=torch.float64)
14 gae_duplicate tensor(-0.2545, dtype=torch.float64) tensor(0.3597, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
13 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(-1.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2401, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
12 gae_duplicate tensor(-0.1080, dtype=torch.float64) tensor(-0.6738, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3709, dtype=torch.float64) delta_t tensor(-0.0033, dtype=torch.float64)
11 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(0.1007, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1042, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
10 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(0.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.0781, dtype=torch.float64)
9 gae_duplicate tensor(-0.2193, dtype=torch.float64) tensor(-1.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6539, dtype=torch.float64) delta_t tensor(-0.0333, dtype=torch.float64)
8 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(0.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5934, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
7 gae_duplicate tensor(-0.1915, dtype=torch.float64) tensor(-0.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(0.1126, dtype=torch.float64)
6 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-2.4208, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4638, dtype=torch.float64) delta_t tensor(-0.0504, dtype=torch.float64)
5 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(0.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0941, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
4 gae_duplicate tensor(-0.0833, dtype=torch.float64) tensor(-0.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9517, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-0.1497, dtype=torch.float64) tensor(0.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2507, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
2 gae_duplicate tensor(-0.2518, dtype=torch.float64) tensor(1.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-397.15625
value loss:3.3956356048583984
entropies:350.0474548339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0910961627960205 seconds
19 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(-0.1404, dtype=torch.float64)
19 gae_duplicate tensor(-0.1851, dtype=torch.float64) tensor(2.8898, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1469, dtype=torch.float64) delta_t tensor(-0.0096, dtype=torch.float64)
18 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(0.4302, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1088, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
17 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(0.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9306, dtype=torch.float64) delta_t tensor(-0.1117, dtype=torch.float64)
16 gae_duplicate tensor(-0.1878, dtype=torch.float64) tensor(2.2485, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9688, dtype=torch.float64) delta_t tensor(-0.0847, dtype=torch.float64)
15 gae_duplicate tensor(-0.2030, dtype=torch.float64) tensor(1.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7266, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
14 gae_duplicate tensor(-0.2316, dtype=torch.float64) tensor(1.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8540, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
13 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-1.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
12 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(1.2342, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0854, dtype=torch.float64) delta_t tensor(-0.3581, dtype=torch.float64)
11 gae_duplicate tensor(-2.1171, dtype=torch.float64) tensor(7.8370, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7979, dtype=torch.float64) delta_t tensor(-0.5230, dtype=torch.float64)
10 gae_duplicate tensor(-3.5782, dtype=torch.float64) tensor(11.8932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0220, dtype=torch.float64) delta_t tensor(-0.2719, dtype=torch.float64)
9 gae_duplicate tensor(-2.0140, dtype=torch.float64) tensor(5.7694, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5259, dtype=torch.float64) delta_t tensor(0.0733, dtype=torch.float64)
8 gae_duplicate tensor(-0.1091, dtype=torch.float64) tensor(-0.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2570, dtype=torch.float64) delta_t tensor(-0.2977, dtype=torch.float64)
7 gae_duplicate tensor(-1.8969, dtype=torch.float64) tensor(6.3073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7571, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
6 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(-1.8580, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5183, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
5 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-1.5472, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
4 gae_duplicate tensor(-0.1646, dtype=torch.float64) tensor(-1.2567, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1910, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
3 gae_duplicate tensor(-0.2768, dtype=torch.float64) tensor(-1.3627, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3820, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
2 gae_duplicate tensor(-0.2375, dtype=torch.float64) tensor(-2.0803, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1851.5546875
value loss:41.457462310791016
entropies:350.21295166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.4309399127960205 seconds
19 rew tensor(1.1974, dtype=torch.float64) delta_t tensor(-0.1255, dtype=torch.float64)
19 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(2.5230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1202, dtype=torch.float64) delta_t tensor(0.0237, dtype=torch.float64)
18 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-0.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9553, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
17 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(1.7772, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9681, dtype=torch.float64) delta_t tensor(-0.1020, dtype=torch.float64)
16 gae_duplicate tensor(-0.2394, dtype=torch.float64) tensor(2.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8154, dtype=torch.float64) delta_t tensor(-0.1371, dtype=torch.float64)
15 gae_duplicate tensor(-0.3201, dtype=torch.float64) tensor(2.8524, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8652, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
14 gae_duplicate tensor(-0.2812, dtype=torch.float64) tensor(-4.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(-0.2626, dtype=torch.float64)
13 gae_duplicate tensor(-1.3465, dtype=torch.float64) tensor(5.0663, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2800, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
12 gae_duplicate tensor(-0.2488, dtype=torch.float64) tensor(-1.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4191, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
11 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(-0.3612, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0504, dtype=torch.float64) delta_t tensor(0.0998, dtype=torch.float64)
10 gae_duplicate tensor(-0.0456, dtype=torch.float64) tensor(-2.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3181, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
9 gae_duplicate tensor(-0.0982, dtype=torch.float64) tensor(-1.2707, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4990, dtype=torch.float64) delta_t tensor(-0.1205, dtype=torch.float64)
8 gae_duplicate tensor(-0.3061, dtype=torch.float64) tensor(2.2534, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1872, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
7 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(1.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6140, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
6 gae_duplicate tensor(-0.1095, dtype=torch.float64) tensor(-2.0136, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7223, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
5 gae_duplicate tensor(-0.0161, dtype=torch.float64) tensor(-2.8059, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2669, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
4 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-0.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4685, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
3 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-1.7436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6113, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
2 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(0.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-155.87045288085938
value loss:8.65420150756836
entropies:350.1229248046875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3908.5466)
ToM Target loss= tensor(4020.3035)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.3322601318359375 seconds
19 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(-0.1271, dtype=torch.float64)
19 gae_duplicate tensor(-0.2098, dtype=torch.float64) tensor(2.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
18 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(-0.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(-0.0804, dtype=torch.float64)
17 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(1.5705, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(-0.0389, dtype=torch.float64)
16 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(0.9736, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8771, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
15 gae_duplicate tensor(-0.2219, dtype=torch.float64) tensor(0.5953, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3859, dtype=torch.float64) delta_t tensor(-0.1066, dtype=torch.float64)
14 gae_duplicate tensor(-0.5387, dtype=torch.float64) tensor(2.2799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5847, dtype=torch.float64) delta_t tensor(-0.0571, dtype=torch.float64)
13 gae_duplicate tensor(-0.1770, dtype=torch.float64) tensor(1.4349, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2551, dtype=torch.float64) delta_t tensor(0.0142, dtype=torch.float64)
12 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(-0.3721, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
11 gae_duplicate tensor(-0.2353, dtype=torch.float64) tensor(-0.3434, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1917, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
10 gae_duplicate tensor(-0.1560, dtype=torch.float64) tensor(0.6838, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4562, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
9 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-0.5069, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5477, dtype=torch.float64) delta_t tensor(-0.0292, dtype=torch.float64)
8 gae_duplicate tensor(-0.1356, dtype=torch.float64) tensor(0.6460, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4750, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
7 gae_duplicate tensor(-0.2298, dtype=torch.float64) tensor(0.4426, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7533, dtype=torch.float64) delta_t tensor(0.0069, dtype=torch.float64)
6 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(0.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2905, dtype=torch.float64) delta_t tensor(0.0245, dtype=torch.float64)
5 gae_duplicate tensor(-0.2285, dtype=torch.float64) tensor(-0.5042, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1680, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
4 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-0.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7279, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
3 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-0.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1889, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
2 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(0.5360, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-555.9305419921875
value loss:3.06588077545166
entropies:349.8543395996094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.816271066665649 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(-0.1057, dtype=torch.float64)
19 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(2.1673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1709, dtype=torch.float64) delta_t tensor(0.0128, dtype=torch.float64)
18 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(-0.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1072, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
17 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(0.5633, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0435, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
16 gae_duplicate tensor(-0.0818, dtype=torch.float64) tensor(-0.2237, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7765, dtype=torch.float64) delta_t tensor(-0.1170, dtype=torch.float64)
15 gae_duplicate tensor(-1.4304, dtype=torch.float64) tensor(2.9785, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6869, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
14 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(0.1676, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1695, dtype=torch.float64) delta_t tensor(-0.3285, dtype=torch.float64)
13 gae_duplicate tensor(-2.4615, dtype=torch.float64) tensor(6.9317, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0902, dtype=torch.float64) delta_t tensor(-0.1390, dtype=torch.float64)
12 gae_duplicate tensor(-1.0242, dtype=torch.float64) tensor(3.4275, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4074, dtype=torch.float64) delta_t tensor(0.1091, dtype=torch.float64)
11 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(-1.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0412, dtype=torch.float64) delta_t tensor(0.1184, dtype=torch.float64)
10 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-2.7163, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4455, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
9 gae_duplicate tensor(0.0024, dtype=torch.float64) tensor(-2.8074, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(-0.0376, dtype=torch.float64)
8 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(0.4656, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7665, dtype=torch.float64) delta_t tensor(-0.1523, dtype=torch.float64)
7 gae_duplicate tensor(-1.2564, dtype=torch.float64) tensor(3.6199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8028, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
6 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-1.4397, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3172, dtype=torch.float64) delta_t tensor(0.0946, dtype=torch.float64)
5 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(-1.8446, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1408, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
4 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-1.2941, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
3 gae_duplicate tensor(-0.1321, dtype=torch.float64) tensor(-0.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1663, dtype=torch.float64) delta_t tensor(-0.0151, dtype=torch.float64)
2 gae_duplicate tensor(-0.4114, dtype=torch.float64) tensor(0.6237, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-554.4193115234375
value loss:21.319786071777344
entropies:349.5284118652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.948959589004517 seconds
19 rew tensor(1.1463, dtype=torch.float64) delta_t tensor(-0.1242, dtype=torch.float64)
19 gae_duplicate tensor(-0.1530, dtype=torch.float64) tensor(2.3917, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1335, dtype=torch.float64) delta_t tensor(0.1197, dtype=torch.float64)
18 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-2.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.0208, dtype=torch.float64)
17 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-0.5394, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8654, dtype=torch.float64) delta_t tensor(-0.1282, dtype=torch.float64)
16 gae_duplicate tensor(-0.2013, dtype=torch.float64) tensor(2.3480, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8660, dtype=torch.float64) delta_t tensor(-0.0130, dtype=torch.float64)
15 gae_duplicate tensor(-0.3439, dtype=torch.float64) tensor(0.3938, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7256, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
14 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-0.0058, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
13 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(-0.0379, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2024, dtype=torch.float64) delta_t tensor(-0.0068, dtype=torch.float64)
12 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(0.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5604, dtype=torch.float64) delta_t tensor(-0.0593, dtype=torch.float64)
11 gae_duplicate tensor(-0.1919, dtype=torch.float64) tensor(1.1069, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0395, dtype=torch.float64) delta_t tensor(0.0111, dtype=torch.float64)
10 gae_duplicate tensor(-0.3988, dtype=torch.float64) tensor(0.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2537, dtype=torch.float64) delta_t tensor(0.0221, dtype=torch.float64)
9 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-0.4471, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5245, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
8 gae_duplicate tensor(-0.2430, dtype=torch.float64) tensor(0.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5368, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
7 gae_duplicate tensor(-0.2429, dtype=torch.float64) tensor(1.1393, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7407, dtype=torch.float64) delta_t tensor(0.0619, dtype=torch.float64)
6 gae_duplicate tensor(-0.1009, dtype=torch.float64) tensor(-1.1104, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3162, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
5 gae_duplicate tensor(0.0575, dtype=torch.float64) tensor(-2.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0910, dtype=torch.float64) delta_t tensor(0.0430, dtype=torch.float64)
4 gae_duplicate tensor(-0.1114, dtype=torch.float64) tensor(-1.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8055, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
3 gae_duplicate tensor(0.0004, dtype=torch.float64) tensor(-1.4978, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2788, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
2 gae_duplicate tensor(-0.1048, dtype=torch.float64) tensor(-1.3223, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.28964614868164
value loss:2.8612260818481445
entropies:348.9834289550781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.911404132843018 seconds
19 rew tensor(1.1719, dtype=torch.float64) delta_t tensor(-0.0928, dtype=torch.float64)
19 gae_duplicate tensor(-0.1622, dtype=torch.float64) tensor(1.7879, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1981, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
18 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-1.5146, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1086, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
17 gae_duplicate tensor(-0.0391, dtype=torch.float64) tensor(-1.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
16 gae_duplicate tensor(-0.1007, dtype=torch.float64) tensor(-0.9657, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8788, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
15 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(0.1265, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3966, dtype=torch.float64) delta_t tensor(-0.1688, dtype=torch.float64)
14 gae_duplicate tensor(-0.8177, dtype=torch.float64) tensor(3.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4659, dtype=torch.float64) delta_t tensor(-0.0674, dtype=torch.float64)
13 gae_duplicate tensor(-0.7410, dtype=torch.float64) tensor(1.3782, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3831, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
12 gae_duplicate tensor(-0.1546, dtype=torch.float64) tensor(-1.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3162, dtype=torch.float64) delta_t tensor(0.0334, dtype=torch.float64)
11 gae_duplicate tensor(-0.0232, dtype=torch.float64) tensor(-0.7484, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0267, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
10 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-1.5289, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2788, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
9 gae_duplicate tensor(-0.2754, dtype=torch.float64) tensor(-0.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4880, dtype=torch.float64) delta_t tensor(-0.0083, dtype=torch.float64)
8 gae_duplicate tensor(-0.1234, dtype=torch.float64) tensor(0.1251, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9453, dtype=torch.float64) delta_t tensor(-0.0997, dtype=torch.float64)
7 gae_duplicate tensor(-0.4505, dtype=torch.float64) tensor(1.7570, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5904, dtype=torch.float64) delta_t tensor(0.1632, dtype=torch.float64)
6 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-2.9233, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6460, dtype=torch.float64) delta_t tensor(0.0532, dtype=torch.float64)
5 gae_duplicate tensor(-0.1702, dtype=torch.float64) tensor(-1.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1143, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
4 gae_duplicate tensor(-0.0838, dtype=torch.float64) tensor(-1.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2665, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
3 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(0.7858, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4715, dtype=torch.float64) delta_t tensor(0.0333, dtype=torch.float64)
2 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(-0.6015, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:139.22286987304688
value loss:6.146454811096191
entropies:348.54449462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.030841112136841 seconds
19 rew tensor(1.0442, dtype=torch.float64) delta_t tensor(-0.0814, dtype=torch.float64)
19 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(1.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0826, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
18 gae_duplicate tensor(0.0049, dtype=torch.float64) tensor(-1.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9166, dtype=torch.float64) delta_t tensor(-0.0270, dtype=torch.float64)
17 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(0.4364, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0066, dtype=torch.float64) delta_t tensor(0.0188, dtype=torch.float64)
16 gae_duplicate tensor(-0.0188, dtype=torch.float64) tensor(-0.3546, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
15 gae_duplicate tensor(-0.1187, dtype=torch.float64) tensor(-0.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8547, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
14 gae_duplicate tensor(-0.0354, dtype=torch.float64) tensor(-0.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5466, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
13 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(-0.1504, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
12 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(1.1539, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3038, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
11 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(0.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0506, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
10 gae_duplicate tensor(-0.0422, dtype=torch.float64) tensor(-2.6934, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(0.1246, dtype=torch.float64)
9 gae_duplicate tensor(0.0401, dtype=torch.float64) tensor(-2.9188, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3953, dtype=torch.float64) delta_t tensor(-0.1034, dtype=torch.float64)
8 gae_duplicate tensor(-0.1450, dtype=torch.float64) tensor(1.6874, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0649, dtype=torch.float64) delta_t tensor(-0.1053, dtype=torch.float64)
7 gae_duplicate tensor(-0.2391, dtype=torch.float64) tensor(2.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5107, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
6 gae_duplicate tensor(-0.0312, dtype=torch.float64) tensor(-1.5576, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7010, dtype=torch.float64) delta_t tensor(-0.0562, dtype=torch.float64)
5 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(0.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1409, dtype=torch.float64) delta_t tensor(-0.0271, dtype=torch.float64)
4 gae_duplicate tensor(-0.2157, dtype=torch.float64) tensor(0.5359, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1534, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
3 gae_duplicate tensor(-0.1446, dtype=torch.float64) tensor(-2.4195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
2 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-1.3675, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:151.38534545898438
value loss:2.1750717163085938
entropies:348.1710205078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3878.6377)
ToM Target loss= tensor(4032.4348)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.755863904953003 seconds
19 rew tensor(1.2100, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
19 gae_duplicate tensor(-0.1391, dtype=torch.float64) tensor(0.7688, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1850, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
18 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-2.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(0.0323, dtype=torch.float64)
17 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-0.9749, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0441, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
16 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9684, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
15 gae_duplicate tensor(-0.1179, dtype=torch.float64) tensor(-1.5417, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2467, dtype=torch.float64) delta_t tensor(-0.1861, dtype=torch.float64)
14 gae_duplicate tensor(-1.8198, dtype=torch.float64) tensor(2.6483, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3660, dtype=torch.float64) delta_t tensor(-0.0926, dtype=torch.float64)
13 gae_duplicate tensor(-1.3253, dtype=torch.float64) tensor(2.8754, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3156, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
12 gae_duplicate tensor(-0.1313, dtype=torch.float64) tensor(-2.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
11 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-2.5792, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0655, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
10 gae_duplicate tensor(0.0202, dtype=torch.float64) tensor(-2.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4058, dtype=torch.float64) delta_t tensor(0.1354, dtype=torch.float64)
9 gae_duplicate tensor(0.0697, dtype=torch.float64) tensor(-3.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6265, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
8 gae_duplicate tensor(-0.3990, dtype=torch.float64) tensor(0.5789, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0961, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
7 gae_duplicate tensor(-0.5608, dtype=torch.float64) tensor(0.0853, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7410, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
6 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(0.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5206, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
5 gae_duplicate tensor(-0.2034, dtype=torch.float64) tensor(-1.3679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1134, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
4 gae_duplicate tensor(-0.1741, dtype=torch.float64) tensor(-0.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2400, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
3 gae_duplicate tensor(-0.2961, dtype=torch.float64) tensor(1.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4452, dtype=torch.float64) delta_t tensor(0.0238, dtype=torch.float64)
2 gae_duplicate tensor(-0.1694, dtype=torch.float64) tensor(-0.6545, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:476.91510009765625
value loss:13.84135913848877
entropies:347.95977783203125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.932731866836548 seconds
19 rew tensor(1.0702, dtype=torch.float64) delta_t tensor(-0.0380, dtype=torch.float64)
19 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(0.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0709, dtype=torch.float64) delta_t tensor(0.0894, dtype=torch.float64)
18 gae_duplicate tensor(-0.0152, dtype=torch.float64) tensor(-1.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0200, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
17 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-1.2337, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7235, dtype=torch.float64) delta_t tensor(-0.2292, dtype=torch.float64)
16 gae_duplicate tensor(-1.3044, dtype=torch.float64) tensor(4.8279, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8922, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
15 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-0.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7638, dtype=torch.float64) delta_t tensor(0.1412, dtype=torch.float64)
14 gae_duplicate tensor(-0.1106, dtype=torch.float64) tensor(-2.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.0869, dtype=torch.float64)
13 gae_duplicate tensor(-0.0814, dtype=torch.float64) tensor(-1.9077, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3553, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
12 gae_duplicate tensor(-0.0889, dtype=torch.float64) tensor(-0.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4955, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
11 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-0.8605, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0134, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
10 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-0.5979, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(-0.0172, dtype=torch.float64)
9 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.3447, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5258, dtype=torch.float64) delta_t tensor(0.0231, dtype=torch.float64)
8 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(-0.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2956, dtype=torch.float64) delta_t tensor(-0.2437, dtype=torch.float64)
7 gae_duplicate tensor(-1.8437, dtype=torch.float64) tensor(5.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6541, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
6 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(-0.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5192, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
5 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-1.5089, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0891, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
4 gae_duplicate tensor(-0.1305, dtype=torch.float64) tensor(-1.4014, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1524, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
3 gae_duplicate tensor(-0.1762, dtype=torch.float64) tensor(0.7504, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
2 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(-1.0177, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:73.14273834228516
value loss:10.751104354858398
entropies:348.05474853515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.882338047027588 seconds
19 rew tensor(1.2354, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
19 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-0.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
18 gae_duplicate tensor(0.0500, dtype=torch.float64) tensor(-3.1850, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0579, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
17 gae_duplicate tensor(-0.0442, dtype=torch.float64) tensor(-1.1050, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9930, dtype=torch.float64) delta_t tensor(0.1666, dtype=torch.float64)
16 gae_duplicate tensor(-0.1060, dtype=torch.float64) tensor(-3.0219, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(0.1050, dtype=torch.float64)
15 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(-2.6721, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5088, dtype=torch.float64) delta_t tensor(0.2058, dtype=torch.float64)
14 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-4.4592, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7255, dtype=torch.float64) delta_t tensor(0.1826, dtype=torch.float64)
13 gae_duplicate tensor(0.1301, dtype=torch.float64) tensor(-4.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1909, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
12 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(-1.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5210, dtype=torch.float64) delta_t tensor(0.1005, dtype=torch.float64)
11 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-2.0617, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1919, dtype=torch.float64) delta_t tensor(-0.0067, dtype=torch.float64)
10 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(0.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4696, dtype=torch.float64) delta_t tensor(0.0880, dtype=torch.float64)
9 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(-1.7554, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5501, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
8 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(0.2011, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8578, dtype=torch.float64) delta_t tensor(-0.0055, dtype=torch.float64)
7 gae_duplicate tensor(-0.2456, dtype=torch.float64) tensor(0.1895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7783, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
6 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-0.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4208, dtype=torch.float64) delta_t tensor(0.0089, dtype=torch.float64)
5 gae_duplicate tensor(-0.3112, dtype=torch.float64) tensor(0.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0128, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
4 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(0.8315, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0390, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
3 gae_duplicate tensor(-0.2922, dtype=torch.float64) tensor(-0.0125, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(-0.0985, dtype=torch.float64)
2 gae_duplicate tensor(-0.4499, dtype=torch.float64) tensor(1.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1027.0987548828125
value loss:5.8879008293151855
entropies:347.9648132324219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.756649971008301 seconds
19 rew tensor(1.2611, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
19 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-0.5058, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9270, dtype=torch.float64) delta_t tensor(-0.1299, dtype=torch.float64)
18 gae_duplicate tensor(-1.4060, dtype=torch.float64) tensor(2.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0947, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
17 gae_duplicate tensor(-0.0652, dtype=torch.float64) tensor(-1.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0566, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
16 gae_duplicate tensor(0.0221, dtype=torch.float64) tensor(-1.6268, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9149, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
15 gae_duplicate tensor(-0.1778, dtype=torch.float64) tensor(-0.1233, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9288, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
14 gae_duplicate tensor(-0.1575, dtype=torch.float64) tensor(-0.9691, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5217, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
13 gae_duplicate tensor(-1.0334, dtype=torch.float64) tensor(0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1321, dtype=torch.float64) delta_t tensor(-0.1610, dtype=torch.float64)
12 gae_duplicate tensor(-1.5926, dtype=torch.float64) tensor(2.3127, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7352, dtype=torch.float64) delta_t tensor(-0.7626, dtype=torch.float64)
11 gae_duplicate tensor(-3.5566, dtype=torch.float64) tensor(14.4017, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3169, dtype=torch.float64) delta_t tensor(-0.1834, dtype=torch.float64)
10 gae_duplicate tensor(-1.9307, dtype=torch.float64) tensor(5.6622, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1874, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
9 gae_duplicate tensor(-0.2527, dtype=torch.float64) tensor(1.0656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3829, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
8 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-0.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0739, dtype=torch.float64) delta_t tensor(-0.1422, dtype=torch.float64)
7 gae_duplicate tensor(-0.6841, dtype=torch.float64) tensor(2.4248, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6500, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
6 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(-1.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6241, dtype=torch.float64) delta_t tensor(-0.0870, dtype=torch.float64)
5 gae_duplicate tensor(-0.3156, dtype=torch.float64) tensor(1.8044, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0125, dtype=torch.float64) delta_t tensor(-0.0378, dtype=torch.float64)
4 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(0.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1766, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
3 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-0.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3315, dtype=torch.float64) delta_t tensor(-0.1206, dtype=torch.float64)
2 gae_duplicate tensor(-0.3298, dtype=torch.float64) tensor(2.2853, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1506.341064453125
value loss:41.34437561035156
entropies:348.0890197753906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.874901056289673 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
19 gae_duplicate tensor(-0.0941, dtype=torch.float64) tensor(0.3324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.1353, dtype=torch.float64)
18 gae_duplicate tensor(-0.0030, dtype=torch.float64) tensor(-2.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0445, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
17 gae_duplicate tensor(-0.0421, dtype=torch.float64) tensor(-1.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9686, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
16 gae_duplicate tensor(-0.0702, dtype=torch.float64) tensor(-0.7755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8913, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
15 gae_duplicate tensor(-0.1136, dtype=torch.float64) tensor(-0.9899, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
14 gae_duplicate tensor(-0.5915, dtype=torch.float64) tensor(-0.3626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6113, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
13 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-2.7341, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1645, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
12 gae_duplicate tensor(-0.1830, dtype=torch.float64) tensor(-1.6410, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6227, dtype=torch.float64) delta_t tensor(0.0591, dtype=torch.float64)
11 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-1.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1284, dtype=torch.float64) delta_t tensor(0.1629, dtype=torch.float64)
10 gae_duplicate tensor(0.1125, dtype=torch.float64) tensor(-3.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6740, dtype=torch.float64) delta_t tensor(0.0913, dtype=torch.float64)
9 gae_duplicate tensor(-0.0181, dtype=torch.float64) tensor(-2.3291, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7400, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
8 gae_duplicate tensor(-0.1439, dtype=torch.float64) tensor(-0.2540, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
7 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(0.9700, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9336, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
6 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(0.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0351, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
5 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(0.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2946, dtype=torch.float64) delta_t tensor(-0.0606, dtype=torch.float64)
4 gae_duplicate tensor(-0.2570, dtype=torch.float64) tensor(1.1722, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5387, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
3 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-0.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0752, dtype=torch.float64) delta_t tensor(-0.0438, dtype=torch.float64)
2 gae_duplicate tensor(-0.3433, dtype=torch.float64) tensor(0.5326, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:657.880615234375
value loss:4.635802745819092
entropies:348.46728515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3893.3320)
ToM Target loss= tensor(4031.4485)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.817009925842285 seconds
19 rew tensor(1.2105, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
19 gae_duplicate tensor(-0.0925, dtype=torch.float64) tensor(1.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2232, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
18 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-1.8685, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1602, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
17 gae_duplicate tensor(-0.0135, dtype=torch.float64) tensor(-1.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0204, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(-1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9044, dtype=torch.float64) delta_t tensor(0.0819, dtype=torch.float64)
15 gae_duplicate tensor(-0.0548, dtype=torch.float64) tensor(-1.6543, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0961, dtype=torch.float64) delta_t tensor(-0.3494, dtype=torch.float64)
14 gae_duplicate tensor(-1.3997, dtype=torch.float64) tensor(5.6284, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6612, dtype=torch.float64) delta_t tensor(0.1541, dtype=torch.float64)
13 gae_duplicate tensor(-0.0489, dtype=torch.float64) tensor(-2.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2930, dtype=torch.float64) delta_t tensor(0.0963, dtype=torch.float64)
12 gae_duplicate tensor(-0.1334, dtype=torch.float64) tensor(-1.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6105, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
11 gae_duplicate tensor(-0.0127, dtype=torch.float64) tensor(-3.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
10 gae_duplicate tensor(-0.0580, dtype=torch.float64) tensor(-1.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4962, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
9 gae_duplicate tensor(-0.1352, dtype=torch.float64) tensor(-1.5706, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8306, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
8 gae_duplicate tensor(-0.2359, dtype=torch.float64) tensor(0.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6017, dtype=torch.float64) delta_t tensor(-0.5720, dtype=torch.float64)
7 gae_duplicate tensor(-1.9285, dtype=torch.float64) tensor(9.8148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9715, dtype=torch.float64) delta_t tensor(0.0697, dtype=torch.float64)
6 gae_duplicate tensor(-0.2995, dtype=torch.float64) tensor(-0.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2922, dtype=torch.float64) delta_t tensor(0.2530, dtype=torch.float64)
5 gae_duplicate tensor(-0.0688, dtype=torch.float64) tensor(-5.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0895, dtype=torch.float64) delta_t tensor(0.0950, dtype=torch.float64)
4 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-2.1336, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2182, dtype=torch.float64) delta_t tensor(-0.1021, dtype=torch.float64)
3 gae_duplicate tensor(-0.3121, dtype=torch.float64) tensor(1.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4336, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
2 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(-2.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:363.6068115234375
value loss:19.540943145751953
entropies:348.99005126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.720254898071289 seconds
19 rew tensor(1.1590, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
19 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(0.5454, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1975, dtype=torch.float64) delta_t tensor(0.1406, dtype=torch.float64)
18 gae_duplicate tensor(0.0893, dtype=torch.float64) tensor(-2.6347, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0320, dtype=torch.float64) delta_t tensor(0.0104, dtype=torch.float64)
17 gae_duplicate tensor(-0.0768, dtype=torch.float64) tensor(-0.5636, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.0055, dtype=torch.float64)
16 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-0.1352, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6399, dtype=torch.float64) delta_t tensor(-0.2157, dtype=torch.float64)
15 gae_duplicate tensor(-1.6628, dtype=torch.float64) tensor(4.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0049, dtype=torch.float64) delta_t tensor(-0.3286, dtype=torch.float64)
14 gae_duplicate tensor(-2.0548, dtype=torch.float64) tensor(6.0672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7381, dtype=torch.float64) delta_t tensor(0.0450, dtype=torch.float64)
13 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-0.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1255, dtype=torch.float64) delta_t tensor(0.0860, dtype=torch.float64)
12 gae_duplicate tensor(-0.1002, dtype=torch.float64) tensor(-1.8319, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6744, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
11 gae_duplicate tensor(0.0247, dtype=torch.float64) tensor(-2.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1805, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
10 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(-1.1252, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5223, dtype=torch.float64) delta_t tensor(0.0016, dtype=torch.float64)
9 gae_duplicate tensor(-0.1266, dtype=torch.float64) tensor(-0.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7034, dtype=torch.float64) delta_t tensor(0.0413, dtype=torch.float64)
8 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-0.7054, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0525, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
7 gae_duplicate tensor(-0.2226, dtype=torch.float64) tensor(-0.5450, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8062, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
6 gae_duplicate tensor(-0.1673, dtype=torch.float64) tensor(0.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1108, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
5 gae_duplicate tensor(-0.1613, dtype=torch.float64) tensor(0.8959, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3720, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
4 gae_duplicate tensor(-0.1875, dtype=torch.float64) tensor(0.3867, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4223, dtype=torch.float64) delta_t tensor(-0.0544, dtype=torch.float64)
3 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(1.1362, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0408, dtype=torch.float64) delta_t tensor(-0.0560, dtype=torch.float64)
2 gae_duplicate tensor(-0.3111, dtype=torch.float64) tensor(1.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-365.49066162109375
value loss:12.546443939208984
entropies:349.7408447265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.814692974090576 seconds
19 rew tensor(0.9578, dtype=torch.float64) delta_t tensor(-0.2862, dtype=torch.float64)
19 gae_duplicate tensor(-1.4780, dtype=torch.float64) tensor(5.1028, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(0.1235, dtype=torch.float64)
18 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-1.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0446, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
17 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-0.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9423, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
16 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(0.3848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8404, dtype=torch.float64) delta_t tensor(-0.1403, dtype=torch.float64)
15 gae_duplicate tensor(-0.2962, dtype=torch.float64) tensor(2.8330, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6364, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
14 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(-2.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6755, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
13 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(-1.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1511, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
12 gae_duplicate tensor(-0.1287, dtype=torch.float64) tensor(-0.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5610, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
11 gae_duplicate tensor(-0.0492, dtype=torch.float64) tensor(-1.2043, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2062, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
10 gae_duplicate tensor(-0.3089, dtype=torch.float64) tensor(0.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4949, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
9 gae_duplicate tensor(-0.0295, dtype=torch.float64) tensor(-1.6984, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7277, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
8 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-0.7187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5931, dtype=torch.float64) delta_t tensor(-0.1090, dtype=torch.float64)
7 gae_duplicate tensor(-0.8960, dtype=torch.float64) tensor(1.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9078, dtype=torch.float64) delta_t tensor(0.0986, dtype=torch.float64)
6 gae_duplicate tensor(-0.1164, dtype=torch.float64) tensor(-1.8193, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1882, dtype=torch.float64) delta_t tensor(0.1149, dtype=torch.float64)
5 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(-2.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1918, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
4 gae_duplicate tensor(-0.1390, dtype=torch.float64) tensor(-0.6072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7815, dtype=torch.float64) delta_t tensor(-0.0274, dtype=torch.float64)
3 gae_duplicate tensor(-0.1651, dtype=torch.float64) tensor(0.2953, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1527, dtype=torch.float64) delta_t tensor(0.0257, dtype=torch.float64)
2 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(-0.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:101.55513763427734
value loss:7.988801956176758
entropies:350.4593811035156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.007253885269165 seconds
19 rew tensor(1.2099, dtype=torch.float64) delta_t tensor(-0.0805, dtype=torch.float64)
19 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(1.5673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1839, dtype=torch.float64) delta_t tensor(0.0632, dtype=torch.float64)
18 gae_duplicate tensor(-0.0948, dtype=torch.float64) tensor(-1.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8302, dtype=torch.float64) delta_t tensor(-0.2475, dtype=torch.float64)
17 gae_duplicate tensor(-1.3181, dtype=torch.float64) tensor(5.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0184, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
16 gae_duplicate tensor(-0.0811, dtype=torch.float64) tensor(0.3563, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9294, dtype=torch.float64) delta_t tensor(-0.0036, dtype=torch.float64)
15 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(-0.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7502, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
14 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-1.7395, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7242, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
13 gae_duplicate tensor(-0.1917, dtype=torch.float64) tensor(-1.8062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4187, dtype=torch.float64) delta_t tensor(0.1505, dtype=torch.float64)
12 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(-2.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0919, dtype=torch.float64) delta_t tensor(-0.2816, dtype=torch.float64)
11 gae_duplicate tensor(-1.9800, dtype=torch.float64) tensor(4.5840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.2546, dtype=torch.float64) delta_t tensor(-0.7736, dtype=torch.float64)
10 gae_duplicate tensor(-6.2267, dtype=torch.float64) tensor(17.9613, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4717, dtype=torch.float64) delta_t tensor(0.0378, dtype=torch.float64)
9 gae_duplicate tensor(-0.3889, dtype=torch.float64) tensor(0.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7038, dtype=torch.float64) delta_t tensor(0.1302, dtype=torch.float64)
8 gae_duplicate tensor(-0.2033, dtype=torch.float64) tensor(-2.8491, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1552, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
7 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(-0.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0116, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
6 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-0.9333, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9812, dtype=torch.float64) delta_t tensor(-0.0917, dtype=torch.float64)
5 gae_duplicate tensor(-0.3246, dtype=torch.float64) tensor(1.6197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4750, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
4 gae_duplicate tensor(-0.3428, dtype=torch.float64) tensor(1.5261, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4336, dtype=torch.float64) delta_t tensor(0.0660, dtype=torch.float64)
3 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(-0.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1691, dtype=torch.float64) delta_t tensor(-0.1064, dtype=torch.float64)
2 gae_duplicate tensor(-0.6189, dtype=torch.float64) tensor(1.8610, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1312.1192626953125
value loss:74.25138854980469
entropies:351.22589111328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.812718152999878 seconds
19 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(-0.1163, dtype=torch.float64)
19 gae_duplicate tensor(-0.1716, dtype=torch.float64) tensor(2.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1584, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
18 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-0.1176, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0946, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
17 gae_duplicate tensor(-0.0999, dtype=torch.float64) tensor(-1.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0308, dtype=torch.float64) delta_t tensor(0.0329, dtype=torch.float64)
16 gae_duplicate tensor(-0.0899, dtype=torch.float64) tensor(-0.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9288, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
15 gae_duplicate tensor(-0.3457, dtype=torch.float64) tensor(-1.6225, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6360, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
14 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-1.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6367, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
13 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-0.9659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3029, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
12 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-0.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4210, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
11 gae_duplicate tensor(-0.2846, dtype=torch.float64) tensor(0.5556, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0167, dtype=torch.float64) delta_t tensor(0.0638, dtype=torch.float64)
10 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-1.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2563, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
9 gae_duplicate tensor(-0.1863, dtype=torch.float64) tensor(0.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6270, dtype=torch.float64) delta_t tensor(-0.0409, dtype=torch.float64)
8 gae_duplicate tensor(-0.3832, dtype=torch.float64) tensor(0.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0513, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
7 gae_duplicate tensor(-0.7358, dtype=torch.float64) tensor(2.2303, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8193, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
6 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-2.6853, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3627, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
5 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-3.5278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1092, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
4 gae_duplicate tensor(0.0545, dtype=torch.float64) tensor(-2.8090, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1174, dtype=torch.float64) delta_t tensor(-0.0422, dtype=torch.float64)
3 gae_duplicate tensor(-0.2155, dtype=torch.float64) tensor(0.4638, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4535, dtype=torch.float64) delta_t tensor(0.1532, dtype=torch.float64)
2 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(-3.2528, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:635.1317749023438
value loss:6.6057353019714355
entropies:351.6667175292969
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3975.2810)
ToM Target loss= tensor(4035.0938)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.012477874755859 seconds
19 rew tensor(1.1832, dtype=torch.float64) delta_t tensor(-0.1395, dtype=torch.float64)
19 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(2.7536, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1833, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
18 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-0.4172, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1452, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
17 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-0.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7525, dtype=torch.float64) delta_t tensor(-0.2344, dtype=torch.float64)
16 gae_duplicate tensor(-1.3812, dtype=torch.float64) tensor(4.6938, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8523, dtype=torch.float64) delta_t tensor(0.0014, dtype=torch.float64)
15 gae_duplicate tensor(-0.1725, dtype=torch.float64) tensor(0.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6596, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
14 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-4.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6872, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
13 gae_duplicate tensor(-0.1241, dtype=torch.float64) tensor(-1.5441, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3297, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
12 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-1.1923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5729, dtype=torch.float64) delta_t tensor(0.0645, dtype=torch.float64)
11 gae_duplicate tensor(-0.1829, dtype=torch.float64) tensor(-1.2716, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1935, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
10 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(0.7221, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3943, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
9 gae_duplicate tensor(-0.0760, dtype=torch.float64) tensor(-1.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6761, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
8 gae_duplicate tensor(-0.3642, dtype=torch.float64) tensor(0.9913, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.2167, dtype=torch.float64) delta_t tensor(-0.3975, dtype=torch.float64)
7 gae_duplicate tensor(-1.7358, dtype=torch.float64) tensor(7.1109, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8290, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
6 gae_duplicate tensor(-0.0561, dtype=torch.float64) tensor(-1.8438, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6206, dtype=torch.float64) delta_t tensor(0.3256, dtype=torch.float64)
5 gae_duplicate tensor(-0.1173, dtype=torch.float64) tensor(-6.4272, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3905, dtype=torch.float64) delta_t tensor(0.0359, dtype=torch.float64)
4 gae_duplicate tensor(-0.1826, dtype=torch.float64) tensor(-1.4754, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6928, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
3 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(0.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7476, dtype=torch.float64) delta_t tensor(0.1442, dtype=torch.float64)
2 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(-2.9541, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:255.54818725585938
value loss:18.566246032714844
entropies:352.1966552734375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.759521961212158 seconds
19 rew tensor(1.1451, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
19 gae_duplicate tensor(-0.2172, dtype=torch.float64) tensor(2.8256, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8682, dtype=torch.float64) delta_t tensor(-0.2169, dtype=torch.float64)
18 gae_duplicate tensor(-1.4832, dtype=torch.float64) tensor(4.8085, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(-0.0676, dtype=torch.float64)
17 gae_duplicate tensor(-0.1759, dtype=torch.float64) tensor(1.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0188, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
16 gae_duplicate tensor(-0.2152, dtype=torch.float64) tensor(0.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7884, dtype=torch.float64) delta_t tensor(-0.2151, dtype=torch.float64)
15 gae_duplicate tensor(-0.3757, dtype=torch.float64) tensor(4.3321, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4729, dtype=torch.float64) delta_t tensor(-0.1307, dtype=torch.float64)
14 gae_duplicate tensor(-0.7257, dtype=torch.float64) tensor(2.6549, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7763, dtype=torch.float64) delta_t tensor(0.0421, dtype=torch.float64)
13 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-0.5795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2658, dtype=torch.float64) delta_t tensor(0.0790, dtype=torch.float64)
12 gae_duplicate tensor(-0.2564, dtype=torch.float64) tensor(-1.4328, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6356, dtype=torch.float64) delta_t tensor(-0.0018, dtype=torch.float64)
11 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-0.2452, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2059, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
10 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(-1.1878, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4575, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
9 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-0.5594, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5740, dtype=torch.float64) delta_t tensor(0.0588, dtype=torch.float64)
8 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-1.3515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6212, dtype=torch.float64) delta_t tensor(-0.0554, dtype=torch.float64)
7 gae_duplicate tensor(-0.3559, dtype=torch.float64) tensor(0.9432, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9210, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
6 gae_duplicate tensor(-0.1121, dtype=torch.float64) tensor(-1.9327, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1327, dtype=torch.float64) delta_t tensor(0.1375, dtype=torch.float64)
5 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-2.9425, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2978, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
4 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-0.2676, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5179, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
3 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(-2.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
2 gae_duplicate tensor(-0.4222, dtype=torch.float64) tensor(3.3673, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-560.3496704101562
value loss:8.960044860839844
entropies:352.7682800292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.741860866546631 seconds
19 rew tensor(1.1069, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
19 gae_duplicate tensor(-0.2292, dtype=torch.float64) tensor(2.8183, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0947, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
18 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-0.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7920, dtype=torch.float64) delta_t tensor(-0.2091, dtype=torch.float64)
17 gae_duplicate tensor(-1.4794, dtype=torch.float64) tensor(3.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9164, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
16 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(1.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8146, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
15 gae_duplicate tensor(-0.2017, dtype=torch.float64) tensor(2.5051, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6999, dtype=torch.float64) delta_t tensor(0.1423, dtype=torch.float64)
14 gae_duplicate tensor(-0.1139, dtype=torch.float64) tensor(-2.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6998, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
13 gae_duplicate tensor(-0.1404, dtype=torch.float64) tensor(0.0035, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3186, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
12 gae_duplicate tensor(-0.1136, dtype=torch.float64) tensor(-0.5782, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4815, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
11 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(0.7710, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1144, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
10 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(0.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2768, dtype=torch.float64) delta_t tensor(0.0929, dtype=torch.float64)
9 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(-1.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4212, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
8 gae_duplicate tensor(-0.0455, dtype=torch.float64) tensor(-2.5754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9194, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
7 gae_duplicate tensor(-0.0236, dtype=torch.float64) tensor(-2.3483, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5362, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
6 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-2.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6472, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
5 gae_duplicate tensor(-0.3877, dtype=torch.float64) tensor(-1.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0868, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
4 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1480, dtype=torch.float64) delta_t tensor(0.0244, dtype=torch.float64)
3 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-0.4285, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4441, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
2 gae_duplicate tensor(-0.2657, dtype=torch.float64) tensor(0.0692, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-31.577621459960938
value loss:7.166576862335205
entropies:353.1836853027344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.659731864929199 seconds
19 rew tensor(1.1710, dtype=torch.float64) delta_t tensor(-0.1329, dtype=torch.float64)
19 gae_duplicate tensor(-0.1929, dtype=torch.float64) tensor(2.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1585, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
18 gae_duplicate tensor(-0.0519, dtype=torch.float64) tensor(-0.5838, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1077, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
17 gae_duplicate tensor(-0.0727, dtype=torch.float64) tensor(-0.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0052, dtype=torch.float64) delta_t tensor(-0.0379, dtype=torch.float64)
16 gae_duplicate tensor(-0.1555, dtype=torch.float64) tensor(0.7241, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9411, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
15 gae_duplicate tensor(-0.1566, dtype=torch.float64) tensor(-1.7135, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6496, dtype=torch.float64) delta_t tensor(0.4168, dtype=torch.float64)
14 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-7.9770, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(0.1256, dtype=torch.float64)
13 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-3.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.1204, dtype=torch.float64)
12 gae_duplicate tensor(-0.0282, dtype=torch.float64) tensor(-2.8740, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3158, dtype=torch.float64) delta_t tensor(0.0537, dtype=torch.float64)
11 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-1.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1021, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
10 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(0.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3157, dtype=torch.float64) delta_t tensor(0.0898, dtype=torch.float64)
9 gae_duplicate tensor(-0.0373, dtype=torch.float64) tensor(-1.7888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4975, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
8 gae_duplicate tensor(-0.0569, dtype=torch.float64) tensor(-1.9991, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4427, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
7 gae_duplicate tensor(-0.0822, dtype=torch.float64) tensor(-4.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6507, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
6 gae_duplicate tensor(-0.2254, dtype=torch.float64) tensor(0.7088, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8768, dtype=torch.float64) delta_t tensor(0.1436, dtype=torch.float64)
5 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-2.8991, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3678, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
4 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-0.4444, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7479, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
3 gae_duplicate tensor(-0.1186, dtype=torch.float64) tensor(-1.2721, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6867, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
2 gae_duplicate tensor(-0.1996, dtype=torch.float64) tensor(0.6760, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1278.541015625
value loss:7.35036563873291
entropies:353.62689208984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.699392080307007 seconds
19 rew tensor(1.2225, dtype=torch.float64) delta_t tensor(-0.0731, dtype=torch.float64)
19 gae_duplicate tensor(-0.1421, dtype=torch.float64) tensor(1.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1974, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
18 gae_duplicate tensor(-0.0418, dtype=torch.float64) tensor(-1.4072, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1073, dtype=torch.float64) delta_t tensor(-0.0294, dtype=torch.float64)
17 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(0.4560, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1203, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
16 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-0.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9675, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
15 gae_duplicate tensor(-0.1928, dtype=torch.float64) tensor(0.6511, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.2306, dtype=torch.float64)
14 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(-4.5193, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6249, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
13 gae_duplicate tensor(-0.0336, dtype=torch.float64) tensor(-2.8443, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1595, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
12 gae_duplicate tensor(-2.2283, dtype=torch.float64) tensor(4.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2655, dtype=torch.float64) delta_t tensor(-0.7271, dtype=torch.float64)
11 gae_duplicate tensor(-4.5924, dtype=torch.float64) tensor(15.0818, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2045, dtype=torch.float64) delta_t tensor(0.1312, dtype=torch.float64)
10 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-1.1937, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5850, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
9 gae_duplicate tensor(0.0460, dtype=torch.float64) tensor(-2.3633, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6662, dtype=torch.float64) delta_t tensor(0.0094, dtype=torch.float64)
8 gae_duplicate tensor(-0.0929, dtype=torch.float64) tensor(-0.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3804, dtype=torch.float64) delta_t tensor(-0.1549, dtype=torch.float64)
7 gae_duplicate tensor(-2.1304, dtype=torch.float64) tensor(2.7330, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8842, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
6 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(0.8660, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4658, dtype=torch.float64) delta_t tensor(0.1089, dtype=torch.float64)
5 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(-1.9138, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0605, dtype=torch.float64) delta_t tensor(-0.0477, dtype=torch.float64)
4 gae_duplicate tensor(-0.2358, dtype=torch.float64) tensor(0.7568, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2631, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
3 gae_duplicate tensor(-0.2388, dtype=torch.float64) tensor(-1.4225, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3920, dtype=torch.float64) delta_t tensor(0.0051, dtype=torch.float64)
2 gae_duplicate tensor(-0.1810, dtype=torch.float64) tensor(-0.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-633.0042724609375
value loss:52.075496673583984
entropies:354.0029602050781
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(4002.0107)
ToM Target loss= tensor(4043.5947)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.826632976531982 seconds
19 rew tensor(1.1712, dtype=torch.float64) delta_t tensor(-0.0510, dtype=torch.float64)
19 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(1.0395, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
18 gae_duplicate tensor(-0.0175, dtype=torch.float64) tensor(-2.0767, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0823, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
17 gae_duplicate tensor(0.0571, dtype=torch.float64) tensor(-2.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
16 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-0.6504, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8401, dtype=torch.float64) delta_t tensor(-0.0291, dtype=torch.float64)
15 gae_duplicate tensor(-0.0761, dtype=torch.float64) tensor(0.4969, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8143, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
14 gae_duplicate tensor(-0.1822, dtype=torch.float64) tensor(0.6846, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1677, dtype=torch.float64) delta_t tensor(-0.5895, dtype=torch.float64)
13 gae_duplicate tensor(-2.3472, dtype=torch.float64) tensor(11.5552, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4447, dtype=torch.float64) delta_t tensor(0.1543, dtype=torch.float64)
12 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-1.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2668, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
11 gae_duplicate tensor(-0.2093, dtype=torch.float64) tensor(-2.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0750, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
10 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-4.2850, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2925, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
9 gae_duplicate tensor(0.0098, dtype=torch.float64) tensor(-1.6629, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5123, dtype=torch.float64) delta_t tensor(-0.1052, dtype=torch.float64)
8 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(1.9842, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7375, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
7 gae_duplicate tensor(-0.2836, dtype=torch.float64) tensor(1.5624, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5885, dtype=torch.float64) delta_t tensor(0.1338, dtype=torch.float64)
6 gae_duplicate tensor(0.0111, dtype=torch.float64) tensor(-2.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5934, dtype=torch.float64) delta_t tensor(-0.0281, dtype=torch.float64)
5 gae_duplicate tensor(-0.2228, dtype=torch.float64) tensor(0.2301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0413, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
4 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-0.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0573, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
3 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(0.4066, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2901, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
2 gae_duplicate tensor(-0.3281, dtype=torch.float64) tensor(1.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-125.31141662597656
value loss:14.382442474365234
entropies:354.20928955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.626910209655762 seconds
19 rew tensor(1.1462, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
19 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(0.3059, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0953, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
18 gae_duplicate tensor(0.0107, dtype=torch.float64) tensor(-1.8804, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
17 gae_duplicate tensor(-0.0495, dtype=torch.float64) tensor(-1.1274, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0182, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
16 gae_duplicate tensor(-0.0525, dtype=torch.float64) tensor(-1.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8526, dtype=torch.float64) delta_t tensor(0.0629, dtype=torch.float64)
15 gae_duplicate tensor(-0.0557, dtype=torch.float64) tensor(-1.2490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5567, dtype=torch.float64) delta_t tensor(-0.2339, dtype=torch.float64)
14 gae_duplicate tensor(-0.9572, dtype=torch.float64) tensor(4.5027, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6235, dtype=torch.float64) delta_t tensor(0.0083, dtype=torch.float64)
13 gae_duplicate tensor(-0.1117, dtype=torch.float64) tensor(0.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
12 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-2.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4848, dtype=torch.float64) delta_t tensor(-0.0545, dtype=torch.float64)
11 gae_duplicate tensor(-0.2373, dtype=torch.float64) tensor(0.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0032, dtype=torch.float64) delta_t tensor(0.1199, dtype=torch.float64)
10 gae_duplicate tensor(-0.0542, dtype=torch.float64) tensor(-2.3246, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3568, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
9 gae_duplicate tensor(-0.2588, dtype=torch.float64) tensor(-1.0152, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4878, dtype=torch.float64) delta_t tensor(-0.0046, dtype=torch.float64)
8 gae_duplicate tensor(-0.4772, dtype=torch.float64) tensor(0.0630, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1913, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
7 gae_duplicate tensor(-0.5435, dtype=torch.float64) tensor(0.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7799, dtype=torch.float64) delta_t tensor(-0.0400, dtype=torch.float64)
6 gae_duplicate tensor(-0.2150, dtype=torch.float64) tensor(0.8348, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3167, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
5 gae_duplicate tensor(-0.1247, dtype=torch.float64) tensor(-2.2973, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0139, dtype=torch.float64) delta_t tensor(-0.0986, dtype=torch.float64)
4 gae_duplicate tensor(-0.3186, dtype=torch.float64) tensor(1.8022, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0267, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
3 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-1.4853, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3579, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
2 gae_duplicate tensor(-0.5591, dtype=torch.float64) tensor(0.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:181.47280883789062
value loss:8.194698333740234
entropies:354.3656921386719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.93739914894104 seconds
19 rew tensor(1.1206, dtype=torch.float64) delta_t tensor(-0.0101, dtype=torch.float64)
19 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(0.2055, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1080, dtype=torch.float64) delta_t tensor(0.1452, dtype=torch.float64)
18 gae_duplicate tensor(0.0429, dtype=torch.float64) tensor(-2.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0823, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
17 gae_duplicate tensor(0.0192, dtype=torch.float64) tensor(-2.8320, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8653, dtype=torch.float64) delta_t tensor(0.0194, dtype=torch.float64)
16 gae_duplicate tensor(-0.1161, dtype=torch.float64) tensor(-0.7177, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9292, dtype=torch.float64) delta_t tensor(0.0488, dtype=torch.float64)
15 gae_duplicate tensor(-0.0410, dtype=torch.float64) tensor(-1.0178, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5596, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
14 gae_duplicate tensor(-0.0504, dtype=torch.float64) tensor(0.2553, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7520, dtype=torch.float64) delta_t tensor(0.0654, dtype=torch.float64)
13 gae_duplicate tensor(-0.0141, dtype=torch.float64) tensor(-1.2746, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1510, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
12 gae_duplicate tensor(-0.1472, dtype=torch.float64) tensor(-0.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6110, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
11 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-0.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0908, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
10 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-0.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3665, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
9 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-0.7781, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7526, dtype=torch.float64) delta_t tensor(0.0060, dtype=torch.float64)
8 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4807, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
7 gae_duplicate tensor(-0.6638, dtype=torch.float64) tensor(2.2389, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7916, dtype=torch.float64) delta_t tensor(0.0220, dtype=torch.float64)
6 gae_duplicate tensor(-0.1839, dtype=torch.float64) tensor(-0.2307, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2409, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
5 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-0.6790, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1902, dtype=torch.float64) delta_t tensor(0.0920, dtype=torch.float64)
4 gae_duplicate tensor(0.0483, dtype=torch.float64) tensor(-1.8292, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7331, dtype=torch.float64) delta_t tensor(-0.0981, dtype=torch.float64)
3 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(1.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1668, dtype=torch.float64) delta_t tensor(0.1524, dtype=torch.float64)
2 gae_duplicate tensor(-0.0401, dtype=torch.float64) tensor(-2.8743, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:552.7523193359375
value loss:3.1485681533813477
entropies:354.4494934082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.16314697265625 seconds
19 rew tensor(1.1840, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
19 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(0.1889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1330, dtype=torch.float64) delta_t tensor(0.1282, dtype=torch.float64)
18 gae_duplicate tensor(0.0112, dtype=torch.float64) tensor(-2.5298, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1451, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
17 gae_duplicate tensor(0.0771, dtype=torch.float64) tensor(-3.0363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9670, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
16 gae_duplicate tensor(-0.0615, dtype=torch.float64) tensor(-1.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7011, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
15 gae_duplicate tensor(-1.2109, dtype=torch.float64) tensor(3.0258, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8268, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
14 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-3.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3964, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
13 gae_duplicate tensor(-0.6245, dtype=torch.float64) tensor(0.4302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5325, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
12 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-2.2816, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2410, dtype=torch.float64) delta_t tensor(0.1386, dtype=torch.float64)
11 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-3.0416, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1386, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
10 gae_duplicate tensor(-0.0173, dtype=torch.float64) tensor(-2.4060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1129, dtype=torch.float64) delta_t tensor(0.1574, dtype=torch.float64)
9 gae_duplicate tensor(-0.0037, dtype=torch.float64) tensor(-3.3520, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4855, dtype=torch.float64) delta_t tensor(-0.1128, dtype=torch.float64)
8 gae_duplicate tensor(-0.3660, dtype=torch.float64) tensor(1.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.9402, dtype=torch.float64) delta_t tensor(-0.7519, dtype=torch.float64)
7 gae_duplicate tensor(-4.2432, dtype=torch.float64) tensor(14.6959, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7915, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
6 gae_duplicate tensor(-0.5628, dtype=torch.float64) tensor(2.7434, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8010, dtype=torch.float64) delta_t tensor(0.1628, dtype=torch.float64)
5 gae_duplicate tensor(-0.2832, dtype=torch.float64) tensor(-2.8721, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3686, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
4 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-0.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8771, dtype=torch.float64) delta_t tensor(-0.1864, dtype=torch.float64)
3 gae_duplicate tensor(-0.4616, dtype=torch.float64) tensor(3.5181, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6746, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
2 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(-2.7908, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:11.932826042175293
value loss:42.976158142089844
entropies:354.5157165527344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.166011095046997 seconds
19 rew tensor(1.1328, dtype=torch.float64) delta_t tensor(-0.0103, dtype=torch.float64)
19 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(0.2142, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(0.1732, dtype=torch.float64)
18 gae_duplicate tensor(0.0696, dtype=torch.float64) tensor(-3.2787, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1071, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
17 gae_duplicate tensor(0.0861, dtype=torch.float64) tensor(-3.6038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8771, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
16 gae_duplicate tensor(-0.1202, dtype=torch.float64) tensor(-0.3775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8779, dtype=torch.float64) delta_t tensor(0.0510, dtype=torch.float64)
15 gae_duplicate tensor(-0.0042, dtype=torch.float64) tensor(-1.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6607, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
14 gae_duplicate tensor(-0.0678, dtype=torch.float64) tensor(0.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7645, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
13 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-1.8797, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2276, dtype=torch.float64) delta_t tensor(-0.1254, dtype=torch.float64)
12 gae_duplicate tensor(-0.2889, dtype=torch.float64) tensor(2.2912, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4969, dtype=torch.float64) delta_t tensor(-0.0505, dtype=torch.float64)
11 gae_duplicate tensor(-0.1970, dtype=torch.float64) tensor(1.3068, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0397, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
10 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-0.5266, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1896, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
9 gae_duplicate tensor(-0.0344, dtype=torch.float64) tensor(-0.7960, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5245, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
8 gae_duplicate tensor(-0.4164, dtype=torch.float64) tensor(0.3384, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8404, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
7 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-5.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6391, dtype=torch.float64) delta_t tensor(-0.0220, dtype=torch.float64)
6 gae_duplicate tensor(-0.1320, dtype=torch.float64) tensor(-0.0740, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5424, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
5 gae_duplicate tensor(-0.1011, dtype=torch.float64) tensor(-1.6305, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
4 gae_duplicate tensor(-0.1992, dtype=torch.float64) tensor(-0.3328, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1345, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
3 gae_duplicate tensor(-0.1799, dtype=torch.float64) tensor(0.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4691, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
2 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-2.3968, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:800.1044921875
value loss:4.796818256378174
entropies:354.631103515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3957.5664)
ToM Target loss= tensor(4046.0764)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.140371084213257 seconds
19 rew tensor(1.2470, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
19 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-0.1115, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9384, dtype=torch.float64) delta_t tensor(-0.1426, dtype=torch.float64)
18 gae_duplicate tensor(-1.3941, dtype=torch.float64) tensor(2.8717, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1193, dtype=torch.float64) delta_t tensor(0.0749, dtype=torch.float64)
17 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-1.1805, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1070, dtype=torch.float64) delta_t tensor(0.1397, dtype=torch.float64)
16 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-2.8306, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9663, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
15 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(-2.5409, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8137, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
14 gae_duplicate tensor(0.0071, dtype=torch.float64) tensor(-6.5450, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2476, dtype=torch.float64) delta_t tensor(-0.3025, dtype=torch.float64)
13 gae_duplicate tensor(-1.9081, dtype=torch.float64) tensor(4.9668, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1102, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
12 gae_duplicate tensor(-1.9927, dtype=torch.float64) tensor(1.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5286, dtype=torch.float64) delta_t tensor(-0.8138, dtype=torch.float64)
11 gae_duplicate tensor(-3.9016, dtype=torch.float64) tensor(16.8185, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3338, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
10 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(0.5873, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6084, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
9 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-2.9215, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7395, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
8 gae_duplicate tensor(-0.3130, dtype=torch.float64) tensor(1.3015, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7436, dtype=torch.float64) delta_t tensor(0.3133, dtype=torch.float64)
7 gae_duplicate tensor(-0.4128, dtype=torch.float64) tensor(-6.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9822, dtype=torch.float64) delta_t tensor(-0.1027, dtype=torch.float64)
6 gae_duplicate tensor(-0.2075, dtype=torch.float64) tensor(1.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3373, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
5 gae_duplicate tensor(-0.3274, dtype=torch.float64) tensor(-1.4894, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0955, dtype=torch.float64) delta_t tensor(-0.0317, dtype=torch.float64)
4 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(0.4101, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1156, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
3 gae_duplicate tensor(-0.1515, dtype=torch.float64) tensor(0.7652, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2233, dtype=torch.float64) delta_t tensor(0.0239, dtype=torch.float64)
2 gae_duplicate tensor(-0.1223, dtype=torch.float64) tensor(-0.4050, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-459.6553649902344
value loss:49.496402740478516
entropies:354.72564697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.833467721939087 seconds
19 rew tensor(1.1455, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
19 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(0.2618, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1201, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
18 gae_duplicate tensor(0.0125, dtype=torch.float64) tensor(-1.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8118, dtype=torch.float64) delta_t tensor(-0.2091, dtype=torch.float64)
17 gae_duplicate tensor(-1.3801, dtype=torch.float64) tensor(3.6633, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0310, dtype=torch.float64) delta_t tensor(0.0540, dtype=torch.float64)
16 gae_duplicate tensor(-0.0944, dtype=torch.float64) tensor(-0.6848, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9676, dtype=torch.float64) delta_t tensor(0.0295, dtype=torch.float64)
15 gae_duplicate tensor(-0.0317, dtype=torch.float64) tensor(-0.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0799, dtype=torch.float64) delta_t tensor(-0.6283, dtype=torch.float64)
14 gae_duplicate tensor(-2.2791, dtype=torch.float64) tensor(11.7516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4095, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
13 gae_duplicate tensor(-0.9626, dtype=torch.float64) tensor(0.6711, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4195, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
12 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-1.2546, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4833, dtype=torch.float64) delta_t tensor(0.1351, dtype=torch.float64)
11 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-2.8341, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0397, dtype=torch.float64) delta_t tensor(0.0762, dtype=torch.float64)
10 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-1.7086, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4064, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
9 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-0.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5747, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
8 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-0.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9639, dtype=torch.float64) delta_t tensor(-0.2933, dtype=torch.float64)
7 gae_duplicate tensor(-1.6569, dtype=torch.float64) tensor(6.0775, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7292, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
6 gae_duplicate tensor(-0.3562, dtype=torch.float64) tensor(0.8892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3650, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
5 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-0.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1149, dtype=torch.float64) delta_t tensor(-0.0259, dtype=torch.float64)
4 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(0.5303, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8451, dtype=torch.float64) delta_t tensor(-0.0355, dtype=torch.float64)
3 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(0.7798, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2290, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
2 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-1.0473, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-790.7294921875
value loss:22.74898910522461
entropies:354.80767822265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777837038040161 seconds
19 rew tensor(1.1966, dtype=torch.float64) delta_t tensor(0.0225, dtype=torch.float64)
19 gae_duplicate tensor(-0.0817, dtype=torch.float64) tensor(-0.4629, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8367, dtype=torch.float64) delta_t tensor(-0.1497, dtype=torch.float64)
18 gae_duplicate tensor(-1.4105, dtype=torch.float64) tensor(2.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7257, dtype=torch.float64) delta_t tensor(-0.2081, dtype=torch.float64)
17 gae_duplicate tensor(-1.3770, dtype=torch.float64) tensor(4.2110, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9924, dtype=torch.float64) delta_t tensor(0.0649, dtype=torch.float64)
16 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-0.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8010, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
15 gae_duplicate tensor(-0.1874, dtype=torch.float64) tensor(-0.7868, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7001, dtype=torch.float64) delta_t tensor(0.0982, dtype=torch.float64)
14 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(-2.1789, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5849, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
13 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(0.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3813, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
12 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-1.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4687, dtype=torch.float64) delta_t tensor(0.0441, dtype=torch.float64)
11 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-0.9288, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1396, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
10 gae_duplicate tensor(-0.2969, dtype=torch.float64) tensor(0.0718, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3804, dtype=torch.float64) delta_t tensor(0.0352, dtype=torch.float64)
9 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-0.6718, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5741, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
8 gae_duplicate tensor(-0.2343, dtype=torch.float64) tensor(2.2075, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9900, dtype=torch.float64) delta_t tensor(-0.1020, dtype=torch.float64)
7 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(2.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6505, dtype=torch.float64) delta_t tensor(-0.0495, dtype=torch.float64)
6 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(1.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5427, dtype=torch.float64) delta_t tensor(0.0131, dtype=torch.float64)
5 gae_duplicate tensor(-0.2462, dtype=torch.float64) tensor(0.0166, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0161, dtype=torch.float64) delta_t tensor(0.0309, dtype=torch.float64)
4 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-0.6490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0685, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
3 gae_duplicate tensor(-0.2360, dtype=torch.float64) tensor(2.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3152, dtype=torch.float64) delta_t tensor(0.0123, dtype=torch.float64)
2 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(0.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-541.5496826171875
value loss:10.33823013305664
entropies:354.91082763671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.865006923675537 seconds
19 rew tensor(1.1336, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
19 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(0.6775, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0952, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
18 gae_duplicate tensor(-0.0140, dtype=torch.float64) tensor(-1.5712, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0954, dtype=torch.float64) delta_t tensor(0.1193, dtype=torch.float64)
17 gae_duplicate tensor(-0.0240, dtype=torch.float64) tensor(-2.4310, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7230, dtype=torch.float64) delta_t tensor(-0.2114, dtype=torch.float64)
16 gae_duplicate tensor(-1.3425, dtype=torch.float64) tensor(4.1925, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8524, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
15 gae_duplicate tensor(-0.1317, dtype=torch.float64) tensor(-0.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4683, dtype=torch.float64) delta_t tensor(-0.2475, dtype=torch.float64)
14 gae_duplicate tensor(-1.3137, dtype=torch.float64) tensor(4.7236, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3639, dtype=torch.float64) delta_t tensor(-0.0503, dtype=torch.float64)
13 gae_duplicate tensor(-0.9879, dtype=torch.float64) tensor(1.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5366, dtype=torch.float64) delta_t tensor(0.0538, dtype=torch.float64)
12 gae_duplicate tensor(-0.1812, dtype=torch.float64) tensor(-0.9043, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2897, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
11 gae_duplicate tensor(-0.2394, dtype=torch.float64) tensor(-0.3530, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0771, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
10 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.9625, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1763, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
9 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-1.9474, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3967, dtype=torch.float64) delta_t tensor(-0.0249, dtype=torch.float64)
8 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(0.2532, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7156, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
7 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-0.1166, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4861, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
6 gae_duplicate tensor(-0.0896, dtype=torch.float64) tensor(-1.0254, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6207, dtype=torch.float64) delta_t tensor(-0.0394, dtype=torch.float64)
5 gae_duplicate tensor(-0.1734, dtype=torch.float64) tensor(0.6273, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
4 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9331, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
3 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(0.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2913, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
2 gae_duplicate tensor(-0.1387, dtype=torch.float64) tensor(-0.3396, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-258.2847595214844
value loss:9.142675399780273
entropies:355.0077819824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.62192702293396 seconds
19 rew tensor(1.2099, dtype=torch.float64) delta_t tensor(-0.0486, dtype=torch.float64)
19 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(0.9476, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1720, dtype=torch.float64) delta_t tensor(0.0852, dtype=torch.float64)
18 gae_duplicate tensor(0.0335, dtype=torch.float64) tensor(-1.6094, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0838, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
17 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-0.7420, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1470, dtype=torch.float64) delta_t tensor(0.0989, dtype=torch.float64)
16 gae_duplicate tensor(0.0389, dtype=torch.float64) tensor(-2.0595, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0076, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
15 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-1.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5568, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
14 gae_duplicate tensor(-0.7938, dtype=torch.float64) tensor(-1.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0191, dtype=torch.float64) delta_t tensor(-0.4295, dtype=torch.float64)
13 gae_duplicate tensor(-2.6819, dtype=torch.float64) tensor(8.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1097, dtype=torch.float64) delta_t tensor(-0.1020, dtype=torch.float64)
12 gae_duplicate tensor(-1.4501, dtype=torch.float64) tensor(2.8729, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2939, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
11 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-1.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1170, dtype=torch.float64) delta_t tensor(0.0012, dtype=torch.float64)
10 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(-0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4219, dtype=torch.float64) delta_t tensor(-0.0251, dtype=torch.float64)
9 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(0.4485, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4497, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
8 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(0.6734, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1346, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
7 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(-1.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5644, dtype=torch.float64) delta_t tensor(-0.1320, dtype=torch.float64)
6 gae_duplicate tensor(-0.2310, dtype=torch.float64) tensor(2.5902, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7974, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
5 gae_duplicate tensor(-0.2088, dtype=torch.float64) tensor(0.8455, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1388, dtype=torch.float64) delta_t tensor(-0.0062, dtype=torch.float64)
4 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(0.1767, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3921, dtype=torch.float64) delta_t tensor(-0.0686, dtype=torch.float64)
3 gae_duplicate tensor(-0.1885, dtype=torch.float64) tensor(1.4177, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4447, dtype=torch.float64) delta_t tensor(-0.1966, dtype=torch.float64)
2 gae_duplicate tensor(-0.3087, dtype=torch.float64) tensor(4.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-768.3025512695312
value loss:19.15398406982422
entropies:355.12493896484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3979.2114)
ToM Target loss= tensor(4048.4480)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.960324048995972 seconds
19 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
19 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(0.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1214, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
18 gae_duplicate tensor(-0.0228, dtype=torch.float64) tensor(-1.7774, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7612, dtype=torch.float64) delta_t tensor(-0.2476, dtype=torch.float64)
17 gae_duplicate tensor(-1.4076, dtype=torch.float64) tensor(4.9813, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
16 gae_duplicate tensor(-0.1052, dtype=torch.float64) tensor(-0.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(-0.0366, dtype=torch.float64)
15 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(0.6864, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4664, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
14 gae_duplicate tensor(-0.7956, dtype=torch.float64) tensor(0.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
13 gae_duplicate tensor(-0.1306, dtype=torch.float64) tensor(0.2832, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2403, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
12 gae_duplicate tensor(-0.2098, dtype=torch.float64) tensor(-2.3888, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5218, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
11 gae_duplicate tensor(-0.2118, dtype=torch.float64) tensor(-0.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2054, dtype=torch.float64) delta_t tensor(0.0182, dtype=torch.float64)
10 gae_duplicate tensor(-0.0816, dtype=torch.float64) tensor(-0.3678, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
9 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(-0.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6016, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
8 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(0.8680, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6875, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
7 gae_duplicate tensor(-0.1547, dtype=torch.float64) tensor(-1.7229, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6650, dtype=torch.float64) delta_t tensor(-0.0963, dtype=torch.float64)
6 gae_duplicate tensor(-0.1940, dtype=torch.float64) tensor(1.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5168, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
5 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(0.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0405, dtype=torch.float64) delta_t tensor(-0.0431, dtype=torch.float64)
4 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(0.8648, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0327, dtype=torch.float64) delta_t tensor(0.0065, dtype=torch.float64)
3 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-0.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2908, dtype=torch.float64) delta_t tensor(-0.0913, dtype=torch.float64)
2 gae_duplicate tensor(-0.2993, dtype=torch.float64) tensor(1.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-374.1226501464844
value loss:7.177814483642578
entropies:355.1825866699219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965836048126221 seconds
19 rew tensor(1.1837, dtype=torch.float64) delta_t tensor(0.0156, dtype=torch.float64)
19 gae_duplicate tensor(-0.1329, dtype=torch.float64) tensor(-0.2808, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0943, dtype=torch.float64) delta_t tensor(0.0859, dtype=torch.float64)
18 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-1.7027, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9919, dtype=torch.float64) delta_t tensor(0.0530, dtype=torch.float64)
17 gae_duplicate tensor(-0.0310, dtype=torch.float64) tensor(-1.2094, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9289, dtype=torch.float64) delta_t tensor(0.0109, dtype=torch.float64)
16 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-0.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7257, dtype=torch.float64) delta_t tensor(-0.1092, dtype=torch.float64)
15 gae_duplicate tensor(-0.2733, dtype=torch.float64) tensor(2.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7755, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
14 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5862, dtype=torch.float64) delta_t tensor(0.0443, dtype=torch.float64)
13 gae_duplicate tensor(-0.0428, dtype=torch.float64) tensor(-0.8705, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5834, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
12 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(0.1573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1416, dtype=torch.float64) delta_t tensor(-0.1178, dtype=torch.float64)
11 gae_duplicate tensor(-0.4397, dtype=torch.float64) tensor(2.3316, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2387, dtype=torch.float64) delta_t tensor(0.1295, dtype=torch.float64)
10 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-2.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0272, dtype=torch.float64) delta_t tensor(-0.0569, dtype=torch.float64)
9 gae_duplicate tensor(-0.3090, dtype=torch.float64) tensor(0.8793, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3981, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
8 gae_duplicate tensor(-0.3865, dtype=torch.float64) tensor(-0.8962, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0135, dtype=torch.float64) delta_t tensor(0.1776, dtype=torch.float64)
7 gae_duplicate tensor(-0.0845, dtype=torch.float64) tensor(-3.5849, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7183, dtype=torch.float64) delta_t tensor(-0.0032, dtype=torch.float64)
6 gae_duplicate tensor(-0.2774, dtype=torch.float64) tensor(-0.3944, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4103, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
5 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-0.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0195, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
4 gae_duplicate tensor(-0.5001, dtype=torch.float64) tensor(0.6993, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0010, dtype=torch.float64) delta_t tensor(0.0872, dtype=torch.float64)
3 gae_duplicate tensor(-0.1085, dtype=torch.float64) tensor(-1.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3374, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
2 gae_duplicate tensor(-0.5328, dtype=torch.float64) tensor(1.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:294.47613525390625
value loss:7.212796211242676
entropies:355.26434326171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.811378240585327 seconds
19 rew tensor(1.1968, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
19 gae_duplicate tensor(-0.0686, dtype=torch.float64) tensor(-0.3006, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8751, dtype=torch.float64) delta_t tensor(-0.1586, dtype=torch.float64)
18 gae_duplicate tensor(-1.3889, dtype=torch.float64) tensor(2.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0178, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
17 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-0.5220, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0189, dtype=torch.float64) delta_t tensor(0.0900, dtype=torch.float64)
16 gae_duplicate tensor(-0.0053, dtype=torch.float64) tensor(-1.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8391, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
15 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(0.0849, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6633, dtype=torch.float64) delta_t tensor(0.1203, dtype=torch.float64)
14 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-2.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7119, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
13 gae_duplicate tensor(-0.1522, dtype=torch.float64) tensor(-0.0428, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2173, dtype=torch.float64) delta_t tensor(-0.0615, dtype=torch.float64)
12 gae_duplicate tensor(-0.3336, dtype=torch.float64) tensor(1.2700, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5575, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
11 gae_duplicate tensor(-0.0683, dtype=torch.float64) tensor(-1.4199, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1277, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
10 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(0.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5191, dtype=torch.float64) delta_t tensor(0.1289, dtype=torch.float64)
9 gae_duplicate tensor(0.0364, dtype=torch.float64) tensor(-2.5374, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6738, dtype=torch.float64) delta_t tensor(-0.1420, dtype=torch.float64)
8 gae_duplicate tensor(-0.3425, dtype=torch.float64) tensor(2.6298, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9312, dtype=torch.float64) delta_t tensor(-0.3428, dtype=torch.float64)
7 gae_duplicate tensor(-1.7732, dtype=torch.float64) tensor(6.9638, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8920, dtype=torch.float64) delta_t tensor(-0.0213, dtype=torch.float64)
6 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(1.1221, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1378, dtype=torch.float64) delta_t tensor(0.0391, dtype=torch.float64)
5 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-0.7301, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2180, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
4 gae_duplicate tensor(-0.0090, dtype=torch.float64) tensor(-0.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6257, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
3 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(2.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0745, dtype=torch.float64) delta_t tensor(0.0073, dtype=torch.float64)
2 gae_duplicate tensor(-0.4417, dtype=torch.float64) tensor(0.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-462.7289733886719
value loss:11.3651123046875
entropies:355.31201171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.785325765609741 seconds
19 rew tensor(1.1831, dtype=torch.float64) delta_t tensor(-0.0327, dtype=torch.float64)
19 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(0.6339, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1574, dtype=torch.float64) delta_t tensor(0.1971, dtype=torch.float64)
18 gae_duplicate tensor(0.0860, dtype=torch.float64) tensor(-3.8616, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0311, dtype=torch.float64) delta_t tensor(0.0355, dtype=torch.float64)
17 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(-1.0898, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8894, dtype=torch.float64) delta_t tensor(-0.0390, dtype=torch.float64)
16 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(0.6280, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9298, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
15 gae_duplicate tensor(-0.2246, dtype=torch.float64) tensor(-0.3650, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.2235, dtype=torch.float64)
14 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(-4.3516, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7652, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
13 gae_duplicate tensor(0.0774, dtype=torch.float64) tensor(-4.0624, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1263, dtype=torch.float64) delta_t tensor(0.0442, dtype=torch.float64)
12 gae_duplicate tensor(-0.1105, dtype=torch.float64) tensor(-1.3259, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6996, dtype=torch.float64) delta_t tensor(0.0917, dtype=torch.float64)
11 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-1.9222, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2674, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
10 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(0.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5185, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
9 gae_duplicate tensor(-0.1154, dtype=torch.float64) tensor(-1.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6502, dtype=torch.float64) delta_t tensor(-0.0402, dtype=torch.float64)
8 gae_duplicate tensor(-0.2362, dtype=torch.float64) tensor(0.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7617, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
7 gae_duplicate tensor(-0.2986, dtype=torch.float64) tensor(0.0737, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8655, dtype=torch.float64) delta_t tensor(-0.0357, dtype=torch.float64)
6 gae_duplicate tensor(-0.1700, dtype=torch.float64) tensor(0.7470, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2908, dtype=torch.float64) delta_t tensor(0.1180, dtype=torch.float64)
5 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-2.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0920, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
4 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-0.0078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9303, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
3 gae_duplicate tensor(-0.0880, dtype=torch.float64) tensor(-0.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2523, dtype=torch.float64) delta_t tensor(0.0181, dtype=torch.float64)
2 gae_duplicate tensor(-0.1385, dtype=torch.float64) tensor(-0.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:837.5900268554688
value loss:4.765876770019531
entropies:355.3269958496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8183510303497314 seconds
19 rew tensor(1.2345, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
19 gae_duplicate tensor(-0.1191, dtype=torch.float64) tensor(0.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2217, dtype=torch.float64) delta_t tensor(0.1498, dtype=torch.float64)
18 gae_duplicate tensor(0.0435, dtype=torch.float64) tensor(-2.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1336, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
17 gae_duplicate tensor(-0.0481, dtype=torch.float64) tensor(-2.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7776, dtype=torch.float64) delta_t tensor(-0.1346, dtype=torch.float64)
16 gae_duplicate tensor(-1.3066, dtype=torch.float64) tensor(2.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9171, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
15 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(0.4707, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1357, dtype=torch.float64) delta_t tensor(-0.2863, dtype=torch.float64)
14 gae_duplicate tensor(-1.8869, dtype=torch.float64) tensor(5.6316, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4081, dtype=torch.float64) delta_t tensor(-0.0744, dtype=torch.float64)
13 gae_duplicate tensor(-1.1486, dtype=torch.float64) tensor(2.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4086, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
12 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-1.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3783, dtype=torch.float64) delta_t tensor(0.1051, dtype=torch.float64)
11 gae_duplicate tensor(-0.0906, dtype=torch.float64) tensor(-2.1442, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0379, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
10 gae_duplicate tensor(-0.3589, dtype=torch.float64) tensor(0.4786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3785, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
9 gae_duplicate tensor(-0.0299, dtype=torch.float64) tensor(-1.2733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5743, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
8 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(1.1972, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1873, dtype=torch.float64) delta_t tensor(-0.2069, dtype=torch.float64)
7 gae_duplicate tensor(-1.5807, dtype=torch.float64) tensor(4.4982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9550, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
6 gae_duplicate tensor(-0.2740, dtype=torch.float64) tensor(0.2992, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2450, dtype=torch.float64) delta_t tensor(0.1181, dtype=torch.float64)
5 gae_duplicate tensor(-0.1765, dtype=torch.float64) tensor(-2.2125, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1355, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
4 gae_duplicate tensor(-0.1442, dtype=torch.float64) tensor(-0.3119, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8797, dtype=torch.float64) delta_t tensor(-0.0314, dtype=torch.float64)
3 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(0.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1834, dtype=torch.float64) delta_t tensor(-0.0227, dtype=torch.float64)
2 gae_duplicate tensor(-0.4157, dtype=torch.float64) tensor(0.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-446.7452697753906
value loss:19.11676788330078
entropies:355.3543701171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.9263)
ToM Target loss= tensor(4057.8018)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.903314113616943 seconds
19 rew tensor(1.1333, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
19 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(0.7560, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1466, dtype=torch.float64) delta_t tensor(0.0933, dtype=torch.float64)
18 gae_duplicate tensor(-0.0219, dtype=torch.float64) tensor(-1.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0688, dtype=torch.float64) delta_t tensor(0.0596, dtype=torch.float64)
17 gae_duplicate tensor(-0.0342, dtype=torch.float64) tensor(-1.3131, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(0.0008, dtype=torch.float64)
16 gae_duplicate tensor(-0.0549, dtype=torch.float64) tensor(-0.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9045, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
15 gae_duplicate tensor(-0.0742, dtype=torch.float64) tensor(0.2097, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7635, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
14 gae_duplicate tensor(-0.1500, dtype=torch.float64) tensor(-0.6601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3922, dtype=torch.float64) delta_t tensor(-0.1582, dtype=torch.float64)
13 gae_duplicate tensor(-1.3935, dtype=torch.float64) tensor(3.0905, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4189, dtype=torch.float64) delta_t tensor(0.0694, dtype=torch.float64)
12 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(-1.0379, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5315, dtype=torch.float64) delta_t tensor(-0.7710, dtype=torch.float64)
11 gae_duplicate tensor(-4.4164, dtype=torch.float64) tensor(15.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0103, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
10 gae_duplicate tensor(-0.1549, dtype=torch.float64) tensor(-0.5675, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2299, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
9 gae_duplicate tensor(-0.3293, dtype=torch.float64) tensor(0.0251, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(-0.0191, dtype=torch.float64)
8 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(0.3774, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9410, dtype=torch.float64) delta_t tensor(0.0662, dtype=torch.float64)
7 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(-1.2549, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5391, dtype=torch.float64) delta_t tensor(0.1052, dtype=torch.float64)
6 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-2.2055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7209, dtype=torch.float64) delta_t tensor(-0.0199, dtype=torch.float64)
5 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(0.1544, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0347, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
4 gae_duplicate tensor(-0.2971, dtype=torch.float64) tensor(0.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1989, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
3 gae_duplicate tensor(-0.0947, dtype=torch.float64) tensor(-1.2791, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3913, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
2 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(-0.1070, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-666.1691284179688
value loss:36.963924407958984
entropies:355.34027099609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.7239789962768555 seconds
19 rew tensor(1.0942, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
19 gae_duplicate tensor(-0.0917, dtype=torch.float64) tensor(0.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0697, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
18 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-1.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0053, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
17 gae_duplicate tensor(-0.0726, dtype=torch.float64) tensor(-0.6801, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9541, dtype=torch.float64) delta_t tensor(-0.0174, dtype=torch.float64)
16 gae_duplicate tensor(-0.0830, dtype=torch.float64) tensor(0.2775, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9290, dtype=torch.float64) delta_t tensor(0.0133, dtype=torch.float64)
15 gae_duplicate tensor(-0.1487, dtype=torch.float64) tensor(-0.1842, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8265, dtype=torch.float64) delta_t tensor(0.0791, dtype=torch.float64)
14 gae_duplicate tensor(-0.0646, dtype=torch.float64) tensor(-1.6589, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7760, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
13 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-0.1592, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4312, dtype=torch.float64) delta_t tensor(0.0735, dtype=torch.float64)
12 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(-1.4377, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0151, dtype=torch.float64) delta_t tensor(-0.4001, dtype=torch.float64)
11 gae_duplicate tensor(-2.2552, dtype=torch.float64) tensor(7.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5071, dtype=torch.float64) delta_t tensor(-0.2699, dtype=torch.float64)
10 gae_duplicate tensor(-2.2012, dtype=torch.float64) tensor(5.9371, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0637, dtype=torch.float64) delta_t tensor(-0.3143, dtype=torch.float64)
9 gae_duplicate tensor(-1.8180, dtype=torch.float64) tensor(6.7588, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5752, dtype=torch.float64) delta_t tensor(0.0058, dtype=torch.float64)
8 gae_duplicate tensor(-0.2798, dtype=torch.float64) tensor(0.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4858, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
7 gae_duplicate tensor(-0.2555, dtype=torch.float64) tensor(-2.4528, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7405, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
6 gae_duplicate tensor(-0.1428, dtype=torch.float64) tensor(-1.8758, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4414, dtype=torch.float64) delta_t tensor(0.1079, dtype=torch.float64)
5 gae_duplicate tensor(-0.0173, dtype=torch.float64) tensor(-2.2896, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1156, dtype=torch.float64) delta_t tensor(-0.0444, dtype=torch.float64)
4 gae_duplicate tensor(-0.2041, dtype=torch.float64) tensor(0.6866, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9829, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
3 gae_duplicate tensor(-0.0385, dtype=torch.float64) tensor(-1.1327, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2289, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
2 gae_duplicate tensor(0.0168, dtype=torch.float64) tensor(-3.3284, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-431.7303466796875
value loss:24.1280517578125
entropies:355.2760925292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.852586269378662 seconds
19 rew tensor(1.2097, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
19 gae_duplicate tensor(-0.0934, dtype=torch.float64) tensor(0.6554, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2098, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
18 gae_duplicate tensor(0.0259, dtype=torch.float64) tensor(-2.2138, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0838, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
17 gae_duplicate tensor(-0.0418, dtype=torch.float64) tensor(-1.1798, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0573, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
16 gae_duplicate tensor(-0.0265, dtype=torch.float64) tensor(-0.9998, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
15 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(0.4964, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0089, dtype=torch.float64) delta_t tensor(-0.4233, dtype=torch.float64)
14 gae_duplicate tensor(-1.8957, dtype=torch.float64) tensor(8.1491, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5206, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
13 gae_duplicate tensor(-0.1682, dtype=torch.float64) tensor(-0.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3057, dtype=torch.float64) delta_t tensor(0.0832, dtype=torch.float64)
12 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-1.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
11 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(-1.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0769, dtype=torch.float64) delta_t tensor(-0.0539, dtype=torch.float64)
10 gae_duplicate tensor(-0.3821, dtype=torch.float64) tensor(0.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4700, dtype=torch.float64) delta_t tensor(0.0901, dtype=torch.float64)
9 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-1.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6130, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
8 gae_duplicate tensor(-0.1257, dtype=torch.float64) tensor(0.3920, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0040, dtype=torch.float64) delta_t tensor(-0.0279, dtype=torch.float64)
7 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(0.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8293, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
6 gae_duplicate tensor(-0.4298, dtype=torch.float64) tensor(-0.0141, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3688, dtype=torch.float64) delta_t tensor(-0.0260, dtype=torch.float64)
5 gae_duplicate tensor(-0.3636, dtype=torch.float64) tensor(0.5073, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0150, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
4 gae_duplicate tensor(-0.1067, dtype=torch.float64) tensor(-0.6286, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0665, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
3 gae_duplicate tensor(-0.1840, dtype=torch.float64) tensor(-0.4410, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3717, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
2 gae_duplicate tensor(-0.1809, dtype=torch.float64) tensor(-0.4928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-84.5521240234375
value loss:10.76573657989502
entropies:355.1722106933594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.889106035232544 seconds
19 rew tensor(1.1588, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
19 gae_duplicate tensor(-0.0698, dtype=torch.float64) tensor(0.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
18 gae_duplicate tensor(0.0223, dtype=torch.float64) tensor(-2.5698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9935, dtype=torch.float64) delta_t tensor(0.0415, dtype=torch.float64)
17 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-1.1002, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9546, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
16 gae_duplicate tensor(-0.1079, dtype=torch.float64) tensor(-0.0653, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
15 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-1.2256, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1767, dtype=torch.float64) delta_t tensor(-0.3971, dtype=torch.float64)
14 gae_duplicate tensor(-1.3023, dtype=torch.float64) tensor(7.9094, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6622, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
13 gae_duplicate tensor(0.0053, dtype=torch.float64) tensor(-2.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3289, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
12 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-0.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4836, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
11 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-1.2115, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0277, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
10 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(0.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
9 gae_duplicate tensor(-0.1876, dtype=torch.float64) tensor(-0.4433, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5502, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
8 gae_duplicate tensor(-0.1299, dtype=torch.float64) tensor(-0.9263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2277, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
7 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-0.7838, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7551, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
6 gae_duplicate tensor(-0.1670, dtype=torch.float64) tensor(-0.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2356, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
5 gae_duplicate tensor(0.0445, dtype=torch.float64) tensor(-1.5869, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2967, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
4 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(-0.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5725, dtype=torch.float64) delta_t tensor(0.0651, dtype=torch.float64)
3 gae_duplicate tensor(0.0078, dtype=torch.float64) tensor(-1.2866, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0602, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
2 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-0.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:240.692626953125
value loss:7.455197334289551
entropies:355.126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.701648950576782 seconds
19 rew tensor(1.2098, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
19 gae_duplicate tensor(-0.1451, dtype=torch.float64) tensor(0.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1582, dtype=torch.float64) delta_t tensor(0.1053, dtype=torch.float64)
18 gae_duplicate tensor(0.0313, dtype=torch.float64) tensor(-1.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0951, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
17 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-2.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0311, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
16 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-1.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9418, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
15 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-3.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3532, dtype=torch.float64) delta_t tensor(-0.0351, dtype=torch.float64)
14 gae_duplicate tensor(-0.9552, dtype=torch.float64) tensor(0.3807, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5603, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
13 gae_duplicate tensor(-0.1482, dtype=torch.float64) tensor(-1.8659, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3171, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
12 gae_duplicate tensor(-0.0692, dtype=torch.float64) tensor(-3.2432, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4570, dtype=torch.float64) delta_t tensor(0.1003, dtype=torch.float64)
11 gae_duplicate tensor(-0.0636, dtype=torch.float64) tensor(-2.3595, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0901, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
10 gae_duplicate tensor(-0.0776, dtype=torch.float64) tensor(-1.6771, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.0242, dtype=torch.float64)
9 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(-0.6083, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6251, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
8 gae_duplicate tensor(-0.2983, dtype=torch.float64) tensor(2.4064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0488, dtype=torch.float64) delta_t tensor(0.2013, dtype=torch.float64)
7 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-3.7972, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7274, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
6 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(0.9167, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5966, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
5 gae_duplicate tensor(-0.2936, dtype=torch.float64) tensor(-1.8474, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2413, dtype=torch.float64) delta_t tensor(0.0166, dtype=torch.float64)
4 gae_duplicate tensor(-0.0156, dtype=torch.float64) tensor(-0.5376, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4311, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
3 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(0.4343, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5854, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
2 gae_duplicate tensor(-0.1597, dtype=torch.float64) tensor(-1.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1075.5631103515625
value loss:7.177958965301514
entropies:355.0595397949219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.1719)
ToM Target loss= tensor(4060.2034)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.02117395401001 seconds
19 rew tensor(1.1835, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
19 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(1.7198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1834, dtype=torch.float64) delta_t tensor(0.0728, dtype=torch.float64)
18 gae_duplicate tensor(0.0117, dtype=torch.float64) tensor(-1.2664, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8802, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
17 gae_duplicate tensor(-1.3280, dtype=torch.float64) tensor(3.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1331, dtype=torch.float64) delta_t tensor(0.1086, dtype=torch.float64)
16 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-1.8011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7658, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
15 gae_duplicate tensor(-1.0743, dtype=torch.float64) tensor(-0.1291, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3677, dtype=torch.float64) delta_t tensor(-0.1410, dtype=torch.float64)
14 gae_duplicate tensor(-0.6712, dtype=torch.float64) tensor(2.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6607, dtype=torch.float64) delta_t tensor(0.2182, dtype=torch.float64)
13 gae_duplicate tensor(-0.0596, dtype=torch.float64) tensor(-4.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4574, dtype=torch.float64) delta_t tensor(0.2498, dtype=torch.float64)
12 gae_duplicate tensor(0.0061, dtype=torch.float64) tensor(-5.4271, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2799, dtype=torch.float64) delta_t tensor(-0.6069, dtype=torch.float64)
11 gae_duplicate tensor(-4.3091, dtype=torch.float64) tensor(12.1080, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1151, dtype=torch.float64) delta_t tensor(0.2679, dtype=torch.float64)
10 gae_duplicate tensor(-0.1342, dtype=torch.float64) tensor(-4.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4830, dtype=torch.float64) delta_t tensor(0.0626, dtype=torch.float64)
9 gae_duplicate tensor(-0.1148, dtype=torch.float64) tensor(-1.7293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6124, dtype=torch.float64) delta_t tensor(-0.0481, dtype=torch.float64)
8 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(0.7547, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.5532, dtype=torch.float64) delta_t tensor(-1.1703, dtype=torch.float64)
7 gae_duplicate tensor(-5.8012, dtype=torch.float64) tensor(23.2027, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9827, dtype=torch.float64) delta_t tensor(-0.1620, dtype=torch.float64)
6 gae_duplicate tensor(-0.7541, dtype=torch.float64) tensor(5.5772, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4156, dtype=torch.float64) delta_t tensor(0.1537, dtype=torch.float64)
5 gae_duplicate tensor(-0.2515, dtype=torch.float64) tensor(-2.4712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0853, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
4 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(0.0601, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4001, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
3 gae_duplicate tensor(-0.2917, dtype=torch.float64) tensor(1.3438, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4167, dtype=torch.float64) delta_t tensor(-0.0258, dtype=torch.float64)
2 gae_duplicate tensor(-0.2749, dtype=torch.float64) tensor(0.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1756.048095703125
value loss:98.3100814819336
entropies:355.01043701171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.777904987335205 seconds
19 rew tensor(1.2087, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
19 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(1.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1831, dtype=torch.float64) delta_t tensor(0.0953, dtype=torch.float64)
18 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-1.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1448, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
17 gae_duplicate tensor(0.0008, dtype=torch.float64) tensor(-2.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9289, dtype=torch.float64) delta_t tensor(-0.0634, dtype=torch.float64)
16 gae_duplicate tensor(-0.1545, dtype=torch.float64) tensor(1.0388, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9422, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
15 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(0.4949, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4481, dtype=torch.float64) delta_t tensor(-0.1403, dtype=torch.float64)
14 gae_duplicate tensor(-1.0618, dtype=torch.float64) tensor(3.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2609, dtype=torch.float64) delta_t tensor(-0.2598, dtype=torch.float64)
13 gae_duplicate tensor(-2.0978, dtype=torch.float64) tensor(5.8530, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0288, dtype=torch.float64) delta_t tensor(-0.0943, dtype=torch.float64)
12 gae_duplicate tensor(-0.4465, dtype=torch.float64) tensor(2.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6098, dtype=torch.float64) delta_t tensor(0.0995, dtype=torch.float64)
11 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-1.7724, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1537, dtype=torch.float64) delta_t tensor(-0.0265, dtype=torch.float64)
10 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(0.3889, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4460, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
9 gae_duplicate tensor(-0.1021, dtype=torch.float64) tensor(-0.8531, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6002, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
8 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-1.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7971, dtype=torch.float64) delta_t tensor(-0.1201, dtype=torch.float64)
7 gae_duplicate tensor(-0.5185, dtype=torch.float64) tensor(2.2136, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8309, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
6 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2859, dtype=torch.float64) delta_t tensor(0.0875, dtype=torch.float64)
5 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-1.7139, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0937, dtype=torch.float64) delta_t tensor(-0.0359, dtype=torch.float64)
4 gae_duplicate tensor(-0.1513, dtype=torch.float64) tensor(0.5136, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8636, dtype=torch.float64) delta_t tensor(0.0462, dtype=torch.float64)
3 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-0.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2373, dtype=torch.float64) delta_t tensor(-0.0677, dtype=torch.float64)
2 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(1.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-543.1629028320312
value loss:11.537909507751465
entropies:354.8909912109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.325740098953247 seconds
19 rew tensor(1.1830, dtype=torch.float64) delta_t tensor(-0.0140, dtype=torch.float64)
19 gae_duplicate tensor(-0.1282, dtype=torch.float64) tensor(0.2585, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1071, dtype=torch.float64) delta_t tensor(0.0316, dtype=torch.float64)
18 gae_duplicate tensor(-0.0075, dtype=torch.float64) tensor(-0.5872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0822, dtype=torch.float64) delta_t tensor(0.0322, dtype=torch.float64)
17 gae_duplicate tensor(-0.0069, dtype=torch.float64) tensor(-0.6666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0182, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
16 gae_duplicate tensor(-0.0576, dtype=torch.float64) tensor(-0.5343, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
15 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(0.0126, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8525, dtype=torch.float64) delta_t tensor(0.0793, dtype=torch.float64)
14 gae_duplicate tensor(-0.1767, dtype=torch.float64) tensor(-1.5117, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0207, dtype=torch.float64) delta_t tensor(-0.3455, dtype=torch.float64)
13 gae_duplicate tensor(-2.0957, dtype=torch.float64) tensor(7.1433, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1991, dtype=torch.float64) delta_t tensor(-0.1046, dtype=torch.float64)
12 gae_duplicate tensor(-0.4414, dtype=torch.float64) tensor(2.6826, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(0.0010, dtype=torch.float64)
11 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(0.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1638, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
10 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(-0.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
9 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(-1.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4496, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
8 gae_duplicate tensor(-0.1564, dtype=torch.float64) tensor(1.0570, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0923, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
7 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(-1.6439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6026, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
6 gae_duplicate tensor(-0.0214, dtype=torch.float64) tensor(-2.5327, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6923, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
5 gae_duplicate tensor(-0.2154, dtype=torch.float64) tensor(0.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1368, dtype=torch.float64) delta_t tensor(0.0162, dtype=torch.float64)
4 gae_duplicate tensor(-0.1370, dtype=torch.float64) tensor(-0.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2858, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
3 gae_duplicate tensor(-0.0802, dtype=torch.float64) tensor(-1.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4935, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
2 gae_duplicate tensor(-0.2701, dtype=torch.float64) tensor(0.4294, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-195.82785034179688
value loss:9.638545036315918
entropies:354.7107238769531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.048675060272217 seconds
19 rew tensor(1.1321, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
19 gae_duplicate tensor(-0.1571, dtype=torch.float64) tensor(1.6092, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1190, dtype=torch.float64) delta_t tensor(0.0344, dtype=torch.float64)
18 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(-0.5645, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1191, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
17 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-1.8425, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0935, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
16 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-2.9609, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8269, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
15 gae_duplicate tensor(-0.1423, dtype=torch.float64) tensor(-0.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3217, dtype=torch.float64) delta_t tensor(-0.3105, dtype=torch.float64)
14 gae_duplicate tensor(-2.1934, dtype=torch.float64) tensor(6.5715, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(-0.2205, dtype=torch.float64)
13 gae_duplicate tensor(-1.4785, dtype=torch.float64) tensor(4.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.0227, dtype=torch.float64)
12 gae_duplicate tensor(-0.2022, dtype=torch.float64) tensor(-0.0423, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2542, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
11 gae_duplicate tensor(-0.2506, dtype=torch.float64) tensor(0.9059, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1765, dtype=torch.float64) delta_t tensor(0.0661, dtype=torch.float64)
10 gae_duplicate tensor(-0.0753, dtype=torch.float64) tensor(-1.2615, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1010, dtype=torch.float64) delta_t tensor(0.0663, dtype=torch.float64)
9 gae_duplicate tensor(-0.0247, dtype=torch.float64) tensor(-1.4657, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3199, dtype=torch.float64) delta_t tensor(0.0196, dtype=torch.float64)
8 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(-0.4785, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1070, dtype=torch.float64) delta_t tensor(-0.0058, dtype=torch.float64)
7 gae_duplicate tensor(-0.1865, dtype=torch.float64) tensor(0.0690, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4344, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
6 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-1.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7456, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
5 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(1.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1628, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
4 gae_duplicate tensor(-0.1199, dtype=torch.float64) tensor(-1.4570, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1966, dtype=torch.float64) delta_t tensor(-0.0440, dtype=torch.float64)
3 gae_duplicate tensor(-0.2585, dtype=torch.float64) tensor(0.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5323, dtype=torch.float64) delta_t tensor(-0.0236, dtype=torch.float64)
2 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(0.4439, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-310.5658874511719
value loss:14.427133560180664
entropies:354.4519958496094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.615722894668579 seconds
19 rew tensor(1.1712, dtype=torch.float64) delta_t tensor(-0.0537, dtype=torch.float64)
19 gae_duplicate tensor(-0.1371, dtype=torch.float64) tensor(1.0317, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1584, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
18 gae_duplicate tensor(-0.0055, dtype=torch.float64) tensor(-1.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
17 gae_duplicate tensor(-0.0983, dtype=torch.float64) tensor(0.3990, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
16 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(0.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4412, dtype=torch.float64) delta_t tensor(-0.4084, dtype=torch.float64)
15 gae_duplicate tensor(-2.8408, dtype=torch.float64) tensor(7.4488, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4042, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
14 gae_duplicate tensor(-0.7700, dtype=torch.float64) tensor(1.0769, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6481, dtype=torch.float64) delta_t tensor(0.1713, dtype=torch.float64)
13 gae_duplicate tensor(-0.1094, dtype=torch.float64) tensor(-3.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1771, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
12 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-2.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6357, dtype=torch.float64) delta_t tensor(0.0787, dtype=torch.float64)
11 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-1.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1798, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
10 gae_duplicate tensor(-0.1784, dtype=torch.float64) tensor(0.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6233, dtype=torch.float64) delta_t tensor(0.0769, dtype=torch.float64)
9 gae_duplicate tensor(-0.0096, dtype=torch.float64) tensor(-1.4677, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7777, dtype=torch.float64) delta_t tensor(-0.0689, dtype=torch.float64)
8 gae_duplicate tensor(-0.1519, dtype=torch.float64) tensor(1.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8126, dtype=torch.float64) delta_t tensor(-0.3551, dtype=torch.float64)
7 gae_duplicate tensor(-1.7194, dtype=torch.float64) tensor(6.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9068, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
6 gae_duplicate tensor(-0.3427, dtype=torch.float64) tensor(1.2499, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1621, dtype=torch.float64) delta_t tensor(-7.0087e-05, dtype=torch.float64)
5 gae_duplicate tensor(-0.1131, dtype=torch.float64) tensor(0.0704, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1900, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
4 gae_duplicate tensor(-0.1262, dtype=torch.float64) tensor(-0.3112, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7451, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
3 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(1.4630, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1539, dtype=torch.float64) delta_t tensor(0.0942, dtype=torch.float64)
2 gae_duplicate tensor(-0.0476, dtype=torch.float64) tensor(-1.6615, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-617.1383666992188
value loss:21.012928009033203
entropies:354.2288818359375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.5547)
ToM Target loss= tensor(4058.6218)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.693583965301514 seconds
19 rew tensor(1.1444, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
19 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(0.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0814, dtype=torch.float64) delta_t tensor(0.0411, dtype=torch.float64)
18 gae_duplicate tensor(-0.0445, dtype=torch.float64) tensor(-0.7812, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0187, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
17 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(-0.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0178, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
16 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-0.8133, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7631, dtype=torch.float64) delta_t tensor(-0.0741, dtype=torch.float64)
15 gae_duplicate tensor(-0.1742, dtype=torch.float64) tensor(1.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7508, dtype=torch.float64) delta_t tensor(0.0102, dtype=torch.float64)
14 gae_duplicate tensor(-0.1240, dtype=torch.float64) tensor(-0.0468, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4834, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
13 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-0.8915, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
12 gae_duplicate tensor(-0.1789, dtype=torch.float64) tensor(-0.1016, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1000, dtype=torch.float64) delta_t tensor(-0.0261, dtype=torch.float64)
11 gae_duplicate tensor(-0.2078, dtype=torch.float64) tensor(0.5362, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(0.0715, dtype=torch.float64)
10 gae_duplicate tensor(-0.1636, dtype=torch.float64) tensor(-1.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1613, dtype=torch.float64) delta_t tensor(0.0781, dtype=torch.float64)
9 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-1.7255, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4450, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
8 gae_duplicate tensor(-0.1630, dtype=torch.float64) tensor(1.2605, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8738, dtype=torch.float64) delta_t tensor(0.0586, dtype=torch.float64)
7 gae_duplicate tensor(-0.2026, dtype=torch.float64) tensor(-1.3020, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5851, dtype=torch.float64) delta_t tensor(0.0342, dtype=torch.float64)
6 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(-0.7658, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5720, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
5 gae_duplicate tensor(-0.2253, dtype=torch.float64) tensor(1.5427, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0105, dtype=torch.float64) delta_t tensor(0.0474, dtype=torch.float64)
4 gae_duplicate tensor(-0.1008, dtype=torch.float64) tensor(-0.7503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0001, dtype=torch.float64) delta_t tensor(-0.0715, dtype=torch.float64)
3 gae_duplicate tensor(-0.1881, dtype=torch.float64) tensor(1.4161, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3336, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
2 gae_duplicate tensor(-0.3033, dtype=torch.float64) tensor(0.5408, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-11.600054740905762
value loss:3.395913600921631
entropies:354.1531066894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.805024147033691 seconds
19 rew tensor(1.1830, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
19 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(1.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1576, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
18 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-1.2404, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0302, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
17 gae_duplicate tensor(-0.0882, dtype=torch.float64) tensor(-0.4106, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9787, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
16 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-0.2118, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9277, dtype=torch.float64) delta_t tensor(-0.0118, dtype=torch.float64)
15 gae_duplicate tensor(-0.0645, dtype=torch.float64) tensor(0.2174, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7494, dtype=torch.float64) delta_t tensor(0.0972, dtype=torch.float64)
14 gae_duplicate tensor(-0.0745, dtype=torch.float64) tensor(-1.8976, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3204, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
13 gae_duplicate tensor(-1.3109, dtype=torch.float64) tensor(0.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1491, dtype=torch.float64) delta_t tensor(-0.4115, dtype=torch.float64)
12 gae_duplicate tensor(-2.9582, dtype=torch.float64) tensor(7.7117, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0396, dtype=torch.float64) delta_t tensor(-0.1632, dtype=torch.float64)
11 gae_duplicate tensor(-1.3082, dtype=torch.float64) tensor(3.7129, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0249, dtype=torch.float64) delta_t tensor(0.2718, dtype=torch.float64)
10 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-5.0588, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3288, dtype=torch.float64) delta_t tensor(0.0864, dtype=torch.float64)
9 gae_duplicate tensor(-0.0328, dtype=torch.float64) tensor(-2.1332, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5498, dtype=torch.float64) delta_t tensor(-0.0052, dtype=torch.float64)
8 gae_duplicate tensor(-0.1722, dtype=torch.float64) tensor(-0.1668, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6894, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
7 gae_duplicate tensor(-0.1541, dtype=torch.float64) tensor(-2.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7271, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
6 gae_duplicate tensor(-0.2922, dtype=torch.float64) tensor(1.4744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4921, dtype=torch.float64) delta_t tensor(-0.0807, dtype=torch.float64)
5 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(1.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0902, dtype=torch.float64) delta_t tensor(0.0140, dtype=torch.float64)
4 gae_duplicate tensor(-0.1303, dtype=torch.float64) tensor(-0.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0207, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
3 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(1.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2284, dtype=torch.float64) delta_t tensor(0.0117, dtype=torch.float64)
2 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-391.3387451171875
value loss:25.938093185424805
entropies:354.0914001464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.079176187515259 seconds
19 rew tensor(1.2094, dtype=torch.float64) delta_t tensor(-0.0640, dtype=torch.float64)
19 gae_duplicate tensor(-0.1909, dtype=torch.float64) tensor(1.3184, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1204, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
18 gae_duplicate tensor(-0.0558, dtype=torch.float64) tensor(-0.5994, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0569, dtype=torch.float64) delta_t tensor(0.0525, dtype=torch.float64)
17 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(-1.0530, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9294, dtype=torch.float64) delta_t tensor(-0.0381, dtype=torch.float64)
16 gae_duplicate tensor(-0.0820, dtype=torch.float64) tensor(0.6498, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8778, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
15 gae_duplicate tensor(-0.2073, dtype=torch.float64) tensor(0.5302, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8019, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
14 gae_duplicate tensor(-0.2027, dtype=torch.float64) tensor(-4.1119, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5595, dtype=torch.float64) delta_t tensor(0.0992, dtype=torch.float64)
13 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(-2.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2100, dtype=torch.float64) delta_t tensor(-0.2789, dtype=torch.float64)
12 gae_duplicate tensor(-1.5581, dtype=torch.float64) tensor(5.6890, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3803, dtype=torch.float64) delta_t tensor(0.1034, dtype=torch.float64)
11 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-1.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0008, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
10 gae_duplicate tensor(-0.0980, dtype=torch.float64) tensor(-1.8230, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4314, dtype=torch.float64) delta_t tensor(0.0939, dtype=torch.float64)
9 gae_duplicate tensor(-0.0931, dtype=torch.float64) tensor(-2.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6125, dtype=torch.float64) delta_t tensor(-0.0267, dtype=torch.float64)
8 gae_duplicate tensor(-0.2775, dtype=torch.float64) tensor(0.2694, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9972, dtype=torch.float64) delta_t tensor(0.0630, dtype=torch.float64)
7 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(-1.2005, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7408, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
6 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-0.8334, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5941, dtype=torch.float64) delta_t tensor(0.0973, dtype=torch.float64)
5 gae_duplicate tensor(-0.0784, dtype=torch.float64) tensor(-1.9681, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2171, dtype=torch.float64) delta_t tensor(0.0501, dtype=torch.float64)
4 gae_duplicate tensor(-0.0699, dtype=torch.float64) tensor(-1.2036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4312, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
3 gae_duplicate tensor(-0.2006, dtype=torch.float64) tensor(-0.9019, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5483, dtype=torch.float64) delta_t tensor(0.0122, dtype=torch.float64)
2 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(-0.2150, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:532.873779296875
value loss:8.711660385131836
entropies:354.1546325683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.695039987564087 seconds
19 rew tensor(1.1576, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
19 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(1.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1448, dtype=torch.float64) delta_t tensor(0.0331, dtype=torch.float64)
18 gae_duplicate tensor(-0.0595, dtype=torch.float64) tensor(-0.4807, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0931, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
17 gae_duplicate tensor(-0.1081, dtype=torch.float64) tensor(-1.4404, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9912, dtype=torch.float64) delta_t tensor(0.0286, dtype=torch.float64)
16 gae_duplicate tensor(-0.0417, dtype=torch.float64) tensor(-0.7150, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8773, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
15 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-0.9307, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4466, dtype=torch.float64) delta_t tensor(-0.3135, dtype=torch.float64)
14 gae_duplicate tensor(-1.5370, dtype=torch.float64) tensor(6.1740, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2222, dtype=torch.float64) delta_t tensor(-0.5467, dtype=torch.float64)
13 gae_duplicate tensor(-3.9060, dtype=torch.float64) tensor(11.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.1737, dtype=torch.float64)
12 gae_duplicate tensor(-0.0740, dtype=torch.float64) tensor(-2.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2674, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
11 gae_duplicate tensor(-0.2007, dtype=torch.float64) tensor(-0.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2137, dtype=torch.float64) delta_t tensor(0.0871, dtype=torch.float64)
10 gae_duplicate tensor(-0.2072, dtype=torch.float64) tensor(-1.7610, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
9 gae_duplicate tensor(0.0285, dtype=torch.float64) tensor(-1.6657, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4993, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
8 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9411, dtype=torch.float64) delta_t tensor(0.1215, dtype=torch.float64)
7 gae_duplicate tensor(-0.1398, dtype=torch.float64) tensor(-2.1639, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5756, dtype=torch.float64) delta_t tensor(0.0641, dtype=torch.float64)
6 gae_duplicate tensor(0.0067, dtype=torch.float64) tensor(-1.4425, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6432, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
5 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(0.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(0.0736, dtype=torch.float64)
4 gae_duplicate tensor(-0.0902, dtype=torch.float64) tensor(-1.2630, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1971, dtype=torch.float64) delta_t tensor(-0.1312, dtype=torch.float64)
3 gae_duplicate tensor(-0.2884, dtype=torch.float64) tensor(2.3680, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4177, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
2 gae_duplicate tensor(-0.2367, dtype=torch.float64) tensor(-1.0300, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-507.9998779296875
value loss:30.79108428955078
entropies:354.18988037109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.007428169250488 seconds
19 rew tensor(1.1707, dtype=torch.float64) delta_t tensor(-0.0690, dtype=torch.float64)
19 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(1.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0815, dtype=torch.float64) delta_t tensor(0.0709, dtype=torch.float64)
18 gae_duplicate tensor(-0.0397, dtype=torch.float64) tensor(-1.2834, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7355, dtype=torch.float64) delta_t tensor(-0.1849, dtype=torch.float64)
17 gae_duplicate tensor(-1.2852, dtype=torch.float64) tensor(3.8385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9298, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
16 gae_duplicate tensor(-0.1481, dtype=torch.float64) tensor(0.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7886, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
15 gae_duplicate tensor(-0.2064, dtype=torch.float64) tensor(1.7905, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7000, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
14 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-1.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7631, dtype=torch.float64) delta_t tensor(0.1157, dtype=torch.float64)
13 gae_duplicate tensor(-0.0684, dtype=torch.float64) tensor(-2.4613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2535, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
12 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-0.0525, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(-0.0210, dtype=torch.float64)
11 gae_duplicate tensor(-0.1920, dtype=torch.float64) tensor(0.4456, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0526, dtype=torch.float64) delta_t tensor(-0.0311, dtype=torch.float64)
10 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(0.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2416, dtype=torch.float64) delta_t tensor(0.0075, dtype=torch.float64)
9 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(-0.0857, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3958, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
8 gae_duplicate tensor(-0.0407, dtype=torch.float64) tensor(-1.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7676, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
7 gae_duplicate tensor(-0.2143, dtype=torch.float64) tensor(0.7011, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4849, dtype=torch.float64) delta_t tensor(0.0643, dtype=torch.float64)
6 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-1.2470, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6203, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
5 gae_duplicate tensor(-0.2368, dtype=torch.float64) tensor(1.4230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0388, dtype=torch.float64) delta_t tensor(-0.0319, dtype=torch.float64)
4 gae_duplicate tensor(-0.1595, dtype=torch.float64) tensor(0.8321, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9458, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
3 gae_duplicate tensor(-0.1356, dtype=torch.float64) tensor(-0.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3050, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
2 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(1.8514, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-389.6002502441406
value loss:4.950319290161133
entropies:354.0950927734375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.7761)
ToM Target loss= tensor(4068.4084)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt