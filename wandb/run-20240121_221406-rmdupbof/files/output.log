obs <crafter.objects.Shelter object at 0x1697dc760> [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x124585cd0> [42.  0.  0.  0. 43.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1697e26a0> [ 9.  0.  0.  0.  9.  0.  0.  0. 13.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x1697dc760> [39.  0.  0.  0. 39.  0.  0.  0. 18.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x124585cd0> [40.  0.  0.  0. 36.  0.  0.  0.  5.  0.  0.  0.]
obs <crafter.objects.Station object at 0x1697e26a0> [ 9.  0.  0.  0.  9.  0.  0.  0. 15.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.003634929656982422 seconds
19 rew tensor(1.2499, dtype=torch.float64) delta_t tensor(1.1720, dtype=torch.float64)
19 gae_duplicate tensor(1.0311, dtype=torch.float64) tensor(-23.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.3741, dtype=torch.float64) delta_t tensor(1.3034, dtype=torch.float64)
18 gae_duplicate tensor(1.2059, dtype=torch.float64) tensor(-28.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.3383, dtype=torch.float64) delta_t tensor(1.2828, dtype=torch.float64)
17 gae_duplicate tensor(1.2818, dtype=torch.float64) tensor(-27.9266, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.2838, dtype=torch.float64) delta_t tensor(1.0906, dtype=torch.float64)
16 gae_duplicate tensor(1.0204, dtype=torch.float64) tensor(-23.3834, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.3333, dtype=torch.float64) delta_t tensor(1.2358, dtype=torch.float64)
15 gae_duplicate tensor(0.9938, dtype=torch.float64) tensor(-26.3060, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8529, dtype=torch.float64) delta_t tensor(0.7317, dtype=torch.float64)
14 gae_duplicate tensor(-0.3954, dtype=torch.float64) tensor(-16.8584, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.3498, dtype=torch.float64) delta_t tensor(1.2979, dtype=torch.float64)
13 gae_duplicate tensor(0.9901, dtype=torch.float64) tensor(-26.8502, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9160, dtype=torch.float64) delta_t tensor(0.8011, dtype=torch.float64)
12 gae_duplicate tensor(0.4518, dtype=torch.float64) tensor(-18.7902, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9947, dtype=torch.float64) delta_t tensor(0.9253, dtype=torch.float64)
11 gae_duplicate tensor(-1.0938, dtype=torch.float64) tensor(-20.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7788, dtype=torch.float64) delta_t tensor(0.7302, dtype=torch.float64)
10 gae_duplicate tensor(0.2576, dtype=torch.float64) tensor(-16.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4587, dtype=torch.float64) delta_t tensor(1.4201, dtype=torch.float64)
9 gae_duplicate tensor(0.8224, dtype=torch.float64) tensor(-29.2604, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0661, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
8 gae_duplicate tensor(-0.7767, dtype=torch.float64) tensor(-1.3615, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(0.7211, dtype=torch.float64)
7 gae_duplicate tensor(-0.5802, dtype=torch.float64) tensor(-14.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.0663, dtype=torch.float64) delta_t tensor(-0.0984, dtype=torch.float64)
6 gae_duplicate tensor(-0.6090, dtype=torch.float64) tensor(0.5397, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.6268, dtype=torch.float64) delta_t tensor(-0.6048, dtype=torch.float64)
5 gae_duplicate tensor(-1.0448, dtype=torch.float64) tensor(12.0462, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
4 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-9.9106, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.1875, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
3 gae_duplicate tensor(-0.6186, dtype=torch.float64) tensor(-3.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(1.0730, dtype=torch.float64) delta_t tensor(1.0749, dtype=torch.float64)
2 gae_duplicate tensor(1.0588, dtype=torch.float64) tensor(-21.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:15855.4521484375
value loss:202.2161865234375
entropies:354.45269775390625
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.840303897857666 seconds
19 rew tensor(1.2343, dtype=torch.float64) delta_t tensor(1.1460, dtype=torch.float64)
19 gae_duplicate tensor(0.9710, dtype=torch.float64) tensor(-21.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2922, dtype=torch.float64) delta_t tensor(1.1940, dtype=torch.float64)
18 gae_duplicate tensor(1.0970, dtype=torch.float64) tensor(-26.6553, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.3031, dtype=torch.float64) delta_t tensor(1.1657, dtype=torch.float64)
17 gae_duplicate tensor(1.1895, dtype=torch.float64) tensor(-24.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1588, dtype=torch.float64) delta_t tensor(0.9432, dtype=torch.float64)
16 gae_duplicate tensor(0.8021, dtype=torch.float64) tensor(-20.5338, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1731, dtype=torch.float64) delta_t tensor(1.0446, dtype=torch.float64)
15 gae_duplicate tensor(0.7817, dtype=torch.float64) tensor(-22.3054, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4824, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
14 gae_duplicate tensor(-0.8231, dtype=torch.float64) tensor(-9.6472, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9466, dtype=torch.float64) delta_t tensor(0.9065, dtype=torch.float64)
13 gae_duplicate tensor(0.5323, dtype=torch.float64) tensor(-18.6894, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4282, dtype=torch.float64) delta_t tensor(0.2835, dtype=torch.float64)
12 gae_duplicate tensor(-0.0402, dtype=torch.float64) tensor(-7.7000, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8705, dtype=torch.float64) delta_t tensor(0.8363, dtype=torch.float64)
11 gae_duplicate tensor(0.2602, dtype=torch.float64) tensor(-17.1770, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0632, dtype=torch.float64) delta_t tensor(0.0475, dtype=torch.float64)
10 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(-2.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6765, dtype=torch.float64) delta_t tensor(0.6535, dtype=torch.float64)
9 gae_duplicate tensor(-0.0045, dtype=torch.float64) tensor(-13.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4199, dtype=torch.float64) delta_t tensor(-0.5189, dtype=torch.float64)
8 gae_duplicate tensor(-0.7529, dtype=torch.float64) tensor(9.1897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3964, dtype=torch.float64) delta_t tensor(-0.4349, dtype=torch.float64)
7 gae_duplicate tensor(-1.2934, dtype=torch.float64) tensor(8.8030, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6897, dtype=torch.float64) delta_t tensor(-0.7244, dtype=torch.float64)
6 gae_duplicate tensor(-1.4786, dtype=torch.float64) tensor(15.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0392, dtype=torch.float64) delta_t tensor(-1.0257, dtype=torch.float64)
5 gae_duplicate tensor(-1.4935, dtype=torch.float64) tensor(21.0253, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0356, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
4 gae_duplicate tensor(-1.1846, dtype=torch.float64) tensor(1.7733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7468, dtype=torch.float64) delta_t tensor(-0.8228, dtype=torch.float64)
3 gae_duplicate tensor(-1.7417, dtype=torch.float64) tensor(16.2438, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2818, dtype=torch.float64) delta_t tensor(0.2990, dtype=torch.float64)
2 gae_duplicate tensor(-0.9012, dtype=torch.float64) tensor(-4.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6247.548828125
value loss:143.0915985107422
entropies:353.5246276855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.144720792770386 seconds
19 rew tensor(1.0022, dtype=torch.float64) delta_t tensor(0.9249, dtype=torch.float64)
19 gae_duplicate tensor(-0.4351, dtype=torch.float64) tensor(-17.2179, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2905, dtype=torch.float64) delta_t tensor(1.1747, dtype=torch.float64)
18 gae_duplicate tensor(0.9025, dtype=torch.float64) tensor(-25.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2971, dtype=torch.float64) delta_t tensor(1.2036, dtype=torch.float64)
17 gae_duplicate tensor(1.1369, dtype=torch.float64) tensor(-24.9680, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1347, dtype=torch.float64) delta_t tensor(0.9252, dtype=torch.float64)
16 gae_duplicate tensor(0.8251, dtype=torch.float64) tensor(-20.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.8042, dtype=torch.float64)
15 gae_duplicate tensor(0.6745, dtype=torch.float64) tensor(-17.2586, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1916, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
14 gae_duplicate tensor(-0.8955, dtype=torch.float64) tensor(-3.9162, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(0.7045, dtype=torch.float64)
13 gae_duplicate tensor(0.4073, dtype=torch.float64) tensor(-13.9240, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4472, dtype=torch.float64) delta_t tensor(0.3376, dtype=torch.float64)
12 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-8.3403, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3951, dtype=torch.float64) delta_t tensor(0.3150, dtype=torch.float64)
11 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-6.7282, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1661, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(-0.3958, dtype=torch.float64) tensor(-2.7168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4536, dtype=torch.float64) delta_t tensor(0.4072, dtype=torch.float64)
9 gae_duplicate tensor(-0.3301, dtype=torch.float64) tensor(-8.6226, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5751, dtype=torch.float64) delta_t tensor(-0.7002, dtype=torch.float64)
8 gae_duplicate tensor(-1.1011, dtype=torch.float64) tensor(13.4335, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1620, dtype=torch.float64) delta_t tensor(-0.2402, dtype=torch.float64)
7 gae_duplicate tensor(-1.6726, dtype=torch.float64) tensor(5.5059, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7473, dtype=torch.float64) delta_t tensor(-0.8253, dtype=torch.float64)
6 gae_duplicate tensor(-1.3845, dtype=torch.float64) tensor(15.9910, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1465, dtype=torch.float64) delta_t tensor(-1.1333, dtype=torch.float64)
5 gae_duplicate tensor(-2.0320, dtype=torch.float64) tensor(22.9513, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3557, dtype=torch.float64) delta_t tensor(-0.3091, dtype=torch.float64)
4 gae_duplicate tensor(-1.0933, dtype=torch.float64) tensor(8.8863, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6489, dtype=torch.float64) delta_t tensor(-0.7122, dtype=torch.float64)
3 gae_duplicate tensor(-1.8990, dtype=torch.float64) tensor(15.8048, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0273, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
2 gae_duplicate tensor(-0.5760, dtype=torch.float64) tensor(0.8253, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3494.060791015625
value loss:128.5408935546875
entropies:353.07720947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.951641798019409 seconds
19 rew tensor(1.2134, dtype=torch.float64) delta_t tensor(1.0694, dtype=torch.float64)
19 gae_duplicate tensor(0.8764, dtype=torch.float64) tensor(-21.4714, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2232, dtype=torch.float64) delta_t tensor(1.1035, dtype=torch.float64)
18 gae_duplicate tensor(1.0557, dtype=torch.float64) tensor(-22.7882, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1499, dtype=torch.float64) delta_t tensor(1.0301, dtype=torch.float64)
17 gae_duplicate tensor(0.9330, dtype=torch.float64) tensor(-22.1174, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1313, dtype=torch.float64) delta_t tensor(0.9912, dtype=torch.float64)
16 gae_duplicate tensor(1.0355, dtype=torch.float64) tensor(-20.7128, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9731, dtype=torch.float64) delta_t tensor(0.7641, dtype=torch.float64)
15 gae_duplicate tensor(0.6612, dtype=torch.float64) tensor(-17.8989, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0336, dtype=torch.float64) delta_t tensor(0.8213, dtype=torch.float64)
14 gae_duplicate tensor(0.8242, dtype=torch.float64) tensor(-18.1659, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3683, dtype=torch.float64) delta_t tensor(0.2709, dtype=torch.float64)
13 gae_duplicate tensor(-0.8004, dtype=torch.float64) tensor(-7.0691, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(0.2732, dtype=torch.float64)
12 gae_duplicate tensor(-0.9146, dtype=torch.float64) tensor(-5.9583, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.7542, dtype=torch.float64) delta_t tensor(-0.8802, dtype=torch.float64)
11 gae_duplicate tensor(-3.6282, dtype=torch.float64) tensor(18.0541, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3173, dtype=torch.float64) delta_t tensor(0.2237, dtype=torch.float64)
10 gae_duplicate tensor(-0.2289, dtype=torch.float64) tensor(-2.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3509, dtype=torch.float64) delta_t tensor(0.3035, dtype=torch.float64)
9 gae_duplicate tensor(-0.3490, dtype=torch.float64) tensor(-6.5627, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4089, dtype=torch.float64) delta_t tensor(-0.5642, dtype=torch.float64)
8 gae_duplicate tensor(-0.9755, dtype=torch.float64) tensor(10.7491, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1344, dtype=torch.float64) delta_t tensor(-1.1232, dtype=torch.float64)
7 gae_duplicate tensor(-2.0805, dtype=torch.float64) tensor(23.1930, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5674, dtype=torch.float64) delta_t tensor(-0.6470, dtype=torch.float64)
6 gae_duplicate tensor(-1.2413, dtype=torch.float64) tensor(15.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7340, dtype=torch.float64) delta_t tensor(-1.6836, dtype=torch.float64)
5 gae_duplicate tensor(-2.2932, dtype=torch.float64) tensor(35.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1364, dtype=torch.float64) delta_t tensor(0.1408, dtype=torch.float64)
4 gae_duplicate tensor(-0.5614, dtype=torch.float64) tensor(0.4497, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5291, dtype=torch.float64) delta_t tensor(-1.6298, dtype=torch.float64)
3 gae_duplicate tensor(-2.3277, dtype=torch.float64) tensor(32.4976, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(0.4981, dtype=torch.float64)
2 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(-6.3799, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:772.8740234375
value loss:180.7778778076172
entropies:352.4766845703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.254166841506958 seconds
19 rew tensor(1.2605, dtype=torch.float64) delta_t tensor(1.0296, dtype=torch.float64)
19 gae_duplicate tensor(0.9802, dtype=torch.float64) tensor(-20.0859, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1392, dtype=torch.float64) delta_t tensor(0.9657, dtype=torch.float64)
18 gae_duplicate tensor(0.9686, dtype=torch.float64) tensor(-20.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0011, dtype=torch.float64) delta_t tensor(0.8205, dtype=torch.float64)
17 gae_duplicate tensor(0.7977, dtype=torch.float64) tensor(-18.3946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1644, dtype=torch.float64) delta_t tensor(0.9556, dtype=torch.float64)
16 gae_duplicate tensor(0.9191, dtype=torch.float64) tensor(-21.1161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8606, dtype=torch.float64) delta_t tensor(0.6247, dtype=torch.float64)
15 gae_duplicate tensor(0.6608, dtype=torch.float64) tensor(-14.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8775, dtype=torch.float64) delta_t tensor(0.6774, dtype=torch.float64)
14 gae_duplicate tensor(0.5325, dtype=torch.float64) tensor(-14.9919, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3355, dtype=torch.float64) delta_t tensor(0.2853, dtype=torch.float64)
13 gae_duplicate tensor(-0.9047, dtype=torch.float64) tensor(-7.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3425, dtype=torch.float64) delta_t tensor(0.1744, dtype=torch.float64)
12 gae_duplicate tensor(-0.0296, dtype=torch.float64) tensor(-4.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5316, dtype=torch.float64) delta_t tensor(0.4524, dtype=torch.float64)
11 gae_duplicate tensor(0.1047, dtype=torch.float64) tensor(-9.0596, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1668, dtype=torch.float64) delta_t tensor(-0.2193, dtype=torch.float64)
10 gae_duplicate tensor(-0.4545, dtype=torch.float64) tensor(3.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6604, dtype=torch.float64) delta_t tensor(0.6312, dtype=torch.float64)
9 gae_duplicate tensor(0.0774, dtype=torch.float64) tensor(-13.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4691, dtype=torch.float64) delta_t tensor(-0.6077, dtype=torch.float64)
8 gae_duplicate tensor(-1.0515, dtype=torch.float64) tensor(10.1762, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1635, dtype=torch.float64) delta_t tensor(-1.1868, dtype=torch.float64)
7 gae_duplicate tensor(-1.4514, dtype=torch.float64) tensor(25.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6481, dtype=torch.float64) delta_t tensor(-0.6278, dtype=torch.float64)
6 gae_duplicate tensor(-1.1173, dtype=torch.float64) tensor(15.8795, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5084, dtype=torch.float64) delta_t tensor(-1.3964, dtype=torch.float64)
5 gae_duplicate tensor(-1.5756, dtype=torch.float64) tensor(28.6733, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(0.3550, dtype=torch.float64)
4 gae_duplicate tensor(-0.0025, dtype=torch.float64) tensor(-4.0381, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6115, dtype=torch.float64) delta_t tensor(-1.7498, dtype=torch.float64)
3 gae_duplicate tensor(-2.0308, dtype=torch.float64) tensor(33.4702, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7297, dtype=torch.float64) delta_t tensor(0.7516, dtype=torch.float64)
2 gae_duplicate tensor(0.3072, dtype=torch.float64) tensor(-10.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2077.92578125
value loss:135.16433715820312
entropies:351.66033935546875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3985.0342)
ToM Target loss= tensor(3826.4644)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.879281759262085 seconds
19 rew tensor(1.2304, dtype=torch.float64) delta_t tensor(1.0177, dtype=torch.float64)
19 gae_duplicate tensor(0.9371, dtype=torch.float64) tensor(-19.7181, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1889, dtype=torch.float64) delta_t tensor(1.0019, dtype=torch.float64)
18 gae_duplicate tensor(0.9250, dtype=torch.float64) tensor(-23.7844, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0657, dtype=torch.float64) delta_t tensor(0.8244, dtype=torch.float64)
17 gae_duplicate tensor(0.7482, dtype=torch.float64) tensor(-20.2524, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0360, dtype=torch.float64) delta_t tensor(0.7133, dtype=torch.float64)
16 gae_duplicate tensor(0.5567, dtype=torch.float64) tensor(-15.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9750, dtype=torch.float64) delta_t tensor(0.7561, dtype=torch.float64)
15 gae_duplicate tensor(0.6198, dtype=torch.float64) tensor(-16.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7779, dtype=torch.float64) delta_t tensor(0.6523, dtype=torch.float64)
14 gae_duplicate tensor(0.5072, dtype=torch.float64) tensor(-14.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2304, dtype=torch.float64) delta_t tensor(0.1411, dtype=torch.float64)
13 gae_duplicate tensor(-2.6605, dtype=torch.float64) tensor(-4.7133, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3822, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
12 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-4.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2915, dtype=torch.float64) delta_t tensor(0.2076, dtype=torch.float64)
11 gae_duplicate tensor(-1.6296, dtype=torch.float64) tensor(-4.9441, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6639, dtype=torch.float64) delta_t tensor(-0.7088, dtype=torch.float64)
10 gae_duplicate tensor(-3.4759, dtype=torch.float64) tensor(12.7125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3565, dtype=torch.float64) delta_t tensor(0.3124, dtype=torch.float64)
9 gae_duplicate tensor(-0.1707, dtype=torch.float64) tensor(-4.5689, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4466, dtype=torch.float64) delta_t tensor(-0.6182, dtype=torch.float64)
8 gae_duplicate tensor(-1.0484, dtype=torch.float64) tensor(11.4841, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5338, dtype=torch.float64) delta_t tensor(-0.6431, dtype=torch.float64)
7 gae_duplicate tensor(-1.3274, dtype=torch.float64) tensor(13.1731, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7236, dtype=torch.float64) delta_t tensor(-0.8190, dtype=torch.float64)
6 gae_duplicate tensor(-1.0876, dtype=torch.float64) tensor(17.3482, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2973, dtype=torch.float64) delta_t tensor(-1.2406, dtype=torch.float64)
5 gae_duplicate tensor(-1.9826, dtype=torch.float64) tensor(24.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2247, dtype=torch.float64) delta_t tensor(-0.2139, dtype=torch.float64)
4 gae_duplicate tensor(-0.7616, dtype=torch.float64) tensor(6.4588, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7935, dtype=torch.float64) delta_t tensor(-0.8721, dtype=torch.float64)
3 gae_duplicate tensor(-1.7332, dtype=torch.float64) tensor(16.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0393, dtype=torch.float64) delta_t tensor(0.0646, dtype=torch.float64)
2 gae_duplicate tensor(-0.7190, dtype=torch.float64) tensor(0.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1348.5977783203125
value loss:145.19407653808594
entropies:350.85540771484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.098465919494629 seconds
19 rew tensor(1.1457, dtype=torch.float64) delta_t tensor(0.9450, dtype=torch.float64)
19 gae_duplicate tensor(0.7177, dtype=torch.float64) tensor(-18.3506, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1824, dtype=torch.float64) delta_t tensor(1.0132, dtype=torch.float64)
18 gae_duplicate tensor(0.8221, dtype=torch.float64) tensor(-21.4120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1239, dtype=torch.float64) delta_t tensor(0.9388, dtype=torch.float64)
17 gae_duplicate tensor(0.8426, dtype=torch.float64) tensor(-19.5511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0922, dtype=torch.float64) delta_t tensor(0.8530, dtype=torch.float64)
16 gae_duplicate tensor(0.6875, dtype=torch.float64) tensor(-19.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0594, dtype=torch.float64) delta_t tensor(0.7622, dtype=torch.float64)
15 gae_duplicate tensor(0.6383, dtype=torch.float64) tensor(-16.4407, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8736, dtype=torch.float64) delta_t tensor(0.6454, dtype=torch.float64)
14 gae_duplicate tensor(0.3661, dtype=torch.float64) tensor(-14.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2711, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
13 gae_duplicate tensor(-2.5699, dtype=torch.float64) tensor(-3.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1454, dtype=torch.float64) delta_t tensor(-0.3426, dtype=torch.float64)
12 gae_duplicate tensor(-3.4160, dtype=torch.float64) tensor(5.6677, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2837, dtype=torch.float64) delta_t tensor(-0.4503, dtype=torch.float64)
11 gae_duplicate tensor(-3.7723, dtype=torch.float64) tensor(8.9255, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7550, dtype=torch.float64) delta_t tensor(-0.8275, dtype=torch.float64)
10 gae_duplicate tensor(-4.3133, dtype=torch.float64) tensor(16.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3969, dtype=torch.float64) delta_t tensor(0.3459, dtype=torch.float64)
9 gae_duplicate tensor(-0.5394, dtype=torch.float64) tensor(-4.8293, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5376, dtype=torch.float64) delta_t tensor(-0.7090, dtype=torch.float64)
8 gae_duplicate tensor(-1.1332, dtype=torch.float64) tensor(13.5488, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2928, dtype=torch.float64) delta_t tensor(-0.3603, dtype=torch.float64)
7 gae_duplicate tensor(-1.1265, dtype=torch.float64) tensor(8.6295, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6964, dtype=torch.float64) delta_t tensor(-0.7534, dtype=torch.float64)
6 gae_duplicate tensor(-1.1297, dtype=torch.float64) tensor(14.8156, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3066, dtype=torch.float64) delta_t tensor(-1.2903, dtype=torch.float64)
5 gae_duplicate tensor(-1.8924, dtype=torch.float64) tensor(25.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3303, dtype=torch.float64) delta_t tensor(-0.3062, dtype=torch.float64)
4 gae_duplicate tensor(-0.9430, dtype=torch.float64) tensor(8.3751, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(-0.8738, dtype=torch.float64)
3 gae_duplicate tensor(-1.8682, dtype=torch.float64) tensor(17.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0412, dtype=torch.float64) delta_t tensor(0.0524, dtype=torch.float64)
2 gae_duplicate tensor(-0.5498, dtype=torch.float64) tensor(0.4755, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-149.8107147216797
value loss:186.60023498535156
entropies:350.6183166503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.070976972579956 seconds
19 rew tensor(1.2551, dtype=torch.float64) delta_t tensor(1.0566, dtype=torch.float64)
19 gae_duplicate tensor(0.9653, dtype=torch.float64) tensor(-21.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2399, dtype=torch.float64) delta_t tensor(1.0612, dtype=torch.float64)
18 gae_duplicate tensor(1.0038, dtype=torch.float64) tensor(-21.8122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1870, dtype=torch.float64) delta_t tensor(0.9120, dtype=torch.float64)
17 gae_duplicate tensor(0.7093, dtype=torch.float64) tensor(-19.1036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1297, dtype=torch.float64) delta_t tensor(0.8253, dtype=torch.float64)
16 gae_duplicate tensor(0.5772, dtype=torch.float64) tensor(-17.3258, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0418, dtype=torch.float64) delta_t tensor(0.8286, dtype=torch.float64)
15 gae_duplicate tensor(0.4747, dtype=torch.float64) tensor(-17.8526, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3131, dtype=torch.float64) delta_t tensor(0.1096, dtype=torch.float64)
14 gae_duplicate tensor(-2.5340, dtype=torch.float64) tensor(-4.2416, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1802, dtype=torch.float64) delta_t tensor(0.0801, dtype=torch.float64)
13 gae_duplicate tensor(-1.1734, dtype=torch.float64) tensor(-1.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0486, dtype=torch.float64) delta_t tensor(-0.2146, dtype=torch.float64)
12 gae_duplicate tensor(-2.3307, dtype=torch.float64) tensor(3.5915, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1100, dtype=torch.float64) delta_t tensor(0.0118, dtype=torch.float64)
11 gae_duplicate tensor(-1.3619, dtype=torch.float64) tensor(0.0432, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0850, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
10 gae_duplicate tensor(-0.3827, dtype=torch.float64) tensor(-0.0939, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5642, dtype=torch.float64) delta_t tensor(0.4863, dtype=torch.float64)
9 gae_duplicate tensor(-0.2171, dtype=torch.float64) tensor(-10.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5777, dtype=torch.float64) delta_t tensor(-0.7440, dtype=torch.float64)
8 gae_duplicate tensor(-0.9358, dtype=torch.float64) tensor(12.9939, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6884, dtype=torch.float64) delta_t tensor(-0.7580, dtype=torch.float64)
7 gae_duplicate tensor(-2.0628, dtype=torch.float64) tensor(16.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7494, dtype=torch.float64) delta_t tensor(-0.8441, dtype=torch.float64)
6 gae_duplicate tensor(-1.3586, dtype=torch.float64) tensor(17.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2064, dtype=torch.float64) delta_t tensor(-1.1347, dtype=torch.float64)
5 gae_duplicate tensor(-1.8116, dtype=torch.float64) tensor(23.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1594, dtype=torch.float64) delta_t tensor(-0.1234, dtype=torch.float64)
4 gae_duplicate tensor(-0.7781, dtype=torch.float64) tensor(4.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9165, dtype=torch.float64) delta_t tensor(-1.0326, dtype=torch.float64)
3 gae_duplicate tensor(-1.7733, dtype=torch.float64) tensor(20.6148, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1942, dtype=torch.float64) delta_t tensor(0.2197, dtype=torch.float64)
2 gae_duplicate tensor(-0.2796, dtype=torch.float64) tensor(-2.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:803.4346313476562
value loss:143.76365661621094
entropies:350.6968078613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9226720333099365 seconds
19 rew tensor(1.1985, dtype=torch.float64) delta_t tensor(0.8855, dtype=torch.float64)
19 gae_duplicate tensor(0.5943, dtype=torch.float64) tensor(-17.8529, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1791, dtype=torch.float64) delta_t tensor(0.9609, dtype=torch.float64)
18 gae_duplicate tensor(0.7639, dtype=torch.float64) tensor(-19.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1249, dtype=torch.float64) delta_t tensor(0.8875, dtype=torch.float64)
17 gae_duplicate tensor(0.7087, dtype=torch.float64) tensor(-19.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0387, dtype=torch.float64) delta_t tensor(0.6545, dtype=torch.float64)
16 gae_duplicate tensor(0.5389, dtype=torch.float64) tensor(-14.0257, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9614, dtype=torch.float64) delta_t tensor(0.7762, dtype=torch.float64)
15 gae_duplicate tensor(0.7459, dtype=torch.float64) tensor(-16.4563, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1812, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
14 gae_duplicate tensor(-0.9024, dtype=torch.float64) tensor(-0.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4880, dtype=torch.float64) delta_t tensor(0.4104, dtype=torch.float64)
13 gae_duplicate tensor(-1.2421, dtype=torch.float64) tensor(-7.8331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3210, dtype=torch.float64) delta_t tensor(0.1230, dtype=torch.float64)
12 gae_duplicate tensor(-0.0943, dtype=torch.float64) tensor(-3.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3100, dtype=torch.float64) delta_t tensor(0.2185, dtype=torch.float64)
11 gae_duplicate tensor(-1.5522, dtype=torch.float64) tensor(-4.6040, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0214, dtype=torch.float64) delta_t tensor(-0.1048, dtype=torch.float64)
10 gae_duplicate tensor(-0.6066, dtype=torch.float64) tensor(1.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4868, dtype=torch.float64) delta_t tensor(0.3731, dtype=torch.float64)
9 gae_duplicate tensor(0.0874, dtype=torch.float64) tensor(-7.6118, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5135, dtype=torch.float64) delta_t tensor(-0.6911, dtype=torch.float64)
8 gae_duplicate tensor(-0.8754, dtype=torch.float64) tensor(12.7898, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1302, dtype=torch.float64) delta_t tensor(-0.2647, dtype=torch.float64)
7 gae_duplicate tensor(-0.8754, dtype=torch.float64) tensor(6.1609, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8552, dtype=torch.float64) delta_t tensor(-0.9489, dtype=torch.float64)
6 gae_duplicate tensor(-1.3347, dtype=torch.float64) tensor(19.1086, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9106, dtype=torch.float64) delta_t tensor(-0.8604, dtype=torch.float64)
5 gae_duplicate tensor(-1.6585, dtype=torch.float64) tensor(18.7044, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3748, dtype=torch.float64) delta_t tensor(-0.3751, dtype=torch.float64)
4 gae_duplicate tensor(-0.9159, dtype=torch.float64) tensor(9.3196, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3972, dtype=torch.float64) delta_t tensor(-0.4532, dtype=torch.float64)
3 gae_duplicate tensor(-1.5777, dtype=torch.float64) tensor(9.8857, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0641, dtype=torch.float64) delta_t tensor(-0.0442, dtype=torch.float64)
2 gae_duplicate tensor(-0.5412, dtype=torch.float64) tensor(1.5174, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1649.5101318359375
value loss:98.7083740234375
entropies:350.87261962890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.967357873916626 seconds
19 rew tensor(1.1756, dtype=torch.float64) delta_t tensor(0.9171, dtype=torch.float64)
19 gae_duplicate tensor(0.6317, dtype=torch.float64) tensor(-18.4213, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1292, dtype=torch.float64) delta_t tensor(0.8840, dtype=torch.float64)
18 gae_duplicate tensor(0.7398, dtype=torch.float64) tensor(-18.1940, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1755, dtype=torch.float64) delta_t tensor(0.9099, dtype=torch.float64)
17 gae_duplicate tensor(0.7068, dtype=torch.float64) tensor(-18.7616, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0632, dtype=torch.float64) delta_t tensor(0.7698, dtype=torch.float64)
16 gae_duplicate tensor(0.5168, dtype=torch.float64) tensor(-17.5946, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9371, dtype=torch.float64) delta_t tensor(0.6119, dtype=torch.float64)
15 gae_duplicate tensor(0.3414, dtype=torch.float64) tensor(-13.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8106, dtype=torch.float64) delta_t tensor(0.5377, dtype=torch.float64)
14 gae_duplicate tensor(0.4090, dtype=torch.float64) tensor(-12.3939, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7485, dtype=torch.float64) delta_t tensor(0.5668, dtype=torch.float64)
13 gae_duplicate tensor(-0.0150, dtype=torch.float64) tensor(-13.2923, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0297, dtype=torch.float64) delta_t tensor(-0.3155, dtype=torch.float64)
12 gae_duplicate tensor(-2.4721, dtype=torch.float64) tensor(6.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6915, dtype=torch.float64) delta_t tensor(-0.8001, dtype=torch.float64)
11 gae_duplicate tensor(-5.9351, dtype=torch.float64) tensor(15.4925, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0695, dtype=torch.float64) delta_t tensor(-0.1765, dtype=torch.float64)
10 gae_duplicate tensor(-2.2940, dtype=torch.float64) tensor(4.5158, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1415, dtype=torch.float64) delta_t tensor(0.1039, dtype=torch.float64)
9 gae_duplicate tensor(-0.3926, dtype=torch.float64) tensor(-1.4616, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4027, dtype=torch.float64) delta_t tensor(-0.5716, dtype=torch.float64)
8 gae_duplicate tensor(-0.9461, dtype=torch.float64) tensor(10.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1665, dtype=torch.float64) delta_t tensor(-1.1356, dtype=torch.float64)
7 gae_duplicate tensor(-2.1480, dtype=torch.float64) tensor(22.3586, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6159, dtype=torch.float64) delta_t tensor(-0.5436, dtype=torch.float64)
6 gae_duplicate tensor(-1.5089, dtype=torch.float64) tensor(12.8872, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5924, dtype=torch.float64) delta_t tensor(-1.5309, dtype=torch.float64)
5 gae_duplicate tensor(-2.0511, dtype=torch.float64) tensor(29.7493, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2741, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
4 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(-3.8208, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5656, dtype=torch.float64) delta_t tensor(-1.6896, dtype=torch.float64)
3 gae_duplicate tensor(-2.4784, dtype=torch.float64) tensor(33.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6433, dtype=torch.float64) delta_t tensor(0.6666, dtype=torch.float64)
2 gae_duplicate tensor(0.0191, dtype=torch.float64) tensor(-9.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-580.844482421875
value loss:204.03509521484375
entropies:350.9585266113281
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.4900)
ToM Target loss= tensor(2549.6624)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.013357877731323 seconds
19 rew tensor(1.1926, dtype=torch.float64) delta_t tensor(0.7973, dtype=torch.float64)
19 gae_duplicate tensor(0.6103, dtype=torch.float64) tensor(-15.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1346, dtype=torch.float64) delta_t tensor(0.7908, dtype=torch.float64)
18 gae_duplicate tensor(0.7176, dtype=torch.float64) tensor(-18.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0619, dtype=torch.float64) delta_t tensor(0.7142, dtype=torch.float64)
17 gae_duplicate tensor(0.5838, dtype=torch.float64) tensor(-14.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0161, dtype=torch.float64) delta_t tensor(0.6548, dtype=torch.float64)
16 gae_duplicate tensor(0.4329, dtype=torch.float64) tensor(-13.6868, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8989, dtype=torch.float64) delta_t tensor(0.6194, dtype=torch.float64)
15 gae_duplicate tensor(0.5276, dtype=torch.float64) tensor(-14.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1358, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
14 gae_duplicate tensor(-1.2998, dtype=torch.float64) tensor(1.0953, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6293, dtype=torch.float64) delta_t tensor(0.4629, dtype=torch.float64)
13 gae_duplicate tensor(0.1353, dtype=torch.float64) tensor(-8.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4142, dtype=torch.float64) delta_t tensor(0.1863, dtype=torch.float64)
12 gae_duplicate tensor(-0.1804, dtype=torch.float64) tensor(-4.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4743, dtype=torch.float64) delta_t tensor(0.2809, dtype=torch.float64)
11 gae_duplicate tensor(-0.0436, dtype=torch.float64) tensor(-5.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1232, dtype=torch.float64) delta_t tensor(-0.1943, dtype=torch.float64)
10 gae_duplicate tensor(-0.4439, dtype=torch.float64) tensor(2.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4218, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
9 gae_duplicate tensor(0.1571, dtype=torch.float64) tensor(-6.4234, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3910, dtype=torch.float64) delta_t tensor(-0.5797, dtype=torch.float64)
8 gae_duplicate tensor(-0.9053, dtype=torch.float64) tensor(11.3077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6649, dtype=torch.float64) delta_t tensor(-0.7722, dtype=torch.float64)
7 gae_duplicate tensor(-1.3967, dtype=torch.float64) tensor(15.6967, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6647, dtype=torch.float64) delta_t tensor(-0.6738, dtype=torch.float64)
6 gae_duplicate tensor(-1.1020, dtype=torch.float64) tensor(14.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2223, dtype=torch.float64) delta_t tensor(-1.0546, dtype=torch.float64)
5 gae_duplicate tensor(-1.5619, dtype=torch.float64) tensor(21.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0680, dtype=torch.float64) delta_t tensor(-0.0343, dtype=torch.float64)
4 gae_duplicate tensor(-0.8969, dtype=torch.float64) tensor(2.8036, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8110, dtype=torch.float64) delta_t tensor(-0.9278, dtype=torch.float64)
3 gae_duplicate tensor(-1.9977, dtype=torch.float64) tensor(18.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1994, dtype=torch.float64) delta_t tensor(0.2318, dtype=torch.float64)
2 gae_duplicate tensor(-0.7117, dtype=torch.float64) tensor(-3.0893, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:805.166015625
value loss:91.57159423828125
entropies:351.2230224609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.993865966796875 seconds
19 rew tensor(1.1811, dtype=torch.float64) delta_t tensor(0.8216, dtype=torch.float64)
19 gae_duplicate tensor(0.6557, dtype=torch.float64) tensor(-15.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1872, dtype=torch.float64) delta_t tensor(0.8730, dtype=torch.float64)
18 gae_duplicate tensor(0.7360, dtype=torch.float64) tensor(-17.8003, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1654, dtype=torch.float64) delta_t tensor(0.8476, dtype=torch.float64)
17 gae_duplicate tensor(0.7341, dtype=torch.float64) tensor(-19.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0530, dtype=torch.float64) delta_t tensor(0.7102, dtype=torch.float64)
16 gae_duplicate tensor(0.5292, dtype=torch.float64) tensor(-16.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.5855, dtype=torch.float64) delta_t tensor(0.2774, dtype=torch.float64)
15 gae_duplicate tensor(-0.7569, dtype=torch.float64) tensor(-6.7094, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5361, dtype=torch.float64) delta_t tensor(0.2934, dtype=torch.float64)
14 gae_duplicate tensor(-1.0488, dtype=torch.float64) tensor(-6.2500, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5834, dtype=torch.float64) delta_t tensor(0.3701, dtype=torch.float64)
13 gae_duplicate tensor(-0.2142, dtype=torch.float64) tensor(-7.9419, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4263, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
12 gae_duplicate tensor(-0.2604, dtype=torch.float64) tensor(-4.3997, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3138, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
11 gae_duplicate tensor(-0.2598, dtype=torch.float64) tensor(-4.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1623, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
10 gae_duplicate tensor(-0.3981, dtype=torch.float64) tensor(-2.1586, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1834, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
9 gae_duplicate tensor(-0.5796, dtype=torch.float64) tensor(-2.2398, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3710, dtype=torch.float64) delta_t tensor(-0.5165, dtype=torch.float64)
8 gae_duplicate tensor(-0.8694, dtype=torch.float64) tensor(10.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8050, dtype=torch.float64) delta_t tensor(-0.8880, dtype=torch.float64)
7 gae_duplicate tensor(-2.2676, dtype=torch.float64) tensor(19.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6138, dtype=torch.float64) delta_t tensor(-0.6377, dtype=torch.float64)
6 gae_duplicate tensor(-1.2076, dtype=torch.float64) tensor(14.7763, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3148, dtype=torch.float64) delta_t tensor(-1.2226, dtype=torch.float64)
5 gae_duplicate tensor(-2.2585, dtype=torch.float64) tensor(26.4105, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0199, dtype=torch.float64) delta_t tensor(-0.0097, dtype=torch.float64)
4 gae_duplicate tensor(-0.9103, dtype=torch.float64) tensor(3.2190, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9958, dtype=torch.float64) delta_t tensor(-1.0754, dtype=torch.float64)
3 gae_duplicate tensor(-2.4312, dtype=torch.float64) tensor(21.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3193, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
2 gae_duplicate tensor(-0.4525, dtype=torch.float64) tensor(-3.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:578.6663208007812
value loss:115.24443817138672
entropies:351.61688232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.881508111953735 seconds
19 rew tensor(1.1706, dtype=torch.float64) delta_t tensor(0.8294, dtype=torch.float64)
19 gae_duplicate tensor(0.7123, dtype=torch.float64) tensor(-16.1812, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1341, dtype=torch.float64) delta_t tensor(0.7813, dtype=torch.float64)
18 gae_duplicate tensor(0.7633, dtype=torch.float64) tensor(-16.6534, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0190, dtype=torch.float64) delta_t tensor(0.7158, dtype=torch.float64)
17 gae_duplicate tensor(0.6558, dtype=torch.float64) tensor(-15.5946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9942, dtype=torch.float64) delta_t tensor(0.7113, dtype=torch.float64)
16 gae_duplicate tensor(0.4626, dtype=torch.float64) tensor(-15.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9641, dtype=torch.float64) delta_t tensor(0.6580, dtype=torch.float64)
15 gae_duplicate tensor(0.5426, dtype=torch.float64) tensor(-14.9239, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7237, dtype=torch.float64) delta_t tensor(0.4034, dtype=torch.float64)
14 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-9.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6687, dtype=torch.float64) delta_t tensor(0.4829, dtype=torch.float64)
13 gae_duplicate tensor(0.3586, dtype=torch.float64) tensor(-10.6795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1502, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
12 gae_duplicate tensor(-0.9820, dtype=torch.float64) tensor(1.3872, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1186, dtype=torch.float64) delta_t tensor(-0.3070, dtype=torch.float64)
11 gae_duplicate tensor(-3.1452, dtype=torch.float64) tensor(5.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0743, dtype=torch.float64) delta_t tensor(-0.1614, dtype=torch.float64)
10 gae_duplicate tensor(-0.5411, dtype=torch.float64) tensor(3.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3767, dtype=torch.float64) delta_t tensor(0.3151, dtype=torch.float64)
9 gae_duplicate tensor(0.0897, dtype=torch.float64) tensor(-5.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4823, dtype=torch.float64) delta_t tensor(-0.6867, dtype=torch.float64)
8 gae_duplicate tensor(-1.1440, dtype=torch.float64) tensor(12.6221, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8983, dtype=torch.float64) delta_t tensor(-0.9028, dtype=torch.float64)
7 gae_duplicate tensor(-1.4529, dtype=torch.float64) tensor(19.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5774, dtype=torch.float64) delta_t tensor(-0.6155, dtype=torch.float64)
6 gae_duplicate tensor(-1.1604, dtype=torch.float64) tensor(14.7074, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5295, dtype=torch.float64) delta_t tensor(-1.3371, dtype=torch.float64)
5 gae_duplicate tensor(-1.6040, dtype=torch.float64) tensor(27.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0518, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
4 gae_duplicate tensor(-0.6747, dtype=torch.float64) tensor(0.9646, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2444, dtype=torch.float64) delta_t tensor(-1.3625, dtype=torch.float64)
3 gae_duplicate tensor(-1.9800, dtype=torch.float64) tensor(26.4250, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3889, dtype=torch.float64) delta_t tensor(0.4209, dtype=torch.float64)
2 gae_duplicate tensor(-0.3273, dtype=torch.float64) tensor(-5.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-241.33203125
value loss:117.29972839355469
entropies:351.7850646972656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.882656097412109 seconds
19 rew tensor(1.1331, dtype=torch.float64) delta_t tensor(0.7278, dtype=torch.float64)
19 gae_duplicate tensor(0.4817, dtype=torch.float64) tensor(-13.5217, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0419, dtype=torch.float64) delta_t tensor(0.6457, dtype=torch.float64)
18 gae_duplicate tensor(0.5687, dtype=torch.float64) tensor(-14.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1007, dtype=torch.float64) delta_t tensor(0.7028, dtype=torch.float64)
17 gae_duplicate tensor(0.5944, dtype=torch.float64) tensor(-14.5093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9436, dtype=torch.float64) delta_t tensor(0.5928, dtype=torch.float64)
16 gae_duplicate tensor(0.5249, dtype=torch.float64) tensor(-12.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9503, dtype=torch.float64) delta_t tensor(0.5184, dtype=torch.float64)
15 gae_duplicate tensor(0.4730, dtype=torch.float64) tensor(-11.2662, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6865, dtype=torch.float64) delta_t tensor(0.3764, dtype=torch.float64)
14 gae_duplicate tensor(0.2518, dtype=torch.float64) tensor(-8.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3223, dtype=torch.float64) delta_t tensor(0.1466, dtype=torch.float64)
13 gae_duplicate tensor(-1.1367, dtype=torch.float64) tensor(-2.8190, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3327, dtype=torch.float64) delta_t tensor(0.1185, dtype=torch.float64)
12 gae_duplicate tensor(-0.2275, dtype=torch.float64) tensor(-2.6981, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3984, dtype=torch.float64) delta_t tensor(0.2378, dtype=torch.float64)
11 gae_duplicate tensor(-0.0375, dtype=torch.float64) tensor(-4.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0197, dtype=torch.float64) delta_t tensor(-0.0733, dtype=torch.float64)
10 gae_duplicate tensor(-0.3053, dtype=torch.float64) tensor(0.9234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5239, dtype=torch.float64) delta_t tensor(0.4348, dtype=torch.float64)
9 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(-8.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5945, dtype=torch.float64) delta_t tensor(-0.7880, dtype=torch.float64)
8 gae_duplicate tensor(-1.1529, dtype=torch.float64) tensor(13.8877, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6393, dtype=torch.float64) delta_t tensor(-0.7314, dtype=torch.float64)
7 gae_duplicate tensor(-1.8486, dtype=torch.float64) tensor(15.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6631, dtype=torch.float64) delta_t tensor(-0.6304, dtype=torch.float64)
6 gae_duplicate tensor(-1.1606, dtype=torch.float64) tensor(13.9733, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2670, dtype=torch.float64) delta_t tensor(-1.0660, dtype=torch.float64)
5 gae_duplicate tensor(-1.8515, dtype=torch.float64) tensor(21.3819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0033, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
4 gae_duplicate tensor(-0.6063, dtype=torch.float64) tensor(0.9662, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0124, dtype=torch.float64) delta_t tensor(-1.1248, dtype=torch.float64)
3 gae_duplicate tensor(-2.0554, dtype=torch.float64) tensor(21.9286, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3818, dtype=torch.float64) delta_t tensor(0.4156, dtype=torch.float64)
2 gae_duplicate tensor(-0.2315, dtype=torch.float64) tensor(-5.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:532.4290161132812
value loss:89.23210144042969
entropies:351.8817443847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.050668001174927 seconds
19 rew tensor(1.1976, dtype=torch.float64) delta_t tensor(0.7289, dtype=torch.float64)
19 gae_duplicate tensor(0.5435, dtype=torch.float64) tensor(-14.1408, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2160, dtype=torch.float64) delta_t tensor(0.8113, dtype=torch.float64)
18 gae_duplicate tensor(0.7096, dtype=torch.float64) tensor(-17.5057, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1526, dtype=torch.float64) delta_t tensor(0.6678, dtype=torch.float64)
17 gae_duplicate tensor(0.6051, dtype=torch.float64) tensor(-14.6441, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0781, dtype=torch.float64) delta_t tensor(0.6415, dtype=torch.float64)
16 gae_duplicate tensor(0.5643, dtype=torch.float64) tensor(-13.7824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9641, dtype=torch.float64) delta_t tensor(0.6018, dtype=torch.float64)
15 gae_duplicate tensor(0.3935, dtype=torch.float64) tensor(-14.0100, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0612, dtype=torch.float64) delta_t tensor(-0.3157, dtype=torch.float64)
14 gae_duplicate tensor(-2.5214, dtype=torch.float64) tensor(3.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6468, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
13 gae_duplicate tensor(0.0210, dtype=torch.float64) tensor(-9.7452, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2405, dtype=torch.float64) delta_t tensor(-0.4554, dtype=torch.float64)
12 gae_duplicate tensor(-2.4377, dtype=torch.float64) tensor(7.4436, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6775, dtype=torch.float64) delta_t tensor(0.5688, dtype=torch.float64)
11 gae_duplicate tensor(0.0828, dtype=torch.float64) tensor(-9.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1736, dtype=torch.float64) delta_t tensor(-0.2402, dtype=torch.float64)
10 gae_duplicate tensor(-0.3646, dtype=torch.float64) tensor(3.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6721, dtype=torch.float64) delta_t tensor(0.5573, dtype=torch.float64)
9 gae_duplicate tensor(0.1574, dtype=torch.float64) tensor(-10.4098, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6372, dtype=torch.float64) delta_t tensor(-0.8414, dtype=torch.float64)
8 gae_duplicate tensor(-1.1063, dtype=torch.float64) tensor(15.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2568, dtype=torch.float64) delta_t tensor(-0.3727, dtype=torch.float64)
7 gae_duplicate tensor(-1.1890, dtype=torch.float64) tensor(8.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8453, dtype=torch.float64) delta_t tensor(-0.8142, dtype=torch.float64)
6 gae_duplicate tensor(-1.0311, dtype=torch.float64) tensor(16.7194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0057, dtype=torch.float64) delta_t tensor(-0.8134, dtype=torch.float64)
5 gae_duplicate tensor(-1.2539, dtype=torch.float64) tensor(18.3612, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2052, dtype=torch.float64) delta_t tensor(-0.1827, dtype=torch.float64)
4 gae_duplicate tensor(-0.8894, dtype=torch.float64) tensor(5.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7156, dtype=torch.float64) delta_t tensor(-0.8189, dtype=torch.float64)
3 gae_duplicate tensor(-1.7201, dtype=torch.float64) tensor(17.0578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1376, dtype=torch.float64) delta_t tensor(0.1770, dtype=torch.float64)
2 gae_duplicate tensor(-0.4289, dtype=torch.float64) tensor(-1.5139, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:393.4712219238281
value loss:99.03402709960938
entropies:352.05242919921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3941.0034)
ToM Target loss= tensor(2401.7524)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.144069194793701 seconds
19 rew tensor(1.1236, dtype=torch.float64) delta_t tensor(0.6645, dtype=torch.float64)
19 gae_duplicate tensor(0.4780, dtype=torch.float64) tensor(-12.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1415, dtype=torch.float64) delta_t tensor(0.6924, dtype=torch.float64)
18 gae_duplicate tensor(0.5543, dtype=torch.float64) tensor(-15.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0645, dtype=torch.float64) delta_t tensor(0.6086, dtype=torch.float64)
17 gae_duplicate tensor(0.5358, dtype=torch.float64) tensor(-13.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0028, dtype=torch.float64) delta_t tensor(0.6166, dtype=torch.float64)
16 gae_duplicate tensor(0.4739, dtype=torch.float64) tensor(-12.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9915, dtype=torch.float64) delta_t tensor(0.6093, dtype=torch.float64)
15 gae_duplicate tensor(0.4761, dtype=torch.float64) tensor(-13.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4194, dtype=torch.float64) delta_t tensor(0.0970, dtype=torch.float64)
14 gae_duplicate tensor(-1.1377, dtype=torch.float64) tensor(-2.9369, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6556, dtype=torch.float64) delta_t tensor(0.4376, dtype=torch.float64)
13 gae_duplicate tensor(0.0661, dtype=torch.float64) tensor(-9.1084, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3020, dtype=torch.float64) delta_t tensor(-0.0076, dtype=torch.float64)
12 gae_duplicate tensor(-0.2633, dtype=torch.float64) tensor(-0.8302, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2224, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
11 gae_duplicate tensor(-1.4202, dtype=torch.float64) tensor(-0.3111, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0108, dtype=torch.float64) delta_t tensor(-0.1033, dtype=torch.float64)
10 gae_duplicate tensor(-0.3516, dtype=torch.float64) tensor(2.0185, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4260, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
9 gae_duplicate tensor(0.0508, dtype=torch.float64) tensor(-5.8733, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5470, dtype=torch.float64) delta_t tensor(-0.7786, dtype=torch.float64)
8 gae_duplicate tensor(-1.1715, dtype=torch.float64) tensor(14.0312, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5296, dtype=torch.float64) delta_t tensor(-0.5388, dtype=torch.float64)
7 gae_duplicate tensor(-1.3383, dtype=torch.float64) tensor(12.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6293, dtype=torch.float64) delta_t tensor(-0.5891, dtype=torch.float64)
6 gae_duplicate tensor(-0.8529, dtype=torch.float64) tensor(12.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3228, dtype=torch.float64) delta_t tensor(-1.1065, dtype=torch.float64)
5 gae_duplicate tensor(-1.5268, dtype=torch.float64) tensor(23.0967, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1260, dtype=torch.float64) delta_t tensor(-0.0356, dtype=torch.float64)
4 gae_duplicate tensor(-0.5792, dtype=torch.float64) tensor(3.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8959, dtype=torch.float64) delta_t tensor(-0.9869, dtype=torch.float64)
3 gae_duplicate tensor(-2.0115, dtype=torch.float64) tensor(18.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2427, dtype=torch.float64) delta_t tensor(0.2828, dtype=torch.float64)
2 gae_duplicate tensor(-0.3246, dtype=torch.float64) tensor(-3.4589, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:96.73282623291016
value loss:81.47835540771484
entropies:352.33892822265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.779396057128906 seconds
19 rew tensor(1.2097, dtype=torch.float64) delta_t tensor(0.6376, dtype=torch.float64)
19 gae_duplicate tensor(0.4146, dtype=torch.float64) tensor(-12.7273, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2142, dtype=torch.float64) delta_t tensor(0.7074, dtype=torch.float64)
18 gae_duplicate tensor(0.4976, dtype=torch.float64) tensor(-15.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0984, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
17 gae_duplicate tensor(0.5762, dtype=torch.float64) tensor(-12.8900, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9435, dtype=torch.float64) delta_t tensor(0.4591, dtype=torch.float64)
16 gae_duplicate tensor(0.3685, dtype=torch.float64) tensor(-10.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9348, dtype=torch.float64) delta_t tensor(0.4260, dtype=torch.float64)
15 gae_duplicate tensor(0.2227, dtype=torch.float64) tensor(-9.5943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6834, dtype=torch.float64) delta_t tensor(0.3296, dtype=torch.float64)
14 gae_duplicate tensor(0.2727, dtype=torch.float64) tensor(-7.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5846, dtype=torch.float64) delta_t tensor(0.3307, dtype=torch.float64)
13 gae_duplicate tensor(-0.0894, dtype=torch.float64) tensor(-7.0481, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.2326, dtype=torch.float64)
12 gae_duplicate tensor(-0.2552, dtype=torch.float64) tensor(-5.7332, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2206, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
11 gae_duplicate tensor(-0.2263, dtype=torch.float64) tensor(-1.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1866, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
10 gae_duplicate tensor(-0.4322, dtype=torch.float64) tensor(-1.1392, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0046, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
9 gae_duplicate tensor(-0.3587, dtype=torch.float64) tensor(-0.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3875, dtype=torch.float64) delta_t tensor(-0.6134, dtype=torch.float64)
8 gae_duplicate tensor(-0.8947, dtype=torch.float64) tensor(12.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4797, dtype=torch.float64) delta_t tensor(-1.4444, dtype=torch.float64)
7 gae_duplicate tensor(-1.9582, dtype=torch.float64) tensor(29.6034, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5256, dtype=torch.float64) delta_t tensor(-0.2847, dtype=torch.float64)
6 gae_duplicate tensor(-0.7279, dtype=torch.float64) tensor(8.5137, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7314, dtype=torch.float64) delta_t tensor(-1.4709, dtype=torch.float64)
5 gae_duplicate tensor(-1.7316, dtype=torch.float64) tensor(30.2821, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4202, dtype=torch.float64) delta_t tensor(0.4912, dtype=torch.float64)
4 gae_duplicate tensor(-0.2494, dtype=torch.float64) tensor(-6.2778, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7532, dtype=torch.float64) delta_t tensor(-1.8440, dtype=torch.float64)
3 gae_duplicate tensor(-2.3960, dtype=torch.float64) tensor(36.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7771, dtype=torch.float64) delta_t tensor(0.8361, dtype=torch.float64)
2 gae_duplicate tensor(0.0812, dtype=torch.float64) tensor(-13.3925, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-830.3670654296875
value loss:116.9906997680664
entropies:352.62548828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.572014093399048 seconds
19 rew tensor(1.2035, dtype=torch.float64) delta_t tensor(0.6178, dtype=torch.float64)
19 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-12.5307, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1407, dtype=torch.float64) delta_t tensor(0.6226, dtype=torch.float64)
18 gae_duplicate tensor(0.5593, dtype=torch.float64) tensor(-12.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0524, dtype=torch.float64) delta_t tensor(0.5598, dtype=torch.float64)
17 gae_duplicate tensor(0.3746, dtype=torch.float64) tensor(-11.8282, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7513, dtype=torch.float64) delta_t tensor(0.2143, dtype=torch.float64)
16 gae_duplicate tensor(-0.9410, dtype=torch.float64) tensor(-5.0065, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8990, dtype=torch.float64) delta_t tensor(0.4696, dtype=torch.float64)
15 gae_duplicate tensor(0.2980, dtype=torch.float64) tensor(-9.6856, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8119, dtype=torch.float64) delta_t tensor(0.4630, dtype=torch.float64)
14 gae_duplicate tensor(0.2123, dtype=torch.float64) tensor(-9.8317, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7604, dtype=torch.float64) delta_t tensor(0.4479, dtype=torch.float64)
13 gae_duplicate tensor(0.1583, dtype=torch.float64) tensor(-9.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3682, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
12 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(-2.7472, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.6343, dtype=torch.float64) delta_t tensor(-0.9316, dtype=torch.float64)
11 gae_duplicate tensor(-6.0808, dtype=torch.float64) tensor(20.4365, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.6328, dtype=torch.float64) delta_t tensor(-0.6781, dtype=torch.float64)
10 gae_duplicate tensor(-3.4167, dtype=torch.float64) tensor(14.5642, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2933, dtype=torch.float64) delta_t tensor(0.2128, dtype=torch.float64)
9 gae_duplicate tensor(-0.5876, dtype=torch.float64) tensor(-2.6136, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4770, dtype=torch.float64) delta_t tensor(-0.7338, dtype=torch.float64)
8 gae_duplicate tensor(-1.0663, dtype=torch.float64) tensor(13.7261, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6640, dtype=torch.float64) delta_t tensor(-0.6942, dtype=torch.float64)
7 gae_duplicate tensor(-1.4267, dtype=torch.float64) tensor(15.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6278, dtype=torch.float64) delta_t tensor(-0.5514, dtype=torch.float64)
6 gae_duplicate tensor(-1.0981, dtype=torch.float64) tensor(12.3601, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4788, dtype=torch.float64) delta_t tensor(-1.2420, dtype=torch.float64)
5 gae_duplicate tensor(-1.7028, dtype=torch.float64) tensor(24.7649, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1604, dtype=torch.float64) delta_t tensor(-0.0675, dtype=torch.float64)
4 gae_duplicate tensor(-0.8077, dtype=torch.float64) tensor(3.5752, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0465, dtype=torch.float64) delta_t tensor(-1.0982, dtype=torch.float64)
3 gae_duplicate tensor(-2.0248, dtype=torch.float64) tensor(21.1958, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1672, dtype=torch.float64) delta_t tensor(0.2320, dtype=torch.float64)
2 gae_duplicate tensor(-0.4494, dtype=torch.float64) tensor(-2.1191, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2654.656982421875
value loss:153.44351196289062
entropies:352.7781066894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.295018911361694 seconds
19 rew tensor(1.1901, dtype=torch.float64) delta_t tensor(0.5724, dtype=torch.float64)
19 gae_duplicate tensor(0.4112, dtype=torch.float64) tensor(-11.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1939, dtype=torch.float64) delta_t tensor(0.6563, dtype=torch.float64)
18 gae_duplicate tensor(0.5037, dtype=torch.float64) tensor(-13.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0534, dtype=torch.float64) delta_t tensor(0.4705, dtype=torch.float64)
17 gae_duplicate tensor(0.2526, dtype=torch.float64) tensor(-10.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0011, dtype=torch.float64) delta_t tensor(0.5002, dtype=torch.float64)
16 gae_duplicate tensor(0.2918, dtype=torch.float64) tensor(-10.6484, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9261, dtype=torch.float64) delta_t tensor(0.4872, dtype=torch.float64)
15 gae_duplicate tensor(0.3907, dtype=torch.float64) tensor(-11.1212, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6983, dtype=torch.float64) delta_t tensor(0.2119, dtype=torch.float64)
14 gae_duplicate tensor(-1.0573, dtype=torch.float64) tensor(-4.4778, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6699, dtype=torch.float64) delta_t tensor(0.3028, dtype=torch.float64)
13 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-6.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1684, dtype=torch.float64) delta_t tensor(-0.1937, dtype=torch.float64)
12 gae_duplicate tensor(-0.7050, dtype=torch.float64) tensor(3.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3989, dtype=torch.float64) delta_t tensor(-0.6487, dtype=torch.float64)
11 gae_duplicate tensor(-4.1633, dtype=torch.float64) tensor(14.9658, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0966, dtype=torch.float64) delta_t tensor(-0.2022, dtype=torch.float64)
10 gae_duplicate tensor(-1.3482, dtype=torch.float64) tensor(5.7621, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1441, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
9 gae_duplicate tensor(-0.0065, dtype=torch.float64) tensor(-1.8535, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3795, dtype=torch.float64) delta_t tensor(-0.6149, dtype=torch.float64)
8 gae_duplicate tensor(-0.7883, dtype=torch.float64) tensor(12.5120, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0623, dtype=torch.float64) delta_t tensor(-0.9377, dtype=torch.float64)
7 gae_duplicate tensor(-1.5264, dtype=torch.float64) tensor(19.5109, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6215, dtype=torch.float64) delta_t tensor(-0.5179, dtype=torch.float64)
6 gae_duplicate tensor(-1.4829, dtype=torch.float64) tensor(12.9550, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5328, dtype=torch.float64) delta_t tensor(-1.2512, dtype=torch.float64)
5 gae_duplicate tensor(-1.6406, dtype=torch.float64) tensor(25.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2078, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
4 gae_duplicate tensor(-0.3062, dtype=torch.float64) tensor(-2.8119, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4435, dtype=torch.float64) delta_t tensor(-1.5696, dtype=torch.float64)
3 gae_duplicate tensor(-2.1551, dtype=torch.float64) tensor(29.9440, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5591, dtype=torch.float64) delta_t tensor(0.6430, dtype=torch.float64)
2 gae_duplicate tensor(-0.0227, dtype=torch.float64) tensor(-9.0738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2412.765380859375
value loss:119.96104431152344
entropies:352.88616943359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.999612808227539 seconds
19 rew tensor(1.1891, dtype=torch.float64) delta_t tensor(0.6014, dtype=torch.float64)
19 gae_duplicate tensor(0.3902, dtype=torch.float64) tensor(-11.9895, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1921, dtype=torch.float64) delta_t tensor(0.6639, dtype=torch.float64)
18 gae_duplicate tensor(0.5329, dtype=torch.float64) tensor(-14.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0789, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
17 gae_duplicate tensor(0.3716, dtype=torch.float64) tensor(-12.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0954, dtype=torch.float64) delta_t tensor(0.5336, dtype=torch.float64)
16 gae_duplicate tensor(0.3690, dtype=torch.float64) tensor(-12.2473, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0060, dtype=torch.float64) delta_t tensor(0.5651, dtype=torch.float64)
15 gae_duplicate tensor(0.3529, dtype=torch.float64) tensor(-12.2049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0336, dtype=torch.float64) delta_t tensor(-0.5259, dtype=torch.float64)
14 gae_duplicate tensor(-1.3594, dtype=torch.float64) tensor(8.3374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4000, dtype=torch.float64) delta_t tensor(0.1634, dtype=torch.float64)
13 gae_duplicate tensor(-1.2741, dtype=torch.float64) tensor(-2.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3921, dtype=torch.float64) delta_t tensor(0.1355, dtype=torch.float64)
12 gae_duplicate tensor(-0.0454, dtype=torch.float64) tensor(-2.9768, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5767, dtype=torch.float64) delta_t tensor(0.3237, dtype=torch.float64)
11 gae_duplicate tensor(-0.0876, dtype=torch.float64) tensor(-6.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1693, dtype=torch.float64) delta_t tensor(-0.2015, dtype=torch.float64)
10 gae_duplicate tensor(-0.3369, dtype=torch.float64) tensor(3.3423, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5904, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
9 gae_duplicate tensor(-0.1516, dtype=torch.float64) tensor(-10.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5877, dtype=torch.float64) delta_t tensor(-0.8329, dtype=torch.float64)
8 gae_duplicate tensor(-1.0293, dtype=torch.float64) tensor(14.6875, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0566, dtype=torch.float64) delta_t tensor(-1.0644, dtype=torch.float64)
7 gae_duplicate tensor(-2.6072, dtype=torch.float64) tensor(22.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7510, dtype=torch.float64) delta_t tensor(-0.5762, dtype=torch.float64)
6 gae_duplicate tensor(-1.1087, dtype=torch.float64) tensor(14.2940, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2960, dtype=torch.float64) delta_t tensor(-0.9095, dtype=torch.float64)
5 gae_duplicate tensor(-1.4040, dtype=torch.float64) tensor(18.4160, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1669, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
4 gae_duplicate tensor(-0.3172, dtype=torch.float64) tensor(-3.3820, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2685, dtype=torch.float64) delta_t tensor(-1.4079, dtype=torch.float64)
3 gae_duplicate tensor(-2.0860, dtype=torch.float64) tensor(27.4900, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.6618, dtype=torch.float64)
2 gae_duplicate tensor(-0.0320, dtype=torch.float64) tensor(-10.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-632.3658447265625
value loss:100.13953399658203
entropies:352.8076171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3936.2954)
ToM Target loss= tensor(2424.5317)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.189443111419678 seconds
19 rew tensor(1.1842, dtype=torch.float64) delta_t tensor(0.5335, dtype=torch.float64)
19 gae_duplicate tensor(0.2889, dtype=torch.float64) tensor(-10.1907, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1745, dtype=torch.float64) delta_t tensor(0.6222, dtype=torch.float64)
18 gae_duplicate tensor(0.4598, dtype=torch.float64) tensor(-13.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1014, dtype=torch.float64) delta_t tensor(0.5248, dtype=torch.float64)
17 gae_duplicate tensor(0.3943, dtype=torch.float64) tensor(-10.8882, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7539, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
16 gae_duplicate tensor(-1.1268, dtype=torch.float64) tensor(-3.6995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9480, dtype=torch.float64) delta_t tensor(0.4052, dtype=torch.float64)
15 gae_duplicate tensor(0.2968, dtype=torch.float64) tensor(-8.4408, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7790, dtype=torch.float64) delta_t tensor(0.3801, dtype=torch.float64)
14 gae_duplicate tensor(0.1077, dtype=torch.float64) tensor(-7.8693, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.2914, dtype=torch.float64)
13 gae_duplicate tensor(-0.0243, dtype=torch.float64) tensor(-6.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3134, dtype=torch.float64) delta_t tensor(-0.0866, dtype=torch.float64)
12 gae_duplicate tensor(-0.3265, dtype=torch.float64) tensor(1.0142, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1301, dtype=torch.float64) delta_t tensor(-0.3921, dtype=torch.float64)
11 gae_duplicate tensor(-3.3162, dtype=torch.float64) tensor(7.4723, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2455, dtype=torch.float64) delta_t tensor(-0.3630, dtype=torch.float64)
10 gae_duplicate tensor(-1.5589, dtype=torch.float64) tensor(8.7752, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3670, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
9 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-6.3055, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5281, dtype=torch.float64) delta_t tensor(-0.8164, dtype=torch.float64)
8 gae_duplicate tensor(-1.0827, dtype=torch.float64) tensor(15.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3985, dtype=torch.float64) delta_t tensor(-1.3662, dtype=torch.float64)
7 gae_duplicate tensor(-4.2741, dtype=torch.float64) tensor(30.4013, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6670, dtype=torch.float64) delta_t tensor(-0.5596, dtype=torch.float64)
6 gae_duplicate tensor(-1.2409, dtype=torch.float64) tensor(13.8874, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4774, dtype=torch.float64) delta_t tensor(-1.1275, dtype=torch.float64)
5 gae_duplicate tensor(-1.6127, dtype=torch.float64) tensor(24.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0624, dtype=torch.float64) delta_t tensor(0.1277, dtype=torch.float64)
4 gae_duplicate tensor(-0.8570, dtype=torch.float64) tensor(-0.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2902, dtype=torch.float64) delta_t tensor(-1.3658, dtype=torch.float64)
3 gae_duplicate tensor(-2.2897, dtype=torch.float64) tensor(26.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4132, dtype=torch.float64) delta_t tensor(0.5180, dtype=torch.float64)
2 gae_duplicate tensor(-0.1457, dtype=torch.float64) tensor(-8.0230, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2917.458740234375
value loss:132.79653930664062
entropies:352.8883972167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.973672866821289 seconds
19 rew tensor(1.2042, dtype=torch.float64) delta_t tensor(0.5169, dtype=torch.float64)
19 gae_duplicate tensor(0.4023, dtype=torch.float64) tensor(-10.1693, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1945, dtype=torch.float64) delta_t tensor(0.5727, dtype=torch.float64)
18 gae_duplicate tensor(0.5130, dtype=torch.float64) tensor(-12.2625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1459, dtype=torch.float64) delta_t tensor(0.5073, dtype=torch.float64)
17 gae_duplicate tensor(0.3820, dtype=torch.float64) tensor(-10.8456, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0718, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
16 gae_duplicate tensor(0.2086, dtype=torch.float64) tensor(-9.6146, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9963, dtype=torch.float64) delta_t tensor(0.3743, dtype=torch.float64)
15 gae_duplicate tensor(-0.0853, dtype=torch.float64) tensor(-8.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2534, dtype=torch.float64) delta_t tensor(-0.2230, dtype=torch.float64)
14 gae_duplicate tensor(-2.8393, dtype=torch.float64) tensor(3.0109, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.3039, dtype=torch.float64)
13 gae_duplicate tensor(-0.1880, dtype=torch.float64) tensor(-5.3471, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4921, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
12 gae_duplicate tensor(-0.3236, dtype=torch.float64) tensor(-2.4472, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0543, dtype=torch.float64) delta_t tensor(-0.2493, dtype=torch.float64)
11 gae_duplicate tensor(-2.6102, dtype=torch.float64) tensor(4.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7038, dtype=torch.float64) delta_t tensor(-0.8410, dtype=torch.float64)
10 gae_duplicate tensor(-4.4132, dtype=torch.float64) tensor(15.8947, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1518, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
9 gae_duplicate tensor(-1.6614, dtype=torch.float64) tensor(-1.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5546, dtype=torch.float64) delta_t tensor(-0.8127, dtype=torch.float64)
8 gae_duplicate tensor(-1.0894, dtype=torch.float64) tensor(16.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7926, dtype=torch.float64) delta_t tensor(-0.8107, dtype=torch.float64)
7 gae_duplicate tensor(-2.3386, dtype=torch.float64) tensor(17.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8815, dtype=torch.float64) delta_t tensor(-0.6280, dtype=torch.float64)
6 gae_duplicate tensor(-1.3393, dtype=torch.float64) tensor(14.2000, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1349, dtype=torch.float64) delta_t tensor(-0.9298, dtype=torch.float64)
5 gae_duplicate tensor(-1.6349, dtype=torch.float64) tensor(19.0707, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0952, dtype=torch.float64) delta_t tensor(-0.0581, dtype=torch.float64)
4 gae_duplicate tensor(-1.1398, dtype=torch.float64) tensor(3.3804, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9933, dtype=torch.float64) delta_t tensor(-1.0210, dtype=torch.float64)
3 gae_duplicate tensor(-2.4187, dtype=torch.float64) tensor(19.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.3614, dtype=torch.float64)
2 gae_duplicate tensor(-0.3763, dtype=torch.float64) tensor(-5.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2669.835205078125
value loss:145.2081298828125
entropies:352.80206298828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.048144102096558 seconds
19 rew tensor(1.1953, dtype=torch.float64) delta_t tensor(0.5350, dtype=torch.float64)
19 gae_duplicate tensor(0.3605, dtype=torch.float64) tensor(-10.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1603, dtype=torch.float64) delta_t tensor(0.5841, dtype=torch.float64)
18 gae_duplicate tensor(0.3621, dtype=torch.float64) tensor(-12.4227, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0981, dtype=torch.float64) delta_t tensor(0.5260, dtype=torch.float64)
17 gae_duplicate tensor(0.1900, dtype=torch.float64) tensor(-11.3172, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0362, dtype=torch.float64) delta_t tensor(0.4058, dtype=torch.float64)
16 gae_duplicate tensor(0.2328, dtype=torch.float64) tensor(-9.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9474, dtype=torch.float64) delta_t tensor(0.4140, dtype=torch.float64)
15 gae_duplicate tensor(0.2230, dtype=torch.float64) tensor(-9.3444, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2508, dtype=torch.float64) delta_t tensor(-0.3153, dtype=torch.float64)
14 gae_duplicate tensor(-1.5777, dtype=torch.float64) tensor(4.9507, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3516, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
13 gae_duplicate tensor(-0.9584, dtype=torch.float64) tensor(-2.5062, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3230, dtype=torch.float64) delta_t tensor(0.1710, dtype=torch.float64)
12 gae_duplicate tensor(-0.3254, dtype=torch.float64) tensor(-3.5700, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6212, dtype=torch.float64) delta_t tensor(0.3563, dtype=torch.float64)
11 gae_duplicate tensor(0.1717, dtype=torch.float64) tensor(-7.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1520, dtype=torch.float64) delta_t tensor(-0.2801, dtype=torch.float64)
10 gae_duplicate tensor(-0.4816, dtype=torch.float64) tensor(4.6958, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.7847, dtype=torch.float64) delta_t tensor(0.7001, dtype=torch.float64)
9 gae_duplicate tensor(0.0515, dtype=torch.float64) tensor(-12.9504, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6731, dtype=torch.float64) delta_t tensor(-0.9388, dtype=torch.float64)
8 gae_duplicate tensor(-1.0903, dtype=torch.float64) tensor(17.0013, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6960, dtype=torch.float64) delta_t tensor(-0.6250, dtype=torch.float64)
7 gae_duplicate tensor(-0.8565, dtype=torch.float64) tensor(14.5088, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7794, dtype=torch.float64) delta_t tensor(-0.5524, dtype=torch.float64)
6 gae_duplicate tensor(-0.8134, dtype=torch.float64) tensor(12.4873, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2797, dtype=torch.float64) delta_t tensor(-0.7996, dtype=torch.float64)
5 gae_duplicate tensor(-1.0205, dtype=torch.float64) tensor(15.7951, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0877, dtype=torch.float64) delta_t tensor(0.2124, dtype=torch.float64)
4 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-2.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2741, dtype=torch.float64) delta_t tensor(-1.4134, dtype=torch.float64)
3 gae_duplicate tensor(-1.8540, dtype=torch.float64) tensor(26.5252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4088, dtype=torch.float64) delta_t tensor(0.5305, dtype=torch.float64)
2 gae_duplicate tensor(0.1400, dtype=torch.float64) tensor(-7.3405, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-507.0223693847656
value loss:77.1949462890625
entropies:352.71075439453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.872175693511963 seconds
19 rew tensor(1.2231, dtype=torch.float64) delta_t tensor(0.5184, dtype=torch.float64)
19 gae_duplicate tensor(0.2842, dtype=torch.float64) tensor(-10.4417, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1483, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
18 gae_duplicate tensor(0.2281, dtype=torch.float64) tensor(-10.1698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0988, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
17 gae_duplicate tensor(0.3099, dtype=torch.float64) tensor(-10.0875, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0507, dtype=torch.float64) delta_t tensor(0.3511, dtype=torch.float64)
16 gae_duplicate tensor(0.0958, dtype=torch.float64) tensor(-7.7926, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9365, dtype=torch.float64) delta_t tensor(0.3381, dtype=torch.float64)
15 gae_duplicate tensor(0.2163, dtype=torch.float64) tensor(-7.2788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7622, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
14 gae_duplicate tensor(0.0196, dtype=torch.float64) tensor(-4.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6809, dtype=torch.float64) delta_t tensor(0.2944, dtype=torch.float64)
13 gae_duplicate tensor(-0.0538, dtype=torch.float64) tensor(-6.3973, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1325, dtype=torch.float64) delta_t tensor(-0.2198, dtype=torch.float64)
12 gae_duplicate tensor(-1.1037, dtype=torch.float64) tensor(3.9207, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4752, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
11 gae_duplicate tensor(-0.1991, dtype=torch.float64) tensor(-2.6117, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0066, dtype=torch.float64) delta_t tensor(-0.0240, dtype=torch.float64)
10 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(0.1737, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4324, dtype=torch.float64) delta_t tensor(0.5122, dtype=torch.float64)
9 gae_duplicate tensor(0.1736, dtype=torch.float64) tensor(-9.7146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5180, dtype=torch.float64) delta_t tensor(-0.8146, dtype=torch.float64)
8 gae_duplicate tensor(-1.0861, dtype=torch.float64) tensor(15.0323, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.3855, dtype=torch.float64) delta_t tensor(-2.1892, dtype=torch.float64)
7 gae_duplicate tensor(-5.3534, dtype=torch.float64) tensor(48.3062, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7619, dtype=torch.float64) delta_t tensor(-0.5112, dtype=torch.float64)
6 gae_duplicate tensor(-1.4869, dtype=torch.float64) tensor(13.7759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4587, dtype=torch.float64) delta_t tensor(-0.9809, dtype=torch.float64)
5 gae_duplicate tensor(-1.2945, dtype=torch.float64) tensor(21.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3654, dtype=torch.float64) delta_t tensor(0.4969, dtype=torch.float64)
4 gae_duplicate tensor(0.0691, dtype=torch.float64) tensor(-7.3417, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6771, dtype=torch.float64) delta_t tensor(-1.8258, dtype=torch.float64)
3 gae_duplicate tensor(-2.4031, dtype=torch.float64) tensor(35.6661, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7003, dtype=torch.float64) delta_t tensor(0.8368, dtype=torch.float64)
2 gae_duplicate tensor(0.3422, dtype=torch.float64) tensor(-12.2639, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2782.344970703125
value loss:156.9549560546875
entropies:352.70416259765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.89885401725769 seconds
19 rew tensor(1.1758, dtype=torch.float64) delta_t tensor(0.2563, dtype=torch.float64)
19 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-5.1524, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1786, dtype=torch.float64) delta_t tensor(0.3316, dtype=torch.float64)
18 gae_duplicate tensor(0.2013, dtype=torch.float64) tensor(-7.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0942, dtype=torch.float64) delta_t tensor(0.4527, dtype=torch.float64)
17 gae_duplicate tensor(0.3983, dtype=torch.float64) tensor(-9.2458, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
16 gae_duplicate tensor(0.0756, dtype=torch.float64) tensor(-5.0747, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8541, dtype=torch.float64) delta_t tensor(0.2657, dtype=torch.float64)
15 gae_duplicate tensor(0.1328, dtype=torch.float64) tensor(-5.7766, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7400, dtype=torch.float64) delta_t tensor(0.1490, dtype=torch.float64)
14 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-3.6540, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6580, dtype=torch.float64) delta_t tensor(0.3280, dtype=torch.float64)
13 gae_duplicate tensor(0.1493, dtype=torch.float64) tensor(-6.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4602, dtype=torch.float64) delta_t tensor(0.0197, dtype=torch.float64)
12 gae_duplicate tensor(-0.3368, dtype=torch.float64) tensor(-0.9756, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2927, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
11 gae_duplicate tensor(-0.5458, dtype=torch.float64) tensor(0.7559, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1802, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
10 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(-1.6019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0344, dtype=torch.float64) delta_t tensor(0.1549, dtype=torch.float64)
9 gae_duplicate tensor(-0.1048, dtype=torch.float64) tensor(-2.9467, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3858, dtype=torch.float64) delta_t tensor(-0.6999, dtype=torch.float64)
8 gae_duplicate tensor(-1.1425, dtype=torch.float64) tensor(13.1828, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1393, dtype=torch.float64) delta_t tensor(-1.8931, dtype=torch.float64)
7 gae_duplicate tensor(-4.3164, dtype=torch.float64) tensor(39.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5347, dtype=torch.float64) delta_t tensor(-0.3238, dtype=torch.float64)
6 gae_duplicate tensor(-1.3244, dtype=torch.float64) tensor(10.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6643, dtype=torch.float64) delta_t tensor(-1.1394, dtype=torch.float64)
5 gae_duplicate tensor(-1.3882, dtype=torch.float64) tensor(23.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4088, dtype=torch.float64) delta_t tensor(0.5519, dtype=torch.float64)
4 gae_duplicate tensor(-0.1535, dtype=torch.float64) tensor(-8.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7102, dtype=torch.float64) delta_t tensor(-1.8766, dtype=torch.float64)
3 gae_duplicate tensor(-2.4920, dtype=torch.float64) tensor(35.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.7544, dtype=torch.float64) delta_t tensor(0.9020, dtype=torch.float64)
2 gae_duplicate tensor(0.1325, dtype=torch.float64) tensor(-13.8963, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2958.888671875
value loss:125.62146759033203
entropies:352.4958801269531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.5925)
ToM Target loss= tensor(2393.9102)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.916759729385376 seconds
19 rew tensor(1.1266, dtype=torch.float64) delta_t tensor(0.3224, dtype=torch.float64)
19 gae_duplicate tensor(0.2412, dtype=torch.float64) tensor(-6.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1542, dtype=torch.float64) delta_t tensor(0.4311, dtype=torch.float64)
18 gae_duplicate tensor(0.4003, dtype=torch.float64) tensor(-9.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0284, dtype=torch.float64) delta_t tensor(0.3479, dtype=torch.float64)
17 gae_duplicate tensor(0.1826, dtype=torch.float64) tensor(-7.3598, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9552, dtype=torch.float64) delta_t tensor(0.3208, dtype=torch.float64)
16 gae_duplicate tensor(0.2261, dtype=torch.float64) tensor(-6.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8653, dtype=torch.float64) delta_t tensor(0.1468, dtype=torch.float64)
15 gae_duplicate tensor(-0.0647, dtype=torch.float64) tensor(-3.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(-0.0426, dtype=torch.float64)
14 gae_duplicate tensor(-1.0043, dtype=torch.float64) tensor(0.6454, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2988, dtype=torch.float64) delta_t tensor(-0.0605, dtype=torch.float64)
13 gae_duplicate tensor(-1.1086, dtype=torch.float64) tensor(1.0613, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4798, dtype=torch.float64) delta_t tensor(0.1557, dtype=torch.float64)
12 gae_duplicate tensor(-0.3355, dtype=torch.float64) tensor(-3.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3972, dtype=torch.float64) delta_t tensor(0.1844, dtype=torch.float64)
11 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(-3.8979, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0586, dtype=torch.float64) delta_t tensor(-0.1017, dtype=torch.float64)
10 gae_duplicate tensor(-0.5322, dtype=torch.float64) tensor(1.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3278, dtype=torch.float64) delta_t tensor(0.3088, dtype=torch.float64)
9 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-6.4105, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5096, dtype=torch.float64) delta_t tensor(-0.7760, dtype=torch.float64)
8 gae_duplicate tensor(-1.1283, dtype=torch.float64) tensor(14.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9827, dtype=torch.float64) delta_t tensor(-0.8874, dtype=torch.float64)
7 gae_duplicate tensor(-1.8658, dtype=torch.float64) tensor(19.9891, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6025, dtype=torch.float64) delta_t tensor(-0.2883, dtype=torch.float64)
6 gae_duplicate tensor(-0.6807, dtype=torch.float64) tensor(7.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4171, dtype=torch.float64) delta_t tensor(-0.9326, dtype=torch.float64)
5 gae_duplicate tensor(-1.4236, dtype=torch.float64) tensor(18.0455, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1929, dtype=torch.float64) delta_t tensor(0.3664, dtype=torch.float64)
4 gae_duplicate tensor(-0.3043, dtype=torch.float64) tensor(-5.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3303, dtype=torch.float64) delta_t tensor(-1.4174, dtype=torch.float64)
3 gae_duplicate tensor(-2.2387, dtype=torch.float64) tensor(27.9565, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5485, dtype=torch.float64) delta_t tensor(0.6896, dtype=torch.float64)
2 gae_duplicate tensor(-0.0598, dtype=torch.float64) tensor(-11.0060, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1618.20361328125
value loss:73.7439193725586
entropies:352.33697509765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.773507833480835 seconds
19 rew tensor(1.1430, dtype=torch.float64) delta_t tensor(0.3184, dtype=torch.float64)
19 gae_duplicate tensor(0.1582, dtype=torch.float64) tensor(-6.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1211, dtype=torch.float64) delta_t tensor(0.4010, dtype=torch.float64)
18 gae_duplicate tensor(0.2374, dtype=torch.float64) tensor(-8.2888, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.2695, dtype=torch.float64)
17 gae_duplicate tensor(0.1197, dtype=torch.float64) tensor(-5.9851, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9938, dtype=torch.float64) delta_t tensor(0.2575, dtype=torch.float64)
16 gae_duplicate tensor(0.1231, dtype=torch.float64) tensor(-5.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.2680, dtype=torch.float64)
15 gae_duplicate tensor(0.0857, dtype=torch.float64) tensor(-5.9846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
14 gae_duplicate tensor(-1.2470, dtype=torch.float64) tensor(-0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5876, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
13 gae_duplicate tensor(-0.0160, dtype=torch.float64) tensor(-2.8401, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2666, dtype=torch.float64) delta_t tensor(-0.1819, dtype=torch.float64)
12 gae_duplicate tensor(-0.3882, dtype=torch.float64) tensor(3.0734, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5379, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
11 gae_duplicate tensor(-0.4174, dtype=torch.float64) tensor(-2.7914, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0625, dtype=torch.float64) delta_t tensor(-0.1788, dtype=torch.float64)
10 gae_duplicate tensor(-0.5628, dtype=torch.float64) tensor(3.3432, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4420, dtype=torch.float64) delta_t tensor(0.3680, dtype=torch.float64)
9 gae_duplicate tensor(0.0744, dtype=torch.float64) tensor(-6.7983, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4890, dtype=torch.float64) delta_t tensor(-0.7386, dtype=torch.float64)
8 gae_duplicate tensor(-1.2659, dtype=torch.float64) tensor(13.4077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4739, dtype=torch.float64) delta_t tensor(-0.4381, dtype=torch.float64)
7 gae_duplicate tensor(-1.2455, dtype=torch.float64) tensor(9.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7422, dtype=torch.float64) delta_t tensor(-0.4381, dtype=torch.float64)
6 gae_duplicate tensor(-1.0833, dtype=torch.float64) tensor(9.2180, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0027, dtype=torch.float64) delta_t tensor(-0.6149, dtype=torch.float64)
5 gae_duplicate tensor(-1.2854, dtype=torch.float64) tensor(12.3248, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2481, dtype=torch.float64) delta_t tensor(-0.1790, dtype=torch.float64)
4 gae_duplicate tensor(-1.5588, dtype=torch.float64) tensor(4.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6095, dtype=torch.float64) delta_t tensor(-0.5831, dtype=torch.float64)
3 gae_duplicate tensor(-1.7855, dtype=torch.float64) tensor(11.0605, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1202, dtype=torch.float64) delta_t tensor(0.3058, dtype=torch.float64)
2 gae_duplicate tensor(-0.5766, dtype=torch.float64) tensor(-5.0782, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-981.2872314453125
value loss:52.745201110839844
entropies:352.2721252441406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038455009460449 seconds
19 rew tensor(1.2015, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
19 gae_duplicate tensor(0.2168, dtype=torch.float64) tensor(-8.2291, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2180, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
18 gae_duplicate tensor(0.0504, dtype=torch.float64) tensor(-9.4650, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8690, dtype=torch.float64) delta_t tensor(0.1210, dtype=torch.float64)
17 gae_duplicate tensor(-1.0724, dtype=torch.float64) tensor(-3.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0405, dtype=torch.float64) delta_t tensor(0.2875, dtype=torch.float64)
16 gae_duplicate tensor(0.1007, dtype=torch.float64) tensor(-5.8906, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0301, dtype=torch.float64) delta_t tensor(0.4209, dtype=torch.float64)
15 gae_duplicate tensor(0.2347, dtype=torch.float64) tensor(-8.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1517, dtype=torch.float64) delta_t tensor(-0.3894, dtype=torch.float64)
14 gae_duplicate tensor(-2.8056, dtype=torch.float64) tensor(6.9332, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8149, dtype=torch.float64) delta_t tensor(0.4317, dtype=torch.float64)
13 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-7.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0211, dtype=torch.float64) delta_t tensor(-0.3210, dtype=torch.float64)
12 gae_duplicate tensor(-1.1830, dtype=torch.float64) tensor(5.2369, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0298, dtype=torch.float64) delta_t tensor(-0.3362, dtype=torch.float64)
11 gae_duplicate tensor(-4.3806, dtype=torch.float64) tensor(9.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3668, dtype=torch.float64) delta_t tensor(-0.3715, dtype=torch.float64)
10 gae_duplicate tensor(-1.3710, dtype=torch.float64) tensor(7.6403, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4809, dtype=torch.float64) delta_t tensor(0.4126, dtype=torch.float64)
9 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(-7.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6284, dtype=torch.float64) delta_t tensor(-0.9029, dtype=torch.float64)
8 gae_duplicate tensor(-1.1326, dtype=torch.float64) tensor(16.3674, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9632, dtype=torch.float64) delta_t tensor(-0.9626, dtype=torch.float64)
7 gae_duplicate tensor(-4.1287, dtype=torch.float64) tensor(21.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7580, dtype=torch.float64) delta_t tensor(-0.6404, dtype=torch.float64)
6 gae_duplicate tensor(-1.1681, dtype=torch.float64) tensor(14.7931, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1862, dtype=torch.float64) delta_t tensor(-0.6583, dtype=torch.float64)
5 gae_duplicate tensor(-1.0665, dtype=torch.float64) tensor(14.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0495, dtype=torch.float64) delta_t tensor(0.1119, dtype=torch.float64)
4 gae_duplicate tensor(-0.6472, dtype=torch.float64) tensor(-0.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0303, dtype=torch.float64) delta_t tensor(-0.9836, dtype=torch.float64)
3 gae_duplicate tensor(-2.1421, dtype=torch.float64) tensor(19.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2826, dtype=torch.float64) delta_t tensor(0.4076, dtype=torch.float64)
2 gae_duplicate tensor(-0.1453, dtype=torch.float64) tensor(-5.8687, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3354.290283203125
value loss:127.82405090332031
entropies:352.3348693847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.896428108215332 seconds
19 rew tensor(1.1149, dtype=torch.float64) delta_t tensor(0.2517, dtype=torch.float64)
19 gae_duplicate tensor(0.0816, dtype=torch.float64) tensor(-4.8437, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1171, dtype=torch.float64) delta_t tensor(0.3702, dtype=torch.float64)
18 gae_duplicate tensor(0.2546, dtype=torch.float64) tensor(-7.6262, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9662, dtype=torch.float64) delta_t tensor(0.2594, dtype=torch.float64)
17 gae_duplicate tensor(0.0630, dtype=torch.float64) tensor(-5.9764, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9675, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
16 gae_duplicate tensor(0.1733, dtype=torch.float64) tensor(-5.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8312, dtype=torch.float64) delta_t tensor(0.1963, dtype=torch.float64)
15 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-4.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
14 gae_duplicate tensor(-1.4653, dtype=torch.float64) tensor(-0.2003, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6294, dtype=torch.float64) delta_t tensor(0.2035, dtype=torch.float64)
13 gae_duplicate tensor(-0.0298, dtype=torch.float64) tensor(-4.0756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2910, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
12 gae_duplicate tensor(-0.3899, dtype=torch.float64) tensor(1.7878, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5706, dtype=torch.float64) delta_t tensor(0.1514, dtype=torch.float64)
11 gae_duplicate tensor(-0.4328, dtype=torch.float64) tensor(-3.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1177, dtype=torch.float64) delta_t tensor(-0.1602, dtype=torch.float64)
10 gae_duplicate tensor(-0.3775, dtype=torch.float64) tensor(3.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3482, dtype=torch.float64) delta_t tensor(0.3276, dtype=torch.float64)
9 gae_duplicate tensor(0.0091, dtype=torch.float64) tensor(-6.0271, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3991, dtype=torch.float64) delta_t tensor(-0.6964, dtype=torch.float64)
8 gae_duplicate tensor(-0.9939, dtype=torch.float64) tensor(12.6990, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6849, dtype=torch.float64) delta_t tensor(-0.6360, dtype=torch.float64)
7 gae_duplicate tensor(-1.1477, dtype=torch.float64) tensor(13.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6164, dtype=torch.float64) delta_t tensor(-0.2979, dtype=torch.float64)
6 gae_duplicate tensor(-0.5741, dtype=torch.float64) tensor(7.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2553, dtype=torch.float64) delta_t tensor(-0.7050, dtype=torch.float64)
5 gae_duplicate tensor(-1.1541, dtype=torch.float64) tensor(13.8064, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0221, dtype=torch.float64) delta_t tensor(0.1573, dtype=torch.float64)
4 gae_duplicate tensor(-0.6819, dtype=torch.float64) tensor(-1.8038, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9127, dtype=torch.float64) delta_t tensor(-0.9185, dtype=torch.float64)
3 gae_duplicate tensor(-1.6289, dtype=torch.float64) tensor(17.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.5129, dtype=torch.float64)
2 gae_duplicate tensor(-0.3709, dtype=torch.float64) tensor(-7.9849, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1022.755126953125
value loss:49.44954299926758
entropies:352.2738342285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9505510330200195 seconds
19 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.3121, dtype=torch.float64)
19 gae_duplicate tensor(0.1416, dtype=torch.float64) tensor(-5.8878, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1362, dtype=torch.float64) delta_t tensor(0.3746, dtype=torch.float64)
18 gae_duplicate tensor(0.2436, dtype=torch.float64) tensor(-7.9718, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9976, dtype=torch.float64) delta_t tensor(0.3040, dtype=torch.float64)
17 gae_duplicate tensor(0.2306, dtype=torch.float64) tensor(-7.3053, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9221, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
16 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-0.8193, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8434, dtype=torch.float64) delta_t tensor(0.2112, dtype=torch.float64)
15 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-4.1360, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5889, dtype=torch.float64) delta_t tensor(0.1475, dtype=torch.float64)
14 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-3.6004, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6079, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
13 gae_duplicate tensor(-0.6748, dtype=torch.float64) tensor(-3.2509, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1123, dtype=torch.float64) delta_t tensor(-0.2762, dtype=torch.float64)
12 gae_duplicate tensor(-0.4159, dtype=torch.float64) tensor(5.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5292, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
11 gae_duplicate tensor(-0.3018, dtype=torch.float64) tensor(-0.2234, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1920, dtype=torch.float64) delta_t tensor(-0.3884, dtype=torch.float64)
10 gae_duplicate tensor(-0.6163, dtype=torch.float64) tensor(7.7164, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3458, dtype=torch.float64) delta_t tensor(0.3113, dtype=torch.float64)
9 gae_duplicate tensor(0.0113, dtype=torch.float64) tensor(-5.2886, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3703, dtype=torch.float64) delta_t tensor(-0.6898, dtype=torch.float64)
8 gae_duplicate tensor(-0.8038, dtype=torch.float64) tensor(13.7543, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5426, dtype=torch.float64) delta_t tensor(-0.6045, dtype=torch.float64)
7 gae_duplicate tensor(-1.2912, dtype=torch.float64) tensor(13.9810, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5733, dtype=torch.float64) delta_t tensor(-0.3038, dtype=torch.float64)
6 gae_duplicate tensor(-0.6550, dtype=torch.float64) tensor(7.2920, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2829, dtype=torch.float64) delta_t tensor(-0.7607, dtype=torch.float64)
5 gae_duplicate tensor(-1.2974, dtype=torch.float64) tensor(15.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2159, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
4 gae_duplicate tensor(-0.5656, dtype=torch.float64) tensor(0.3844, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7385, dtype=torch.float64) delta_t tensor(-0.5691, dtype=torch.float64)
3 gae_duplicate tensor(-1.2745, dtype=torch.float64) tensor(10.8347, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.2810, dtype=torch.float64)
2 gae_duplicate tensor(-0.2701, dtype=torch.float64) tensor(-4.1920, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1845.5283203125
value loss:37.132415771484375
entropies:352.3168640136719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.3093)
ToM Target loss= tensor(2374.1824)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.028846740722656 seconds
19 rew tensor(1.1337, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
19 gae_duplicate tensor(0.0540, dtype=torch.float64) tensor(-4.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1461, dtype=torch.float64) delta_t tensor(0.3605, dtype=torch.float64)
18 gae_duplicate tensor(0.2504, dtype=torch.float64) tensor(-7.4809, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0214, dtype=torch.float64) delta_t tensor(0.2422, dtype=torch.float64)
17 gae_duplicate tensor(0.0505, dtype=torch.float64) tensor(-5.2958, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9954, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
16 gae_duplicate tensor(0.1009, dtype=torch.float64) tensor(-5.1527, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9042, dtype=torch.float64) delta_t tensor(0.1722, dtype=torch.float64)
15 gae_duplicate tensor(0.0696, dtype=torch.float64) tensor(-3.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2710, dtype=torch.float64) delta_t tensor(-0.3203, dtype=torch.float64)
14 gae_duplicate tensor(-2.6031, dtype=torch.float64) tensor(5.9248, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4135, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
13 gae_duplicate tensor(-0.9781, dtype=torch.float64) tensor(1.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3592, dtype=torch.float64) delta_t tensor(-0.1182, dtype=torch.float64)
12 gae_duplicate tensor(-0.4118, dtype=torch.float64) tensor(2.3522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3899, dtype=torch.float64) delta_t tensor(-0.0527, dtype=torch.float64)
11 gae_duplicate tensor(-0.6168, dtype=torch.float64) tensor(0.8819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0458, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
10 gae_duplicate tensor(-0.5945, dtype=torch.float64) tensor(2.1125, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2566, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
9 gae_duplicate tensor(-0.2189, dtype=torch.float64) tensor(-5.4223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4048, dtype=torch.float64) delta_t tensor(-0.7031, dtype=torch.float64)
8 gae_duplicate tensor(-1.1282, dtype=torch.float64) tensor(13.1435, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2780, dtype=torch.float64) delta_t tensor(-1.2243, dtype=torch.float64)
7 gae_duplicate tensor(-3.4089, dtype=torch.float64) tensor(25.5997, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6114, dtype=torch.float64) delta_t tensor(-0.2394, dtype=torch.float64)
6 gae_duplicate tensor(-1.1781, dtype=torch.float64) tensor(7.2250, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3887, dtype=torch.float64) delta_t tensor(-0.7968, dtype=torch.float64)
5 gae_duplicate tensor(-1.5240, dtype=torch.float64) tensor(15.6230, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0360, dtype=torch.float64) delta_t tensor(0.2362, dtype=torch.float64)
4 gae_duplicate tensor(-0.5657, dtype=torch.float64) tensor(-2.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1306, dtype=torch.float64) delta_t tensor(-1.1034, dtype=torch.float64)
3 gae_duplicate tensor(-1.9684, dtype=torch.float64) tensor(20.6274, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3812, dtype=torch.float64) delta_t tensor(0.5450, dtype=torch.float64)
2 gae_duplicate tensor(-0.0770, dtype=torch.float64) tensor(-9.2123, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2836.033447265625
value loss:80.86483001708984
entropies:352.2688293457031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.47793984413147 seconds
19 rew tensor(1.1468, dtype=torch.float64) delta_t tensor(0.2787, dtype=torch.float64)
19 gae_duplicate tensor(0.0548, dtype=torch.float64) tensor(-5.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8099, dtype=torch.float64) delta_t tensor(0.0280, dtype=torch.float64)
18 gae_duplicate tensor(-1.1985, dtype=torch.float64) tensor(-0.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0362, dtype=torch.float64) delta_t tensor(0.2792, dtype=torch.float64)
17 gae_duplicate tensor(0.0372, dtype=torch.float64) tensor(-5.4724, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0492, dtype=torch.float64) delta_t tensor(0.2743, dtype=torch.float64)
16 gae_duplicate tensor(0.2101, dtype=torch.float64) tensor(-6.3387, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9491, dtype=torch.float64) delta_t tensor(0.2092, dtype=torch.float64)
15 gae_duplicate tensor(0.0695, dtype=torch.float64) tensor(-4.6594, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7930, dtype=torch.float64) delta_t tensor(0.1902, dtype=torch.float64)
14 gae_duplicate tensor(0.1192, dtype=torch.float64) tensor(-4.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2344, dtype=torch.float64) delta_t tensor(-0.2865, dtype=torch.float64)
13 gae_duplicate tensor(-2.6281, dtype=torch.float64) tensor(6.5595, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1389, dtype=torch.float64) delta_t tensor(-0.2732, dtype=torch.float64)
12 gae_duplicate tensor(-1.4403, dtype=torch.float64) tensor(5.5529, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3699, dtype=torch.float64) delta_t tensor(-0.0288, dtype=torch.float64)
11 gae_duplicate tensor(-0.2159, dtype=torch.float64) tensor(1.1741, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0169, dtype=torch.float64) delta_t tensor(-0.1516, dtype=torch.float64)
10 gae_duplicate tensor(-0.5575, dtype=torch.float64) tensor(3.1791, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3195, dtype=torch.float64) delta_t tensor(0.2193, dtype=torch.float64)
9 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(-3.7617, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2725, dtype=torch.float64) delta_t tensor(-0.6254, dtype=torch.float64)
8 gae_duplicate tensor(-0.8971, dtype=torch.float64) tensor(12.6781, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7280, dtype=torch.float64) delta_t tensor(-0.7815, dtype=torch.float64)
7 gae_duplicate tensor(-1.1310, dtype=torch.float64) tensor(15.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5144, dtype=torch.float64) delta_t tensor(-0.1173, dtype=torch.float64)
6 gae_duplicate tensor(-0.7000, dtype=torch.float64) tensor(3.8067, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3343, dtype=torch.float64) delta_t tensor(-0.7953, dtype=torch.float64)
5 gae_duplicate tensor(-1.2168, dtype=torch.float64) tensor(16.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1194, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
4 gae_duplicate tensor(-0.5631, dtype=torch.float64) tensor(-0.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7595, dtype=torch.float64) delta_t tensor(-0.5985, dtype=torch.float64)
3 gae_duplicate tensor(-1.2071, dtype=torch.float64) tensor(11.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1265, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
2 gae_duplicate tensor(-0.5240, dtype=torch.float64) tensor(-4.6200, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2341.06103515625
value loss:52.158058166503906
entropies:352.33306884765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.495738983154297 seconds
19 rew tensor(1.1780, dtype=torch.float64) delta_t tensor(0.1886, dtype=torch.float64)
19 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-3.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1930, dtype=torch.float64) delta_t tensor(0.2727, dtype=torch.float64)
18 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(-5.3872, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1193, dtype=torch.float64) delta_t tensor(0.3090, dtype=torch.float64)
17 gae_duplicate tensor(0.1354, dtype=torch.float64) tensor(-6.7620, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0184, dtype=torch.float64) delta_t tensor(0.2308, dtype=torch.float64)
16 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-5.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8984, dtype=torch.float64) delta_t tensor(0.2266, dtype=torch.float64)
15 gae_duplicate tensor(0.0726, dtype=torch.float64) tensor(-5.1814, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0133, dtype=torch.float64) delta_t tensor(-0.5080, dtype=torch.float64)
14 gae_duplicate tensor(-1.5350, dtype=torch.float64) tensor(9.1793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4507, dtype=torch.float64) delta_t tensor(-0.0367, dtype=torch.float64)
13 gae_duplicate tensor(-1.5723, dtype=torch.float64) tensor(2.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1805, dtype=torch.float64) delta_t tensor(-0.3201, dtype=torch.float64)
12 gae_duplicate tensor(-0.4594, dtype=torch.float64) tensor(6.3911, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5428, dtype=torch.float64) delta_t tensor(0.0811, dtype=torch.float64)
11 gae_duplicate tensor(-0.3470, dtype=torch.float64) tensor(-0.6649, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0868, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
10 gae_duplicate tensor(-0.3759, dtype=torch.float64) tensor(2.3199, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4553, dtype=torch.float64) delta_t tensor(0.3527, dtype=torch.float64)
9 gae_duplicate tensor(0.0941, dtype=torch.float64) tensor(-6.6726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5594, dtype=torch.float64) delta_t tensor(-0.8409, dtype=torch.float64)
8 gae_duplicate tensor(-1.1086, dtype=torch.float64) tensor(16.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2912, dtype=torch.float64) delta_t tensor(-0.3054, dtype=torch.float64)
7 gae_duplicate tensor(-1.0347, dtype=torch.float64) tensor(7.5909, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7500, dtype=torch.float64) delta_t tensor(-0.3698, dtype=torch.float64)
6 gae_duplicate tensor(-0.7973, dtype=torch.float64) tensor(7.4655, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0342, dtype=torch.float64) delta_t tensor(-0.4810, dtype=torch.float64)
5 gae_duplicate tensor(-1.0186, dtype=torch.float64) tensor(10.0204, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3265, dtype=torch.float64) delta_t tensor(-0.1450, dtype=torch.float64)
4 gae_duplicate tensor(-1.1135, dtype=torch.float64) tensor(3.7060, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4977, dtype=torch.float64) delta_t tensor(-0.4076, dtype=torch.float64)
3 gae_duplicate tensor(-1.7897, dtype=torch.float64) tensor(9.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0077, dtype=torch.float64) delta_t tensor(0.2007, dtype=torch.float64)
2 gae_duplicate tensor(-0.3406, dtype=torch.float64) tensor(-2.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2133.471435546875
value loss:49.5502815246582
entropies:352.2740783691406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.172966241836548 seconds
19 rew tensor(1.1228, dtype=torch.float64) delta_t tensor(0.2154, dtype=torch.float64)
19 gae_duplicate tensor(0.1017, dtype=torch.float64) tensor(-4.1916, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(0.3380, dtype=torch.float64)
18 gae_duplicate tensor(0.2972, dtype=torch.float64) tensor(-7.2651, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0506, dtype=torch.float64) delta_t tensor(0.2346, dtype=torch.float64)
17 gae_duplicate tensor(0.0989, dtype=torch.float64) tensor(-5.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9734, dtype=torch.float64) delta_t tensor(0.1769, dtype=torch.float64)
16 gae_duplicate tensor(0.0129, dtype=torch.float64) tensor(-4.0918, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9346, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
15 gae_duplicate tensor(0.0789, dtype=torch.float64) tensor(-4.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2680, dtype=torch.float64) delta_t tensor(-0.3433, dtype=torch.float64)
14 gae_duplicate tensor(-2.5584, dtype=torch.float64) tensor(7.3684, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6759, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
13 gae_duplicate tensor(0.0591, dtype=torch.float64) tensor(-3.3989, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3735, dtype=torch.float64) delta_t tensor(-0.1208, dtype=torch.float64)
12 gae_duplicate tensor(-0.4265, dtype=torch.float64) tensor(2.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4263, dtype=torch.float64) delta_t tensor(0.1082, dtype=torch.float64)
11 gae_duplicate tensor(-0.3162, dtype=torch.float64) tensor(-1.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0169, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
10 gae_duplicate tensor(-0.6379, dtype=torch.float64) tensor(2.2359, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3079, dtype=torch.float64) delta_t tensor(0.3082, dtype=torch.float64)
9 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(-6.5661, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5159, dtype=torch.float64) delta_t tensor(-0.6991, dtype=torch.float64)
8 gae_duplicate tensor(-1.0328, dtype=torch.float64) tensor(13.0215, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0220, dtype=torch.float64) delta_t tensor(-0.9666, dtype=torch.float64)
7 gae_duplicate tensor(-3.4795, dtype=torch.float64) tensor(19.9460, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7739, dtype=torch.float64) delta_t tensor(-0.3691, dtype=torch.float64)
6 gae_duplicate tensor(-1.0368, dtype=torch.float64) tensor(8.8486, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1218, dtype=torch.float64) delta_t tensor(-0.5082, dtype=torch.float64)
5 gae_duplicate tensor(-1.3493, dtype=torch.float64) tensor(10.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0607, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
4 gae_duplicate tensor(-0.5497, dtype=torch.float64) tensor(-2.3158, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9094, dtype=torch.float64) delta_t tensor(-0.9190, dtype=torch.float64)
3 gae_duplicate tensor(-2.2273, dtype=torch.float64) tensor(18.3330, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2888, dtype=torch.float64) delta_t tensor(0.4644, dtype=torch.float64)
2 gae_duplicate tensor(-0.3389, dtype=torch.float64) tensor(-6.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2058.798583984375
value loss:77.90585327148438
entropies:352.201416015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.091727256774902 seconds
19 rew tensor(1.2401, dtype=torch.float64) delta_t tensor(0.2239, dtype=torch.float64)
19 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-4.3722, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2555, dtype=torch.float64) delta_t tensor(0.3865, dtype=torch.float64)
18 gae_duplicate tensor(0.0980, dtype=torch.float64) tensor(-8.0636, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2184, dtype=torch.float64) delta_t tensor(0.3003, dtype=torch.float64)
17 gae_duplicate tensor(-0.1559, dtype=torch.float64) tensor(-6.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7753, dtype=torch.float64) delta_t tensor(-0.0025, dtype=torch.float64)
16 gae_duplicate tensor(-1.2231, dtype=torch.float64) tensor(-0.4683, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8837, dtype=torch.float64) delta_t tensor(0.1705, dtype=torch.float64)
15 gae_duplicate tensor(-0.0222, dtype=torch.float64) tensor(-3.2562, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7543, dtype=torch.float64) delta_t tensor(0.1412, dtype=torch.float64)
14 gae_duplicate tensor(-0.0623, dtype=torch.float64) tensor(-3.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.5380, dtype=torch.float64) delta_t tensor(-1.0427, dtype=torch.float64)
13 gae_duplicate tensor(-2.8842, dtype=torch.float64) tensor(21.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2926, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
12 gae_duplicate tensor(-1.6029, dtype=torch.float64) tensor(6.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2669, dtype=torch.float64) delta_t tensor(0.1075, dtype=torch.float64)
11 gae_duplicate tensor(-0.3539, dtype=torch.float64) tensor(-1.2846, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2778, dtype=torch.float64) delta_t tensor(0.2278, dtype=torch.float64)
10 gae_duplicate tensor(-0.6026, dtype=torch.float64) tensor(-4.4325, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2573, dtype=torch.float64) delta_t tensor(0.2497, dtype=torch.float64)
9 gae_duplicate tensor(-0.2935, dtype=torch.float64) tensor(-5.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5879, dtype=torch.float64) delta_t tensor(-0.8591, dtype=torch.float64)
8 gae_duplicate tensor(-1.2150, dtype=torch.float64) tensor(16.7988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7518, dtype=torch.float64) delta_t tensor(-0.7051, dtype=torch.float64)
7 gae_duplicate tensor(-1.9075, dtype=torch.float64) tensor(14.8871, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6660, dtype=torch.float64) delta_t tensor(-0.1658, dtype=torch.float64)
6 gae_duplicate tensor(-0.4820, dtype=torch.float64) tensor(4.6623, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3852, dtype=torch.float64) delta_t tensor(-0.8146, dtype=torch.float64)
5 gae_duplicate tensor(-1.3252, dtype=torch.float64) tensor(16.1189, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0194, dtype=torch.float64) delta_t tensor(0.2930, dtype=torch.float64)
4 gae_duplicate tensor(-0.2578, dtype=torch.float64) tensor(-4.2019, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-1.0807, dtype=torch.float64)
3 gae_duplicate tensor(-2.1574, dtype=torch.float64) tensor(21.1322, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3546, dtype=torch.float64) delta_t tensor(0.5294, dtype=torch.float64)
2 gae_duplicate tensor(-0.0516, dtype=torch.float64) tensor(-8.7367, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2908.085205078125
value loss:83.62271881103516
entropies:352.0557556152344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3935.2500)
ToM Target loss= tensor(2366.5522)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.056473016738892 seconds
19 rew tensor(1.1858, dtype=torch.float64) delta_t tensor(0.2427, dtype=torch.float64)
19 gae_duplicate tensor(0.1221, dtype=torch.float64) tensor(-4.7306, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1482, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
18 gae_duplicate tensor(0.1453, dtype=torch.float64) tensor(-7.2881, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0337, dtype=torch.float64) delta_t tensor(0.2219, dtype=torch.float64)
17 gae_duplicate tensor(0.0873, dtype=torch.float64) tensor(-5.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0884, dtype=torch.float64) delta_t tensor(0.0250, dtype=torch.float64)
16 gae_duplicate tensor(-0.3538, dtype=torch.float64) tensor(-1.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9205, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
15 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-2.9630, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8731, dtype=torch.float64) delta_t tensor(0.2087, dtype=torch.float64)
14 gae_duplicate tensor(0.1154, dtype=torch.float64) tensor(-4.3268, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4628, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
13 gae_duplicate tensor(-1.3593, dtype=torch.float64) tensor(-1.2491, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1424, dtype=torch.float64) delta_t tensor(-0.5446, dtype=torch.float64)
12 gae_duplicate tensor(-2.1986, dtype=torch.float64) tensor(10.4208, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(-0.1515, dtype=torch.float64)
11 gae_duplicate tensor(-1.5208, dtype=torch.float64) tensor(4.9471, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1320, dtype=torch.float64) delta_t tensor(-0.1365, dtype=torch.float64)
10 gae_duplicate tensor(-0.5094, dtype=torch.float64) tensor(2.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5041, dtype=torch.float64) delta_t tensor(0.5672, dtype=torch.float64)
9 gae_duplicate tensor(-0.0583, dtype=torch.float64) tensor(-10.1162, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5269, dtype=torch.float64) delta_t tensor(-0.8403, dtype=torch.float64)
8 gae_duplicate tensor(-1.0944, dtype=torch.float64) tensor(14.8579, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9709, dtype=torch.float64) delta_t tensor(-0.8672, dtype=torch.float64)
7 gae_duplicate tensor(-2.2484, dtype=torch.float64) tensor(20.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7478, dtype=torch.float64) delta_t tensor(-0.1817, dtype=torch.float64)
6 gae_duplicate tensor(-0.6722, dtype=torch.float64) tensor(5.4970, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2445, dtype=torch.float64) delta_t tensor(-0.5953, dtype=torch.float64)
5 gae_duplicate tensor(-1.1185, dtype=torch.float64) tensor(11.8197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0153, dtype=torch.float64) delta_t tensor(0.2408, dtype=torch.float64)
4 gae_duplicate tensor(-0.5890, dtype=torch.float64) tensor(-3.5847, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0510, dtype=torch.float64) delta_t tensor(-1.0140, dtype=torch.float64)
3 gae_duplicate tensor(-2.1694, dtype=torch.float64) tensor(18.8996, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3460, dtype=torch.float64) delta_t tensor(0.5889, dtype=torch.float64)
2 gae_duplicate tensor(-0.3301, dtype=torch.float64) tensor(-9.5091, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2219.6884765625
value loss:72.40333557128906
entropies:352.0067443847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.887792110443115 seconds
19 rew tensor(1.0828, dtype=torch.float64) delta_t tensor(0.1013, dtype=torch.float64)
19 gae_duplicate tensor(-0.0353, dtype=torch.float64) tensor(-1.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1226, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
18 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-3.0322, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0611, dtype=torch.float64) delta_t tensor(0.1454, dtype=torch.float64)
17 gae_duplicate tensor(-0.0245, dtype=torch.float64) tensor(-3.2467, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0354, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
16 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-2.4944, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8422, dtype=torch.float64) delta_t tensor(0.0681, dtype=torch.float64)
15 gae_duplicate tensor(-0.0392, dtype=torch.float64) tensor(-1.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7439, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
14 gae_duplicate tensor(-0.2698, dtype=torch.float64) tensor(-0.7374, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6623, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
13 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-2.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3366, dtype=torch.float64) delta_t tensor(-0.1771, dtype=torch.float64)
12 gae_duplicate tensor(-0.4181, dtype=torch.float64) tensor(3.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4508, dtype=torch.float64) delta_t tensor(0.0092, dtype=torch.float64)
11 gae_duplicate tensor(-0.6363, dtype=torch.float64) tensor(0.2248, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0884, dtype=torch.float64) delta_t tensor(-0.2467, dtype=torch.float64)
10 gae_duplicate tensor(-0.5849, dtype=torch.float64) tensor(4.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3086, dtype=torch.float64) delta_t tensor(0.3736, dtype=torch.float64)
9 gae_duplicate tensor(0.0093, dtype=torch.float64) tensor(-6.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4241, dtype=torch.float64) delta_t tensor(-0.7356, dtype=torch.float64)
8 gae_duplicate tensor(-1.1336, dtype=torch.float64) tensor(13.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3616, dtype=torch.float64) delta_t tensor(-1.0839, dtype=torch.float64)
7 gae_duplicate tensor(-4.1319, dtype=torch.float64) tensor(21.7770, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6342, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
6 gae_duplicate tensor(-0.8435, dtype=torch.float64) tensor(4.3931, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3240, dtype=torch.float64) delta_t tensor(-0.6918, dtype=torch.float64)
5 gae_duplicate tensor(-1.2234, dtype=torch.float64) tensor(13.9933, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0398, dtype=torch.float64) delta_t tensor(0.2815, dtype=torch.float64)
4 gae_duplicate tensor(-0.5371, dtype=torch.float64) tensor(-3.7274, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0357, dtype=torch.float64) delta_t tensor(-0.9228, dtype=torch.float64)
3 gae_duplicate tensor(-2.0722, dtype=torch.float64) tensor(17.2505, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3883, dtype=torch.float64) delta_t tensor(0.5769, dtype=torch.float64)
2 gae_duplicate tensor(-0.3379, dtype=torch.float64) tensor(-9.6703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2462.6943359375
value loss:72.97966766357422
entropies:351.91400146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9085187911987305 seconds
19 rew tensor(1.1889, dtype=torch.float64) delta_t tensor(0.2101, dtype=torch.float64)
19 gae_duplicate tensor(0.0341, dtype=torch.float64) tensor(-4.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1770, dtype=torch.float64) delta_t tensor(0.3239, dtype=torch.float64)
18 gae_duplicate tensor(0.1334, dtype=torch.float64) tensor(-6.7227, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.5280, dtype=torch.float64) delta_t tensor(-0.2813, dtype=torch.float64)
17 gae_duplicate tensor(-1.2416, dtype=torch.float64) tensor(4.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9338, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
16 gae_duplicate tensor(-0.3095, dtype=torch.float64) tensor(-0.7613, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8072, dtype=torch.float64) delta_t tensor(0.0835, dtype=torch.float64)
15 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-1.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4563, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
14 gae_duplicate tensor(-1.8889, dtype=torch.float64) tensor(3.5179, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6666, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
13 gae_duplicate tensor(-0.1220, dtype=torch.float64) tensor(-2.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3217, dtype=torch.float64) delta_t tensor(-0.0586, dtype=torch.float64)
12 gae_duplicate tensor(-0.5009, dtype=torch.float64) tensor(0.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5503, dtype=torch.float64) delta_t tensor(0.1110, dtype=torch.float64)
11 gae_duplicate tensor(-0.5306, dtype=torch.float64) tensor(-2.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1120, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
10 gae_duplicate tensor(-0.6295, dtype=torch.float64) tensor(2.5396, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4758, dtype=torch.float64) delta_t tensor(0.4741, dtype=torch.float64)
9 gae_duplicate tensor(0.1025, dtype=torch.float64) tensor(-8.6709, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5664, dtype=torch.float64) delta_t tensor(-0.8494, dtype=torch.float64)
8 gae_duplicate tensor(-0.9390, dtype=torch.float64) tensor(16.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4198, dtype=torch.float64) delta_t tensor(-0.5275, dtype=torch.float64)
7 gae_duplicate tensor(-0.8717, dtype=torch.float64) tensor(12.9029, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6851, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
6 gae_duplicate tensor(-0.4143, dtype=torch.float64) tensor(1.7880, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2247, dtype=torch.float64) delta_t tensor(-0.6217, dtype=torch.float64)
5 gae_duplicate tensor(-1.1918, dtype=torch.float64) tensor(13.1268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2118, dtype=torch.float64) delta_t tensor(0.0854, dtype=torch.float64)
4 gae_duplicate tensor(-0.7239, dtype=torch.float64) tensor(-0.3159, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8246, dtype=torch.float64) delta_t tensor(-0.6651, dtype=torch.float64)
3 gae_duplicate tensor(-1.8461, dtype=torch.float64) tensor(13.1554, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1361, dtype=torch.float64) delta_t tensor(0.3145, dtype=torch.float64)
2 gae_duplicate tensor(-0.2387, dtype=torch.float64) tensor(-5.1911, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2066.21533203125
value loss:45.37111282348633
entropies:351.939453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.822610855102539 seconds
19 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(0.1898, dtype=torch.float64)
19 gae_duplicate tensor(0.0589, dtype=torch.float64) tensor(-3.5048, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1141, dtype=torch.float64) delta_t tensor(0.0812, dtype=torch.float64)
18 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(-1.6524, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0242, dtype=torch.float64) delta_t tensor(0.1568, dtype=torch.float64)
17 gae_duplicate tensor(0.0282, dtype=torch.float64) tensor(-3.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9506, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.3192, dtype=torch.float64) tensor(-0.9579, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8845, dtype=torch.float64) delta_t tensor(0.1415, dtype=torch.float64)
15 gae_duplicate tensor(0.0387, dtype=torch.float64) tensor(-2.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(-0.2342, dtype=torch.float64)
14 gae_duplicate tensor(-1.3772, dtype=torch.float64) tensor(4.1246, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6640, dtype=torch.float64) delta_t tensor(0.1507, dtype=torch.float64)
13 gae_duplicate tensor(-0.0369, dtype=torch.float64) tensor(-2.5195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2406, dtype=torch.float64) delta_t tensor(-0.2157, dtype=torch.float64)
12 gae_duplicate tensor(-0.5330, dtype=torch.float64) tensor(3.6045, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
11 gae_duplicate tensor(-0.4879, dtype=torch.float64) tensor(1.1883, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1225, dtype=torch.float64) delta_t tensor(-0.2646, dtype=torch.float64)
10 gae_duplicate tensor(-0.6025, dtype=torch.float64) tensor(5.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.3292, dtype=torch.float64)
9 gae_duplicate tensor(0.0101, dtype=torch.float64) tensor(-5.9117, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3558, dtype=torch.float64) delta_t tensor(-0.6629, dtype=torch.float64)
8 gae_duplicate tensor(-0.8192, dtype=torch.float64) tensor(12.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7759, dtype=torch.float64) delta_t tensor(-0.7052, dtype=torch.float64)
7 gae_duplicate tensor(-1.2553, dtype=torch.float64) tensor(14.9600, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5392, dtype=torch.float64) delta_t tensor(-0.0282, dtype=torch.float64)
6 gae_duplicate tensor(-0.4508, dtype=torch.float64) tensor(1.8663, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3955, dtype=torch.float64) delta_t tensor(-0.6769, dtype=torch.float64)
5 gae_duplicate tensor(-1.1854, dtype=torch.float64) tensor(14.2972, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0472, dtype=torch.float64) delta_t tensor(0.1767, dtype=torch.float64)
4 gae_duplicate tensor(-1.0322, dtype=torch.float64) tensor(-2.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9727, dtype=torch.float64) delta_t tensor(-0.7537, dtype=torch.float64)
3 gae_duplicate tensor(-1.4429, dtype=torch.float64) tensor(15.7842, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2758, dtype=torch.float64) delta_t tensor(0.4760, dtype=torch.float64)
2 gae_duplicate tensor(-0.3792, dtype=torch.float64) tensor(-7.6617, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2404.25244140625
value loss:40.040252685546875
entropies:351.8483581542969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.669059753417969 seconds
19 rew tensor(1.1285, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
19 gae_duplicate tensor(-0.0380, dtype=torch.float64) tensor(-2.2942, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0782, dtype=torch.float64) delta_t tensor(0.0919, dtype=torch.float64)
18 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-2.1216, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7033, dtype=torch.float64) delta_t tensor(-0.1290, dtype=torch.float64)
17 gae_duplicate tensor(-1.3077, dtype=torch.float64) tensor(1.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9904, dtype=torch.float64) delta_t tensor(0.1908, dtype=torch.float64)
16 gae_duplicate tensor(-0.0236, dtype=torch.float64) tensor(-3.7978, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8723, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
15 gae_duplicate tensor(-0.0074, dtype=torch.float64) tensor(-2.5365, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6318, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
14 gae_duplicate tensor(-0.0349, dtype=torch.float64) tensor(-2.8924, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7158, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
13 gae_duplicate tensor(0.0754, dtype=torch.float64) tensor(-4.6087, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2281, dtype=torch.float64) delta_t tensor(-0.1164, dtype=torch.float64)
12 gae_duplicate tensor(-0.4809, dtype=torch.float64) tensor(1.7819, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4442, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
11 gae_duplicate tensor(-0.5239, dtype=torch.float64) tensor(0.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1744, dtype=torch.float64) delta_t tensor(-0.2673, dtype=torch.float64)
10 gae_duplicate tensor(-0.5787, dtype=torch.float64) tensor(5.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3662, dtype=torch.float64) delta_t tensor(0.4120, dtype=torch.float64)
9 gae_duplicate tensor(0.0094, dtype=torch.float64) tensor(-7.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4597, dtype=torch.float64) delta_t tensor(-0.7440, dtype=torch.float64)
8 gae_duplicate tensor(-1.0140, dtype=torch.float64) tensor(14.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7311, dtype=torch.float64) delta_t tensor(-0.5650, dtype=torch.float64)
7 gae_duplicate tensor(-1.0621, dtype=torch.float64) tensor(12.9105, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5400, dtype=torch.float64) delta_t tensor(-0.0790, dtype=torch.float64)
6 gae_duplicate tensor(-0.6087, dtype=torch.float64) tensor(2.6194, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4532, dtype=torch.float64) delta_t tensor(-0.6964, dtype=torch.float64)
5 gae_duplicate tensor(-1.1275, dtype=torch.float64) tensor(13.3187, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0452, dtype=torch.float64) delta_t tensor(0.2977, dtype=torch.float64)
4 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(-4.5154, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0698, dtype=torch.float64) delta_t tensor(-0.9150, dtype=torch.float64)
3 gae_duplicate tensor(-1.6865, dtype=torch.float64) tensor(16.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(0.5191, dtype=torch.float64)
2 gae_duplicate tensor(-0.1568, dtype=torch.float64) tensor(-8.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1797.57763671875
value loss:39.66435623168945
entropies:351.6795654296875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.9668)
ToM Target loss= tensor(2354.0657)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.736365079879761 seconds
19 rew tensor(1.1850, dtype=torch.float64) delta_t tensor(0.1923, dtype=torch.float64)
19 gae_duplicate tensor(-0.0830, dtype=torch.float64) tensor(-3.7277, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1868, dtype=torch.float64) delta_t tensor(0.1939, dtype=torch.float64)
18 gae_duplicate tensor(-0.2996, dtype=torch.float64) tensor(-4.2950, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1639, dtype=torch.float64) delta_t tensor(0.3294, dtype=torch.float64)
17 gae_duplicate tensor(0.1913, dtype=torch.float64) tensor(-6.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1132, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
16 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(-3.4467, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1006, dtype=torch.float64) delta_t tensor(0.3004, dtype=torch.float64)
15 gae_duplicate tensor(0.0650, dtype=torch.float64) tensor(-5.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8691, dtype=torch.float64) delta_t tensor(0.1839, dtype=torch.float64)
14 gae_duplicate tensor(-0.2235, dtype=torch.float64) tensor(-3.8611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7699, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
13 gae_duplicate tensor(-1.1053, dtype=torch.float64) tensor(-3.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1801, dtype=torch.float64) delta_t tensor(-0.8273, dtype=torch.float64)
12 gae_duplicate tensor(-4.5056, dtype=torch.float64) tensor(14.9712, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.9027, dtype=torch.float64) delta_t tensor(-1.3643, dtype=torch.float64)
11 gae_duplicate tensor(-4.5014, dtype=torch.float64) tensor(29.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-1.1834, dtype=torch.float64) delta_t tensor(-1.2514, dtype=torch.float64)
10 gae_duplicate tensor(-4.1332, dtype=torch.float64) tensor(28.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1089, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
9 gae_duplicate tensor(-2.9509, dtype=torch.float64) tensor(4.9083, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4358, dtype=torch.float64) delta_t tensor(-0.6397, dtype=torch.float64)
8 gae_duplicate tensor(-1.0084, dtype=torch.float64) tensor(13.1486, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2794, dtype=torch.float64) delta_t tensor(-0.0471, dtype=torch.float64)
7 gae_duplicate tensor(-1.0018, dtype=torch.float64) tensor(2.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9121, dtype=torch.float64) delta_t tensor(-0.2757, dtype=torch.float64)
6 gae_duplicate tensor(-0.6808, dtype=torch.float64) tensor(5.9567, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9201, dtype=torch.float64) delta_t tensor(-0.4311, dtype=torch.float64)
5 gae_duplicate tensor(-1.0461, dtype=torch.float64) tensor(8.8298, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4606, dtype=torch.float64) delta_t tensor(-0.1629, dtype=torch.float64)
4 gae_duplicate tensor(-1.0387, dtype=torch.float64) tensor(4.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4784, dtype=torch.float64) delta_t tensor(-0.2256, dtype=torch.float64)
3 gae_duplicate tensor(-0.9656, dtype=torch.float64) tensor(6.0429, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1866, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
2 gae_duplicate tensor(-0.6783, dtype=torch.float64) tensor(-0.3693, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-4779.3125
value loss:165.04531860351562
entropies:351.47998046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.810945987701416 seconds
19 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(0.1979, dtype=torch.float64)
19 gae_duplicate tensor(0.0469, dtype=torch.float64) tensor(-3.8428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1862, dtype=torch.float64) delta_t tensor(0.2987, dtype=torch.float64)
18 gae_duplicate tensor(0.2008, dtype=torch.float64) tensor(-6.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1104, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
17 gae_duplicate tensor(-0.4184, dtype=torch.float64) tensor(-3.8666, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0197, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
16 gae_duplicate tensor(-0.3049, dtype=torch.float64) tensor(-2.9481, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8951, dtype=torch.float64) delta_t tensor(0.1326, dtype=torch.float64)
15 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(-2.9210, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7382, dtype=torch.float64) delta_t tensor(0.1103, dtype=torch.float64)
14 gae_duplicate tensor(-0.0153, dtype=torch.float64) tensor(-2.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4523, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
13 gae_duplicate tensor(-1.3855, dtype=torch.float64) tensor(1.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1733, dtype=torch.float64) delta_t tensor(-0.3451, dtype=torch.float64)
12 gae_duplicate tensor(-1.6056, dtype=torch.float64) tensor(6.6980, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3285, dtype=torch.float64) delta_t tensor(0.0017, dtype=torch.float64)
11 gae_duplicate tensor(-0.3390, dtype=torch.float64) tensor(1.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1536, dtype=torch.float64) delta_t tensor(0.2405, dtype=torch.float64)
10 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-4.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2022, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
9 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-5.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4184, dtype=torch.float64) delta_t tensor(-0.6191, dtype=torch.float64)
8 gae_duplicate tensor(-0.9673, dtype=torch.float64) tensor(11.5573, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3478, dtype=torch.float64) delta_t tensor(-1.1060, dtype=torch.float64)
7 gae_duplicate tensor(-4.5904, dtype=torch.float64) tensor(21.1001, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7148, dtype=torch.float64) delta_t tensor(-0.0694, dtype=torch.float64)
6 gae_duplicate tensor(-1.1240, dtype=torch.float64) tensor(3.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2426, dtype=torch.float64) delta_t tensor(-0.5315, dtype=torch.float64)
5 gae_duplicate tensor(-1.1072, dtype=torch.float64) tensor(10.0098, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0771, dtype=torch.float64) delta_t tensor(0.2664, dtype=torch.float64)
4 gae_duplicate tensor(-0.2888, dtype=torch.float64) tensor(-4.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9671, dtype=torch.float64) delta_t tensor(-0.8164, dtype=torch.float64)
3 gae_duplicate tensor(-2.0691, dtype=torch.float64) tensor(14.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2329, dtype=torch.float64) delta_t tensor(0.4410, dtype=torch.float64)
2 gae_duplicate tensor(-0.3286, dtype=torch.float64) tensor(-6.8493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1505.8787841796875
value loss:78.88553619384766
entropies:351.1852722167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.673664093017578 seconds
19 rew tensor(1.2150, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
19 gae_duplicate tensor(-0.4591, dtype=torch.float64) tensor(-0.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2042, dtype=torch.float64) delta_t tensor(0.3012, dtype=torch.float64)
18 gae_duplicate tensor(0.1066, dtype=torch.float64) tensor(-5.6816, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0487, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
17 gae_duplicate tensor(-0.4057, dtype=torch.float64) tensor(-2.4684, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9085, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
16 gae_duplicate tensor(-0.2839, dtype=torch.float64) tensor(0.2317, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8713, dtype=torch.float64) delta_t tensor(0.1483, dtype=torch.float64)
15 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-2.9955, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6484, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
14 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-2.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5452, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
13 gae_duplicate tensor(-0.1387, dtype=torch.float64) tensor(-1.3982, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2625, dtype=torch.float64) delta_t tensor(-0.1326, dtype=torch.float64)
12 gae_duplicate tensor(-0.4658, dtype=torch.float64) tensor(2.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2265, dtype=torch.float64) delta_t tensor(-0.2319, dtype=torch.float64)
11 gae_duplicate tensor(-2.1232, dtype=torch.float64) tensor(4.9875, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1424, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
10 gae_duplicate tensor(-0.5955, dtype=torch.float64) tensor(2.4559, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4597, dtype=torch.float64) delta_t tensor(0.4278, dtype=torch.float64)
9 gae_duplicate tensor(0.0211, dtype=torch.float64) tensor(-8.1459, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5625, dtype=torch.float64) delta_t tensor(-0.8136, dtype=torch.float64)
8 gae_duplicate tensor(-1.1303, dtype=torch.float64) tensor(15.4988, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4470, dtype=torch.float64) delta_t tensor(-0.3298, dtype=torch.float64)
7 gae_duplicate tensor(-1.0654, dtype=torch.float64) tensor(9.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7559, dtype=torch.float64) delta_t tensor(-0.1227, dtype=torch.float64)
6 gae_duplicate tensor(-0.5294, dtype=torch.float64) tensor(2.9532, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1917, dtype=torch.float64) delta_t tensor(-0.4593, dtype=torch.float64)
5 gae_duplicate tensor(-0.9928, dtype=torch.float64) tensor(8.7597, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2471, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
4 gae_duplicate tensor(-0.4181, dtype=torch.float64) tensor(-0.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7872, dtype=torch.float64) delta_t tensor(-0.5685, dtype=torch.float64)
3 gae_duplicate tensor(-1.4845, dtype=torch.float64) tensor(10.6596, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1141, dtype=torch.float64) delta_t tensor(0.3199, dtype=torch.float64)
2 gae_duplicate tensor(-0.2601, dtype=torch.float64) tensor(-4.8033, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1608.3785400390625
value loss:39.55672073364258
entropies:351.02264404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9557530879974365 seconds
19 rew tensor(1.1903, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
19 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-1.8559, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1272, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
18 gae_duplicate tensor(-0.2829, dtype=torch.float64) tensor(-2.3416, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7423, dtype=torch.float64) delta_t tensor(-0.1295, dtype=torch.float64)
17 gae_duplicate tensor(-1.2776, dtype=torch.float64) tensor(1.9999, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9498, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
16 gae_duplicate tensor(-0.1054, dtype=torch.float64) tensor(-0.7907, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8073, dtype=torch.float64) delta_t tensor(0.0689, dtype=torch.float64)
15 gae_duplicate tensor(-0.0573, dtype=torch.float64) tensor(-1.4910, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6627, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
14 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-1.7672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6118, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
13 gae_duplicate tensor(-0.1265, dtype=torch.float64) tensor(-1.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3258, dtype=torch.float64) delta_t tensor(-0.0521, dtype=torch.float64)
12 gae_duplicate tensor(-0.5382, dtype=torch.float64) tensor(0.6132, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3780, dtype=torch.float64) delta_t tensor(-0.0778, dtype=torch.float64)
11 gae_duplicate tensor(-0.5806, dtype=torch.float64) tensor(1.2197, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0493, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
10 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(0.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3284, dtype=torch.float64) delta_t tensor(0.3997, dtype=torch.float64)
9 gae_duplicate tensor(0.0993, dtype=torch.float64) tensor(-7.3337, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4465, dtype=torch.float64) delta_t tensor(-0.6664, dtype=torch.float64)
8 gae_duplicate tensor(-0.9722, dtype=torch.float64) tensor(11.8945, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5719, dtype=torch.float64) delta_t tensor(-0.3493, dtype=torch.float64)
7 gae_duplicate tensor(-1.1013, dtype=torch.float64) tensor(8.5265, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6837, dtype=torch.float64) delta_t tensor(0.0049, dtype=torch.float64)
6 gae_duplicate tensor(-0.7491, dtype=torch.float64) tensor(0.7810, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2151, dtype=torch.float64) delta_t tensor(-0.5096, dtype=torch.float64)
5 gae_duplicate tensor(-1.0735, dtype=torch.float64) tensor(9.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3079, dtype=torch.float64) delta_t tensor(0.0459, dtype=torch.float64)
4 gae_duplicate tensor(-0.9320, dtype=torch.float64) tensor(0.2560, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6755, dtype=torch.float64) delta_t tensor(-0.3873, dtype=torch.float64)
3 gae_duplicate tensor(-1.1665, dtype=torch.float64) tensor(7.7143, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0277, dtype=torch.float64) delta_t tensor(0.2907, dtype=torch.float64)
2 gae_duplicate tensor(-0.2697, dtype=torch.float64) tensor(-5.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1231.7061767578125
value loss:34.68553161621094
entropies:350.83795166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.87309718132019 seconds
19 rew tensor(1.0892, dtype=torch.float64) delta_t tensor(0.0926, dtype=torch.float64)
19 gae_duplicate tensor(-0.0782, dtype=torch.float64) tensor(-2.0825, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1559, dtype=torch.float64) delta_t tensor(0.2406, dtype=torch.float64)
18 gae_duplicate tensor(0.0967, dtype=torch.float64) tensor(-4.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9737, dtype=torch.float64) delta_t tensor(0.0758, dtype=torch.float64)
17 gae_duplicate tensor(-0.0182, dtype=torch.float64) tensor(-1.8941, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9480, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
16 gae_duplicate tensor(-0.0332, dtype=torch.float64) tensor(-2.3545, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9243, dtype=torch.float64) delta_t tensor(0.1586, dtype=torch.float64)
15 gae_duplicate tensor(0.0728, dtype=torch.float64) tensor(-3.3535, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6357, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
14 gae_duplicate tensor(-0.0249, dtype=torch.float64) tensor(-1.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4296, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
13 gae_duplicate tensor(-1.4706, dtype=torch.float64) tensor(2.6720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2735, dtype=torch.float64) delta_t tensor(-0.1259, dtype=torch.float64)
12 gae_duplicate tensor(-0.2748, dtype=torch.float64) tensor(2.9554, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4210, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
11 gae_duplicate tensor(-0.3261, dtype=torch.float64) tensor(-0.4530, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0642, dtype=torch.float64) delta_t tensor(0.2371, dtype=torch.float64)
10 gae_duplicate tensor(-0.0687, dtype=torch.float64) tensor(-4.6324, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4314, dtype=torch.float64) delta_t tensor(0.3105, dtype=torch.float64)
9 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-6.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7027, dtype=torch.float64) delta_t tensor(-0.8938, dtype=torch.float64)
8 gae_duplicate tensor(-1.0398, dtype=torch.float64) tensor(16.3348, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1168, dtype=torch.float64) delta_t tensor(-0.1375, dtype=torch.float64)
7 gae_duplicate tensor(-0.8311, dtype=torch.float64) tensor(4.2028, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7152, dtype=torch.float64) delta_t tensor(-0.0325, dtype=torch.float64)
6 gae_duplicate tensor(-0.3012, dtype=torch.float64) tensor(1.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0844, dtype=torch.float64) delta_t tensor(-0.3453, dtype=torch.float64)
5 gae_duplicate tensor(-0.8017, dtype=torch.float64) tensor(6.6016, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3166, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
4 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(-1.0264, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5897, dtype=torch.float64) delta_t tensor(-0.3538, dtype=torch.float64)
3 gae_duplicate tensor(-1.2740, dtype=torch.float64) tensor(6.7471, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0468, dtype=torch.float64) delta_t tensor(0.2302, dtype=torch.float64)
2 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-3.9709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-514.7357788085938
value loss:25.151891708374023
entropies:350.60040283203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.6797)
ToM Target loss= tensor(2338.2549)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.017634868621826 seconds
19 rew tensor(1.1559, dtype=torch.float64) delta_t tensor(0.0903, dtype=torch.float64)
19 gae_duplicate tensor(0.0097, dtype=torch.float64) tensor(-1.7031, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1708, dtype=torch.float64) delta_t tensor(0.0916, dtype=torch.float64)
18 gae_duplicate tensor(-0.2023, dtype=torch.float64) tensor(-1.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0778, dtype=torch.float64) delta_t tensor(0.0777, dtype=torch.float64)
17 gae_duplicate tensor(-0.3023, dtype=torch.float64) tensor(-1.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9127, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
16 gae_duplicate tensor(-0.5028, dtype=torch.float64) tensor(-0.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(0.0853, dtype=torch.float64)
15 gae_duplicate tensor(-0.0585, dtype=torch.float64) tensor(-1.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6274, dtype=torch.float64) delta_t tensor(0.0495, dtype=torch.float64)
14 gae_duplicate tensor(-0.0584, dtype=torch.float64) tensor(-1.2142, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5743, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
13 gae_duplicate tensor(-0.3986, dtype=torch.float64) tensor(0.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3129, dtype=torch.float64) delta_t tensor(-0.1945, dtype=torch.float64)
12 gae_duplicate tensor(-0.4983, dtype=torch.float64) tensor(3.9506, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4297, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
11 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(-0.5881, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0377, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
10 gae_duplicate tensor(-0.4534, dtype=torch.float64) tensor(-0.5347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2637, dtype=torch.float64) delta_t tensor(0.2450, dtype=torch.float64)
9 gae_duplicate tensor(-0.2227, dtype=torch.float64) tensor(-4.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5978, dtype=torch.float64) delta_t tensor(-0.6622, dtype=torch.float64)
8 gae_duplicate tensor(-1.0138, dtype=torch.float64) tensor(12.2530, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5413, dtype=torch.float64) delta_t tensor(-0.3798, dtype=torch.float64)
7 gae_duplicate tensor(-1.8361, dtype=torch.float64) tensor(8.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6516, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
6 gae_duplicate tensor(-0.2908, dtype=torch.float64) tensor(0.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2779, dtype=torch.float64) delta_t tensor(-0.4842, dtype=torch.float64)
5 gae_duplicate tensor(-1.2676, dtype=torch.float64) tensor(10.0024, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0720, dtype=torch.float64) delta_t tensor(0.2579, dtype=torch.float64)
4 gae_duplicate tensor(-0.4540, dtype=torch.float64) tensor(-3.4624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9379, dtype=torch.float64) delta_t tensor(-0.6839, dtype=torch.float64)
3 gae_duplicate tensor(-2.1040, dtype=torch.float64) tensor(12.5638, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3052, dtype=torch.float64) delta_t tensor(0.5141, dtype=torch.float64)
2 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-8.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1248.61279296875
value loss:40.73296356201172
entropies:350.513916015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.793370008468628 seconds
19 rew tensor(1.1442, dtype=torch.float64) delta_t tensor(-0.0770, dtype=torch.float64)
19 gae_duplicate tensor(-0.4110, dtype=torch.float64) tensor(1.6466, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1708, dtype=torch.float64) delta_t tensor(0.2496, dtype=torch.float64)
18 gae_duplicate tensor(0.1675, dtype=torch.float64) tensor(-4.6180, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0550, dtype=torch.float64) delta_t tensor(0.1618, dtype=torch.float64)
17 gae_duplicate tensor(0.0415, dtype=torch.float64) tensor(-3.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9242, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
16 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-2.2725, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8726, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
15 gae_duplicate tensor(-0.5257, dtype=torch.float64) tensor(0.2597, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6393, dtype=torch.float64) delta_t tensor(-0.0384, dtype=torch.float64)
14 gae_duplicate tensor(-0.4584, dtype=torch.float64) tensor(0.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7313, dtype=torch.float64) delta_t tensor(0.1194, dtype=torch.float64)
13 gae_duplicate tensor(-0.0771, dtype=torch.float64) tensor(-2.0205, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0037, dtype=torch.float64) delta_t tensor(-0.5083, dtype=torch.float64)
12 gae_duplicate tensor(-1.4167, dtype=torch.float64) tensor(9.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3936, dtype=torch.float64) delta_t tensor(-0.1596, dtype=torch.float64)
11 gae_duplicate tensor(-0.8069, dtype=torch.float64) tensor(4.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0897, dtype=torch.float64) delta_t tensor(-0.0734, dtype=torch.float64)
10 gae_duplicate tensor(-0.5617, dtype=torch.float64) tensor(1.8337, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1579, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
9 gae_duplicate tensor(0.0217, dtype=torch.float64) tensor(-4.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5856, dtype=torch.float64) delta_t tensor(-0.7627, dtype=torch.float64)
8 gae_duplicate tensor(-0.8267, dtype=torch.float64) tensor(14.8458, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5646, dtype=torch.float64) delta_t tensor(-0.3689, dtype=torch.float64)
7 gae_duplicate tensor(-1.0332, dtype=torch.float64) tensor(9.1407, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6772, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
6 gae_duplicate tensor(-0.2607, dtype=torch.float64) tensor(-1.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3794, dtype=torch.float64) delta_t tensor(-0.5588, dtype=torch.float64)
5 gae_duplicate tensor(-0.8894, dtype=torch.float64) tensor(10.3209, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1114, dtype=torch.float64) delta_t tensor(0.2952, dtype=torch.float64)
4 gae_duplicate tensor(-0.2397, dtype=torch.float64) tensor(-4.5635, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0638, dtype=torch.float64) delta_t tensor(-0.6990, dtype=torch.float64)
3 gae_duplicate tensor(-1.7213, dtype=torch.float64) tensor(14.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2527, dtype=torch.float64) delta_t tensor(0.4556, dtype=torch.float64)
2 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-8.4116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2049.881591796875
value loss:34.33390426635742
entropies:350.37005615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.251924991607666 seconds
19 rew tensor(1.1307, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
19 gae_duplicate tensor(-0.0390, dtype=torch.float64) tensor(-2.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1859, dtype=torch.float64) delta_t tensor(0.2918, dtype=torch.float64)
18 gae_duplicate tensor(0.1496, dtype=torch.float64) tensor(-6.5153, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0419, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
17 gae_duplicate tensor(0.0249, dtype=torch.float64) tensor(-3.8472, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0172, dtype=torch.float64) delta_t tensor(0.1872, dtype=torch.float64)
16 gae_duplicate tensor(-0.0019, dtype=torch.float64) tensor(-3.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9407, dtype=torch.float64) delta_t tensor(0.1534, dtype=torch.float64)
15 gae_duplicate tensor(-0.0588, dtype=torch.float64) tensor(-3.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4463, dtype=torch.float64) delta_t tensor(-0.1616, dtype=torch.float64)
14 gae_duplicate tensor(-1.2955, dtype=torch.float64) tensor(2.5630, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1828, dtype=torch.float64) delta_t tensor(-0.3329, dtype=torch.float64)
13 gae_duplicate tensor(-2.9519, dtype=torch.float64) tensor(5.9682, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2129, dtype=torch.float64) delta_t tensor(-0.5837, dtype=torch.float64)
12 gae_duplicate tensor(-1.7409, dtype=torch.float64) tensor(11.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5565, dtype=torch.float64) delta_t tensor(0.1474, dtype=torch.float64)
11 gae_duplicate tensor(-0.3659, dtype=torch.float64) tensor(-1.7786, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0113, dtype=torch.float64) delta_t tensor(0.2912, dtype=torch.float64)
10 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(-5.5565, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4307, dtype=torch.float64) delta_t tensor(0.3957, dtype=torch.float64)
9 gae_duplicate tensor(0.1214, dtype=torch.float64) tensor(-7.9812, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5983, dtype=torch.float64) delta_t tensor(-0.8217, dtype=torch.float64)
8 gae_duplicate tensor(-0.9705, dtype=torch.float64) tensor(14.7399, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3168, dtype=torch.float64) delta_t tensor(-0.2019, dtype=torch.float64)
7 gae_duplicate tensor(-1.2700, dtype=torch.float64) tensor(5.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6634, dtype=torch.float64) delta_t tensor(-0.0829, dtype=torch.float64)
6 gae_duplicate tensor(-0.6501, dtype=torch.float64) tensor(2.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2059, dtype=torch.float64) delta_t tensor(-0.3552, dtype=torch.float64)
5 gae_duplicate tensor(-0.8991, dtype=torch.float64) tensor(7.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2123, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
4 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-2.4739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7595, dtype=torch.float64) delta_t tensor(-0.4940, dtype=torch.float64)
3 gae_duplicate tensor(-1.2221, dtype=torch.float64) tensor(10.7635, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1648, dtype=torch.float64) delta_t tensor(0.3641, dtype=torch.float64)
2 gae_duplicate tensor(-0.0358, dtype=torch.float64) tensor(-5.9353, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1048.692626953125
value loss:52.29967498779297
entropies:350.1302490234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.285931825637817 seconds
19 rew tensor(1.1689, dtype=torch.float64) delta_t tensor(0.0843, dtype=torch.float64)
19 gae_duplicate tensor(-0.0024, dtype=torch.float64) tensor(-1.5466, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1427, dtype=torch.float64) delta_t tensor(0.2201, dtype=torch.float64)
18 gae_duplicate tensor(0.1065, dtype=torch.float64) tensor(-4.4128, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0141, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
17 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-3.5032, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9742, dtype=torch.float64) delta_t tensor(0.1493, dtype=torch.float64)
16 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-3.1643, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8832, dtype=torch.float64) delta_t tensor(0.1147, dtype=torch.float64)
15 gae_duplicate tensor(-0.0486, dtype=torch.float64) tensor(-2.4474, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4760, dtype=torch.float64) delta_t tensor(-0.1097, dtype=torch.float64)
14 gae_duplicate tensor(-0.9996, dtype=torch.float64) tensor(1.7075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2267, dtype=torch.float64) delta_t tensor(-0.3128, dtype=torch.float64)
13 gae_duplicate tensor(-2.4119, dtype=torch.float64) tensor(6.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2712, dtype=torch.float64) delta_t tensor(-0.1386, dtype=torch.float64)
12 gae_duplicate tensor(-0.4836, dtype=torch.float64) tensor(4.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6138, dtype=torch.float64) delta_t tensor(0.3063, dtype=torch.float64)
11 gae_duplicate tensor(0.0661, dtype=torch.float64) tensor(-5.6292, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1165, dtype=torch.float64) delta_t tensor(-0.0791, dtype=torch.float64)
10 gae_duplicate tensor(-0.5784, dtype=torch.float64) tensor(0.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5931, dtype=torch.float64) delta_t tensor(0.4723, dtype=torch.float64)
9 gae_duplicate tensor(0.0363, dtype=torch.float64) tensor(-8.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7658, dtype=torch.float64) delta_t tensor(-0.8088, dtype=torch.float64)
8 gae_duplicate tensor(-0.9378, dtype=torch.float64) tensor(13.8698, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0304, dtype=torch.float64) delta_t tensor(-0.8240, dtype=torch.float64)
7 gae_duplicate tensor(-5.8654, dtype=torch.float64) tensor(21.6147, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8485, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
6 gae_duplicate tensor(-1.2336, dtype=torch.float64) tensor(2.7530, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9998, dtype=torch.float64) delta_t tensor(-0.2238, dtype=torch.float64)
5 gae_duplicate tensor(-0.6125, dtype=torch.float64) tensor(4.8165, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3686, dtype=torch.float64) delta_t tensor(0.0478, dtype=torch.float64)
4 gae_duplicate tensor(-0.1748, dtype=torch.float64) tensor(-0.4496, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6318, dtype=torch.float64) delta_t tensor(-0.2805, dtype=torch.float64)
3 gae_duplicate tensor(-1.1706, dtype=torch.float64) tensor(5.5353, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0102, dtype=torch.float64) delta_t tensor(0.1952, dtype=torch.float64)
2 gae_duplicate tensor(-0.0846, dtype=torch.float64) tensor(-3.0384, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1631.42041015625
value loss:84.65863037109375
entropies:349.7773132324219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.012868881225586 seconds
19 rew tensor(1.1453, dtype=torch.float64) delta_t tensor(0.1918, dtype=torch.float64)
19 gae_duplicate tensor(-0.0177, dtype=torch.float64) tensor(-3.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0803, dtype=torch.float64) delta_t tensor(0.1345, dtype=torch.float64)
18 gae_duplicate tensor(-0.4341, dtype=torch.float64) tensor(-2.4860, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7975, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
17 gae_duplicate tensor(-1.1946, dtype=torch.float64) tensor(1.5512, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0164, dtype=torch.float64) delta_t tensor(-0.0683, dtype=torch.float64)
16 gae_duplicate tensor(-0.4592, dtype=torch.float64) tensor(1.4673, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(0.1670, dtype=torch.float64)
15 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-3.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5943, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
14 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(-0.9841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7090, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
13 gae_duplicate tensor(-0.0375, dtype=torch.float64) tensor(-2.2829, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1899, dtype=torch.float64) delta_t tensor(-0.2078, dtype=torch.float64)
12 gae_duplicate tensor(-0.3010, dtype=torch.float64) tensor(3.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
11 gae_duplicate tensor(-0.3104, dtype=torch.float64) tensor(-0.5305, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1463, dtype=torch.float64) delta_t tensor(-0.1402, dtype=torch.float64)
10 gae_duplicate tensor(-0.7148, dtype=torch.float64) tensor(2.9071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(0.4174, dtype=torch.float64)
9 gae_duplicate tensor(0.0407, dtype=torch.float64) tensor(-7.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5755, dtype=torch.float64) delta_t tensor(-0.6501, dtype=torch.float64)
8 gae_duplicate tensor(-0.9649, dtype=torch.float64) tensor(12.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8613, dtype=torch.float64) delta_t tensor(-0.5752, dtype=torch.float64)
7 gae_duplicate tensor(-2.5015, dtype=torch.float64) tensor(14.8854, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6836, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
6 gae_duplicate tensor(-0.4201, dtype=torch.float64) tensor(1.5114, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2992, dtype=torch.float64) delta_t tensor(-0.4878, dtype=torch.float64)
5 gae_duplicate tensor(-0.9264, dtype=torch.float64) tensor(9.2761, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1392, dtype=torch.float64) delta_t tensor(0.2670, dtype=torch.float64)
4 gae_duplicate tensor(-0.3618, dtype=torch.float64) tensor(-4.0876, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9333, dtype=torch.float64) delta_t tensor(-0.5203, dtype=torch.float64)
3 gae_duplicate tensor(-1.4923, dtype=torch.float64) tensor(9.1809, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2136, dtype=torch.float64) delta_t tensor(0.4597, dtype=torch.float64)
2 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-9.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1303.06103515625
value loss:41.34720993041992
entropies:349.3187255859375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3922.9927)
ToM Target loss= tensor(2326.9841)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.1169819831848145 seconds
19 rew tensor(1.1578, dtype=torch.float64) delta_t tensor(-0.0918, dtype=torch.float64)
19 gae_duplicate tensor(-0.5269, dtype=torch.float64) tensor(1.2198, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1451, dtype=torch.float64) delta_t tensor(0.1510, dtype=torch.float64)
18 gae_duplicate tensor(-0.3702, dtype=torch.float64) tensor(-2.5884, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0548, dtype=torch.float64) delta_t tensor(0.0696, dtype=torch.float64)
17 gae_duplicate tensor(-0.2448, dtype=torch.float64) tensor(-1.5669, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0311, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
16 gae_duplicate tensor(-0.5478, dtype=torch.float64) tensor(-1.9496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8995, dtype=torch.float64) delta_t tensor(0.1087, dtype=torch.float64)
15 gae_duplicate tensor(-0.0772, dtype=torch.float64) tensor(-2.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5419, dtype=torch.float64) delta_t tensor(-0.1062, dtype=torch.float64)
14 gae_duplicate tensor(-1.3784, dtype=torch.float64) tensor(2.9075, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3172, dtype=torch.float64) delta_t tensor(-0.1953, dtype=torch.float64)
13 gae_duplicate tensor(-0.9096, dtype=torch.float64) tensor(3.9711, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0067, dtype=torch.float64) delta_t tensor(-0.1745, dtype=torch.float64)
12 gae_duplicate tensor(-0.9854, dtype=torch.float64) tensor(4.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3752, dtype=torch.float64) delta_t tensor(0.0991, dtype=torch.float64)
11 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(-1.4936, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0412, dtype=torch.float64) delta_t tensor(0.0399, dtype=torch.float64)
10 gae_duplicate tensor(-0.2042, dtype=torch.float64) tensor(-0.6952, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5166, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
9 gae_duplicate tensor(0.2492, dtype=torch.float64) tensor(-10.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6447, dtype=torch.float64) delta_t tensor(-0.7315, dtype=torch.float64)
8 gae_duplicate tensor(-1.0128, dtype=torch.float64) tensor(12.3118, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6937, dtype=torch.float64) delta_t tensor(-0.3143, dtype=torch.float64)
7 gae_duplicate tensor(-1.0597, dtype=torch.float64) tensor(8.0268, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7390, dtype=torch.float64) delta_t tensor(-0.0595, dtype=torch.float64)
6 gae_duplicate tensor(-0.6357, dtype=torch.float64) tensor(1.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3178, dtype=torch.float64) delta_t tensor(-0.4456, dtype=torch.float64)
5 gae_duplicate tensor(-0.8492, dtype=torch.float64) tensor(9.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0239, dtype=torch.float64) delta_t tensor(0.2271, dtype=torch.float64)
4 gae_duplicate tensor(-0.8523, dtype=torch.float64) tensor(-3.6523, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1219, dtype=torch.float64) delta_t tensor(-0.7691, dtype=torch.float64)
3 gae_duplicate tensor(-1.4437, dtype=torch.float64) tensor(14.9350, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3143, dtype=torch.float64) delta_t tensor(0.5345, dtype=torch.float64)
2 gae_duplicate tensor(-0.2786, dtype=torch.float64) tensor(-9.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1408.16259765625
value loss:43.67224884033203
entropies:348.74053955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.808893203735352 seconds
19 rew tensor(1.2171, dtype=torch.float64) delta_t tensor(0.2876, dtype=torch.float64)
19 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-6.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1670, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
18 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(-2.5375, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1031, dtype=torch.float64) delta_t tensor(0.3268, dtype=torch.float64)
17 gae_duplicate tensor(0.1038, dtype=torch.float64) tensor(-6.2004, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7510, dtype=torch.float64) delta_t tensor(-0.2775, dtype=torch.float64)
16 gae_duplicate tensor(-1.0956, dtype=torch.float64) tensor(4.5046, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7097, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
15 gae_duplicate tensor(-1.1254, dtype=torch.float64) tensor(-0.8395, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7677, dtype=torch.float64) delta_t tensor(0.2377, dtype=torch.float64)
14 gae_duplicate tensor(0.0651, dtype=torch.float64) tensor(-4.3646, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6523, dtype=torch.float64) delta_t tensor(0.1035, dtype=torch.float64)
13 gae_duplicate tensor(-0.3148, dtype=torch.float64) tensor(-2.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3107, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
12 gae_duplicate tensor(-0.4368, dtype=torch.float64) tensor(2.1188, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5089, dtype=torch.float64) delta_t tensor(0.1771, dtype=torch.float64)
11 gae_duplicate tensor(0.0139, dtype=torch.float64) tensor(-3.1012, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0653, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
10 gae_duplicate tensor(-0.1355, dtype=torch.float64) tensor(-5.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4030, dtype=torch.float64) delta_t tensor(0.5026, dtype=torch.float64)
9 gae_duplicate tensor(0.0284, dtype=torch.float64) tensor(-9.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5588, dtype=torch.float64) delta_t tensor(-0.7025, dtype=torch.float64)
8 gae_duplicate tensor(-1.0937, dtype=torch.float64) tensor(12.1526, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.1206, dtype=torch.float64) delta_t tensor(-1.7730, dtype=torch.float64)
7 gae_duplicate tensor(-5.6697, dtype=torch.float64) tensor(35.9557, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0549, dtype=torch.float64) delta_t tensor(-0.2431, dtype=torch.float64)
6 gae_duplicate tensor(-1.4918, dtype=torch.float64) tensor(7.9130, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0330, dtype=torch.float64) delta_t tensor(-0.2074, dtype=torch.float64)
5 gae_duplicate tensor(-0.8201, dtype=torch.float64) tensor(5.0485, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0678, dtype=torch.float64) delta_t tensor(0.2511, dtype=torch.float64)
4 gae_duplicate tensor(-0.6644, dtype=torch.float64) tensor(-4.6851, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0570, dtype=torch.float64) delta_t tensor(-0.5894, dtype=torch.float64)
3 gae_duplicate tensor(-1.6110, dtype=torch.float64) tensor(10.1419, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2973, dtype=torch.float64) delta_t tensor(0.5302, dtype=torch.float64)
2 gae_duplicate tensor(-0.2756, dtype=torch.float64) tensor(-8.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1362.7591552734375
value loss:122.6129150390625
entropies:348.17974853515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.857891082763672 seconds
19 rew tensor(1.2156, dtype=torch.float64) delta_t tensor(0.1484, dtype=torch.float64)
19 gae_duplicate tensor(-0.1322, dtype=torch.float64) tensor(-2.9567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1908, dtype=torch.float64) delta_t tensor(0.1668, dtype=torch.float64)
18 gae_duplicate tensor(-0.3269, dtype=torch.float64) tensor(-3.5766, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0756, dtype=torch.float64) delta_t tensor(0.1862, dtype=torch.float64)
17 gae_duplicate tensor(0.0115, dtype=torch.float64) tensor(-4.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0643, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
16 gae_duplicate tensor(0.1360, dtype=torch.float64) tensor(-4.6991, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0241, dtype=torch.float64) delta_t tensor(0.2121, dtype=torch.float64)
15 gae_duplicate tensor(-0.0214, dtype=torch.float64) tensor(-4.3374, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3174, dtype=torch.float64) delta_t tensor(-0.3748, dtype=torch.float64)
14 gae_duplicate tensor(-2.8625, dtype=torch.float64) tensor(6.1213, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.4007, dtype=torch.float64) delta_t tensor(-0.8310, dtype=torch.float64)
13 gae_duplicate tensor(-2.7699, dtype=torch.float64) tensor(15.4854, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2576, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
12 gae_duplicate tensor(-0.9701, dtype=torch.float64) tensor(1.3999, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3381, dtype=torch.float64) delta_t tensor(0.0248, dtype=torch.float64)
11 gae_duplicate tensor(-0.5880, dtype=torch.float64) tensor(-0.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0771, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
10 gae_duplicate tensor(-0.2679, dtype=torch.float64) tensor(-2.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5287, dtype=torch.float64) delta_t tensor(0.5845, dtype=torch.float64)
9 gae_duplicate tensor(0.2641, dtype=torch.float64) tensor(-12.4084, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5260, dtype=torch.float64) delta_t tensor(-0.6956, dtype=torch.float64)
8 gae_duplicate tensor(-0.8375, dtype=torch.float64) tensor(12.7708, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2976, dtype=torch.float64) delta_t tensor(-0.8472, dtype=torch.float64)
7 gae_duplicate tensor(-3.0464, dtype=torch.float64) tensor(19.5857, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7131, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
6 gae_duplicate tensor(-0.9015, dtype=torch.float64) tensor(0.6570, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4068, dtype=torch.float64) delta_t tensor(-0.4471, dtype=torch.float64)
5 gae_duplicate tensor(-0.8534, dtype=torch.float64) tensor(9.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(4.2405e-05, dtype=torch.float64) delta_t tensor(0.3698, dtype=torch.float64)
4 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-6.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2266, dtype=torch.float64) delta_t tensor(-0.8527, dtype=torch.float64)
3 gae_duplicate tensor(-1.2479, dtype=torch.float64) tensor(15.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3502, dtype=torch.float64) delta_t tensor(0.5653, dtype=torch.float64)
2 gae_duplicate tensor(-0.0554, dtype=torch.float64) tensor(-8.8921, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1732.18701171875
value loss:81.9712905883789
entropies:347.71661376953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.799695014953613 seconds
19 rew tensor(1.1398, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
19 gae_duplicate tensor(-0.3114, dtype=torch.float64) tensor(1.7380, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1283, dtype=torch.float64) delta_t tensor(0.1780, dtype=torch.float64)
18 gae_duplicate tensor(0.0809, dtype=torch.float64) tensor(-3.7596, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0376, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
17 gae_duplicate tensor(-0.4467, dtype=torch.float64) tensor(-0.8409, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9619, dtype=torch.float64) delta_t tensor(-0.0023, dtype=torch.float64)
16 gae_duplicate tensor(-0.3923, dtype=torch.float64) tensor(-0.0733, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7909, dtype=torch.float64) delta_t tensor(-0.1986, dtype=torch.float64)
15 gae_duplicate tensor(-0.6445, dtype=torch.float64) tensor(3.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8052, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
14 gae_duplicate tensor(0.0081, dtype=torch.float64) tensor(-2.4672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6233, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
13 gae_duplicate tensor(0.0152, dtype=torch.float64) tensor(-3.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4665, dtype=torch.float64) delta_t tensor(-0.0340, dtype=torch.float64)
12 gae_duplicate tensor(-0.4156, dtype=torch.float64) tensor(0.0700, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2739, dtype=torch.float64) delta_t tensor(-0.1462, dtype=torch.float64)
11 gae_duplicate tensor(-0.5974, dtype=torch.float64) tensor(2.2916, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1680, dtype=torch.float64) delta_t tensor(0.2144, dtype=torch.float64)
10 gae_duplicate tensor(-0.1720, dtype=torch.float64) tensor(-3.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1228, dtype=torch.float64) delta_t tensor(0.2839, dtype=torch.float64)
9 gae_duplicate tensor(0.0311, dtype=torch.float64) tensor(-5.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2723, dtype=torch.float64) delta_t tensor(-0.4169, dtype=torch.float64)
8 gae_duplicate tensor(-0.6984, dtype=torch.float64) tensor(6.9160, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9999, dtype=torch.float64) delta_t tensor(-0.4805, dtype=torch.float64)
7 gae_duplicate tensor(-0.9168, dtype=torch.float64) tensor(11.0614, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5741, dtype=torch.float64) delta_t tensor(0.2060, dtype=torch.float64)
6 gae_duplicate tensor(-0.6196, dtype=torch.float64) tensor(-3.4577, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3208, dtype=torch.float64) delta_t tensor(-0.4856, dtype=torch.float64)
5 gae_duplicate tensor(-0.8711, dtype=torch.float64) tensor(9.7310, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0809, dtype=torch.float64) delta_t tensor(0.2707, dtype=torch.float64)
4 gae_duplicate tensor(-1.0325, dtype=torch.float64) tensor(-4.2165, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9493, dtype=torch.float64) delta_t tensor(-0.6133, dtype=torch.float64)
3 gae_duplicate tensor(-1.3039, dtype=torch.float64) tensor(11.6654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2807, dtype=torch.float64) delta_t tensor(0.5481, dtype=torch.float64)
2 gae_duplicate tensor(-0.4780, dtype=torch.float64) tensor(-9.3531, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-650.5684204101562
value loss:39.75544738769531
entropies:347.1885070800781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.930363893508911 seconds
19 rew tensor(1.0888, dtype=torch.float64) delta_t tensor(-0.0538, dtype=torch.float64)
19 gae_duplicate tensor(-0.4507, dtype=torch.float64) tensor(0.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0505, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
18 gae_duplicate tensor(-0.0912, dtype=torch.float64) tensor(-2.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9741, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
17 gae_duplicate tensor(-0.3641, dtype=torch.float64) tensor(0.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8295, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
16 gae_duplicate tensor(-0.0667, dtype=torch.float64) tensor(-0.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8196, dtype=torch.float64) delta_t tensor(-0.0160, dtype=torch.float64)
15 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(0.4495, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6731, dtype=torch.float64) delta_t tensor(0.0569, dtype=torch.float64)
14 gae_duplicate tensor(-0.0423, dtype=torch.float64) tensor(-0.9890, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7190, dtype=torch.float64) delta_t tensor(0.0365, dtype=torch.float64)
13 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(-0.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2441, dtype=torch.float64) delta_t tensor(-0.2528, dtype=torch.float64)
12 gae_duplicate tensor(-0.4428, dtype=torch.float64) tensor(4.6325, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5240, dtype=torch.float64) delta_t tensor(0.0271, dtype=torch.float64)
11 gae_duplicate tensor(-0.5704, dtype=torch.float64) tensor(-0.0482, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0145, dtype=torch.float64) delta_t tensor(-0.1466, dtype=torch.float64)
10 gae_duplicate tensor(-0.5481, dtype=torch.float64) tensor(3.2312, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2210, dtype=torch.float64) delta_t tensor(0.2141, dtype=torch.float64)
9 gae_duplicate tensor(0.0063, dtype=torch.float64) tensor(-3.6289, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4946, dtype=torch.float64) delta_t tensor(-0.6522, dtype=torch.float64)
8 gae_duplicate tensor(-0.9778, dtype=torch.float64) tensor(12.2059, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4627, dtype=torch.float64) delta_t tensor(-0.1688, dtype=torch.float64)
7 gae_duplicate tensor(-1.0118, dtype=torch.float64) tensor(4.0332, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5603, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
6 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-3.5508, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3240, dtype=torch.float64) delta_t tensor(-0.4577, dtype=torch.float64)
5 gae_duplicate tensor(-0.9218, dtype=torch.float64) tensor(7.9228, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2117, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
4 gae_duplicate tensor(-0.1204, dtype=torch.float64) tensor(-3.5080, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7669, dtype=torch.float64) delta_t tensor(-0.4086, dtype=torch.float64)
3 gae_duplicate tensor(-1.1449, dtype=torch.float64) tensor(8.0155, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1517, dtype=torch.float64) delta_t tensor(0.3473, dtype=torch.float64)
2 gae_duplicate tensor(-0.0187, dtype=torch.float64) tensor(-5.5792, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1247.7138671875
value loss:18.98116683959961
entropies:346.5733337402344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3905.6042)
ToM Target loss= tensor(2313.4612)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.89087986946106 seconds
19 rew tensor(1.1306, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
19 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-1.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1187, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
18 gae_duplicate tensor(0.0005, dtype=torch.float64) tensor(-4.1848, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0808, dtype=torch.float64) delta_t tensor(0.1715, dtype=torch.float64)
17 gae_duplicate tensor(0.0912, dtype=torch.float64) tensor(-3.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
16 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(-0.7495, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9259, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
15 gae_duplicate tensor(-0.0360, dtype=torch.float64) tensor(-2.7303, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2727, dtype=torch.float64) delta_t tensor(-0.1927, dtype=torch.float64)
14 gae_duplicate tensor(-1.5209, dtype=torch.float64) tensor(3.0143, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8305, dtype=torch.float64) delta_t tensor(0.3254, dtype=torch.float64)
13 gae_duplicate tensor(0.1937, dtype=torch.float64) tensor(-6.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1172, dtype=torch.float64) delta_t tensor(-0.1790, dtype=torch.float64)
12 gae_duplicate tensor(-0.4352, dtype=torch.float64) tensor(3.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6910, dtype=torch.float64) delta_t tensor(0.2165, dtype=torch.float64)
11 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(-3.8940, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2126, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
10 gae_duplicate tensor(-0.2666, dtype=torch.float64) tensor(0.3092, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.3591, dtype=torch.float64)
9 gae_duplicate tensor(0.0127, dtype=torch.float64) tensor(-6.4096, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5778, dtype=torch.float64) delta_t tensor(-0.7485, dtype=torch.float64)
8 gae_duplicate tensor(-1.0418, dtype=torch.float64) tensor(15.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3581, dtype=torch.float64) delta_t tensor(-0.2147, dtype=torch.float64)
7 gae_duplicate tensor(-0.8128, dtype=torch.float64) tensor(5.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6963, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
6 gae_duplicate tensor(-0.3594, dtype=torch.float64) tensor(-3.1777, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1479, dtype=torch.float64) delta_t tensor(-0.2135, dtype=torch.float64)
5 gae_duplicate tensor(-0.5396, dtype=torch.float64) tensor(3.4756, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1804, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
4 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(-3.5546, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7667, dtype=torch.float64) delta_t tensor(-0.4695, dtype=torch.float64)
3 gae_duplicate tensor(-1.5348, dtype=torch.float64) tensor(8.1275, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2098, dtype=torch.float64) delta_t tensor(0.3995, dtype=torch.float64)
2 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(-6.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:91.20677185058594
value loss:28.16556167602539
entropies:346.00787353515625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.146388053894043 seconds
19 rew tensor(1.1395, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
19 gae_duplicate tensor(-0.5494, dtype=torch.float64) tensor(-0.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2058, dtype=torch.float64) delta_t tensor(0.2863, dtype=torch.float64)
18 gae_duplicate tensor(0.1740, dtype=torch.float64) tensor(-5.4522, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1033, dtype=torch.float64) delta_t tensor(0.1840, dtype=torch.float64)
17 gae_duplicate tensor(0.0594, dtype=torch.float64) tensor(-4.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0261, dtype=torch.float64) delta_t tensor(0.1376, dtype=torch.float64)
16 gae_duplicate tensor(-0.0361, dtype=torch.float64) tensor(-2.9018, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0027, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
15 gae_duplicate tensor(-0.2651, dtype=torch.float64) tensor(-1.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8206, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
14 gae_duplicate tensor(0.0158, dtype=torch.float64) tensor(-3.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1557, dtype=torch.float64) delta_t tensor(-0.3537, dtype=torch.float64)
13 gae_duplicate tensor(-2.9588, dtype=torch.float64) tensor(6.0229, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(-0.1772, dtype=torch.float64)
12 gae_duplicate tensor(-1.3239, dtype=torch.float64) tensor(3.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
11 gae_duplicate tensor(-0.0556, dtype=torch.float64) tensor(-0.3472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0140, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
10 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(-1.1739, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2740, dtype=torch.float64) delta_t tensor(0.4365, dtype=torch.float64)
9 gae_duplicate tensor(-0.0022, dtype=torch.float64) tensor(-8.3253, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5872, dtype=torch.float64) delta_t tensor(-0.6275, dtype=torch.float64)
8 gae_duplicate tensor(-0.8910, dtype=torch.float64) tensor(10.6853, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6538, dtype=torch.float64) delta_t tensor(-1.0293, dtype=torch.float64)
7 gae_duplicate tensor(-4.9442, dtype=torch.float64) tensor(19.1382, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7764, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
6 gae_duplicate tensor(-1.1714, dtype=torch.float64) tensor(0.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4062, dtype=torch.float64) delta_t tensor(-0.3652, dtype=torch.float64)
5 gae_duplicate tensor(-0.7679, dtype=torch.float64) tensor(6.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1269, dtype=torch.float64) delta_t tensor(0.4798, dtype=torch.float64)
4 gae_duplicate tensor(-0.0399, dtype=torch.float64) tensor(-8.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4002, dtype=torch.float64) delta_t tensor(-0.8911, dtype=torch.float64)
3 gae_duplicate tensor(-1.5781, dtype=torch.float64) tensor(15.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4783, dtype=torch.float64) delta_t tensor(0.6793, dtype=torch.float64)
2 gae_duplicate tensor(0.0795, dtype=torch.float64) tensor(-10.6608, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-991.2470703125
value loss:88.04541015625
entropies:345.4734191894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0202789306640625 seconds
19 rew tensor(1.2142, dtype=torch.float64) delta_t tensor(0.1654, dtype=torch.float64)
19 gae_duplicate tensor(0.0082, dtype=torch.float64) tensor(-3.5647, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2028, dtype=torch.float64) delta_t tensor(0.2790, dtype=torch.float64)
18 gae_duplicate tensor(0.1296, dtype=torch.float64) tensor(-5.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1258, dtype=torch.float64) delta_t tensor(0.1160, dtype=torch.float64)
17 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(-3.6169, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0892, dtype=torch.float64) delta_t tensor(0.1177, dtype=torch.float64)
16 gae_duplicate tensor(-0.3462, dtype=torch.float64) tensor(-2.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9731, dtype=torch.float64) delta_t tensor(0.2223, dtype=torch.float64)
15 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-4.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.2679, dtype=torch.float64) delta_t tensor(-0.8658, dtype=torch.float64)
14 gae_duplicate tensor(-2.9758, dtype=torch.float64) tensor(15.1099, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3290, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
13 gae_duplicate tensor(-1.6012, dtype=torch.float64) tensor(5.6710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2488, dtype=torch.float64) delta_t tensor(0.0185, dtype=torch.float64)
12 gae_duplicate tensor(-0.2382, dtype=torch.float64) tensor(0.4603, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5057, dtype=torch.float64) delta_t tensor(0.1200, dtype=torch.float64)
11 gae_duplicate tensor(-0.2751, dtype=torch.float64) tensor(-2.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1146, dtype=torch.float64) delta_t tensor(0.1028, dtype=torch.float64)
10 gae_duplicate tensor(-0.1333, dtype=torch.float64) tensor(-2.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4539, dtype=torch.float64) delta_t tensor(0.5379, dtype=torch.float64)
9 gae_duplicate tensor(0.3584, dtype=torch.float64) tensor(-11.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4654, dtype=torch.float64) delta_t tensor(-0.6535, dtype=torch.float64)
8 gae_duplicate tensor(-0.8909, dtype=torch.float64) tensor(12.9352, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5794, dtype=torch.float64) delta_t tensor(-0.9744, dtype=torch.float64)
7 gae_duplicate tensor(-4.4561, dtype=torch.float64) tensor(19.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8035, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
6 gae_duplicate tensor(-1.1994, dtype=torch.float64) tensor(2.1957, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2781, dtype=torch.float64) delta_t tensor(-0.2861, dtype=torch.float64)
5 gae_duplicate tensor(-0.6795, dtype=torch.float64) tensor(6.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0505, dtype=torch.float64) delta_t tensor(0.3872, dtype=torch.float64)
4 gae_duplicate tensor(-0.4177, dtype=torch.float64) tensor(-7.2223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2132, dtype=torch.float64) delta_t tensor(-0.8234, dtype=torch.float64)
3 gae_duplicate tensor(-1.4289, dtype=torch.float64) tensor(16.7290, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4135, dtype=torch.float64) delta_t tensor(0.6909, dtype=torch.float64)
2 gae_duplicate tensor(0.0988, dtype=torch.float64) tensor(-12.7460, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1338.2642822265625
value loss:85.66114044189453
entropies:345.1501159667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.841078996658325 seconds
19 rew tensor(1.1366, dtype=torch.float64) delta_t tensor(-0.1269, dtype=torch.float64)
19 gae_duplicate tensor(-0.7114, dtype=torch.float64) tensor(1.6748, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1381, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
18 gae_duplicate tensor(-0.3097, dtype=torch.float64) tensor(-1.5046, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0356, dtype=torch.float64) delta_t tensor(-0.0042, dtype=torch.float64)
17 gae_duplicate tensor(-0.3974, dtype=torch.float64) tensor(0.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9345, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
16 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-1.8371, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
15 gae_duplicate tensor(-0.6769, dtype=torch.float64) tensor(-1.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4773, dtype=torch.float64) delta_t tensor(-0.1832, dtype=torch.float64)
14 gae_duplicate tensor(-1.5782, dtype=torch.float64) tensor(3.2010, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6591, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
13 gae_duplicate tensor(-0.0739, dtype=torch.float64) tensor(-2.9957, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3925, dtype=torch.float64) delta_t tensor(-0.1036, dtype=torch.float64)
12 gae_duplicate tensor(-0.4134, dtype=torch.float64) tensor(1.6252, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4272, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
11 gae_duplicate tensor(-0.2679, dtype=torch.float64) tensor(-0.4461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0378, dtype=torch.float64) delta_t tensor(-0.1216, dtype=torch.float64)
10 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(2.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1829, dtype=torch.float64) delta_t tensor(0.3952, dtype=torch.float64)
9 gae_duplicate tensor(0.0950, dtype=torch.float64) tensor(-8.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4393, dtype=torch.float64) delta_t tensor(-0.6376, dtype=torch.float64)
8 gae_duplicate tensor(-1.0396, dtype=torch.float64) tensor(11.7938, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3999, dtype=torch.float64) delta_t tensor(-0.7117, dtype=torch.float64)
7 gae_duplicate tensor(-1.9952, dtype=torch.float64) tensor(13.8681, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5715, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
6 gae_duplicate tensor(-0.4982, dtype=torch.float64) tensor(-2.5612, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5589, dtype=torch.float64) delta_t tensor(-0.5465, dtype=torch.float64)
5 gae_duplicate tensor(-1.0144, dtype=torch.float64) tensor(9.7691, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2378, dtype=torch.float64) delta_t tensor(0.6028, dtype=torch.float64)
4 gae_duplicate tensor(0.1411, dtype=torch.float64) tensor(-10.7950, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4126, dtype=torch.float64) delta_t tensor(-0.8582, dtype=torch.float64)
3 gae_duplicate tensor(-1.3701, dtype=torch.float64) tensor(16.2786, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6001, dtype=torch.float64) delta_t tensor(0.8022, dtype=torch.float64)
2 gae_duplicate tensor(0.2573, dtype=torch.float64) tensor(-15.0934, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-934.8800048828125
value loss:50.01152038574219
entropies:344.7441711425781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.303112030029297 seconds
19 rew tensor(1.1855, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
19 gae_duplicate tensor(-0.3000, dtype=torch.float64) tensor(-0.7989, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1223, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
18 gae_duplicate tensor(-0.4078, dtype=torch.float64) tensor(-1.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0694, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
17 gae_duplicate tensor(-0.4060, dtype=torch.float64) tensor(-0.9092, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0213, dtype=torch.float64) delta_t tensor(0.1696, dtype=torch.float64)
16 gae_duplicate tensor(0.1196, dtype=torch.float64) tensor(-3.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8784, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
15 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-3.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6748, dtype=torch.float64) delta_t tensor(0.0637, dtype=torch.float64)
14 gae_duplicate tensor(0.0169, dtype=torch.float64) tensor(-1.4872, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4677, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
13 gae_duplicate tensor(-0.3720, dtype=torch.float64) tensor(-0.3179, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4116, dtype=torch.float64) delta_t tensor(0.0840, dtype=torch.float64)
12 gae_duplicate tensor(-0.0690, dtype=torch.float64) tensor(-1.7370, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3002, dtype=torch.float64) delta_t tensor(0.0893, dtype=torch.float64)
11 gae_duplicate tensor(-0.2282, dtype=torch.float64) tensor(-1.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0645, dtype=torch.float64) delta_t tensor(0.0994, dtype=torch.float64)
10 gae_duplicate tensor(-0.1922, dtype=torch.float64) tensor(-2.0151, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2355, dtype=torch.float64) delta_t tensor(0.4815, dtype=torch.float64)
9 gae_duplicate tensor(-0.1124, dtype=torch.float64) tensor(-10.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4634, dtype=torch.float64) delta_t tensor(-0.5060, dtype=torch.float64)
8 gae_duplicate tensor(-0.9639, dtype=torch.float64) tensor(7.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4607, dtype=torch.float64) delta_t tensor(-0.8723, dtype=torch.float64)
7 gae_duplicate tensor(-3.2279, dtype=torch.float64) tensor(17.0048, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7349, dtype=torch.float64) delta_t tensor(0.1369, dtype=torch.float64)
6 gae_duplicate tensor(-0.7576, dtype=torch.float64) tensor(-0.9242, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3247, dtype=torch.float64) delta_t tensor(-0.2985, dtype=torch.float64)
5 gae_duplicate tensor(-1.0053, dtype=torch.float64) tensor(5.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1296, dtype=torch.float64) delta_t tensor(0.4813, dtype=torch.float64)
4 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(-8.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2092, dtype=torch.float64) delta_t tensor(-0.6545, dtype=torch.float64)
3 gae_duplicate tensor(-1.2524, dtype=torch.float64) tensor(10.8678, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4411, dtype=torch.float64) delta_t tensor(0.6217, dtype=torch.float64)
2 gae_duplicate tensor(-0.4308, dtype=torch.float64) tensor(-11.4713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:318.8304138183594
value loss:54.34115982055664
entropies:344.54931640625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3887.0930)
ToM Target loss= tensor(2291.2314)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.971570253372192 seconds
19 rew tensor(1.1746, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
19 gae_duplicate tensor(-0.0794, dtype=torch.float64) tensor(-2.1272, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1365, dtype=torch.float64) delta_t tensor(0.2149, dtype=torch.float64)
18 gae_duplicate tensor(-0.0168, dtype=torch.float64) tensor(-4.1898, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0851, dtype=torch.float64) delta_t tensor(0.1900, dtype=torch.float64)
17 gae_duplicate tensor(0.0573, dtype=torch.float64) tensor(-3.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9284, dtype=torch.float64) delta_t tensor(-0.0323, dtype=torch.float64)
16 gae_duplicate tensor(-0.3995, dtype=torch.float64) tensor(0.3759, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9312, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
15 gae_duplicate tensor(-0.0515, dtype=torch.float64) tensor(-2.0464, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7348, dtype=torch.float64) delta_t tensor(0.1198, dtype=torch.float64)
14 gae_duplicate tensor(-0.0082, dtype=torch.float64) tensor(-2.4288, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0384, dtype=torch.float64) delta_t tensor(-0.4605, dtype=torch.float64)
13 gae_duplicate tensor(-3.8845, dtype=torch.float64) tensor(8.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0257, dtype=torch.float64) delta_t tensor(-0.3231, dtype=torch.float64)
12 gae_duplicate tensor(-1.5155, dtype=torch.float64) tensor(6.6448, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5861, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
11 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(-2.6544, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1428, dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
10 gae_duplicate tensor(-0.5450, dtype=torch.float64) tensor(0.4793, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5297, dtype=torch.float64) delta_t tensor(0.4461, dtype=torch.float64)
9 gae_duplicate tensor(0.0644, dtype=torch.float64) tensor(-8.2044, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5694, dtype=torch.float64) delta_t tensor(-0.5869, dtype=torch.float64)
8 gae_duplicate tensor(-0.8013, dtype=torch.float64) tensor(10.8897, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3785, dtype=torch.float64) delta_t tensor(0.0536, dtype=torch.float64)
7 gae_duplicate tensor(-0.2655, dtype=torch.float64) tensor(0.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7798, dtype=torch.float64) delta_t tensor(0.1647, dtype=torch.float64)
6 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(-3.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1076, dtype=torch.float64) delta_t tensor(-0.2025, dtype=torch.float64)
5 gae_duplicate tensor(-0.6245, dtype=torch.float64) tensor(3.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2152, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
4 gae_duplicate tensor(-0.4008, dtype=torch.float64) tensor(-3.0097, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7418, dtype=torch.float64) delta_t tensor(-0.4045, dtype=torch.float64)
3 gae_duplicate tensor(-1.1805, dtype=torch.float64) tensor(7.1650, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1471, dtype=torch.float64) delta_t tensor(0.3827, dtype=torch.float64)
2 gae_duplicate tensor(-0.3312, dtype=torch.float64) tensor(-7.1085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:0.009295463562011719
value loss:47.654991149902344
entropies:344.5602111816406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9651429653167725 seconds
19 rew tensor(1.1761, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
19 gae_duplicate tensor(-0.5713, dtype=torch.float64) tensor(1.5433, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1242, dtype=torch.float64) delta_t tensor(0.0827, dtype=torch.float64)
18 gae_duplicate tensor(-0.3865, dtype=torch.float64) tensor(-0.8096, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0596, dtype=torch.float64) delta_t tensor(0.1401, dtype=torch.float64)
17 gae_duplicate tensor(0.0137, dtype=torch.float64) tensor(-2.8263, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9315, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
16 gae_duplicate tensor(0.0070, dtype=torch.float64) tensor(-1.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(-0.0150, dtype=torch.float64)
15 gae_duplicate tensor(-0.6133, dtype=torch.float64) tensor(0.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6879, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
14 gae_duplicate tensor(-0.0644, dtype=torch.float64) tensor(-0.9724, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5950, dtype=torch.float64) delta_t tensor(0.1087, dtype=torch.float64)
13 gae_duplicate tensor(-0.0546, dtype=torch.float64) tensor(-2.3937, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3909, dtype=torch.float64) delta_t tensor(-0.0806, dtype=torch.float64)
12 gae_duplicate tensor(-0.3193, dtype=torch.float64) tensor(1.2892, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2548, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
11 gae_duplicate tensor(-0.3895, dtype=torch.float64) tensor(-0.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0672, dtype=torch.float64) delta_t tensor(0.1471, dtype=torch.float64)
10 gae_duplicate tensor(-0.1001, dtype=torch.float64) tensor(-2.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1651, dtype=torch.float64) delta_t tensor(0.3631, dtype=torch.float64)
9 gae_duplicate tensor(0.0760, dtype=torch.float64) tensor(-6.8232, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4632, dtype=torch.float64) delta_t tensor(-0.5704, dtype=torch.float64)
8 gae_duplicate tensor(-0.8080, dtype=torch.float64) tensor(9.7556, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0348, dtype=torch.float64) delta_t tensor(-0.4218, dtype=torch.float64)
7 gae_duplicate tensor(-0.9876, dtype=torch.float64) tensor(9.8170, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5562, dtype=torch.float64) delta_t tensor(0.3066, dtype=torch.float64)
6 gae_duplicate tensor(-0.0331, dtype=torch.float64) tensor(-4.6531, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5344, dtype=torch.float64) delta_t tensor(-0.4471, dtype=torch.float64)
5 gae_duplicate tensor(-0.8534, dtype=torch.float64) tensor(8.5840, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1348, dtype=torch.float64) delta_t tensor(0.4761, dtype=torch.float64)
4 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(-7.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3098, dtype=torch.float64) delta_t tensor(-0.7135, dtype=torch.float64)
3 gae_duplicate tensor(-1.1852, dtype=torch.float64) tensor(12.3135, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4965, dtype=torch.float64) delta_t tensor(0.6725, dtype=torch.float64)
2 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-11.1726, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-150.54922485351562
value loss:30.0559139251709
entropies:344.5070495605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.075074911117554 seconds
19 rew tensor(1.1092, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
19 gae_duplicate tensor(-0.0673, dtype=torch.float64) tensor(-0.6290, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1490, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
18 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-3.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0335, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
17 gae_duplicate tensor(0.0192, dtype=torch.float64) tensor(-2.3702, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9333, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
16 gae_duplicate tensor(-0.6070, dtype=torch.float64) tensor(0.5455, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8673, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
15 gae_duplicate tensor(-0.2980, dtype=torch.float64) tensor(0.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6631, dtype=torch.float64) delta_t tensor(0.0422, dtype=torch.float64)
14 gae_duplicate tensor(-0.1413, dtype=torch.float64) tensor(-0.7514, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7103, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
13 gae_duplicate tensor(0.0421, dtype=torch.float64) tensor(-2.7961, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2874, dtype=torch.float64) delta_t tensor(-0.1694, dtype=torch.float64)
12 gae_duplicate tensor(-0.4286, dtype=torch.float64) tensor(3.3161, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4374, dtype=torch.float64) delta_t tensor(0.0580, dtype=torch.float64)
11 gae_duplicate tensor(-0.1683, dtype=torch.float64) tensor(-0.7389, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0375, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
10 gae_duplicate tensor(-0.5706, dtype=torch.float64) tensor(2.8569, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2314, dtype=torch.float64) delta_t tensor(0.3371, dtype=torch.float64)
9 gae_duplicate tensor(-0.0447, dtype=torch.float64) tensor(-6.4345, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4373, dtype=torch.float64) delta_t tensor(-0.3964, dtype=torch.float64)
8 gae_duplicate tensor(-0.5352, dtype=torch.float64) tensor(6.7821, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6590, dtype=torch.float64) delta_t tensor(-0.1467, dtype=torch.float64)
7 gae_duplicate tensor(-0.8512, dtype=torch.float64) tensor(3.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6569, dtype=torch.float64) delta_t tensor(0.2513, dtype=torch.float64)
6 gae_duplicate tensor(-0.3086, dtype=torch.float64) tensor(-4.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2522, dtype=torch.float64) delta_t tensor(-0.2341, dtype=torch.float64)
5 gae_duplicate tensor(-0.6753, dtype=torch.float64) tensor(4.5249, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1255, dtype=torch.float64) delta_t tensor(0.2506, dtype=torch.float64)
4 gae_duplicate tensor(-0.4916, dtype=torch.float64) tensor(-5.2986, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8539, dtype=torch.float64) delta_t tensor(-0.3937, dtype=torch.float64)
3 gae_duplicate tensor(-0.9971, dtype=torch.float64) tensor(6.6149, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2497, dtype=torch.float64) delta_t tensor(0.4769, dtype=torch.float64)
2 gae_duplicate tensor(-0.0730, dtype=torch.float64) tensor(-7.8965, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:243.43959045410156
value loss:21.461944580078125
entropies:344.3255920410156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.365793228149414 seconds
19 rew tensor(1.2266, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
19 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-3.8269, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2148, dtype=torch.float64) delta_t tensor(0.2847, dtype=torch.float64)
18 gae_duplicate tensor(0.0080, dtype=torch.float64) tensor(-5.3635, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1640, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
17 gae_duplicate tensor(-0.3960, dtype=torch.float64) tensor(-4.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0741, dtype=torch.float64) delta_t tensor(0.1595, dtype=torch.float64)
16 gae_duplicate tensor(0.0043, dtype=torch.float64) tensor(-3.5476, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9308, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
15 gae_duplicate tensor(-0.0540, dtype=torch.float64) tensor(-3.2558, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2663, dtype=torch.float64) delta_t tensor(-0.3598, dtype=torch.float64)
14 gae_duplicate tensor(-2.8102, dtype=torch.float64) tensor(9.5634, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1517, dtype=torch.float64) delta_t tensor(-0.2692, dtype=torch.float64)
13 gae_duplicate tensor(-2.3106, dtype=torch.float64) tensor(5.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2922, dtype=torch.float64) delta_t tensor(-0.6913, dtype=torch.float64)
12 gae_duplicate tensor(-3.1145, dtype=torch.float64) tensor(12.5562, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1458, dtype=torch.float64) delta_t tensor(-0.3646, dtype=torch.float64)
11 gae_duplicate tensor(-3.2134, dtype=torch.float64) tensor(8.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1595, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
10 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-3.7577, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.4939, dtype=torch.float64)
9 gae_duplicate tensor(0.0336, dtype=torch.float64) tensor(-9.4500, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4398, dtype=torch.float64) delta_t tensor(-0.4757, dtype=torch.float64)
8 gae_duplicate tensor(-0.7335, dtype=torch.float64) tensor(7.8340, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8726, dtype=torch.float64) delta_t tensor(-0.2667, dtype=torch.float64)
7 gae_duplicate tensor(-1.1109, dtype=torch.float64) tensor(5.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5317, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
6 gae_duplicate tensor(0.2226, dtype=torch.float64) tensor(-6.6009, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5085, dtype=torch.float64) delta_t tensor(-0.4165, dtype=torch.float64)
5 gae_duplicate tensor(-0.8323, dtype=torch.float64) tensor(6.8359, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0239, dtype=torch.float64) delta_t tensor(0.3590, dtype=torch.float64)
4 gae_duplicate tensor(0.0335, dtype=torch.float64) tensor(-6.0930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1852, dtype=torch.float64) delta_t tensor(-0.8052, dtype=torch.float64)
3 gae_duplicate tensor(-1.1472, dtype=torch.float64) tensor(15.4541, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3602, dtype=torch.float64) delta_t tensor(0.5352, dtype=torch.float64)
2 gae_duplicate tensor(0.1038, dtype=torch.float64) tensor(-9.4019, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-965.513671875
value loss:79.22319030761719
entropies:344.33441162109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.047593355178833 seconds
19 rew tensor(1.1116, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
19 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-0.7656, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0607, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
18 gae_duplicate tensor(-0.0239, dtype=torch.float64) tensor(-2.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0881, dtype=torch.float64) delta_t tensor(0.0927, dtype=torch.float64)
17 gae_duplicate tensor(-0.3016, dtype=torch.float64) tensor(-1.9850, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(0.0957, dtype=torch.float64)
16 gae_duplicate tensor(0.0794, dtype=torch.float64) tensor(-1.9278, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8689, dtype=torch.float64) delta_t tensor(0.0587, dtype=torch.float64)
15 gae_duplicate tensor(-0.0661, dtype=torch.float64) tensor(-1.7662, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4726, dtype=torch.float64) delta_t tensor(-0.1513, dtype=torch.float64)
14 gae_duplicate tensor(-1.5206, dtype=torch.float64) tensor(2.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5969, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
13 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-1.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4002, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
12 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(1.1715, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3536, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
11 gae_duplicate tensor(-0.4680, dtype=torch.float64) tensor(1.8207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0242, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
10 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-0.7673, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1445, dtype=torch.float64) delta_t tensor(0.3955, dtype=torch.float64)
9 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-8.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2613, dtype=torch.float64) delta_t tensor(-0.5589, dtype=torch.float64)
8 gae_duplicate tensor(-0.7352, dtype=torch.float64) tensor(9.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0179, dtype=torch.float64) delta_t tensor(-0.3205, dtype=torch.float64)
7 gae_duplicate tensor(-0.8584, dtype=torch.float64) tensor(6.9903, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3657, dtype=torch.float64) delta_t tensor(0.4652, dtype=torch.float64)
6 gae_duplicate tensor(0.3342, dtype=torch.float64) tensor(-7.8967, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6040, dtype=torch.float64) delta_t tensor(-0.3971, dtype=torch.float64)
5 gae_duplicate tensor(-0.6720, dtype=torch.float64) tensor(7.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0736, dtype=torch.float64) delta_t tensor(0.3905, dtype=torch.float64)
4 gae_duplicate tensor(0.0682, dtype=torch.float64) tensor(-6.9310, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1525, dtype=torch.float64) delta_t tensor(-0.8199, dtype=torch.float64)
3 gae_duplicate tensor(-1.1411, dtype=torch.float64) tensor(16.7939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4488, dtype=torch.float64) delta_t tensor(0.6298, dtype=torch.float64)
2 gae_duplicate tensor(0.2120, dtype=torch.float64) tensor(-11.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-122.91991424560547
value loss:25.95252799987793
entropies:344.0656433105469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3866.2246)
ToM Target loss= tensor(2266.8689)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.820007085800171 seconds
19 rew tensor(1.1647, dtype=torch.float64) delta_t tensor(0.0773, dtype=torch.float64)
19 gae_duplicate tensor(-0.0266, dtype=torch.float64) tensor(-1.4135, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0872, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
18 gae_duplicate tensor(0.0733, dtype=torch.float64) tensor(-2.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0235, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
17 gae_duplicate tensor(-0.2536, dtype=torch.float64) tensor(-1.0665, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9192, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
16 gae_duplicate tensor(-0.0406, dtype=torch.float64) tensor(-1.4730, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8287, dtype=torch.float64) delta_t tensor(0.0734, dtype=torch.float64)
15 gae_duplicate tensor(-0.0416, dtype=torch.float64) tensor(-1.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7388, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
14 gae_duplicate tensor(0.0382, dtype=torch.float64) tensor(-3.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5686, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
13 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-0.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3516, dtype=torch.float64) delta_t tensor(-0.1351, dtype=torch.float64)
12 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(2.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3336, dtype=torch.float64) delta_t tensor(-0.0912, dtype=torch.float64)
11 gae_duplicate tensor(-0.5227, dtype=torch.float64) tensor(1.3822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1337, dtype=torch.float64) delta_t tensor(0.0856, dtype=torch.float64)
10 gae_duplicate tensor(-0.0798, dtype=torch.float64) tensor(-1.3156, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0349, dtype=torch.float64) delta_t tensor(0.2386, dtype=torch.float64)
9 gae_duplicate tensor(-0.0529, dtype=torch.float64) tensor(-4.4193, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2835, dtype=torch.float64) delta_t tensor(-0.5462, dtype=torch.float64)
8 gae_duplicate tensor(-0.7081, dtype=torch.float64) tensor(9.3976, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1063, dtype=torch.float64) delta_t tensor(-0.4487, dtype=torch.float64)
7 gae_duplicate tensor(-0.9244, dtype=torch.float64) tensor(10.1491, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4143, dtype=torch.float64) delta_t tensor(0.4872, dtype=torch.float64)
6 gae_duplicate tensor(0.3398, dtype=torch.float64) tensor(-8.9393, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6383, dtype=torch.float64) delta_t tensor(-0.3983, dtype=torch.float64)
5 gae_duplicate tensor(-0.7915, dtype=torch.float64) tensor(6.3473, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1282, dtype=torch.float64) delta_t tensor(0.4376, dtype=torch.float64)
4 gae_duplicate tensor(0.0735, dtype=torch.float64) tensor(-7.3887, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2635, dtype=torch.float64) delta_t tensor(-0.8816, dtype=torch.float64)
3 gae_duplicate tensor(-1.2086, dtype=torch.float64) tensor(15.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4902, dtype=torch.float64) delta_t tensor(0.6647, dtype=torch.float64)
2 gae_duplicate tensor(0.1960, dtype=torch.float64) tensor(-11.6406, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-31.401002883911133
value loss:27.247047424316406
entropies:344.028076171875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.859072923660278 seconds
19 rew tensor(1.1875, dtype=torch.float64) delta_t tensor(0.0851, dtype=torch.float64)
19 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-1.5164, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1759, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
18 gae_duplicate tensor(-0.4716, dtype=torch.float64) tensor(-0.8665, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9084, dtype=torch.float64) delta_t tensor(-0.0205, dtype=torch.float64)
17 gae_duplicate tensor(-1.3741, dtype=torch.float64) tensor(0.4268, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0489, dtype=torch.float64) delta_t tensor(-0.0769, dtype=torch.float64)
16 gae_duplicate tensor(-0.5188, dtype=torch.float64) tensor(1.4160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7113, dtype=torch.float64) delta_t tensor(-0.2034, dtype=torch.float64)
15 gae_duplicate tensor(-1.6712, dtype=torch.float64) tensor(3.7124, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7927, dtype=torch.float64) delta_t tensor(0.0772, dtype=torch.float64)
14 gae_duplicate tensor(-0.0535, dtype=torch.float64) tensor(-1.0005, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7010, dtype=torch.float64) delta_t tensor(0.1546, dtype=torch.float64)
13 gae_duplicate tensor(-0.0320, dtype=torch.float64) tensor(-2.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1122, dtype=torch.float64) delta_t tensor(-0.3024, dtype=torch.float64)
12 gae_duplicate tensor(-2.0491, dtype=torch.float64) tensor(5.3044, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0965, dtype=torch.float64) delta_t tensor(-0.1514, dtype=torch.float64)
11 gae_duplicate tensor(-1.5469, dtype=torch.float64) tensor(2.6267, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0251, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
10 gae_duplicate tensor(-0.0105, dtype=torch.float64) tensor(-2.4962, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3403, dtype=torch.float64) delta_t tensor(0.6080, dtype=torch.float64)
9 gae_duplicate tensor(0.2207, dtype=torch.float64) tensor(-12.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6208, dtype=torch.float64) delta_t tensor(-0.5591, dtype=torch.float64)
8 gae_duplicate tensor(-0.9035, dtype=torch.float64) tensor(8.7864, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7868, dtype=torch.float64) delta_t tensor(-0.7686, dtype=torch.float64)
7 gae_duplicate tensor(-3.2836, dtype=torch.float64) tensor(14.7609, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7534, dtype=torch.float64) delta_t tensor(0.2393, dtype=torch.float64)
6 gae_duplicate tensor(-0.7436, dtype=torch.float64) tensor(-2.8403, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6082, dtype=torch.float64) delta_t tensor(-0.3943, dtype=torch.float64)
5 gae_duplicate tensor(-0.6902, dtype=torch.float64) tensor(8.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3347, dtype=torch.float64) delta_t tensor(0.6116, dtype=torch.float64)
4 gae_duplicate tensor(0.0932, dtype=torch.float64) tensor(-10.3429, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7796, dtype=torch.float64) delta_t tensor(-0.9058, dtype=torch.float64)
3 gae_duplicate tensor(-1.2569, dtype=torch.float64) tensor(15.2920, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6715, dtype=torch.float64) delta_t tensor(0.8134, dtype=torch.float64)
2 gae_duplicate tensor(0.0916, dtype=torch.float64) tensor(-12.9728, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-793.6189575195312
value loss:69.03868865966797
entropies:343.864990234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.801152944564819 seconds
19 rew tensor(1.0600, dtype=torch.float64) delta_t tensor(0.0024, dtype=torch.float64)
19 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-0.0350, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0474, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
18 gae_duplicate tensor(-0.0138, dtype=torch.float64) tensor(-2.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9310, dtype=torch.float64) delta_t tensor(0.0445, dtype=torch.float64)
17 gae_duplicate tensor(-0.0120, dtype=torch.float64) tensor(-1.0376, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9835, dtype=torch.float64) delta_t tensor(0.0800, dtype=torch.float64)
16 gae_duplicate tensor(0.0314, dtype=torch.float64) tensor(-1.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8419, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
15 gae_duplicate tensor(0.0231, dtype=torch.float64) tensor(-1.9084, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8282, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
14 gae_duplicate tensor(0.0533, dtype=torch.float64) tensor(-3.0449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5575, dtype=torch.float64) delta_t tensor(0.0506, dtype=torch.float64)
13 gae_duplicate tensor(0.0373, dtype=torch.float64) tensor(-1.2281, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4018, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
12 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(1.4057, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3501, dtype=torch.float64) delta_t tensor(-0.0754, dtype=torch.float64)
11 gae_duplicate tensor(-0.2328, dtype=torch.float64) tensor(1.4503, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0257, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
10 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(0.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1960, dtype=torch.float64) delta_t tensor(0.4644, dtype=torch.float64)
9 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-9.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2833, dtype=torch.float64) delta_t tensor(-0.5647, dtype=torch.float64)
8 gae_duplicate tensor(-0.6787, dtype=torch.float64) tensor(9.8286, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1250, dtype=torch.float64) delta_t tensor(-0.3413, dtype=torch.float64)
7 gae_duplicate tensor(-0.5800, dtype=torch.float64) tensor(7.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4268, dtype=torch.float64) delta_t tensor(0.3692, dtype=torch.float64)
6 gae_duplicate tensor(0.2906, dtype=torch.float64) tensor(-6.4239, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6305, dtype=torch.float64) delta_t tensor(-0.3497, dtype=torch.float64)
5 gae_duplicate tensor(-0.4486, dtype=torch.float64) tensor(5.7268, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1540, dtype=torch.float64) delta_t tensor(0.4354, dtype=torch.float64)
4 gae_duplicate tensor(0.1092, dtype=torch.float64) tensor(-7.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2570, dtype=torch.float64) delta_t tensor(-0.8447, dtype=torch.float64)
3 gae_duplicate tensor(-1.0293, dtype=torch.float64) tensor(15.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5154, dtype=torch.float64) delta_t tensor(0.7293, dtype=torch.float64)
2 gae_duplicate tensor(0.0937, dtype=torch.float64) tensor(-11.9900, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:131.0179443359375
value loss:22.39126205444336
entropies:343.74749755859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.095217227935791 seconds
19 rew tensor(1.1760, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
19 gae_duplicate tensor(0.0031, dtype=torch.float64) tensor(-2.4706, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1899, dtype=torch.float64) delta_t tensor(0.2581, dtype=torch.float64)
18 gae_duplicate tensor(0.0811, dtype=torch.float64) tensor(-4.8053, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1245, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
17 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(-3.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0741, dtype=torch.float64) delta_t tensor(0.0456, dtype=torch.float64)
16 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(-1.1663, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9966, dtype=torch.float64) delta_t tensor(0.1424, dtype=torch.float64)
15 gae_duplicate tensor(-0.1152, dtype=torch.float64) tensor(-2.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3097, dtype=torch.float64) delta_t tensor(-0.1888, dtype=torch.float64)
14 gae_duplicate tensor(-2.7410, dtype=torch.float64) tensor(2.9867, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0568, dtype=torch.float64) delta_t tensor(-0.4066, dtype=torch.float64)
13 gae_duplicate tensor(-2.9274, dtype=torch.float64) tensor(11.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0374, dtype=torch.float64) delta_t tensor(-0.1672, dtype=torch.float64)
12 gae_duplicate tensor(-1.2103, dtype=torch.float64) tensor(3.8475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4627, dtype=torch.float64) delta_t tensor(0.1240, dtype=torch.float64)
11 gae_duplicate tensor(-0.4912, dtype=torch.float64) tensor(-2.7373, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1281, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
10 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(0.1253, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5294, dtype=torch.float64) delta_t tensor(0.4034, dtype=torch.float64)
9 gae_duplicate tensor(-0.0377, dtype=torch.float64) tensor(-7.4065, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4909, dtype=torch.float64) delta_t tensor(-0.5327, dtype=torch.float64)
8 gae_duplicate tensor(-0.8526, dtype=torch.float64) tensor(9.2391, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5110, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
7 gae_duplicate tensor(-0.5964, dtype=torch.float64) tensor(0.9454, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8270, dtype=torch.float64) delta_t tensor(0.2884, dtype=torch.float64)
6 gae_duplicate tensor(-0.0314, dtype=torch.float64) tensor(-5.1909, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0176, dtype=torch.float64) delta_t tensor(0.0205, dtype=torch.float64)
5 gae_duplicate tensor(-0.5789, dtype=torch.float64) tensor(-1.0450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2843, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
4 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(-1.9997, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5268, dtype=torch.float64) delta_t tensor(-0.2357, dtype=torch.float64)
3 gae_duplicate tensor(-1.1153, dtype=torch.float64) tensor(5.9654, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0249, dtype=torch.float64) delta_t tensor(0.2410, dtype=torch.float64)
2 gae_duplicate tensor(-0.2694, dtype=torch.float64) tensor(-4.0443, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:45.708003997802734
value loss:50.566612243652344
entropies:343.58062744140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.83179497718811 seconds
19 rew tensor(1.0713, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
19 gae_duplicate tensor(-0.0866, dtype=torch.float64) tensor(-0.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0853, dtype=torch.float64) delta_t tensor(0.1377, dtype=torch.float64)
18 gae_duplicate tensor(0.0771, dtype=torch.float64) tensor(-2.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9573, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
17 gae_duplicate tensor(-0.0848, dtype=torch.float64) tensor(-1.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9708, dtype=torch.float64) delta_t tensor(-0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.4619, dtype=torch.float64) tensor(1.0728, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8032, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
15 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-0.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8293, dtype=torch.float64) delta_t tensor(0.1768, dtype=torch.float64)
14 gae_duplicate tensor(-0.0186, dtype=torch.float64) tensor(-3.2313, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5952, dtype=torch.float64) delta_t tensor(0.0183, dtype=torch.float64)
13 gae_duplicate tensor(-0.1639, dtype=torch.float64) tensor(-1.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3643, dtype=torch.float64) delta_t tensor(-0.0697, dtype=torch.float64)
12 gae_duplicate tensor(-0.1807, dtype=torch.float64) tensor(1.4180, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5025, dtype=torch.float64) delta_t tensor(0.0635, dtype=torch.float64)
11 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(-0.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1531, dtype=torch.float64) delta_t tensor(-0.1481, dtype=torch.float64)
10 gae_duplicate tensor(-0.3813, dtype=torch.float64) tensor(2.4927, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3095, dtype=torch.float64) delta_t tensor(0.5965, dtype=torch.float64)
9 gae_duplicate tensor(0.3819, dtype=torch.float64) tensor(-10.3805, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3592, dtype=torch.float64) delta_t tensor(-0.6511, dtype=torch.float64)
8 gae_duplicate tensor(-0.9885, dtype=torch.float64) tensor(10.6438, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3417, dtype=torch.float64) delta_t tensor(-0.3627, dtype=torch.float64)
7 gae_duplicate tensor(-1.4645, dtype=torch.float64) tensor(8.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4906, dtype=torch.float64) delta_t tensor(0.2915, dtype=torch.float64)
6 gae_duplicate tensor(-0.3645, dtype=torch.float64) tensor(-4.6216, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5827, dtype=torch.float64) delta_t tensor(-0.3588, dtype=torch.float64)
5 gae_duplicate tensor(-0.5786, dtype=torch.float64) tensor(5.9996, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1530, dtype=torch.float64) delta_t tensor(0.4592, dtype=torch.float64)
4 gae_duplicate tensor(0.2285, dtype=torch.float64) tensor(-7.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2697, dtype=torch.float64) delta_t tensor(-0.7108, dtype=torch.float64)
3 gae_duplicate tensor(-0.8698, dtype=torch.float64) tensor(12.1223, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5284, dtype=torch.float64) delta_t tensor(0.6578, dtype=torch.float64)
2 gae_duplicate tensor(0.3301, dtype=torch.float64) tensor(-12.9999, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:85.74774169921875
value loss:27.13388442993164
entropies:343.1634521484375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3876.3765)
ToM Target loss= tensor(2242.0352)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.652792692184448 seconds
19 rew tensor(0.9266, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
19 gae_duplicate tensor(-1.3293, dtype=torch.float64) tensor(0.2810, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1507, dtype=torch.float64) delta_t tensor(0.3210, dtype=torch.float64)
18 gae_duplicate tensor(0.0664, dtype=torch.float64) tensor(-5.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0215, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
17 gae_duplicate tensor(-0.0277, dtype=torch.float64) tensor(-3.1398, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9947, dtype=torch.float64) delta_t tensor(0.1696, dtype=torch.float64)
16 gae_duplicate tensor(0.0254, dtype=torch.float64) tensor(-3.5020, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9047, dtype=torch.float64) delta_t tensor(0.2095, dtype=torch.float64)
15 gae_duplicate tensor(-0.0044, dtype=torch.float64) tensor(-4.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3925, dtype=torch.float64) delta_t tensor(-0.1489, dtype=torch.float64)
14 gae_duplicate tensor(-1.4067, dtype=torch.float64) tensor(2.0638, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.2298, dtype=torch.float64)
13 gae_duplicate tensor(0.0186, dtype=torch.float64) tensor(-3.9788, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2055, dtype=torch.float64) delta_t tensor(-0.0548, dtype=torch.float64)
12 gae_duplicate tensor(-0.3793, dtype=torch.float64) tensor(0.4253, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5570, dtype=torch.float64) delta_t tensor(0.1833, dtype=torch.float64)
11 gae_duplicate tensor(-0.2292, dtype=torch.float64) tensor(-3.2684, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1921, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
10 gae_duplicate tensor(-0.1744, dtype=torch.float64) tensor(-0.3758, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4258, dtype=torch.float64) delta_t tensor(0.4064, dtype=torch.float64)
9 gae_duplicate tensor(-0.1019, dtype=torch.float64) tensor(-7.4999, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6465, dtype=torch.float64) delta_t tensor(-0.5867, dtype=torch.float64)
8 gae_duplicate tensor(-0.8556, dtype=torch.float64) tensor(12.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1320, dtype=torch.float64) delta_t tensor(-0.3930, dtype=torch.float64)
7 gae_duplicate tensor(-2.9841, dtype=torch.float64) tensor(7.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7390, dtype=torch.float64) delta_t tensor(0.2906, dtype=torch.float64)
6 gae_duplicate tensor(-0.6571, dtype=torch.float64) tensor(-4.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2952, dtype=torch.float64) delta_t tensor(-0.0931, dtype=torch.float64)
5 gae_duplicate tensor(-0.2934, dtype=torch.float64) tensor(1.3090, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0055, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
4 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-5.4394, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1241, dtype=torch.float64) delta_t tensor(-0.5903, dtype=torch.float64)
3 gae_duplicate tensor(-1.1785, dtype=torch.float64) tensor(10.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3314, dtype=torch.float64) delta_t tensor(0.4324, dtype=torch.float64)
2 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-6.3213, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:695.1366577148438
value loss:47.3900260925293
entropies:342.8839416503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.081936359405518 seconds
19 rew tensor(1.1785, dtype=torch.float64) delta_t tensor(0.1274, dtype=torch.float64)
19 gae_duplicate tensor(-0.0256, dtype=torch.float64) tensor(-2.2856, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1412, dtype=torch.float64) delta_t tensor(0.2252, dtype=torch.float64)
18 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-4.2120, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(-0.0142, dtype=torch.float64)
17 gae_duplicate tensor(-0.5838, dtype=torch.float64) tensor(-0.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8815, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
16 gae_duplicate tensor(-0.0287, dtype=torch.float64) tensor(-1.5473, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8547, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
15 gae_duplicate tensor(-0.0379, dtype=torch.float64) tensor(-3.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4907, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
14 gae_duplicate tensor(-1.2717, dtype=torch.float64) tensor(0.9742, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4907, dtype=torch.float64) delta_t tensor(-0.0034, dtype=torch.float64)
13 gae_duplicate tensor(-0.2510, dtype=torch.float64) tensor(0.1664, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3770, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
12 gae_duplicate tensor(-0.1750, dtype=torch.float64) tensor(-1.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4117, dtype=torch.float64) delta_t tensor(0.0857, dtype=torch.float64)
11 gae_duplicate tensor(-0.4828, dtype=torch.float64) tensor(-1.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0257, dtype=torch.float64) delta_t tensor(0.1478, dtype=torch.float64)
10 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(-2.6571, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3632, dtype=torch.float64) delta_t tensor(0.3502, dtype=torch.float64)
9 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-7.1040, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4927, dtype=torch.float64) delta_t tensor(-0.5050, dtype=torch.float64)
8 gae_duplicate tensor(-0.7089, dtype=torch.float64) tensor(9.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4713, dtype=torch.float64) delta_t tensor(-0.0339, dtype=torch.float64)
7 gae_duplicate tensor(-0.5716, dtype=torch.float64) tensor(1.6088, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6879, dtype=torch.float64) delta_t tensor(0.3943, dtype=torch.float64)
6 gae_duplicate tensor(0.0379, dtype=torch.float64) tensor(-6.8177, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1958, dtype=torch.float64) delta_t tensor(-0.0476, dtype=torch.float64)
5 gae_duplicate tensor(-0.5424, dtype=torch.float64) tensor(-0.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2076, dtype=torch.float64) delta_t tensor(0.1202, dtype=torch.float64)
4 gae_duplicate tensor(-0.4340, dtype=torch.float64) tensor(-3.1475, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7447, dtype=torch.float64) delta_t tensor(-0.2855, dtype=torch.float64)
3 gae_duplicate tensor(-0.9364, dtype=torch.float64) tensor(5.0583, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1679, dtype=torch.float64) delta_t tensor(0.3415, dtype=torch.float64)
2 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(-5.3024, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1133.0948486328125
value loss:22.24294090270996
entropies:342.7439880371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.376446008682251 seconds
19 rew tensor(1.1252, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
19 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-1.1411, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1270, dtype=torch.float64) delta_t tensor(0.1931, dtype=torch.float64)
18 gae_duplicate tensor(0.0808, dtype=torch.float64) tensor(-4.0123, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.0922, dtype=torch.float64)
17 gae_duplicate tensor(0.0197, dtype=torch.float64) tensor(-2.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9350, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
16 gae_duplicate tensor(-0.0174, dtype=torch.float64) tensor(-2.2952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8820, dtype=torch.float64) delta_t tensor(0.1049, dtype=torch.float64)
15 gae_duplicate tensor(0.0507, dtype=torch.float64) tensor(-2.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7154, dtype=torch.float64) delta_t tensor(0.1022, dtype=torch.float64)
14 gae_duplicate tensor(0.0051, dtype=torch.float64) tensor(-2.0327, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3996, dtype=torch.float64) delta_t tensor(-0.0673, dtype=torch.float64)
13 gae_duplicate tensor(-1.0133, dtype=torch.float64) tensor(2.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2593, dtype=torch.float64) delta_t tensor(-0.0217, dtype=torch.float64)
12 gae_duplicate tensor(-0.3711, dtype=torch.float64) tensor(0.8741, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5062, dtype=torch.float64) delta_t tensor(0.0912, dtype=torch.float64)
11 gae_duplicate tensor(-0.2221, dtype=torch.float64) tensor(-1.8733, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0777, dtype=torch.float64) delta_t tensor(0.0047, dtype=torch.float64)
10 gae_duplicate tensor(-0.2642, dtype=torch.float64) tensor(-0.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(0.3859, dtype=torch.float64)
9 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(-6.9062, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5601, dtype=torch.float64) delta_t tensor(-0.6051, dtype=torch.float64)
8 gae_duplicate tensor(-0.8087, dtype=torch.float64) tensor(10.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5464, dtype=torch.float64) delta_t tensor(-0.0019, dtype=torch.float64)
7 gae_duplicate tensor(-0.5532, dtype=torch.float64) tensor(1.7207, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6516, dtype=torch.float64) delta_t tensor(0.3419, dtype=torch.float64)
6 gae_duplicate tensor(-0.0291, dtype=torch.float64) tensor(-5.9820, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2737, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
5 gae_duplicate tensor(-0.4124, dtype=torch.float64) tensor(-0.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0797, dtype=torch.float64) delta_t tensor(0.2251, dtype=torch.float64)
4 gae_duplicate tensor(-0.1776, dtype=torch.float64) tensor(-3.9180, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9385, dtype=torch.float64) delta_t tensor(-0.4998, dtype=torch.float64)
3 gae_duplicate tensor(-1.0988, dtype=torch.float64) tensor(8.8507, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2962, dtype=torch.float64) delta_t tensor(0.3925, dtype=torch.float64)
2 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-7.2318, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:784.7951049804688
value loss:20.838834762573242
entropies:342.38189697265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.864005088806152 seconds
19 rew tensor(1.1154, dtype=torch.float64) delta_t tensor(0.0007, dtype=torch.float64)
19 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(-0.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1030, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
18 gae_duplicate tensor(-0.3754, dtype=torch.float64) tensor(-1.7173, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0776, dtype=torch.float64) delta_t tensor(0.1606, dtype=torch.float64)
17 gae_duplicate tensor(0.0608, dtype=torch.float64) tensor(-2.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(-0.1155, dtype=torch.float64)
16 gae_duplicate tensor(-0.3887, dtype=torch.float64) tensor(2.1730, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9489, dtype=torch.float64) delta_t tensor(0.1365, dtype=torch.float64)
15 gae_duplicate tensor(-0.0293, dtype=torch.float64) tensor(-2.4190, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6098, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
14 gae_duplicate tensor(0.0034, dtype=torch.float64) tensor(-1.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5028, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
13 gae_duplicate tensor(-1.1271, dtype=torch.float64) tensor(-0.2338, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1149, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
12 gae_duplicate tensor(-0.3795, dtype=torch.float64) tensor(1.4845, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6251, dtype=torch.float64) delta_t tensor(0.1726, dtype=torch.float64)
11 gae_duplicate tensor(-0.1455, dtype=torch.float64) tensor(-3.5724, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1579, dtype=torch.float64) delta_t tensor(-0.1575, dtype=torch.float64)
10 gae_duplicate tensor(-0.4647, dtype=torch.float64) tensor(3.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4143, dtype=torch.float64) delta_t tensor(0.3197, dtype=torch.float64)
9 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-5.7123, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5225, dtype=torch.float64) delta_t tensor(-0.4390, dtype=torch.float64)
8 gae_duplicate tensor(-0.6573, dtype=torch.float64) tensor(8.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3537, dtype=torch.float64) delta_t tensor(0.0834, dtype=torch.float64)
7 gae_duplicate tensor(-0.2247, dtype=torch.float64) tensor(-1.2466, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6392, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
6 gae_duplicate tensor(0.1941, dtype=torch.float64) tensor(-9.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2002, dtype=torch.float64) delta_t tensor(-0.0815, dtype=torch.float64)
5 gae_duplicate tensor(-0.2995, dtype=torch.float64) tensor(0.6991, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2363, dtype=torch.float64) delta_t tensor(0.1171, dtype=torch.float64)
4 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(-2.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6820, dtype=torch.float64) delta_t tensor(-0.3306, dtype=torch.float64)
3 gae_duplicate tensor(-1.1021, dtype=torch.float64) tensor(5.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1402, dtype=torch.float64) delta_t tensor(0.2357, dtype=torch.float64)
2 gae_duplicate tensor(-0.2582, dtype=torch.float64) tensor(-3.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:653.9766235351562
value loss:16.75122833251953
entropies:341.9181823730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2522618770599365 seconds
19 rew tensor(1.1804, dtype=torch.float64) delta_t tensor(0.1265, dtype=torch.float64)
19 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-2.1875, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1154, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
18 gae_duplicate tensor(-0.4443, dtype=torch.float64) tensor(-0.7414, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9852, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
17 gae_duplicate tensor(-0.0040, dtype=torch.float64) tensor(-1.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9728, dtype=torch.float64) delta_t tensor(0.0627, dtype=torch.float64)
16 gae_duplicate tensor(-0.0435, dtype=torch.float64) tensor(-1.4794, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8562, dtype=torch.float64) delta_t tensor(0.0805, dtype=torch.float64)
15 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-1.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6254, dtype=torch.float64) delta_t tensor(0.1127, dtype=torch.float64)
14 gae_duplicate tensor(-0.0792, dtype=torch.float64) tensor(-2.2624, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7514, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
13 gae_duplicate tensor(-0.1341, dtype=torch.float64) tensor(-4.4081, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2868, dtype=torch.float64) delta_t tensor(-0.1025, dtype=torch.float64)
12 gae_duplicate tensor(-0.2837, dtype=torch.float64) tensor(1.4043, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5156, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
11 gae_duplicate tensor(-0.1839, dtype=torch.float64) tensor(-0.3864, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1184, dtype=torch.float64) delta_t tensor(-0.0611, dtype=torch.float64)
10 gae_duplicate tensor(-0.3786, dtype=torch.float64) tensor(1.1006, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(0.2115, dtype=torch.float64)
9 gae_duplicate tensor(-0.1350, dtype=torch.float64) tensor(-3.7167, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5235, dtype=torch.float64) delta_t tensor(-0.3440, dtype=torch.float64)
8 gae_duplicate tensor(-0.5871, dtype=torch.float64) tensor(5.7515, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2718, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
7 gae_duplicate tensor(-0.5730, dtype=torch.float64) tensor(-1.2243, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7681, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
6 gae_duplicate tensor(-0.0648, dtype=torch.float64) tensor(-5.7993, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.9782, dtype=torch.float64) delta_t tensor(-0.2031, dtype=torch.float64)
5 gae_duplicate tensor(-0.5314, dtype=torch.float64) tensor(3.1624, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3114, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
4 gae_duplicate tensor(-0.4994, dtype=torch.float64) tensor(1.2199, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4872, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
3 gae_duplicate tensor(-0.5078, dtype=torch.float64) tensor(-0.4905, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.1389, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
2 gae_duplicate tensor(-0.3744, dtype=torch.float64) tensor(-1.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:701.002197265625
value loss:16.891836166381836
entropies:341.58074951171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3870.6196)
ToM Target loss= tensor(2219.8594)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.115507125854492 seconds
19 rew tensor(1.1662, dtype=torch.float64) delta_t tensor(0.1213, dtype=torch.float64)
19 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-2.3824, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1533, dtype=torch.float64) delta_t tensor(0.2176, dtype=torch.float64)
18 gae_duplicate tensor(0.0166, dtype=torch.float64) tensor(-4.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1024, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
17 gae_duplicate tensor(0.0929, dtype=torch.float64) tensor(-3.6718, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0508, dtype=torch.float64) delta_t tensor(0.1596, dtype=torch.float64)
16 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-3.3369, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(-0.3427, dtype=torch.float64)
15 gae_duplicate tensor(-2.6514, dtype=torch.float64) tensor(8.3479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4699, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
14 gae_duplicate tensor(-1.1172, dtype=torch.float64) tensor(2.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3163, dtype=torch.float64) delta_t tensor(-0.0430, dtype=torch.float64)
13 gae_duplicate tensor(-1.1582, dtype=torch.float64) tensor(0.9627, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4281, dtype=torch.float64) delta_t tensor(0.2438, dtype=torch.float64)
12 gae_duplicate tensor(-0.1205, dtype=torch.float64) tensor(-4.4339, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3353, dtype=torch.float64) delta_t tensor(0.0642, dtype=torch.float64)
11 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(-1.6101, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0223, dtype=torch.float64) delta_t tensor(0.1430, dtype=torch.float64)
10 gae_duplicate tensor(-0.0587, dtype=torch.float64) tensor(-2.7652, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3078, dtype=torch.float64) delta_t tensor(0.5421, dtype=torch.float64)
9 gae_duplicate tensor(0.0257, dtype=torch.float64) tensor(-10.9129, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4161, dtype=torch.float64) delta_t tensor(-0.4095, dtype=torch.float64)
8 gae_duplicate tensor(-0.9009, dtype=torch.float64) tensor(5.5769, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7120, dtype=torch.float64) delta_t tensor(-0.6433, dtype=torch.float64)
7 gae_duplicate tensor(-2.6990, dtype=torch.float64) tensor(13.4462, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5866, dtype=torch.float64) delta_t tensor(0.2884, dtype=torch.float64)
6 gae_duplicate tensor(-0.6027, dtype=torch.float64) tensor(-3.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5966, dtype=torch.float64) delta_t tensor(-0.2640, dtype=torch.float64)
5 gae_duplicate tensor(-0.7535, dtype=torch.float64) tensor(4.8215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2554, dtype=torch.float64) delta_t tensor(0.4770, dtype=torch.float64)
4 gae_duplicate tensor(0.2554, dtype=torch.float64) tensor(-7.7334, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5284, dtype=torch.float64) delta_t tensor(-0.7518, dtype=torch.float64)
3 gae_duplicate tensor(-0.9173, dtype=torch.float64) tensor(13.2984, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6075, dtype=torch.float64) delta_t tensor(0.6768, dtype=torch.float64)
2 gae_duplicate tensor(0.3471, dtype=torch.float64) tensor(-10.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:238.96913146972656
value loss:52.69719314575195
entropies:340.7936096191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.858633041381836 seconds
19 rew tensor(1.2176, dtype=torch.float64) delta_t tensor(0.1654, dtype=torch.float64)
19 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-3.2095, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1797, dtype=torch.float64) delta_t tensor(0.2228, dtype=torch.float64)
18 gae_duplicate tensor(0.0920, dtype=torch.float64) tensor(-4.3327, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1673, dtype=torch.float64) delta_t tensor(0.1145, dtype=torch.float64)
17 gae_duplicate tensor(-0.3862, dtype=torch.float64) tensor(-2.7461, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0779, dtype=torch.float64) delta_t tensor(0.2387, dtype=torch.float64)
16 gae_duplicate tensor(0.1150, dtype=torch.float64) tensor(-4.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0014, dtype=torch.float64) delta_t tensor(0.2564, dtype=torch.float64)
15 gae_duplicate tensor(0.0033, dtype=torch.float64) tensor(-5.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2144, dtype=torch.float64) delta_t tensor(-0.3128, dtype=torch.float64)
14 gae_duplicate tensor(-2.7872, dtype=torch.float64) tensor(8.6449, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3243, dtype=torch.float64) delta_t tensor(-0.1381, dtype=torch.float64)
13 gae_duplicate tensor(-1.2682, dtype=torch.float64) tensor(4.8765, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4245, dtype=torch.float64) delta_t tensor(0.1766, dtype=torch.float64)
12 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(-2.8951, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0912, dtype=torch.float64) delta_t tensor(-0.2562, dtype=torch.float64)
11 gae_duplicate tensor(-2.9540, dtype=torch.float64) tensor(4.2947, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2166, dtype=torch.float64) delta_t tensor(-0.0334, dtype=torch.float64)
10 gae_duplicate tensor(-1.0243, dtype=torch.float64) tensor(0.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3536, dtype=torch.float64) delta_t tensor(0.3485, dtype=torch.float64)
9 gae_duplicate tensor(0.1110, dtype=torch.float64) tensor(-6.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4459, dtype=torch.float64) delta_t tensor(-0.2883, dtype=torch.float64)
8 gae_duplicate tensor(-0.8703, dtype=torch.float64) tensor(4.2754, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6732, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
7 gae_duplicate tensor(-1.3245, dtype=torch.float64) tensor(3.0771, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7979, dtype=torch.float64) delta_t tensor(0.3700, dtype=torch.float64)
6 gae_duplicate tensor(0.0577, dtype=torch.float64) tensor(-7.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1231, dtype=torch.float64) delta_t tensor(-0.1281, dtype=torch.float64)
5 gae_duplicate tensor(-0.6203, dtype=torch.float64) tensor(1.8512, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1632, dtype=torch.float64) delta_t tensor(0.1662, dtype=torch.float64)
4 gae_duplicate tensor(-0.2736, dtype=torch.float64) tensor(-2.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7456, dtype=torch.float64) delta_t tensor(-0.3029, dtype=torch.float64)
3 gae_duplicate tensor(-1.0094, dtype=torch.float64) tensor(4.5998, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0983, dtype=torch.float64) delta_t tensor(0.2454, dtype=torch.float64)
2 gae_duplicate tensor(-0.4801, dtype=torch.float64) tensor(-4.0412, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:451.02642822265625
value loss:56.05180358886719
entropies:340.09991455078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.553230285644531 seconds
19 rew tensor(1.1671, dtype=torch.float64) delta_t tensor(0.1056, dtype=torch.float64)
19 gae_duplicate tensor(-0.0333, dtype=torch.float64) tensor(-1.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1031, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
18 gae_duplicate tensor(0.0592, dtype=torch.float64) tensor(-3.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0889, dtype=torch.float64) delta_t tensor(0.1594, dtype=torch.float64)
17 gae_duplicate tensor(0.0347, dtype=torch.float64) tensor(-3.1781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9461, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
16 gae_duplicate tensor(0.0656, dtype=torch.float64) tensor(-3.2145, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9594, dtype=torch.float64) delta_t tensor(0.2145, dtype=torch.float64)
15 gae_duplicate tensor(0.0054, dtype=torch.float64) tensor(-4.0475, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1407, dtype=torch.float64) delta_t tensor(-0.3100, dtype=torch.float64)
14 gae_duplicate tensor(-2.7085, dtype=torch.float64) tensor(4.9301, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5989, dtype=torch.float64) delta_t tensor(0.1382, dtype=torch.float64)
13 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-1.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3090, dtype=torch.float64) delta_t tensor(0.0050, dtype=torch.float64)
12 gae_duplicate tensor(-0.2351, dtype=torch.float64) tensor(-0.0744, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4648, dtype=torch.float64) delta_t tensor(0.1073, dtype=torch.float64)
11 gae_duplicate tensor(-0.4795, dtype=torch.float64) tensor(-3.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0681, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
10 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-1.0274, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3878, dtype=torch.float64) delta_t tensor(0.3300, dtype=torch.float64)
9 gae_duplicate tensor(-0.0471, dtype=torch.float64) tensor(-6.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4986, dtype=torch.float64) delta_t tensor(-0.4580, dtype=torch.float64)
8 gae_duplicate tensor(-0.8469, dtype=torch.float64) tensor(9.0198, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5341, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
7 gae_duplicate tensor(-0.6118, dtype=torch.float64) tensor(-0.0622, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5763, dtype=torch.float64) delta_t tensor(0.4688, dtype=torch.float64)
6 gae_duplicate tensor(0.3066, dtype=torch.float64) tensor(-8.6572, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3318, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
5 gae_duplicate tensor(-0.4540, dtype=torch.float64) tensor(-0.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1374, dtype=torch.float64) delta_t tensor(0.1336, dtype=torch.float64)
4 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-2.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8610, dtype=torch.float64) delta_t tensor(-0.5460, dtype=torch.float64)
3 gae_duplicate tensor(-0.9578, dtype=torch.float64) tensor(8.7109, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2140, dtype=torch.float64) delta_t tensor(0.2818, dtype=torch.float64)
2 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-4.3690, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1085.8079833984375
value loss:29.26250457763672
entropies:339.24200439453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038316011428833 seconds
19 rew tensor(1.2455, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
19 gae_duplicate tensor(-0.4810, dtype=torch.float64) tensor(-1.0474, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1563, dtype=torch.float64) delta_t tensor(0.0686, dtype=torch.float64)
18 gae_duplicate tensor(-0.5761, dtype=torch.float64) tensor(-1.2712, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0399, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
17 gae_duplicate tensor(0.0023, dtype=torch.float64) tensor(-2.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9739, dtype=torch.float64) delta_t tensor(0.0776, dtype=torch.float64)
16 gae_duplicate tensor(-0.3962, dtype=torch.float64) tensor(-1.6835, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8325, dtype=torch.float64) delta_t tensor(0.0409, dtype=torch.float64)
15 gae_duplicate tensor(-0.0283, dtype=torch.float64) tensor(-1.1301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4571, dtype=torch.float64) delta_t tensor(-0.1624, dtype=torch.float64)
14 gae_duplicate tensor(-1.2708, dtype=torch.float64) tensor(2.7377, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5183, dtype=torch.float64) delta_t tensor(0.0463, dtype=torch.float64)
13 gae_duplicate tensor(-0.2652, dtype=torch.float64) tensor(-0.5226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2823, dtype=torch.float64) delta_t tensor(-0.0088, dtype=torch.float64)
12 gae_duplicate tensor(-0.2484, dtype=torch.float64) tensor(0.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.0485, dtype=torch.float64)
11 gae_duplicate tensor(-0.4852, dtype=torch.float64) tensor(-0.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0683, dtype=torch.float64) delta_t tensor(-0.0131, dtype=torch.float64)
10 gae_duplicate tensor(-0.2784, dtype=torch.float64) tensor(0.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3509, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
9 gae_duplicate tensor(0.3968, dtype=torch.float64) tensor(-9.5786, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4750, dtype=torch.float64) delta_t tensor(-0.4524, dtype=torch.float64)
8 gae_duplicate tensor(-0.6459, dtype=torch.float64) tensor(6.6023, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0940, dtype=torch.float64) delta_t tensor(-0.1582, dtype=torch.float64)
7 gae_duplicate tensor(-0.4643, dtype=torch.float64) tensor(4.0137, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5798, dtype=torch.float64) delta_t tensor(0.2168, dtype=torch.float64)
6 gae_duplicate tensor(-0.2089, dtype=torch.float64) tensor(-4.1356, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5641, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
5 gae_duplicate tensor(-0.7458, dtype=torch.float64) tensor(5.0045, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1516, dtype=torch.float64) delta_t tensor(0.4033, dtype=torch.float64)
4 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-6.5183, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3593, dtype=torch.float64) delta_t tensor(-0.6291, dtype=torch.float64)
3 gae_duplicate tensor(-0.9005, dtype=torch.float64) tensor(11.4753, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4904, dtype=torch.float64) delta_t tensor(0.5455, dtype=torch.float64)
2 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(-9.2205, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:364.6722412109375
value loss:23.711240768432617
entropies:338.428466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0214619636535645 seconds
19 rew tensor(1.1418, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
19 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-0.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1293, dtype=torch.float64) delta_t tensor(0.1883, dtype=torch.float64)
18 gae_duplicate tensor(0.0973, dtype=torch.float64) tensor(-3.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0909, dtype=torch.float64) delta_t tensor(0.1624, dtype=torch.float64)
17 gae_duplicate tensor(0.1118, dtype=torch.float64) tensor(-3.3635, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(0.0789, dtype=torch.float64)
16 gae_duplicate tensor(0.0154, dtype=torch.float64) tensor(-1.8658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(0.1147, dtype=torch.float64)
15 gae_duplicate tensor(-0.0020, dtype=torch.float64) tensor(-2.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3305, dtype=torch.float64) delta_t tensor(-0.0992, dtype=torch.float64)
14 gae_duplicate tensor(-1.3127, dtype=torch.float64) tensor(1.3375, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7697, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
13 gae_duplicate tensor(0.0208, dtype=torch.float64) tensor(-4.7575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1792, dtype=torch.float64) delta_t tensor(-0.1730, dtype=torch.float64)
12 gae_duplicate tensor(-0.3650, dtype=torch.float64) tensor(3.5171, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5828, dtype=torch.float64) delta_t tensor(0.1727, dtype=torch.float64)
11 gae_duplicate tensor(-0.2048, dtype=torch.float64) tensor(-2.8461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1584, dtype=torch.float64) delta_t tensor(-0.0155, dtype=torch.float64)
10 gae_duplicate tensor(-0.1297, dtype=torch.float64) tensor(0.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3080, dtype=torch.float64) delta_t tensor(0.2093, dtype=torch.float64)
9 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-3.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4716, dtype=torch.float64) delta_t tensor(-0.5775, dtype=torch.float64)
8 gae_duplicate tensor(-0.7156, dtype=torch.float64) tensor(10.8636, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7081, dtype=torch.float64) delta_t tensor(0.0610, dtype=torch.float64)
7 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(0.1186, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5763, dtype=torch.float64) delta_t tensor(0.4902, dtype=torch.float64)
6 gae_duplicate tensor(0.3722, dtype=torch.float64) tensor(-9.9816, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3875, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
5 gae_duplicate tensor(-0.3307, dtype=torch.float64) tensor(0.5271, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0050, dtype=torch.float64) delta_t tensor(0.2416, dtype=torch.float64)
4 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-3.9579, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0481, dtype=torch.float64) delta_t tensor(-0.6835, dtype=torch.float64)
3 gae_duplicate tensor(-1.3086, dtype=torch.float64) tensor(10.7709, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3599, dtype=torch.float64) delta_t tensor(0.4173, dtype=torch.float64)
2 gae_duplicate tensor(0.0833, dtype=torch.float64) tensor(-6.3325, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:798.7066650390625
value loss:22.007652282714844
entropies:337.5430908203125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3857.0459)
ToM Target loss= tensor(2192.5620)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt