obs <crafter.objects.Shelter object at 0x16dd547c0> [39.  0.  0.  0. 39.  0.  0.  0. 19.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x16dd54a00> [38.  0.  0.  0. 39.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16dd54d00> [ 9.  0.  0.  0.  9.  0.  0.  0. 11.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x16dd547c0> [39.  0.  0.  0. 39.  0.  0.  0. 20.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x16dd54a00> [44.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x16dd54d00> [ 9.  0.  0.  0.  9.  0.  0.  0. 14.  0.  0.  0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.0024390220642089844 seconds
19 rew tensor(1.2912, dtype=torch.float64) delta_t tensor(1.3617, dtype=torch.float64)
19 gae_duplicate tensor(1.2593, dtype=torch.float64) tensor(-26.9978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.3914, dtype=torch.float64) delta_t tensor(1.5843, dtype=torch.float64)
18 gae_duplicate tensor(1.4858, dtype=torch.float64) tensor(-34.1263, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2822, dtype=torch.float64) delta_t tensor(1.3516, dtype=torch.float64)
17 gae_duplicate tensor(1.0112, dtype=torch.float64) tensor(-30.7730, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.3063, dtype=torch.float64) delta_t tensor(1.5441, dtype=torch.float64)
16 gae_duplicate tensor(1.5613, dtype=torch.float64) tensor(-33.6627, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.2808, dtype=torch.float64) delta_t tensor(1.1586, dtype=torch.float64)
15 gae_duplicate tensor(1.1259, dtype=torch.float64) tensor(-25.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8519, dtype=torch.float64) delta_t tensor(1.0809, dtype=torch.float64)
14 gae_duplicate tensor(0.2598, dtype=torch.float64) tensor(-24.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.3449, dtype=torch.float64) delta_t tensor(1.3708, dtype=torch.float64)
13 gae_duplicate tensor(1.2877, dtype=torch.float64) tensor(-29.4302, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6403, dtype=torch.float64) delta_t tensor(0.8834, dtype=torch.float64)
12 gae_duplicate tensor(0.8464, dtype=torch.float64) tensor(-19.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.3600, dtype=torch.float64) delta_t tensor(1.4182, dtype=torch.float64)
11 gae_duplicate tensor(1.1559, dtype=torch.float64) tensor(-30.9166, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3914, dtype=torch.float64) delta_t tensor(0.4071, dtype=torch.float64)
10 gae_duplicate tensor(0.0482, dtype=torch.float64) tensor(-11.1764, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.4212, dtype=torch.float64) delta_t tensor(1.4324, dtype=torch.float64)
9 gae_duplicate tensor(1.2313, dtype=torch.float64) tensor(-29.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(0.0431, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
8 gae_duplicate tensor(-0.5838, dtype=torch.float64) tensor(-3.9470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.7834, dtype=torch.float64) delta_t tensor(0.8369, dtype=torch.float64)
7 gae_duplicate tensor(-0.3965, dtype=torch.float64) tensor(-17.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.3544, dtype=torch.float64) delta_t tensor(-0.3355, dtype=torch.float64)
6 gae_duplicate tensor(-1.0636, dtype=torch.float64) tensor(4.7446, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4435, dtype=torch.float64) delta_t tensor(-0.5359, dtype=torch.float64)
5 gae_duplicate tensor(-1.1471, dtype=torch.float64) tensor(10.6965, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2169, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
4 gae_duplicate tensor(-0.8437, dtype=torch.float64) tensor(-0.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(0.4709, dtype=torch.float64) delta_t tensor(0.2422, dtype=torch.float64)
3 gae_duplicate tensor(-0.7482, dtype=torch.float64) tensor(-4.7315, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.9474, dtype=torch.float64) delta_t tensor(0.8913, dtype=torch.float64)
2 gae_duplicate tensor(0.7681, dtype=torch.float64) tensor(-17.4917, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17468.6640625
value loss:238.82339477539062
entropies:354.2188415527344
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 4.889613151550293 seconds
19 rew tensor(1.2353, dtype=torch.float64) delta_t tensor(1.3833, dtype=torch.float64)
19 gae_duplicate tensor(1.1916, dtype=torch.float64) tensor(-27.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2523, dtype=torch.float64) delta_t tensor(1.3533, dtype=torch.float64)
18 gae_duplicate tensor(1.2019, dtype=torch.float64) tensor(-28.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1137, dtype=torch.float64) delta_t tensor(1.2010, dtype=torch.float64)
17 gae_duplicate tensor(1.0420, dtype=torch.float64) tensor(-26.8376, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1580, dtype=torch.float64) delta_t tensor(1.3274, dtype=torch.float64)
16 gae_duplicate tensor(1.2174, dtype=torch.float64) tensor(-29.4705, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1126, dtype=torch.float64) delta_t tensor(0.9969, dtype=torch.float64)
15 gae_duplicate tensor(0.5501, dtype=torch.float64) tensor(-22.4490, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4826, dtype=torch.float64) delta_t tensor(0.6923, dtype=torch.float64)
14 gae_duplicate tensor(-0.2930, dtype=torch.float64) tensor(-15.8831, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6537, dtype=torch.float64) delta_t tensor(0.5958, dtype=torch.float64)
13 gae_duplicate tensor(-1.3533, dtype=torch.float64) tensor(-13.4030, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3360, dtype=torch.float64) delta_t tensor(0.5404, dtype=torch.float64)
12 gae_duplicate tensor(0.3432, dtype=torch.float64) tensor(-11.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.8422, dtype=torch.float64)
11 gae_duplicate tensor(0.8034, dtype=torch.float64) tensor(-18.2527, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0738, dtype=torch.float64) delta_t tensor(-0.0669, dtype=torch.float64)
10 gae_duplicate tensor(-0.3824, dtype=torch.float64) tensor(-0.3730, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.8710, dtype=torch.float64) delta_t tensor(0.9002, dtype=torch.float64)
9 gae_duplicate tensor(0.3559, dtype=torch.float64) tensor(-17.8381, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7742, dtype=torch.float64) delta_t tensor(-0.7741, dtype=torch.float64)
8 gae_duplicate tensor(-1.0503, dtype=torch.float64) tensor(13.0901, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.1113, dtype=torch.float64) delta_t tensor(0.1792, dtype=torch.float64)
7 gae_duplicate tensor(-1.0361, dtype=torch.float64) tensor(-1.9707, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8690, dtype=torch.float64) delta_t tensor(-0.8724, dtype=torch.float64)
6 gae_duplicate tensor(-1.0971, dtype=torch.float64) tensor(17.0683, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0864, dtype=torch.float64) delta_t tensor(-1.1651, dtype=torch.float64)
5 gae_duplicate tensor(-1.7710, dtype=torch.float64) tensor(25.8992, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2334, dtype=torch.float64) delta_t tensor(-0.4051, dtype=torch.float64)
4 gae_duplicate tensor(-1.1305, dtype=torch.float64) tensor(10.5237, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5815, dtype=torch.float64) delta_t tensor(-0.8229, dtype=torch.float64)
3 gae_duplicate tensor(-1.8028, dtype=torch.float64) tensor(17.3846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1432, dtype=torch.float64) delta_t tensor(0.0552, dtype=torch.float64)
2 gae_duplicate tensor(-0.4214, dtype=torch.float64) tensor(0.6115, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:6913.0087890625
value loss:173.43844604492188
entropies:354.7828369140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.826016902923584 seconds
19 rew tensor(1.2031, dtype=torch.float64) delta_t tensor(1.2059, dtype=torch.float64)
19 gae_duplicate tensor(1.1106, dtype=torch.float64) tensor(-23.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2292, dtype=torch.float64) delta_t tensor(1.3964, dtype=torch.float64)
18 gae_duplicate tensor(1.2800, dtype=torch.float64) tensor(-30.4838, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2194, dtype=torch.float64) delta_t tensor(1.2404, dtype=torch.float64)
17 gae_duplicate tensor(0.9934, dtype=torch.float64) tensor(-27.1044, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1110, dtype=torch.float64) delta_t tensor(1.2522, dtype=torch.float64)
16 gae_duplicate tensor(1.1371, dtype=torch.float64) tensor(-27.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0798, dtype=torch.float64) delta_t tensor(1.0745, dtype=torch.float64)
15 gae_duplicate tensor(0.7447, dtype=torch.float64) tensor(-24.1481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8944, dtype=torch.float64) delta_t tensor(0.9120, dtype=torch.float64)
14 gae_duplicate tensor(0.8068, dtype=torch.float64) tensor(-19.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5346, dtype=torch.float64) delta_t tensor(0.5442, dtype=torch.float64)
13 gae_duplicate tensor(-0.9089, dtype=torch.float64) tensor(-12.7345, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5152, dtype=torch.float64) delta_t tensor(0.6286, dtype=torch.float64)
12 gae_duplicate tensor(0.4075, dtype=torch.float64) tensor(-13.6844, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4791, dtype=torch.float64) delta_t tensor(0.4068, dtype=torch.float64)
11 gae_duplicate tensor(0.0534, dtype=torch.float64) tensor(-9.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2055, dtype=torch.float64) delta_t tensor(0.2196, dtype=torch.float64)
10 gae_duplicate tensor(-0.1104, dtype=torch.float64) tensor(-5.4004, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4048, dtype=torch.float64) delta_t tensor(0.3518, dtype=torch.float64)
9 gae_duplicate tensor(0.0065, dtype=torch.float64) tensor(-7.3877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4462, dtype=torch.float64) delta_t tensor(-0.4424, dtype=torch.float64)
8 gae_duplicate tensor(-0.9967, dtype=torch.float64) tensor(7.9486, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8476, dtype=torch.float64) delta_t tensor(-0.8054, dtype=torch.float64)
7 gae_duplicate tensor(-1.6208, dtype=torch.float64) tensor(16.7262, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6097, dtype=torch.float64) delta_t tensor(-0.5626, dtype=torch.float64)
6 gae_duplicate tensor(-1.2703, dtype=torch.float64) tensor(12.4232, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6688, dtype=torch.float64) delta_t tensor(-1.7304, dtype=torch.float64)
5 gae_duplicate tensor(-2.1234, dtype=torch.float64) tensor(35.4849, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1398, dtype=torch.float64) delta_t tensor(-0.0895, dtype=torch.float64)
4 gae_duplicate tensor(-0.7319, dtype=torch.float64) tensor(5.1821, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2688, dtype=torch.float64) delta_t tensor(-1.5026, dtype=torch.float64)
3 gae_duplicate tensor(-2.0176, dtype=torch.float64) tensor(29.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5216, dtype=torch.float64) delta_t tensor(0.4981, dtype=torch.float64)
2 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-6.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5330.32470703125
value loss:187.4092559814453
entropies:355.11688232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.965040922164917 seconds
19 rew tensor(1.2405, dtype=torch.float64) delta_t tensor(1.1914, dtype=torch.float64)
19 gae_duplicate tensor(0.9445, dtype=torch.float64) tensor(-23.7206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2039, dtype=torch.float64) delta_t tensor(1.1611, dtype=torch.float64)
18 gae_duplicate tensor(1.1058, dtype=torch.float64) tensor(-25.3236, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1758, dtype=torch.float64) delta_t tensor(1.1378, dtype=torch.float64)
17 gae_duplicate tensor(1.1657, dtype=torch.float64) tensor(-24.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1351, dtype=torch.float64) delta_t tensor(1.2802, dtype=torch.float64)
16 gae_duplicate tensor(1.0854, dtype=torch.float64) tensor(-27.3441, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0831, dtype=torch.float64) delta_t tensor(1.0471, dtype=torch.float64)
15 gae_duplicate tensor(0.7481, dtype=torch.float64) tensor(-23.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6717, dtype=torch.float64) delta_t tensor(0.6595, dtype=torch.float64)
14 gae_duplicate tensor(0.3468, dtype=torch.float64) tensor(-15.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2934, dtype=torch.float64) delta_t tensor(0.1855, dtype=torch.float64)
13 gae_duplicate tensor(-2.5529, dtype=torch.float64) tensor(-4.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0020, dtype=torch.float64) delta_t tensor(0.1901, dtype=torch.float64)
12 gae_duplicate tensor(-1.1049, dtype=torch.float64) tensor(-4.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5929, dtype=torch.float64) delta_t tensor(0.5880, dtype=torch.float64)
11 gae_duplicate tensor(0.4355, dtype=torch.float64) tensor(-12.0628, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0539, dtype=torch.float64) delta_t tensor(-0.0547, dtype=torch.float64)
10 gae_duplicate tensor(-0.4381, dtype=torch.float64) tensor(-0.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5610, dtype=torch.float64) delta_t tensor(0.4728, dtype=torch.float64)
9 gae_duplicate tensor(0.1337, dtype=torch.float64) tensor(-9.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6719, dtype=torch.float64) delta_t tensor(-0.6847, dtype=torch.float64)
8 gae_duplicate tensor(-0.9549, dtype=torch.float64) tensor(12.4006, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1749, dtype=torch.float64) delta_t tensor(-0.1270, dtype=torch.float64)
7 gae_duplicate tensor(-1.3212, dtype=torch.float64) tensor(3.6907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8209, dtype=torch.float64) delta_t tensor(-0.8574, dtype=torch.float64)
6 gae_duplicate tensor(-1.2928, dtype=torch.float64) tensor(17.1439, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3341, dtype=torch.float64) delta_t tensor(-1.4360, dtype=torch.float64)
5 gae_duplicate tensor(-2.2448, dtype=torch.float64) tensor(30.1963, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3565, dtype=torch.float64) delta_t tensor(-0.5512, dtype=torch.float64)
4 gae_duplicate tensor(-1.2274, dtype=torch.float64) tensor(13.9599, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6450, dtype=torch.float64) delta_t tensor(-0.8896, dtype=torch.float64)
3 gae_duplicate tensor(-1.8064, dtype=torch.float64) tensor(18.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0132, dtype=torch.float64) delta_t tensor(-0.0962, dtype=torch.float64)
2 gae_duplicate tensor(-0.7429, dtype=torch.float64) tensor(3.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3716.23486328125
value loss:165.4132080078125
entropies:355.2667541503906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.313432931900024 seconds
19 rew tensor(1.2218, dtype=torch.float64) delta_t tensor(1.1423, dtype=torch.float64)
19 gae_duplicate tensor(1.0621, dtype=torch.float64) tensor(-22.9293, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2096, dtype=torch.float64) delta_t tensor(1.1483, dtype=torch.float64)
18 gae_duplicate tensor(1.1373, dtype=torch.float64) tensor(-24.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0927, dtype=torch.float64) delta_t tensor(0.9663, dtype=torch.float64)
17 gae_duplicate tensor(0.9293, dtype=torch.float64) tensor(-21.0628, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0446, dtype=torch.float64) delta_t tensor(1.2071, dtype=torch.float64)
16 gae_duplicate tensor(1.1387, dtype=torch.float64) tensor(-26.0584, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7744, dtype=torch.float64) delta_t tensor(0.4382, dtype=torch.float64)
15 gae_duplicate tensor(-0.6161, dtype=torch.float64) tensor(-11.3749, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7659, dtype=torch.float64) delta_t tensor(0.8594, dtype=torch.float64)
14 gae_duplicate tensor(0.7757, dtype=torch.float64) tensor(-17.9019, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8737, dtype=torch.float64) delta_t tensor(0.5983, dtype=torch.float64)
13 gae_duplicate tensor(0.3109, dtype=torch.float64) tensor(-13.9427, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2803, dtype=torch.float64) delta_t tensor(0.3716, dtype=torch.float64)
12 gae_duplicate tensor(0.2491, dtype=torch.float64) tensor(-8.6746, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6935, dtype=torch.float64) delta_t tensor(0.6565, dtype=torch.float64)
11 gae_duplicate tensor(0.4377, dtype=torch.float64) tensor(-14.0958, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1290, dtype=torch.float64) delta_t tensor(-0.0991, dtype=torch.float64)
10 gae_duplicate tensor(-0.3275, dtype=torch.float64) tensor(0.6095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3642, dtype=torch.float64) delta_t tensor(0.3084, dtype=torch.float64)
9 gae_duplicate tensor(0.0959, dtype=torch.float64) tensor(-5.9276, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5356, dtype=torch.float64) delta_t tensor(-0.5611, dtype=torch.float64)
8 gae_duplicate tensor(-0.7464, dtype=torch.float64) tensor(10.3207, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9135, dtype=torch.float64) delta_t tensor(-0.8642, dtype=torch.float64)
7 gae_duplicate tensor(-2.7834, dtype=torch.float64) tensor(17.8107, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6646, dtype=torch.float64) delta_t tensor(-0.6725, dtype=torch.float64)
6 gae_duplicate tensor(-1.2266, dtype=torch.float64) tensor(15.0711, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6188, dtype=torch.float64) delta_t tensor(-1.7122, dtype=torch.float64)
5 gae_duplicate tensor(-2.2988, dtype=torch.float64) tensor(36.5045, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0072, dtype=torch.float64) delta_t tensor(-0.2403, dtype=torch.float64)
4 gae_duplicate tensor(-0.8356, dtype=torch.float64) tensor(8.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1216, dtype=torch.float64) delta_t tensor(-1.3734, dtype=torch.float64)
3 gae_duplicate tensor(-2.1582, dtype=torch.float64) tensor(27.7447, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3796, dtype=torch.float64) delta_t tensor(0.3038, dtype=torch.float64)
2 gae_duplicate tensor(-0.0914, dtype=torch.float64) tensor(-3.0444, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2788.28271484375
value loss:157.4759521484375
entropies:355.2140808105469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.7419)
ToM Target loss= tensor(3457.0308)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.085047960281372 seconds
19 rew tensor(1.2190, dtype=torch.float64) delta_t tensor(1.1423, dtype=torch.float64)
19 gae_duplicate tensor(1.0706, dtype=torch.float64) tensor(-22.3616, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1862, dtype=torch.float64) delta_t tensor(1.0451, dtype=torch.float64)
18 gae_duplicate tensor(0.9428, dtype=torch.float64) tensor(-23.0940, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.2041, dtype=torch.float64) delta_t tensor(1.0856, dtype=torch.float64)
17 gae_duplicate tensor(0.9681, dtype=torch.float64) tensor(-24.4708, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0497, dtype=torch.float64) delta_t tensor(1.0442, dtype=torch.float64)
16 gae_duplicate tensor(0.9892, dtype=torch.float64) tensor(-22.6130, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0502, dtype=torch.float64) delta_t tensor(0.7185, dtype=torch.float64)
15 gae_duplicate tensor(0.7457, dtype=torch.float64) tensor(-16.4173, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8266, dtype=torch.float64) delta_t tensor(0.6780, dtype=torch.float64)
14 gae_duplicate tensor(0.5978, dtype=torch.float64) tensor(-15.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8101, dtype=torch.float64) delta_t tensor(0.5828, dtype=torch.float64)
13 gae_duplicate tensor(0.4276, dtype=torch.float64) tensor(-13.0150, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1448, dtype=torch.float64) delta_t tensor(0.1025, dtype=torch.float64)
12 gae_duplicate tensor(-1.1148, dtype=torch.float64) tensor(-3.3231, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4165, dtype=torch.float64) delta_t tensor(0.3274, dtype=torch.float64)
11 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(-6.6938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1237, dtype=torch.float64) delta_t tensor(0.1938, dtype=torch.float64)
10 gae_duplicate tensor(-0.1954, dtype=torch.float64) tensor(-4.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2975, dtype=torch.float64) delta_t tensor(0.2262, dtype=torch.float64)
9 gae_duplicate tensor(0.1327, dtype=torch.float64) tensor(-4.9357, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6477, dtype=torch.float64) delta_t tensor(-0.6436, dtype=torch.float64)
8 gae_duplicate tensor(-1.0455, dtype=torch.float64) tensor(12.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7950, dtype=torch.float64) delta_t tensor(-1.7709, dtype=torch.float64)
7 gae_duplicate tensor(-5.5311, dtype=torch.float64) tensor(35.5482, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9203, dtype=torch.float64) delta_t tensor(-0.9192, dtype=torch.float64)
6 gae_duplicate tensor(-1.8992, dtype=torch.float64) tensor(20.5843, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5941, dtype=torch.float64) delta_t tensor(-1.6842, dtype=torch.float64)
5 gae_duplicate tensor(-2.2551, dtype=torch.float64) tensor(34.8883, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0422, dtype=torch.float64) delta_t tensor(-0.1884, dtype=torch.float64)
4 gae_duplicate tensor(-1.0712, dtype=torch.float64) tensor(7.7778, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4074, dtype=torch.float64) delta_t tensor(-1.5388, dtype=torch.float64)
3 gae_duplicate tensor(-2.5329, dtype=torch.float64) tensor(30.7670, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3900, dtype=torch.float64) delta_t tensor(0.2772, dtype=torch.float64)
2 gae_duplicate tensor(-0.6971, dtype=torch.float64) tensor(-2.3518, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:835.8817138671875
value loss:222.9032745361328
entropies:354.7052307128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.074965953826904 seconds
19 rew tensor(1.1528, dtype=torch.float64) delta_t tensor(1.0732, dtype=torch.float64)
19 gae_duplicate tensor(1.0154, dtype=torch.float64) tensor(-21.6432, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1690, dtype=torch.float64) delta_t tensor(1.0916, dtype=torch.float64)
18 gae_duplicate tensor(0.9838, dtype=torch.float64) tensor(-23.7312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0541, dtype=torch.float64) delta_t tensor(0.9732, dtype=torch.float64)
17 gae_duplicate tensor(0.8335, dtype=torch.float64) tensor(-20.4103, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9279, dtype=torch.float64) delta_t tensor(0.8363, dtype=torch.float64)
16 gae_duplicate tensor(0.6667, dtype=torch.float64) tensor(-19.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8738, dtype=torch.float64) delta_t tensor(0.6373, dtype=torch.float64)
15 gae_duplicate tensor(0.5475, dtype=torch.float64) tensor(-13.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7441, dtype=torch.float64) delta_t tensor(0.7088, dtype=torch.float64)
14 gae_duplicate tensor(0.5832, dtype=torch.float64) tensor(-15.0259, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7918, dtype=torch.float64) delta_t tensor(0.6660, dtype=torch.float64)
13 gae_duplicate tensor(0.2604, dtype=torch.float64) tensor(-14.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3961, dtype=torch.float64) delta_t tensor(0.4222, dtype=torch.float64)
12 gae_duplicate tensor(0.2045, dtype=torch.float64) tensor(-9.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4828, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
11 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(-11.0153, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0257, dtype=torch.float64) delta_t tensor(-0.0958, dtype=torch.float64)
10 gae_duplicate tensor(-0.2808, dtype=torch.float64) tensor(0.8972, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1646, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
9 gae_duplicate tensor(-0.4156, dtype=torch.float64) tensor(-1.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4295, dtype=torch.float64) delta_t tensor(-0.4216, dtype=torch.float64)
8 gae_duplicate tensor(-0.7145, dtype=torch.float64) tensor(7.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7801, dtype=torch.float64) delta_t tensor(-0.7216, dtype=torch.float64)
7 gae_duplicate tensor(-1.8082, dtype=torch.float64) tensor(15.8684, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5442, dtype=torch.float64) delta_t tensor(-0.5387, dtype=torch.float64)
6 gae_duplicate tensor(-0.9164, dtype=torch.float64) tensor(11.5781, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6886, dtype=torch.float64) delta_t tensor(-1.7463, dtype=torch.float64)
5 gae_duplicate tensor(-2.0720, dtype=torch.float64) tensor(33.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0184, dtype=torch.float64) delta_t tensor(-0.2309, dtype=torch.float64)
4 gae_duplicate tensor(-0.7969, dtype=torch.float64) tensor(8.0200, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0622, dtype=torch.float64) delta_t tensor(-1.2476, dtype=torch.float64)
3 gae_duplicate tensor(-1.8801, dtype=torch.float64) tensor(23.9730, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3697, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
2 gae_duplicate tensor(-0.2215, dtype=torch.float64) tensor(-3.1559, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:2690.65087890625
value loss:132.91448974609375
entropies:353.6884765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.202677011489868 seconds
19 rew tensor(1.2174, dtype=torch.float64) delta_t tensor(1.0746, dtype=torch.float64)
19 gae_duplicate tensor(0.9977, dtype=torch.float64) tensor(-21.4855, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2265, dtype=torch.float64) delta_t tensor(1.0786, dtype=torch.float64)
18 gae_duplicate tensor(1.0713, dtype=torch.float64) tensor(-22.9631, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1882, dtype=torch.float64) delta_t tensor(0.9714, dtype=torch.float64)
17 gae_duplicate tensor(0.7580, dtype=torch.float64) tensor(-20.2988, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1862, dtype=torch.float64) delta_t tensor(0.9794, dtype=torch.float64)
16 gae_duplicate tensor(0.6516, dtype=torch.float64) tensor(-22.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0511, dtype=torch.float64) delta_t tensor(0.7634, dtype=torch.float64)
15 gae_duplicate tensor(0.4853, dtype=torch.float64) tensor(-16.5718, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9186, dtype=torch.float64) delta_t tensor(0.7889, dtype=torch.float64)
14 gae_duplicate tensor(0.5664, dtype=torch.float64) tensor(-17.1386, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.3409, dtype=torch.float64) delta_t tensor(-0.5381, dtype=torch.float64)
13 gae_duplicate tensor(-3.5651, dtype=torch.float64) tensor(8.3262, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0489, dtype=torch.float64) delta_t tensor(0.0154, dtype=torch.float64)
12 gae_duplicate tensor(-1.0298, dtype=torch.float64) tensor(0.3197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5247, dtype=torch.float64) delta_t tensor(0.3823, dtype=torch.float64)
11 gae_duplicate tensor(0.0647, dtype=torch.float64) tensor(-7.8825, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0262, dtype=torch.float64) delta_t tensor(-0.0639, dtype=torch.float64)
10 gae_duplicate tensor(-0.6661, dtype=torch.float64) tensor(0.1463, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6849, dtype=torch.float64) delta_t tensor(0.5604, dtype=torch.float64)
9 gae_duplicate tensor(0.1697, dtype=torch.float64) tensor(-11.1565, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7095, dtype=torch.float64) delta_t tensor(-0.7515, dtype=torch.float64)
8 gae_duplicate tensor(-0.9988, dtype=torch.float64) tensor(13.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6022, dtype=torch.float64) delta_t tensor(-0.5722, dtype=torch.float64)
7 gae_duplicate tensor(-1.4041, dtype=torch.float64) tensor(12.4836, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7906, dtype=torch.float64) delta_t tensor(-0.7947, dtype=torch.float64)
6 gae_duplicate tensor(-1.1946, dtype=torch.float64) tensor(16.8516, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5180, dtype=torch.float64) delta_t tensor(-1.5934, dtype=torch.float64)
5 gae_duplicate tensor(-2.1633, dtype=torch.float64) tensor(34.0215, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0422, dtype=torch.float64) delta_t tensor(-0.2344, dtype=torch.float64)
4 gae_duplicate tensor(-0.8220, dtype=torch.float64) tensor(7.9614, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1142, dtype=torch.float64) delta_t tensor(-1.3114, dtype=torch.float64)
3 gae_duplicate tensor(-2.2238, dtype=torch.float64) tensor(26.6977, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3057, dtype=torch.float64) delta_t tensor(0.2476, dtype=torch.float64)
2 gae_duplicate tensor(-0.4345, dtype=torch.float64) tensor(-2.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1043.7293701171875
value loss:160.8911895751953
entropies:353.30230712890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9505698680877686 seconds
19 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(0.7993, dtype=torch.float64)
19 gae_duplicate tensor(-0.4593, dtype=torch.float64) tensor(-16.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2177, dtype=torch.float64) delta_t tensor(1.0366, dtype=torch.float64)
18 gae_duplicate tensor(0.7431, dtype=torch.float64) tensor(-21.5497, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1131, dtype=torch.float64) delta_t tensor(0.8882, dtype=torch.float64)
17 gae_duplicate tensor(0.5630, dtype=torch.float64) tensor(-19.6093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0541, dtype=torch.float64) delta_t tensor(0.8222, dtype=torch.float64)
16 gae_duplicate tensor(0.6271, dtype=torch.float64) tensor(-17.0730, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9672, dtype=torch.float64) delta_t tensor(0.6193, dtype=torch.float64)
15 gae_duplicate tensor(0.5075, dtype=torch.float64) tensor(-13.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0313, dtype=torch.float64) delta_t tensor(-0.0342, dtype=torch.float64)
14 gae_duplicate tensor(-1.0965, dtype=torch.float64) tensor(-0.1361, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6586, dtype=torch.float64) delta_t tensor(0.4181, dtype=torch.float64)
13 gae_duplicate tensor(0.0853, dtype=torch.float64) tensor(-8.0260, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.4435, dtype=torch.float64)
12 gae_duplicate tensor(0.1735, dtype=torch.float64) tensor(-10.1522, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.3125, dtype=torch.float64)
11 gae_duplicate tensor(0.0242, dtype=torch.float64) tensor(-6.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1344, dtype=torch.float64) delta_t tensor(-0.2320, dtype=torch.float64)
10 gae_duplicate tensor(-0.5541, dtype=torch.float64) tensor(3.9747, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3751, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
9 gae_duplicate tensor(0.0890, dtype=torch.float64) tensor(-5.8105, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6042, dtype=torch.float64) delta_t tensor(-0.6258, dtype=torch.float64)
8 gae_duplicate tensor(-0.8452, dtype=torch.float64) tensor(11.7986, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0855, dtype=torch.float64) delta_t tensor(-1.0293, dtype=torch.float64)
7 gae_duplicate tensor(-3.3368, dtype=torch.float64) tensor(22.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7267, dtype=torch.float64) delta_t tensor(-0.7109, dtype=torch.float64)
6 gae_duplicate tensor(-1.3559, dtype=torch.float64) tensor(16.2098, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6704, dtype=torch.float64) delta_t tensor(-1.7558, dtype=torch.float64)
5 gae_duplicate tensor(-2.2250, dtype=torch.float64) tensor(34.8387, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.1558, dtype=torch.float64)
4 gae_duplicate tensor(-0.7054, dtype=torch.float64) tensor(6.5044, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3050, dtype=torch.float64) delta_t tensor(-1.4445, dtype=torch.float64)
3 gae_duplicate tensor(-2.3988, dtype=torch.float64) tensor(28.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3498, dtype=torch.float64) delta_t tensor(0.2176, dtype=torch.float64)
2 gae_duplicate tensor(-0.3504, dtype=torch.float64) tensor(-1.3957, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-273.613037109375
value loss:147.5175323486328
entropies:353.07281494140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.207683801651001 seconds
19 rew tensor(1.1891, dtype=torch.float64) delta_t tensor(1.0536, dtype=torch.float64)
19 gae_duplicate tensor(0.8292, dtype=torch.float64) tensor(-21.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1965, dtype=torch.float64) delta_t tensor(1.0562, dtype=torch.float64)
18 gae_duplicate tensor(0.9352, dtype=torch.float64) tensor(-21.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0978, dtype=torch.float64) delta_t tensor(0.8395, dtype=torch.float64)
17 gae_duplicate tensor(0.6571, dtype=torch.float64) tensor(-18.0511, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9134, dtype=torch.float64) delta_t tensor(0.9209, dtype=torch.float64)
16 gae_duplicate tensor(0.8418, dtype=torch.float64) tensor(-19.4637, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9996, dtype=torch.float64) delta_t tensor(0.6088, dtype=torch.float64)
15 gae_duplicate tensor(0.5057, dtype=torch.float64) tensor(-13.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7096, dtype=torch.float64) delta_t tensor(0.6105, dtype=torch.float64)
14 gae_duplicate tensor(0.4000, dtype=torch.float64) tensor(-13.7093, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8857, dtype=torch.float64) delta_t tensor(0.5442, dtype=torch.float64)
13 gae_duplicate tensor(0.4056, dtype=torch.float64) tensor(-11.7561, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2762, dtype=torch.float64) delta_t tensor(0.2567, dtype=torch.float64)
12 gae_duplicate tensor(0.1875, dtype=torch.float64) tensor(-6.3121, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0423, dtype=torch.float64) delta_t tensor(-0.1605, dtype=torch.float64)
11 gae_duplicate tensor(-3.1785, dtype=torch.float64) tensor(1.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2275, dtype=torch.float64) delta_t tensor(-0.3153, dtype=torch.float64)
10 gae_duplicate tensor(-1.8899, dtype=torch.float64) tensor(7.0089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2509, dtype=torch.float64) delta_t tensor(0.1501, dtype=torch.float64)
9 gae_duplicate tensor(-0.1207, dtype=torch.float64) tensor(-2.3719, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6339, dtype=torch.float64) delta_t tensor(-0.6201, dtype=torch.float64)
8 gae_duplicate tensor(-0.9591, dtype=torch.float64) tensor(12.3322, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7775, dtype=torch.float64) delta_t tensor(-0.7171, dtype=torch.float64)
7 gae_duplicate tensor(-3.7792, dtype=torch.float64) tensor(14.5115, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7373, dtype=torch.float64) delta_t tensor(-0.7538, dtype=torch.float64)
6 gae_duplicate tensor(-1.1347, dtype=torch.float64) tensor(16.2598, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5073, dtype=torch.float64) delta_t tensor(-1.5540, dtype=torch.float64)
5 gae_duplicate tensor(-2.4079, dtype=torch.float64) tensor(32.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0815, dtype=torch.float64) delta_t tensor(-0.2543, dtype=torch.float64)
4 gae_duplicate tensor(-0.7016, dtype=torch.float64) tensor(7.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0247, dtype=torch.float64) delta_t tensor(-1.1792, dtype=torch.float64)
3 gae_duplicate tensor(-2.5754, dtype=torch.float64) tensor(24.4918, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2896, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
2 gae_duplicate tensor(-0.3253, dtype=torch.float64) tensor(-2.2030, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:651.2052612304688
value loss:157.64280700683594
entropies:352.8282470703125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.6519)
ToM Target loss= tensor(2714.8887)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.157836675643921 seconds
19 rew tensor(1.2043, dtype=torch.float64) delta_t tensor(1.0431, dtype=torch.float64)
19 gae_duplicate tensor(0.8541, dtype=torch.float64) tensor(-18.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1989, dtype=torch.float64) delta_t tensor(1.0605, dtype=torch.float64)
18 gae_duplicate tensor(0.8953, dtype=torch.float64) tensor(-22.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0975, dtype=torch.float64) delta_t tensor(0.9252, dtype=torch.float64)
17 gae_duplicate tensor(0.8778, dtype=torch.float64) tensor(-19.6135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0487, dtype=torch.float64) delta_t tensor(0.7589, dtype=torch.float64)
16 gae_duplicate tensor(0.4955, dtype=torch.float64) tensor(-16.5323, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9318, dtype=torch.float64) delta_t tensor(0.5429, dtype=torch.float64)
15 gae_duplicate tensor(0.4648, dtype=torch.float64) tensor(-12.2963, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4800, dtype=torch.float64) delta_t tensor(0.3526, dtype=torch.float64)
14 gae_duplicate tensor(-0.6711, dtype=torch.float64) tensor(-8.6987, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7209, dtype=torch.float64) delta_t tensor(0.4711, dtype=torch.float64)
13 gae_duplicate tensor(0.3327, dtype=torch.float64) tensor(-9.9684, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0315, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
12 gae_duplicate tensor(-1.2872, dtype=torch.float64) tensor(-0.7736, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1561, dtype=torch.float64) delta_t tensor(-0.0108, dtype=torch.float64)
11 gae_duplicate tensor(-2.0627, dtype=torch.float64) tensor(1.2529, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0656, dtype=torch.float64) delta_t tensor(-0.1204, dtype=torch.float64)
10 gae_duplicate tensor(-0.4334, dtype=torch.float64) tensor(2.3566, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3810, dtype=torch.float64) delta_t tensor(0.3754, dtype=torch.float64)
9 gae_duplicate tensor(0.0788, dtype=torch.float64) tensor(-6.9734, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6112, dtype=torch.float64) delta_t tensor(-0.6152, dtype=torch.float64)
8 gae_duplicate tensor(-0.9580, dtype=torch.float64) tensor(11.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6184, dtype=torch.float64) delta_t tensor(-0.5628, dtype=torch.float64)
7 gae_duplicate tensor(-1.5082, dtype=torch.float64) tensor(11.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7524, dtype=torch.float64) delta_t tensor(-0.7110, dtype=torch.float64)
6 gae_duplicate tensor(-1.2572, dtype=torch.float64) tensor(15.3796, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5352, dtype=torch.float64) delta_t tensor(-1.5961, dtype=torch.float64)
5 gae_duplicate tensor(-1.9894, dtype=torch.float64) tensor(32.8158, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0435, dtype=torch.float64) delta_t tensor(-0.2186, dtype=torch.float64)
4 gae_duplicate tensor(-1.1694, dtype=torch.float64) tensor(8.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1126, dtype=torch.float64) delta_t tensor(-1.2389, dtype=torch.float64)
3 gae_duplicate tensor(-2.0856, dtype=torch.float64) tensor(25.5241, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3097, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
2 gae_duplicate tensor(-0.8145, dtype=torch.float64) tensor(-2.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:481.9477233886719
value loss:131.8357696533203
entropies:352.7830505371094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.196087121963501 seconds
19 rew tensor(1.0947, dtype=torch.float64) delta_t tensor(0.9495, dtype=torch.float64)
19 gae_duplicate tensor(0.8056, dtype=torch.float64) tensor(-18.6671, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0996, dtype=torch.float64) delta_t tensor(0.9052, dtype=torch.float64)
18 gae_duplicate tensor(0.5991, dtype=torch.float64) tensor(-19.7505, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1064, dtype=torch.float64) delta_t tensor(0.9045, dtype=torch.float64)
17 gae_duplicate tensor(0.7749, dtype=torch.float64) tensor(-19.6388, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9784, dtype=torch.float64) delta_t tensor(0.7999, dtype=torch.float64)
16 gae_duplicate tensor(0.7472, dtype=torch.float64) tensor(-17.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9390, dtype=torch.float64) delta_t tensor(0.6783, dtype=torch.float64)
15 gae_duplicate tensor(0.5031, dtype=torch.float64) tensor(-14.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7189, dtype=torch.float64) delta_t tensor(0.3880, dtype=torch.float64)
14 gae_duplicate tensor(0.1811, dtype=torch.float64) tensor(-9.5550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6893, dtype=torch.float64) delta_t tensor(0.4625, dtype=torch.float64)
13 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-10.1173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3794, dtype=torch.float64) delta_t tensor(0.2948, dtype=torch.float64)
12 gae_duplicate tensor(0.1477, dtype=torch.float64) tensor(-6.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
11 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-3.2260, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0102, dtype=torch.float64) delta_t tensor(-0.1246, dtype=torch.float64)
10 gae_duplicate tensor(-0.3778, dtype=torch.float64) tensor(1.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2526, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
9 gae_duplicate tensor(-0.3072, dtype=torch.float64) tensor(-3.2783, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5507, dtype=torch.float64) delta_t tensor(-0.5057, dtype=torch.float64)
8 gae_duplicate tensor(-1.0067, dtype=torch.float64) tensor(9.3345, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7357, dtype=torch.float64) delta_t tensor(-0.6483, dtype=torch.float64)
7 gae_duplicate tensor(-1.9840, dtype=torch.float64) tensor(14.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6474, dtype=torch.float64) delta_t tensor(-0.6104, dtype=torch.float64)
6 gae_duplicate tensor(-1.0630, dtype=torch.float64) tensor(13.8280, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5671, dtype=torch.float64) delta_t tensor(-1.5898, dtype=torch.float64)
5 gae_duplicate tensor(-2.3159, dtype=torch.float64) tensor(31.7628, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0414, dtype=torch.float64) delta_t tensor(-0.1360, dtype=torch.float64)
4 gae_duplicate tensor(-0.8956, dtype=torch.float64) tensor(6.1503, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0834, dtype=torch.float64) delta_t tensor(-1.2279, dtype=torch.float64)
3 gae_duplicate tensor(-2.2905, dtype=torch.float64) tensor(26.0522, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4238, dtype=torch.float64) delta_t tensor(0.4123, dtype=torch.float64)
2 gae_duplicate tensor(-0.2962, dtype=torch.float64) tensor(-5.1703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1207.46240234375
value loss:116.50279998779297
entropies:352.2685852050781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052438020706177 seconds
19 rew tensor(1.1617, dtype=torch.float64) delta_t tensor(0.9690, dtype=torch.float64)
19 gae_duplicate tensor(0.8140, dtype=torch.float64) tensor(-18.1586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2066, dtype=torch.float64) delta_t tensor(1.0136, dtype=torch.float64)
18 gae_duplicate tensor(0.9350, dtype=torch.float64) tensor(-21.0158, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0771, dtype=torch.float64) delta_t tensor(0.7857, dtype=torch.float64)
17 gae_duplicate tensor(0.6280, dtype=torch.float64) tensor(-18.0509, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9697, dtype=torch.float64) delta_t tensor(0.7683, dtype=torch.float64)
16 gae_duplicate tensor(0.4135, dtype=torch.float64) tensor(-17.4071, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9609, dtype=torch.float64) delta_t tensor(0.5591, dtype=torch.float64)
15 gae_duplicate tensor(0.3675, dtype=torch.float64) tensor(-12.6737, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2301, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
14 gae_duplicate tensor(-1.9066, dtype=torch.float64) tensor(-3.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8790, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
13 gae_duplicate tensor(0.2761, dtype=torch.float64) tensor(-9.9977, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2036, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
12 gae_duplicate tensor(0.1290, dtype=torch.float64) tensor(-4.7003, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6715, dtype=torch.float64) delta_t tensor(0.3219, dtype=torch.float64)
11 gae_duplicate tensor(0.1428, dtype=torch.float64) tensor(-6.6502, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1733, dtype=torch.float64) delta_t tensor(-0.2597, dtype=torch.float64)
10 gae_duplicate tensor(-0.5327, dtype=torch.float64) tensor(4.2990, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.2959, dtype=torch.float64)
9 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-5.3149, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6042, dtype=torch.float64) delta_t tensor(-0.5885, dtype=torch.float64)
8 gae_duplicate tensor(-0.7653, dtype=torch.float64) tensor(10.8991, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7186, dtype=torch.float64) delta_t tensor(-0.6696, dtype=torch.float64)
7 gae_duplicate tensor(-3.7821, dtype=torch.float64) tensor(13.1819, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8879, dtype=torch.float64) delta_t tensor(-0.8776, dtype=torch.float64)
6 gae_duplicate tensor(-1.5054, dtype=torch.float64) tensor(17.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2354, dtype=torch.float64) delta_t tensor(-1.2683, dtype=torch.float64)
5 gae_duplicate tensor(-1.9068, dtype=torch.float64) tensor(27.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2614, dtype=torch.float64) delta_t tensor(-0.3711, dtype=torch.float64)
4 gae_duplicate tensor(-0.9769, dtype=torch.float64) tensor(9.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6750, dtype=torch.float64) delta_t tensor(-0.8189, dtype=torch.float64)
3 gae_duplicate tensor(-1.8981, dtype=torch.float64) tensor(16.6405, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1241, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
2 gae_duplicate tensor(-0.5181, dtype=torch.float64) tensor(-0.4151, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:885.7409057617188
value loss:120.73851776123047
entropies:351.5289001464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.987807989120483 seconds
19 rew tensor(1.2157, dtype=torch.float64) delta_t tensor(0.9983, dtype=torch.float64)
19 gae_duplicate tensor(0.8627, dtype=torch.float64) tensor(-18.8691, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2469, dtype=torch.float64) delta_t tensor(1.0419, dtype=torch.float64)
18 gae_duplicate tensor(1.0416, dtype=torch.float64) tensor(-22.0042, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1473, dtype=torch.float64) delta_t tensor(0.9025, dtype=torch.float64)
17 gae_duplicate tensor(0.8107, dtype=torch.float64) tensor(-19.1728, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0702, dtype=torch.float64) delta_t tensor(0.8173, dtype=torch.float64)
16 gae_duplicate tensor(0.6930, dtype=torch.float64) tensor(-18.7002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0494, dtype=torch.float64) delta_t tensor(0.6531, dtype=torch.float64)
15 gae_duplicate tensor(0.5112, dtype=torch.float64) tensor(-14.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5188, dtype=torch.float64) delta_t tensor(0.3527, dtype=torch.float64)
14 gae_duplicate tensor(-0.7276, dtype=torch.float64) tensor(-8.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1837, dtype=torch.float64) delta_t tensor(-0.1799, dtype=torch.float64)
13 gae_duplicate tensor(-2.8043, dtype=torch.float64) tensor(4.1589, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2091, dtype=torch.float64) delta_t tensor(-0.2130, dtype=torch.float64)
12 gae_duplicate tensor(-3.0794, dtype=torch.float64) tensor(3.4946, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0891, dtype=torch.float64) delta_t tensor(-0.1939, dtype=torch.float64)
11 gae_duplicate tensor(-2.4939, dtype=torch.float64) tensor(5.7563, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4594, dtype=torch.float64) delta_t tensor(-0.5535, dtype=torch.float64)
10 gae_duplicate tensor(-2.6852, dtype=torch.float64) tensor(11.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
9 gae_duplicate tensor(-1.9780, dtype=torch.float64) tensor(-3.7462, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8346, dtype=torch.float64) delta_t tensor(-0.8329, dtype=torch.float64)
8 gae_duplicate tensor(-1.0790, dtype=torch.float64) tensor(16.5899, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0041, dtype=torch.float64) delta_t tensor(0.0562, dtype=torch.float64)
7 gae_duplicate tensor(-0.9226, dtype=torch.float64) tensor(0.5566, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9409, dtype=torch.float64) delta_t tensor(-0.9713, dtype=torch.float64)
6 gae_duplicate tensor(-1.1237, dtype=torch.float64) tensor(18.3857, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2008, dtype=torch.float64) delta_t tensor(-1.1779, dtype=torch.float64)
5 gae_duplicate tensor(-1.9843, dtype=torch.float64) tensor(23.6427, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4106, dtype=torch.float64) delta_t tensor(-0.5291, dtype=torch.float64)
4 gae_duplicate tensor(-0.8899, dtype=torch.float64) tensor(12.3818, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5804, dtype=torch.float64) delta_t tensor(-0.7027, dtype=torch.float64)
3 gae_duplicate tensor(-1.6220, dtype=torch.float64) tensor(14.4846, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0386, dtype=torch.float64) delta_t tensor(-0.0687, dtype=torch.float64)
2 gae_duplicate tensor(-0.3880, dtype=torch.float64) tensor(2.8703, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-550.885009765625
value loss:154.35366821289062
entropies:350.94696044921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1317079067230225 seconds
19 rew tensor(1.2069, dtype=torch.float64) delta_t tensor(0.9998, dtype=torch.float64)
19 gae_duplicate tensor(0.7666, dtype=torch.float64) tensor(-19.5951, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2116, dtype=torch.float64) delta_t tensor(1.0055, dtype=torch.float64)
18 gae_duplicate tensor(0.9555, dtype=torch.float64) tensor(-22.5924, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1346, dtype=torch.float64) delta_t tensor(0.9200, dtype=torch.float64)
17 gae_duplicate tensor(0.7153, dtype=torch.float64) tensor(-20.2203, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(0.7041, dtype=torch.float64)
16 gae_duplicate tensor(0.6302, dtype=torch.float64) tensor(-14.9694, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9707, dtype=torch.float64) delta_t tensor(0.5362, dtype=torch.float64)
15 gae_duplicate tensor(0.4616, dtype=torch.float64) tensor(-12.4483, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1161, dtype=torch.float64) delta_t tensor(-0.1360, dtype=torch.float64)
14 gae_duplicate tensor(-1.4838, dtype=torch.float64) tensor(1.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7646, dtype=torch.float64) delta_t tensor(0.4069, dtype=torch.float64)
13 gae_duplicate tensor(0.1399, dtype=torch.float64) tensor(-8.2816, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0733, dtype=torch.float64) delta_t tensor(0.0202, dtype=torch.float64)
12 gae_duplicate tensor(-0.9809, dtype=torch.float64) tensor(-1.0746, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5068, dtype=torch.float64) delta_t tensor(0.1816, dtype=torch.float64)
11 gae_duplicate tensor(0.1114, dtype=torch.float64) tensor(-3.8576, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0113, dtype=torch.float64) delta_t tensor(-0.1334, dtype=torch.float64)
10 gae_duplicate tensor(-0.3667, dtype=torch.float64) tensor(2.0932, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5107, dtype=torch.float64) delta_t tensor(0.4137, dtype=torch.float64)
9 gae_duplicate tensor(0.0966, dtype=torch.float64) tensor(-7.4464, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6500, dtype=torch.float64) delta_t tensor(-0.6273, dtype=torch.float64)
8 gae_duplicate tensor(-1.0055, dtype=torch.float64) tensor(11.5824, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3904, dtype=torch.float64) delta_t tensor(-0.2731, dtype=torch.float64)
7 gae_duplicate tensor(-1.0328, dtype=torch.float64) tensor(6.6804, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7050, dtype=torch.float64) delta_t tensor(-0.6791, dtype=torch.float64)
6 gae_duplicate tensor(-1.0684, dtype=torch.float64) tensor(13.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4211, dtype=torch.float64) delta_t tensor(-1.4272, dtype=torch.float64)
5 gae_duplicate tensor(-2.0531, dtype=torch.float64) tensor(30.2154, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1758, dtype=torch.float64) delta_t tensor(-0.2965, dtype=torch.float64)
4 gae_duplicate tensor(-0.9449, dtype=torch.float64) tensor(9.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8297, dtype=torch.float64) delta_t tensor(-0.9607, dtype=torch.float64)
3 gae_duplicate tensor(-1.4370, dtype=torch.float64) tensor(20.5421, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1797, dtype=torch.float64) delta_t tensor(0.1622, dtype=torch.float64)
2 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-1.2112, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:780.3781127929688
value loss:101.46185302734375
entropies:350.5688171386719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3932.5042)
ToM Target loss= tensor(2505.5615)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9584221839904785 seconds
19 rew tensor(1.2052, dtype=torch.float64) delta_t tensor(0.9510, dtype=torch.float64)
19 gae_duplicate tensor(0.7108, dtype=torch.float64) tensor(-18.6978, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1930, dtype=torch.float64) delta_t tensor(0.9637, dtype=torch.float64)
18 gae_duplicate tensor(1.0239, dtype=torch.float64) tensor(-20.5643, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0638, dtype=torch.float64) delta_t tensor(0.7489, dtype=torch.float64)
17 gae_duplicate tensor(0.5189, dtype=torch.float64) tensor(-16.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0723, dtype=torch.float64) delta_t tensor(0.6463, dtype=torch.float64)
16 gae_duplicate tensor(0.5480, dtype=torch.float64) tensor(-15.7110, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(0.4865, dtype=torch.float64)
15 gae_duplicate tensor(0.2465, dtype=torch.float64) tensor(-10.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2158, dtype=torch.float64) delta_t tensor(-0.0833, dtype=torch.float64)
14 gae_duplicate tensor(-2.1975, dtype=torch.float64) tensor(0.2596, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3720, dtype=torch.float64) delta_t tensor(-0.0016, dtype=torch.float64)
13 gae_duplicate tensor(-1.3735, dtype=torch.float64) tensor(-0.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4666, dtype=torch.float64) delta_t tensor(0.3278, dtype=torch.float64)
12 gae_duplicate tensor(0.0203, dtype=torch.float64) tensor(-6.4639, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5776, dtype=torch.float64) delta_t tensor(0.2332, dtype=torch.float64)
11 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(-5.3848, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0873, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
10 gae_duplicate tensor(-0.5898, dtype=torch.float64) tensor(2.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5040, dtype=torch.float64) delta_t tensor(0.4415, dtype=torch.float64)
9 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-8.2042, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6609, dtype=torch.float64) delta_t tensor(-0.6183, dtype=torch.float64)
8 gae_duplicate tensor(-0.8838, dtype=torch.float64) tensor(11.4519, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9640, dtype=torch.float64) delta_t tensor(-0.8583, dtype=torch.float64)
7 gae_duplicate tensor(-2.5674, dtype=torch.float64) tensor(17.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7896, dtype=torch.float64) delta_t tensor(-0.7096, dtype=torch.float64)
6 gae_duplicate tensor(-1.4142, dtype=torch.float64) tensor(15.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5114, dtype=torch.float64) delta_t tensor(-1.4949, dtype=torch.float64)
5 gae_duplicate tensor(-2.3931, dtype=torch.float64) tensor(32.1314, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0095, dtype=torch.float64) delta_t tensor(-0.0957, dtype=torch.float64)
4 gae_duplicate tensor(-0.8187, dtype=torch.float64) tensor(5.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1490, dtype=torch.float64) delta_t tensor(-1.2031, dtype=torch.float64)
3 gae_duplicate tensor(-1.8725, dtype=torch.float64) tensor(22.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3682, dtype=torch.float64) delta_t tensor(0.3785, dtype=torch.float64)
2 gae_duplicate tensor(-0.2619, dtype=torch.float64) tensor(-4.7481, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-136.4521942138672
value loss:124.09378814697266
entropies:350.30438232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.94291615486145 seconds
19 rew tensor(1.2298, dtype=torch.float64) delta_t tensor(1.0177, dtype=torch.float64)
19 gae_duplicate tensor(0.8481, dtype=torch.float64) tensor(-20.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2226, dtype=torch.float64) delta_t tensor(0.9838, dtype=torch.float64)
18 gae_duplicate tensor(0.8555, dtype=torch.float64) tensor(-22.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8024, dtype=torch.float64) delta_t tensor(0.5048, dtype=torch.float64)
17 gae_duplicate tensor(-0.6512, dtype=torch.float64) tensor(-11.5287, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0679, dtype=torch.float64) delta_t tensor(0.6846, dtype=torch.float64)
16 gae_duplicate tensor(0.5712, dtype=torch.float64) tensor(-13.8670, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8705, dtype=torch.float64) delta_t tensor(0.5757, dtype=torch.float64)
15 gae_duplicate tensor(0.3710, dtype=torch.float64) tensor(-13.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2869, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
14 gae_duplicate tensor(-1.5087, dtype=torch.float64) tensor(0.0550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5141, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
13 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-4.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4464, dtype=torch.float64) delta_t tensor(0.2038, dtype=torch.float64)
12 gae_duplicate tensor(0.1115, dtype=torch.float64) tensor(-4.2855, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2649, dtype=torch.float64) delta_t tensor(-0.0161, dtype=torch.float64)
11 gae_duplicate tensor(-0.3844, dtype=torch.float64) tensor(-0.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1633, dtype=torch.float64) delta_t tensor(0.0606, dtype=torch.float64)
10 gae_duplicate tensor(-0.4216, dtype=torch.float64) tensor(-1.1019, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2610, dtype=torch.float64) delta_t tensor(0.2760, dtype=torch.float64)
9 gae_duplicate tensor(-0.3933, dtype=torch.float64) tensor(-5.8965, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4499, dtype=torch.float64) delta_t tensor(-0.3709, dtype=torch.float64)
8 gae_duplicate tensor(-0.7414, dtype=torch.float64) tensor(6.8274, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1631, dtype=torch.float64) delta_t tensor(-1.0415, dtype=torch.float64)
7 gae_duplicate tensor(-1.8175, dtype=torch.float64) tensor(20.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6389, dtype=torch.float64) delta_t tensor(-0.4815, dtype=torch.float64)
6 gae_duplicate tensor(-1.1504, dtype=torch.float64) tensor(11.3289, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7429, dtype=torch.float64) delta_t tensor(-1.7296, dtype=torch.float64)
5 gae_duplicate tensor(-2.3182, dtype=torch.float64) tensor(32.9110, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1737, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
4 gae_duplicate tensor(-1.1030, dtype=torch.float64) tensor(2.1921, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3762, dtype=torch.float64) delta_t tensor(-1.4077, dtype=torch.float64)
3 gae_duplicate tensor(-1.8078, dtype=torch.float64) tensor(29.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5171, dtype=torch.float64) delta_t tensor(0.4917, dtype=torch.float64)
2 gae_duplicate tensor(-0.7502, dtype=torch.float64) tensor(-7.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.754268646240234
value loss:127.22998809814453
entropies:350.0846862792969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.099623203277588 seconds
19 rew tensor(1.2184, dtype=torch.float64) delta_t tensor(1.0139, dtype=torch.float64)
19 gae_duplicate tensor(0.8880, dtype=torch.float64) tensor(-20.4007, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2104, dtype=torch.float64) delta_t tensor(0.9887, dtype=torch.float64)
18 gae_duplicate tensor(0.9520, dtype=torch.float64) tensor(-22.2506, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0661, dtype=torch.float64) delta_t tensor(0.6773, dtype=torch.float64)
17 gae_duplicate tensor(0.5664, dtype=torch.float64) tensor(-15.7147, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8942, dtype=torch.float64) delta_t tensor(0.5775, dtype=torch.float64)
16 gae_duplicate tensor(0.5456, dtype=torch.float64) tensor(-13.2019, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9109, dtype=torch.float64) delta_t tensor(0.4475, dtype=torch.float64)
15 gae_duplicate tensor(0.4347, dtype=torch.float64) tensor(-9.9351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3854, dtype=torch.float64) delta_t tensor(0.1937, dtype=torch.float64)
14 gae_duplicate tensor(-1.0198, dtype=torch.float64) tensor(-4.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8172, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
13 gae_duplicate tensor(0.0195, dtype=torch.float64) tensor(-7.9347, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0764, dtype=torch.float64) delta_t tensor(-0.0574, dtype=torch.float64)
12 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(0.3148, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7007, dtype=torch.float64) delta_t tensor(0.3258, dtype=torch.float64)
11 gae_duplicate tensor(0.2312, dtype=torch.float64) tensor(-6.1387, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1247, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
10 gae_duplicate tensor(-0.4021, dtype=torch.float64) tensor(4.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3746, dtype=torch.float64) delta_t tensor(0.3629, dtype=torch.float64)
9 gae_duplicate tensor(0.1029, dtype=torch.float64) tensor(-6.1933, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6394, dtype=torch.float64) delta_t tensor(-0.5559, dtype=torch.float64)
8 gae_duplicate tensor(-0.7222, dtype=torch.float64) tensor(10.5444, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5042, dtype=torch.float64) delta_t tensor(-0.3614, dtype=torch.float64)
7 gae_duplicate tensor(-1.5050, dtype=torch.float64) tensor(7.3414, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7735, dtype=torch.float64) delta_t tensor(-0.6781, dtype=torch.float64)
6 gae_duplicate tensor(-0.9904, dtype=torch.float64) tensor(13.7911, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4055, dtype=torch.float64) delta_t tensor(-1.3677, dtype=torch.float64)
5 gae_duplicate tensor(-2.0086, dtype=torch.float64) tensor(26.4489, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0799, dtype=torch.float64) delta_t tensor(-0.1592, dtype=torch.float64)
4 gae_duplicate tensor(-0.6805, dtype=torch.float64) tensor(5.7116, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9407, dtype=torch.float64) delta_t tensor(-0.9966, dtype=torch.float64)
3 gae_duplicate tensor(-1.9964, dtype=torch.float64) tensor(21.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2903, dtype=torch.float64) delta_t tensor(0.3178, dtype=torch.float64)
2 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(-4.0049, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1014.14794921875
value loss:94.20915222167969
entropies:349.9683837890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038228988647461 seconds
19 rew tensor(1.1541, dtype=torch.float64) delta_t tensor(0.8380, dtype=torch.float64)
19 gae_duplicate tensor(0.7594, dtype=torch.float64) tensor(-17.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1976, dtype=torch.float64) delta_t tensor(0.9009, dtype=torch.float64)
18 gae_duplicate tensor(0.8563, dtype=torch.float64) tensor(-18.9133, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1201, dtype=torch.float64) delta_t tensor(0.7742, dtype=torch.float64)
17 gae_duplicate tensor(0.4572, dtype=torch.float64) tensor(-16.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1113, dtype=torch.float64) delta_t tensor(0.7390, dtype=torch.float64)
16 gae_duplicate tensor(0.3796, dtype=torch.float64) tensor(-16.7987, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9965, dtype=torch.float64) delta_t tensor(0.5868, dtype=torch.float64)
15 gae_duplicate tensor(0.2804, dtype=torch.float64) tensor(-12.7529, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8854, dtype=torch.float64) delta_t tensor(0.4598, dtype=torch.float64)
14 gae_duplicate tensor(0.1011, dtype=torch.float64) tensor(-9.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0199, dtype=torch.float64) delta_t tensor(-0.3935, dtype=torch.float64)
13 gae_duplicate tensor(-4.0505, dtype=torch.float64) tensor(9.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5086, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
12 gae_duplicate tensor(-0.0460, dtype=torch.float64) tensor(-5.5826, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4299, dtype=torch.float64) delta_t tensor(0.0263, dtype=torch.float64)
11 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-0.9849, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0060, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
10 gae_duplicate tensor(-0.3347, dtype=torch.float64) tensor(0.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4631, dtype=torch.float64) delta_t tensor(0.4413, dtype=torch.float64)
9 gae_duplicate tensor(-0.0003, dtype=torch.float64) tensor(-8.3810, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6686, dtype=torch.float64) delta_t tensor(-0.5830, dtype=torch.float64)
8 gae_duplicate tensor(-1.2473, dtype=torch.float64) tensor(9.9436, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-2.5322, dtype=torch.float64) delta_t tensor(-2.3850, dtype=torch.float64)
7 gae_duplicate tensor(-5.5648, dtype=torch.float64) tensor(49.5525, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0301, dtype=torch.float64) delta_t tensor(-0.9017, dtype=torch.float64)
6 gae_duplicate tensor(-2.0993, dtype=torch.float64) tensor(22.5578, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5599, dtype=torch.float64) delta_t tensor(-1.4986, dtype=torch.float64)
5 gae_duplicate tensor(-2.1484, dtype=torch.float64) tensor(30.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1118, dtype=torch.float64) delta_t tensor(0.0965, dtype=torch.float64)
4 gae_duplicate tensor(-0.6546, dtype=torch.float64) tensor(1.2877, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5210, dtype=torch.float64) delta_t tensor(-1.4754, dtype=torch.float64)
3 gae_duplicate tensor(-2.2434, dtype=torch.float64) tensor(27.6122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4693, dtype=torch.float64) delta_t tensor(0.5403, dtype=torch.float64)
2 gae_duplicate tensor(-0.0004, dtype=torch.float64) tensor(-8.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1981.5546875
value loss:241.6146240234375
entropies:349.97845458984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.277130842208862 seconds
19 rew tensor(1.1841, dtype=torch.float64) delta_t tensor(0.9532, dtype=torch.float64)
19 gae_duplicate tensor(0.7410, dtype=torch.float64) tensor(-18.3294, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1346, dtype=torch.float64) delta_t tensor(0.8689, dtype=torch.float64)
18 gae_duplicate tensor(0.7794, dtype=torch.float64) tensor(-17.9468, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8672, dtype=torch.float64) delta_t tensor(0.5468, dtype=torch.float64)
17 gae_duplicate tensor(-0.9052, dtype=torch.float64) tensor(-12.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8208, dtype=torch.float64) delta_t tensor(0.4709, dtype=torch.float64)
16 gae_duplicate tensor(-0.8154, dtype=torch.float64) tensor(-10.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9608, dtype=torch.float64) delta_t tensor(0.4802, dtype=torch.float64)
15 gae_duplicate tensor(0.2039, dtype=torch.float64) tensor(-10.6227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7915, dtype=torch.float64) delta_t tensor(0.3560, dtype=torch.float64)
14 gae_duplicate tensor(0.1320, dtype=torch.float64) tensor(-8.6834, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7035, dtype=torch.float64) delta_t tensor(0.2954, dtype=torch.float64)
13 gae_duplicate tensor(0.1884, dtype=torch.float64) tensor(-6.8521, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3671, dtype=torch.float64) delta_t tensor(0.0832, dtype=torch.float64)
12 gae_duplicate tensor(-0.2121, dtype=torch.float64) tensor(-2.3467, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4219, dtype=torch.float64) delta_t tensor(-0.7252, dtype=torch.float64)
11 gae_duplicate tensor(-4.4710, dtype=torch.float64) tensor(12.9516, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.5376, dtype=torch.float64) delta_t tensor(-0.6155, dtype=torch.float64)
10 gae_duplicate tensor(-3.5408, dtype=torch.float64) tensor(12.4861, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3147, dtype=torch.float64) delta_t tensor(0.2847, dtype=torch.float64)
9 gae_duplicate tensor(0.0551, dtype=torch.float64) tensor(-4.2320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4738, dtype=torch.float64) delta_t tensor(-0.3762, dtype=torch.float64)
8 gae_duplicate tensor(-0.6939, dtype=torch.float64) tensor(6.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9160, dtype=torch.float64) delta_t tensor(-0.7322, dtype=torch.float64)
7 gae_duplicate tensor(-1.3644, dtype=torch.float64) tensor(15.6877, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6352, dtype=torch.float64) delta_t tensor(-0.4907, dtype=torch.float64)
6 gae_duplicate tensor(-1.1142, dtype=torch.float64) tensor(10.9253, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6949, dtype=torch.float64) delta_t tensor(-1.6220, dtype=torch.float64)
5 gae_duplicate tensor(-1.9620, dtype=torch.float64) tensor(31.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0633, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
4 gae_duplicate tensor(-0.4937, dtype=torch.float64) tensor(2.5711, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2713, dtype=torch.float64) delta_t tensor(-1.2738, dtype=torch.float64)
3 gae_duplicate tensor(-1.7397, dtype=torch.float64) tensor(26.4384, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4129, dtype=torch.float64) delta_t tensor(0.4022, dtype=torch.float64)
2 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(-5.0113, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1256.595703125
value loss:144.4020233154297
entropies:349.88543701171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3920.2610)
ToM Target loss= tensor(2405.9277)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.211474895477295 seconds
19 rew tensor(1.1992, dtype=torch.float64) delta_t tensor(0.9467, dtype=torch.float64)
19 gae_duplicate tensor(0.7648, dtype=torch.float64) tensor(-18.4178, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1912, dtype=torch.float64) delta_t tensor(0.9351, dtype=torch.float64)
18 gae_duplicate tensor(0.8262, dtype=torch.float64) tensor(-20.8345, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0111, dtype=torch.float64) delta_t tensor(0.6497, dtype=torch.float64)
17 gae_duplicate tensor(0.4109, dtype=torch.float64) tensor(-13.8308, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9568, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
16 gae_duplicate tensor(0.3708, dtype=torch.float64) tensor(-11.3865, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8006, dtype=torch.float64) delta_t tensor(0.3450, dtype=torch.float64)
15 gae_duplicate tensor(0.3151, dtype=torch.float64) tensor(-8.3609, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6945, dtype=torch.float64) delta_t tensor(0.3161, dtype=torch.float64)
14 gae_duplicate tensor(-0.0200, dtype=torch.float64) tensor(-6.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.3067, dtype=torch.float64)
13 gae_duplicate tensor(0.1824, dtype=torch.float64) tensor(-6.3340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2839, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
12 gae_duplicate tensor(-0.0162, dtype=torch.float64) tensor(-3.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4537, dtype=torch.float64) delta_t tensor(0.0291, dtype=torch.float64)
11 gae_duplicate tensor(-0.3984, dtype=torch.float64) tensor(-0.9415, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0102, dtype=torch.float64) delta_t tensor(-0.1458, dtype=torch.float64)
10 gae_duplicate tensor(-0.5211, dtype=torch.float64) tensor(2.3416, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3194, dtype=torch.float64) delta_t tensor(0.3260, dtype=torch.float64)
9 gae_duplicate tensor(-0.3885, dtype=torch.float64) tensor(-5.9772, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4976, dtype=torch.float64) delta_t tensor(-0.3806, dtype=torch.float64)
8 gae_duplicate tensor(-0.8528, dtype=torch.float64) tensor(6.8303, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3642, dtype=torch.float64) delta_t tensor(-0.2170, dtype=torch.float64)
7 gae_duplicate tensor(-1.8126, dtype=torch.float64) tensor(4.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7967, dtype=torch.float64) delta_t tensor(-0.6777, dtype=torch.float64)
6 gae_duplicate tensor(-1.2325, dtype=torch.float64) tensor(13.3087, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1775, dtype=torch.float64) delta_t tensor(-1.1154, dtype=torch.float64)
5 gae_duplicate tensor(-2.3205, dtype=torch.float64) tensor(24.0174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2688, dtype=torch.float64) delta_t tensor(-0.2958, dtype=torch.float64)
4 gae_duplicate tensor(-0.8386, dtype=torch.float64) tensor(7.7030, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5049, dtype=torch.float64) delta_t tensor(-0.4919, dtype=torch.float64)
3 gae_duplicate tensor(-1.8134, dtype=torch.float64) tensor(11.3564, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0816, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
2 gae_duplicate tensor(-0.4024, dtype=torch.float64) tensor(-1.1744, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1375.226318359375
value loss:81.18962860107422
entropies:349.903564453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.860971927642822 seconds
19 rew tensor(1.2047, dtype=torch.float64) delta_t tensor(0.8670, dtype=torch.float64)
19 gae_duplicate tensor(0.6474, dtype=torch.float64) tensor(-17.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2217, dtype=torch.float64) delta_t tensor(0.9574, dtype=torch.float64)
18 gae_duplicate tensor(0.8234, dtype=torch.float64) tensor(-20.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.8207, dtype=torch.float64)
17 gae_duplicate tensor(0.5468, dtype=torch.float64) tensor(-17.6089, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8296, dtype=torch.float64) delta_t tensor(0.4512, dtype=torch.float64)
16 gae_duplicate tensor(-0.9463, dtype=torch.float64) tensor(-10.7017, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6895, dtype=torch.float64) delta_t tensor(0.2280, dtype=torch.float64)
15 gae_duplicate tensor(-0.5536, dtype=torch.float64) tensor(-5.8788, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6432, dtype=torch.float64) delta_t tensor(0.1990, dtype=torch.float64)
14 gae_duplicate tensor(-0.8621, dtype=torch.float64) tensor(-4.4878, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1866, dtype=torch.float64) delta_t tensor(-0.2352, dtype=torch.float64)
13 gae_duplicate tensor(-1.4201, dtype=torch.float64) tensor(3.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2230, dtype=torch.float64) delta_t tensor(0.1362, dtype=torch.float64)
12 gae_duplicate tensor(-0.9780, dtype=torch.float64) tensor(-2.3874, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5264, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
11 gae_duplicate tensor(-0.3035, dtype=torch.float64) tensor(-1.8726, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0363, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
10 gae_duplicate tensor(-0.4361, dtype=torch.float64) tensor(1.4089, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5368, dtype=torch.float64) delta_t tensor(0.5406, dtype=torch.float64)
9 gae_duplicate tensor(0.1960, dtype=torch.float64) tensor(-10.1235, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6178, dtype=torch.float64) delta_t tensor(-0.5000, dtype=torch.float64)
8 gae_duplicate tensor(-0.7265, dtype=torch.float64) tensor(8.6138, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7132, dtype=torch.float64) delta_t tensor(-1.5124, dtype=torch.float64)
7 gae_duplicate tensor(-4.7685, dtype=torch.float64) tensor(28.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8877, dtype=torch.float64) delta_t tensor(-0.7091, dtype=torch.float64)
6 gae_duplicate tensor(-1.6131, dtype=torch.float64) tensor(16.2928, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4742, dtype=torch.float64) delta_t tensor(-1.3623, dtype=torch.float64)
5 gae_duplicate tensor(-1.6823, dtype=torch.float64) tensor(27.8566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1370, dtype=torch.float64) delta_t tensor(0.1626, dtype=torch.float64)
4 gae_duplicate tensor(-0.4713, dtype=torch.float64) tensor(-0.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3618, dtype=torch.float64) delta_t tensor(-1.3000, dtype=torch.float64)
3 gae_duplicate tensor(-1.9127, dtype=torch.float64) tensor(25.1864, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4748, dtype=torch.float64) delta_t tensor(0.5132, dtype=torch.float64)
2 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-7.5568, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-798.4364013671875
value loss:147.62612915039062
entropies:349.8926696777344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.995265960693359 seconds
19 rew tensor(1.2077, dtype=torch.float64) delta_t tensor(0.9350, dtype=torch.float64)
19 gae_duplicate tensor(0.7830, dtype=torch.float64) tensor(-16.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1466, dtype=torch.float64) delta_t tensor(0.8737, dtype=torch.float64)
18 gae_duplicate tensor(0.8012, dtype=torch.float64) tensor(-17.9877, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0677, dtype=torch.float64) delta_t tensor(0.7165, dtype=torch.float64)
17 gae_duplicate tensor(0.4572, dtype=torch.float64) tensor(-14.6662, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9896, dtype=torch.float64) delta_t tensor(0.5704, dtype=torch.float64)
16 gae_duplicate tensor(0.4190, dtype=torch.float64) tensor(-12.6812, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9551, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
15 gae_duplicate tensor(0.4551, dtype=torch.float64) tensor(-9.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3682, dtype=torch.float64) delta_t tensor(-0.0978, dtype=torch.float64)
14 gae_duplicate tensor(-0.8860, dtype=torch.float64) tensor(0.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5636, dtype=torch.float64) delta_t tensor(0.2436, dtype=torch.float64)
13 gae_duplicate tensor(-0.1620, dtype=torch.float64) tensor(-4.3249, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2924, dtype=torch.float64) delta_t tensor(0.1152, dtype=torch.float64)
12 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(-2.8163, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(0.0895, dtype=torch.float64)
11 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(-2.1734, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0051, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
10 gae_duplicate tensor(-0.2886, dtype=torch.float64) tensor(0.9550, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3910, dtype=torch.float64) delta_t tensor(0.4006, dtype=torch.float64)
9 gae_duplicate tensor(-0.4305, dtype=torch.float64) tensor(-7.3358, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6221, dtype=torch.float64) delta_t tensor(-0.4663, dtype=torch.float64)
8 gae_duplicate tensor(-0.9155, dtype=torch.float64) tensor(7.9941, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2148, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
7 gae_duplicate tensor(-1.5393, dtype=torch.float64) tensor(1.9965, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8188, dtype=torch.float64) delta_t tensor(-0.6598, dtype=torch.float64)
6 gae_duplicate tensor(-1.0336, dtype=torch.float64) tensor(13.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1815, dtype=torch.float64) delta_t tensor(-1.0677, dtype=torch.float64)
5 gae_duplicate tensor(-2.1727, dtype=torch.float64) tensor(21.5668, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3136, dtype=torch.float64) delta_t tensor(-0.3104, dtype=torch.float64)
4 gae_duplicate tensor(-0.7676, dtype=torch.float64) tensor(8.4078, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5086, dtype=torch.float64) delta_t tensor(-0.4735, dtype=torch.float64)
3 gae_duplicate tensor(-1.3787, dtype=torch.float64) tensor(10.8951, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0147, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
2 gae_duplicate tensor(-0.6721, dtype=torch.float64) tensor(1.2249, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1026.023681640625
value loss:75.55528259277344
entropies:349.9051513671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.122209072113037 seconds
19 rew tensor(1.1999, dtype=torch.float64) delta_t tensor(0.8986, dtype=torch.float64)
19 gae_duplicate tensor(0.7407, dtype=torch.float64) tensor(-16.8619, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1748, dtype=torch.float64) delta_t tensor(0.8791, dtype=torch.float64)
18 gae_duplicate tensor(0.8438, dtype=torch.float64) tensor(-19.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0774, dtype=torch.float64) delta_t tensor(0.6933, dtype=torch.float64)
17 gae_duplicate tensor(0.4642, dtype=torch.float64) tensor(-14.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9731, dtype=torch.float64) delta_t tensor(0.5401, dtype=torch.float64)
16 gae_duplicate tensor(0.3452, dtype=torch.float64) tensor(-11.6333, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9193, dtype=torch.float64) delta_t tensor(0.4806, dtype=torch.float64)
15 gae_duplicate tensor(0.3326, dtype=torch.float64) tensor(-10.7564, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4550, dtype=torch.float64) delta_t tensor(-0.0423, dtype=torch.float64)
14 gae_duplicate tensor(-1.2009, dtype=torch.float64) tensor(0.4257, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6424, dtype=torch.float64) delta_t tensor(0.3221, dtype=torch.float64)
13 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(-6.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4870, dtype=torch.float64) delta_t tensor(0.1906, dtype=torch.float64)
12 gae_duplicate tensor(-0.2933, dtype=torch.float64) tensor(-4.3453, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0229, dtype=torch.float64) delta_t tensor(-0.2589, dtype=torch.float64)
11 gae_duplicate tensor(-1.1749, dtype=torch.float64) tensor(4.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1196, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
10 gae_duplicate tensor(-0.2147, dtype=torch.float64) tensor(-1.0010, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2305, dtype=torch.float64) delta_t tensor(0.2596, dtype=torch.float64)
9 gae_duplicate tensor(-0.1553, dtype=torch.float64) tensor(-5.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5260, dtype=torch.float64) delta_t tensor(-0.3357, dtype=torch.float64)
8 gae_duplicate tensor(-0.7033, dtype=torch.float64) tensor(5.8295, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6431, dtype=torch.float64) delta_t tensor(-0.4173, dtype=torch.float64)
7 gae_duplicate tensor(-1.8972, dtype=torch.float64) tensor(8.7982, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7550, dtype=torch.float64) delta_t tensor(-0.5553, dtype=torch.float64)
6 gae_duplicate tensor(-1.0875, dtype=torch.float64) tensor(11.3642, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4114, dtype=torch.float64) delta_t tensor(-1.2421, dtype=torch.float64)
5 gae_duplicate tensor(-2.0467, dtype=torch.float64) tensor(26.0265, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0948, dtype=torch.float64) delta_t tensor(-0.1282, dtype=torch.float64)
4 gae_duplicate tensor(-1.0192, dtype=torch.float64) tensor(5.9552, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8943, dtype=torch.float64) delta_t tensor(-0.8194, dtype=torch.float64)
3 gae_duplicate tensor(-2.0573, dtype=torch.float64) tensor(17.0067, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1904, dtype=torch.float64) delta_t tensor(0.2351, dtype=torch.float64)
2 gae_duplicate tensor(-1.0590, dtype=torch.float64) tensor(-3.4810, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:705.6492919921875
value loss:93.70741271972656
entropies:349.8199462890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.191037893295288 seconds
19 rew tensor(1.1416, dtype=torch.float64) delta_t tensor(0.8137, dtype=torch.float64)
19 gae_duplicate tensor(0.7027, dtype=torch.float64) tensor(-15.8353, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1187, dtype=torch.float64) delta_t tensor(0.7606, dtype=torch.float64)
18 gae_duplicate tensor(0.6255, dtype=torch.float64) tensor(-16.6644, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0976, dtype=torch.float64) delta_t tensor(0.6807, dtype=torch.float64)
17 gae_duplicate tensor(0.4374, dtype=torch.float64) tensor(-15.0639, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0075, dtype=torch.float64) delta_t tensor(0.5617, dtype=torch.float64)
16 gae_duplicate tensor(0.4006, dtype=torch.float64) tensor(-13.2533, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9217, dtype=torch.float64) delta_t tensor(0.4029, dtype=torch.float64)
15 gae_duplicate tensor(0.3456, dtype=torch.float64) tensor(-9.8633, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6809, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
14 gae_duplicate tensor(-0.0076, dtype=torch.float64) tensor(-4.5166, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6788, dtype=torch.float64) delta_t tensor(0.2231, dtype=torch.float64)
13 gae_duplicate tensor(0.1076, dtype=torch.float64) tensor(-4.5845, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2141, dtype=torch.float64) delta_t tensor(-0.1070, dtype=torch.float64)
12 gae_duplicate tensor(-0.3727, dtype=torch.float64) tensor(1.5815, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5256, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
11 gae_duplicate tensor(-0.1026, dtype=torch.float64) tensor(-2.6294, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1018, dtype=torch.float64) delta_t tensor(-0.1379, dtype=torch.float64)
10 gae_duplicate tensor(-0.2671, dtype=torch.float64) tensor(2.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4428, dtype=torch.float64) delta_t tensor(0.5156, dtype=torch.float64)
9 gae_duplicate tensor(0.1874, dtype=torch.float64) tensor(-9.2994, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6069, dtype=torch.float64) delta_t tensor(-0.4006, dtype=torch.float64)
8 gae_duplicate tensor(-0.7783, dtype=torch.float64) tensor(6.5981, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5613, dtype=torch.float64) delta_t tensor(-0.3001, dtype=torch.float64)
7 gae_duplicate tensor(-1.2760, dtype=torch.float64) tensor(6.6489, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8073, dtype=torch.float64) delta_t tensor(-0.5760, dtype=torch.float64)
6 gae_duplicate tensor(-1.2222, dtype=torch.float64) tensor(11.2740, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2719, dtype=torch.float64) delta_t tensor(-1.1439, dtype=torch.float64)
5 gae_duplicate tensor(-1.6545, dtype=torch.float64) tensor(23.2392, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1135, dtype=torch.float64) delta_t tensor(-0.0829, dtype=torch.float64)
4 gae_duplicate tensor(-0.7215, dtype=torch.float64) tensor(3.8779, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7703, dtype=torch.float64) delta_t tensor(-0.7018, dtype=torch.float64)
3 gae_duplicate tensor(-1.6704, dtype=torch.float64) tensor(16.0886, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1989, dtype=torch.float64) delta_t tensor(0.3103, dtype=torch.float64)
2 gae_duplicate tensor(-0.6558, dtype=torch.float64) tensor(-4.4254, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1216.7783203125
value loss:73.12890625
entropies:349.57720947265625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3910.2439)
ToM Target loss= tensor(2403.0911)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.033218860626221 seconds
19 rew tensor(1.1614, dtype=torch.float64) delta_t tensor(0.7247, dtype=torch.float64)
19 gae_duplicate tensor(0.4575, dtype=torch.float64) tensor(-13.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0987, dtype=torch.float64) delta_t tensor(0.7530, dtype=torch.float64)
18 gae_duplicate tensor(0.4575, dtype=torch.float64) tensor(-15.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9988, dtype=torch.float64) delta_t tensor(0.5238, dtype=torch.float64)
17 gae_duplicate tensor(0.2843, dtype=torch.float64) tensor(-11.8888, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9840, dtype=torch.float64) delta_t tensor(0.5083, dtype=torch.float64)
16 gae_duplicate tensor(0.3424, dtype=torch.float64) tensor(-10.9289, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9227, dtype=torch.float64) delta_t tensor(0.4130, dtype=torch.float64)
15 gae_duplicate tensor(0.2551, dtype=torch.float64) tensor(-9.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7565, dtype=torch.float64) delta_t tensor(0.3566, dtype=torch.float64)
14 gae_duplicate tensor(0.0080, dtype=torch.float64) tensor(-7.3572, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7281, dtype=torch.float64) delta_t tensor(0.2373, dtype=torch.float64)
13 gae_duplicate tensor(0.1058, dtype=torch.float64) tensor(-5.6609, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3103, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
12 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-0.0073, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4902, dtype=torch.float64) delta_t tensor(0.0121, dtype=torch.float64)
11 gae_duplicate tensor(-0.1902, dtype=torch.float64) tensor(-0.1045, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0753, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
10 gae_duplicate tensor(-0.3182, dtype=torch.float64) tensor(2.1981, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3260, dtype=torch.float64) delta_t tensor(0.3774, dtype=torch.float64)
9 gae_duplicate tensor(0.2045, dtype=torch.float64) tensor(-7.1867, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5107, dtype=torch.float64) delta_t tensor(-0.3083, dtype=torch.float64)
8 gae_duplicate tensor(-0.8116, dtype=torch.float64) tensor(5.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7379, dtype=torch.float64) delta_t tensor(-0.4421, dtype=torch.float64)
7 gae_duplicate tensor(-1.2448, dtype=torch.float64) tensor(8.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6452, dtype=torch.float64) delta_t tensor(-0.4020, dtype=torch.float64)
6 gae_duplicate tensor(-1.0681, dtype=torch.float64) tensor(8.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5192, dtype=torch.float64) delta_t tensor(-1.3478, dtype=torch.float64)
5 gae_duplicate tensor(-1.7812, dtype=torch.float64) tensor(27.5389, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0252, dtype=torch.float64) delta_t tensor(0.0377, dtype=torch.float64)
4 gae_duplicate tensor(-0.5824, dtype=torch.float64) tensor(1.7520, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9945, dtype=torch.float64) delta_t tensor(-0.9449, dtype=torch.float64)
3 gae_duplicate tensor(-1.7830, dtype=torch.float64) tensor(17.3812, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3412, dtype=torch.float64) delta_t tensor(0.4523, dtype=torch.float64)
2 gae_duplicate tensor(-0.2062, dtype=torch.float64) tensor(-6.7381, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:751.1915283203125
value loss:69.20770263671875
entropies:349.2958068847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.063549995422363 seconds
19 rew tensor(1.0956, dtype=torch.float64) delta_t tensor(0.6611, dtype=torch.float64)
19 gae_duplicate tensor(0.4218, dtype=torch.float64) tensor(-12.6039, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1089, dtype=torch.float64) delta_t tensor(0.6885, dtype=torch.float64)
18 gae_duplicate tensor(0.5966, dtype=torch.float64) tensor(-14.3051, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9821, dtype=torch.float64) delta_t tensor(0.4945, dtype=torch.float64)
17 gae_duplicate tensor(0.3800, dtype=torch.float64) tensor(-12.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9866, dtype=torch.float64) delta_t tensor(0.5313, dtype=torch.float64)
16 gae_duplicate tensor(0.3133, dtype=torch.float64) tensor(-10.7954, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8799, dtype=torch.float64) delta_t tensor(0.3363, dtype=torch.float64)
15 gae_duplicate tensor(0.2230, dtype=torch.float64) tensor(-7.7682, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7300, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
14 gae_duplicate tensor(-0.1134, dtype=torch.float64) tensor(-4.7485, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6466, dtype=torch.float64) delta_t tensor(0.1390, dtype=torch.float64)
13 gae_duplicate tensor(0.0090, dtype=torch.float64) tensor(-3.3106, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3247, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
12 gae_duplicate tensor(-0.2878, dtype=torch.float64) tensor(0.1621, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4715, dtype=torch.float64) delta_t tensor(-0.0010, dtype=torch.float64)
11 gae_duplicate tensor(-0.2690, dtype=torch.float64) tensor(0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1662, dtype=torch.float64) delta_t tensor(-0.1487, dtype=torch.float64)
10 gae_duplicate tensor(-0.2528, dtype=torch.float64) tensor(2.7982, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3748, dtype=torch.float64) delta_t tensor(0.4472, dtype=torch.float64)
9 gae_duplicate tensor(0.2164, dtype=torch.float64) tensor(-9.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4962, dtype=torch.float64) delta_t tensor(-0.2661, dtype=torch.float64)
8 gae_duplicate tensor(-0.6519, dtype=torch.float64) tensor(4.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8590, dtype=torch.float64) delta_t tensor(-0.5193, dtype=torch.float64)
7 gae_duplicate tensor(-1.3290, dtype=torch.float64) tensor(10.2616, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5930, dtype=torch.float64) delta_t tensor(-0.3454, dtype=torch.float64)
6 gae_duplicate tensor(-0.7191, dtype=torch.float64) tensor(8.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6283, dtype=torch.float64) delta_t tensor(-1.4153, dtype=torch.float64)
5 gae_duplicate tensor(-1.8360, dtype=torch.float64) tensor(28.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0467, dtype=torch.float64) delta_t tensor(0.0756, dtype=torch.float64)
4 gae_duplicate tensor(-0.5141, dtype=torch.float64) tensor(1.3301, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1106, dtype=torch.float64) delta_t tensor(-1.0136, dtype=torch.float64)
3 gae_duplicate tensor(-1.7740, dtype=torch.float64) tensor(20.1483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4124, dtype=torch.float64) delta_t tensor(0.5612, dtype=torch.float64)
2 gae_duplicate tensor(0.0167, dtype=torch.float64) tensor(-9.3892, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:350.4667053222656
value loss:66.60576629638672
entropies:349.0245361328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.985051870346069 seconds
19 rew tensor(1.1802, dtype=torch.float64) delta_t tensor(0.7985, dtype=torch.float64)
19 gae_duplicate tensor(0.4110, dtype=torch.float64) tensor(-15.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8561, dtype=torch.float64) delta_t tensor(0.4202, dtype=torch.float64)
18 gae_duplicate tensor(-0.9825, dtype=torch.float64) tensor(-9.3729, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9976, dtype=torch.float64) delta_t tensor(0.4663, dtype=torch.float64)
17 gae_duplicate tensor(0.2653, dtype=torch.float64) tensor(-9.3862, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9608, dtype=torch.float64) delta_t tensor(0.4430, dtype=torch.float64)
16 gae_duplicate tensor(0.3243, dtype=torch.float64) tensor(-9.1234, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8685, dtype=torch.float64) delta_t tensor(0.3163, dtype=torch.float64)
15 gae_duplicate tensor(0.2861, dtype=torch.float64) tensor(-6.6982, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(0.2315, dtype=torch.float64)
14 gae_duplicate tensor(-0.1072, dtype=torch.float64) tensor(-5.5419, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6619, dtype=torch.float64) delta_t tensor(0.2195, dtype=torch.float64)
13 gae_duplicate tensor(-0.0592, dtype=torch.float64) tensor(-5.0117, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2480, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
12 gae_duplicate tensor(-0.2074, dtype=torch.float64) tensor(-0.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5158, dtype=torch.float64) delta_t tensor(0.1417, dtype=torch.float64)
11 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(-2.6700, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0386, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
10 gae_duplicate tensor(-0.2776, dtype=torch.float64) tensor(0.9702, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3995, dtype=torch.float64) delta_t tensor(0.3988, dtype=torch.float64)
9 gae_duplicate tensor(-0.3889, dtype=torch.float64) tensor(-7.4206, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6458, dtype=torch.float64) delta_t tensor(-0.4115, dtype=torch.float64)
8 gae_duplicate tensor(-0.7947, dtype=torch.float64) tensor(8.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2962, dtype=torch.float64) delta_t tensor(0.0174, dtype=torch.float64)
7 gae_duplicate tensor(-1.5023, dtype=torch.float64) tensor(-0.7526, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7145, dtype=torch.float64) delta_t tensor(-0.4860, dtype=torch.float64)
6 gae_duplicate tensor(-0.9699, dtype=torch.float64) tensor(9.0837, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3279, dtype=torch.float64) delta_t tensor(-1.0779, dtype=torch.float64)
5 gae_duplicate tensor(-2.1536, dtype=torch.float64) tensor(20.9869, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3096, dtype=torch.float64) delta_t tensor(-0.2119, dtype=torch.float64)
4 gae_duplicate tensor(-0.7249, dtype=torch.float64) tensor(6.0216, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5810, dtype=torch.float64) delta_t tensor(-0.4763, dtype=torch.float64)
3 gae_duplicate tensor(-1.3397, dtype=torch.float64) tensor(10.0948, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0451, dtype=torch.float64) delta_t tensor(0.1669, dtype=torch.float64)
2 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(-2.2862, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:917.5220336914062
value loss:59.21653747558594
entropies:348.8553466796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.851095199584961 seconds
19 rew tensor(1.2157, dtype=torch.float64) delta_t tensor(0.6999, dtype=torch.float64)
19 gae_duplicate tensor(0.3560, dtype=torch.float64) tensor(-12.9220, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1542, dtype=torch.float64) delta_t tensor(0.6808, dtype=torch.float64)
18 gae_duplicate tensor(0.4866, dtype=torch.float64) tensor(-13.9112, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0894, dtype=torch.float64) delta_t tensor(0.5714, dtype=torch.float64)
17 gae_duplicate tensor(0.3019, dtype=torch.float64) tensor(-12.8964, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0261, dtype=torch.float64) delta_t tensor(0.4747, dtype=torch.float64)
16 gae_duplicate tensor(0.3203, dtype=torch.float64) tensor(-11.2456, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8950, dtype=torch.float64) delta_t tensor(0.3231, dtype=torch.float64)
15 gae_duplicate tensor(0.1926, dtype=torch.float64) tensor(-7.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5431, dtype=torch.float64) delta_t tensor(0.0571, dtype=torch.float64)
14 gae_duplicate tensor(-1.1233, dtype=torch.float64) tensor(-2.2670, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4397, dtype=torch.float64) delta_t tensor(0.0294, dtype=torch.float64)
13 gae_duplicate tensor(-0.1898, dtype=torch.float64) tensor(-1.0122, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5069, dtype=torch.float64) delta_t tensor(0.0677, dtype=torch.float64)
12 gae_duplicate tensor(-0.4339, dtype=torch.float64) tensor(-1.5255, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2030, dtype=torch.float64) delta_t tensor(0.0253, dtype=torch.float64)
11 gae_duplicate tensor(-0.4684, dtype=torch.float64) tensor(-0.5763, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2855, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
10 gae_duplicate tensor(-0.2717, dtype=torch.float64) tensor(-5.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0180, dtype=torch.float64) delta_t tensor(0.1861, dtype=torch.float64)
9 gae_duplicate tensor(-0.3865, dtype=torch.float64) tensor(-3.7890, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3020, dtype=torch.float64) delta_t tensor(0.0045, dtype=torch.float64)
8 gae_duplicate tensor(-0.5288, dtype=torch.float64) tensor(-0.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4788, dtype=torch.float64) delta_t tensor(-1.1187, dtype=torch.float64)
7 gae_duplicate tensor(-2.0417, dtype=torch.float64) tensor(22.0367, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6043, dtype=torch.float64) delta_t tensor(-0.2454, dtype=torch.float64)
6 gae_duplicate tensor(-0.7905, dtype=torch.float64) tensor(6.4966, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8136, dtype=torch.float64) delta_t tensor(-1.6287, dtype=torch.float64)
5 gae_duplicate tensor(-2.2968, dtype=torch.float64) tensor(31.5330, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2760, dtype=torch.float64) delta_t tensor(0.3457, dtype=torch.float64)
4 gae_duplicate tensor(-0.2728, dtype=torch.float64) tensor(-3.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3539, dtype=torch.float64) delta_t tensor(-1.1468, dtype=torch.float64)
3 gae_duplicate tensor(-2.1888, dtype=torch.float64) tensor(24.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4879, dtype=torch.float64) delta_t tensor(0.6313, dtype=torch.float64)
2 gae_duplicate tensor(-0.7974, dtype=torch.float64) tensor(-9.9484, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-7.169866561889648
value loss:101.42364501953125
entropies:348.65771484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.241635084152222 seconds
19 rew tensor(1.2034, dtype=torch.float64) delta_t tensor(0.7076, dtype=torch.float64)
19 gae_duplicate tensor(0.4236, dtype=torch.float64) tensor(-13.8909, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1404, dtype=torch.float64) delta_t tensor(0.6519, dtype=torch.float64)
18 gae_duplicate tensor(0.3814, dtype=torch.float64) tensor(-13.7744, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0367, dtype=torch.float64) delta_t tensor(0.4962, dtype=torch.float64)
17 gae_duplicate tensor(0.3450, dtype=torch.float64) tensor(-11.0951, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9990, dtype=torch.float64) delta_t tensor(0.4213, dtype=torch.float64)
16 gae_duplicate tensor(0.2739, dtype=torch.float64) tensor(-9.5058, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(0.3176, dtype=torch.float64)
15 gae_duplicate tensor(0.2502, dtype=torch.float64) tensor(-7.0505, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3868, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
14 gae_duplicate tensor(-1.4751, dtype=torch.float64) tensor(1.8550, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6534, dtype=torch.float64) delta_t tensor(0.1441, dtype=torch.float64)
13 gae_duplicate tensor(-0.3183, dtype=torch.float64) tensor(-2.8549, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1997, dtype=torch.float64) delta_t tensor(-0.1842, dtype=torch.float64)
12 gae_duplicate tensor(-0.4078, dtype=torch.float64) tensor(3.1312, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5283, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
11 gae_duplicate tensor(-0.1873, dtype=torch.float64) tensor(-0.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2641, dtype=torch.float64) delta_t tensor(-0.1955, dtype=torch.float64)
10 gae_duplicate tensor(-0.3325, dtype=torch.float64) tensor(3.5675, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5273, dtype=torch.float64) delta_t tensor(0.5960, dtype=torch.float64)
9 gae_duplicate tensor(0.3273, dtype=torch.float64) tensor(-10.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5895, dtype=torch.float64) delta_t tensor(-0.3170, dtype=torch.float64)
8 gae_duplicate tensor(-0.7467, dtype=torch.float64) tensor(4.7558, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8629, dtype=torch.float64) delta_t tensor(-0.4511, dtype=torch.float64)
7 gae_duplicate tensor(-1.3401, dtype=torch.float64) tensor(9.6382, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6848, dtype=torch.float64) delta_t tensor(-0.3866, dtype=torch.float64)
6 gae_duplicate tensor(-0.7757, dtype=torch.float64) tensor(7.9989, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5932, dtype=torch.float64) delta_t tensor(-1.3164, dtype=torch.float64)
5 gae_duplicate tensor(-1.6687, dtype=torch.float64) tensor(27.8450, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0698, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
4 gae_duplicate tensor(-0.4114, dtype=torch.float64) tensor(-0.9133, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1985, dtype=torch.float64) delta_t tensor(-1.0307, dtype=torch.float64)
3 gae_duplicate tensor(-1.8121, dtype=torch.float64) tensor(19.0568, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4107, dtype=torch.float64) delta_t tensor(0.5623, dtype=torch.float64)
2 gae_duplicate tensor(0.0211, dtype=torch.float64) tensor(-8.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-30.745943069458008
value loss:68.30160522460938
entropies:348.4434814453125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3936.2144)
ToM Target loss= tensor(2370.0103)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9442689418792725 seconds
19 rew tensor(1.1344, dtype=torch.float64) delta_t tensor(0.5482, dtype=torch.float64)
19 gae_duplicate tensor(0.3294, dtype=torch.float64) tensor(-10.2889, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1617, dtype=torch.float64) delta_t tensor(0.5947, dtype=torch.float64)
18 gae_duplicate tensor(0.4690, dtype=torch.float64) tensor(-11.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1014, dtype=torch.float64) delta_t tensor(0.5278, dtype=torch.float64)
17 gae_duplicate tensor(0.3993, dtype=torch.float64) tensor(-11.8525, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7687, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
16 gae_duplicate tensor(-0.7608, dtype=torch.float64) tensor(-4.1334, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.3899, dtype=torch.float64)
15 gae_duplicate tensor(0.2555, dtype=torch.float64) tensor(-8.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3994, dtype=torch.float64) delta_t tensor(-0.1121, dtype=torch.float64)
14 gae_duplicate tensor(-1.1697, dtype=torch.float64) tensor(0.8140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7525, dtype=torch.float64) delta_t tensor(0.2096, dtype=torch.float64)
13 gae_duplicate tensor(-0.1436, dtype=torch.float64) tensor(-3.7421, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2259, dtype=torch.float64) delta_t tensor(-0.1086, dtype=torch.float64)
12 gae_duplicate tensor(-0.4892, dtype=torch.float64) tensor(1.2782, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6438, dtype=torch.float64) delta_t tensor(0.1462, dtype=torch.float64)
11 gae_duplicate tensor(-0.2028, dtype=torch.float64) tensor(-2.3456, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1946, dtype=torch.float64) delta_t tensor(-0.1018, dtype=torch.float64)
10 gae_duplicate tensor(-0.2409, dtype=torch.float64) tensor(1.6106, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5324, dtype=torch.float64) delta_t tensor(0.6423, dtype=torch.float64)
9 gae_duplicate tensor(0.2771, dtype=torch.float64) tensor(-13.5871, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6608, dtype=torch.float64) delta_t tensor(-0.3749, dtype=torch.float64)
8 gae_duplicate tensor(-0.7306, dtype=torch.float64) tensor(6.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1776, dtype=torch.float64) delta_t tensor(-0.7984, dtype=torch.float64)
7 gae_duplicate tensor(-4.1999, dtype=torch.float64) tensor(15.1686, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7873, dtype=torch.float64) delta_t tensor(-0.4839, dtype=torch.float64)
6 gae_duplicate tensor(-1.3404, dtype=torch.float64) tensor(11.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4190, dtype=torch.float64) delta_t tensor(-1.1176, dtype=torch.float64)
5 gae_duplicate tensor(-1.5813, dtype=torch.float64) tensor(21.6551, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0444, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
4 gae_duplicate tensor(-0.5182, dtype=torch.float64) tensor(-2.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0741, dtype=torch.float64) delta_t tensor(-0.8824, dtype=torch.float64)
3 gae_duplicate tensor(-1.7506, dtype=torch.float64) tensor(16.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4246, dtype=torch.float64) delta_t tensor(0.6609, dtype=torch.float64)
2 gae_duplicate tensor(0.1295, dtype=torch.float64) tensor(-10.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:129.09957885742188
value loss:88.48039245605469
entropies:348.35150146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.073700904846191 seconds
19 rew tensor(1.2144, dtype=torch.float64) delta_t tensor(0.7341, dtype=torch.float64)
19 gae_duplicate tensor(0.3813, dtype=torch.float64) tensor(-14.8652, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1772, dtype=torch.float64) delta_t tensor(0.7328, dtype=torch.float64)
18 gae_duplicate tensor(0.3957, dtype=torch.float64) tensor(-14.8286, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8162, dtype=torch.float64) delta_t tensor(0.2849, dtype=torch.float64)
17 gae_duplicate tensor(-0.9835, dtype=torch.float64) tensor(-6.6506, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9716, dtype=torch.float64) delta_t tensor(0.3489, dtype=torch.float64)
16 gae_duplicate tensor(0.1235, dtype=torch.float64) tensor(-7.0453, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8923, dtype=torch.float64) delta_t tensor(0.3189, dtype=torch.float64)
15 gae_duplicate tensor(0.2748, dtype=torch.float64) tensor(-6.6779, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6963, dtype=torch.float64) delta_t tensor(0.1368, dtype=torch.float64)
14 gae_duplicate tensor(0.0716, dtype=torch.float64) tensor(-3.5599, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6944, dtype=torch.float64) delta_t tensor(0.2531, dtype=torch.float64)
13 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-5.0259, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3725, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
12 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(-0.9135, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2976, dtype=torch.float64) delta_t tensor(-0.1143, dtype=torch.float64)
11 gae_duplicate tensor(-0.2460, dtype=torch.float64) tensor(2.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0323, dtype=torch.float64) delta_t tensor(-0.0082, dtype=torch.float64)
10 gae_duplicate tensor(-0.5798, dtype=torch.float64) tensor(0.2340, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2308, dtype=torch.float64) delta_t tensor(0.3836, dtype=torch.float64)
9 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-7.3823, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4060, dtype=torch.float64) delta_t tensor(-0.0708, dtype=torch.float64)
8 gae_duplicate tensor(-0.6102, dtype=torch.float64) tensor(1.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5464, dtype=torch.float64) delta_t tensor(-0.1564, dtype=torch.float64)
7 gae_duplicate tensor(-1.6503, dtype=torch.float64) tensor(2.4979, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7565, dtype=torch.float64) delta_t tensor(-0.3940, dtype=torch.float64)
6 gae_duplicate tensor(-0.7746, dtype=torch.float64) tensor(7.7952, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2951, dtype=torch.float64) delta_t tensor(-1.0593, dtype=torch.float64)
5 gae_duplicate tensor(-1.9734, dtype=torch.float64) tensor(20.8554, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2056, dtype=torch.float64) delta_t tensor(-0.0828, dtype=torch.float64)
4 gae_duplicate tensor(-0.6304, dtype=torch.float64) tensor(3.7586, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5585, dtype=torch.float64) delta_t tensor(-0.4114, dtype=torch.float64)
3 gae_duplicate tensor(-1.6895, dtype=torch.float64) tensor(7.8423, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0130, dtype=torch.float64) delta_t tensor(0.0997, dtype=torch.float64)
2 gae_duplicate tensor(-0.8621, dtype=torch.float64) tensor(-1.1702, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1089.03564453125
value loss:60.77200698852539
entropies:348.505615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.42761492729187 seconds
19 rew tensor(1.0884, dtype=torch.float64) delta_t tensor(0.4066, dtype=torch.float64)
19 gae_duplicate tensor(0.2277, dtype=torch.float64) tensor(-7.8748, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1293, dtype=torch.float64) delta_t tensor(0.5340, dtype=torch.float64)
18 gae_duplicate tensor(0.3863, dtype=torch.float64) tensor(-12.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9976, dtype=torch.float64) delta_t tensor(0.3757, dtype=torch.float64)
17 gae_duplicate tensor(0.2026, dtype=torch.float64) tensor(-8.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8889, dtype=torch.float64) delta_t tensor(0.2370, dtype=torch.float64)
16 gae_duplicate tensor(0.1635, dtype=torch.float64) tensor(-5.7092, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9073, dtype=torch.float64) delta_t tensor(0.2859, dtype=torch.float64)
15 gae_duplicate tensor(0.1844, dtype=torch.float64) tensor(-6.5702, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5866, dtype=torch.float64) delta_t tensor(-0.0432, dtype=torch.float64)
14 gae_duplicate tensor(-0.1531, dtype=torch.float64) tensor(0.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7800, dtype=torch.float64) delta_t tensor(0.2169, dtype=torch.float64)
13 gae_duplicate tensor(-0.0093, dtype=torch.float64) tensor(-4.0714, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1897, dtype=torch.float64) delta_t tensor(-0.1212, dtype=torch.float64)
12 gae_duplicate tensor(-0.5122, dtype=torch.float64) tensor(1.7896, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6505, dtype=torch.float64) delta_t tensor(0.0727, dtype=torch.float64)
11 gae_duplicate tensor(-0.2422, dtype=torch.float64) tensor(-1.1498, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1224, dtype=torch.float64) delta_t tensor(-0.1845, dtype=torch.float64)
10 gae_duplicate tensor(-0.4905, dtype=torch.float64) tensor(3.2571, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4342, dtype=torch.float64) delta_t tensor(0.4804, dtype=torch.float64)
9 gae_duplicate tensor(0.2702, dtype=torch.float64) tensor(-8.7343, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6816, dtype=torch.float64) delta_t tensor(-0.3557, dtype=torch.float64)
8 gae_duplicate tensor(-0.7651, dtype=torch.float64) tensor(5.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1635, dtype=torch.float64) delta_t tensor(0.2512, dtype=torch.float64)
7 gae_duplicate tensor(-0.4336, dtype=torch.float64) tensor(-4.3476, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7206, dtype=torch.float64) delta_t tensor(-0.4240, dtype=torch.float64)
6 gae_duplicate tensor(-0.7232, dtype=torch.float64) tensor(8.4887, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2780, dtype=torch.float64) delta_t tensor(-0.9360, dtype=torch.float64)
5 gae_duplicate tensor(-1.3137, dtype=torch.float64) tensor(18.8868, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3153, dtype=torch.float64) delta_t tensor(-0.2197, dtype=torch.float64)
4 gae_duplicate tensor(-0.5977, dtype=torch.float64) tensor(6.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5283, dtype=torch.float64) delta_t tensor(-0.3615, dtype=torch.float64)
3 gae_duplicate tensor(-0.7853, dtype=torch.float64) tensor(7.6349, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0665, dtype=torch.float64) delta_t tensor(0.2156, dtype=torch.float64)
2 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-3.1709, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:479.599853515625
value loss:32.25202941894531
entropies:348.7701721191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052557706832886 seconds
19 rew tensor(1.1681, dtype=torch.float64) delta_t tensor(0.5486, dtype=torch.float64)
19 gae_duplicate tensor(0.3610, dtype=torch.float64) tensor(-11.2448, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1830, dtype=torch.float64) delta_t tensor(0.6184, dtype=torch.float64)
18 gae_duplicate tensor(0.4549, dtype=torch.float64) tensor(-13.0945, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0512, dtype=torch.float64) delta_t tensor(0.4353, dtype=torch.float64)
17 gae_duplicate tensor(0.2912, dtype=torch.float64) tensor(-9.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9496, dtype=torch.float64) delta_t tensor(0.2864, dtype=torch.float64)
16 gae_duplicate tensor(0.0840, dtype=torch.float64) tensor(-6.4185, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8551, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
15 gae_duplicate tensor(0.0549, dtype=torch.float64) tensor(-4.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7101, dtype=torch.float64) delta_t tensor(0.1592, dtype=torch.float64)
14 gae_duplicate tensor(-0.1476, dtype=torch.float64) tensor(-3.3475, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2127, dtype=torch.float64) delta_t tensor(-0.3055, dtype=torch.float64)
13 gae_duplicate tensor(-3.0660, dtype=torch.float64) tensor(4.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0196, dtype=torch.float64) delta_t tensor(-0.2012, dtype=torch.float64)
12 gae_duplicate tensor(-1.1619, dtype=torch.float64) tensor(4.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5646, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
11 gae_duplicate tensor(-0.5713, dtype=torch.float64) tensor(-0.0108, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0336, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
10 gae_duplicate tensor(-0.2963, dtype=torch.float64) tensor(0.8646, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5973, dtype=torch.float64) delta_t tensor(0.5830, dtype=torch.float64)
9 gae_duplicate tensor(0.3648, dtype=torch.float64) tensor(-11.4280, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.8172, dtype=torch.float64) delta_t tensor(-0.4591, dtype=torch.float64)
8 gae_duplicate tensor(-0.7140, dtype=torch.float64) tensor(7.3485, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.0258, dtype=torch.float64) delta_t tensor(0.4282, dtype=torch.float64)
7 gae_duplicate tensor(-0.2197, dtype=torch.float64) tensor(-8.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8719, dtype=torch.float64) delta_t tensor(-0.5683, dtype=torch.float64)
6 gae_duplicate tensor(-0.9515, dtype=torch.float64) tensor(10.2982, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1551, dtype=torch.float64) delta_t tensor(-0.8163, dtype=torch.float64)
5 gae_duplicate tensor(-1.3065, dtype=torch.float64) tensor(16.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4245, dtype=torch.float64) delta_t tensor(-0.2285, dtype=torch.float64)
4 gae_duplicate tensor(-0.6055, dtype=torch.float64) tensor(6.1051, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4409, dtype=torch.float64) delta_t tensor(-0.2660, dtype=torch.float64)
3 gae_duplicate tensor(-0.8913, dtype=torch.float64) tensor(6.8810, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0409, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
2 gae_duplicate tensor(-0.1835, dtype=torch.float64) tensor(-1.7555, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:594.2427368164062
value loss:53.437015533447266
entropies:349.04595947265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.157786130905151 seconds
19 rew tensor(1.1659, dtype=torch.float64) delta_t tensor(0.5240, dtype=torch.float64)
19 gae_duplicate tensor(0.2512, dtype=torch.float64) tensor(-9.6477, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1007, dtype=torch.float64) delta_t tensor(0.4635, dtype=torch.float64)
18 gae_duplicate tensor(0.2964, dtype=torch.float64) tensor(-9.6250, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0908, dtype=torch.float64) delta_t tensor(0.4530, dtype=torch.float64)
17 gae_duplicate tensor(0.2222, dtype=torch.float64) tensor(-9.3385, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9570, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
16 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-6.6022, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9238, dtype=torch.float64) delta_t tensor(0.2617, dtype=torch.float64)
15 gae_duplicate tensor(-0.0215, dtype=torch.float64) tensor(-5.6595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4423, dtype=torch.float64) delta_t tensor(-0.1967, dtype=torch.float64)
14 gae_duplicate tensor(-1.5345, dtype=torch.float64) tensor(2.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4350, dtype=torch.float64) delta_t tensor(-0.1715, dtype=torch.float64)
13 gae_duplicate tensor(-1.6595, dtype=torch.float64) tensor(3.5687, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4522, dtype=torch.float64) delta_t tensor(0.0417, dtype=torch.float64)
12 gae_duplicate tensor(-0.5386, dtype=torch.float64) tensor(-0.7867, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4608, dtype=torch.float64) delta_t tensor(-0.1020, dtype=torch.float64)
11 gae_duplicate tensor(-0.2706, dtype=torch.float64) tensor(1.9540, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0970, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
10 gae_duplicate tensor(-0.2685, dtype=torch.float64) tensor(-2.2542, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3428, dtype=torch.float64) delta_t tensor(0.4465, dtype=torch.float64)
9 gae_duplicate tensor(0.3692, dtype=torch.float64) tensor(-9.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6028, dtype=torch.float64) delta_t tensor(-0.2035, dtype=torch.float64)
8 gae_duplicate tensor(-0.5790, dtype=torch.float64) tensor(3.0997, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2278, dtype=torch.float64) delta_t tensor(-0.7744, dtype=torch.float64)
7 gae_duplicate tensor(-5.2884, dtype=torch.float64) tensor(18.8789, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7916, dtype=torch.float64) delta_t tensor(-0.4398, dtype=torch.float64)
6 gae_duplicate tensor(-1.5236, dtype=torch.float64) tensor(9.4342, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3987, dtype=torch.float64) delta_t tensor(-0.9943, dtype=torch.float64)
5 gae_duplicate tensor(-1.4361, dtype=torch.float64) tensor(20.2780, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1069, dtype=torch.float64) delta_t tensor(0.0261, dtype=torch.float64)
4 gae_duplicate tensor(-0.6267, dtype=torch.float64) tensor(1.4093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9068, dtype=torch.float64) delta_t tensor(-0.6222, dtype=torch.float64)
3 gae_duplicate tensor(-1.5451, dtype=torch.float64) tensor(12.3500, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2645, dtype=torch.float64) delta_t tensor(0.4473, dtype=torch.float64)
2 gae_duplicate tensor(-0.1663, dtype=torch.float64) tensor(-6.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-848.5653686523438
value loss:93.09541320800781
entropies:349.5168151855469
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3923.9258)
ToM Target loss= tensor(2370.2512)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.953462839126587 seconds
19 rew tensor(1.1354, dtype=torch.float64) delta_t tensor(0.4745, dtype=torch.float64)
19 gae_duplicate tensor(0.2270, dtype=torch.float64) tensor(-9.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1799, dtype=torch.float64) delta_t tensor(0.4909, dtype=torch.float64)
18 gae_duplicate tensor(0.4158, dtype=torch.float64) tensor(-10.8699, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0339, dtype=torch.float64) delta_t tensor(0.3587, dtype=torch.float64)
17 gae_duplicate tensor(0.3196, dtype=torch.float64) tensor(-7.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9717, dtype=torch.float64) delta_t tensor(0.2607, dtype=torch.float64)
16 gae_duplicate tensor(0.0590, dtype=torch.float64) tensor(-5.5986, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8924, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
15 gae_duplicate tensor(0.0682, dtype=torch.float64) tensor(-3.9591, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6914, dtype=torch.float64) delta_t tensor(0.0278, dtype=torch.float64)
14 gae_duplicate tensor(-0.1766, dtype=torch.float64) tensor(-0.9081, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7493, dtype=torch.float64) delta_t tensor(0.1165, dtype=torch.float64)
13 gae_duplicate tensor(-0.0168, dtype=torch.float64) tensor(-2.5832, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2439, dtype=torch.float64) delta_t tensor(-0.1116, dtype=torch.float64)
12 gae_duplicate tensor(-0.5820, dtype=torch.float64) tensor(1.9309, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5643, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
11 gae_duplicate tensor(-0.2436, dtype=torch.float64) tensor(-0.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1423, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
10 gae_duplicate tensor(-0.3895, dtype=torch.float64) tensor(1.3095, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4348, dtype=torch.float64) delta_t tensor(0.5801, dtype=torch.float64)
9 gae_duplicate tensor(0.3152, dtype=torch.float64) tensor(-10.7419, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6785, dtype=torch.float64) delta_t tensor(-0.3300, dtype=torch.float64)
8 gae_duplicate tensor(-0.5693, dtype=torch.float64) tensor(5.9239, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0087, dtype=torch.float64) delta_t tensor(-0.5807, dtype=torch.float64)
7 gae_duplicate tensor(-4.2086, dtype=torch.float64) tensor(11.4494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8827, dtype=torch.float64) delta_t tensor(-0.5055, dtype=torch.float64)
6 gae_duplicate tensor(-1.0269, dtype=torch.float64) tensor(11.1832, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3356, dtype=torch.float64) delta_t tensor(-0.9640, dtype=torch.float64)
5 gae_duplicate tensor(-1.4662, dtype=torch.float64) tensor(21.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1193, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
4 gae_duplicate tensor(-0.6762, dtype=torch.float64) tensor(1.9454, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9103, dtype=torch.float64) delta_t tensor(-0.5680, dtype=torch.float64)
3 gae_duplicate tensor(-1.6839, dtype=torch.float64) tensor(10.8277, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2523, dtype=torch.float64) delta_t tensor(0.4448, dtype=torch.float64)
2 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-7.2407, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-438.15960693359375
value loss:71.48875427246094
entropies:349.74005126953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.464150667190552 seconds
19 rew tensor(1.1578, dtype=torch.float64) delta_t tensor(0.4014, dtype=torch.float64)
19 gae_duplicate tensor(0.2671, dtype=torch.float64) tensor(-8.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1460, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
18 gae_duplicate tensor(0.3023, dtype=torch.float64) tensor(-9.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1073, dtype=torch.float64) delta_t tensor(0.4350, dtype=torch.float64)
17 gae_duplicate tensor(0.2741, dtype=torch.float64) tensor(-9.3276, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0051, dtype=torch.float64) delta_t tensor(0.3134, dtype=torch.float64)
16 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-6.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0311, dtype=torch.float64) delta_t tensor(0.3449, dtype=torch.float64)
15 gae_duplicate tensor(0.1413, dtype=torch.float64) tensor(-7.0364, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8331, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
14 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(-3.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0182, dtype=torch.float64) delta_t tensor(0.3614, dtype=torch.float64)
13 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-6.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2231, dtype=torch.float64) delta_t tensor(-0.2795, dtype=torch.float64)
12 gae_duplicate tensor(-0.5991, dtype=torch.float64) tensor(4.6900, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-1.0364, dtype=torch.float64) delta_t tensor(-1.6259, dtype=torch.float64)
11 gae_duplicate tensor(-5.7889, dtype=torch.float64) tensor(30.5156, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9533, dtype=torch.float64) delta_t tensor(-0.9587, dtype=torch.float64)
10 gae_duplicate tensor(-4.2076, dtype=torch.float64) tensor(22.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3243, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
9 gae_duplicate tensor(-0.0418, dtype=torch.float64) tensor(-6.8771, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4826, dtype=torch.float64) delta_t tensor(-0.1263, dtype=torch.float64)
8 gae_duplicate tensor(-0.2242, dtype=torch.float64) tensor(1.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9271, dtype=torch.float64) delta_t tensor(-0.4463, dtype=torch.float64)
7 gae_duplicate tensor(-1.4986, dtype=torch.float64) tensor(8.2713, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8112, dtype=torch.float64) delta_t tensor(-0.4339, dtype=torch.float64)
6 gae_duplicate tensor(-0.9969, dtype=torch.float64) tensor(8.8859, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3267, dtype=torch.float64) delta_t tensor(-0.8628, dtype=torch.float64)
5 gae_duplicate tensor(-1.4596, dtype=torch.float64) tensor(17.6643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1824, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
4 gae_duplicate tensor(-0.3143, dtype=torch.float64) tensor(0.8718, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8977, dtype=torch.float64) delta_t tensor(-0.5593, dtype=torch.float64)
3 gae_duplicate tensor(-1.0732, dtype=torch.float64) tensor(10.6857, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1881, dtype=torch.float64) delta_t tensor(0.3613, dtype=torch.float64)
2 gae_duplicate tensor(0.0985, dtype=torch.float64) tensor(-5.8732, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2387.25732421875
value loss:148.58970642089844
entropies:349.6702575683594
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.903619766235352 seconds
19 rew tensor(1.2387, dtype=torch.float64) delta_t tensor(0.5338, dtype=torch.float64)
19 gae_duplicate tensor(0.2857, dtype=torch.float64) tensor(-10.4383, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1996, dtype=torch.float64) delta_t tensor(0.5137, dtype=torch.float64)
18 gae_duplicate tensor(0.3760, dtype=torch.float64) tensor(-10.9292, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1084, dtype=torch.float64) delta_t tensor(0.3846, dtype=torch.float64)
17 gae_duplicate tensor(0.3133, dtype=torch.float64) tensor(-8.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9411, dtype=torch.float64) delta_t tensor(0.1994, dtype=torch.float64)
16 gae_duplicate tensor(0.0118, dtype=torch.float64) tensor(-4.8523, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8382, dtype=torch.float64) delta_t tensor(0.1646, dtype=torch.float64)
15 gae_duplicate tensor(-0.0006, dtype=torch.float64) tensor(-3.9041, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6285, dtype=torch.float64) delta_t tensor(-0.0328, dtype=torch.float64)
14 gae_duplicate tensor(-0.2060, dtype=torch.float64) tensor(0.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6032, dtype=torch.float64) delta_t tensor(0.0565, dtype=torch.float64)
13 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(-1.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2953, dtype=torch.float64) delta_t tensor(-0.1412, dtype=torch.float64)
12 gae_duplicate tensor(-0.5830, dtype=torch.float64) tensor(3.3408, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3754, dtype=torch.float64) delta_t tensor(-0.0138, dtype=torch.float64)
11 gae_duplicate tensor(-0.3424, dtype=torch.float64) tensor(0.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1005, dtype=torch.float64) delta_t tensor(0.1523, dtype=torch.float64)
10 gae_duplicate tensor(-0.3781, dtype=torch.float64) tensor(-2.4453, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1808, dtype=torch.float64) delta_t tensor(0.3411, dtype=torch.float64)
9 gae_duplicate tensor(-0.1046, dtype=torch.float64) tensor(-6.8989, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6523, dtype=torch.float64) delta_t tensor(-0.1399, dtype=torch.float64)
8 gae_duplicate tensor(-0.5114, dtype=torch.float64) tensor(1.9263, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6102, dtype=torch.float64) delta_t tensor(-0.1240, dtype=torch.float64)
7 gae_duplicate tensor(-1.5771, dtype=torch.float64) tensor(1.5858, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8426, dtype=torch.float64) delta_t tensor(-0.4007, dtype=torch.float64)
6 gae_duplicate tensor(-0.9183, dtype=torch.float64) tensor(7.6300, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3981, dtype=torch.float64) delta_t tensor(-0.9996, dtype=torch.float64)
5 gae_duplicate tensor(-1.8651, dtype=torch.float64) tensor(20.6770, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1215, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
4 gae_duplicate tensor(-0.7411, dtype=torch.float64) tensor(1.4283, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9548, dtype=torch.float64) delta_t tensor(-0.5089, dtype=torch.float64)
3 gae_duplicate tensor(-1.9091, dtype=torch.float64) tensor(9.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2335, dtype=torch.float64) delta_t tensor(0.3775, dtype=torch.float64)
2 gae_duplicate tensor(-0.2881, dtype=torch.float64) tensor(-6.2306, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:337.6600341796875
value loss:58.16795349121094
entropies:349.8848876953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.782812833786011 seconds
19 rew tensor(1.1988, dtype=torch.float64) delta_t tensor(0.4361, dtype=torch.float64)
19 gae_duplicate tensor(0.2706, dtype=torch.float64) tensor(-8.3979, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1767, dtype=torch.float64) delta_t tensor(0.4682, dtype=torch.float64)
18 gae_duplicate tensor(0.2418, dtype=torch.float64) tensor(-10.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1259, dtype=torch.float64) delta_t tensor(0.4168, dtype=torch.float64)
17 gae_duplicate tensor(0.2339, dtype=torch.float64) tensor(-9.1021, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9242, dtype=torch.float64) delta_t tensor(0.1702, dtype=torch.float64)
16 gae_duplicate tensor(0.0347, dtype=torch.float64) tensor(-4.4597, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9298, dtype=torch.float64) delta_t tensor(0.1877, dtype=torch.float64)
15 gae_duplicate tensor(0.1480, dtype=torch.float64) tensor(-3.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3805, dtype=torch.float64) delta_t tensor(-0.2988, dtype=torch.float64)
14 gae_duplicate tensor(-1.3138, dtype=torch.float64) tensor(5.3470, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1099, dtype=torch.float64) delta_t tensor(-0.4723, dtype=torch.float64)
13 gae_duplicate tensor(-3.2510, dtype=torch.float64) tensor(11.8411, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2431, dtype=torch.float64) delta_t tensor(-0.0149, dtype=torch.float64)
12 gae_duplicate tensor(-0.5926, dtype=torch.float64) tensor(1.1333, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5208, dtype=torch.float64) delta_t tensor(-0.0106, dtype=torch.float64)
11 gae_duplicate tensor(-0.2217, dtype=torch.float64) tensor(0.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0773, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
10 gae_duplicate tensor(-0.1864, dtype=torch.float64) tensor(-0.4192, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5508, dtype=torch.float64) delta_t tensor(0.6641, dtype=torch.float64)
9 gae_duplicate tensor(0.3946, dtype=torch.float64) tensor(-13.3972, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7367, dtype=torch.float64) delta_t tensor(-0.2507, dtype=torch.float64)
8 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(3.2587, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1505, dtype=torch.float64) delta_t tensor(0.3523, dtype=torch.float64)
7 gae_duplicate tensor(-0.7667, dtype=torch.float64) tensor(-6.1111, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9685, dtype=torch.float64) delta_t tensor(-0.5033, dtype=torch.float64)
6 gae_duplicate tensor(-0.6811, dtype=torch.float64) tensor(8.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1270, dtype=torch.float64) delta_t tensor(-0.6660, dtype=torch.float64)
5 gae_duplicate tensor(-1.1717, dtype=torch.float64) tensor(13.6326, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3479, dtype=torch.float64) delta_t tensor(-0.1112, dtype=torch.float64)
4 gae_duplicate tensor(-0.6503, dtype=torch.float64) tensor(3.5410, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5421, dtype=torch.float64) delta_t tensor(-0.2287, dtype=torch.float64)
3 gae_duplicate tensor(-1.1819, dtype=torch.float64) tensor(4.4747, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0438, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
2 gae_duplicate tensor(-0.6003, dtype=torch.float64) tensor(0.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:56.002403259277344
value loss:52.94914627075195
entropies:349.9350891113281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.103443145751953 seconds
19 rew tensor(1.2032, dtype=torch.float64) delta_t tensor(0.4093, dtype=torch.float64)
19 gae_duplicate tensor(0.1871, dtype=torch.float64) tensor(-8.0034, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1621, dtype=torch.float64) delta_t tensor(0.3686, dtype=torch.float64)
18 gae_duplicate tensor(0.2709, dtype=torch.float64) tensor(-7.4812, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9538, dtype=torch.float64) delta_t tensor(0.1522, dtype=torch.float64)
17 gae_duplicate tensor(0.0561, dtype=torch.float64) tensor(-3.6985, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9278, dtype=torch.float64) delta_t tensor(0.1353, dtype=torch.float64)
16 gae_duplicate tensor(0.0655, dtype=torch.float64) tensor(-3.2796, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8351, dtype=torch.float64) delta_t tensor(0.0550, dtype=torch.float64)
15 gae_duplicate tensor(-0.0803, dtype=torch.float64) tensor(-1.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8288, dtype=torch.float64) delta_t tensor(0.1080, dtype=torch.float64)
14 gae_duplicate tensor(-0.2895, dtype=torch.float64) tensor(-2.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5462, dtype=torch.float64) delta_t tensor(-0.1652, dtype=torch.float64)
13 gae_duplicate tensor(-0.3096, dtype=torch.float64) tensor(2.8943, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3155, dtype=torch.float64) delta_t tensor(-0.1404, dtype=torch.float64)
12 gae_duplicate tensor(-0.4051, dtype=torch.float64) tensor(2.9975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5083, dtype=torch.float64) delta_t tensor(-0.0729, dtype=torch.float64)
11 gae_duplicate tensor(-0.2918, dtype=torch.float64) tensor(1.7021, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0393, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
10 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-2.1555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4158, dtype=torch.float64) delta_t tensor(0.6292, dtype=torch.float64)
9 gae_duplicate tensor(0.4350, dtype=torch.float64) tensor(-12.7533, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6214, dtype=torch.float64) delta_t tensor(-0.1194, dtype=torch.float64)
8 gae_duplicate tensor(-0.5206, dtype=torch.float64) tensor(1.3567, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9197, dtype=torch.float64) delta_t tensor(-0.3100, dtype=torch.float64)
7 gae_duplicate tensor(-0.9902, dtype=torch.float64) tensor(7.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7167, dtype=torch.float64) delta_t tensor(-0.2063, dtype=torch.float64)
6 gae_duplicate tensor(-0.4736, dtype=torch.float64) tensor(5.1608, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5805, dtype=torch.float64) delta_t tensor(-1.0698, dtype=torch.float64)
5 gae_duplicate tensor(-1.5006, dtype=torch.float64) tensor(21.6714, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1381, dtype=torch.float64) delta_t tensor(0.2370, dtype=torch.float64)
4 gae_duplicate tensor(-0.3871, dtype=torch.float64) tensor(-2.7138, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2689, dtype=torch.float64) delta_t tensor(-0.8687, dtype=torch.float64)
3 gae_duplicate tensor(-1.3730, dtype=torch.float64) tensor(17.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5067, dtype=torch.float64) delta_t tensor(0.7430, dtype=torch.float64)
2 gae_duplicate tensor(0.2370, dtype=torch.float64) tensor(-12.3025, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-310.7027282714844
value loss:43.551021575927734
entropies:349.9009704589844
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3936.2573)
ToM Target loss= tensor(2339.4751)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.038080930709839 seconds
19 rew tensor(1.1361, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
19 gae_duplicate tensor(0.0503, dtype=torch.float64) tensor(-4.7934, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1373, dtype=torch.float64) delta_t tensor(0.3249, dtype=torch.float64)
18 gae_duplicate tensor(0.2147, dtype=torch.float64) tensor(-6.6243, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0060, dtype=torch.float64) delta_t tensor(0.2493, dtype=torch.float64)
17 gae_duplicate tensor(0.0631, dtype=torch.float64) tensor(-5.3383, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0231, dtype=torch.float64) delta_t tensor(0.2153, dtype=torch.float64)
16 gae_duplicate tensor(-0.0668, dtype=torch.float64) tensor(-5.0696, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7954, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
15 gae_duplicate tensor(0.0222, dtype=torch.float64) tensor(-1.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8516, dtype=torch.float64) delta_t tensor(0.0611, dtype=torch.float64)
14 gae_duplicate tensor(-0.2833, dtype=torch.float64) tensor(-1.0378, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5154, dtype=torch.float64) delta_t tensor(-0.1730, dtype=torch.float64)
13 gae_duplicate tensor(-0.4787, dtype=torch.float64) tensor(3.0220, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4323, dtype=torch.float64) delta_t tensor(-0.1235, dtype=torch.float64)
12 gae_duplicate tensor(-0.6377, dtype=torch.float64) tensor(2.5250, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3043, dtype=torch.float64) delta_t tensor(-0.2043, dtype=torch.float64)
11 gae_duplicate tensor(-0.4363, dtype=torch.float64) tensor(4.0461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1555, dtype=torch.float64) delta_t tensor(0.2942, dtype=torch.float64)
10 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-5.3667, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1271, dtype=torch.float64) delta_t tensor(0.3922, dtype=torch.float64)
9 gae_duplicate tensor(0.0443, dtype=torch.float64) tensor(-7.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4420, dtype=torch.float64) delta_t tensor(0.1199, dtype=torch.float64)
8 gae_duplicate tensor(-0.5363, dtype=torch.float64) tensor(-3.0049, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0778, dtype=torch.float64) delta_t tensor(-0.4478, dtype=torch.float64)
7 gae_duplicate tensor(-1.7508, dtype=torch.float64) tensor(7.9828, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5486, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
6 gae_duplicate tensor(-0.5526, dtype=torch.float64) tensor(0.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7367, dtype=torch.float64) delta_t tensor(-1.2056, dtype=torch.float64)
5 gae_duplicate tensor(-1.8900, dtype=torch.float64) tensor(22.9661, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1641, dtype=torch.float64) delta_t tensor(0.3179, dtype=torch.float64)
4 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(-3.6633, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2559, dtype=torch.float64) delta_t tensor(-0.8841, dtype=torch.float64)
3 gae_duplicate tensor(-1.6575, dtype=torch.float64) tensor(16.6901, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5459, dtype=torch.float64) delta_t tensor(0.6865, dtype=torch.float64)
2 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(-11.2864, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-210.95220947265625
value loss:53.52842330932617
entropies:349.67626953125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.101051092147827 seconds
19 rew tensor(1.2279, dtype=torch.float64) delta_t tensor(0.3246, dtype=torch.float64)
19 gae_duplicate tensor(0.1015, dtype=torch.float64) tensor(-6.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1917, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
18 gae_duplicate tensor(0.1424, dtype=torch.float64) tensor(-7.6005, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1918, dtype=torch.float64) delta_t tensor(0.3866, dtype=torch.float64)
17 gae_duplicate tensor(0.2241, dtype=torch.float64) tensor(-8.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9456, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
16 gae_duplicate tensor(-0.0675, dtype=torch.float64) tensor(-3.0763, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9109, dtype=torch.float64) delta_t tensor(0.1512, dtype=torch.float64)
15 gae_duplicate tensor(-0.0617, dtype=torch.float64) tensor(-3.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6714, dtype=torch.float64) delta_t tensor(-0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-0.2995, dtype=torch.float64) tensor(0.4068, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2369, dtype=torch.float64) delta_t tensor(-0.1785, dtype=torch.float64)
13 gae_duplicate tensor(-1.7417, dtype=torch.float64) tensor(3.1846, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4924, dtype=torch.float64) delta_t tensor(-0.0875, dtype=torch.float64)
12 gae_duplicate tensor(-0.6403, dtype=torch.float64) tensor(2.8379, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0906, dtype=torch.float64) delta_t tensor(-0.1568, dtype=torch.float64)
11 gae_duplicate tensor(-0.3895, dtype=torch.float64) tensor(3.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(0.4487, dtype=torch.float64)
10 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-7.9960, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0082, dtype=torch.float64) delta_t tensor(0.2757, dtype=torch.float64)
9 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(-5.7831, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4889, dtype=torch.float64) delta_t tensor(0.1211, dtype=torch.float64)
8 gae_duplicate tensor(-0.2176, dtype=torch.float64) tensor(-2.8750, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0993, dtype=torch.float64) delta_t tensor(-0.4548, dtype=torch.float64)
7 gae_duplicate tensor(-1.6898, dtype=torch.float64) tensor(7.2148, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6222, dtype=torch.float64) delta_t tensor(-0.0614, dtype=torch.float64)
6 gae_duplicate tensor(-0.4589, dtype=torch.float64) tensor(1.7321, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7475, dtype=torch.float64) delta_t tensor(-1.1888, dtype=torch.float64)
5 gae_duplicate tensor(-1.8529, dtype=torch.float64) tensor(25.2745, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1260, dtype=torch.float64) delta_t tensor(0.2345, dtype=torch.float64)
4 gae_duplicate tensor(-0.4278, dtype=torch.float64) tensor(-2.1695, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3438, dtype=torch.float64) delta_t tensor(-0.8273, dtype=torch.float64)
3 gae_duplicate tensor(-1.7506, dtype=torch.float64) tensor(15.0372, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4816, dtype=torch.float64) delta_t tensor(0.6013, dtype=torch.float64)
2 gae_duplicate tensor(0.0287, dtype=torch.float64) tensor(-9.6244, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-196.54141235351562
value loss:63.69286346435547
entropies:349.5072937011719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.758340120315552 seconds
19 rew tensor(1.2264, dtype=torch.float64) delta_t tensor(0.2981, dtype=torch.float64)
19 gae_duplicate tensor(0.1554, dtype=torch.float64) tensor(-6.1872, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2407, dtype=torch.float64) delta_t tensor(0.4030, dtype=torch.float64)
18 gae_duplicate tensor(0.2889, dtype=torch.float64) tensor(-7.8898, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1536, dtype=torch.float64) delta_t tensor(0.3098, dtype=torch.float64)
17 gae_duplicate tensor(0.1215, dtype=torch.float64) tensor(-6.5989, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0346, dtype=torch.float64) delta_t tensor(0.1902, dtype=torch.float64)
16 gae_duplicate tensor(0.0501, dtype=torch.float64) tensor(-4.0979, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9170, dtype=torch.float64) delta_t tensor(0.0815, dtype=torch.float64)
15 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-1.8766, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1760, dtype=torch.float64) delta_t tensor(-0.7913, dtype=torch.float64)
14 gae_duplicate tensor(-2.9186, dtype=torch.float64) tensor(14.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6873, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
13 gae_duplicate tensor(-0.4537, dtype=torch.float64) tensor(0.1508, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2831, dtype=torch.float64) delta_t tensor(0.0664, dtype=torch.float64)
12 gae_duplicate tensor(-0.2738, dtype=torch.float64) tensor(-1.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2093, dtype=torch.float64) delta_t tensor(-0.2924, dtype=torch.float64)
11 gae_duplicate tensor(-1.9516, dtype=torch.float64) tensor(5.3932, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0418, dtype=torch.float64) delta_t tensor(0.0797, dtype=torch.float64)
10 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(-0.9042, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5124, dtype=torch.float64) delta_t tensor(0.4252, dtype=torch.float64)
9 gae_duplicate tensor(0.0887, dtype=torch.float64) tensor(-7.8201, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7755, dtype=torch.float64) delta_t tensor(-0.2157, dtype=torch.float64)
8 gae_duplicate tensor(-0.4874, dtype=torch.float64) tensor(3.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6413, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
7 gae_duplicate tensor(-1.9527, dtype=torch.float64) tensor(-0.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9119, dtype=torch.float64) delta_t tensor(-0.3804, dtype=torch.float64)
6 gae_duplicate tensor(-0.9417, dtype=torch.float64) tensor(6.9760, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2746, dtype=torch.float64) delta_t tensor(-0.6717, dtype=torch.float64)
5 gae_duplicate tensor(-1.7229, dtype=torch.float64) tensor(13.1661, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2148, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
4 gae_duplicate tensor(-0.2036, dtype=torch.float64) tensor(-1.5259, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8173, dtype=torch.float64) delta_t tensor(-0.4461, dtype=torch.float64)
3 gae_duplicate tensor(-1.4737, dtype=torch.float64) tensor(7.9073, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1401, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
2 gae_duplicate tensor(-0.4533, dtype=torch.float64) tensor(-3.9094, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-613.01123046875
value loss:67.80177307128906
entropies:349.1529235839844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3817338943481445 seconds
19 rew tensor(1.2371, dtype=torch.float64) delta_t tensor(0.2861, dtype=torch.float64)
19 gae_duplicate tensor(0.0658, dtype=torch.float64) tensor(-5.9250, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1342, dtype=torch.float64) delta_t tensor(0.2752, dtype=torch.float64)
18 gae_duplicate tensor(0.1349, dtype=torch.float64) tensor(-5.6611, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1467, dtype=torch.float64) delta_t tensor(0.2939, dtype=torch.float64)
17 gae_duplicate tensor(0.1928, dtype=torch.float64) tensor(-6.2946, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6917, dtype=torch.float64) delta_t tensor(-0.1777, dtype=torch.float64)
16 gae_duplicate tensor(-1.5529, dtype=torch.float64) tensor(2.5973, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9394, dtype=torch.float64) delta_t tensor(0.1700, dtype=torch.float64)
15 gae_duplicate tensor(0.0454, dtype=torch.float64) tensor(-2.8631, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7819, dtype=torch.float64) delta_t tensor(-0.0203, dtype=torch.float64)
14 gae_duplicate tensor(-0.1331, dtype=torch.float64) tensor(0.0413, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0992, dtype=torch.float64) delta_t tensor(-0.5670, dtype=torch.float64)
13 gae_duplicate tensor(-1.8181, dtype=torch.float64) tensor(11.9910, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6208, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
12 gae_duplicate tensor(-0.3985, dtype=torch.float64) tensor(-1.0577, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0591, dtype=torch.float64) delta_t tensor(-0.1677, dtype=torch.float64)
11 gae_duplicate tensor(-0.3955, dtype=torch.float64) tensor(3.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4187, dtype=torch.float64) delta_t tensor(0.3043, dtype=torch.float64)
10 gae_duplicate tensor(-0.4609, dtype=torch.float64) tensor(-5.5406, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0252, dtype=torch.float64) delta_t tensor(0.3973, dtype=torch.float64)
9 gae_duplicate tensor(-0.1416, dtype=torch.float64) tensor(-7.7214, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4052, dtype=torch.float64) delta_t tensor(0.2264, dtype=torch.float64)
8 gae_duplicate tensor(-0.2255, dtype=torch.float64) tensor(-5.3632, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3210, dtype=torch.float64) delta_t tensor(-0.5898, dtype=torch.float64)
7 gae_duplicate tensor(-1.4326, dtype=torch.float64) tensor(10.3742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5383, dtype=torch.float64) delta_t tensor(0.0951, dtype=torch.float64)
6 gae_duplicate tensor(-0.4450, dtype=torch.float64) tensor(-0.9107, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8920, dtype=torch.float64) delta_t tensor(-1.2642, dtype=torch.float64)
5 gae_duplicate tensor(-1.8691, dtype=torch.float64) tensor(24.6961, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2633, dtype=torch.float64) delta_t tensor(0.3542, dtype=torch.float64)
4 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-4.2227, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5320, dtype=torch.float64) delta_t tensor(-1.0138, dtype=torch.float64)
3 gae_duplicate tensor(-1.3905, dtype=torch.float64) tensor(18.2245, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5910, dtype=torch.float64) delta_t tensor(0.7615, dtype=torch.float64)
2 gae_duplicate tensor(0.1566, dtype=torch.float64) tensor(-13.0909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-774.5603637695312
value loss:66.45680236816406
entropies:349.0467834472656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.248703956604004 seconds
19 rew tensor(1.2185, dtype=torch.float64) delta_t tensor(0.2483, dtype=torch.float64)
19 gae_duplicate tensor(0.0781, dtype=torch.float64) tensor(-4.5676, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2073, dtype=torch.float64) delta_t tensor(0.3297, dtype=torch.float64)
18 gae_duplicate tensor(0.1379, dtype=torch.float64) tensor(-7.0648, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1831, dtype=torch.float64) delta_t tensor(0.3006, dtype=torch.float64)
17 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-6.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1458, dtype=torch.float64) delta_t tensor(0.3318, dtype=torch.float64)
16 gae_duplicate tensor(0.1203, dtype=torch.float64) tensor(-6.8073, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9908, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
15 gae_duplicate tensor(-0.0123, dtype=torch.float64) tensor(-3.0448, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2652, dtype=torch.float64) delta_t tensor(-0.4414, dtype=torch.float64)
14 gae_duplicate tensor(-1.5145, dtype=torch.float64) tensor(7.9296, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3924, dtype=torch.float64) delta_t tensor(-0.3763, dtype=torch.float64)
13 gae_duplicate tensor(-1.5908, dtype=torch.float64) tensor(7.6127, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2107, dtype=torch.float64) delta_t tensor(-0.2387, dtype=torch.float64)
12 gae_duplicate tensor(-0.4629, dtype=torch.float64) tensor(5.1834, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5185, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
11 gae_duplicate tensor(-0.4697, dtype=torch.float64) tensor(-0.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2138, dtype=torch.float64) delta_t tensor(0.0338, dtype=torch.float64)
10 gae_duplicate tensor(-0.1649, dtype=torch.float64) tensor(-0.5747, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4774, dtype=torch.float64) delta_t tensor(0.7262, dtype=torch.float64)
9 gae_duplicate tensor(0.3396, dtype=torch.float64) tensor(-14.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5526, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
8 gae_duplicate tensor(-0.3296, dtype=torch.float64) tensor(-1.4827, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5321, dtype=torch.float64) delta_t tensor(-0.8146, dtype=torch.float64)
7 gae_duplicate tensor(-3.9892, dtype=torch.float64) tensor(14.9199, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8255, dtype=torch.float64) delta_t tensor(-0.1980, dtype=torch.float64)
6 gae_duplicate tensor(-1.0561, dtype=torch.float64) tensor(4.9794, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5275, dtype=torch.float64) delta_t tensor(-0.9671, dtype=torch.float64)
5 gae_duplicate tensor(-1.2769, dtype=torch.float64) tensor(18.3464, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0175, dtype=torch.float64) delta_t tensor(0.2338, dtype=torch.float64)
4 gae_duplicate tensor(-0.4592, dtype=torch.float64) tensor(-2.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1960, dtype=torch.float64) delta_t tensor(-0.6695, dtype=torch.float64)
3 gae_duplicate tensor(-1.5242, dtype=torch.float64) tensor(13.3718, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3580, dtype=torch.float64) delta_t tensor(0.4794, dtype=torch.float64)
2 gae_duplicate tensor(-0.3240, dtype=torch.float64) tensor(-8.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1024.3790283203125
value loss:77.1534194946289
entropies:348.7901306152344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3926.6809)
ToM Target loss= tensor(2319.9075)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.227718830108643 seconds
19 rew tensor(1.2024, dtype=torch.float64) delta_t tensor(0.2903, dtype=torch.float64)
19 gae_duplicate tensor(0.0970, dtype=torch.float64) tensor(-6.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2166, dtype=torch.float64) delta_t tensor(0.3801, dtype=torch.float64)
18 gae_duplicate tensor(0.1861, dtype=torch.float64) tensor(-7.8823, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1409, dtype=torch.float64) delta_t tensor(0.3107, dtype=torch.float64)
17 gae_duplicate tensor(0.0515, dtype=torch.float64) tensor(-7.6797, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0873, dtype=torch.float64) delta_t tensor(0.1928, dtype=torch.float64)
16 gae_duplicate tensor(-0.0954, dtype=torch.float64) tensor(-4.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0133, dtype=torch.float64) delta_t tensor(0.1470, dtype=torch.float64)
15 gae_duplicate tensor(-0.0725, dtype=torch.float64) tensor(-3.1288, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7367, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
14 gae_duplicate tensor(-0.2894, dtype=torch.float64) tensor(-3.3354, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6892, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
13 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(0.2959, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1908, dtype=torch.float64) delta_t tensor(-0.0798, dtype=torch.float64)
12 gae_duplicate tensor(-0.6300, dtype=torch.float64) tensor(1.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
11 gae_duplicate tensor(-0.0748, dtype=torch.float64) tensor(-1.6077, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0711, dtype=torch.float64) delta_t tensor(0.1969, dtype=torch.float64)
10 gae_duplicate tensor(-0.1669, dtype=torch.float64) tensor(-4.2474, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3484, dtype=torch.float64) delta_t tensor(0.6257, dtype=torch.float64)
9 gae_duplicate tensor(0.4378, dtype=torch.float64) tensor(-12.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6791, dtype=torch.float64) delta_t tensor(-0.0450, dtype=torch.float64)
8 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(-0.1289, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4575, dtype=torch.float64) delta_t tensor(-0.7688, dtype=torch.float64)
7 gae_duplicate tensor(-5.3080, dtype=torch.float64) tensor(13.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0089, dtype=torch.float64) delta_t tensor(-0.3806, dtype=torch.float64)
6 gae_duplicate tensor(-1.3087, dtype=torch.float64) tensor(8.4476, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3593, dtype=torch.float64) delta_t tensor(-0.6936, dtype=torch.float64)
5 gae_duplicate tensor(-1.3705, dtype=torch.float64) tensor(13.4509, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0933, dtype=torch.float64) delta_t tensor(0.2083, dtype=torch.float64)
4 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(-1.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0383, dtype=torch.float64) delta_t tensor(-0.4553, dtype=torch.float64)
3 gae_duplicate tensor(-1.5611, dtype=torch.float64) tensor(7.9365, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2082, dtype=torch.float64) delta_t tensor(0.3219, dtype=torch.float64)
2 gae_duplicate tensor(-1.2701, dtype=torch.float64) tensor(-5.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:588.0836791992188
value loss:90.16217803955078
entropies:348.78424072265625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.711156129837036 seconds
19 rew tensor(1.1395, dtype=torch.float64) delta_t tensor(0.1619, dtype=torch.float64)
19 gae_duplicate tensor(-0.0841, dtype=torch.float64) tensor(-3.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1419, dtype=torch.float64) delta_t tensor(0.2044, dtype=torch.float64)
18 gae_duplicate tensor(0.0013, dtype=torch.float64) tensor(-4.3844, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0881, dtype=torch.float64) delta_t tensor(0.1555, dtype=torch.float64)
17 gae_duplicate tensor(0.0731, dtype=torch.float64) tensor(-3.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9609, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
16 gae_duplicate tensor(-0.1272, dtype=torch.float64) tensor(-1.2687, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8786, dtype=torch.float64) delta_t tensor(-0.0089, dtype=torch.float64)
15 gae_duplicate tensor(-0.0974, dtype=torch.float64) tensor(0.0347, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6334, dtype=torch.float64) delta_t tensor(-0.1782, dtype=torch.float64)
14 gae_duplicate tensor(-0.3398, dtype=torch.float64) tensor(3.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3731, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
13 gae_duplicate tensor(-1.2822, dtype=torch.float64) tensor(5.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4042, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
12 gae_duplicate tensor(-0.4273, dtype=torch.float64) tensor(0.1010, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0688, dtype=torch.float64) delta_t tensor(-0.3722, dtype=torch.float64)
11 gae_duplicate tensor(-1.5198, dtype=torch.float64) tensor(6.6207, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2337, dtype=torch.float64) delta_t tensor(0.4517, dtype=torch.float64)
10 gae_duplicate tensor(-0.0323, dtype=torch.float64) tensor(-7.6762, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2122, dtype=torch.float64) delta_t tensor(0.4183, dtype=torch.float64)
9 gae_duplicate tensor(0.1176, dtype=torch.float64) tensor(-8.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6137, dtype=torch.float64) delta_t tensor(0.0890, dtype=torch.float64)
8 gae_duplicate tensor(-0.3542, dtype=torch.float64) tensor(-2.5269, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5881, dtype=torch.float64) delta_t tensor(0.1343, dtype=torch.float64)
7 gae_duplicate tensor(-1.1080, dtype=torch.float64) tensor(-2.6647, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6806, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
6 gae_duplicate tensor(-0.3718, dtype=torch.float64) tensor(-0.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5109, dtype=torch.float64) delta_t tensor(-0.8394, dtype=torch.float64)
5 gae_duplicate tensor(-1.6402, dtype=torch.float64) tensor(15.4774, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0948, dtype=torch.float64) delta_t tensor(0.1972, dtype=torch.float64)
4 gae_duplicate tensor(-0.2566, dtype=torch.float64) tensor(-2.0762, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9406, dtype=torch.float64) delta_t tensor(-0.3175, dtype=torch.float64)
3 gae_duplicate tensor(-1.1150, dtype=torch.float64) tensor(5.6983, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2706, dtype=torch.float64) delta_t tensor(0.2796, dtype=torch.float64)
2 gae_duplicate tensor(-0.3429, dtype=torch.float64) tensor(-4.4493, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:106.07614135742188
value loss:41.339454650878906
entropies:348.98162841796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.892697095870972 seconds
19 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
19 gae_duplicate tensor(-0.1102, dtype=torch.float64) tensor(-2.1076, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1278, dtype=torch.float64) delta_t tensor(0.1982, dtype=torch.float64)
18 gae_duplicate tensor(-0.0484, dtype=torch.float64) tensor(-4.2937, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0877, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
17 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-3.2267, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9973, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
16 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(-1.4215, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9338, dtype=torch.float64) delta_t tensor(0.0561, dtype=torch.float64)
15 gae_duplicate tensor(-0.0805, dtype=torch.float64) tensor(-1.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2130, dtype=torch.float64) delta_t tensor(-0.6230, dtype=torch.float64)
14 gae_duplicate tensor(-3.2312, dtype=torch.float64) tensor(14.1231, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4675, dtype=torch.float64) delta_t tensor(-0.1594, dtype=torch.float64)
13 gae_duplicate tensor(-0.5279, dtype=torch.float64) tensor(4.0716, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4840, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
12 gae_duplicate tensor(-0.2973, dtype=torch.float64) tensor(-0.8537, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2367, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
11 gae_duplicate tensor(-0.4530, dtype=torch.float64) tensor(2.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2363, dtype=torch.float64) delta_t tensor(0.4870, dtype=torch.float64)
10 gae_duplicate tensor(-0.0444, dtype=torch.float64) tensor(-8.7876, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2255, dtype=torch.float64) delta_t tensor(0.4585, dtype=torch.float64)
9 gae_duplicate tensor(0.1230, dtype=torch.float64) tensor(-9.9455, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5959, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
8 gae_duplicate tensor(-0.4832, dtype=torch.float64) tensor(-3.3895, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9032, dtype=torch.float64) delta_t tensor(-0.1274, dtype=torch.float64)
7 gae_duplicate tensor(-1.2607, dtype=torch.float64) tensor(1.4155, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6613, dtype=torch.float64) delta_t tensor(-0.0124, dtype=torch.float64)
6 gae_duplicate tensor(-0.4711, dtype=torch.float64) tensor(0.1198, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5769, dtype=torch.float64) delta_t tensor(-0.8669, dtype=torch.float64)
5 gae_duplicate tensor(-1.4168, dtype=torch.float64) tensor(17.8074, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1023, dtype=torch.float64) delta_t tensor(0.3042, dtype=torch.float64)
4 gae_duplicate tensor(-0.3171, dtype=torch.float64) tensor(-4.5931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1723, dtype=torch.float64) delta_t tensor(-0.6339, dtype=torch.float64)
3 gae_duplicate tensor(-1.3443, dtype=torch.float64) tensor(12.1355, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4671, dtype=torch.float64) delta_t tensor(0.6291, dtype=torch.float64)
2 gae_duplicate tensor(0.1387, dtype=torch.float64) tensor(-12.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-73.76688385009766
value loss:56.20428466796875
entropies:349.0086975097656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.097100019454956 seconds
19 rew tensor(1.1769, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
19 gae_duplicate tensor(-0.1536, dtype=torch.float64) tensor(-2.0318, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1247, dtype=torch.float64) delta_t tensor(0.1643, dtype=torch.float64)
18 gae_duplicate tensor(0.0335, dtype=torch.float64) tensor(-3.5967, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0204, dtype=torch.float64) delta_t tensor(0.0652, dtype=torch.float64)
17 gae_duplicate tensor(-0.1127, dtype=torch.float64) tensor(-1.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0100, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
16 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-0.8659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
15 gae_duplicate tensor(-0.2568, dtype=torch.float64) tensor(1.6425, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5981, dtype=torch.float64) delta_t tensor(-0.3007, dtype=torch.float64)
14 gae_duplicate tensor(-1.5546, dtype=torch.float64) tensor(5.8541, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1297, dtype=torch.float64) delta_t tensor(-0.8971, dtype=torch.float64)
13 gae_duplicate tensor(-4.5882, dtype=torch.float64) tensor(21.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2238, dtype=torch.float64) delta_t tensor(-0.4156, dtype=torch.float64)
12 gae_duplicate tensor(-1.5354, dtype=torch.float64) tensor(9.6796, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2660, dtype=torch.float64) delta_t tensor(-0.2536, dtype=torch.float64)
11 gae_duplicate tensor(-0.6504, dtype=torch.float64) tensor(5.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0481, dtype=torch.float64) delta_t tensor(0.3023, dtype=torch.float64)
10 gae_duplicate tensor(0.0233, dtype=torch.float64) tensor(-5.4176, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2138, dtype=torch.float64) delta_t tensor(0.5921, dtype=torch.float64)
9 gae_duplicate tensor(0.4444, dtype=torch.float64) tensor(-12.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5360, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
8 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-3.9533, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7261, dtype=torch.float64) delta_t tensor(0.0824, dtype=torch.float64)
7 gae_duplicate tensor(-0.5837, dtype=torch.float64) tensor(-2.7223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6286, dtype=torch.float64) delta_t tensor(0.0766, dtype=torch.float64)
6 gae_duplicate tensor(-0.2352, dtype=torch.float64) tensor(-1.9587, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6136, dtype=torch.float64) delta_t tensor(-0.8600, dtype=torch.float64)
5 gae_duplicate tensor(-1.4230, dtype=torch.float64) tensor(16.8134, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0463, dtype=torch.float64) delta_t tensor(0.2220, dtype=torch.float64)
4 gae_duplicate tensor(-0.0458, dtype=torch.float64) tensor(-2.5223, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0656, dtype=torch.float64) delta_t tensor(-0.4473, dtype=torch.float64)
3 gae_duplicate tensor(-0.7721, dtype=torch.float64) tensor(8.5969, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2659, dtype=torch.float64) delta_t tensor(0.2940, dtype=torch.float64)
2 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-4.7501, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1595.1810302734375
value loss:66.74800872802734
entropies:349.0703430175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.320828914642334 seconds
19 rew tensor(1.1911, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
19 gae_duplicate tensor(-0.0773, dtype=torch.float64) tensor(-2.6440, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1542, dtype=torch.float64) delta_t tensor(0.1927, dtype=torch.float64)
18 gae_duplicate tensor(-0.1329, dtype=torch.float64) tensor(-3.8429, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0515, dtype=torch.float64) delta_t tensor(0.0879, dtype=torch.float64)
17 gae_duplicate tensor(-0.1032, dtype=torch.float64) tensor(-2.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8934, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
16 gae_duplicate tensor(-0.1225, dtype=torch.float64) tensor(1.1620, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9359, dtype=torch.float64) delta_t tensor(-0.0092, dtype=torch.float64)
15 gae_duplicate tensor(-0.2287, dtype=torch.float64) tensor(0.2468, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7380, dtype=torch.float64) delta_t tensor(-0.1029, dtype=torch.float64)
14 gae_duplicate tensor(-0.3375, dtype=torch.float64) tensor(1.9275, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5817, dtype=torch.float64) delta_t tensor(-0.2104, dtype=torch.float64)
13 gae_duplicate tensor(-0.5019, dtype=torch.float64) tensor(4.5534, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3229, dtype=torch.float64) delta_t tensor(-0.1735, dtype=torch.float64)
12 gae_duplicate tensor(-0.4907, dtype=torch.float64) tensor(3.6411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3570, dtype=torch.float64) delta_t tensor(-0.1125, dtype=torch.float64)
11 gae_duplicate tensor(-0.2792, dtype=torch.float64) tensor(2.4478, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0648, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
10 gae_duplicate tensor(-0.1294, dtype=torch.float64) tensor(-4.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2784, dtype=torch.float64) delta_t tensor(0.7034, dtype=torch.float64)
9 gae_duplicate tensor(0.4771, dtype=torch.float64) tensor(-15.1052, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6546, dtype=torch.float64) delta_t tensor(0.0657, dtype=torch.float64)
8 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(-2.7365, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7933, dtype=torch.float64) delta_t tensor(0.0233, dtype=torch.float64)
7 gae_duplicate tensor(-1.2576, dtype=torch.float64) tensor(-0.7453, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7477, dtype=torch.float64) delta_t tensor(-0.0204, dtype=torch.float64)
6 gae_duplicate tensor(-0.2119, dtype=torch.float64) tensor(0.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5868, dtype=torch.float64) delta_t tensor(-0.8064, dtype=torch.float64)
5 gae_duplicate tensor(-1.5528, dtype=torch.float64) tensor(16.1669, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0618, dtype=torch.float64) delta_t tensor(0.2471, dtype=torch.float64)
4 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(-3.2965, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2798, dtype=torch.float64) delta_t tensor(-0.6110, dtype=torch.float64)
3 gae_duplicate tensor(-1.6125, dtype=torch.float64) tensor(11.6562, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3875, dtype=torch.float64) delta_t tensor(0.4196, dtype=torch.float64)
2 gae_duplicate tensor(-0.1089, dtype=torch.float64) tensor(-6.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-120.18094635009766
value loss:33.822933197021484
entropies:349.0762634277344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3915.9958)
ToM Target loss= tensor(2292.4817)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.088081121444702 seconds
19 rew tensor(1.1132, dtype=torch.float64) delta_t tensor(0.0141, dtype=torch.float64)
19 gae_duplicate tensor(-0.1037, dtype=torch.float64) tensor(-0.2601, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0872, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
18 gae_duplicate tensor(0.0331, dtype=torch.float64) tensor(-2.1294, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0117, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
17 gae_duplicate tensor(-0.1269, dtype=torch.float64) tensor(-0.8316, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9206, dtype=torch.float64) delta_t tensor(-0.0272, dtype=torch.float64)
16 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(0.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8957, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
15 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(0.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7022, dtype=torch.float64) delta_t tensor(-0.0616, dtype=torch.float64)
14 gae_duplicate tensor(-0.2797, dtype=torch.float64) tensor(1.3908, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7114, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
13 gae_duplicate tensor(-0.4016, dtype=torch.float64) tensor(2.1701, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2199, dtype=torch.float64) delta_t tensor(-0.2376, dtype=torch.float64)
12 gae_duplicate tensor(-0.5865, dtype=torch.float64) tensor(4.8071, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5418, dtype=torch.float64) delta_t tensor(-0.2114, dtype=torch.float64)
11 gae_duplicate tensor(-0.5285, dtype=torch.float64) tensor(4.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0424, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
10 gae_duplicate tensor(-0.3797, dtype=torch.float64) tensor(-1.4898, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3827, dtype=torch.float64) delta_t tensor(0.5394, dtype=torch.float64)
9 gae_duplicate tensor(0.2887, dtype=torch.float64) tensor(-10.1484, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6153, dtype=torch.float64) delta_t tensor(0.1010, dtype=torch.float64)
8 gae_duplicate tensor(-0.1969, dtype=torch.float64) tensor(-3.0349, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3781, dtype=torch.float64) delta_t tensor(0.4004, dtype=torch.float64)
7 gae_duplicate tensor(-0.5170, dtype=torch.float64) tensor(-7.5617, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7209, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
6 gae_duplicate tensor(-0.4285, dtype=torch.float64) tensor(-0.3411, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3299, dtype=torch.float64) delta_t tensor(-0.5803, dtype=torch.float64)
5 gae_duplicate tensor(-1.1936, dtype=torch.float64) tensor(11.1566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1994, dtype=torch.float64) delta_t tensor(0.1205, dtype=torch.float64)
4 gae_duplicate tensor(-0.2014, dtype=torch.float64) tensor(-1.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7065, dtype=torch.float64) delta_t tensor(-0.2481, dtype=torch.float64)
3 gae_duplicate tensor(-0.7855, dtype=torch.float64) tensor(4.9595, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1917, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
2 gae_duplicate tensor(-0.1744, dtype=torch.float64) tensor(-4.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-26.007986068725586
value loss:22.35169219970703
entropies:349.106689453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.200638055801392 seconds
19 rew tensor(1.2280, dtype=torch.float64) delta_t tensor(0.1497, dtype=torch.float64)
19 gae_duplicate tensor(-0.0229, dtype=torch.float64) tensor(-3.0365, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2045, dtype=torch.float64) delta_t tensor(0.2399, dtype=torch.float64)
18 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-4.8842, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1009, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
17 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-2.8668, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1153, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
16 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-3.2479, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0256, dtype=torch.float64) delta_t tensor(0.0684, dtype=torch.float64)
15 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-1.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9349, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
14 gae_duplicate tensor(-0.2551, dtype=torch.float64) tensor(-2.4187, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2141, dtype=torch.float64) delta_t tensor(-0.5831, dtype=torch.float64)
13 gae_duplicate tensor(-1.6954, dtype=torch.float64) tensor(11.0138, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3175, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
12 gae_duplicate tensor(-0.6319, dtype=torch.float64) tensor(-0.4664, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.1094, dtype=torch.float64) delta_t tensor(-0.6073, dtype=torch.float64)
11 gae_duplicate tensor(-2.5391, dtype=torch.float64) tensor(11.4520, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7969, dtype=torch.float64) delta_t tensor(-0.4330, dtype=torch.float64)
10 gae_duplicate tensor(-4.4979, dtype=torch.float64) tensor(12.8701, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2144, dtype=torch.float64) delta_t tensor(0.2058, dtype=torch.float64)
9 gae_duplicate tensor(-3.6235, dtype=torch.float64) tensor(-3.4647, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6034, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
8 gae_duplicate tensor(-0.1905, dtype=torch.float64) tensor(-2.3540, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6749, dtype=torch.float64) delta_t tensor(0.1677, dtype=torch.float64)
7 gae_duplicate tensor(-0.3864, dtype=torch.float64) tensor(-2.7912, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8313, dtype=torch.float64) delta_t tensor(-0.0881, dtype=torch.float64)
6 gae_duplicate tensor(-0.4738, dtype=torch.float64) tensor(1.3320, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5614, dtype=torch.float64) delta_t tensor(-0.7187, dtype=torch.float64)
5 gae_duplicate tensor(-1.1304, dtype=torch.float64) tensor(13.7518, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0571, dtype=torch.float64) delta_t tensor(0.2203, dtype=torch.float64)
4 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(-2.7637, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2166, dtype=torch.float64) delta_t tensor(-0.4163, dtype=torch.float64)
3 gae_duplicate tensor(-0.9669, dtype=torch.float64) tensor(7.5505, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2814, dtype=torch.float64) delta_t tensor(0.3574, dtype=torch.float64)
2 gae_duplicate tensor(-0.7073, dtype=torch.float64) tensor(-5.7361, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1310.4952392578125
value loss:102.95072937011719
entropies:348.9816589355469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.921857118606567 seconds
19 rew tensor(1.1266, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
19 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-0.1206, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1010, dtype=torch.float64) delta_t tensor(0.0956, dtype=torch.float64)
18 gae_duplicate tensor(-0.0474, dtype=torch.float64) tensor(-1.7592, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0227, dtype=torch.float64) delta_t tensor(0.0290, dtype=torch.float64)
17 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(-0.7695, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9475, dtype=torch.float64) delta_t tensor(-0.0157, dtype=torch.float64)
16 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(0.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8811, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
15 gae_duplicate tensor(-0.1644, dtype=torch.float64) tensor(1.8482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
14 gae_duplicate tensor(-0.2278, dtype=torch.float64) tensor(0.0994, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5074, dtype=torch.float64) delta_t tensor(-0.3816, dtype=torch.float64)
13 gae_duplicate tensor(-1.6664, dtype=torch.float64) tensor(7.0726, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2970, dtype=torch.float64) delta_t tensor(-0.1342, dtype=torch.float64)
12 gae_duplicate tensor(-0.6189, dtype=torch.float64) tensor(3.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5554, dtype=torch.float64) delta_t tensor(-0.1916, dtype=torch.float64)
11 gae_duplicate tensor(-0.4154, dtype=torch.float64) tensor(4.0426, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0951, dtype=torch.float64) delta_t tensor(0.1373, dtype=torch.float64)
10 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-2.5319, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4174, dtype=torch.float64) delta_t tensor(0.8069, dtype=torch.float64)
9 gae_duplicate tensor(0.5420, dtype=torch.float64) tensor(-16.8861, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5288, dtype=torch.float64) delta_t tensor(0.1361, dtype=torch.float64)
8 gae_duplicate tensor(-0.3129, dtype=torch.float64) tensor(-4.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6186, dtype=torch.float64) delta_t tensor(0.2523, dtype=torch.float64)
7 gae_duplicate tensor(0.0094, dtype=torch.float64) tensor(-5.0255, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6213, dtype=torch.float64) delta_t tensor(0.0798, dtype=torch.float64)
6 gae_duplicate tensor(-0.4034, dtype=torch.float64) tensor(-2.3669, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5040, dtype=torch.float64) delta_t tensor(-0.6717, dtype=torch.float64)
5 gae_duplicate tensor(-0.8936, dtype=torch.float64) tensor(12.6134, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0708, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
4 gae_duplicate tensor(-0.0967, dtype=torch.float64) tensor(-0.8344, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9377, dtype=torch.float64) delta_t tensor(-0.3391, dtype=torch.float64)
3 gae_duplicate tensor(-0.7486, dtype=torch.float64) tensor(6.8419, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2926, dtype=torch.float64) delta_t tensor(0.3295, dtype=torch.float64)
2 gae_duplicate tensor(0.1522, dtype=torch.float64) tensor(-5.8307, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:123.57347106933594
value loss:27.051097869873047
entropies:348.7657470703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.754308223724365 seconds
19 rew tensor(1.2272, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
19 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-2.4782, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2158, dtype=torch.float64) delta_t tensor(0.2222, dtype=torch.float64)
18 gae_duplicate tensor(-0.0608, dtype=torch.float64) tensor(-4.5860, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1529, dtype=torch.float64) delta_t tensor(0.1525, dtype=torch.float64)
17 gae_duplicate tensor(-0.1113, dtype=torch.float64) tensor(-3.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8327, dtype=torch.float64) delta_t tensor(-0.1456, dtype=torch.float64)
16 gae_duplicate tensor(-1.6276, dtype=torch.float64) tensor(2.0809, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9965, dtype=torch.float64) delta_t tensor(0.0465, dtype=torch.float64)
15 gae_duplicate tensor(-0.2167, dtype=torch.float64) tensor(-0.5879, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1576, dtype=torch.float64) delta_t tensor(-0.9158, dtype=torch.float64)
14 gae_duplicate tensor(-2.2445, dtype=torch.float64) tensor(17.0156, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0688, dtype=torch.float64) delta_t tensor(-0.8989, dtype=torch.float64)
13 gae_duplicate tensor(-4.3874, dtype=torch.float64) tensor(18.4311, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3993, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
12 gae_duplicate tensor(-0.4607, dtype=torch.float64) tensor(1.1008, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5043, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
11 gae_duplicate tensor(-0.4594, dtype=torch.float64) tensor(2.0286, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0973, dtype=torch.float64) delta_t tensor(0.1867, dtype=torch.float64)
10 gae_duplicate tensor(-0.1216, dtype=torch.float64) tensor(-3.6117, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5293, dtype=torch.float64) delta_t tensor(0.9515, dtype=torch.float64)
9 gae_duplicate tensor(0.6453, dtype=torch.float64) tensor(-20.8532, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5748, dtype=torch.float64) delta_t tensor(0.1017, dtype=torch.float64)
8 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-4.6673, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4960, dtype=torch.float64) delta_t tensor(-0.5513, dtype=torch.float64)
7 gae_duplicate tensor(-1.5860, dtype=torch.float64) tensor(11.1704, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7974, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
6 gae_duplicate tensor(-0.7354, dtype=torch.float64) tensor(1.3458, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6122, dtype=torch.float64) delta_t tensor(-0.7338, dtype=torch.float64)
5 gae_duplicate tensor(-1.0196, dtype=torch.float64) tensor(15.0340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1877, dtype=torch.float64) delta_t tensor(0.4569, dtype=torch.float64)
4 gae_duplicate tensor(0.0181, dtype=torch.float64) tensor(-7.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4536, dtype=torch.float64) delta_t tensor(-0.6872, dtype=torch.float64)
3 gae_duplicate tensor(-0.9831, dtype=torch.float64) tensor(12.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.5368, dtype=torch.float64)
2 gae_duplicate tensor(0.1486, dtype=torch.float64) tensor(-8.7542, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1371.654541015625
value loss:86.00298309326172
entropies:348.572998046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.798318862915039 seconds
19 rew tensor(1.2564, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
19 gae_duplicate tensor(-0.0440, dtype=torch.float64) tensor(-2.9717, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2707, dtype=torch.float64) delta_t tensor(0.2799, dtype=torch.float64)
18 gae_duplicate tensor(0.1413, dtype=torch.float64) tensor(-6.0727, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9108, dtype=torch.float64) delta_t tensor(-0.0722, dtype=torch.float64)
17 gae_duplicate tensor(-1.4805, dtype=torch.float64) tensor(0.8192, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0918, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
16 gae_duplicate tensor(-0.2794, dtype=torch.float64) tensor(-2.2231, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9471, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
15 gae_duplicate tensor(-0.2337, dtype=torch.float64) tensor(0.4877, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3105, dtype=torch.float64) delta_t tensor(-0.4331, dtype=torch.float64)
14 gae_duplicate tensor(-1.5227, dtype=torch.float64) tensor(7.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2685, dtype=torch.float64) delta_t tensor(-0.7649, dtype=torch.float64)
13 gae_duplicate tensor(-3.0346, dtype=torch.float64) tensor(14.8246, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0033, dtype=torch.float64) delta_t tensor(0.0105, dtype=torch.float64)
12 gae_duplicate tensor(-1.0432, dtype=torch.float64) tensor(1.9326, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3319, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
11 gae_duplicate tensor(-0.3267, dtype=torch.float64) tensor(0.3653, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0933, dtype=torch.float64) delta_t tensor(0.2682, dtype=torch.float64)
10 gae_duplicate tensor(0.0243, dtype=torch.float64) tensor(-5.2669, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6724, dtype=torch.float64) delta_t tensor(0.9250, dtype=torch.float64)
9 gae_duplicate tensor(0.3128, dtype=torch.float64) tensor(-19.3195, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.9166, dtype=torch.float64) delta_t tensor(-0.2004, dtype=torch.float64)
8 gae_duplicate tensor(-0.2850, dtype=torch.float64) tensor(2.0248, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4701, dtype=torch.float64) delta_t tensor(0.3811, dtype=torch.float64)
7 gae_duplicate tensor(-0.0669, dtype=torch.float64) tensor(-7.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9827, dtype=torch.float64) delta_t tensor(-0.2284, dtype=torch.float64)
6 gae_duplicate tensor(-0.5504, dtype=torch.float64) tensor(3.6228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3983, dtype=torch.float64) delta_t tensor(-0.4948, dtype=torch.float64)
5 gae_duplicate tensor(-0.7735, dtype=torch.float64) tensor(9.5443, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1246, dtype=torch.float64) delta_t tensor(0.3620, dtype=torch.float64)
4 gae_duplicate tensor(-0.2133, dtype=torch.float64) tensor(-5.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1270, dtype=torch.float64) delta_t tensor(-0.4095, dtype=torch.float64)
3 gae_duplicate tensor(-1.1127, dtype=torch.float64) tensor(8.3618, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2134, dtype=torch.float64) delta_t tensor(0.2955, dtype=torch.float64)
2 gae_duplicate tensor(-0.3640, dtype=torch.float64) tensor(-4.9022, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:123.71266174316406
value loss:62.05320358276367
entropies:348.6434326171875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3914.9624)
ToM Target loss= tensor(2257.9934)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.211158990859985 seconds
19 rew tensor(1.2160, dtype=torch.float64) delta_t tensor(0.0954, dtype=torch.float64)
19 gae_duplicate tensor(-0.0786, dtype=torch.float64) tensor(-1.7740, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2039, dtype=torch.float64) delta_t tensor(0.2175, dtype=torch.float64)
18 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-4.5717, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9123, dtype=torch.float64) delta_t tensor(-0.0959, dtype=torch.float64)
17 gae_duplicate tensor(-1.4593, dtype=torch.float64) tensor(1.3884, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0268, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
16 gae_duplicate tensor(-0.1855, dtype=torch.float64) tensor(-0.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9102, dtype=torch.float64) delta_t tensor(-0.0689, dtype=torch.float64)
15 gae_duplicate tensor(-0.2297, dtype=torch.float64) tensor(1.4079, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1464, dtype=torch.float64) delta_t tensor(-0.5410, dtype=torch.float64)
14 gae_duplicate tensor(-1.8470, dtype=torch.float64) tensor(10.2465, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7243, dtype=torch.float64) delta_t tensor(-0.1566, dtype=torch.float64)
13 gae_duplicate tensor(-0.4524, dtype=torch.float64) tensor(3.9340, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
12 gae_duplicate tensor(-0.3969, dtype=torch.float64) tensor(-0.3252, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6093, dtype=torch.float64) delta_t tensor(0.0130, dtype=torch.float64)
11 gae_duplicate tensor(-0.1691, dtype=torch.float64) tensor(-0.2890, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1596, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
10 gae_duplicate tensor(-0.0250, dtype=torch.float64) tensor(-2.6756, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4186, dtype=torch.float64) delta_t tensor(0.8637, dtype=torch.float64)
9 gae_duplicate tensor(0.5499, dtype=torch.float64) tensor(-18.3891, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5628, dtype=torch.float64) delta_t tensor(0.1799, dtype=torch.float64)
8 gae_duplicate tensor(-0.1049, dtype=torch.float64) tensor(-5.2130, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1182, dtype=torch.float64) delta_t tensor(-0.1705, dtype=torch.float64)
7 gae_duplicate tensor(-2.2050, dtype=torch.float64) tensor(1.9523, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6691, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
6 gae_duplicate tensor(-0.4123, dtype=torch.float64) tensor(-1.5055, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5527, dtype=torch.float64) delta_t tensor(-0.6806, dtype=torch.float64)
5 gae_duplicate tensor(-0.9468, dtype=torch.float64) tensor(12.8813, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1394, dtype=torch.float64) delta_t tensor(0.3689, dtype=torch.float64)
4 gae_duplicate tensor(0.0059, dtype=torch.float64) tensor(-6.1310, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2447, dtype=torch.float64) delta_t tensor(-0.6047, dtype=torch.float64)
3 gae_duplicate tensor(-1.1820, dtype=torch.float64) tensor(10.3326, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5039, dtype=torch.float64) delta_t tensor(0.5957, dtype=torch.float64)
2 gae_duplicate tensor(0.1443, dtype=torch.float64) tensor(-10.1562, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:416.8122863769531
value loss:47.58110809326172
entropies:348.8818664550781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0072550773620605 seconds
19 rew tensor(1.2547, dtype=torch.float64) delta_t tensor(0.1264, dtype=torch.float64)
19 gae_duplicate tensor(-0.0526, dtype=torch.float64) tensor(-2.3468, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2303, dtype=torch.float64) delta_t tensor(0.2116, dtype=torch.float64)
18 gae_duplicate tensor(0.0637, dtype=torch.float64) tensor(-4.1229, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1387, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
17 gae_duplicate tensor(-0.0511, dtype=torch.float64) tensor(-2.8735, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9987, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
16 gae_duplicate tensor(-0.1733, dtype=torch.float64) tensor(-0.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8939, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
15 gae_duplicate tensor(-0.2910, dtype=torch.float64) tensor(-3.3611, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4821, dtype=torch.float64) delta_t tensor(-0.1408, dtype=torch.float64)
14 gae_duplicate tensor(-0.6728, dtype=torch.float64) tensor(2.4334, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5153, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
13 gae_duplicate tensor(-0.2392, dtype=torch.float64) tensor(0.0765, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4403, dtype=torch.float64) delta_t tensor(0.2543, dtype=torch.float64)
12 gae_duplicate tensor(-0.2182, dtype=torch.float64) tensor(-4.6840, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0640, dtype=torch.float64) delta_t tensor(-0.3993, dtype=torch.float64)
11 gae_duplicate tensor(-1.5592, dtype=torch.float64) tensor(6.9662, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0405, dtype=torch.float64) delta_t tensor(0.3236, dtype=torch.float64)
10 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-5.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2022, dtype=torch.float64) delta_t tensor(0.5533, dtype=torch.float64)
9 gae_duplicate tensor(0.0672, dtype=torch.float64) tensor(-10.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5329, dtype=torch.float64) delta_t tensor(0.2307, dtype=torch.float64)
8 gae_duplicate tensor(0.0556, dtype=torch.float64) tensor(-5.7659, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1915, dtype=torch.float64) delta_t tensor(-0.3409, dtype=torch.float64)
7 gae_duplicate tensor(-2.0454, dtype=torch.float64) tensor(5.8473, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7726, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
6 gae_duplicate tensor(-0.6197, dtype=torch.float64) tensor(1.3422, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5746, dtype=torch.float64) delta_t tensor(-0.6971, dtype=torch.float64)
5 gae_duplicate tensor(-1.4965, dtype=torch.float64) tensor(13.7862, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0327, dtype=torch.float64) delta_t tensor(0.3462, dtype=torch.float64)
4 gae_duplicate tensor(-0.1050, dtype=torch.float64) tensor(-5.7816, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1999, dtype=torch.float64) delta_t tensor(-0.4273, dtype=torch.float64)
3 gae_duplicate tensor(-1.4375, dtype=torch.float64) tensor(7.4163, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3840, dtype=torch.float64) delta_t tensor(0.5066, dtype=torch.float64)
2 gae_duplicate tensor(-0.0312, dtype=torch.float64) tensor(-9.1440, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:821.7670288085938
value loss:49.54045486450195
entropies:349.2438659667969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.748913049697876 seconds
19 rew tensor(1.1883, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
19 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(-1.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1379, dtype=torch.float64) delta_t tensor(0.1221, dtype=torch.float64)
18 gae_duplicate tensor(0.0345, dtype=torch.float64) tensor(-2.4465, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0350, dtype=torch.float64) delta_t tensor(0.0372, dtype=torch.float64)
17 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-1.0421, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
16 gae_duplicate tensor(-0.1678, dtype=torch.float64) tensor(-0.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7782, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
15 gae_duplicate tensor(-0.2563, dtype=torch.float64) tensor(0.8130, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8289, dtype=torch.float64) delta_t tensor(0.1453, dtype=torch.float64)
14 gae_duplicate tensor(-0.1904, dtype=torch.float64) tensor(-2.9721, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5434, dtype=torch.float64) delta_t tensor(-0.0755, dtype=torch.float64)
13 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(1.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3738, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
12 gae_duplicate tensor(-0.2635, dtype=torch.float64) tensor(-0.3965, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1168, dtype=torch.float64) delta_t tensor(-0.0654, dtype=torch.float64)
11 gae_duplicate tensor(-0.4475, dtype=torch.float64) tensor(1.3768, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2042, dtype=torch.float64) delta_t tensor(0.4795, dtype=torch.float64)
10 gae_duplicate tensor(0.1067, dtype=torch.float64) tensor(-9.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1201, dtype=torch.float64) delta_t tensor(0.5273, dtype=torch.float64)
9 gae_duplicate tensor(0.3759, dtype=torch.float64) tensor(-12.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3820, dtype=torch.float64) delta_t tensor(0.3945, dtype=torch.float64)
8 gae_duplicate tensor(-0.0257, dtype=torch.float64) tensor(-8.8845, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9414, dtype=torch.float64) delta_t tensor(-0.0093, dtype=torch.float64)
7 gae_duplicate tensor(-0.5644, dtype=torch.float64) tensor(-0.5823, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6945, dtype=torch.float64) delta_t tensor(0.1582, dtype=torch.float64)
6 gae_duplicate tensor(-0.3978, dtype=torch.float64) tensor(-3.0008, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5705, dtype=torch.float64) delta_t tensor(-0.7098, dtype=torch.float64)
5 gae_duplicate tensor(-1.1989, dtype=torch.float64) tensor(12.7464, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0480, dtype=torch.float64) delta_t tensor(0.2772, dtype=torch.float64)
4 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-3.8251, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0260, dtype=torch.float64) delta_t tensor(-0.2497, dtype=torch.float64)
3 gae_duplicate tensor(-0.7525, dtype=torch.float64) tensor(4.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2380, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
2 gae_duplicate tensor(-1.1456, dtype=torch.float64) tensor(-2.7868, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1444.349365234375
value loss:35.28607177734375
entropies:349.7171630859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.962003231048584 seconds
19 rew tensor(1.1992, dtype=torch.float64) delta_t tensor(0.0966, dtype=torch.float64)
19 gae_duplicate tensor(-0.0666, dtype=torch.float64) tensor(-1.7776, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2005, dtype=torch.float64) delta_t tensor(0.1841, dtype=torch.float64)
18 gae_duplicate tensor(-0.0167, dtype=torch.float64) tensor(-3.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0596, dtype=torch.float64) delta_t tensor(0.0583, dtype=torch.float64)
17 gae_duplicate tensor(-0.1605, dtype=torch.float64) tensor(-1.3242, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0051, dtype=torch.float64) delta_t tensor(0.0356, dtype=torch.float64)
16 gae_duplicate tensor(-0.1978, dtype=torch.float64) tensor(-0.7643, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9161, dtype=torch.float64) delta_t tensor(-0.0564, dtype=torch.float64)
15 gae_duplicate tensor(-0.2325, dtype=torch.float64) tensor(0.9634, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5028, dtype=torch.float64) delta_t tensor(-0.1398, dtype=torch.float64)
14 gae_duplicate tensor(-1.7593, dtype=torch.float64) tensor(2.7686, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7736, dtype=torch.float64) delta_t tensor(-0.0783, dtype=torch.float64)
13 gae_duplicate tensor(-0.4616, dtype=torch.float64) tensor(1.6485, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3804, dtype=torch.float64) delta_t tensor(0.1080, dtype=torch.float64)
12 gae_duplicate tensor(-0.2664, dtype=torch.float64) tensor(-1.7797, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6683, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
11 gae_duplicate tensor(-0.4491, dtype=torch.float64) tensor(-1.7395, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.7774, dtype=torch.float64) delta_t tensor(-0.5331, dtype=torch.float64)
10 gae_duplicate tensor(-3.7420, dtype=torch.float64) tensor(9.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.6531, dtype=torch.float64) delta_t tensor(-0.4380, dtype=torch.float64)
9 gae_duplicate tensor(-6.0933, dtype=torch.float64) tensor(8.3365, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5765, dtype=torch.float64) delta_t tensor(0.2057, dtype=torch.float64)
8 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-2.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1908, dtype=torch.float64) delta_t tensor(0.6016, dtype=torch.float64)
7 gae_duplicate tensor(-0.3056, dtype=torch.float64) tensor(-13.4726, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8971, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
6 gae_duplicate tensor(-0.4230, dtype=torch.float64) tensor(1.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2449, dtype=torch.float64) delta_t tensor(-0.3976, dtype=torch.float64)
5 gae_duplicate tensor(-0.9426, dtype=torch.float64) tensor(7.6141, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3788, dtype=torch.float64) delta_t tensor(0.1019, dtype=torch.float64)
4 gae_duplicate tensor(-0.1278, dtype=torch.float64) tensor(-1.1531, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6213, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
3 gae_duplicate tensor(-0.5361, dtype=torch.float64) tensor(-0.9448, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0150, dtype=torch.float64) delta_t tensor(0.0332, dtype=torch.float64)
2 gae_duplicate tensor(-0.4927, dtype=torch.float64) tensor(-0.3915, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-229.21189880371094
value loss:103.21692657470703
entropies:350.2098388671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.590273141860962 seconds
19 rew tensor(1.1208, dtype=torch.float64) delta_t tensor(-0.0555, dtype=torch.float64)
19 gae_duplicate tensor(-0.2380, dtype=torch.float64) tensor(1.1196, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1213, dtype=torch.float64) delta_t tensor(0.0737, dtype=torch.float64)
18 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-1.2719, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1110, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
17 gae_duplicate tensor(-0.0419, dtype=torch.float64) tensor(-1.4448, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9946, dtype=torch.float64) delta_t tensor(-0.0165, dtype=torch.float64)
16 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(0.1297, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8588, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
15 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(2.0196, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4384, dtype=torch.float64) delta_t tensor(-0.4370, dtype=torch.float64)
14 gae_duplicate tensor(-1.8547, dtype=torch.float64) tensor(8.6115, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6888, dtype=torch.float64) delta_t tensor(-0.1002, dtype=torch.float64)
13 gae_duplicate tensor(-0.3647, dtype=torch.float64) tensor(2.6723, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3580, dtype=torch.float64) delta_t tensor(-0.0900, dtype=torch.float64)
12 gae_duplicate tensor(-0.4516, dtype=torch.float64) tensor(2.0213, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3915, dtype=torch.float64) delta_t tensor(-0.1716, dtype=torch.float64)
11 gae_duplicate tensor(-0.4640, dtype=torch.float64) tensor(3.7603, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0603, dtype=torch.float64) delta_t tensor(0.1679, dtype=torch.float64)
10 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-2.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2104, dtype=torch.float64) delta_t tensor(0.5563, dtype=torch.float64)
9 gae_duplicate tensor(0.1168, dtype=torch.float64) tensor(-11.7773, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3288, dtype=torch.float64) delta_t tensor(0.3714, dtype=torch.float64)
8 gae_duplicate tensor(0.2871, dtype=torch.float64) tensor(-8.3041, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8547, dtype=torch.float64) delta_t tensor(0.0425, dtype=torch.float64)
7 gae_duplicate tensor(-0.6556, dtype=torch.float64) tensor(-1.6479, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5487, dtype=torch.float64) delta_t tensor(0.2151, dtype=torch.float64)
6 gae_duplicate tensor(-0.2771, dtype=torch.float64) tensor(-4.3869, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5998, dtype=torch.float64) delta_t tensor(-0.7417, dtype=torch.float64)
5 gae_duplicate tensor(-1.1224, dtype=torch.float64) tensor(13.3655, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0467, dtype=torch.float64) delta_t tensor(0.2103, dtype=torch.float64)
4 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-2.6739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9117, dtype=torch.float64) delta_t tensor(-0.2049, dtype=torch.float64)
3 gae_duplicate tensor(-0.7185, dtype=torch.float64) tensor(3.5483, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2907, dtype=torch.float64) delta_t tensor(0.2826, dtype=torch.float64)
2 gae_duplicate tensor(-0.4854, dtype=torch.float64) tensor(-4.9821, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:11.949357032775879
value loss:27.557119369506836
entropies:350.8446044921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3924.0408)
ToM Target loss= tensor(2235.8154)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.266355991363525 seconds
19 rew tensor(1.2265, dtype=torch.float64) delta_t tensor(0.0742, dtype=torch.float64)
19 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-1.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2148, dtype=torch.float64) delta_t tensor(0.1684, dtype=torch.float64)
18 gae_duplicate tensor(0.0664, dtype=torch.float64) tensor(-3.3986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1372, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
17 gae_duplicate tensor(-0.0581, dtype=torch.float64) tensor(-2.5818, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0482, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
16 gae_duplicate tensor(-0.0854, dtype=torch.float64) tensor(-0.7698, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8945, dtype=torch.float64) delta_t tensor(0.0631, dtype=torch.float64)
15 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(-1.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.1041, dtype=torch.float64) delta_t tensor(-0.7701, dtype=torch.float64)
14 gae_duplicate tensor(-1.9172, dtype=torch.float64) tensor(15.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4897, dtype=torch.float64) delta_t tensor(0.0175, dtype=torch.float64)
13 gae_duplicate tensor(-0.5989, dtype=torch.float64) tensor(1.1295, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4034, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
12 gae_duplicate tensor(-0.1034, dtype=torch.float64) tensor(-2.5376, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4371, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
11 gae_duplicate tensor(-0.1948, dtype=torch.float64) tensor(-0.8454, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0789, dtype=torch.float64) delta_t tensor(0.2163, dtype=torch.float64)
10 gae_duplicate tensor(0.0359, dtype=torch.float64) tensor(-4.1397, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4621, dtype=torch.float64) delta_t tensor(0.7830, dtype=torch.float64)
9 gae_duplicate tensor(0.4142, dtype=torch.float64) tensor(-15.0654, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6108, dtype=torch.float64) delta_t tensor(0.1311, dtype=torch.float64)
8 gae_duplicate tensor(-0.1245, dtype=torch.float64) tensor(-4.3088, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8747, dtype=torch.float64) delta_t tensor(0.0822, dtype=torch.float64)
7 gae_duplicate tensor(-0.5741, dtype=torch.float64) tensor(-2.0276, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7160, dtype=torch.float64) delta_t tensor(0.0918, dtype=torch.float64)
6 gae_duplicate tensor(-0.2204, dtype=torch.float64) tensor(-1.7511, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6029, dtype=torch.float64) delta_t tensor(-0.6820, dtype=torch.float64)
5 gae_duplicate tensor(-1.1932, dtype=torch.float64) tensor(13.3038, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0861, dtype=torch.float64) delta_t tensor(0.2932, dtype=torch.float64)
4 gae_duplicate tensor(-0.1153, dtype=torch.float64) tensor(-4.1671, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2657, dtype=torch.float64) delta_t tensor(-0.4507, dtype=torch.float64)
3 gae_duplicate tensor(-0.7078, dtype=torch.float64) tensor(8.6251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
2 gae_duplicate tensor(-0.2060, dtype=torch.float64) tensor(-7.1894, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:633.4594116210938
value loss:38.60039138793945
entropies:351.4211120605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.098622798919678 seconds
19 rew tensor(1.1223, dtype=torch.float64) delta_t tensor(-0.0635, dtype=torch.float64)
19 gae_duplicate tensor(-0.2318, dtype=torch.float64) tensor(1.1845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1129, dtype=torch.float64) delta_t tensor(0.0522, dtype=torch.float64)
18 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-1.0167, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0229, dtype=torch.float64) delta_t tensor(-0.0206, dtype=torch.float64)
17 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(0.4078, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9955, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
16 gae_duplicate tensor(-0.2358, dtype=torch.float64) tensor(-0.0774, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8694, dtype=torch.float64) delta_t tensor(-0.0613, dtype=torch.float64)
15 gae_duplicate tensor(-0.3066, dtype=torch.float64) tensor(1.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4523, dtype=torch.float64) delta_t tensor(-0.2448, dtype=torch.float64)
14 gae_duplicate tensor(-1.6772, dtype=torch.float64) tensor(5.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(-0.0705, dtype=torch.float64)
13 gae_duplicate tensor(-0.3791, dtype=torch.float64) tensor(1.7487, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2722, dtype=torch.float64) delta_t tensor(-0.1231, dtype=torch.float64)
12 gae_duplicate tensor(-0.2914, dtype=torch.float64) tensor(2.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4778, dtype=torch.float64) delta_t tensor(-0.1403, dtype=torch.float64)
11 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(3.0822, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0779, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
10 gae_duplicate tensor(-0.0986, dtype=torch.float64) tensor(-2.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2920, dtype=torch.float64) delta_t tensor(0.6698, dtype=torch.float64)
9 gae_duplicate tensor(0.4844, dtype=torch.float64) tensor(-12.9509, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4848, dtype=torch.float64) delta_t tensor(0.2479, dtype=torch.float64)
8 gae_duplicate tensor(0.1563, dtype=torch.float64) tensor(-6.1427, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4978, dtype=torch.float64) delta_t tensor(0.3679, dtype=torch.float64)
7 gae_duplicate tensor(-0.3851, dtype=torch.float64) tensor(-7.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7302, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
6 gae_duplicate tensor(-0.3032, dtype=torch.float64) tensor(-1.6263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3463, dtype=torch.float64) delta_t tensor(-0.6129, dtype=torch.float64)
5 gae_duplicate tensor(-1.0309, dtype=torch.float64) tensor(11.7643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1999, dtype=torch.float64) delta_t tensor(0.1688, dtype=torch.float64)
4 gae_duplicate tensor(-0.0856, dtype=torch.float64) tensor(-2.2134, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6329, dtype=torch.float64) delta_t tensor(0.0974, dtype=torch.float64)
3 gae_duplicate tensor(-0.5020, dtype=torch.float64) tensor(-1.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0740, dtype=torch.float64) delta_t tensor(0.0472, dtype=torch.float64)
2 gae_duplicate tensor(-0.6353, dtype=torch.float64) tensor(-0.9370, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:377.0069274902344
value loss:23.69017219543457
entropies:351.79644775390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.203351974487305 seconds
19 rew tensor(1.1470, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
19 gae_duplicate tensor(-0.2399, dtype=torch.float64) tensor(0.4138, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1746, dtype=torch.float64) delta_t tensor(0.1252, dtype=torch.float64)
18 gae_duplicate tensor(-0.0578, dtype=torch.float64) tensor(-2.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0717, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
17 gae_duplicate tensor(-0.1240, dtype=torch.float64) tensor(-0.7704, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0334, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
16 gae_duplicate tensor(-0.1061, dtype=torch.float64) tensor(-0.8015, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9588, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
15 gae_duplicate tensor(-0.3187, dtype=torch.float64) tensor(1.0479, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7255, dtype=torch.float64) delta_t tensor(0.1317, dtype=torch.float64)
14 gae_duplicate tensor(-0.2345, dtype=torch.float64) tensor(-2.3398, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6567, dtype=torch.float64) delta_t tensor(-0.2088, dtype=torch.float64)
13 gae_duplicate tensor(-0.3800, dtype=torch.float64) tensor(4.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3119, dtype=torch.float64) delta_t tensor(0.1333, dtype=torch.float64)
12 gae_duplicate tensor(-0.4169, dtype=torch.float64) tensor(-2.2607, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5497, dtype=torch.float64) delta_t tensor(-0.1094, dtype=torch.float64)
11 gae_duplicate tensor(-0.4949, dtype=torch.float64) tensor(1.6372, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1549, dtype=torch.float64) delta_t tensor(0.1394, dtype=torch.float64)
10 gae_duplicate tensor(-0.1379, dtype=torch.float64) tensor(-2.5038, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5133, dtype=torch.float64) delta_t tensor(0.7932, dtype=torch.float64)
9 gae_duplicate tensor(0.2033, dtype=torch.float64) tensor(-15.1772, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6343, dtype=torch.float64) delta_t tensor(0.0792, dtype=torch.float64)
8 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(-2.9305, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1764, dtype=torch.float64) delta_t tensor(-0.3235, dtype=torch.float64)
7 gae_duplicate tensor(-3.4071, dtype=torch.float64) tensor(6.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8824, dtype=torch.float64) delta_t tensor(-0.1533, dtype=torch.float64)
6 gae_duplicate tensor(-0.8431, dtype=torch.float64) tensor(4.0195, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3994, dtype=torch.float64) delta_t tensor(-0.5226, dtype=torch.float64)
5 gae_duplicate tensor(-0.9336, dtype=torch.float64) tensor(10.6688, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0253, dtype=torch.float64) delta_t tensor(0.2753, dtype=torch.float64)
4 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-4.9281, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0626, dtype=torch.float64) delta_t tensor(-0.3605, dtype=torch.float64)
3 gae_duplicate tensor(-1.1652, dtype=torch.float64) tensor(6.8283, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3394, dtype=torch.float64) delta_t tensor(0.3532, dtype=torch.float64)
2 gae_duplicate tensor(-0.2524, dtype=torch.float64) tensor(-5.9401, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:194.50015258789062
value loss:45.63328552246094
entropies:351.9681701660156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.308490037918091 seconds
19 rew tensor(1.2012, dtype=torch.float64) delta_t tensor(0.0071, dtype=torch.float64)
19 gae_duplicate tensor(-0.2820, dtype=torch.float64) tensor(-0.0845, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1756, dtype=torch.float64) delta_t tensor(0.0977, dtype=torch.float64)
18 gae_duplicate tensor(-0.1995, dtype=torch.float64) tensor(-1.7165, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1240, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
17 gae_duplicate tensor(-0.1045, dtype=torch.float64) tensor(-1.5331, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9536, dtype=torch.float64) delta_t tensor(-0.0993, dtype=torch.float64)
16 gae_duplicate tensor(-0.2253, dtype=torch.float64) tensor(1.9119, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8399, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
15 gae_duplicate tensor(-0.2415, dtype=torch.float64) tensor(-0.3621, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7087, dtype=torch.float64) delta_t tensor(-0.0290, dtype=torch.float64)
14 gae_duplicate tensor(-0.2905, dtype=torch.float64) tensor(0.4601, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5552, dtype=torch.float64) delta_t tensor(0.0386, dtype=torch.float64)
13 gae_duplicate tensor(-0.1713, dtype=torch.float64) tensor(-0.7852, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5544, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
12 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(-0.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2183, dtype=torch.float64) delta_t tensor(-0.0908, dtype=torch.float64)
11 gae_duplicate tensor(-0.4491, dtype=torch.float64) tensor(1.6467, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1940, dtype=torch.float64) delta_t tensor(0.4048, dtype=torch.float64)
10 gae_duplicate tensor(-0.1005, dtype=torch.float64) tensor(-8.0496, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0081, dtype=torch.float64) delta_t tensor(0.5705, dtype=torch.float64)
9 gae_duplicate tensor(0.2793, dtype=torch.float64) tensor(-12.1139, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4591, dtype=torch.float64) delta_t tensor(0.3598, dtype=torch.float64)
8 gae_duplicate tensor(0.0323, dtype=torch.float64) tensor(-7.9784, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7118, dtype=torch.float64) delta_t tensor(-0.6935, dtype=torch.float64)
7 gae_duplicate tensor(-1.9207, dtype=torch.float64) tensor(12.0401, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5914, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
6 gae_duplicate tensor(-0.5658, dtype=torch.float64) tensor(-0.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8338, dtype=torch.float64) delta_t tensor(-0.9181, dtype=torch.float64)
5 gae_duplicate tensor(-1.2913, dtype=torch.float64) tensor(17.8931, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4488, dtype=torch.float64) delta_t tensor(0.4685, dtype=torch.float64)
3 rew tensor(-1.7215, dtype=torch.float64) delta_t tensor(-0.7590, dtype=torch.float64)
3 gae_duplicate tensor(-1.2742, dtype=torch.float64) tensor(14.2806, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8122, dtype=torch.float64) delta_t tensor(0.7682, dtype=torch.float64)
2 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-13.3063, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:266.8954162597656
value loss:47.2741813659668
entropies:352.14044189453125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.07475209236145 seconds
19 rew tensor(1.1761, dtype=torch.float64) delta_t tensor(-0.0250, dtype=torch.float64)
19 gae_duplicate tensor(-0.3097, dtype=torch.float64) tensor(0.4284, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8941, dtype=torch.float64) delta_t tensor(-0.1856, dtype=torch.float64)
18 gae_duplicate tensor(-1.6248, dtype=torch.float64) tensor(3.6069, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0471, dtype=torch.float64) delta_t tensor(-0.0346, dtype=torch.float64)
17 gae_duplicate tensor(-0.3063, dtype=torch.float64) tensor(0.9793, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0735, dtype=torch.float64) delta_t tensor(0.0080, dtype=torch.float64)
16 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-0.0172, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9323, dtype=torch.float64) delta_t tensor(-0.0255, dtype=torch.float64)
15 gae_duplicate tensor(-0.2634, dtype=torch.float64) tensor(0.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8537, dtype=torch.float64) delta_t tensor(0.0628, dtype=torch.float64)
14 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(-0.9906, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1222, dtype=torch.float64) delta_t tensor(-0.7875, dtype=torch.float64)
13 gae_duplicate tensor(-3.2272, dtype=torch.float64) tensor(14.8556, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0247, dtype=torch.float64) delta_t tensor(-0.2531, dtype=torch.float64)
12 gae_duplicate tensor(-1.8255, dtype=torch.float64) tensor(6.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4630, dtype=torch.float64) delta_t tensor(-0.0465, dtype=torch.float64)
11 gae_duplicate tensor(-0.4421, dtype=torch.float64) tensor(1.4659, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0788, dtype=torch.float64) delta_t tensor(0.1781, dtype=torch.float64)
10 gae_duplicate tensor(0.0135, dtype=torch.float64) tensor(-3.2330, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3744, dtype=torch.float64) delta_t tensor(0.7928, dtype=torch.float64)
9 gae_duplicate tensor(0.5905, dtype=torch.float64) tensor(-16.6943, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4838, dtype=torch.float64) delta_t tensor(0.2011, dtype=torch.float64)
8 gae_duplicate tensor(0.0451, dtype=torch.float64) tensor(-5.3642, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3524, dtype=torch.float64) delta_t tensor(-0.3536, dtype=torch.float64)
7 gae_duplicate tensor(-1.8675, dtype=torch.float64) tensor(6.1788, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6144, dtype=torch.float64) delta_t tensor(0.1242, dtype=torch.float64)
6 gae_duplicate tensor(-0.5428, dtype=torch.float64) tensor(-1.9096, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7282, dtype=torch.float64) delta_t tensor(-0.7856, dtype=torch.float64)
5 gae_duplicate tensor(-0.8688, dtype=torch.float64) tensor(15.3332, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1828, dtype=torch.float64) delta_t tensor(0.2771, dtype=torch.float64)
4 gae_duplicate tensor(-0.0787, dtype=torch.float64) tensor(-3.7889, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3498, dtype=torch.float64) delta_t tensor(-0.4106, dtype=torch.float64)
3 gae_duplicate tensor(-0.9961, dtype=torch.float64) tensor(7.4934, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5319, dtype=torch.float64) delta_t tensor(0.4588, dtype=torch.float64)
2 gae_duplicate tensor(0.0427, dtype=torch.float64) tensor(-7.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1051.3363037109375
value loss:53.89086151123047
entropies:352.3006286621094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3924.1035)
ToM Target loss= tensor(2206.1204)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.779399156570435 seconds
19 rew tensor(1.1994, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
19 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(0.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1620, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
18 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-1.1136, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0739, dtype=torch.float64) delta_t tensor(0.0036, dtype=torch.float64)
17 gae_duplicate tensor(-0.2383, dtype=torch.float64) tensor(-0.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0204, dtype=torch.float64) delta_t tensor(-0.0268, dtype=torch.float64)
16 gae_duplicate tensor(-0.0939, dtype=torch.float64) tensor(0.4554, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8130, dtype=torch.float64) delta_t tensor(-0.0701, dtype=torch.float64)
15 gae_duplicate tensor(-0.3030, dtype=torch.float64) tensor(1.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5815, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
14 gae_duplicate tensor(-1.6495, dtype=torch.float64) tensor(5.5896, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4477, dtype=torch.float64) delta_t tensor(-0.2942, dtype=torch.float64)
13 gae_duplicate tensor(-0.6374, dtype=torch.float64) tensor(6.2710, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4034, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
12 gae_duplicate tensor(-0.3182, dtype=torch.float64) tensor(1.7737, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2529, dtype=torch.float64) delta_t tensor(-0.1343, dtype=torch.float64)
11 gae_duplicate tensor(-0.4281, dtype=torch.float64) tensor(2.7679, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1069, dtype=torch.float64) delta_t tensor(0.3820, dtype=torch.float64)
10 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-6.9138, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1727, dtype=torch.float64) delta_t tensor(0.5371, dtype=torch.float64)
9 gae_duplicate tensor(0.1629, dtype=torch.float64) tensor(-11.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4804, dtype=torch.float64) delta_t tensor(0.2605, dtype=torch.float64)
8 gae_duplicate tensor(-0.3098, dtype=torch.float64) tensor(-6.8081, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2683, dtype=torch.float64) delta_t tensor(-0.2539, dtype=torch.float64)
7 gae_duplicate tensor(-1.1308, dtype=torch.float64) tensor(3.8968, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5989, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
6 gae_duplicate tensor(-0.3304, dtype=torch.float64) tensor(-1.9205, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7567, dtype=torch.float64) delta_t tensor(-0.8280, dtype=torch.float64)
5 gae_duplicate tensor(-1.3237, dtype=torch.float64) tensor(15.7122, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2994, dtype=torch.float64) delta_t tensor(0.4201, dtype=torch.float64)
4 gae_duplicate tensor(0.1410, dtype=torch.float64) tensor(-6.5691, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4929, dtype=torch.float64) delta_t tensor(-0.6395, dtype=torch.float64)
3 gae_duplicate tensor(-1.2842, dtype=torch.float64) tensor(12.8489, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6621, dtype=torch.float64) delta_t tensor(0.5909, dtype=torch.float64)
2 gae_duplicate tensor(-0.2346, dtype=torch.float64) tensor(-9.9502, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-425.17779541015625
value loss:38.57124710083008
entropies:352.5590515136719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0219690799713135 seconds
19 rew tensor(1.0826, dtype=torch.float64) delta_t tensor(-0.1407, dtype=torch.float64)
19 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(2.6378, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0458, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
18 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(1.2914, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(-0.1157, dtype=torch.float64)
17 gae_duplicate tensor(-0.2673, dtype=torch.float64) tensor(2.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(-0.0845, dtype=torch.float64)
16 gae_duplicate tensor(-0.2354, dtype=torch.float64) tensor(1.8952, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8651, dtype=torch.float64) delta_t tensor(-0.0283, dtype=torch.float64)
15 gae_duplicate tensor(-0.2644, dtype=torch.float64) tensor(0.8034, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5189, dtype=torch.float64) delta_t tensor(-0.3963, dtype=torch.float64)
14 gae_duplicate tensor(-1.9379, dtype=torch.float64) tensor(7.7140, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6592, dtype=torch.float64) delta_t tensor(-0.1638, dtype=torch.float64)
13 gae_duplicate tensor(-0.4360, dtype=torch.float64) tensor(3.9409, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4106, dtype=torch.float64) delta_t tensor(-0.2834, dtype=torch.float64)
12 gae_duplicate tensor(-0.4678, dtype=torch.float64) tensor(5.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3887, dtype=torch.float64) delta_t tensor(-0.1979, dtype=torch.float64)
11 gae_duplicate tensor(-0.4959, dtype=torch.float64) tensor(4.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0107, dtype=torch.float64) delta_t tensor(0.1791, dtype=torch.float64)
10 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-3.2705, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(0.5800, dtype=torch.float64)
9 gae_duplicate tensor(0.4529, dtype=torch.float64) tensor(-11.4935, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3795, dtype=torch.float64) delta_t tensor(0.3029, dtype=torch.float64)
8 gae_duplicate tensor(0.1861, dtype=torch.float64) tensor(-7.2397, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8701, dtype=torch.float64) delta_t tensor(0.0502, dtype=torch.float64)
7 gae_duplicate tensor(-0.4498, dtype=torch.float64) tensor(-1.5659, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4844, dtype=torch.float64) delta_t tensor(0.2472, dtype=torch.float64)
6 gae_duplicate tensor(0.1002, dtype=torch.float64) tensor(-5.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6743, dtype=torch.float64) delta_t tensor(-0.7887, dtype=torch.float64)
5 gae_duplicate tensor(-1.0303, dtype=torch.float64) tensor(14.9086, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0343, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
4 gae_duplicate tensor(-0.1758, dtype=torch.float64) tensor(-1.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0427, dtype=torch.float64) delta_t tensor(-0.2238, dtype=torch.float64)
3 gae_duplicate tensor(-0.5072, dtype=torch.float64) tensor(4.0560, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4097, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
2 gae_duplicate tensor(-0.0743, dtype=torch.float64) tensor(-5.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-852.6566772460938
value loss:25.31716537475586
entropies:352.87152099609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.702517986297607 seconds
19 rew tensor(1.1220, dtype=torch.float64) delta_t tensor(-0.0861, dtype=torch.float64)
19 gae_duplicate tensor(-0.2573, dtype=torch.float64) tensor(1.6353, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1105, dtype=torch.float64) delta_t tensor(0.0315, dtype=torch.float64)
18 gae_duplicate tensor(-0.2059, dtype=torch.float64) tensor(-0.4049, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1124, dtype=torch.float64) delta_t tensor(0.0360, dtype=torch.float64)
17 gae_duplicate tensor(-0.1310, dtype=torch.float64) tensor(-0.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9683, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
16 gae_duplicate tensor(-0.1632, dtype=torch.float64) tensor(0.1152, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9838, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
15 gae_duplicate tensor(-0.2617, dtype=torch.float64) tensor(1.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7492, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
14 gae_duplicate tensor(-0.3064, dtype=torch.float64) tensor(-0.5768, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5426, dtype=torch.float64) delta_t tensor(-0.3450, dtype=torch.float64)
13 gae_duplicate tensor(-1.4031, dtype=torch.float64) tensor(6.3756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.2089, dtype=torch.float64) delta_t tensor(-0.4683, dtype=torch.float64)
12 gae_duplicate tensor(-2.1985, dtype=torch.float64) tensor(9.9057, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1542, dtype=torch.float64) delta_t tensor(-0.4370, dtype=torch.float64)
11 gae_duplicate tensor(-1.6214, dtype=torch.float64) tensor(9.9408, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0414, dtype=torch.float64) delta_t tensor(0.1566, dtype=torch.float64)
10 gae_duplicate tensor(-0.1314, dtype=torch.float64) tensor(-2.1603, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4669, dtype=torch.float64) delta_t tensor(0.6508, dtype=torch.float64)
9 gae_duplicate tensor(0.4391, dtype=torch.float64) tensor(-12.6494, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6544, dtype=torch.float64) delta_t tensor(0.0120, dtype=torch.float64)
8 gae_duplicate tensor(-0.3628, dtype=torch.float64) tensor(-1.6954, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3741, dtype=torch.float64) delta_t tensor(0.4135, dtype=torch.float64)
7 gae_duplicate tensor(-0.0744, dtype=torch.float64) tensor(-8.3344, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7602, dtype=torch.float64) delta_t tensor(-0.0478, dtype=torch.float64)
6 gae_duplicate tensor(-0.3026, dtype=torch.float64) tensor(0.0348, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3629, dtype=torch.float64) delta_t tensor(-0.4825, dtype=torch.float64)
5 gae_duplicate tensor(-0.9411, dtype=torch.float64) tensor(9.3970, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2295, dtype=torch.float64) delta_t tensor(0.1495, dtype=torch.float64)
4 gae_duplicate tensor(-0.1215, dtype=torch.float64) tensor(-2.0368, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7537, dtype=torch.float64) delta_t tensor(-0.0947, dtype=torch.float64)
3 gae_duplicate tensor(-0.6298, dtype=torch.float64) tensor(1.6314, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1337, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
2 gae_duplicate tensor(-0.4669, dtype=torch.float64) tensor(-0.7299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-710.7769165039062
value loss:32.747283935546875
entropies:353.178955078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.597178936004639 seconds
19 rew tensor(1.1231, dtype=torch.float64) delta_t tensor(-0.0968, dtype=torch.float64)
19 gae_duplicate tensor(-0.2856, dtype=torch.float64) tensor(1.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(0.0958, dtype=torch.float64)
18 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-1.6126, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0982, dtype=torch.float64) delta_t tensor(0.0039, dtype=torch.float64)
17 gae_duplicate tensor(-0.1271, dtype=torch.float64) tensor(-0.3625, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9314, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
16 gae_duplicate tensor(-0.2721, dtype=torch.float64) tensor(1.3206, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9328, dtype=torch.float64) delta_t tensor(-0.1346, dtype=torch.float64)
15 gae_duplicate tensor(-0.2308, dtype=torch.float64) tensor(2.7035, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1055, dtype=torch.float64) delta_t tensor(-0.4402, dtype=torch.float64)
14 gae_duplicate tensor(-1.8412, dtype=torch.float64) tensor(8.4761, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7758, dtype=torch.float64) delta_t tensor(-0.1839, dtype=torch.float64)
13 gae_duplicate tensor(-0.4252, dtype=torch.float64) tensor(4.3713, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2170, dtype=torch.float64) delta_t tensor(-0.0012, dtype=torch.float64)
12 gae_duplicate tensor(-0.4159, dtype=torch.float64) tensor(0.4129, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6477, dtype=torch.float64) delta_t tensor(-0.0177, dtype=torch.float64)
11 gae_duplicate tensor(-0.4382, dtype=torch.float64) tensor(0.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2251, dtype=torch.float64) delta_t tensor(-0.0364, dtype=torch.float64)
10 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(0.7840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4415, dtype=torch.float64) delta_t tensor(0.6267, dtype=torch.float64)
9 gae_duplicate tensor(0.3498, dtype=torch.float64) tensor(-12.0788, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6843, dtype=torch.float64) delta_t tensor(0.0048, dtype=torch.float64)
8 gae_duplicate tensor(-0.2885, dtype=torch.float64) tensor(-1.5155, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7602, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
7 gae_duplicate tensor(-2.1570, dtype=torch.float64) tensor(-1.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7500, dtype=torch.float64) delta_t tensor(-0.1168, dtype=torch.float64)
6 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(2.2462, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3915, dtype=torch.float64) delta_t tensor(-0.5312, dtype=torch.float64)
5 gae_duplicate tensor(-0.8478, dtype=torch.float64) tensor(10.0864, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0966, dtype=torch.float64) delta_t tensor(0.1909, dtype=torch.float64)
4 gae_duplicate tensor(-0.1302, dtype=torch.float64) tensor(-2.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8778, dtype=torch.float64) delta_t tensor(-0.2527, dtype=torch.float64)
3 gae_duplicate tensor(-1.2245, dtype=torch.float64) tensor(4.4631, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2795, dtype=torch.float64) delta_t tensor(0.2536, dtype=torch.float64)
2 gae_duplicate tensor(-0.2674, dtype=torch.float64) tensor(-4.3841, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-755.87744140625
value loss:32.9445686340332
entropies:353.4154968261719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.951088905334473 seconds
19 rew tensor(1.2113, dtype=torch.float64) delta_t tensor(0.0163, dtype=torch.float64)
19 gae_duplicate tensor(-0.1589, dtype=torch.float64) tensor(-0.3283, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1734, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
18 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-1.8223, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0462, dtype=torch.float64) delta_t tensor(-0.0109, dtype=torch.float64)
17 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-0.0418, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0598, dtype=torch.float64) delta_t tensor(0.0132, dtype=torch.float64)
16 gae_duplicate tensor(-0.1208, dtype=torch.float64) tensor(-0.2827, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9299, dtype=torch.float64) delta_t tensor(0.0193, dtype=torch.float64)
15 gae_duplicate tensor(-0.3266, dtype=torch.float64) tensor(-0.3708, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5403, dtype=torch.float64) delta_t tensor(-0.1961, dtype=torch.float64)
14 gae_duplicate tensor(-0.9557, dtype=torch.float64) tensor(3.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5458, dtype=torch.float64) delta_t tensor(-0.1533, dtype=torch.float64)
13 gae_duplicate tensor(-0.3540, dtype=torch.float64) tensor(3.4054, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3864, dtype=torch.float64) delta_t tensor(-0.0064, dtype=torch.float64)
12 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(0.5730, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3852, dtype=torch.float64) delta_t tensor(-0.1545, dtype=torch.float64)
11 gae_duplicate tensor(-0.3523, dtype=torch.float64) tensor(3.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0780, dtype=torch.float64) delta_t tensor(0.2714, dtype=torch.float64)
10 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-4.9584, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3982, dtype=torch.float64) delta_t tensor(0.6813, dtype=torch.float64)
9 gae_duplicate tensor(0.4523, dtype=torch.float64) tensor(-14.2271, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5079, dtype=torch.float64) delta_t tensor(0.1768, dtype=torch.float64)
8 gae_duplicate tensor(-0.1648, dtype=torch.float64) tensor(-4.8961, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6808, dtype=torch.float64) delta_t tensor(-0.7181, dtype=torch.float64)
7 gae_duplicate tensor(-4.7308, dtype=torch.float64) tensor(13.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7202, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
6 gae_duplicate tensor(-1.2187, dtype=torch.float64) tensor(2.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5992, dtype=torch.float64) delta_t tensor(-0.6427, dtype=torch.float64)
5 gae_duplicate tensor(-1.0475, dtype=torch.float64) tensor(12.3578, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1097, dtype=torch.float64) delta_t tensor(0.3364, dtype=torch.float64)
4 gae_duplicate tensor(0.0042, dtype=torch.float64) tensor(-5.2171, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2763, dtype=torch.float64) delta_t tensor(-0.4127, dtype=torch.float64)
3 gae_duplicate tensor(-0.9329, dtype=torch.float64) tensor(7.4581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4604, dtype=torch.float64) delta_t tensor(0.4073, dtype=torch.float64)
2 gae_duplicate tensor(0.0615, dtype=torch.float64) tensor(-6.9865, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-477.2235107421875
value loss:60.773380279541016
entropies:353.7256774902344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3960.4124)
ToM Target loss= tensor(2179.8594)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.222361087799072 seconds
19 rew tensor(1.1769, dtype=torch.float64) delta_t tensor(-0.0212, dtype=torch.float64)
19 gae_duplicate tensor(-0.2954, dtype=torch.float64) tensor(0.4337, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1239, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
18 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(-1.0753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0607, dtype=torch.float64) delta_t tensor(-0.0002, dtype=torch.float64)
17 gae_duplicate tensor(-0.2194, dtype=torch.float64) tensor(-0.0242, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9955, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
16 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-0.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9054, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
15 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-0.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3895, dtype=torch.float64) delta_t tensor(-0.1361, dtype=torch.float64)
14 gae_duplicate tensor(-1.1772, dtype=torch.float64) tensor(2.4626, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7396, dtype=torch.float64) delta_t tensor(-0.0949, dtype=torch.float64)
13 gae_duplicate tensor(-0.3884, dtype=torch.float64) tensor(2.0326, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2382, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
12 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(0.6539, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5198, dtype=torch.float64) delta_t tensor(0.0760, dtype=torch.float64)
11 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-1.4835, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0847, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
10 gae_duplicate tensor(-0.1508, dtype=torch.float64) tensor(-2.4301, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(0.6552, dtype=torch.float64)
9 gae_duplicate tensor(0.3850, dtype=torch.float64) tensor(-13.3287, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5913, dtype=torch.float64) delta_t tensor(0.1123, dtype=torch.float64)
8 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-3.7549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7560, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
7 gae_duplicate tensor(-0.5485, dtype=torch.float64) tensor(-3.3319, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7352, dtype=torch.float64) delta_t tensor(0.0100, dtype=torch.float64)
6 gae_duplicate tensor(-0.3132, dtype=torch.float64) tensor(-0.5917, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4885, dtype=torch.float64) delta_t tensor(-0.5584, dtype=torch.float64)
5 gae_duplicate tensor(-0.8912, dtype=torch.float64) tensor(11.0518, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0266, dtype=torch.float64) delta_t tensor(0.2448, dtype=torch.float64)
4 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-3.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1126, dtype=torch.float64) delta_t tensor(-0.3286, dtype=torch.float64)
3 gae_duplicate tensor(-0.9089, dtype=torch.float64) tensor(6.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3758, dtype=torch.float64) delta_t tensor(0.2519, dtype=torch.float64)
2 gae_duplicate tensor(-0.5729, dtype=torch.float64) tensor(-4.1766, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:578.4449462890625
value loss:24.11655044555664
entropies:354.0239562988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.243431091308594 seconds
19 rew tensor(1.1334, dtype=torch.float64) delta_t tensor(-0.0594, dtype=torch.float64)
19 gae_duplicate tensor(-0.2531, dtype=torch.float64) tensor(1.1641, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0705, dtype=torch.float64) delta_t tensor(-0.0069, dtype=torch.float64)
18 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(0.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0976, dtype=torch.float64) delta_t tensor(0.0138, dtype=torch.float64)
17 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(-0.2415, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0983, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
16 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(-0.8187, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9426, dtype=torch.float64) delta_t tensor(-0.1202, dtype=torch.float64)
15 gae_duplicate tensor(-0.2915, dtype=torch.float64) tensor(2.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5663, dtype=torch.float64) delta_t tensor(-0.2452, dtype=torch.float64)
14 gae_duplicate tensor(-1.7941, dtype=torch.float64) tensor(5.4995, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.0914, dtype=torch.float64) delta_t tensor(-0.8099, dtype=torch.float64)
13 gae_duplicate tensor(-2.6982, dtype=torch.float64) tensor(16.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1393, dtype=torch.float64) delta_t tensor(-0.1012, dtype=torch.float64)
12 gae_duplicate tensor(-1.4848, dtype=torch.float64) tensor(3.6057, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4509, dtype=torch.float64) delta_t tensor(0.1271, dtype=torch.float64)
11 gae_duplicate tensor(-0.2214, dtype=torch.float64) tensor(-2.1318, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0576, dtype=torch.float64) delta_t tensor(0.1036, dtype=torch.float64)
10 gae_duplicate tensor(-0.0729, dtype=torch.float64) tensor(-2.2841, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3727, dtype=torch.float64) delta_t tensor(0.6820, dtype=torch.float64)
9 gae_duplicate tensor(0.5417, dtype=torch.float64) tensor(-13.2182, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4807, dtype=torch.float64) delta_t tensor(0.1625, dtype=torch.float64)
8 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-4.5688, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8645, dtype=torch.float64) delta_t tensor(0.0715, dtype=torch.float64)
7 gae_duplicate tensor(-0.2804, dtype=torch.float64) tensor(-2.0430, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5855, dtype=torch.float64) delta_t tensor(0.1350, dtype=torch.float64)
6 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-2.8097, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6552, dtype=torch.float64) delta_t tensor(-0.7140, dtype=torch.float64)
5 gae_duplicate tensor(-0.9857, dtype=torch.float64) tensor(13.4775, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0348, dtype=torch.float64) delta_t tensor(0.1179, dtype=torch.float64)
4 gae_duplicate tensor(-0.0926, dtype=torch.float64) tensor(-0.9155, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1354, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
3 gae_duplicate tensor(-0.7396, dtype=torch.float64) tensor(4.6719, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3853, dtype=torch.float64) delta_t tensor(0.2552, dtype=torch.float64)
2 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-4.3919, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-845.7450561523438
value loss:37.76571273803711
entropies:354.24847412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.3831188678741455 seconds
19 rew tensor(1.0719, dtype=torch.float64) delta_t tensor(-0.1254, dtype=torch.float64)
19 gae_duplicate tensor(-0.2759, dtype=torch.float64) tensor(2.4092, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1379, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
18 gae_duplicate tensor(-0.0923, dtype=torch.float64) tensor(-0.8922, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(-0.0858, dtype=torch.float64)
17 gae_duplicate tensor(-0.2157, dtype=torch.float64) tensor(1.6328, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0205, dtype=torch.float64) delta_t tensor(0.0354, dtype=torch.float64)
16 gae_duplicate tensor(-0.2872, dtype=torch.float64) tensor(-0.3879, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9048, dtype=torch.float64) delta_t tensor(0.1922, dtype=torch.float64)
15 gae_duplicate tensor(-0.1866, dtype=torch.float64) tensor(-4.0854, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8501, dtype=torch.float64) delta_t tensor(-0.0882, dtype=torch.float64)
14 gae_duplicate tensor(-0.3184, dtype=torch.float64) tensor(1.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(-0.0146, dtype=torch.float64)
13 gae_duplicate tensor(-0.2128, dtype=torch.float64) tensor(0.4811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.0267, dtype=torch.float64) delta_t tensor(-0.2892, dtype=torch.float64)
12 gae_duplicate tensor(-2.3231, dtype=torch.float64) tensor(5.2619, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.0877, dtype=torch.float64) delta_t tensor(-0.3856, dtype=torch.float64)
11 gae_duplicate tensor(-2.7452, dtype=torch.float64) tensor(8.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1461, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
10 gae_duplicate tensor(-0.8548, dtype=torch.float64) tensor(-0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2475, dtype=torch.float64) delta_t tensor(0.4514, dtype=torch.float64)
9 gae_duplicate tensor(0.1977, dtype=torch.float64) tensor(-9.0497, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5528, dtype=torch.float64) delta_t tensor(0.1422, dtype=torch.float64)
8 gae_duplicate tensor(-0.4363, dtype=torch.float64) tensor(-3.5601, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5806, dtype=torch.float64) delta_t tensor(0.2302, dtype=torch.float64)
7 gae_duplicate tensor(-0.4864, dtype=torch.float64) tensor(-5.1178, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7074, dtype=torch.float64) delta_t tensor(-0.0315, dtype=torch.float64)
6 gae_duplicate tensor(-0.4518, dtype=torch.float64) tensor(0.2200, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4419, dtype=torch.float64) delta_t tensor(-0.5751, dtype=torch.float64)
5 gae_duplicate tensor(-1.1246, dtype=torch.float64) tensor(12.0111, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0484, dtype=torch.float64) delta_t tensor(0.2700, dtype=torch.float64)
4 gae_duplicate tensor(0.0337, dtype=torch.float64) tensor(-4.0434, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9218, dtype=torch.float64) delta_t tensor(-0.2471, dtype=torch.float64)
3 gae_duplicate tensor(-0.5625, dtype=torch.float64) tensor(4.7252, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3279, dtype=torch.float64) delta_t tensor(0.2055, dtype=torch.float64)
2 gae_duplicate tensor(-0.3294, dtype=torch.float64) tensor(-3.7545, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-391.7980651855469
value loss:40.752017974853516
entropies:354.4714050292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.121064186096191 seconds
19 rew tensor(1.0996, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
19 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(1.9699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1265, dtype=torch.float64) delta_t tensor(0.0380, dtype=torch.float64)
18 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(-0.5061, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0879, dtype=torch.float64) delta_t tensor(0.0019, dtype=torch.float64)
17 gae_duplicate tensor(-0.1146, dtype=torch.float64) tensor(-0.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0233, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
16 gae_duplicate tensor(-0.0950, dtype=torch.float64) tensor(-1.2640, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9465, dtype=torch.float64) delta_t tensor(0.0135, dtype=torch.float64)
15 gae_duplicate tensor(-0.2231, dtype=torch.float64) tensor(-0.4032, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6053, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
14 gae_duplicate tensor(-0.1845, dtype=torch.float64) tensor(-1.1467, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6044, dtype=torch.float64) delta_t tensor(-0.1335, dtype=torch.float64)
13 gae_duplicate tensor(-0.3932, dtype=torch.float64) tensor(2.5238, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3213, dtype=torch.float64) delta_t tensor(0.1090, dtype=torch.float64)
12 gae_duplicate tensor(-0.0330, dtype=torch.float64) tensor(-1.8849, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4665, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
11 gae_duplicate tensor(-0.1786, dtype=torch.float64) tensor(-0.0749, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0954, dtype=torch.float64) delta_t tensor(0.1259, dtype=torch.float64)
10 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(-2.4732, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4540, dtype=torch.float64) delta_t tensor(0.5406, dtype=torch.float64)
9 gae_duplicate tensor(0.2581, dtype=torch.float64) tensor(-10.9355, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6165, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
8 gae_duplicate tensor(-0.3322, dtype=torch.float64) tensor(-2.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6820, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
7 gae_duplicate tensor(-0.7057, dtype=torch.float64) tensor(-4.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6699, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
6 gae_duplicate tensor(-0.3435, dtype=torch.float64) tensor(-0.7287, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4722, dtype=torch.float64) delta_t tensor(-0.5796, dtype=torch.float64)
5 gae_duplicate tensor(-1.0582, dtype=torch.float64) tensor(11.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0150, dtype=torch.float64) delta_t tensor(0.2053, dtype=torch.float64)
4 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-2.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9861, dtype=torch.float64) delta_t tensor(-0.2946, dtype=torch.float64)
3 gae_duplicate tensor(-0.9528, dtype=torch.float64) tensor(5.3415, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3609, dtype=torch.float64) delta_t tensor(0.2342, dtype=torch.float64)
2 gae_duplicate tensor(-0.2961, dtype=torch.float64) tensor(-3.8394, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:521.9110717773438
value loss:21.555522918701172
entropies:354.580078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.540762186050415 seconds
19 rew tensor(1.1505, dtype=torch.float64) delta_t tensor(-0.0284, dtype=torch.float64)
19 gae_duplicate tensor(-0.2200, dtype=torch.float64) tensor(0.5737, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1387, dtype=torch.float64) delta_t tensor(0.0846, dtype=torch.float64)
18 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(-1.5243, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0744, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
17 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-0.5462, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9061, dtype=torch.float64) delta_t tensor(0.0607, dtype=torch.float64)
16 gae_duplicate tensor(-0.2129, dtype=torch.float64) tensor(-1.3341, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8935, dtype=torch.float64) delta_t tensor(-0.0698, dtype=torch.float64)
15 gae_duplicate tensor(-0.1941, dtype=torch.float64) tensor(1.2496, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3360, dtype=torch.float64) delta_t tensor(-0.1276, dtype=torch.float64)
14 gae_duplicate tensor(-1.8949, dtype=torch.float64) tensor(2.4056, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4521, dtype=torch.float64) delta_t tensor(-0.2081, dtype=torch.float64)
13 gae_duplicate tensor(-1.0689, dtype=torch.float64) tensor(4.4507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2550, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
12 gae_duplicate tensor(-0.1714, dtype=torch.float64) tensor(-1.7622, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4907, dtype=torch.float64) delta_t tensor(0.1063, dtype=torch.float64)
11 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-2.1449, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0314, dtype=torch.float64) delta_t tensor(0.0471, dtype=torch.float64)
10 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(-1.1025, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4518, dtype=torch.float64) delta_t tensor(0.4297, dtype=torch.float64)
9 gae_duplicate tensor(0.2892, dtype=torch.float64) tensor(-8.3300, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6683, dtype=torch.float64) delta_t tensor(0.0184, dtype=torch.float64)
8 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(-1.3310, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1091, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
7 gae_duplicate tensor(-0.0023, dtype=torch.float64) tensor(-11.6248, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7722, dtype=torch.float64) delta_t tensor(-0.0971, dtype=torch.float64)
6 gae_duplicate tensor(-0.2896, dtype=torch.float64) tensor(0.8151, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2155, dtype=torch.float64) delta_t tensor(-0.3880, dtype=torch.float64)
5 gae_duplicate tensor(-0.8281, dtype=torch.float64) tensor(7.9377, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3832, dtype=torch.float64) delta_t tensor(-0.0211, dtype=torch.float64)
4 gae_duplicate tensor(-0.1494, dtype=torch.float64) tensor(1.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4879, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
3 gae_duplicate tensor(-0.1743, dtype=torch.float64) tensor(-2.3145, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0191, dtype=torch.float64) delta_t tensor(-0.1770, dtype=torch.float64)
2 gae_duplicate tensor(-0.8030, dtype=torch.float64) tensor(3.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:461.52606201171875
value loss:21.33448600769043
entropies:354.63873291015625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.0078)
ToM Target loss= tensor(2147.6177)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.216202974319458 seconds
19 rew tensor(1.1508, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
19 gae_duplicate tensor(-0.2478, dtype=torch.float64) tensor(0.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1009, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
18 gae_duplicate tensor(-0.1323, dtype=torch.float64) tensor(-0.6974, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0102, dtype=torch.float64) delta_t tensor(-0.0410, dtype=torch.float64)
17 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(0.7499, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0248, dtype=torch.float64) delta_t tensor(-0.0053, dtype=torch.float64)
16 gae_duplicate tensor(-0.2350, dtype=torch.float64) tensor(0.1489, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8943, dtype=torch.float64) delta_t tensor(-0.1368, dtype=torch.float64)
15 gae_duplicate tensor(-0.2404, dtype=torch.float64) tensor(2.6768, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8381, dtype=torch.float64) delta_t tensor(0.0975, dtype=torch.float64)
14 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-1.6488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5806, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
13 gae_duplicate tensor(-0.3875, dtype=torch.float64) tensor(-2.2403, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4120, dtype=torch.float64) delta_t tensor(0.2075, dtype=torch.float64)
12 gae_duplicate tensor(-0.0953, dtype=torch.float64) tensor(-4.1423, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.5143, dtype=torch.float64) delta_t tensor(-0.7513, dtype=torch.float64)
11 gae_duplicate tensor(-4.8973, dtype=torch.float64) tensor(15.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0980, dtype=torch.float64) delta_t tensor(0.1239, dtype=torch.float64)
10 gae_duplicate tensor(-0.0701, dtype=torch.float64) tensor(-0.9966, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3516, dtype=torch.float64) delta_t tensor(0.6844, dtype=torch.float64)
9 gae_duplicate tensor(0.4993, dtype=torch.float64) tensor(-13.4348, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4351, dtype=torch.float64) delta_t tensor(0.1558, dtype=torch.float64)
8 gae_duplicate tensor(-0.0606, dtype=torch.float64) tensor(-4.4649, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1336, dtype=torch.float64) delta_t tensor(-0.1311, dtype=torch.float64)
7 gae_duplicate tensor(-0.3262, dtype=torch.float64) tensor(2.1480, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5792, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
6 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-2.1610, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.8402, dtype=torch.float64) delta_t tensor(-0.8458, dtype=torch.float64)
5 gae_duplicate tensor(-0.9224, dtype=torch.float64) tensor(16.4102, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1081, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
4 gae_duplicate tensor(-0.0033, dtype=torch.float64) tensor(-3.0375, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3465, dtype=torch.float64) delta_t tensor(-0.3760, dtype=torch.float64)
3 gae_duplicate tensor(-0.6728, dtype=torch.float64) tensor(7.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(0.3023, dtype=torch.float64)
2 gae_duplicate tensor(-0.2014, dtype=torch.float64) tensor(-5.2133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-490.69549560546875
value loss:55.506465911865234
entropies:354.6630859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.106123924255371 seconds
19 rew tensor(1.1263, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
19 gae_duplicate tensor(-0.2592, dtype=torch.float64) tensor(0.4700, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1397, dtype=torch.float64) delta_t tensor(0.1066, dtype=torch.float64)
18 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-1.9947, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1144, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
17 gae_duplicate tensor(-0.1226, dtype=torch.float64) tensor(-1.7329, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9313, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
16 gae_duplicate tensor(-0.1814, dtype=torch.float64) tensor(-1.5174, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8660, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
15 gae_duplicate tensor(-0.2413, dtype=torch.float64) tensor(-1.0699, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7505, dtype=torch.float64) delta_t tensor(0.1187, dtype=torch.float64)
14 gae_duplicate tensor(-0.0912, dtype=torch.float64) tensor(-2.5629, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6562, dtype=torch.float64) delta_t tensor(-0.0568, dtype=torch.float64)
13 gae_duplicate tensor(-0.2834, dtype=torch.float64) tensor(0.9855, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.3855, dtype=torch.float64) delta_t tensor(-0.7395, dtype=torch.float64)
12 gae_duplicate tensor(-4.3932, dtype=torch.float64) tensor(13.9404, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4347, dtype=torch.float64) delta_t tensor(0.1752, dtype=torch.float64)
11 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(-2.1553, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1586, dtype=torch.float64) delta_t tensor(0.0818, dtype=torch.float64)
10 gae_duplicate tensor(-0.1938, dtype=torch.float64) tensor(-1.8055, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0952, dtype=torch.float64) delta_t tensor(0.3946, dtype=torch.float64)
9 gae_duplicate tensor(0.0759, dtype=torch.float64) tensor(-8.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3808, dtype=torch.float64) delta_t tensor(0.2390, dtype=torch.float64)
8 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-5.5022, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6719, dtype=torch.float64) delta_t tensor(0.1217, dtype=torch.float64)
7 gae_duplicate tensor(-1.0726, dtype=torch.float64) tensor(-3.3678, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6171, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
6 gae_duplicate tensor(-0.1709, dtype=torch.float64) tensor(-1.7013, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5027, dtype=torch.float64) delta_t tensor(-0.6444, dtype=torch.float64)
5 gae_duplicate tensor(-1.3920, dtype=torch.float64) tensor(12.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1213, dtype=torch.float64) delta_t tensor(0.1268, dtype=torch.float64)
4 gae_duplicate tensor(-0.1652, dtype=torch.float64) tensor(-1.1836, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8040, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
3 gae_duplicate tensor(-1.1279, dtype=torch.float64) tensor(0.9366, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1766, dtype=torch.float64) delta_t tensor(0.0096, dtype=torch.float64)
2 gae_duplicate tensor(-0.9207, dtype=torch.float64) tensor(0.0719, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:118.00676727294922
value loss:50.91532516479492
entropies:354.59210205078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.381993055343628 seconds
19 rew tensor(1.2014, dtype=torch.float64) delta_t tensor(0.0394, dtype=torch.float64)
19 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(-0.7804, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2149, dtype=torch.float64) delta_t tensor(0.1708, dtype=torch.float64)
18 gae_duplicate tensor(0.0553, dtype=torch.float64) tensor(-3.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0349, dtype=torch.float64) delta_t tensor(0.0905, dtype=torch.float64)
17 gae_duplicate tensor(-0.1259, dtype=torch.float64) tensor(-2.0964, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9567, dtype=torch.float64) delta_t tensor(0.0180, dtype=torch.float64)
16 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(-0.6787, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8531, dtype=torch.float64) delta_t tensor(-0.0112, dtype=torch.float64)
15 gae_duplicate tensor(-0.2018, dtype=torch.float64) tensor(0.1596, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4802, dtype=torch.float64) delta_t tensor(-0.1759, dtype=torch.float64)
14 gae_duplicate tensor(-1.3565, dtype=torch.float64) tensor(3.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5816, dtype=torch.float64) delta_t tensor(-0.1246, dtype=torch.float64)
13 gae_duplicate tensor(-0.5967, dtype=torch.float64) tensor(2.7296, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4006, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
12 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(-2.1877, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4769, dtype=torch.float64) delta_t tensor(0.0276, dtype=torch.float64)
11 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(-0.7155, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0022, dtype=torch.float64) delta_t tensor(0.2236, dtype=torch.float64)
10 gae_duplicate tensor(-0.1731, dtype=torch.float64) tensor(-4.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3825, dtype=torch.float64) delta_t tensor(0.5635, dtype=torch.float64)
9 gae_duplicate tensor(0.1214, dtype=torch.float64) tensor(-11.2092, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6377, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
8 gae_duplicate tensor(-0.3970, dtype=torch.float64) tensor(-1.4689, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4015, dtype=torch.float64) delta_t tensor(-0.4820, dtype=torch.float64)
7 gae_duplicate tensor(-3.5892, dtype=torch.float64) tensor(10.3757, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7720, dtype=torch.float64) delta_t tensor(-0.1576, dtype=torch.float64)
6 gae_duplicate tensor(-1.0549, dtype=torch.float64) tensor(3.8588, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5303, dtype=torch.float64) delta_t tensor(-0.6107, dtype=torch.float64)
5 gae_duplicate tensor(-1.0857, dtype=torch.float64) tensor(12.8643, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1442, dtype=torch.float64) delta_t tensor(0.2522, dtype=torch.float64)
4 gae_duplicate tensor(-0.1674, dtype=torch.float64) tensor(-3.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2661, dtype=torch.float64) delta_t tensor(-0.4189, dtype=torch.float64)
3 gae_duplicate tensor(-1.1945, dtype=torch.float64) tensor(8.0870, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5078, dtype=torch.float64) delta_t tensor(0.3493, dtype=torch.float64)
2 gae_duplicate tensor(-0.3186, dtype=torch.float64) tensor(-6.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-350.782470703125
value loss:48.11348342895508
entropies:354.61297607421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.377427101135254 seconds
19 rew tensor(1.2101, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
19 gae_duplicate tensor(-0.2369, dtype=torch.float64) tensor(-1.1732, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1850, dtype=torch.float64) delta_t tensor(0.1521, dtype=torch.float64)
18 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-3.0760, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8071, dtype=torch.float64) delta_t tensor(-0.2386, dtype=torch.float64)
17 gae_duplicate tensor(-1.5733, dtype=torch.float64) tensor(4.3431, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9911, dtype=torch.float64) delta_t tensor(0.1112, dtype=torch.float64)
16 gae_duplicate tensor(-0.2822, dtype=torch.float64) tensor(-1.6384, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6979, dtype=torch.float64) delta_t tensor(-0.1928, dtype=torch.float64)
15 gae_duplicate tensor(-1.0957, dtype=torch.float64) tensor(3.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6442, dtype=torch.float64) delta_t tensor(0.0407, dtype=torch.float64)
14 gae_duplicate tensor(-0.3279, dtype=torch.float64) tensor(-0.4583, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7734, dtype=torch.float64) delta_t tensor(0.1335, dtype=torch.float64)
13 gae_duplicate tensor(0.0132, dtype=torch.float64) tensor(-2.6575, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2302, dtype=torch.float64) delta_t tensor(0.0449, dtype=torch.float64)
12 gae_duplicate tensor(-0.2009, dtype=torch.float64) tensor(-1.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5390, dtype=torch.float64) delta_t tensor(0.1427, dtype=torch.float64)
11 gae_duplicate tensor(-0.0261, dtype=torch.float64) tensor(-2.9079, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1055, dtype=torch.float64) delta_t tensor(-0.0070, dtype=torch.float64)
10 gae_duplicate tensor(-0.1987, dtype=torch.float64) tensor(-0.0223, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4476, dtype=torch.float64) delta_t tensor(0.4097, dtype=torch.float64)
9 gae_duplicate tensor(0.1207, dtype=torch.float64) tensor(-8.1039, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7164, dtype=torch.float64) delta_t tensor(-0.0638, dtype=torch.float64)
8 gae_duplicate tensor(-0.4490, dtype=torch.float64) tensor(0.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3829, dtype=torch.float64) delta_t tensor(-0.6524, dtype=torch.float64)
7 gae_duplicate tensor(-6.2268, dtype=torch.float64) tensor(14.5000, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0664, dtype=torch.float64) delta_t tensor(-0.3581, dtype=torch.float64)
6 gae_duplicate tensor(-1.5254, dtype=torch.float64) tensor(8.0960, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1916, dtype=torch.float64) delta_t tensor(-0.4384, dtype=torch.float64)
5 gae_duplicate tensor(-0.9585, dtype=torch.float64) tensor(9.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3029, dtype=torch.float64) delta_t tensor(0.1874, dtype=torch.float64)
4 gae_duplicate tensor(-0.2174, dtype=torch.float64) tensor(-3.0358, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7774, dtype=torch.float64) delta_t tensor(-0.1663, dtype=torch.float64)
3 gae_duplicate tensor(-1.3229, dtype=torch.float64) tensor(3.2884, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0092, dtype=torch.float64) delta_t tensor(0.0876, dtype=torch.float64)
2 gae_duplicate tensor(-0.4050, dtype=torch.float64) tensor(-1.3992, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1053.337890625
value loss:90.56755065917969
entropies:354.5538635253906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.215572357177734 seconds
19 rew tensor(1.2362, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
19 gae_duplicate tensor(-0.1016, dtype=torch.float64) tensor(-1.6966, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2372, dtype=torch.float64) delta_t tensor(0.1981, dtype=torch.float64)
18 gae_duplicate tensor(-0.0021, dtype=torch.float64) tensor(-4.1410, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1349, dtype=torch.float64) delta_t tensor(0.0907, dtype=torch.float64)
17 gae_duplicate tensor(-0.0013, dtype=torch.float64) tensor(-2.1694, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0967, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
16 gae_duplicate tensor(-0.1296, dtype=torch.float64) tensor(-1.6245, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.1106, dtype=torch.float64) delta_t tensor(0.2756, dtype=torch.float64)
15 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(-5.4924, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0692, dtype=torch.float64) delta_t tensor(-0.4188, dtype=torch.float64)
14 gae_duplicate tensor(-2.4376, dtype=torch.float64) tensor(7.5705, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2028, dtype=torch.float64) delta_t tensor(-0.7969, dtype=torch.float64)
13 gae_duplicate tensor(-2.9424, dtype=torch.float64) tensor(16.1685, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3745, dtype=torch.float64) delta_t tensor(0.2209, dtype=torch.float64)
12 gae_duplicate tensor(-0.2079, dtype=torch.float64) tensor(-2.6407, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4372, dtype=torch.float64) delta_t tensor(0.0671, dtype=torch.float64)
11 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-1.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0392, dtype=torch.float64) delta_t tensor(0.1330, dtype=torch.float64)
10 gae_duplicate tensor(-0.0616, dtype=torch.float64) tensor(-2.7738, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4237, dtype=torch.float64) delta_t tensor(0.7225, dtype=torch.float64)
9 gae_duplicate tensor(0.3870, dtype=torch.float64) tensor(-14.9192, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5869, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
8 gae_duplicate tensor(-0.1815, dtype=torch.float64) tensor(-2.5002, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3287, dtype=torch.float64) delta_t tensor(-0.3220, dtype=torch.float64)
7 gae_duplicate tensor(-1.4713, dtype=torch.float64) tensor(6.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7445, dtype=torch.float64) delta_t tensor(-0.0352, dtype=torch.float64)
6 gae_duplicate tensor(-0.7177, dtype=torch.float64) tensor(1.1645, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6476, dtype=torch.float64) delta_t tensor(-0.6060, dtype=torch.float64)
5 gae_duplicate tensor(-1.0133, dtype=torch.float64) tensor(12.1924, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2412, dtype=torch.float64) delta_t tensor(0.2475, dtype=torch.float64)
4 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-3.5733, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4829, dtype=torch.float64) delta_t tensor(-0.5822, dtype=torch.float64)
3 gae_duplicate tensor(-1.0598, dtype=torch.float64) tensor(11.0399, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5777, dtype=torch.float64) delta_t tensor(0.4039, dtype=torch.float64)
2 gae_duplicate tensor(-0.0453, dtype=torch.float64) tensor(-6.5746, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-361.71148681640625
value loss:55.463417053222656
entropies:354.41412353515625
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3938.7527)
ToM Target loss= tensor(2104.2817)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.796816110610962 seconds
19 rew tensor(1.1063, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
19 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(1.5927, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0815, dtype=torch.float64) delta_t tensor(0.0177, dtype=torch.float64)
18 gae_duplicate tensor(-0.0638, dtype=torch.float64) tensor(-0.1432, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9258, dtype=torch.float64) delta_t tensor(-0.0832, dtype=torch.float64)
17 gae_duplicate tensor(-0.2587, dtype=torch.float64) tensor(1.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0321, dtype=torch.float64) delta_t tensor(-0.0262, dtype=torch.float64)
16 gae_duplicate tensor(-0.1279, dtype=torch.float64) tensor(0.6429, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9017, dtype=torch.float64) delta_t tensor(0.1837, dtype=torch.float64)
15 gae_duplicate tensor(-0.2045, dtype=torch.float64) tensor(-3.3883, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5982, dtype=torch.float64) delta_t tensor(-0.1917, dtype=torch.float64)
14 gae_duplicate tensor(-1.0167, dtype=torch.float64) tensor(3.3336, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5395, dtype=torch.float64) delta_t tensor(-0.0248, dtype=torch.float64)
13 gae_duplicate tensor(-0.2907, dtype=torch.float64) tensor(0.7677, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4650, dtype=torch.float64) delta_t tensor(0.1374, dtype=torch.float64)
12 gae_duplicate tensor(0.0028, dtype=torch.float64) tensor(-2.5926, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3331, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
11 gae_duplicate tensor(-0.2096, dtype=torch.float64) tensor(0.9463, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0389, dtype=torch.float64) delta_t tensor(0.2641, dtype=torch.float64)
10 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-5.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2676, dtype=torch.float64) delta_t tensor(0.4605, dtype=torch.float64)
9 gae_duplicate tensor(-0.0919, dtype=torch.float64) tensor(-9.4555, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3386, dtype=torch.float64) delta_t tensor(0.2296, dtype=torch.float64)
8 gae_duplicate tensor(0.0971, dtype=torch.float64) tensor(-5.6981, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0751, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
7 gae_duplicate tensor(-0.5056, dtype=torch.float64) tensor(1.8664, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6528, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
6 gae_duplicate tensor(-0.7353, dtype=torch.float64) tensor(-0.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4873, dtype=torch.float64) delta_t tensor(-0.6975, dtype=torch.float64)
5 gae_duplicate tensor(-0.9735, dtype=torch.float64) tensor(13.2702, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0205, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
4 gae_duplicate tensor(-0.4974, dtype=torch.float64) tensor(-0.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9833, dtype=torch.float64) delta_t tensor(-0.2160, dtype=torch.float64)
3 gae_duplicate tensor(-0.6010, dtype=torch.float64) tensor(4.1662, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3157, dtype=torch.float64) delta_t tensor(0.2160, dtype=torch.float64)
2 gae_duplicate tensor(-0.6649, dtype=torch.float64) tensor(-4.0313, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:122.72366333007812
value loss:23.514911651611328
entropies:354.3709411621094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.255136966705322 seconds
19 rew tensor(1.2370, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
19 gae_duplicate tensor(-0.0759, dtype=torch.float64) tensor(-1.8050, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1203, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
18 gae_duplicate tensor(-0.0586, dtype=torch.float64) tensor(-1.8790, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0557, dtype=torch.float64) delta_t tensor(0.1167, dtype=torch.float64)
17 gae_duplicate tensor(-0.0130, dtype=torch.float64) tensor(-2.4332, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9786, dtype=torch.float64) delta_t tensor(-0.0078, dtype=torch.float64)
16 gae_duplicate tensor(-0.1464, dtype=torch.float64) tensor(-0.1285, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9276, dtype=torch.float64) delta_t tensor(0.0845, dtype=torch.float64)
15 gae_duplicate tensor(-0.1903, dtype=torch.float64) tensor(-1.5650, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2164, dtype=torch.float64) delta_t tensor(-0.3025, dtype=torch.float64)
14 gae_duplicate tensor(-2.2473, dtype=torch.float64) tensor(5.3150, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4129, dtype=torch.float64) delta_t tensor(-0.1304, dtype=torch.float64)
13 gae_duplicate tensor(-1.2697, dtype=torch.float64) tensor(3.1660, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4273, dtype=torch.float64) delta_t tensor(0.1520, dtype=torch.float64)
12 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(-2.8568, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3160, dtype=torch.float64) delta_t tensor(-0.0468, dtype=torch.float64)
11 gae_duplicate tensor(-0.2528, dtype=torch.float64) tensor(0.6620, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0123, dtype=torch.float64) delta_t tensor(0.1803, dtype=torch.float64)
10 gae_duplicate tensor(-0.2788, dtype=torch.float64) tensor(-3.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3979, dtype=torch.float64) delta_t tensor(0.4201, dtype=torch.float64)
9 gae_duplicate tensor(0.2261, dtype=torch.float64) tensor(-9.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5211, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
8 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(-2.7150, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9765, dtype=torch.float64) delta_t tensor(-0.1653, dtype=torch.float64)
7 gae_duplicate tensor(-2.6979, dtype=torch.float64) tensor(2.2242, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8424, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
6 gae_duplicate tensor(-1.0703, dtype=torch.float64) tensor(2.1416, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3415, dtype=torch.float64) delta_t tensor(-0.4255, dtype=torch.float64)
5 gae_duplicate tensor(-1.0389, dtype=torch.float64) tensor(8.2129, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2003, dtype=torch.float64) delta_t tensor(0.1322, dtype=torch.float64)
4 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(-1.5732, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8468, dtype=torch.float64) delta_t tensor(-0.1962, dtype=torch.float64)
3 gae_duplicate tensor(-0.6760, dtype=torch.float64) tensor(3.9185, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0982, dtype=torch.float64) delta_t tensor(-0.0948, dtype=torch.float64)
2 gae_duplicate tensor(-0.7280, dtype=torch.float64) tensor(2.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-131.8907470703125
value loss:39.98796463012695
entropies:354.3828430175781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.159846067428589 seconds
19 rew tensor(1.1721, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
19 gae_duplicate tensor(-0.2256, dtype=torch.float64) tensor(-0.3497, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1340, dtype=torch.float64) delta_t tensor(0.0952, dtype=torch.float64)
18 gae_duplicate tensor(-0.1316, dtype=torch.float64) tensor(-2.1066, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7649, dtype=torch.float64) delta_t tensor(-0.2776, dtype=torch.float64)
17 gae_duplicate tensor(-1.5889, dtype=torch.float64) tensor(5.5203, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9671, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
16 gae_duplicate tensor(-0.2762, dtype=torch.float64) tensor(1.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6281, dtype=torch.float64) delta_t tensor(-0.3595, dtype=torch.float64)
15 gae_duplicate tensor(-1.4393, dtype=torch.float64) tensor(7.4954, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7856, dtype=torch.float64) delta_t tensor(0.2480, dtype=torch.float64)
14 gae_duplicate tensor(-0.3184, dtype=torch.float64) tensor(-4.3967, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7194, dtype=torch.float64) delta_t tensor(-0.0369, dtype=torch.float64)
13 gae_duplicate tensor(-0.3219, dtype=torch.float64) tensor(0.1530, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3087, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
12 gae_duplicate tensor(-0.1933, dtype=torch.float64) tensor(-1.6445, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5896, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
11 gae_duplicate tensor(0.0333, dtype=torch.float64) tensor(-5.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0913, dtype=torch.float64) delta_t tensor(-0.0542, dtype=torch.float64)
10 gae_duplicate tensor(-0.1792, dtype=torch.float64) tensor(0.6290, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2559, dtype=torch.float64) delta_t tensor(0.5111, dtype=torch.float64)
9 gae_duplicate tensor(0.3435, dtype=torch.float64) tensor(-10.0706, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6103, dtype=torch.float64) delta_t tensor(0.0432, dtype=torch.float64)
8 gae_duplicate tensor(-0.2029, dtype=torch.float64) tensor(-1.8208, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6868, dtype=torch.float64) delta_t tensor(-0.7884, dtype=torch.float64)
7 gae_duplicate tensor(-5.1703, dtype=torch.float64) tensor(15.4322, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7176, dtype=torch.float64) delta_t tensor(-0.0670, dtype=torch.float64)
6 gae_duplicate tensor(-1.0959, dtype=torch.float64) tensor(2.9150, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6499, dtype=torch.float64) delta_t tensor(-0.6953, dtype=torch.float64)
5 gae_duplicate tensor(-1.1401, dtype=torch.float64) tensor(14.3557, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0887, dtype=torch.float64) delta_t tensor(0.1128, dtype=torch.float64)
4 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(-0.8235, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3198, dtype=torch.float64) delta_t tensor(-0.3715, dtype=torch.float64)
3 gae_duplicate tensor(-1.2899, dtype=torch.float64) tensor(7.3123, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4249, dtype=torch.float64) delta_t tensor(0.2413, dtype=torch.float64)
2 gae_duplicate tensor(-0.1874, dtype=torch.float64) tensor(-4.1209, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1423.3094482421875
value loss:71.80815124511719
entropies:354.4859924316406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.997774124145508 seconds
19 rew tensor(1.1587, dtype=torch.float64) delta_t tensor(0.0025, dtype=torch.float64)
19 gae_duplicate tensor(-0.2109, dtype=torch.float64) tensor(-0.0551, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1465, dtype=torch.float64) delta_t tensor(0.1104, dtype=torch.float64)
18 gae_duplicate tensor(-0.0388, dtype=torch.float64) tensor(-2.1691, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0951, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
17 gae_duplicate tensor(-0.0937, dtype=torch.float64) tensor(-1.3687, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9530, dtype=torch.float64) delta_t tensor(-0.0178, dtype=torch.float64)
16 gae_duplicate tensor(-0.2299, dtype=torch.float64) tensor(0.1104, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9015, dtype=torch.float64) delta_t tensor(-0.0300, dtype=torch.float64)
15 gae_duplicate tensor(-0.1945, dtype=torch.float64) tensor(0.6260, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7100, dtype=torch.float64) delta_t tensor(0.0347, dtype=torch.float64)
14 gae_duplicate tensor(-0.2503, dtype=torch.float64) tensor(-0.5814, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1954, dtype=torch.float64) delta_t tensor(-0.4026, dtype=torch.float64)
13 gae_duplicate tensor(-1.7026, dtype=torch.float64) tensor(7.8727, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0796, dtype=torch.float64) delta_t tensor(-0.1231, dtype=torch.float64)
12 gae_duplicate tensor(-1.2570, dtype=torch.float64) tensor(3.0353, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4740, dtype=torch.float64) delta_t tensor(0.1438, dtype=torch.float64)
11 gae_duplicate tensor(-0.1681, dtype=torch.float64) tensor(-2.5921, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0233, dtype=torch.float64) delta_t tensor(0.1067, dtype=torch.float64)
10 gae_duplicate tensor(-0.2182, dtype=torch.float64) tensor(-2.3868, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3708, dtype=torch.float64) delta_t tensor(0.5913, dtype=torch.float64)
9 gae_duplicate tensor(0.3536, dtype=torch.float64) tensor(-11.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6081, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
8 gae_duplicate tensor(-0.1723, dtype=torch.float64) tensor(-1.9705, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5816, dtype=torch.float64) delta_t tensor(0.2550, dtype=torch.float64)
7 gae_duplicate tensor(-0.5738, dtype=torch.float64) tensor(-5.6434, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7256, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
6 gae_duplicate tensor(-0.3294, dtype=torch.float64) tensor(0.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4697, dtype=torch.float64) delta_t tensor(-0.5401, dtype=torch.float64)
5 gae_duplicate tensor(-0.9909, dtype=torch.float64) tensor(10.5983, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0385, dtype=torch.float64) delta_t tensor(0.1291, dtype=torch.float64)
4 gae_duplicate tensor(-0.0932, dtype=torch.float64) tensor(-1.5098, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9948, dtype=torch.float64) delta_t tensor(-0.2758, dtype=torch.float64)
3 gae_duplicate tensor(-0.9275, dtype=torch.float64) tensor(5.1598, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3102, dtype=torch.float64) delta_t tensor(0.1251, dtype=torch.float64)
2 gae_duplicate tensor(-0.1930, dtype=torch.float64) tensor(-2.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:126.8106460571289
value loss:25.13434410095215
entropies:354.5889892578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.368450164794922 seconds
19 rew tensor(1.2238, dtype=torch.float64) delta_t tensor(0.0708, dtype=torch.float64)
19 gae_duplicate tensor(-0.2301, dtype=torch.float64) tensor(-1.4203, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9647, dtype=torch.float64) delta_t tensor(-0.0479, dtype=torch.float64)
18 gae_duplicate tensor(-1.3145, dtype=torch.float64) tensor(1.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8552, dtype=torch.float64) delta_t tensor(-0.1721, dtype=torch.float64)
17 gae_duplicate tensor(-1.4788, dtype=torch.float64) tensor(3.5012, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0059, dtype=torch.float64) delta_t tensor(0.0396, dtype=torch.float64)
16 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-0.4703, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9140, dtype=torch.float64) delta_t tensor(0.1994, dtype=torch.float64)
15 gae_duplicate tensor(-0.1693, dtype=torch.float64) tensor(-3.9184, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7366, dtype=torch.float64) delta_t tensor(-0.0751, dtype=torch.float64)
14 gae_duplicate tensor(-0.2880, dtype=torch.float64) tensor(0.9780, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5654, dtype=torch.float64) delta_t tensor(0.1783, dtype=torch.float64)
13 gae_duplicate tensor(-0.0011, dtype=torch.float64) tensor(-3.3186, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1725, dtype=torch.float64) delta_t tensor(-0.0399, dtype=torch.float64)
12 gae_duplicate tensor(-0.5517, dtype=torch.float64) tensor(0.4725, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0632, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
11 gae_duplicate tensor(-0.2994, dtype=torch.float64) tensor(0.0284, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1826, dtype=torch.float64) delta_t tensor(0.2712, dtype=torch.float64)
10 gae_duplicate tensor(0.0058, dtype=torch.float64) tensor(-5.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0709, dtype=torch.float64) delta_t tensor(0.4259, dtype=torch.float64)
9 gae_duplicate tensor(0.1845, dtype=torch.float64) tensor(-8.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5039, dtype=torch.float64) delta_t tensor(0.1993, dtype=torch.float64)
8 gae_duplicate tensor(-0.0704, dtype=torch.float64) tensor(-4.9010, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0334, dtype=torch.float64) delta_t tensor(-0.0808, dtype=torch.float64)
7 gae_duplicate tensor(-0.8342, dtype=torch.float64) tensor(1.4958, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6723, dtype=torch.float64) delta_t tensor(0.0621, dtype=torch.float64)
6 gae_duplicate tensor(-0.2702, dtype=torch.float64) tensor(-1.1042, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7528, dtype=torch.float64) delta_t tensor(-0.7210, dtype=torch.float64)
5 gae_duplicate tensor(-1.1832, dtype=torch.float64) tensor(14.1057, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0677, dtype=torch.float64) delta_t tensor(0.2459, dtype=torch.float64)
4 gae_duplicate tensor(-0.1023, dtype=torch.float64) tensor(-3.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3576, dtype=torch.float64) delta_t tensor(-0.3920, dtype=torch.float64)
3 gae_duplicate tensor(-1.2696, dtype=torch.float64) tensor(7.5035, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4042, dtype=torch.float64) delta_t tensor(0.1868, dtype=torch.float64)
2 gae_duplicate tensor(-0.7815, dtype=torch.float64) tensor(-2.8273, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:249.828125
value loss:33.08137130737305
entropies:354.74267578125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3956.0857)
ToM Target loss= tensor(2070.6023)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.218247175216675 seconds
19 rew tensor(1.1824, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
19 gae_duplicate tensor(-0.1924, dtype=torch.float64) tensor(-0.9537, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1835, dtype=torch.float64) delta_t tensor(0.1588, dtype=torch.float64)
18 gae_duplicate tensor(-0.1306, dtype=torch.float64) tensor(-3.2349, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1576, dtype=torch.float64) delta_t tensor(0.1467, dtype=torch.float64)
17 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-3.2676, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0682, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
16 gae_duplicate tensor(-0.0728, dtype=torch.float64) tensor(-1.5005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7462, dtype=torch.float64) delta_t tensor(-0.1021, dtype=torch.float64)
15 gae_duplicate tensor(-1.3534, dtype=torch.float64) tensor(1.6145, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5917, dtype=torch.float64) delta_t tensor(-0.2581, dtype=torch.float64)
14 gae_duplicate tensor(-1.6525, dtype=torch.float64) tensor(4.9308, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.1937, dtype=torch.float64) delta_t tensor(-0.5879, dtype=torch.float64)
13 gae_duplicate tensor(-4.9329, dtype=torch.float64) tensor(12.1846, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6437, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
12 gae_duplicate tensor(-0.0586, dtype=torch.float64) tensor(-2.1742, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1808, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
11 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-1.2048, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.3867, dtype=torch.float64) delta_t tensor(0.5668, dtype=torch.float64)
10 gae_duplicate tensor(0.0002, dtype=torch.float64) tensor(-11.2726, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0124, dtype=torch.float64) delta_t tensor(0.3969, dtype=torch.float64)
9 gae_duplicate tensor(0.1400, dtype=torch.float64) tensor(-8.8749, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4800, dtype=torch.float64) delta_t tensor(0.2634, dtype=torch.float64)
8 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-5.9329, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9831, dtype=torch.float64) delta_t tensor(-0.9139, dtype=torch.float64)
7 gae_duplicate tensor(-3.4871, dtype=torch.float64) tensor(18.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7172, dtype=torch.float64) delta_t tensor(-0.0829, dtype=torch.float64)
6 gae_duplicate tensor(-1.1862, dtype=torch.float64) tensor(3.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7958, dtype=torch.float64) delta_t tensor(-0.7463, dtype=torch.float64)
5 gae_duplicate tensor(-1.1160, dtype=torch.float64) tensor(15.6679, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4762, dtype=torch.float64) delta_t tensor(0.3818, dtype=torch.float64)
4 gae_duplicate tensor(-0.0779, dtype=torch.float64) tensor(-6.2668, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8424, dtype=torch.float64) delta_t tensor(-0.8845, dtype=torch.float64)
3 gae_duplicate tensor(-1.2731, dtype=torch.float64) tensor(16.4340, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8248, dtype=torch.float64) delta_t tensor(0.6452, dtype=torch.float64)
2 gae_duplicate tensor(-0.0207, dtype=torch.float64) tensor(-10.7089, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1001.3895874023438
value loss:98.58882141113281
entropies:354.8526611328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.932772159576416 seconds
19 rew tensor(1.2196, dtype=torch.float64) delta_t tensor(0.0836, dtype=torch.float64)
19 gae_duplicate tensor(-0.0559, dtype=torch.float64) tensor(-1.6327, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2073, dtype=torch.float64) delta_t tensor(0.1917, dtype=torch.float64)
18 gae_duplicate tensor(0.1155, dtype=torch.float64) tensor(-3.8986, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1439, dtype=torch.float64) delta_t tensor(0.1222, dtype=torch.float64)
17 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-2.7807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0535, dtype=torch.float64) delta_t tensor(0.0943, dtype=torch.float64)
16 gae_duplicate tensor(-0.0459, dtype=torch.float64) tensor(-2.1368, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0421, dtype=torch.float64) delta_t tensor(0.2503, dtype=torch.float64)
15 gae_duplicate tensor(-0.0944, dtype=torch.float64) tensor(-5.1351, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.3068, dtype=torch.float64) delta_t tensor(-0.9386, dtype=torch.float64)
14 gae_duplicate tensor(-2.9828, dtype=torch.float64) tensor(18.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6003, dtype=torch.float64) delta_t tensor(-0.0721, dtype=torch.float64)
13 gae_duplicate tensor(-0.7527, dtype=torch.float64) tensor(3.3717, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5249, dtype=torch.float64) delta_t tensor(0.2622, dtype=torch.float64)
12 gae_duplicate tensor(-0.0462, dtype=torch.float64) tensor(-4.6599, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0889, dtype=torch.float64) delta_t tensor(-0.3942, dtype=torch.float64)
11 gae_duplicate tensor(-2.4708, dtype=torch.float64) tensor(7.7267, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.9555, dtype=torch.float64) delta_t tensor(-0.8717, dtype=torch.float64)
10 gae_duplicate tensor(-5.6507, dtype=torch.float64) tensor(18.8783, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0688, dtype=torch.float64) delta_t tensor(0.0067, dtype=torch.float64)
9 gae_duplicate tensor(-3.3481, dtype=torch.float64) tensor(1.7917, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6201, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
8 gae_duplicate tensor(-0.2325, dtype=torch.float64) tensor(-0.8894, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2251, dtype=torch.float64) delta_t tensor(0.5381, dtype=torch.float64)
7 gae_duplicate tensor(0.1417, dtype=torch.float64) tensor(-10.7626, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8251, dtype=torch.float64) delta_t tensor(-0.1114, dtype=torch.float64)
6 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(1.1219, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3071, dtype=torch.float64) delta_t tensor(-0.3467, dtype=torch.float64)
5 gae_duplicate tensor(-0.5341, dtype=torch.float64) tensor(7.1538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2455, dtype=torch.float64) delta_t tensor(0.0408, dtype=torch.float64)
4 gae_duplicate tensor(-0.2099, dtype=torch.float64) tensor(-0.0678, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7793, dtype=torch.float64) delta_t tensor(-0.1714, dtype=torch.float64)
3 gae_duplicate tensor(-0.6374, dtype=torch.float64) tensor(3.3544, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1024, dtype=torch.float64) delta_t tensor(-0.0906, dtype=torch.float64)
2 gae_duplicate tensor(-0.4880, dtype=torch.float64) tensor(1.9771, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1818.5426025390625
value loss:110.38780975341797
entropies:354.9070739746094
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.332546949386597 seconds
19 rew tensor(1.1169, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
19 gae_duplicate tensor(-0.1189, dtype=torch.float64) tensor(0.8841, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1430, dtype=torch.float64) delta_t tensor(0.0882, dtype=torch.float64)
18 gae_duplicate tensor(-0.1097, dtype=torch.float64) tensor(-1.6637, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0154, dtype=torch.float64) delta_t tensor(-0.0234, dtype=torch.float64)
17 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(0.2538, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9388, dtype=torch.float64) delta_t tensor(0.0054, dtype=torch.float64)
16 gae_duplicate tensor(-0.0485, dtype=torch.float64) tensor(-0.0721, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8486, dtype=torch.float64) delta_t tensor(-0.0310, dtype=torch.float64)
15 gae_duplicate tensor(-0.1634, dtype=torch.float64) tensor(0.5751, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6056, dtype=torch.float64) delta_t tensor(0.1120, dtype=torch.float64)
14 gae_duplicate tensor(-0.1462, dtype=torch.float64) tensor(-2.3064, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5786, dtype=torch.float64) delta_t tensor(-0.1161, dtype=torch.float64)
13 gae_duplicate tensor(-0.1514, dtype=torch.float64) tensor(2.0263, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2967, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
12 gae_duplicate tensor(-0.0759, dtype=torch.float64) tensor(-0.3573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4753, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
11 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(0.6124, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0131, dtype=torch.float64) delta_t tensor(0.1156, dtype=torch.float64)
10 gae_duplicate tensor(-0.1844, dtype=torch.float64) tensor(-2.2241, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3687, dtype=torch.float64) delta_t tensor(0.2647, dtype=torch.float64)
9 gae_duplicate tensor(0.1195, dtype=torch.float64) tensor(-5.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7067, dtype=torch.float64) delta_t tensor(0.0090, dtype=torch.float64)
8 gae_duplicate tensor(-0.3457, dtype=torch.float64) tensor(-0.6692, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3160, dtype=torch.float64) delta_t tensor(0.4270, dtype=torch.float64)
7 gae_duplicate tensor(-0.9210, dtype=torch.float64) tensor(-8.2282, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7209, dtype=torch.float64) delta_t tensor(-0.0799, dtype=torch.float64)
6 gae_duplicate tensor(-0.3384, dtype=torch.float64) tensor(0.5957, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2808, dtype=torch.float64) delta_t tensor(-0.4289, dtype=torch.float64)
5 gae_duplicate tensor(-1.1197, dtype=torch.float64) tensor(8.5366, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1928, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
4 gae_duplicate tensor(-0.2376, dtype=torch.float64) tensor(-1.2483, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6903, dtype=torch.float64) delta_t tensor(-0.2529, dtype=torch.float64)
3 gae_duplicate tensor(-1.1371, dtype=torch.float64) tensor(5.1244, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1936, dtype=torch.float64) delta_t tensor(0.0172, dtype=torch.float64)
2 gae_duplicate tensor(-0.3600, dtype=torch.float64) tensor(0.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:74.8944091796875
value loss:18.408540725708008
entropies:354.9112548828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.611043691635132 seconds
19 rew tensor(1.1535, dtype=torch.float64) delta_t tensor(0.0262, dtype=torch.float64)
19 gae_duplicate tensor(-0.1817, dtype=torch.float64) tensor(-0.6056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1282, dtype=torch.float64) delta_t tensor(0.1207, dtype=torch.float64)
18 gae_duplicate tensor(-0.0960, dtype=torch.float64) tensor(-2.3527, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1032, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
17 gae_duplicate tensor(-0.0131, dtype=torch.float64) tensor(-1.9930, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9881, dtype=torch.float64) delta_t tensor(0.0185, dtype=torch.float64)
16 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(-0.6161, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9624, dtype=torch.float64) delta_t tensor(-0.0368, dtype=torch.float64)
15 gae_duplicate tensor(-0.1615, dtype=torch.float64) tensor(0.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7952, dtype=torch.float64) delta_t tensor(0.1154, dtype=torch.float64)
14 gae_duplicate tensor(-0.1166, dtype=torch.float64) tensor(-2.3349, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8868, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
13 gae_duplicate tensor(-0.0671, dtype=torch.float64) tensor(-1.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.6095, dtype=torch.float64) delta_t tensor(-0.7295, dtype=torch.float64)
12 gae_duplicate tensor(-5.1384, dtype=torch.float64) tensor(13.3147, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.8339, dtype=torch.float64) delta_t tensor(-1.1852, dtype=torch.float64)
11 gae_duplicate tensor(-5.6680, dtype=torch.float64) tensor(25.1572, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0478, dtype=torch.float64) delta_t tensor(0.1794, dtype=torch.float64)
10 gae_duplicate tensor(-0.1811, dtype=torch.float64) tensor(-1.0710, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3606, dtype=torch.float64) delta_t tensor(0.5468, dtype=torch.float64)
9 gae_duplicate tensor(0.2939, dtype=torch.float64) tensor(-11.2083, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4395, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
8 gae_duplicate tensor(-0.1002, dtype=torch.float64) tensor(-4.0576, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4864, dtype=torch.float64) delta_t tensor(0.3287, dtype=torch.float64)
7 gae_duplicate tensor(-0.0545, dtype=torch.float64) tensor(-7.1746, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7079, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
6 gae_duplicate tensor(-0.5238, dtype=torch.float64) tensor(-0.8852, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4123, dtype=torch.float64) delta_t tensor(-0.4329, dtype=torch.float64)
5 gae_duplicate tensor(-0.8467, dtype=torch.float64) tensor(8.4569, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1662, dtype=torch.float64) delta_t tensor(0.1650, dtype=torch.float64)
4 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-2.3984, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8601, dtype=torch.float64) delta_t tensor(-0.0818, dtype=torch.float64)
3 gae_duplicate tensor(-0.7552, dtype=torch.float64) tensor(1.6102, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1814, dtype=torch.float64) delta_t tensor(-0.0403, dtype=torch.float64)
2 gae_duplicate tensor(-0.7980, dtype=torch.float64) tensor(0.7355, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-836.6951904296875
value loss:111.01355743408203
entropies:354.9139404296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.602973937988281 seconds
19 rew tensor(1.1292, dtype=torch.float64) delta_t tensor(-0.0120, dtype=torch.float64)
19 gae_duplicate tensor(-0.2207, dtype=torch.float64) tensor(0.2757, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0901, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
18 gae_duplicate tensor(-0.0543, dtype=torch.float64) tensor(-1.0304, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0910, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
17 gae_duplicate tensor(-0.1598, dtype=torch.float64) tensor(-1.4921, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9890, dtype=torch.float64) delta_t tensor(-0.0015, dtype=torch.float64)
16 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(-0.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8611, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
15 gae_duplicate tensor(-0.3466, dtype=torch.float64) tensor(1.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8726, dtype=torch.float64) delta_t tensor(0.1636, dtype=torch.float64)
14 gae_duplicate tensor(-0.1916, dtype=torch.float64) tensor(-2.9224, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1027, dtype=torch.float64) delta_t tensor(-0.4940, dtype=torch.float64)
13 gae_duplicate tensor(-2.7513, dtype=torch.float64) tensor(9.6639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4201, dtype=torch.float64) delta_t tensor(-0.0137, dtype=torch.float64)
12 gae_duplicate tensor(-0.2068, dtype=torch.float64) tensor(1.2581, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2713, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
11 gae_duplicate tensor(-0.2332, dtype=torch.float64) tensor(-1.4720, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0738, dtype=torch.float64) delta_t tensor(0.1231, dtype=torch.float64)
10 gae_duplicate tensor(-0.1254, dtype=torch.float64) tensor(-2.5447, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1819, dtype=torch.float64) delta_t tensor(0.4412, dtype=torch.float64)
9 gae_duplicate tensor(0.2995, dtype=torch.float64) tensor(-8.7792, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3756, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
8 gae_duplicate tensor(-0.0029, dtype=torch.float64) tensor(-4.8995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0281, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
7 gae_duplicate tensor(-0.3384, dtype=torch.float64) tensor(-0.4951, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.4789, dtype=torch.float64) delta_t tensor(0.2317, dtype=torch.float64)
6 gae_duplicate tensor(0.1167, dtype=torch.float64) tensor(-4.6821, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7631, dtype=torch.float64) delta_t tensor(-0.7006, dtype=torch.float64)
5 gae_duplicate tensor(-0.9242, dtype=torch.float64) tensor(13.5409, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0864, dtype=torch.float64) delta_t tensor(0.1136, dtype=torch.float64)
4 gae_duplicate tensor(-0.1359, dtype=torch.float64) tensor(-0.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2122, dtype=torch.float64) delta_t tensor(-0.3184, dtype=torch.float64)
3 gae_duplicate tensor(-0.4991, dtype=torch.float64) tensor(6.2845, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4459, dtype=torch.float64) delta_t tensor(0.2335, dtype=torch.float64)
2 gae_duplicate tensor(-0.0804, dtype=torch.float64) tensor(-4.1181, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-42.7824821472168
value loss:26.780546188354492
entropies:354.9822082519531
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.9663)
ToM Target loss= tensor(2035.7279)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.290192127227783 seconds
19 rew tensor(1.2171, dtype=torch.float64) delta_t tensor(0.0944, dtype=torch.float64)
19 gae_duplicate tensor(-0.1658, dtype=torch.float64) tensor(-1.8229, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1791, dtype=torch.float64) delta_t tensor(0.1774, dtype=torch.float64)
18 gae_duplicate tensor(-0.0872, dtype=torch.float64) tensor(-3.7033, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1428, dtype=torch.float64) delta_t tensor(0.1337, dtype=torch.float64)
17 gae_duplicate tensor(-0.0062, dtype=torch.float64) tensor(-2.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0420, dtype=torch.float64) delta_t tensor(0.0786, dtype=torch.float64)
16 gae_duplicate tensor(-0.0655, dtype=torch.float64) tensor(-1.8916, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0018, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
15 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-0.5935, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6821, dtype=torch.float64) delta_t tensor(-0.0960, dtype=torch.float64)
14 gae_duplicate tensor(-0.3335, dtype=torch.float64) tensor(1.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(-0.2016, dtype=torch.float64) delta_t tensor(-0.5564, dtype=torch.float64)
13 gae_duplicate tensor(-2.7065, dtype=torch.float64) tensor(11.7409, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4500, dtype=torch.float64) delta_t tensor(0.2484, dtype=torch.float64)
12 gae_duplicate tensor(0.0394, dtype=torch.float64) tensor(-3.8642, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3713, dtype=torch.float64) delta_t tensor(0.0161, dtype=torch.float64)
11 gae_duplicate tensor(-0.1550, dtype=torch.float64) tensor(-0.7216, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0638, dtype=torch.float64) delta_t tensor(0.1241, dtype=torch.float64)
10 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-2.5779, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4483, dtype=torch.float64) delta_t tensor(0.6938, dtype=torch.float64)
9 gae_duplicate tensor(0.3981, dtype=torch.float64) tensor(-14.0928, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5534, dtype=torch.float64) delta_t tensor(0.0584, dtype=torch.float64)
8 gae_duplicate tensor(-0.2475, dtype=torch.float64) tensor(-2.6218, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0433, dtype=torch.float64) delta_t tensor(0.0254, dtype=torch.float64)
7 gae_duplicate tensor(-0.5704, dtype=torch.float64) tensor(-0.8017, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6697, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
6 gae_duplicate tensor(-0.2857, dtype=torch.float64) tensor(-1.2744, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6872, dtype=torch.float64) delta_t tensor(-0.5573, dtype=torch.float64)
5 gae_duplicate tensor(-0.8579, dtype=torch.float64) tensor(10.9561, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(0.1723, dtype=torch.float64)
4 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-2.3715, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4054, dtype=torch.float64) delta_t tensor(-0.3502, dtype=torch.float64)
3 gae_duplicate tensor(-0.9074, dtype=torch.float64) tensor(6.7418, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4989, dtype=torch.float64) delta_t tensor(0.2831, dtype=torch.float64)
2 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-5.1204, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:616.1221313476562
value loss:30.34576988220215
entropies:354.9878845214844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.802127122879028 seconds
19 rew tensor(1.1544, dtype=torch.float64) delta_t tensor(0.0270, dtype=torch.float64)
19 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-0.4952, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1287, dtype=torch.float64) delta_t tensor(0.1113, dtype=torch.float64)
18 gae_duplicate tensor(-0.0977, dtype=torch.float64) tensor(-2.2957, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8514, dtype=torch.float64) delta_t tensor(-0.1699, dtype=torch.float64)
17 gae_duplicate tensor(-1.5419, dtype=torch.float64) tensor(2.8139, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9753, dtype=torch.float64) delta_t tensor(-0.0147, dtype=torch.float64)
16 gae_duplicate tensor(-0.2471, dtype=torch.float64) tensor(0.5663, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9253, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
15 gae_duplicate tensor(-0.1567, dtype=torch.float64) tensor(1.6310, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.1771, dtype=torch.float64) delta_t tensor(-0.5301, dtype=torch.float64)
14 gae_duplicate tensor(-2.7040, dtype=torch.float64) tensor(10.2531, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6809, dtype=torch.float64) delta_t tensor(-0.0362, dtype=torch.float64)
13 gae_duplicate tensor(-0.5474, dtype=torch.float64) tensor(1.8074, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3714, dtype=torch.float64) delta_t tensor(0.0725, dtype=torch.float64)
12 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-1.2329, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4260, dtype=torch.float64) delta_t tensor(0.1881, dtype=torch.float64)
11 gae_duplicate tensor(0.0606, dtype=torch.float64) tensor(-3.8131, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0401, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
10 gae_duplicate tensor(-0.2002, dtype=torch.float64) tensor(-0.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2712, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
9 gae_duplicate tensor(0.3492, dtype=torch.float64) tensor(-10.3210, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4769, dtype=torch.float64) delta_t tensor(0.1511, dtype=torch.float64)
8 gae_duplicate tensor(0.0520, dtype=torch.float64) tensor(-3.9416, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8410, dtype=torch.float64) delta_t tensor(0.1141, dtype=torch.float64)
7 gae_duplicate tensor(-0.4995, dtype=torch.float64) tensor(-2.6955, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5671, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
6 gae_duplicate tensor(-0.1411, dtype=torch.float64) tensor(-1.9277, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6071, dtype=torch.float64) delta_t tensor(-0.5717, dtype=torch.float64)
5 gae_duplicate tensor(-0.7129, dtype=torch.float64) tensor(10.9315, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0558, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
4 gae_duplicate tensor(-0.1993, dtype=torch.float64) tensor(-1.1347, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1262, dtype=torch.float64) delta_t tensor(-0.1766, dtype=torch.float64)
3 gae_duplicate tensor(-0.9554, dtype=torch.float64) tensor(3.4222, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4029, dtype=torch.float64) delta_t tensor(0.1826, dtype=torch.float64)
2 gae_duplicate tensor(-0.1896, dtype=torch.float64) tensor(-3.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-63.904144287109375
value loss:28.366304397583008
entropies:354.9850769042969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.04440712928772 seconds
19 rew tensor(1.2305, dtype=torch.float64) delta_t tensor(0.1133, dtype=torch.float64)
19 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-2.2324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1798, dtype=torch.float64) delta_t tensor(0.1911, dtype=torch.float64)
18 gae_duplicate tensor(-0.0083, dtype=torch.float64) tensor(-3.8682, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1032, dtype=torch.float64) delta_t tensor(0.1047, dtype=torch.float64)
17 gae_duplicate tensor(-0.1375, dtype=torch.float64) tensor(-2.4373, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0267, dtype=torch.float64) delta_t tensor(0.0559, dtype=torch.float64)
16 gae_duplicate tensor(-0.2522, dtype=torch.float64) tensor(-1.2124, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9746, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
15 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-4.3507, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2770, dtype=torch.float64) delta_t tensor(-0.4410, dtype=torch.float64)
14 gae_duplicate tensor(-2.7299, dtype=torch.float64) tensor(7.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.0930, dtype=torch.float64) delta_t tensor(-0.4348, dtype=torch.float64)
13 gae_duplicate tensor(-2.1990, dtype=torch.float64) tensor(9.1171, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0571, dtype=torch.float64) delta_t tensor(-0.2282, dtype=torch.float64)
12 gae_duplicate tensor(-2.5005, dtype=torch.float64) tensor(5.8393, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.0741, dtype=torch.float64) delta_t tensor(-0.3193, dtype=torch.float64)
11 gae_duplicate tensor(-1.8073, dtype=torch.float64) tensor(7.1293, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1030, dtype=torch.float64) delta_t tensor(0.2687, dtype=torch.float64)
10 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-4.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(0.4887, dtype=torch.float64)
9 gae_duplicate tensor(0.0773, dtype=torch.float64) tensor(-10.3558, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5393, dtype=torch.float64) delta_t tensor(0.1161, dtype=torch.float64)
8 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-3.3445, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6691, dtype=torch.float64) delta_t tensor(-0.6551, dtype=torch.float64)
7 gae_duplicate tensor(-3.9324, dtype=torch.float64) tensor(12.6223, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7185, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
6 gae_duplicate tensor(-0.8491, dtype=torch.float64) tensor(1.4481, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5611, dtype=torch.float64) delta_t tensor(-0.4825, dtype=torch.float64)
5 gae_duplicate tensor(-1.0065, dtype=torch.float64) tensor(9.4574, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1405, dtype=torch.float64) delta_t tensor(0.3084, dtype=torch.float64)
4 gae_duplicate tensor(0.0107, dtype=torch.float64) tensor(-4.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3397, dtype=torch.float64) delta_t tensor(-0.4764, dtype=torch.float64)
3 gae_duplicate tensor(-1.0778, dtype=torch.float64) tensor(9.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4881, dtype=torch.float64) delta_t tensor(0.2759, dtype=torch.float64)
2 gae_duplicate tensor(-0.4919, dtype=torch.float64) tensor(-4.3713, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1215.8763427734375
value loss:80.08528900146484
entropies:354.9551696777344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.153972864151001 seconds
19 rew tensor(1.1031, dtype=torch.float64) delta_t tensor(-0.0475, dtype=torch.float64)
19 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(0.9441, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0906, dtype=torch.float64) delta_t tensor(0.0515, dtype=torch.float64)
18 gae_duplicate tensor(-0.0927, dtype=torch.float64) tensor(-0.8942, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0141, dtype=torch.float64) delta_t tensor(-0.0166, dtype=torch.float64)
17 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(0.2473, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8869, dtype=torch.float64) delta_t tensor(-0.0533, dtype=torch.float64)
16 gae_duplicate tensor(-0.0991, dtype=torch.float64) tensor(1.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(-0.1303, dtype=torch.float64)
15 gae_duplicate tensor(-0.1608, dtype=torch.float64) tensor(2.6470, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5657, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
14 gae_duplicate tensor(-0.1717, dtype=torch.float64) tensor(-2.5930, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8090, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
13 gae_duplicate tensor(-0.2137, dtype=torch.float64) tensor(0.2304, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1806, dtype=torch.float64) delta_t tensor(0.0516, dtype=torch.float64)
12 gae_duplicate tensor(-0.2024, dtype=torch.float64) tensor(-0.9437, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4847, dtype=torch.float64) delta_t tensor(0.0236, dtype=torch.float64)
11 gae_duplicate tensor(-0.0774, dtype=torch.float64) tensor(-0.5863, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(-0.0517, dtype=torch.float64)
10 gae_duplicate tensor(-0.1862, dtype=torch.float64) tensor(0.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4381, dtype=torch.float64) delta_t tensor(0.3414, dtype=torch.float64)
9 gae_duplicate tensor(0.0807, dtype=torch.float64) tensor(-6.6844, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5779, dtype=torch.float64) delta_t tensor(-0.0043, dtype=torch.float64)
8 gae_duplicate tensor(-0.5500, dtype=torch.float64) tensor(-0.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4037, dtype=torch.float64) delta_t tensor(0.3817, dtype=torch.float64)
7 gae_duplicate tensor(-0.0653, dtype=torch.float64) tensor(-7.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6038, dtype=torch.float64) delta_t tensor(0.0296, dtype=torch.float64)
6 gae_duplicate tensor(-0.4826, dtype=torch.float64) tensor(-1.4104, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4049, dtype=torch.float64) delta_t tensor(-0.4624, dtype=torch.float64)
5 gae_duplicate tensor(-0.8097, dtype=torch.float64) tensor(9.2921, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2192, dtype=torch.float64) delta_t tensor(0.0623, dtype=torch.float64)
4 gae_duplicate tensor(-0.0450, dtype=torch.float64) tensor(-0.3214, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6989, dtype=torch.float64) delta_t tensor(-0.0607, dtype=torch.float64)
3 gae_duplicate tensor(-0.2767, dtype=torch.float64) tensor(1.0896, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1399, dtype=torch.float64) delta_t tensor(-0.0785, dtype=torch.float64)
2 gae_duplicate tensor(-0.3921, dtype=torch.float64) tensor(1.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:103.87285614013672
value loss:10.820743560791016
entropies:354.9649963378906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9063880443573 seconds
19 rew tensor(1.1822, dtype=torch.float64) delta_t tensor(0.0476, dtype=torch.float64)
19 gae_duplicate tensor(-0.1212, dtype=torch.float64) tensor(-0.9363, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0938, dtype=torch.float64) delta_t tensor(0.0743, dtype=torch.float64)
18 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(-1.6271, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0280, dtype=torch.float64) delta_t tensor(0.0099, dtype=torch.float64)
17 gae_duplicate tensor(-0.1235, dtype=torch.float64) tensor(-0.3672, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9526, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
16 gae_duplicate tensor(-0.0708, dtype=torch.float64) tensor(-0.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9379, dtype=torch.float64) delta_t tensor(0.0928, dtype=torch.float64)
15 gae_duplicate tensor(-0.1540, dtype=torch.float64) tensor(-1.7947, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3962, dtype=torch.float64) delta_t tensor(-0.0224, dtype=torch.float64)
14 gae_duplicate tensor(-1.0398, dtype=torch.float64) tensor(0.0197, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7192, dtype=torch.float64) delta_t tensor(0.0204, dtype=torch.float64)
13 gae_duplicate tensor(-0.1483, dtype=torch.float64) tensor(-0.3792, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1649, dtype=torch.float64) delta_t tensor(-0.0035, dtype=torch.float64)
12 gae_duplicate tensor(-0.2116, dtype=torch.float64) tensor(0.1192, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(0.0665, dtype=torch.float64)
11 gae_duplicate tensor(-0.1108, dtype=torch.float64) tensor(-1.3272, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1433, dtype=torch.float64) delta_t tensor(-0.0326, dtype=torch.float64)
10 gae_duplicate tensor(-0.1307, dtype=torch.float64) tensor(0.4580, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4669, dtype=torch.float64) delta_t tensor(0.4290, dtype=torch.float64)
9 gae_duplicate tensor(0.1810, dtype=torch.float64) tensor(-8.5145, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6068, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
8 gae_duplicate tensor(-0.2644, dtype=torch.float64) tensor(-1.4665, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4618, dtype=torch.float64) delta_t tensor(0.3944, dtype=torch.float64)
7 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(-8.1638, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7626, dtype=torch.float64) delta_t tensor(-0.0492, dtype=torch.float64)
6 gae_duplicate tensor(-0.4104, dtype=torch.float64) tensor(0.1005, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3492, dtype=torch.float64) delta_t tensor(-0.3817, dtype=torch.float64)
5 gae_duplicate tensor(-0.7386, dtype=torch.float64) tensor(7.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1969, dtype=torch.float64) delta_t tensor(0.1135, dtype=torch.float64)
4 gae_duplicate tensor(-0.0715, dtype=torch.float64) tensor(-1.4314, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7969, dtype=torch.float64) delta_t tensor(-0.1243, dtype=torch.float64)
3 gae_duplicate tensor(-0.5432, dtype=torch.float64) tensor(2.3493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1506, dtype=torch.float64) delta_t tensor(-0.0737, dtype=torch.float64)
2 gae_duplicate tensor(-0.5331, dtype=torch.float64) tensor(1.9089, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:672.4530029296875
value loss:15.59516716003418
entropies:354.961669921875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.2668)
ToM Target loss= tensor(2006.9275)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.869028091430664 seconds
19 rew tensor(1.1948, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
19 gae_duplicate tensor(-0.1432, dtype=torch.float64) tensor(-1.3560, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1817, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
18 gae_duplicate tensor(0.0927, dtype=torch.float64) tensor(-3.5590, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1321, dtype=torch.float64) delta_t tensor(0.1163, dtype=torch.float64)
17 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-2.6459, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9915, dtype=torch.float64) delta_t tensor(0.0265, dtype=torch.float64)
16 gae_duplicate tensor(-0.2257, dtype=torch.float64) tensor(-0.8600, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7334, dtype=torch.float64) delta_t tensor(-0.2435, dtype=torch.float64)
15 gae_duplicate tensor(-1.3699, dtype=torch.float64) tensor(5.0235, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4052, dtype=torch.float64) delta_t tensor(-0.1078, dtype=torch.float64)
14 gae_duplicate tensor(-0.9014, dtype=torch.float64) tensor(2.4094, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6933, dtype=torch.float64) delta_t tensor(-0.0285, dtype=torch.float64)
13 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(0.8709, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2046, dtype=torch.float64) delta_t tensor(0.1208, dtype=torch.float64)
12 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(-2.3923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6446, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
11 gae_duplicate tensor(-0.1698, dtype=torch.float64) tensor(-2.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2600, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
10 gae_duplicate tensor(-0.2020, dtype=torch.float64) tensor(1.3489, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5427, dtype=torch.float64) delta_t tensor(0.6789, dtype=torch.float64)
9 gae_duplicate tensor(0.1345, dtype=torch.float64) tensor(-13.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7221, dtype=torch.float64) delta_t tensor(-0.0936, dtype=torch.float64)
8 gae_duplicate tensor(-0.3706, dtype=torch.float64) tensor(0.4330, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0826, dtype=torch.float64) delta_t tensor(-0.2369, dtype=torch.float64)
7 gae_duplicate tensor(-1.7471, dtype=torch.float64) tensor(4.7958, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9436, dtype=torch.float64) delta_t tensor(-0.2972, dtype=torch.float64)
6 gae_duplicate tensor(-0.6295, dtype=torch.float64) tensor(6.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2793, dtype=torch.float64) delta_t tensor(-0.2868, dtype=torch.float64)
5 gae_duplicate tensor(-0.5741, dtype=torch.float64) tensor(6.3143, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0376, dtype=torch.float64) delta_t tensor(0.2071, dtype=torch.float64)
4 gae_duplicate tensor(-0.1816, dtype=torch.float64) tensor(-3.6638, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0154, dtype=torch.float64) delta_t tensor(-0.1971, dtype=torch.float64)
3 gae_duplicate tensor(-0.9382, dtype=torch.float64) tensor(3.7308, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3353, dtype=torch.float64) delta_t tensor(0.1108, dtype=torch.float64)
2 gae_duplicate tensor(-0.6563, dtype=torch.float64) tensor(-1.8190, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-56.95683288574219
value loss:33.21307373046875
entropies:354.9450378417969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.25291109085083 seconds
19 rew tensor(1.2320, dtype=torch.float64) delta_t tensor(0.1122, dtype=torch.float64)
19 gae_duplicate tensor(-0.1087, dtype=torch.float64) tensor(-2.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1821, dtype=torch.float64) delta_t tensor(0.1869, dtype=torch.float64)
18 gae_duplicate tensor(-0.1556, dtype=torch.float64) tensor(-3.8927, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1699, dtype=torch.float64) delta_t tensor(0.1640, dtype=torch.float64)
17 gae_duplicate tensor(-0.0026, dtype=torch.float64) tensor(-3.6759, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0690, dtype=torch.float64) delta_t tensor(0.1392, dtype=torch.float64)
16 gae_duplicate tensor(-0.0933, dtype=torch.float64) tensor(-3.1067, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.0031, dtype=torch.float64)
15 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(-0.4835, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4653, dtype=torch.float64) delta_t tensor(-0.1691, dtype=torch.float64)
14 gae_duplicate tensor(-1.7769, dtype=torch.float64) tensor(2.8510, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2460, dtype=torch.float64) delta_t tensor(-0.3533, dtype=torch.float64)
13 gae_duplicate tensor(-1.6067, dtype=torch.float64) tensor(7.6876, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4933, dtype=torch.float64) delta_t tensor(-0.6157, dtype=torch.float64)
12 gae_duplicate tensor(-3.9208, dtype=torch.float64) tensor(13.2737, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1901, dtype=torch.float64) delta_t tensor(-0.2289, dtype=torch.float64)
11 gae_duplicate tensor(-1.7371, dtype=torch.float64) tensor(5.5138, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0758, dtype=torch.float64) delta_t tensor(0.0872, dtype=torch.float64)
10 gae_duplicate tensor(-0.1908, dtype=torch.float64) tensor(-1.2422, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5445, dtype=torch.float64) delta_t tensor(0.6939, dtype=torch.float64)
9 gae_duplicate tensor(0.2705, dtype=torch.float64) tensor(-13.2673, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6226, dtype=torch.float64) delta_t tensor(-0.0520, dtype=torch.float64)
8 gae_duplicate tensor(-0.3364, dtype=torch.float64) tensor(-0.2569, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8201, dtype=torch.float64) delta_t tensor(0.2111, dtype=torch.float64)
7 gae_duplicate tensor(-0.1561, dtype=torch.float64) tensor(-3.9731, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7265, dtype=torch.float64) delta_t tensor(0.0260, dtype=torch.float64)
6 gae_duplicate tensor(-0.3447, dtype=torch.float64) tensor(-0.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6063, dtype=torch.float64) delta_t tensor(-0.4384, dtype=torch.float64)
5 gae_duplicate tensor(-0.7776, dtype=torch.float64) tensor(8.2380, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0361, dtype=torch.float64) delta_t tensor(0.0778, dtype=torch.float64)
4 gae_duplicate tensor(-0.1074, dtype=torch.float64) tensor(-0.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2768, dtype=torch.float64) delta_t tensor(-0.2431, dtype=torch.float64)
3 gae_duplicate tensor(-0.6316, dtype=torch.float64) tensor(4.7340, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3575, dtype=torch.float64) delta_t tensor(0.0955, dtype=torch.float64)
2 gae_duplicate tensor(-0.2148, dtype=torch.float64) tensor(-1.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-487.15435791015625
value loss:52.422447204589844
entropies:354.92388916015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0901288986206055 seconds
19 rew tensor(1.1939, dtype=torch.float64) delta_t tensor(0.0601, dtype=torch.float64)
19 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(-1.1170, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8821, dtype=torch.float64) delta_t tensor(-0.1483, dtype=torch.float64)
18 gae_duplicate tensor(-1.4839, dtype=torch.float64) tensor(2.5175, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0548, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
17 gae_duplicate tensor(-0.2520, dtype=torch.float64) tensor(-0.7203, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0022, dtype=torch.float64) delta_t tensor(-0.0117, dtype=torch.float64)
16 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(0.1500, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8494, dtype=torch.float64) delta_t tensor(-0.0552, dtype=torch.float64)
15 gae_duplicate tensor(-0.2329, dtype=torch.float64) tensor(1.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4990, dtype=torch.float64) delta_t tensor(-0.3197, dtype=torch.float64)
14 gae_duplicate tensor(-1.5541, dtype=torch.float64) tensor(6.6661, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5767, dtype=torch.float64) delta_t tensor(-0.0747, dtype=torch.float64)
13 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(2.1612, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4646, dtype=torch.float64) delta_t tensor(0.1446, dtype=torch.float64)
12 gae_duplicate tensor(-0.2553, dtype=torch.float64) tensor(-2.7220, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2277, dtype=torch.float64) delta_t tensor(0.0317, dtype=torch.float64)
11 gae_duplicate tensor(-0.2911, dtype=torch.float64) tensor(-0.9280, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0657, dtype=torch.float64) delta_t tensor(0.1325, dtype=torch.float64)
10 gae_duplicate tensor(-0.0620, dtype=torch.float64) tensor(-2.6277, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2296, dtype=torch.float64) delta_t tensor(0.3772, dtype=torch.float64)
9 gae_duplicate tensor(0.1655, dtype=torch.float64) tensor(-7.6421, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4772, dtype=torch.float64) delta_t tensor(0.1676, dtype=torch.float64)
8 gae_duplicate tensor(-0.1491, dtype=torch.float64) tensor(-4.0976, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9307, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
7 gae_duplicate tensor(-0.7213, dtype=torch.float64) tensor(-1.5726, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5682, dtype=torch.float64) delta_t tensor(0.1155, dtype=torch.float64)
6 gae_duplicate tensor(-0.0945, dtype=torch.float64) tensor(-2.3668, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6620, dtype=torch.float64) delta_t tensor(-0.5727, dtype=torch.float64)
5 gae_duplicate tensor(-0.8542, dtype=torch.float64) tensor(11.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0911, dtype=torch.float64) delta_t tensor(0.1447, dtype=torch.float64)
4 gae_duplicate tensor(-0.1157, dtype=torch.float64) tensor(-1.6645, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1909, dtype=torch.float64) delta_t tensor(-0.2760, dtype=torch.float64)
3 gae_duplicate tensor(-1.0815, dtype=torch.float64) tensor(5.4357, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4254, dtype=torch.float64) delta_t tensor(0.1757, dtype=torch.float64)
2 gae_duplicate tensor(-0.5008, dtype=torch.float64) tensor(-3.0095, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-151.6019744873047
value loss:22.68312644958496
entropies:354.9349365234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.983804702758789 seconds
19 rew tensor(1.1799, dtype=torch.float64) delta_t tensor(0.0364, dtype=torch.float64)
19 gae_duplicate tensor(-0.0329, dtype=torch.float64) tensor(-0.7058, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1425, dtype=torch.float64) delta_t tensor(0.1173, dtype=torch.float64)
18 gae_duplicate tensor(0.0168, dtype=torch.float64) tensor(-2.4182, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0519, dtype=torch.float64) delta_t tensor(0.0288, dtype=torch.float64)
17 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(-0.8146, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9496, dtype=torch.float64) delta_t tensor(-0.0148, dtype=torch.float64)
16 gae_duplicate tensor(-0.1703, dtype=torch.float64) tensor(0.1727, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8480, dtype=torch.float64) delta_t tensor(-0.1191, dtype=torch.float64)
15 gae_duplicate tensor(-0.3124, dtype=torch.float64) tensor(2.4026, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6807, dtype=torch.float64) delta_t tensor(0.0453, dtype=torch.float64)
14 gae_duplicate tensor(-0.2484, dtype=torch.float64) tensor(-0.5322, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6827, dtype=torch.float64) delta_t tensor(-0.0834, dtype=torch.float64)
13 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(1.5416, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2046, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
12 gae_duplicate tensor(-0.2206, dtype=torch.float64) tensor(1.0316, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5411, dtype=torch.float64) delta_t tensor(0.0178, dtype=torch.float64)
11 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(-0.1903, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0772, dtype=torch.float64) delta_t tensor(0.0200, dtype=torch.float64)
10 gae_duplicate tensor(-0.1887, dtype=torch.float64) tensor(-0.3830, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4108, dtype=torch.float64) delta_t tensor(0.4005, dtype=torch.float64)
9 gae_duplicate tensor(0.1374, dtype=torch.float64) tensor(-7.9605, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6318, dtype=torch.float64) delta_t tensor(0.0022, dtype=torch.float64)
8 gae_duplicate tensor(-0.3729, dtype=torch.float64) tensor(-0.8597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1362, dtype=torch.float64) delta_t tensor(-0.2982, dtype=torch.float64)
7 gae_duplicate tensor(-3.6511, dtype=torch.float64) tensor(6.0627, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8383, dtype=torch.float64) delta_t tensor(-0.1797, dtype=torch.float64)
6 gae_duplicate tensor(-0.6889, dtype=torch.float64) tensor(4.0860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2993, dtype=torch.float64) delta_t tensor(-0.3344, dtype=torch.float64)
5 gae_duplicate tensor(-0.7117, dtype=torch.float64) tensor(6.9095, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0694, dtype=torch.float64) delta_t tensor(0.1182, dtype=torch.float64)
4 gae_duplicate tensor(-0.2411, dtype=torch.float64) tensor(-1.7132, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9121, dtype=torch.float64) delta_t tensor(-0.2573, dtype=torch.float64)
3 gae_duplicate tensor(-1.1268, dtype=torch.float64) tensor(4.6270, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3038, dtype=torch.float64) delta_t tensor(0.1450, dtype=torch.float64)
2 gae_duplicate tensor(-0.3826, dtype=torch.float64) tensor(-2.2327, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-583.0865478515625
value loss:35.20944595336914
entropies:354.8883972167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.901794910430908 seconds
19 rew tensor(1.1012, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
19 gae_duplicate tensor(-0.2035, dtype=torch.float64) tensor(0.0892, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1023, dtype=torch.float64) delta_t tensor(0.0925, dtype=torch.float64)
18 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-1.9101, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0758, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
17 gae_duplicate tensor(-0.0477, dtype=torch.float64) tensor(-2.3122, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9986, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
16 gae_duplicate tensor(-0.2084, dtype=torch.float64) tensor(-1.4353, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9484, dtype=torch.float64) delta_t tensor(-0.0313, dtype=torch.float64)
15 gae_duplicate tensor(-0.1859, dtype=torch.float64) tensor(0.4687, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3454, dtype=torch.float64) delta_t tensor(-0.2008, dtype=torch.float64)
14 gae_duplicate tensor(-0.7230, dtype=torch.float64) tensor(3.8912, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8474, dtype=torch.float64) delta_t tensor(-0.0139, dtype=torch.float64)
13 gae_duplicate tensor(-0.1672, dtype=torch.float64) tensor(0.6175, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2541, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
12 gae_duplicate tensor(-0.2643, dtype=torch.float64) tensor(0.3298, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6420, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
11 gae_duplicate tensor(-0.0868, dtype=torch.float64) tensor(-1.8099, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1420, dtype=torch.float64) delta_t tensor(-0.0247, dtype=torch.float64)
10 gae_duplicate tensor(-0.2202, dtype=torch.float64) tensor(0.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3849, dtype=torch.float64) delta_t tensor(0.3671, dtype=torch.float64)
9 gae_duplicate tensor(0.1974, dtype=torch.float64) tensor(-7.1556, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5674, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
8 gae_duplicate tensor(-0.1528, dtype=torch.float64) tensor(-1.8366, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6766, dtype=torch.float64) delta_t tensor(-0.8861, dtype=torch.float64)
7 gae_duplicate tensor(-7.6442, dtype=torch.float64) tensor(18.4028, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8035, dtype=torch.float64) delta_t tensor(-0.1273, dtype=torch.float64)
6 gae_duplicate tensor(-1.6450, dtype=torch.float64) tensor(3.9538, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2458, dtype=torch.float64) delta_t tensor(-0.2623, dtype=torch.float64)
5 gae_duplicate tensor(-0.6695, dtype=torch.float64) tensor(5.4387, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1716, dtype=torch.float64) delta_t tensor(0.2090, dtype=torch.float64)
4 gae_duplicate tensor(-0.0984, dtype=torch.float64) tensor(-3.3394, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8890, dtype=torch.float64) delta_t tensor(-0.1490, dtype=torch.float64)
3 gae_duplicate tensor(-1.0081, dtype=torch.float64) tensor(2.7028, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1882, dtype=torch.float64) delta_t tensor(-0.0395, dtype=torch.float64)
2 gae_duplicate tensor(-0.6579, dtype=torch.float64) tensor(1.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1045.9962158203125
value loss:107.26576232910156
entropies:354.8295593261719
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3959.8306)
ToM Target loss= tensor(1983.0475)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.959805011749268 seconds
19 rew tensor(1.1654, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
19 gae_duplicate tensor(-0.0888, dtype=torch.float64) tensor(-0.5567, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1792, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
18 gae_duplicate tensor(-0.0054, dtype=torch.float64) tensor(-3.2078, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0900, dtype=torch.float64) delta_t tensor(0.0616, dtype=torch.float64)
17 gae_duplicate tensor(-0.1077, dtype=torch.float64) tensor(-1.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(0.0040, dtype=torch.float64)
16 gae_duplicate tensor(-0.1793, dtype=torch.float64) tensor(-0.1719, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.6797, dtype=torch.float64) delta_t tensor(-0.3223, dtype=torch.float64)
15 gae_duplicate tensor(-1.7638, dtype=torch.float64) tensor(6.4751, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4220, dtype=torch.float64) delta_t tensor(-0.0693, dtype=torch.float64)
14 gae_duplicate tensor(-1.0436, dtype=torch.float64) tensor(1.7324, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1774, dtype=torch.float64) delta_t tensor(-0.6237, dtype=torch.float64)
13 gae_duplicate tensor(-1.6655, dtype=torch.float64) tensor(11.8756, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2445, dtype=torch.float64) delta_t tensor(0.1649, dtype=torch.float64)
12 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-1.9385, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(0.0685, dtype=torch.float64)
11 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(-1.6203, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2191, dtype=torch.float64) delta_t tensor(-0.0801, dtype=torch.float64)
10 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(1.5056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6130, dtype=torch.float64) delta_t tensor(0.5154, dtype=torch.float64)
9 gae_duplicate tensor(0.1577, dtype=torch.float64) tensor(-9.7450, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7705, dtype=torch.float64) delta_t tensor(-0.1405, dtype=torch.float64)
8 gae_duplicate tensor(-0.2910, dtype=torch.float64) tensor(1.8032, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3511, dtype=torch.float64) delta_t tensor(0.3995, dtype=torch.float64)
7 gae_duplicate tensor(-0.3118, dtype=torch.float64) tensor(-7.3094, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9503, dtype=torch.float64) delta_t tensor(-0.2693, dtype=torch.float64)
6 gae_duplicate tensor(-0.4808, dtype=torch.float64) tensor(4.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1741, dtype=torch.float64) delta_t tensor(-0.3405, dtype=torch.float64)
5 gae_duplicate tensor(-0.8009, dtype=torch.float64) tensor(6.9145, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2437, dtype=torch.float64) delta_t tensor(0.1216, dtype=torch.float64)
4 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(-1.7605, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6760, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
3 gae_duplicate tensor(-1.0061, dtype=torch.float64) tensor(-0.5939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0645, dtype=torch.float64) delta_t tensor(-0.1224, dtype=torch.float64)
2 gae_duplicate tensor(-0.6972, dtype=torch.float64) tensor(2.4406, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-577.8424682617188
value loss:32.214359283447266
entropies:354.73077392578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9717419147491455 seconds
19 rew tensor(1.2308, dtype=torch.float64) delta_t tensor(0.1046, dtype=torch.float64)
19 gae_duplicate tensor(-0.1210, dtype=torch.float64) tensor(-2.0599, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1025, dtype=torch.float64) delta_t tensor(0.0755, dtype=torch.float64)
18 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(-1.7459, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7722, dtype=torch.float64) delta_t tensor(-0.2352, dtype=torch.float64)
17 gae_duplicate tensor(-1.3909, dtype=torch.float64) tensor(4.5908, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0005, dtype=torch.float64) delta_t tensor(0.0134, dtype=torch.float64)
16 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(0.1888, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7841, dtype=torch.float64) delta_t tensor(-0.1944, dtype=torch.float64)
15 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(3.8361, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7295, dtype=torch.float64) delta_t tensor(0.0999, dtype=torch.float64)
14 gae_duplicate tensor(-0.3116, dtype=torch.float64) tensor(-1.7726, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4620, dtype=torch.float64) delta_t tensor(-0.2461, dtype=torch.float64)
13 gae_duplicate tensor(-1.2617, dtype=torch.float64) tensor(4.8873, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3064, dtype=torch.float64) delta_t tensor(-0.1058, dtype=torch.float64)
12 gae_duplicate tensor(-0.3434, dtype=torch.float64) tensor(2.6286, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3355, dtype=torch.float64) delta_t tensor(0.0541, dtype=torch.float64)
11 gae_duplicate tensor(-0.2316, dtype=torch.float64) tensor(-0.7875, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0540, dtype=torch.float64) delta_t tensor(-0.0321, dtype=torch.float64)
10 gae_duplicate tensor(-0.1942, dtype=torch.float64) tensor(0.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2444, dtype=torch.float64) delta_t tensor(0.3832, dtype=torch.float64)
9 gae_duplicate tensor(0.2149, dtype=torch.float64) tensor(-7.3980, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3480, dtype=torch.float64) delta_t tensor(0.1824, dtype=torch.float64)
8 gae_duplicate tensor(0.0822, dtype=torch.float64) tensor(-4.2188, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7124, dtype=torch.float64) delta_t tensor(0.2082, dtype=torch.float64)
7 gae_duplicate tensor(-0.1420, dtype=torch.float64) tensor(-4.5829, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6099, dtype=torch.float64) delta_t tensor(0.1243, dtype=torch.float64)
6 gae_duplicate tensor(-0.3654, dtype=torch.float64) tensor(-2.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5229, dtype=torch.float64) delta_t tensor(-0.4935, dtype=torch.float64)
5 gae_duplicate tensor(-0.7748, dtype=torch.float64) tensor(9.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1226, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
4 gae_duplicate tensor(-0.1401, dtype=torch.float64) tensor(0.3955, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8544, dtype=torch.float64) delta_t tensor(-0.1104, dtype=torch.float64)
3 gae_duplicate tensor(-0.3966, dtype=torch.float64) tensor(2.0790, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1715, dtype=torch.float64) delta_t tensor(-0.1007, dtype=torch.float64)
2 gae_duplicate tensor(-0.8834, dtype=torch.float64) tensor(2.0597, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-390.3307800292969
value loss:16.292938232421875
entropies:354.5885009765625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.299806118011475 seconds
19 rew tensor(1.1524, dtype=torch.float64) delta_t tensor(0.0211, dtype=torch.float64)
19 gae_duplicate tensor(-0.1781, dtype=torch.float64) tensor(-0.3660, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0878, dtype=torch.float64) delta_t tensor(0.0617, dtype=torch.float64)
18 gae_duplicate tensor(-0.1374, dtype=torch.float64) tensor(-1.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.8400, dtype=torch.float64) delta_t tensor(-0.1643, dtype=torch.float64)
17 gae_duplicate tensor(-1.1542, dtype=torch.float64) tensor(2.9223, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7500, dtype=torch.float64) delta_t tensor(-0.2324, dtype=torch.float64)
16 gae_duplicate tensor(-1.3542, dtype=torch.float64) tensor(4.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8464, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
15 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-0.6390, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7427, dtype=torch.float64) delta_t tensor(-0.0060, dtype=torch.float64)
14 gae_duplicate tensor(-0.2507, dtype=torch.float64) tensor(0.0333, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5916, dtype=torch.float64) delta_t tensor(0.2009, dtype=torch.float64)
13 gae_duplicate tensor(0.1033, dtype=torch.float64) tensor(-3.8753, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4851, dtype=torch.float64) delta_t tensor(0.0189, dtype=torch.float64)
12 gae_duplicate tensor(-0.0693, dtype=torch.float64) tensor(-0.7705, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1825, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
11 gae_duplicate tensor(-0.2696, dtype=torch.float64) tensor(0.7846, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1892, dtype=torch.float64) delta_t tensor(0.2459, dtype=torch.float64)
10 gae_duplicate tensor(-0.1181, dtype=torch.float64) tensor(-4.6945, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0268, dtype=torch.float64) delta_t tensor(0.3761, dtype=torch.float64)
9 gae_duplicate tensor(0.0962, dtype=torch.float64) tensor(-7.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4486, dtype=torch.float64) delta_t tensor(0.2661, dtype=torch.float64)
8 gae_duplicate tensor(0.0790, dtype=torch.float64) tensor(-6.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.5286, dtype=torch.float64) delta_t tensor(-0.3494, dtype=torch.float64)
7 gae_duplicate tensor(-1.4049, dtype=torch.float64) tensor(6.2319, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6526, dtype=torch.float64) delta_t tensor(-0.0039, dtype=torch.float64)
6 gae_duplicate tensor(-1.1718, dtype=torch.float64) tensor(0.7065, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7124, dtype=torch.float64) delta_t tensor(-0.5097, dtype=torch.float64)
5 gae_duplicate tensor(-0.9262, dtype=torch.float64) tensor(9.9421, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3644, dtype=torch.float64) delta_t tensor(0.2736, dtype=torch.float64)
4 gae_duplicate tensor(-0.0901, dtype=torch.float64) tensor(-4.4470, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6134, dtype=torch.float64) delta_t tensor(-0.5240, dtype=torch.float64)
3 gae_duplicate tensor(-0.9326, dtype=torch.float64) tensor(10.1692, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6980, dtype=torch.float64) delta_t tensor(0.4478, dtype=torch.float64)
2 gae_duplicate tensor(-0.2630, dtype=torch.float64) tensor(-7.9066, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:11.01064395904541
value loss:29.53660774230957
entropies:354.40179443359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.913623809814453 seconds
19 rew tensor(1.1896, dtype=torch.float64) delta_t tensor(0.0804, dtype=torch.float64)
19 gae_duplicate tensor(-0.0365, dtype=torch.float64) tensor(-1.5524, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2160, dtype=torch.float64) delta_t tensor(0.2057, dtype=torch.float64)
18 gae_duplicate tensor(0.1133, dtype=torch.float64) tensor(-4.0616, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0486, dtype=torch.float64) delta_t tensor(0.0528, dtype=torch.float64)
17 gae_duplicate tensor(-0.0908, dtype=torch.float64) tensor(-1.4336, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0628, dtype=torch.float64) delta_t tensor(0.1040, dtype=torch.float64)
16 gae_duplicate tensor(-0.0375, dtype=torch.float64) tensor(-2.2263, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9204, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
15 gae_duplicate tensor(-0.2732, dtype=torch.float64) tensor(-1.0093, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8339, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
14 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(-1.8971, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7149, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
13 gae_duplicate tensor(-0.3060, dtype=torch.float64) tensor(1.0531, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3829, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
12 gae_duplicate tensor(-0.2537, dtype=torch.float64) tensor(0.2691, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.2226, dtype=torch.float64) delta_t tensor(-0.6452, dtype=torch.float64)
11 gae_duplicate tensor(-3.9429, dtype=torch.float64) tensor(11.9618, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.4091, dtype=torch.float64) delta_t tensor(-0.1545, dtype=torch.float64)
10 gae_duplicate tensor(-2.4170, dtype=torch.float64) tensor(4.7065, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2932, dtype=torch.float64) delta_t tensor(0.3357, dtype=torch.float64)
9 gae_duplicate tensor(-0.1090, dtype=torch.float64) tensor(-6.4783, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6023, dtype=torch.float64) delta_t tensor(0.1278, dtype=torch.float64)
8 gae_duplicate tensor(-0.2605, dtype=torch.float64) tensor(-3.2090, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1881, dtype=torch.float64) delta_t tensor(-0.2951, dtype=torch.float64)
7 gae_duplicate tensor(-3.3433, dtype=torch.float64) tensor(5.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9357, dtype=torch.float64) delta_t tensor(-0.2415, dtype=torch.float64)
6 gae_duplicate tensor(-0.9256, dtype=torch.float64) tensor(4.9945, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3040, dtype=torch.float64) delta_t tensor(-0.2644, dtype=torch.float64)
5 gae_duplicate tensor(-0.8800, dtype=torch.float64) tensor(5.5411, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0420, dtype=torch.float64) delta_t tensor(0.2710, dtype=torch.float64)
4 gae_duplicate tensor(-0.1270, dtype=torch.float64) tensor(-4.6612, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1268, dtype=torch.float64) delta_t tensor(-0.3434, dtype=torch.float64)
3 gae_duplicate tensor(-1.0660, dtype=torch.float64) tensor(6.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4022, dtype=torch.float64) delta_t tensor(0.1798, dtype=torch.float64)
2 gae_duplicate tensor(-0.4626, dtype=torch.float64) tensor(-3.0281, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-670.7767944335938
value loss:69.86512756347656
entropies:354.2445373535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.961890935897827 seconds
19 rew tensor(1.1251, dtype=torch.float64) delta_t tensor(-0.0105, dtype=torch.float64)
19 gae_duplicate tensor(-0.0680, dtype=torch.float64) tensor(0.2178, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1390, dtype=torch.float64) delta_t tensor(0.1352, dtype=torch.float64)
18 gae_duplicate tensor(0.0585, dtype=torch.float64) tensor(-2.5651, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0758, dtype=torch.float64) delta_t tensor(0.0701, dtype=torch.float64)
17 gae_duplicate tensor(0.0343, dtype=torch.float64) tensor(-1.5719, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8827, dtype=torch.float64) delta_t tensor(-0.0075, dtype=torch.float64)
16 gae_duplicate tensor(-0.0438, dtype=torch.float64) tensor(-0.0282, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9487, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
15 gae_duplicate tensor(-0.1378, dtype=torch.float64) tensor(0.4231, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6906, dtype=torch.float64) delta_t tensor(0.0810, dtype=torch.float64)
14 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-1.4152, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6803, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
13 gae_duplicate tensor(-0.0935, dtype=torch.float64) tensor(0.0234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3212, dtype=torch.float64) delta_t tensor(0.0909, dtype=torch.float64)
12 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(-1.9054, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4362, dtype=torch.float64) delta_t tensor(0.0620, dtype=torch.float64)
11 gae_duplicate tensor(-0.2394, dtype=torch.float64) tensor(-1.5135, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0497, dtype=torch.float64) delta_t tensor(0.0223, dtype=torch.float64)
10 gae_duplicate tensor(-0.2304, dtype=torch.float64) tensor(-0.4420, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2167, dtype=torch.float64) delta_t tensor(0.4538, dtype=torch.float64)
9 gae_duplicate tensor(0.2413, dtype=torch.float64) tensor(-9.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4992, dtype=torch.float64) delta_t tensor(0.1550, dtype=torch.float64)
8 gae_duplicate tensor(0.0022, dtype=torch.float64) tensor(-3.9805, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8264, dtype=torch.float64) delta_t tensor(0.1434, dtype=torch.float64)
7 gae_duplicate tensor(-0.2614, dtype=torch.float64) tensor(-3.2606, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7170, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
6 gae_duplicate tensor(-0.2778, dtype=torch.float64) tensor(0.6706, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4500, dtype=torch.float64) delta_t tensor(-0.3989, dtype=torch.float64)
5 gae_duplicate tensor(-0.8023, dtype=torch.float64) tensor(8.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0821, dtype=torch.float64) delta_t tensor(0.2173, dtype=torch.float64)
4 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(-3.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0842, dtype=torch.float64) delta_t tensor(-0.2170, dtype=torch.float64)
3 gae_duplicate tensor(-0.8602, dtype=torch.float64) tensor(3.9328, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4281, dtype=torch.float64) delta_t tensor(0.1620, dtype=torch.float64)
2 gae_duplicate tensor(-0.7055, dtype=torch.float64) tensor(-2.7997, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:896.0228881835938
value loss:15.609013557434082
entropies:354.210205078125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3954.2415)
ToM Target loss= tensor(1954.3787)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.251332998275757 seconds
19 rew tensor(1.1645, dtype=torch.float64) delta_t tensor(0.0234, dtype=torch.float64)
19 gae_duplicate tensor(-0.1291, dtype=torch.float64) tensor(-0.3780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1391, dtype=torch.float64) delta_t tensor(0.1118, dtype=torch.float64)
18 gae_duplicate tensor(-0.0018, dtype=torch.float64) tensor(-2.2034, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0499, dtype=torch.float64) delta_t tensor(0.0498, dtype=torch.float64)
17 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.1110, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8956, dtype=torch.float64) delta_t tensor(-0.0636, dtype=torch.float64)
16 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(1.2377, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8710, dtype=torch.float64) delta_t tensor(-0.0892, dtype=torch.float64)
15 gae_duplicate tensor(-0.2892, dtype=torch.float64) tensor(1.7548, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7797, dtype=torch.float64) delta_t tensor(0.1621, dtype=torch.float64)
14 gae_duplicate tensor(-0.3224, dtype=torch.float64) tensor(-2.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6693, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
13 gae_duplicate tensor(-0.3908, dtype=torch.float64) tensor(-1.1367, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2673, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
12 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(-1.0110, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4639, dtype=torch.float64) delta_t tensor(0.1429, dtype=torch.float64)
11 gae_duplicate tensor(-0.0618, dtype=torch.float64) tensor(-2.9708, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0129, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
10 gae_duplicate tensor(-0.2373, dtype=torch.float64) tensor(-1.0184, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3554, dtype=torch.float64) delta_t tensor(0.4348, dtype=torch.float64)
9 gae_duplicate tensor(0.1455, dtype=torch.float64) tensor(-8.9837, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6023, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
8 gae_duplicate tensor(-0.2371, dtype=torch.float64) tensor(-1.5187, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6609, dtype=torch.float64) delta_t tensor(0.2252, dtype=torch.float64)
7 gae_duplicate tensor(-0.4462, dtype=torch.float64) tensor(-4.3756, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8340, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
6 gae_duplicate tensor(-0.6487, dtype=torch.float64) tensor(2.0391, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3459, dtype=torch.float64) delta_t tensor(-0.3523, dtype=torch.float64)
5 gae_duplicate tensor(-0.8358, dtype=torch.float64) tensor(7.2932, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0452, dtype=torch.float64) delta_t tensor(0.1504, dtype=torch.float64)
4 gae_duplicate tensor(-0.2317, dtype=torch.float64) tensor(-2.3469, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9687, dtype=torch.float64) delta_t tensor(-0.1952, dtype=torch.float64)
3 gae_duplicate tensor(-0.7567, dtype=torch.float64) tensor(3.6150, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3273, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
2 gae_duplicate tensor(-0.3155, dtype=torch.float64) tensor(-2.2876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:777.2843627929688
value loss:16.350513458251953
entropies:354.1407470703125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.2318220138549805 seconds
19 rew tensor(1.2043, dtype=torch.float64) delta_t tensor(0.0570, dtype=torch.float64)
19 gae_duplicate tensor(-0.0812, dtype=torch.float64) tensor(-1.0645, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1921, dtype=torch.float64) delta_t tensor(0.1515, dtype=torch.float64)
18 gae_duplicate tensor(0.0463, dtype=torch.float64) tensor(-3.1561, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1278, dtype=torch.float64) delta_t tensor(0.1098, dtype=torch.float64)
17 gae_duplicate tensor(-0.0020, dtype=torch.float64) tensor(-2.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9239, dtype=torch.float64) delta_t tensor(-0.0651, dtype=torch.float64)
16 gae_duplicate tensor(-0.1774, dtype=torch.float64) tensor(1.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7940, dtype=torch.float64) delta_t tensor(0.0308, dtype=torch.float64)
15 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(-0.5925, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4606, dtype=torch.float64) delta_t tensor(-0.2953, dtype=torch.float64)
14 gae_duplicate tensor(-1.5474, dtype=torch.float64) tensor(5.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5601, dtype=torch.float64) delta_t tensor(0.0730, dtype=torch.float64)
13 gae_duplicate tensor(-0.0978, dtype=torch.float64) tensor(-0.8305, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4006, dtype=torch.float64) delta_t tensor(-0.1013, dtype=torch.float64)
12 gae_duplicate tensor(-0.2185, dtype=torch.float64) tensor(1.8120, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2379, dtype=torch.float64) delta_t tensor(0.0572, dtype=torch.float64)
11 gae_duplicate tensor(-0.2414, dtype=torch.float64) tensor(-0.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2604, dtype=torch.float64) delta_t tensor(0.1545, dtype=torch.float64)
10 gae_duplicate tensor(-0.2054, dtype=torch.float64) tensor(-3.0835, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0210, dtype=torch.float64) delta_t tensor(0.2379, dtype=torch.float64)
9 gae_duplicate tensor(0.1041, dtype=torch.float64) tensor(-5.1995, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3969, dtype=torch.float64) delta_t tensor(0.2321, dtype=torch.float64)
8 gae_duplicate tensor(-0.2538, dtype=torch.float64) tensor(-5.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1403, dtype=torch.float64) delta_t tensor(-0.0650, dtype=torch.float64)
7 gae_duplicate tensor(-0.6593, dtype=torch.float64) tensor(0.9752, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5521, dtype=torch.float64) delta_t tensor(0.1088, dtype=torch.float64)
6 gae_duplicate tensor(-0.3602, dtype=torch.float64) tensor(-1.9631, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7136, dtype=torch.float64) delta_t tensor(-0.6016, dtype=torch.float64)
5 gae_duplicate tensor(-0.9431, dtype=torch.float64) tensor(11.4112, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1701, dtype=torch.float64) delta_t tensor(0.1946, dtype=torch.float64)
4 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-2.9109, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2832, dtype=torch.float64) delta_t tensor(-0.3640, dtype=torch.float64)
3 gae_duplicate tensor(-0.9044, dtype=torch.float64) tensor(6.7834, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5289, dtype=torch.float64) delta_t tensor(0.2312, dtype=torch.float64)
2 gae_duplicate tensor(-0.5699, dtype=torch.float64) tensor(-3.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:103.26847839355469
value loss:21.80560302734375
entropies:354.0226745605469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.06584095954895 seconds
19 rew tensor(1.1027, dtype=torch.float64) delta_t tensor(-0.0466, dtype=torch.float64)
19 gae_duplicate tensor(-0.1883, dtype=torch.float64) tensor(0.8780, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0892, dtype=torch.float64) delta_t tensor(0.0604, dtype=torch.float64)
18 gae_duplicate tensor(-0.1015, dtype=torch.float64) tensor(-1.1658, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0658, dtype=torch.float64) delta_t tensor(0.0418, dtype=torch.float64)
17 gae_duplicate tensor(-0.1504, dtype=torch.float64) tensor(-0.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.6718, dtype=torch.float64) delta_t tensor(-0.3300, dtype=torch.float64)
16 gae_duplicate tensor(-1.4845, dtype=torch.float64) tensor(6.4005, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8712, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
15 gae_duplicate tensor(-0.1764, dtype=torch.float64) tensor(0.0832, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7584, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
14 gae_duplicate tensor(-0.2632, dtype=torch.float64) tensor(1.3030, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5612, dtype=torch.float64) delta_t tensor(-0.0964, dtype=torch.float64)
13 gae_duplicate tensor(-0.1959, dtype=torch.float64) tensor(1.9651, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4772, dtype=torch.float64) delta_t tensor(0.1310, dtype=torch.float64)
12 gae_duplicate tensor(-0.1277, dtype=torch.float64) tensor(-2.5031, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3177, dtype=torch.float64) delta_t tensor(0.0544, dtype=torch.float64)
11 gae_duplicate tensor(-0.1943, dtype=torch.float64) tensor(-1.4202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0007, dtype=torch.float64) delta_t tensor(-0.0086, dtype=torch.float64)
10 gae_duplicate tensor(-0.1705, dtype=torch.float64) tensor(-0.0424, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2169, dtype=torch.float64) delta_t tensor(0.3263, dtype=torch.float64)
9 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-6.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4623, dtype=torch.float64) delta_t tensor(0.0833, dtype=torch.float64)
8 gae_duplicate tensor(-0.2644, dtype=torch.float64) tensor(-2.2280, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6832, dtype=torch.float64) delta_t tensor(0.1725, dtype=torch.float64)
7 gae_duplicate tensor(-0.1931, dtype=torch.float64) tensor(-3.8697, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5529, dtype=torch.float64) delta_t tensor(0.0808, dtype=torch.float64)
6 gae_duplicate tensor(-0.3665, dtype=torch.float64) tensor(-1.9143, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5826, dtype=torch.float64) delta_t tensor(-0.5145, dtype=torch.float64)
5 gae_duplicate tensor(-0.7389, dtype=torch.float64) tensor(9.7188, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0663, dtype=torch.float64) delta_t tensor(0.0469, dtype=torch.float64)
4 gae_duplicate tensor(-0.2252, dtype=torch.float64) tensor(-0.0298, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9290, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
3 gae_duplicate tensor(-0.4379, dtype=torch.float64) tensor(1.2061, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3052, dtype=torch.float64) delta_t tensor(-0.0116, dtype=torch.float64)
2 gae_duplicate tensor(-0.3369, dtype=torch.float64) tensor(0.5753, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-201.4850311279297
value loss:13.410892486572266
entropies:354.001708984375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.931294918060303 seconds
19 rew tensor(1.2041, dtype=torch.float64) delta_t tensor(0.0457, dtype=torch.float64)
19 gae_duplicate tensor(-0.0724, dtype=torch.float64) tensor(-0.9859, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1536, dtype=torch.float64) delta_t tensor(0.1169, dtype=torch.float64)
18 gae_duplicate tensor(0.0099, dtype=torch.float64) tensor(-2.4451, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0259, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
17 gae_duplicate tensor(-0.1135, dtype=torch.float64) tensor(-0.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9608, dtype=torch.float64) delta_t tensor(-0.0017, dtype=torch.float64)
16 gae_duplicate tensor(-0.1967, dtype=torch.float64) tensor(0.0250, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9103, dtype=torch.float64) delta_t tensor(-0.1021, dtype=torch.float64)
15 gae_duplicate tensor(-0.3200, dtype=torch.float64) tensor(2.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7442, dtype=torch.float64) delta_t tensor(0.1009, dtype=torch.float64)
14 gae_duplicate tensor(-0.3219, dtype=torch.float64) tensor(-1.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4888, dtype=torch.float64) delta_t tensor(-0.1649, dtype=torch.float64)
13 gae_duplicate tensor(-0.9338, dtype=torch.float64) tensor(3.1072, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4175, dtype=torch.float64) delta_t tensor(-0.7604, dtype=torch.float64)
12 gae_duplicate tensor(-3.7893, dtype=torch.float64) tensor(14.5200, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2054, dtype=torch.float64) delta_t tensor(-0.2642, dtype=torch.float64)
11 gae_duplicate tensor(-1.7540, dtype=torch.float64) tensor(6.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0389, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
10 gae_duplicate tensor(-0.3038, dtype=torch.float64) tensor(1.3803, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3452, dtype=torch.float64) delta_t tensor(0.2894, dtype=torch.float64)
9 gae_duplicate tensor(-0.0604, dtype=torch.float64) tensor(-5.5237, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5045, dtype=torch.float64) delta_t tensor(0.0412, dtype=torch.float64)
8 gae_duplicate tensor(-0.2144, dtype=torch.float64) tensor(-1.4974, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4606, dtype=torch.float64) delta_t tensor(0.3183, dtype=torch.float64)
7 gae_duplicate tensor(-0.1657, dtype=torch.float64) tensor(-6.3831, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7096, dtype=torch.float64) delta_t tensor(-0.0354, dtype=torch.float64)
6 gae_duplicate tensor(-0.5431, dtype=torch.float64) tensor(0.2592, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3757, dtype=torch.float64) delta_t tensor(-0.3671, dtype=torch.float64)
5 gae_duplicate tensor(-0.8045, dtype=torch.float64) tensor(7.3789, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2216, dtype=torch.float64) delta_t tensor(-0.0269, dtype=torch.float64)
4 gae_duplicate tensor(-0.1889, dtype=torch.float64) tensor(1.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7345, dtype=torch.float64) delta_t tensor(0.0745, dtype=torch.float64)
3 gae_duplicate tensor(-0.3256, dtype=torch.float64) tensor(-1.2435, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1378, dtype=torch.float64) delta_t tensor(-0.0967, dtype=torch.float64)
2 gae_duplicate tensor(-0.2127, dtype=torch.float64) tensor(1.8377, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1099.63427734375
value loss:37.17716979980469
entropies:354.041015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.849085807800293 seconds
19 rew tensor(1.1911, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
19 gae_duplicate tensor(-0.0863, dtype=torch.float64) tensor(-0.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1917, dtype=torch.float64) delta_t tensor(0.1516, dtype=torch.float64)
18 gae_duplicate tensor(0.0397, dtype=torch.float64) tensor(-3.2071, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0765, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
17 gae_duplicate tensor(-0.1197, dtype=torch.float64) tensor(-1.2194, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0660, dtype=torch.float64) delta_t tensor(0.0633, dtype=torch.float64)
16 gae_duplicate tensor(-0.1805, dtype=torch.float64) tensor(-1.4366, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9491, dtype=torch.float64) delta_t tensor(-0.0600, dtype=torch.float64)
15 gae_duplicate tensor(-0.3486, dtype=torch.float64) tensor(0.9367, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.0505, dtype=torch.float64) delta_t tensor(-0.5340, dtype=torch.float64)
14 gae_duplicate tensor(-2.3878, dtype=torch.float64) tensor(10.9786, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6905, dtype=torch.float64) delta_t tensor(-0.0759, dtype=torch.float64)
13 gae_duplicate tensor(-0.3858, dtype=torch.float64) tensor(2.6309, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2972, dtype=torch.float64) delta_t tensor(0.0971, dtype=torch.float64)
12 gae_duplicate tensor(-0.1699, dtype=torch.float64) tensor(-1.6655, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5734, dtype=torch.float64) delta_t tensor(0.1065, dtype=torch.float64)
11 gae_duplicate tensor(-0.1029, dtype=torch.float64) tensor(-2.2627, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1904, dtype=torch.float64) delta_t tensor(-0.1044, dtype=torch.float64)
10 gae_duplicate tensor(-0.3430, dtype=torch.float64) tensor(1.8400, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4589, dtype=torch.float64) delta_t tensor(0.4989, dtype=torch.float64)
9 gae_duplicate tensor(-0.0426, dtype=torch.float64) tensor(-9.7706, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6284, dtype=torch.float64) delta_t tensor(-0.0812, dtype=torch.float64)
8 gae_duplicate tensor(-0.5052, dtype=torch.float64) tensor(0.6225, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.0385, dtype=torch.float64) delta_t tensor(-0.1154, dtype=torch.float64)
7 gae_duplicate tensor(-1.2269, dtype=torch.float64) tensor(2.1935, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8605, dtype=torch.float64) delta_t tensor(-0.2158, dtype=torch.float64)
6 gae_duplicate tensor(-0.6311, dtype=torch.float64) tensor(4.7347, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4586, dtype=torch.float64) delta_t tensor(-0.3858, dtype=torch.float64)
5 gae_duplicate tensor(-0.9071, dtype=torch.float64) tensor(8.0331, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0154, dtype=torch.float64) delta_t tensor(0.1168, dtype=torch.float64)
4 gae_duplicate tensor(-0.1300, dtype=torch.float64) tensor(-1.4607, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1671, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
3 gae_duplicate tensor(-1.0764, dtype=torch.float64) tensor(4.9376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3749, dtype=torch.float64) delta_t tensor(0.0961, dtype=torch.float64)
2 gae_duplicate tensor(-0.6026, dtype=torch.float64) tensor(-1.6332, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-819.209228515625
value loss:30.468280792236328
entropies:354.0891418457031
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.6733)
ToM Target loss= tensor(1917.2856)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.271671772003174 seconds
19 rew tensor(1.1395, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
19 gae_duplicate tensor(-0.2065, dtype=torch.float64) tensor(0.3446, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1285, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
18 gae_duplicate tensor(-0.1133, dtype=torch.float64) tensor(-1.4891, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1032, dtype=torch.float64) delta_t tensor(0.0609, dtype=torch.float64)
17 gae_duplicate tensor(-0.0807, dtype=torch.float64) tensor(-1.3084, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9736, dtype=torch.float64) delta_t tensor(-0.0455, dtype=torch.float64)
16 gae_duplicate tensor(-0.2281, dtype=torch.float64) tensor(0.8355, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9076, dtype=torch.float64) delta_t tensor(-0.0183, dtype=torch.float64)
15 gae_duplicate tensor(-0.1874, dtype=torch.float64) tensor(0.4073, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4489, dtype=torch.float64) delta_t tensor(-0.3605, dtype=torch.float64)
14 gae_duplicate tensor(-0.9970, dtype=torch.float64) tensor(6.9885, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6393, dtype=torch.float64) delta_t tensor(-0.0348, dtype=torch.float64)
13 gae_duplicate tensor(-0.2597, dtype=torch.float64) tensor(1.4888, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4484, dtype=torch.float64) delta_t tensor(0.0458, dtype=torch.float64)
12 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-0.7346, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3333, dtype=torch.float64) delta_t tensor(0.0585, dtype=torch.float64)
11 gae_duplicate tensor(-0.1209, dtype=torch.float64) tensor(-1.2894, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0522, dtype=torch.float64) delta_t tensor(-0.0215, dtype=torch.float64)
10 gae_duplicate tensor(-0.2186, dtype=torch.float64) tensor(0.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1648, dtype=torch.float64) delta_t tensor(0.3908, dtype=torch.float64)
9 gae_duplicate tensor(0.1473, dtype=torch.float64) tensor(-7.7981, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4616, dtype=torch.float64) delta_t tensor(0.0849, dtype=torch.float64)
8 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-2.5344, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4121, dtype=torch.float64) delta_t tensor(-0.3549, dtype=torch.float64)
7 gae_duplicate tensor(-1.5194, dtype=torch.float64) tensor(6.5461, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5781, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
6 gae_duplicate tensor(-0.5117, dtype=torch.float64) tensor(0.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7350, dtype=torch.float64) delta_t tensor(-0.5838, dtype=torch.float64)
5 gae_duplicate tensor(-0.9627, dtype=torch.float64) tensor(11.6396, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2413, dtype=torch.float64) delta_t tensor(0.1987, dtype=torch.float64)
4 gae_duplicate tensor(-0.1123, dtype=torch.float64) tensor(-2.6388, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4010, dtype=torch.float64) delta_t tensor(-0.3902, dtype=torch.float64)
3 gae_duplicate tensor(-0.8324, dtype=torch.float64) tensor(7.3069, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6010, dtype=torch.float64) delta_t tensor(0.2615, dtype=torch.float64)
2 gae_duplicate tensor(-0.3278, dtype=torch.float64) tensor(-4.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-844.7359619140625
value loss:20.711849212646484
entropies:354.1785888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.125247001647949 seconds
19 rew tensor(1.1652, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
19 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(-0.2450, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0754, dtype=torch.float64) delta_t tensor(0.0520, dtype=torch.float64)
18 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(-1.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0510, dtype=torch.float64) delta_t tensor(0.0203, dtype=torch.float64)
17 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-0.4904, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8968, dtype=torch.float64) delta_t tensor(-0.0665, dtype=torch.float64)
16 gae_duplicate tensor(-0.2540, dtype=torch.float64) tensor(1.3203, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9236, dtype=torch.float64) delta_t tensor(-0.1045, dtype=torch.float64)
15 gae_duplicate tensor(-0.1898, dtype=torch.float64) tensor(2.1649, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3410, dtype=torch.float64) delta_t tensor(-0.0412, dtype=torch.float64)
14 gae_duplicate tensor(-1.0310, dtype=torch.float64) tensor(1.1270, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7185, dtype=torch.float64) delta_t tensor(0.0720, dtype=torch.float64)
13 gae_duplicate tensor(-0.0515, dtype=torch.float64) tensor(-1.3096, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1533, dtype=torch.float64) delta_t tensor(0.0264, dtype=torch.float64)
12 gae_duplicate tensor(-0.1999, dtype=torch.float64) tensor(-0.7629, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5257, dtype=torch.float64) delta_t tensor(0.0549, dtype=torch.float64)
11 gae_duplicate tensor(-0.1823, dtype=torch.float64) tensor(-0.9750, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2183, dtype=torch.float64) delta_t tensor(-0.0780, dtype=torch.float64)
10 gae_duplicate tensor(-0.2319, dtype=torch.float64) tensor(1.4165, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5926, dtype=torch.float64) delta_t tensor(0.4306, dtype=torch.float64)
9 gae_duplicate tensor(-0.0325, dtype=torch.float64) tensor(-8.5267, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7342, dtype=torch.float64) delta_t tensor(-0.1439, dtype=torch.float64)
8 gae_duplicate tensor(-0.4216, dtype=torch.float64) tensor(1.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4458, dtype=torch.float64) delta_t tensor(0.4077, dtype=torch.float64)
7 gae_duplicate tensor(-0.0050, dtype=torch.float64) tensor(-7.7767, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8243, dtype=torch.float64) delta_t tensor(-0.1280, dtype=torch.float64)
6 gae_duplicate tensor(-0.5037, dtype=torch.float64) tensor(1.8049, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3475, dtype=torch.float64) delta_t tensor(-0.2333, dtype=torch.float64)
5 gae_duplicate tensor(-0.6220, dtype=torch.float64) tensor(4.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1461, dtype=torch.float64) delta_t tensor(0.0555, dtype=torch.float64)
4 gae_duplicate tensor(-0.0808, dtype=torch.float64) tensor(-0.7441, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9232, dtype=torch.float64) delta_t tensor(-0.1365, dtype=torch.float64)
3 gae_duplicate tensor(-0.5895, dtype=torch.float64) tensor(2.6206, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1747, dtype=torch.float64) delta_t tensor(-0.1517, dtype=torch.float64)
2 gae_duplicate tensor(-0.5983, dtype=torch.float64) tensor(3.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:5.245473861694336
value loss:14.349468231201172
entropies:354.2315368652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.254090070724487 seconds
19 rew tensor(1.1908, dtype=torch.float64) delta_t tensor(0.0577, dtype=torch.float64)
19 gae_duplicate tensor(-0.2001, dtype=torch.float64) tensor(-1.1962, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1778, dtype=torch.float64) delta_t tensor(0.1506, dtype=torch.float64)
18 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-3.1605, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1396, dtype=torch.float64) delta_t tensor(0.1280, dtype=torch.float64)
17 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-2.9187, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0375, dtype=torch.float64) delta_t tensor(0.0259, dtype=torch.float64)
16 gae_duplicate tensor(-0.1475, dtype=torch.float64) tensor(-0.7658, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9610, dtype=torch.float64) delta_t tensor(-0.0119, dtype=torch.float64)
15 gae_duplicate tensor(-0.3537, dtype=torch.float64) tensor(0.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9606, dtype=torch.float64) delta_t tensor(0.0216, dtype=torch.float64)
14 gae_duplicate tensor(-0.2488, dtype=torch.float64) tensor(-0.3736, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.1716, dtype=torch.float64) delta_t tensor(-0.3705, dtype=torch.float64)
13 gae_duplicate tensor(-2.5257, dtype=torch.float64) tensor(7.6859, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.8915, dtype=torch.float64) delta_t tensor(-1.1433, dtype=torch.float64)
12 gae_duplicate tensor(-4.7469, dtype=torch.float64) tensor(24.6908, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.4314, dtype=torch.float64) delta_t tensor(-0.7540, dtype=torch.float64)
11 gae_duplicate tensor(-3.0946, dtype=torch.float64) tensor(17.0676, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1513, dtype=torch.float64) delta_t tensor(0.2565, dtype=torch.float64)
10 gae_duplicate tensor(-0.2306, dtype=torch.float64) tensor(-3.4288, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3948, dtype=torch.float64) delta_t tensor(0.5304, dtype=torch.float64)
9 gae_duplicate tensor(0.2017, dtype=torch.float64) tensor(-11.0217, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5385, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
8 gae_duplicate tensor(-0.2791, dtype=torch.float64) tensor(-1.4182, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8289, dtype=torch.float64) delta_t tensor(0.1880, dtype=torch.float64)
7 gae_duplicate tensor(-0.2111, dtype=torch.float64) tensor(-3.7254, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7043, dtype=torch.float64) delta_t tensor(0.0098, dtype=torch.float64)
6 gae_duplicate tensor(-0.3984, dtype=torch.float64) tensor(-0.6017, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6127, dtype=torch.float64) delta_t tensor(-0.3689, dtype=torch.float64)
5 gae_duplicate tensor(-0.7457, dtype=torch.float64) tensor(7.2878, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0369, dtype=torch.float64) delta_t tensor(0.2030, dtype=torch.float64)
4 gae_duplicate tensor(-0.2046, dtype=torch.float64) tensor(-3.2338, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2244, dtype=torch.float64) delta_t tensor(-0.2463, dtype=torch.float64)
3 gae_duplicate tensor(-0.5988, dtype=torch.float64) tensor(4.7725, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3837, dtype=torch.float64) delta_t tensor(0.0376, dtype=torch.float64)
2 gae_duplicate tensor(-0.3230, dtype=torch.float64) tensor(-0.2308, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1693.0106201171875
value loss:81.5491943359375
entropies:354.2818298339844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.838296175003052 seconds
19 rew tensor(1.0367, dtype=torch.float64) delta_t tensor(-0.1339, dtype=torch.float64)
19 gae_duplicate tensor(-0.2021, dtype=torch.float64) tensor(2.6956, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0510, dtype=torch.float64) delta_t tensor(-0.0013, dtype=torch.float64)
18 gae_duplicate tensor(-0.0410, dtype=torch.float64) tensor(0.2962, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9495, dtype=torch.float64) delta_t tensor(-0.0832, dtype=torch.float64)
17 gae_duplicate tensor(-0.2426, dtype=torch.float64) tensor(1.6171, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9361, dtype=torch.float64) delta_t tensor(-0.0375, dtype=torch.float64)
16 gae_duplicate tensor(-0.1744, dtype=torch.float64) tensor(0.8648, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8465, dtype=torch.float64) delta_t tensor(-0.1907, dtype=torch.float64)
15 gae_duplicate tensor(-0.3283, dtype=torch.float64) tensor(3.8123, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7054, dtype=torch.float64) delta_t tensor(0.0053, dtype=torch.float64)
14 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(0.2393, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7195, dtype=torch.float64) delta_t tensor(-0.0752, dtype=torch.float64)
13 gae_duplicate tensor(-0.2620, dtype=torch.float64) tensor(1.5827, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2941, dtype=torch.float64) delta_t tensor(-0.0104, dtype=torch.float64)
12 gae_duplicate tensor(-0.2178, dtype=torch.float64) tensor(0.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5270, dtype=torch.float64) delta_t tensor(-0.0762, dtype=torch.float64)
11 gae_duplicate tensor(-0.2720, dtype=torch.float64) tensor(1.5521, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1163, dtype=torch.float64) delta_t tensor(-0.1231, dtype=torch.float64)
10 gae_duplicate tensor(-0.2223, dtype=torch.float64) tensor(2.5901, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2562, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
9 gae_duplicate tensor(0.2266, dtype=torch.float64) tensor(-6.5965, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3988, dtype=torch.float64) delta_t tensor(0.1166, dtype=torch.float64)
8 gae_duplicate tensor(0.0121, dtype=torch.float64) tensor(-2.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6792, dtype=torch.float64) delta_t tensor(0.1955, dtype=torch.float64)
7 gae_duplicate tensor(-0.0711, dtype=torch.float64) tensor(-4.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5147, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
6 gae_duplicate tensor(-0.1118, dtype=torch.float64) tensor(-2.4218, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5793, dtype=torch.float64) delta_t tensor(-0.4859, dtype=torch.float64)
5 gae_duplicate tensor(-0.6814, dtype=torch.float64) tensor(9.5306, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0672, dtype=torch.float64) delta_t tensor(-0.1067, dtype=torch.float64)
4 gae_duplicate tensor(-0.2964, dtype=torch.float64) tensor(3.1988, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8598, dtype=torch.float64) delta_t tensor(0.0357, dtype=torch.float64)
3 gae_duplicate tensor(-0.2049, dtype=torch.float64) tensor(-0.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3053, dtype=torch.float64) delta_t tensor(-0.0256, dtype=torch.float64)
2 gae_duplicate tensor(-0.1768, dtype=torch.float64) tensor(0.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-765.2740478515625
value loss:7.195937156677246
entropies:354.2702941894531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.958329916000366 seconds
19 rew tensor(1.1907, dtype=torch.float64) delta_t tensor(0.0543, dtype=torch.float64)
19 gae_duplicate tensor(-0.1132, dtype=torch.float64) tensor(-0.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1407, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
18 gae_duplicate tensor(-0.1030, dtype=torch.float64) tensor(-2.3350, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1545, dtype=torch.float64) delta_t tensor(0.1300, dtype=torch.float64)
17 gae_duplicate tensor(-0.0263, dtype=torch.float64) tensor(-2.8013, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0514, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
16 gae_duplicate tensor(-0.0396, dtype=torch.float64) tensor(-1.0452, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9504, dtype=torch.float64) delta_t tensor(-0.0094, dtype=torch.float64)
15 gae_duplicate tensor(-0.3154, dtype=torch.float64) tensor(0.0806, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.0131, dtype=torch.float64) delta_t tensor(-0.7080, dtype=torch.float64)
14 gae_duplicate tensor(-2.3554, dtype=torch.float64) tensor(13.8046, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4345, dtype=torch.float64) delta_t tensor(-0.1698, dtype=torch.float64)
13 gae_duplicate tensor(-1.2966, dtype=torch.float64) tensor(4.4773, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4391, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
12 gae_duplicate tensor(-0.3902, dtype=torch.float64) tensor(-0.3254, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4319, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
11 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(0.2915, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0932, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
10 gae_duplicate tensor(-0.0734, dtype=torch.float64) tensor(-4.1237, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4043, dtype=torch.float64) delta_t tensor(0.3657, dtype=torch.float64)
9 gae_duplicate tensor(0.0816, dtype=torch.float64) tensor(-7.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5121, dtype=torch.float64) delta_t tensor(0.1069, dtype=torch.float64)
8 gae_duplicate tensor(-0.1335, dtype=torch.float64) tensor(-2.9285, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8346, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
7 gae_duplicate tensor(-1.1707, dtype=torch.float64) tensor(0.0006, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9340, dtype=torch.float64) delta_t tensor(-0.1855, dtype=torch.float64)
6 gae_duplicate tensor(-0.6096, dtype=torch.float64) tensor(3.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1285, dtype=torch.float64) delta_t tensor(-0.2516, dtype=torch.float64)
5 gae_duplicate tensor(-0.7470, dtype=torch.float64) tensor(5.6847, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2125, dtype=torch.float64) delta_t tensor(0.0082, dtype=torch.float64)
4 gae_duplicate tensor(-0.1806, dtype=torch.float64) tensor(0.4565, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6439, dtype=torch.float64) delta_t tensor(0.0215, dtype=torch.float64)
3 gae_duplicate tensor(-0.7809, dtype=torch.float64) tensor(-0.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0824, dtype=torch.float64) delta_t tensor(-0.0844, dtype=torch.float64)
2 gae_duplicate tensor(-0.7339, dtype=torch.float64) tensor(1.6312, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-502.3976135253906
value loss:33.42840576171875
entropies:354.1990966796875
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3952.7576)
ToM Target loss= tensor(1888.7612)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.9983930587768555 seconds
19 rew tensor(1.2026, dtype=torch.float64) delta_t tensor(0.0809, dtype=torch.float64)
19 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-1.5985, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2032, dtype=torch.float64) delta_t tensor(0.1857, dtype=torch.float64)
18 gae_duplicate tensor(0.0769, dtype=torch.float64) tensor(-3.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1268, dtype=torch.float64) delta_t tensor(0.1217, dtype=torch.float64)
17 gae_duplicate tensor(-0.0763, dtype=torch.float64) tensor(-2.8332, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0236, dtype=torch.float64) delta_t tensor(0.0509, dtype=torch.float64)
16 gae_duplicate tensor(-0.0719, dtype=torch.float64) tensor(-1.3901, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8953, dtype=torch.float64) delta_t tensor(0.0581, dtype=torch.float64)
15 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(-1.2177, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7438, dtype=torch.float64) delta_t tensor(0.0429, dtype=torch.float64)
14 gae_duplicate tensor(-0.2123, dtype=torch.float64) tensor(-0.8488, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3432, dtype=torch.float64) delta_t tensor(-0.1406, dtype=torch.float64)
13 gae_duplicate tensor(-1.1503, dtype=torch.float64) tensor(2.3639, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2207, dtype=torch.float64) delta_t tensor(-0.0188, dtype=torch.float64)
12 gae_duplicate tensor(-0.7397, dtype=torch.float64) tensor(0.7581, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3287, dtype=torch.float64) delta_t tensor(-0.1133, dtype=torch.float64)
11 gae_duplicate tensor(-0.2529, dtype=torch.float64) tensor(2.2321, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0804, dtype=torch.float64) delta_t tensor(0.2554, dtype=torch.float64)
10 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-5.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3037, dtype=torch.float64) delta_t tensor(0.5038, dtype=torch.float64)
9 gae_duplicate tensor(0.0990, dtype=torch.float64) tensor(-10.6418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6250, dtype=torch.float64) delta_t tensor(0.0554, dtype=torch.float64)
8 gae_duplicate tensor(-0.3508, dtype=torch.float64) tensor(-1.9065, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6849, dtype=torch.float64) delta_t tensor(-0.4746, dtype=torch.float64)
7 gae_duplicate tensor(-1.5419, dtype=torch.float64) tensor(9.0629, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7420, dtype=torch.float64) delta_t tensor(-0.0499, dtype=torch.float64)
6 gae_duplicate tensor(-0.5694, dtype=torch.float64) tensor(2.2240, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6863, dtype=torch.float64) delta_t tensor(-0.3965, dtype=torch.float64)
5 gae_duplicate tensor(-0.7765, dtype=torch.float64) tensor(8.2510, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2904, dtype=torch.float64) delta_t tensor(0.3227, dtype=torch.float64)
4 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-5.6213, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5780, dtype=torch.float64) delta_t tensor(-0.5442, dtype=torch.float64)
3 gae_duplicate tensor(-0.9285, dtype=torch.float64) tensor(9.9430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6498, dtype=torch.float64) delta_t tensor(0.3123, dtype=torch.float64)
2 gae_duplicate tensor(-0.4826, dtype=torch.float64) tensor(-5.2508, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:202.18594360351562
value loss:29.960494995117188
entropies:354.0526123046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.086803913116455 seconds
19 rew tensor(1.1795, dtype=torch.float64) delta_t tensor(0.0390, dtype=torch.float64)
19 gae_duplicate tensor(-0.1177, dtype=torch.float64) tensor(-0.7428, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1151, dtype=torch.float64) delta_t tensor(0.0874, dtype=torch.float64)
18 gae_duplicate tensor(-0.0083, dtype=torch.float64) tensor(-1.8357, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(-0.0235, dtype=torch.float64)
17 gae_duplicate tensor(-0.1096, dtype=torch.float64) tensor(0.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8985, dtype=torch.float64) delta_t tensor(-0.0304, dtype=torch.float64)
16 gae_duplicate tensor(-0.1688, dtype=torch.float64) tensor(0.7196, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8334, dtype=torch.float64) delta_t tensor(-0.1703, dtype=torch.float64)
15 gae_duplicate tensor(-0.3018, dtype=torch.float64) tensor(3.3878, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5236, dtype=torch.float64) delta_t tensor(0.2274, dtype=torch.float64)
14 gae_duplicate tensor(-0.0446, dtype=torch.float64) tensor(-4.3640, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.8463, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
13 gae_duplicate tensor(-0.0664, dtype=torch.float64) tensor(0.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.0235, dtype=torch.float64) delta_t tensor(-0.1523, dtype=torch.float64)
12 gae_duplicate tensor(-0.2248, dtype=torch.float64) tensor(3.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.7184, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
11 gae_duplicate tensor(-0.1056, dtype=torch.float64) tensor(-0.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.2341, dtype=torch.float64) delta_t tensor(-0.2182, dtype=torch.float64)
10 gae_duplicate tensor(-0.3831, dtype=torch.float64) tensor(4.1858, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3730, dtype=torch.float64) delta_t tensor(0.1850, dtype=torch.float64)
9 gae_duplicate tensor(-0.2053, dtype=torch.float64) tensor(-3.1037, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5536, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
8 gae_duplicate tensor(-0.0340, dtype=torch.float64) tensor(-1.0077, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1272, dtype=torch.float64) delta_t tensor(0.5027, dtype=torch.float64)
7 gae_duplicate tensor(0.0565, dtype=torch.float64) tensor(-10.1886, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8258, dtype=torch.float64) delta_t tensor(-0.0919, dtype=torch.float64)
6 gae_duplicate tensor(-0.5111, dtype=torch.float64) tensor(0.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1158, dtype=torch.float64) delta_t tensor(-0.1889, dtype=torch.float64)
5 gae_duplicate tensor(-0.5025, dtype=torch.float64) tensor(3.9407, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3771, dtype=torch.float64) delta_t tensor(-0.0792, dtype=torch.float64)
4 gae_duplicate tensor(-0.2249, dtype=torch.float64) tensor(1.9714, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4221, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
3 gae_duplicate tensor(-0.3292, dtype=torch.float64) tensor(-0.9431, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0446, dtype=torch.float64) delta_t tensor(-0.2944, dtype=torch.float64)
2 gae_duplicate tensor(-0.9031, dtype=torch.float64) tensor(5.6465, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-161.54351806640625
value loss:9.585801124572754
entropies:354.01287841796875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.942720890045166 seconds
19 rew tensor(1.1538, dtype=torch.float64) delta_t tensor(0.0125, dtype=torch.float64)
19 gae_duplicate tensor(-0.1165, dtype=torch.float64) tensor(-0.2230, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1544, dtype=torch.float64) delta_t tensor(0.1353, dtype=torch.float64)
18 gae_duplicate tensor(-0.0799, dtype=torch.float64) tensor(-2.5949, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0247, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
17 gae_duplicate tensor(-0.0973, dtype=torch.float64) tensor(-0.5494, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9463, dtype=torch.float64) delta_t tensor(0.0710, dtype=torch.float64)
16 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-1.4002, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9120, dtype=torch.float64) delta_t tensor(-0.0653, dtype=torch.float64)
15 gae_duplicate tensor(-0.1553, dtype=torch.float64) tensor(1.1299, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2890, dtype=torch.float64) delta_t tensor(-0.2143, dtype=torch.float64)
14 gae_duplicate tensor(-1.1095, dtype=torch.float64) tensor(4.3502, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7484, dtype=torch.float64) delta_t tensor(0.0087, dtype=torch.float64)
13 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(0.3850, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2154, dtype=torch.float64) delta_t tensor(-0.0266, dtype=torch.float64)
12 gae_duplicate tensor(-0.3678, dtype=torch.float64) tensor(0.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4967, dtype=torch.float64) delta_t tensor(0.0298, dtype=torch.float64)
11 gae_duplicate tensor(-0.1040, dtype=torch.float64) tensor(-0.5418, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1412, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
10 gae_duplicate tensor(-0.1813, dtype=torch.float64) tensor(1.3513, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4313, dtype=torch.float64) delta_t tensor(0.3704, dtype=torch.float64)
9 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-7.4567, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5777, dtype=torch.float64) delta_t tensor(-0.0045, dtype=torch.float64)
8 gae_duplicate tensor(-0.3270, dtype=torch.float64) tensor(-0.5184, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2395, dtype=torch.float64) delta_t tensor(0.4667, dtype=torch.float64)
7 gae_duplicate tensor(0.0470, dtype=torch.float64) tensor(-8.8910, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8005, dtype=torch.float64) delta_t tensor(-0.0421, dtype=torch.float64)
6 gae_duplicate tensor(-0.2892, dtype=torch.float64) tensor(-0.1512, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1930, dtype=torch.float64) delta_t tensor(-0.2076, dtype=torch.float64)
5 gae_duplicate tensor(-0.5807, dtype=torch.float64) tensor(4.0594, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.3041, dtype=torch.float64) delta_t tensor(0.0198, dtype=torch.float64)
4 gae_duplicate tensor(-0.2508, dtype=torch.float64) tensor(-0.0240, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4802, dtype=torch.float64) delta_t tensor(-0.0135, dtype=torch.float64)
3 gae_duplicate tensor(-0.1729, dtype=torch.float64) tensor(0.2376, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0236, dtype=torch.float64) delta_t tensor(-0.3276, dtype=torch.float64)
2 gae_duplicate tensor(-1.2424, dtype=torch.float64) tensor(6.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:89.87969207763672
value loss:13.022810935974121
entropies:354.0091857910156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.060776948928833 seconds
19 rew tensor(1.1653, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
19 gae_duplicate tensor(-0.1696, dtype=torch.float64) tensor(-0.8382, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1535, dtype=torch.float64) delta_t tensor(0.1443, dtype=torch.float64)
18 gae_duplicate tensor(-0.0853, dtype=torch.float64) tensor(-2.8557, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1035, dtype=torch.float64) delta_t tensor(0.0946, dtype=torch.float64)
17 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-2.0339, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9498, dtype=torch.float64) delta_t tensor(-0.0312, dtype=torch.float64)
16 gae_duplicate tensor(-0.1200, dtype=torch.float64) tensor(0.5041, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8468, dtype=torch.float64) delta_t tensor(-0.0324, dtype=torch.float64)
15 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(0.6335, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7052, dtype=torch.float64) delta_t tensor(0.1550, dtype=torch.float64)
14 gae_duplicate tensor(-0.1895, dtype=torch.float64) tensor(-2.8180, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7051, dtype=torch.float64) delta_t tensor(-0.0826, dtype=torch.float64)
13 gae_duplicate tensor(-0.2341, dtype=torch.float64) tensor(1.3377, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3712, dtype=torch.float64) delta_t tensor(0.0563, dtype=torch.float64)
12 gae_duplicate tensor(-0.1607, dtype=torch.float64) tensor(-0.9530, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4786, dtype=torch.float64) delta_t tensor(0.0935, dtype=torch.float64)
11 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-1.8533, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0283, dtype=torch.float64) delta_t tensor(-0.0745, dtype=torch.float64)
10 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(1.2869, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2186, dtype=torch.float64) delta_t tensor(0.4669, dtype=torch.float64)
9 gae_duplicate tensor(0.1913, dtype=torch.float64) tensor(-9.2685, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4289, dtype=torch.float64) delta_t tensor(0.1502, dtype=torch.float64)
8 gae_duplicate tensor(-0.0838, dtype=torch.float64) tensor(-3.7747, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7236, dtype=torch.float64) delta_t tensor(-0.5579, dtype=torch.float64)
7 gae_duplicate tensor(-3.3678, dtype=torch.float64) tensor(9.8175, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5468, dtype=torch.float64) delta_t tensor(0.1196, dtype=torch.float64)
6 gae_duplicate tensor(-0.9817, dtype=torch.float64) tensor(-0.9497, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7624, dtype=torch.float64) delta_t tensor(-0.4762, dtype=torch.float64)
5 gae_duplicate tensor(-0.7919, dtype=torch.float64) tensor(8.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2444, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
4 gae_duplicate tensor(-0.1631, dtype=torch.float64) tensor(-1.2146, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4233, dtype=torch.float64) delta_t tensor(-0.3088, dtype=torch.float64)
3 gae_duplicate tensor(-1.0663, dtype=torch.float64) tensor(5.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5916, dtype=torch.float64) delta_t tensor(0.2502, dtype=torch.float64)
2 gae_duplicate tensor(-0.1572, dtype=torch.float64) tensor(-4.4412, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:48.60107421875
value loss:32.43024444580078
entropies:353.9887390136719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.084203004837036 seconds
19 rew tensor(1.1663, dtype=torch.float64) delta_t tensor(0.0433, dtype=torch.float64)
19 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-0.9137, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1281, dtype=torch.float64) delta_t tensor(0.1060, dtype=torch.float64)
18 gae_duplicate tensor(-0.0571, dtype=torch.float64) tensor(-2.1635, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0390, dtype=torch.float64) delta_t tensor(0.0381, dtype=torch.float64)
17 gae_duplicate tensor(-0.0694, dtype=torch.float64) tensor(-0.9926, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0141, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
16 gae_duplicate tensor(-0.0201, dtype=torch.float64) tensor(-1.0360, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8335, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
15 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(1.3929, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4346, dtype=torch.float64) delta_t tensor(-0.1763, dtype=torch.float64)
14 gae_duplicate tensor(-1.5142, dtype=torch.float64) tensor(3.7969, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3154, dtype=torch.float64) delta_t tensor(-0.3140, dtype=torch.float64)
13 gae_duplicate tensor(-1.6567, dtype=torch.float64) tensor(6.5811, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2423, dtype=torch.float64) delta_t tensor(0.1569, dtype=torch.float64)
12 gae_duplicate tensor(-0.0665, dtype=torch.float64) tensor(-2.6474, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4849, dtype=torch.float64) delta_t tensor(0.0247, dtype=torch.float64)
11 gae_duplicate tensor(-0.1395, dtype=torch.float64) tensor(-0.7364, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0801, dtype=torch.float64) delta_t tensor(0.0029, dtype=torch.float64)
10 gae_duplicate tensor(-0.0891, dtype=torch.float64) tensor(-0.1502, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5134, dtype=torch.float64) delta_t tensor(0.2411, dtype=torch.float64)
9 gae_duplicate tensor(0.0136, dtype=torch.float64) tensor(-4.7991, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7353, dtype=torch.float64) delta_t tensor(-0.0696, dtype=torch.float64)
8 gae_duplicate tensor(-0.3592, dtype=torch.float64) tensor(0.9854, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.1966, dtype=torch.float64) delta_t tensor(0.5202, dtype=torch.float64)
7 gae_duplicate tensor(-0.0154, dtype=torch.float64) tensor(-9.9076, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7481, dtype=torch.float64) delta_t tensor(-0.0682, dtype=torch.float64)
6 gae_duplicate tensor(-0.3298, dtype=torch.float64) tensor(0.2860, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2514, dtype=torch.float64) delta_t tensor(-0.2295, dtype=torch.float64)
5 gae_duplicate tensor(-0.6561, dtype=torch.float64) tensor(4.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2728, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
4 gae_duplicate tensor(-0.1941, dtype=torch.float64) tensor(0.0998, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5835, dtype=torch.float64) delta_t tensor(-0.0930, dtype=torch.float64)
3 gae_duplicate tensor(-0.4338, dtype=torch.float64) tensor(1.8209, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0999, dtype=torch.float64) delta_t tensor(-0.1517, dtype=torch.float64)
2 gae_duplicate tensor(-0.4862, dtype=torch.float64) tensor(3.0867, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-62.306148529052734
value loss:17.56793785095215
entropies:354.0224304199219
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3950.1138)
ToM Target loss= tensor(1845.1932)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.27542519569397 seconds
19 rew tensor(1.1159, dtype=torch.float64) delta_t tensor(0.0002, dtype=torch.float64)
19 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(0.0766, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1419, dtype=torch.float64) delta_t tensor(0.1293, dtype=torch.float64)
18 gae_duplicate tensor(-0.0887, dtype=torch.float64) tensor(-2.4955, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0637, dtype=torch.float64) delta_t tensor(0.0636, dtype=torch.float64)
17 gae_duplicate tensor(-0.0514, dtype=torch.float64) tensor(-1.5844, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9360, dtype=torch.float64) delta_t tensor(-0.0193, dtype=torch.float64)
16 gae_duplicate tensor(-0.1569, dtype=torch.float64) tensor(0.1457, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8853, dtype=torch.float64) delta_t tensor(-0.0005, dtype=torch.float64)
15 gae_duplicate tensor(-0.1496, dtype=torch.float64) tensor(-0.0513, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7161, dtype=torch.float64) delta_t tensor(0.0289, dtype=torch.float64)
14 gae_duplicate tensor(-0.1367, dtype=torch.float64) tensor(-0.5405, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6942, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
13 gae_duplicate tensor(-0.3514, dtype=torch.float64) tensor(0.4313, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2773, dtype=torch.float64) delta_t tensor(-0.0789, dtype=torch.float64)
12 gae_duplicate tensor(-0.2560, dtype=torch.float64) tensor(1.5605, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5046, dtype=torch.float64) delta_t tensor(0.0795, dtype=torch.float64)
11 gae_duplicate tensor(-0.1051, dtype=torch.float64) tensor(-1.5049, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0325, dtype=torch.float64) delta_t tensor(0.1002, dtype=torch.float64)
10 gae_duplicate tensor(-0.2008, dtype=torch.float64) tensor(-2.0018, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2607, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
9 gae_duplicate tensor(0.1075, dtype=torch.float64) tensor(-7.1684, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5841, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
8 gae_duplicate tensor(-0.3223, dtype=torch.float64) tensor(-2.2854, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.4686, dtype=torch.float64) delta_t tensor(-0.4154, dtype=torch.float64)
7 gae_duplicate tensor(-3.3315, dtype=torch.float64) tensor(8.2672, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7014, dtype=torch.float64) delta_t tensor(-0.0738, dtype=torch.float64)
6 gae_duplicate tensor(-0.9471, dtype=torch.float64) tensor(2.4205, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5550, dtype=torch.float64) delta_t tensor(-0.3794, dtype=torch.float64)
5 gae_duplicate tensor(-0.7063, dtype=torch.float64) tensor(7.8174, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1869, dtype=torch.float64) delta_t tensor(0.1570, dtype=torch.float64)
4 gae_duplicate tensor(-0.1853, dtype=torch.float64) tensor(-2.3072, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2876, dtype=torch.float64) delta_t tensor(-0.3119, dtype=torch.float64)
3 gae_duplicate tensor(-1.0295, dtype=torch.float64) tensor(5.5384, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5469, dtype=torch.float64) delta_t tensor(0.1962, dtype=torch.float64)
2 gae_duplicate tensor(-0.4887, dtype=torch.float64) tensor(-3.3735, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-254.62570190429688
value loss:31.989118576049805
entropies:354.07781982421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.364849328994751 seconds
19 rew tensor(1.1407, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
19 gae_duplicate tensor(-0.1503, dtype=torch.float64) tensor(-0.2617, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0761, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
18 gae_duplicate tensor(-0.0791, dtype=torch.float64) tensor(-1.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1041, dtype=torch.float64) delta_t tensor(0.1012, dtype=torch.float64)
17 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(-2.2977, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9371, dtype=torch.float64) delta_t tensor(0.0269, dtype=torch.float64)
16 gae_duplicate tensor(-0.0819, dtype=torch.float64) tensor(-0.7732, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8851, dtype=torch.float64) delta_t tensor(-0.0788, dtype=torch.float64)
15 gae_duplicate tensor(-0.2905, dtype=torch.float64) tensor(1.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6293, dtype=torch.float64) delta_t tensor(0.0064, dtype=torch.float64)
14 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(0.0303, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6541, dtype=torch.float64) delta_t tensor(-0.0195, dtype=torch.float64)
13 gae_duplicate tensor(-0.1408, dtype=torch.float64) tensor(0.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3204, dtype=torch.float64) delta_t tensor(0.1266, dtype=torch.float64)
12 gae_duplicate tensor(-0.1353, dtype=torch.float64) tensor(-2.5257, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1765, dtype=torch.float64) delta_t tensor(-0.3319, dtype=torch.float64)
11 gae_duplicate tensor(-1.6193, dtype=torch.float64) tensor(5.9168, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0415, dtype=torch.float64) delta_t tensor(0.0507, dtype=torch.float64)
10 gae_duplicate tensor(-0.3155, dtype=torch.float64) tensor(-0.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4838, dtype=torch.float64) delta_t tensor(0.1809, dtype=torch.float64)
9 gae_duplicate tensor(-0.1861, dtype=torch.float64) tensor(-3.4729, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6551, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
8 gae_duplicate tensor(-0.2632, dtype=torch.float64) tensor(-0.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0978, dtype=torch.float64) delta_t tensor(0.5515, dtype=torch.float64)
7 gae_duplicate tensor(0.0976, dtype=torch.float64) tensor(-11.0165, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7863, dtype=torch.float64) delta_t tensor(-0.0371, dtype=torch.float64)
6 gae_duplicate tensor(-0.2494, dtype=torch.float64) tensor(-0.4009, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1766, dtype=torch.float64) delta_t tensor(-0.1783, dtype=torch.float64)
5 gae_duplicate tensor(-0.5231, dtype=torch.float64) tensor(3.2509, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4010, dtype=torch.float64) delta_t tensor(0.0687, dtype=torch.float64)
4 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-1.0606, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.4432, dtype=torch.float64) delta_t tensor(0.0487, dtype=torch.float64)
3 gae_duplicate tensor(-0.1059, dtype=torch.float64) tensor(-1.0091, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0670, dtype=torch.float64) delta_t tensor(-0.3788, dtype=torch.float64)
2 gae_duplicate tensor(-0.7571, dtype=torch.float64) tensor(7.4828, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:237.0920867919922
value loss:14.134910583496094
entropies:354.15777587890625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.364466190338135 seconds
19 rew tensor(1.2049, dtype=torch.float64) delta_t tensor(0.0817, dtype=torch.float64)
19 gae_duplicate tensor(-0.0717, dtype=torch.float64) tensor(-1.5784, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2056, dtype=torch.float64) delta_t tensor(0.2085, dtype=torch.float64)
18 gae_duplicate tensor(-0.0043, dtype=torch.float64) tensor(-4.3683, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1800, dtype=torch.float64) delta_t tensor(0.1793, dtype=torch.float64)
17 gae_duplicate tensor(-0.0434, dtype=torch.float64) tensor(-4.0916, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0521, dtype=torch.float64) delta_t tensor(0.1020, dtype=torch.float64)
16 gae_duplicate tensor(-0.0858, dtype=torch.float64) tensor(-2.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0032, dtype=torch.float64) delta_t tensor(0.0682, dtype=torch.float64)
15 gae_duplicate tensor(-0.2011, dtype=torch.float64) tensor(-1.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(-0.3950, dtype=torch.float64) delta_t tensor(-0.7412, dtype=torch.float64)
14 gae_duplicate tensor(-2.6991, dtype=torch.float64) tensor(14.1996, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3937, dtype=torch.float64) delta_t tensor(-0.3746, dtype=torch.float64)
13 gae_duplicate tensor(-1.5455, dtype=torch.float64) tensor(9.0559, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1537, dtype=torch.float64) delta_t tensor(0.1378, dtype=torch.float64)
12 gae_duplicate tensor(-0.2322, dtype=torch.float64) tensor(-1.9335, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5539, dtype=torch.float64) delta_t tensor(0.0157, dtype=torch.float64)
11 gae_duplicate tensor(-0.1479, dtype=torch.float64) tensor(-0.5467, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1686, dtype=torch.float64) delta_t tensor(0.0249, dtype=torch.float64)
10 gae_duplicate tensor(-0.1347, dtype=torch.float64) tensor(-0.4719, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.6562, dtype=torch.float64) delta_t tensor(0.6188, dtype=torch.float64)
9 gae_duplicate tensor(0.1891, dtype=torch.float64) tensor(-12.5103, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.7263, dtype=torch.float64) delta_t tensor(-0.1330, dtype=torch.float64)
8 gae_duplicate tensor(-0.2928, dtype=torch.float64) tensor(1.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5485, dtype=torch.float64) delta_t tensor(0.4548, dtype=torch.float64)
7 gae_duplicate tensor(0.0032, dtype=torch.float64) tensor(-8.8654, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8035, dtype=torch.float64) delta_t tensor(-0.0355, dtype=torch.float64)
6 gae_duplicate tensor(-0.2575, dtype=torch.float64) tensor(-0.1491, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4267, dtype=torch.float64) delta_t tensor(-0.1627, dtype=torch.float64)
5 gae_duplicate tensor(-0.5668, dtype=torch.float64) tensor(3.3404, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0705, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
4 gae_duplicate tensor(-0.0408, dtype=torch.float64) tensor(-1.1131, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0535, dtype=torch.float64) delta_t tensor(-0.1549, dtype=torch.float64)
3 gae_duplicate tensor(-0.3213, dtype=torch.float64) tensor(2.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2643, dtype=torch.float64) delta_t tensor(-0.0632, dtype=torch.float64)
2 gae_duplicate tensor(-0.3934, dtype=torch.float64) tensor(1.6133, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:295.6579284667969
value loss:35.47852325439453
entropies:354.24676513671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.976434946060181 seconds
19 rew tensor(1.1792, dtype=torch.float64) delta_t tensor(0.0499, dtype=torch.float64)
19 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-0.9586, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.2189, dtype=torch.float64) delta_t tensor(0.2043, dtype=torch.float64)
18 gae_duplicate tensor(0.1112, dtype=torch.float64) tensor(-4.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.7814, dtype=torch.float64) delta_t tensor(-0.2223, dtype=torch.float64)
17 gae_duplicate tensor(-1.4576, dtype=torch.float64) tensor(4.2547, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.8963, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
16 gae_duplicate tensor(-0.1953, dtype=torch.float64) tensor(1.4090, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8723, dtype=torch.float64) delta_t tensor(-0.0865, dtype=torch.float64)
15 gae_duplicate tensor(-0.1431, dtype=torch.float64) tensor(1.8729, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5755, dtype=torch.float64) delta_t tensor(0.0592, dtype=torch.float64)
14 gae_duplicate tensor(-0.2841, dtype=torch.float64) tensor(-1.0049, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4596, dtype=torch.float64) delta_t tensor(-0.1705, dtype=torch.float64)
13 gae_duplicate tensor(-1.0986, dtype=torch.float64) tensor(3.5290, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.0061, dtype=torch.float64)
12 gae_duplicate tensor(-0.2079, dtype=torch.float64) tensor(0.1281, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4242, dtype=torch.float64) delta_t tensor(0.0517, dtype=torch.float64)
11 gae_duplicate tensor(-0.3021, dtype=torch.float64) tensor(-1.0827, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1037, dtype=torch.float64) delta_t tensor(0.0011, dtype=torch.float64)
10 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(-0.3222, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3439, dtype=torch.float64) delta_t tensor(0.3234, dtype=torch.float64)
9 gae_duplicate tensor(-0.0566, dtype=torch.float64) tensor(-6.2409, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6849, dtype=torch.float64) delta_t tensor(-0.0296, dtype=torch.float64)
8 gae_duplicate tensor(-0.4231, dtype=torch.float64) tensor(0.0196, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6485, dtype=torch.float64) delta_t tensor(0.2906, dtype=torch.float64)
7 gae_duplicate tensor(-0.4683, dtype=torch.float64) tensor(-5.5992, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7617, dtype=torch.float64) delta_t tensor(-0.0849, dtype=torch.float64)
6 gae_duplicate tensor(-0.3985, dtype=torch.float64) tensor(0.9642, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4784, dtype=torch.float64) delta_t tensor(-0.3079, dtype=torch.float64)
5 gae_duplicate tensor(-0.6245, dtype=torch.float64) tensor(6.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0221, dtype=torch.float64) delta_t tensor(0.1175, dtype=torch.float64)
4 gae_duplicate tensor(-0.2010, dtype=torch.float64) tensor(-1.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0867, dtype=torch.float64) delta_t tensor(-0.1571, dtype=torch.float64)
3 gae_duplicate tensor(-0.8911, dtype=torch.float64) tensor(2.7587, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3388, dtype=torch.float64) delta_t tensor(0.0302, dtype=torch.float64)
2 gae_duplicate tensor(-0.3624, dtype=torch.float64) tensor(-0.3288, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-103.25247192382812
value loss:17.79645538330078
entropies:354.40045166015625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.038572072982788 seconds
19 rew tensor(1.1787, dtype=torch.float64) delta_t tensor(0.0455, dtype=torch.float64)
19 gae_duplicate tensor(-0.1071, dtype=torch.float64) tensor(-0.8447, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1403, dtype=torch.float64) delta_t tensor(0.1380, dtype=torch.float64)
18 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-2.8827, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0242, dtype=torch.float64) delta_t tensor(0.0363, dtype=torch.float64)
17 gae_duplicate tensor(-0.1913, dtype=torch.float64) tensor(-0.9713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9723, dtype=torch.float64) delta_t tensor(0.0346, dtype=torch.float64)
16 gae_duplicate tensor(-0.1501, dtype=torch.float64) tensor(-0.7171, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8567, dtype=torch.float64) delta_t tensor(-0.1321, dtype=torch.float64)
15 gae_duplicate tensor(-0.3146, dtype=torch.float64) tensor(2.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7155, dtype=torch.float64) delta_t tensor(0.2167, dtype=torch.float64)
14 gae_duplicate tensor(-0.0405, dtype=torch.float64) tensor(-3.8786, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7835, dtype=torch.float64) delta_t tensor(-0.0888, dtype=torch.float64)
13 gae_duplicate tensor(-0.2695, dtype=torch.float64) tensor(1.3173, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.1628, dtype=torch.float64) delta_t tensor(-0.0823, dtype=torch.float64)
12 gae_duplicate tensor(-0.1878, dtype=torch.float64) tensor(1.6508, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.6691, dtype=torch.float64) delta_t tensor(0.0693, dtype=torch.float64)
11 gae_duplicate tensor(-0.1203, dtype=torch.float64) tensor(-1.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0967, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
10 gae_duplicate tensor(-0.2913, dtype=torch.float64) tensor(0.1862, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3582, dtype=torch.float64) delta_t tensor(0.2751, dtype=torch.float64)
9 gae_duplicate tensor(-0.1039, dtype=torch.float64) tensor(-5.6146, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5557, dtype=torch.float64) delta_t tensor(0.0526, dtype=torch.float64)
8 gae_duplicate tensor(-0.0815, dtype=torch.float64) tensor(-1.5597, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2285, dtype=torch.float64) delta_t tensor(-0.4284, dtype=torch.float64)
7 gae_duplicate tensor(-4.0292, dtype=torch.float64) tensor(9.1430, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8744, dtype=torch.float64) delta_t tensor(-0.2436, dtype=torch.float64)
6 gae_duplicate tensor(-1.0154, dtype=torch.float64) tensor(5.5492, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2546, dtype=torch.float64) delta_t tensor(-0.1640, dtype=torch.float64)
5 gae_duplicate tensor(-0.4820, dtype=torch.float64) tensor(3.6368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0976, dtype=torch.float64) delta_t tensor(0.1055, dtype=torch.float64)
4 gae_duplicate tensor(-0.1256, dtype=torch.float64) tensor(-1.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8735, dtype=torch.float64) delta_t tensor(-0.0041, dtype=torch.float64)
3 gae_duplicate tensor(-0.5126, dtype=torch.float64) tensor(-0.2493, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2762, dtype=torch.float64) delta_t tensor(0.0116, dtype=torch.float64)
2 gae_duplicate tensor(-0.2482, dtype=torch.float64) tensor(-0.3224, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-315.5838928222656
value loss:36.92972946166992
entropies:354.4739990234375
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3955.0249)
ToM Target loss= tensor(1808.7898)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.049851894378662 seconds
19 rew tensor(1.1802, dtype=torch.float64) delta_t tensor(0.0440, dtype=torch.float64)
19 gae_duplicate tensor(-0.1847, dtype=torch.float64) tensor(-0.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9056, dtype=torch.float64) delta_t tensor(-0.1125, dtype=torch.float64)
18 gae_duplicate tensor(-1.5163, dtype=torch.float64) tensor(2.4008, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9627, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
17 gae_duplicate tensor(-0.2032, dtype=torch.float64) tensor(1.2521, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9491, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
16 gae_duplicate tensor(-0.0809, dtype=torch.float64) tensor(0.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8606, dtype=torch.float64) delta_t tensor(-0.1177, dtype=torch.float64)
15 gae_duplicate tensor(-0.2704, dtype=torch.float64) tensor(2.2137, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6151, dtype=torch.float64) delta_t tensor(-0.0237, dtype=torch.float64)
14 gae_duplicate tensor(-0.2613, dtype=torch.float64) tensor(0.6915, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6550, dtype=torch.float64) delta_t tensor(-0.0464, dtype=torch.float64)
13 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(1.0226, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2432, dtype=torch.float64) delta_t tensor(0.0439, dtype=torch.float64)
12 gae_duplicate tensor(-0.0523, dtype=torch.float64) tensor(-0.8101, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5496, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
11 gae_duplicate tensor(-0.2438, dtype=torch.float64) tensor(0.4295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1941, dtype=torch.float64) delta_t tensor(-0.1083, dtype=torch.float64)
10 gae_duplicate tensor(-0.2199, dtype=torch.float64) tensor(2.1995, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4716, dtype=torch.float64) delta_t tensor(0.2833, dtype=torch.float64)
9 gae_duplicate tensor(-0.0273, dtype=torch.float64) tensor(-5.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5971, dtype=torch.float64) delta_t tensor(-0.0439, dtype=torch.float64)
8 gae_duplicate tensor(-0.3524, dtype=torch.float64) tensor(0.3133, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.2777, dtype=torch.float64) delta_t tensor(0.4015, dtype=torch.float64)
7 gae_duplicate tensor(-0.0427, dtype=torch.float64) tensor(-7.8946, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7722, dtype=torch.float64) delta_t tensor(-0.0863, dtype=torch.float64)
6 gae_duplicate tensor(-0.3532, dtype=torch.float64) tensor(0.9876, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2338, dtype=torch.float64) delta_t tensor(-0.2334, dtype=torch.float64)
5 gae_duplicate tensor(-0.6412, dtype=torch.float64) tensor(4.9355, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2968, dtype=torch.float64) delta_t tensor(-0.0087, dtype=torch.float64)
4 gae_duplicate tensor(-0.1675, dtype=torch.float64) tensor(0.6994, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.5261, dtype=torch.float64) delta_t tensor(0.0740, dtype=torch.float64)
3 gae_duplicate tensor(-0.0649, dtype=torch.float64) tensor(-1.3553, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0763, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
2 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(0.0817, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-141.16537475585938
value loss:11.084488868713379
entropies:354.4901428222656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.65428900718689 seconds
19 rew tensor(1.0917, dtype=torch.float64) delta_t tensor(-0.0345, dtype=torch.float64)
19 gae_duplicate tensor(-0.2076, dtype=torch.float64) tensor(0.7193, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0914, dtype=torch.float64) delta_t tensor(0.0719, dtype=torch.float64)
18 gae_duplicate tensor(-0.1004, dtype=torch.float64) tensor(-1.4619, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1177, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
17 gae_duplicate tensor(-0.0233, dtype=torch.float64) tensor(-2.1465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0393, dtype=torch.float64) delta_t tensor(0.0496, dtype=torch.float64)
16 gae_duplicate tensor(-0.0560, dtype=torch.float64) tensor(-1.2548, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9115, dtype=torch.float64) delta_t tensor(-0.1005, dtype=torch.float64)
15 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(1.8808, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4283, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
14 gae_duplicate tensor(-1.7990, dtype=torch.float64) tensor(3.8938, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7710, dtype=torch.float64) delta_t tensor(-0.0655, dtype=torch.float64)
13 gae_duplicate tensor(-0.2882, dtype=torch.float64) tensor(1.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3053, dtype=torch.float64) delta_t tensor(0.0176, dtype=torch.float64)
12 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-0.1700, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4618, dtype=torch.float64) delta_t tensor(-0.0532, dtype=torch.float64)
11 gae_duplicate tensor(-0.2261, dtype=torch.float64) tensor(0.9655, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1841, dtype=torch.float64) delta_t tensor(-0.1042, dtype=torch.float64)
10 gae_duplicate tensor(-0.2369, dtype=torch.float64) tensor(2.2225, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3197, dtype=torch.float64) delta_t tensor(0.4482, dtype=torch.float64)
9 gae_duplicate tensor(0.3169, dtype=torch.float64) tensor(-8.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4032, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
8 gae_duplicate tensor(0.0375, dtype=torch.float64) tensor(-2.7052, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.6150, dtype=torch.float64) delta_t tensor(-0.5014, dtype=torch.float64)
7 gae_duplicate tensor(-3.3445, dtype=torch.float64) tensor(10.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5072, dtype=torch.float64) delta_t tensor(0.1212, dtype=torch.float64)
6 gae_duplicate tensor(-0.7739, dtype=torch.float64) tensor(-1.3274, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7438, dtype=torch.float64) delta_t tensor(-0.4708, dtype=torch.float64)
5 gae_duplicate tensor(-0.5566, dtype=torch.float64) tensor(9.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1639, dtype=torch.float64) delta_t tensor(0.0371, dtype=torch.float64)
4 gae_duplicate tensor(-0.1126, dtype=torch.float64) tensor(0.2930, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2963, dtype=torch.float64) delta_t tensor(-0.1966, dtype=torch.float64)
3 gae_duplicate tensor(-0.9861, dtype=torch.float64) tensor(3.9341, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5243, dtype=torch.float64) delta_t tensor(0.1494, dtype=torch.float64)
2 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-2.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-872.693603515625
value loss:32.328857421875
entropies:354.47479248046875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.400982141494751 seconds
19 rew tensor(1.1296, dtype=torch.float64) delta_t tensor(-0.0009, dtype=torch.float64)
19 gae_duplicate tensor(-0.1773, dtype=torch.float64) tensor(-0.0549, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1432, dtype=torch.float64) delta_t tensor(0.1269, dtype=torch.float64)
18 gae_duplicate tensor(-0.0091, dtype=torch.float64) tensor(-2.4515, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0922, dtype=torch.float64) delta_t tensor(0.0904, dtype=torch.float64)
17 gae_duplicate tensor(-0.1258, dtype=torch.float64) tensor(-2.1780, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9649, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
16 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(0.1091, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8337, dtype=torch.float64) delta_t tensor(-0.1213, dtype=torch.float64)
15 gae_duplicate tensor(-0.3058, dtype=torch.float64) tensor(2.5182, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4837, dtype=torch.float64) delta_t tensor(-0.2861, dtype=torch.float64)
14 gae_duplicate tensor(-1.5344, dtype=torch.float64) tensor(5.6672, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.3935, dtype=torch.float64) delta_t tensor(-0.3132, dtype=torch.float64)
13 gae_duplicate tensor(-1.3490, dtype=torch.float64) tensor(6.8715, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3594, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
12 gae_duplicate tensor(-0.2016, dtype=torch.float64) tensor(-1.2067, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4070, dtype=torch.float64) delta_t tensor(-0.0915, dtype=torch.float64)
11 gae_duplicate tensor(-0.2423, dtype=torch.float64) tensor(1.6793, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0545, dtype=torch.float64) delta_t tensor(-0.0467, dtype=torch.float64)
10 gae_duplicate tensor(-0.1949, dtype=torch.float64) tensor(1.1055, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2552, dtype=torch.float64) delta_t tensor(0.3298, dtype=torch.float64)
9 gae_duplicate tensor(0.1304, dtype=torch.float64) tensor(-6.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4274, dtype=torch.float64) delta_t tensor(0.0968, dtype=torch.float64)
8 gae_duplicate tensor(0.0538, dtype=torch.float64) tensor(-2.4800, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8089, dtype=torch.float64) delta_t tensor(0.1802, dtype=torch.float64)
7 gae_duplicate tensor(-0.0068, dtype=torch.float64) tensor(-3.8721, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5312, dtype=torch.float64) delta_t tensor(0.1553, dtype=torch.float64)
6 gae_duplicate tensor(0.0773, dtype=torch.float64) tensor(-3.3420, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6695, dtype=torch.float64) delta_t tensor(-0.4010, dtype=torch.float64)
5 gae_duplicate tensor(-0.4910, dtype=torch.float64) tensor(7.5819, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0404, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
4 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(0.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0274, dtype=torch.float64) delta_t tensor(0.0388, dtype=torch.float64)
3 gae_duplicate tensor(-0.4630, dtype=torch.float64) tensor(-0.8865, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3198, dtype=torch.float64) delta_t tensor(-0.0453, dtype=torch.float64)
2 gae_duplicate tensor(-0.3541, dtype=torch.float64) tensor(0.6257, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-287.04730224609375
value loss:13.170778274536133
entropies:354.4486999511719
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0537331104278564 seconds
19 rew tensor(1.1290, dtype=torch.float64) delta_t tensor(0.0028, dtype=torch.float64)
19 gae_duplicate tensor(-0.0758, dtype=torch.float64) tensor(-0.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0910, dtype=torch.float64) delta_t tensor(0.0816, dtype=torch.float64)
18 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-1.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1315, dtype=torch.float64) delta_t tensor(0.1322, dtype=torch.float64)
17 gae_duplicate tensor(5.4770e-05, dtype=torch.float64) tensor(-2.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0148, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
16 gae_duplicate tensor(-0.0766, dtype=torch.float64) tensor(-1.5247, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8994, dtype=torch.float64) delta_t tensor(-0.0811, dtype=torch.float64)
15 gae_duplicate tensor(-0.2871, dtype=torch.float64) tensor(1.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7328, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
14 gae_duplicate tensor(-0.1526, dtype=torch.float64) tensor(-0.6109, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.2148, dtype=torch.float64) delta_t tensor(-0.5018, dtype=torch.float64)
13 gae_duplicate tensor(-2.9830, dtype=torch.float64) tensor(9.2403, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.1571, dtype=torch.float64) delta_t tensor(-0.4542, dtype=torch.float64)
12 gae_duplicate tensor(-2.6136, dtype=torch.float64) tensor(10.4175, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4870, dtype=torch.float64) delta_t tensor(-0.0480, dtype=torch.float64)
11 gae_duplicate tensor(-0.2934, dtype=torch.float64) tensor(1.8243, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0033, dtype=torch.float64) delta_t tensor(0.0392, dtype=torch.float64)
10 gae_duplicate tensor(-0.3417, dtype=torch.float64) tensor(-0.6471, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3805, dtype=torch.float64) delta_t tensor(0.2009, dtype=torch.float64)
9 gae_duplicate tensor(-0.2126, dtype=torch.float64) tensor(-3.8313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5301, dtype=torch.float64) delta_t tensor(0.0573, dtype=torch.float64)
8 gae_duplicate tensor(-0.1288, dtype=torch.float64) tensor(-1.6604, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.3678, dtype=torch.float64) delta_t tensor(0.3887, dtype=torch.float64)
7 gae_duplicate tensor(-0.1190, dtype=torch.float64) tensor(-8.0742, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7504, dtype=torch.float64) delta_t tensor(-0.0079, dtype=torch.float64)
6 gae_duplicate tensor(-0.2870, dtype=torch.float64) tensor(-0.7986, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2573, dtype=torch.float64) delta_t tensor(-0.1974, dtype=torch.float64)
5 gae_duplicate tensor(-0.6278, dtype=torch.float64) tensor(3.7213, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2478, dtype=torch.float64) delta_t tensor(0.0403, dtype=torch.float64)
4 gae_duplicate tensor(-0.1194, dtype=torch.float64) tensor(-0.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.6126, dtype=torch.float64) delta_t tensor(-0.0233, dtype=torch.float64)
3 gae_duplicate tensor(-0.3476, dtype=torch.float64) tensor(0.2224, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.0998, dtype=torch.float64) delta_t tensor(-0.2064, dtype=torch.float64)
2 gae_duplicate tensor(-0.7555, dtype=torch.float64) tensor(4.0922, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-570.7976684570312
value loss:33.20814895629883
entropies:354.4619445800781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.091475963592529 seconds
19 rew tensor(1.1941, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
19 gae_duplicate tensor(-0.0857, dtype=torch.float64) tensor(-2.5876, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1169, dtype=torch.float64) delta_t tensor(0.0937, dtype=torch.float64)
18 gae_duplicate tensor(0.0188, dtype=torch.float64) tensor(-2.1710, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9622, dtype=torch.float64) delta_t tensor(-0.0246, dtype=torch.float64)
17 gae_duplicate tensor(-0.1872, dtype=torch.float64) tensor(0.2605, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9760, dtype=torch.float64) delta_t tensor(0.0307, dtype=torch.float64)
16 gae_duplicate tensor(-0.1063, dtype=torch.float64) tensor(-0.5678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.7825, dtype=torch.float64) delta_t tensor(-0.1215, dtype=torch.float64)
15 gae_duplicate tensor(-0.2741, dtype=torch.float64) tensor(2.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4326, dtype=torch.float64) delta_t tensor(-0.2257, dtype=torch.float64)
14 gae_duplicate tensor(-1.6612, dtype=torch.float64) tensor(4.8621, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5667, dtype=torch.float64) delta_t tensor(-0.0316, dtype=torch.float64)
13 gae_duplicate tensor(-0.2107, dtype=torch.float64) tensor(1.0527, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3538, dtype=torch.float64) delta_t tensor(0.1881, dtype=torch.float64)
12 gae_duplicate tensor(-0.2138, dtype=torch.float64) tensor(-3.8375, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3610, dtype=torch.float64) delta_t tensor(-0.0714, dtype=torch.float64)
11 gae_duplicate tensor(-0.2362, dtype=torch.float64) tensor(1.0784, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0192, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
10 gae_duplicate tensor(-0.1796, dtype=torch.float64) tensor(-0.1546, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4866, dtype=torch.float64) delta_t tensor(0.1006, dtype=torch.float64)
9 gae_duplicate tensor(0.0172, dtype=torch.float64) tensor(-2.0075, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6638, dtype=torch.float64) delta_t tensor(-0.0587, dtype=torch.float64)
8 gae_duplicate tensor(-0.4779, dtype=torch.float64) tensor(1.0525, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.0454, dtype=torch.float64) delta_t tensor(0.5637, dtype=torch.float64)
7 gae_duplicate tensor(-0.0897, dtype=torch.float64) tensor(-10.5081, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8282, dtype=torch.float64) delta_t tensor(-0.1006, dtype=torch.float64)
6 gae_duplicate tensor(-0.3798, dtype=torch.float64) tensor(1.0385, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1059, dtype=torch.float64) delta_t tensor(-0.1666, dtype=torch.float64)
5 gae_duplicate tensor(-0.6599, dtype=torch.float64) tensor(3.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.4287, dtype=torch.float64) delta_t tensor(0.0279, dtype=torch.float64)
4 gae_duplicate tensor(-0.1253, dtype=torch.float64) tensor(-0.1956, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.3718, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
3 gae_duplicate tensor(-0.2672, dtype=torch.float64) tensor(-1.1474, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.0923, dtype=torch.float64) delta_t tensor(-0.2453, dtype=torch.float64)
2 gae_duplicate tensor(-0.6452, dtype=torch.float64) tensor(4.7567, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:84.79942321777344
value loss:14.823177337646484
entropies:354.4866638183594
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3951.2554)
ToM Target loss= tensor(1774.1514)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.848546981811523 seconds
19 rew tensor(1.0539, dtype=torch.float64) delta_t tensor(-0.0671, dtype=torch.float64)
19 gae_duplicate tensor(-0.1735, dtype=torch.float64) tensor(1.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0675, dtype=torch.float64) delta_t tensor(0.0676, dtype=torch.float64)
18 gae_duplicate tensor(-0.0059, dtype=torch.float64) tensor(-1.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(-0.0111, dtype=torch.float64)
17 gae_duplicate tensor(-0.0955, dtype=torch.float64) tensor(0.1215, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9385, dtype=torch.float64) delta_t tensor(-0.0022, dtype=torch.float64)
16 gae_duplicate tensor(-0.1661, dtype=torch.float64) tensor(0.0345, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9000, dtype=torch.float64) delta_t tensor(-0.0007, dtype=torch.float64)
15 gae_duplicate tensor(-0.1470, dtype=torch.float64) tensor(0.0009, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4352, dtype=torch.float64) delta_t tensor(-0.2420, dtype=torch.float64)
14 gae_duplicate tensor(-1.7035, dtype=torch.float64) tensor(4.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4862, dtype=torch.float64) delta_t tensor(-0.2189, dtype=torch.float64)
13 gae_duplicate tensor(-1.3253, dtype=torch.float64) tensor(4.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3320, dtype=torch.float64) delta_t tensor(0.0230, dtype=torch.float64)
12 gae_duplicate tensor(-0.1776, dtype=torch.float64) tensor(0.0099, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5242, dtype=torch.float64) delta_t tensor(0.0209, dtype=torch.float64)
11 gae_duplicate tensor(-0.2667, dtype=torch.float64) tensor(-0.5076, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0295, dtype=torch.float64) delta_t tensor(-0.0656, dtype=torch.float64)
10 gae_duplicate tensor(-0.2212, dtype=torch.float64) tensor(1.1822, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2280, dtype=torch.float64) delta_t tensor(0.2783, dtype=torch.float64)
9 gae_duplicate tensor(0.1153, dtype=torch.float64) tensor(-5.2809, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5204, dtype=torch.float64) delta_t tensor(0.0695, dtype=torch.float64)
8 gae_duplicate tensor(-0.0758, dtype=torch.float64) tensor(-1.8590, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4858, dtype=torch.float64) delta_t tensor(0.3003, dtype=torch.float64)
7 gae_duplicate tensor(-0.0540, dtype=torch.float64) tensor(-6.1251, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6113, dtype=torch.float64) delta_t tensor(0.0608, dtype=torch.float64)
6 gae_duplicate tensor(-0.0962, dtype=torch.float64) tensor(-1.8978, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4665, dtype=torch.float64) delta_t tensor(-0.3016, dtype=torch.float64)
5 gae_duplicate tensor(-0.5630, dtype=torch.float64) tensor(5.6802, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1459, dtype=torch.float64) delta_t tensor(-0.0332, dtype=torch.float64)
4 gae_duplicate tensor(-0.2297, dtype=torch.float64) tensor(1.2221, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(0.1403, dtype=torch.float64)
3 gae_duplicate tensor(-0.2689, dtype=torch.float64) tensor(-2.6401, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2156, dtype=torch.float64) delta_t tensor(-0.0603, dtype=torch.float64)
2 gae_duplicate tensor(-0.4314, dtype=torch.float64) tensor(0.9758, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-124.6463394165039
value loss:13.980950355529785
entropies:354.495849609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.422762870788574 seconds
19 rew tensor(1.1571, dtype=torch.float64) delta_t tensor(0.0593, dtype=torch.float64)
19 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(-1.2426, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1052, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
18 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-2.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0789, dtype=torch.float64) delta_t tensor(0.1117, dtype=torch.float64)
17 gae_duplicate tensor(-0.0497, dtype=torch.float64) tensor(-2.5465, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0028, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
16 gae_duplicate tensor(-0.0972, dtype=torch.float64) tensor(-1.6867, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8638, dtype=torch.float64) delta_t tensor(0.0101, dtype=torch.float64)
15 gae_duplicate tensor(-0.2596, dtype=torch.float64) tensor(-0.3784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7833, dtype=torch.float64) delta_t tensor(0.2069, dtype=torch.float64)
14 gae_duplicate tensor(-0.0899, dtype=torch.float64) tensor(-3.9120, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4236, dtype=torch.float64) delta_t tensor(-0.1646, dtype=torch.float64)
13 gae_duplicate tensor(-0.9161, dtype=torch.float64) tensor(2.7004, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4044, dtype=torch.float64) delta_t tensor(0.1314, dtype=torch.float64)
12 gae_duplicate tensor(-0.1452, dtype=torch.float64) tensor(-2.3899, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2972, dtype=torch.float64) delta_t tensor(-0.0434, dtype=torch.float64)
11 gae_duplicate tensor(-0.2149, dtype=torch.float64) tensor(0.6219, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0241, dtype=torch.float64) delta_t tensor(0.0653, dtype=torch.float64)
10 gae_duplicate tensor(-0.3202, dtype=torch.float64) tensor(-1.0292, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2891, dtype=torch.float64) delta_t tensor(0.3341, dtype=torch.float64)
9 gae_duplicate tensor(-0.1892, dtype=torch.float64) tensor(-6.7843, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4200, dtype=torch.float64) delta_t tensor(0.0964, dtype=torch.float64)
8 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(-2.7980, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.2416, dtype=torch.float64) delta_t tensor(-0.1656, dtype=torch.float64)
7 gae_duplicate tensor(-1.1823, dtype=torch.float64) tensor(2.7326, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6671, dtype=torch.float64) delta_t tensor(0.0493, dtype=torch.float64)
6 gae_duplicate tensor(-0.6605, dtype=torch.float64) tensor(-0.7857, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6170, dtype=torch.float64) delta_t tensor(-0.3671, dtype=torch.float64)
5 gae_duplicate tensor(-0.6718, dtype=torch.float64) tensor(7.2350, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0544, dtype=torch.float64) delta_t tensor(0.1529, dtype=torch.float64)
4 gae_duplicate tensor(-0.0881, dtype=torch.float64) tensor(-2.1801, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1901, dtype=torch.float64) delta_t tensor(-0.2327, dtype=torch.float64)
3 gae_duplicate tensor(-0.8023, dtype=torch.float64) tensor(4.4219, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3899, dtype=torch.float64) delta_t tensor(0.0599, dtype=torch.float64)
2 gae_duplicate tensor(-0.6167, dtype=torch.float64) tensor(-1.0362, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:522.6526489257812
value loss:19.006166458129883
entropies:354.53363037109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.158567905426025 seconds
19 rew tensor(1.1563, dtype=torch.float64) delta_t tensor(0.0639, dtype=torch.float64)
19 gae_duplicate tensor(-0.0404, dtype=torch.float64) tensor(-1.2443, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1827, dtype=torch.float64) delta_t tensor(0.2041, dtype=torch.float64)
18 gae_duplicate tensor(0.0578, dtype=torch.float64) tensor(-4.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0923, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
17 gae_duplicate tensor(-0.0073, dtype=torch.float64) tensor(-2.9087, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.7283, dtype=torch.float64) delta_t tensor(-0.2011, dtype=torch.float64)
16 gae_duplicate tensor(-1.3677, dtype=torch.float64) tensor(3.8524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8627, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
15 gae_duplicate tensor(-0.0844, dtype=torch.float64) tensor(0.7136, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.3819, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
14 gae_duplicate tensor(-0.9059, dtype=torch.float64) tensor(0.9530, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6327, dtype=torch.float64) delta_t tensor(-0.0001, dtype=torch.float64)
13 gae_duplicate tensor(-0.1214, dtype=torch.float64) tensor(0.1030, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2757, dtype=torch.float64) delta_t tensor(0.0454, dtype=torch.float64)
12 gae_duplicate tensor(-0.1745, dtype=torch.float64) tensor(-0.8835, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5687, dtype=torch.float64) delta_t tensor(-0.0040, dtype=torch.float64)
11 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-0.0813, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1873, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
10 gae_duplicate tensor(-0.2196, dtype=torch.float64) tensor(1.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.5007, dtype=torch.float64) delta_t tensor(0.3905, dtype=torch.float64)
9 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-7.3388, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6626, dtype=torch.float64) delta_t tensor(-0.0652, dtype=torch.float64)
8 gae_duplicate tensor(-0.2548, dtype=torch.float64) tensor(0.4973, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8706, dtype=torch.float64) delta_t tensor(0.0923, dtype=torch.float64)
7 gae_duplicate tensor(-1.3917, dtype=torch.float64) tensor(-1.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7408, dtype=torch.float64) delta_t tensor(-0.0387, dtype=torch.float64)
6 gae_duplicate tensor(-0.4756, dtype=torch.float64) tensor(0.5293, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4652, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
5 gae_duplicate tensor(-0.5259, dtype=torch.float64) tensor(4.2428, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0433, dtype=torch.float64) delta_t tensor(0.0191, dtype=torch.float64)
4 gae_duplicate tensor(-0.2331, dtype=torch.float64) tensor(-0.0120, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.0259, dtype=torch.float64) delta_t tensor(-0.0620, dtype=torch.float64)
3 gae_duplicate tensor(-0.5699, dtype=torch.float64) tensor(1.0011, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3060, dtype=torch.float64) delta_t tensor(-0.0253, dtype=torch.float64)
2 gae_duplicate tensor(-0.4562, dtype=torch.float64) tensor(0.4351, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:157.2478485107422
value loss:16.89288330078125
entropies:354.6402282714844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.901292085647583 seconds
19 rew tensor(1.1211, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
19 gae_duplicate tensor(-0.1602, dtype=torch.float64) tensor(-0.2475, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0942, dtype=torch.float64) delta_t tensor(0.1174, dtype=torch.float64)
18 gae_duplicate tensor(0.0066, dtype=torch.float64) tensor(-2.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0555, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
17 gae_duplicate tensor(-0.0723, dtype=torch.float64) tensor(-1.5758, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9382, dtype=torch.float64) delta_t tensor(0.0799, dtype=torch.float64)
16 gae_duplicate tensor(-0.1171, dtype=torch.float64) tensor(-1.6574, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9012, dtype=torch.float64) delta_t tensor(0.0724, dtype=torch.float64)
15 gae_duplicate tensor(-0.1252, dtype=torch.float64) tensor(-1.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6525, dtype=torch.float64) delta_t tensor(-0.0020, dtype=torch.float64)
14 gae_duplicate tensor(-0.1198, dtype=torch.float64) tensor(-0.0500, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6817, dtype=torch.float64) delta_t tensor(0.0375, dtype=torch.float64)
13 gae_duplicate tensor(-0.1064, dtype=torch.float64) tensor(-0.8228, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2385, dtype=torch.float64) delta_t tensor(-0.0837, dtype=torch.float64)
12 gae_duplicate tensor(-0.1972, dtype=torch.float64) tensor(1.6104, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4638, dtype=torch.float64) delta_t tensor(-0.0618, dtype=torch.float64)
11 gae_duplicate tensor(-0.1963, dtype=torch.float64) tensor(1.4840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0318, dtype=torch.float64) delta_t tensor(-0.0385, dtype=torch.float64)
10 gae_duplicate tensor(-0.2303, dtype=torch.float64) tensor(0.9007, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2961, dtype=torch.float64) delta_t tensor(0.2158, dtype=torch.float64)
9 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-3.9904, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4862, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
8 gae_duplicate tensor(-0.1981, dtype=torch.float64) tensor(-1.6773, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5763, dtype=torch.float64) delta_t tensor(0.2487, dtype=torch.float64)
7 gae_duplicate tensor(-0.2770, dtype=torch.float64) tensor(-4.8008, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7475, dtype=torch.float64) delta_t tensor(-0.0637, dtype=torch.float64)
6 gae_duplicate tensor(-0.4907, dtype=torch.float64) tensor(0.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3289, dtype=torch.float64) delta_t tensor(-0.2636, dtype=torch.float64)
5 gae_duplicate tensor(-0.5641, dtype=torch.float64) tensor(5.3279, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.1536, dtype=torch.float64) delta_t tensor(0.0158, dtype=torch.float64)
4 gae_duplicate tensor(-0.1677, dtype=torch.float64) tensor(0.1499, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7348, dtype=torch.float64) delta_t tensor(-0.0110, dtype=torch.float64)
3 gae_duplicate tensor(-0.6563, dtype=torch.float64) tensor(0.0581, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.2343, dtype=torch.float64) delta_t tensor(0.0052, dtype=torch.float64)
2 gae_duplicate tensor(-0.6137, dtype=torch.float64) tensor(-0.1541, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:393.9834289550781
value loss:9.964054107666016
entropies:354.77972412109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.170306205749512 seconds
19 rew tensor(1.1848, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
19 gae_duplicate tensor(-0.1554, dtype=torch.float64) tensor(-2.1478, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1066, dtype=torch.float64) delta_t tensor(0.1320, dtype=torch.float64)
18 gae_duplicate tensor(0.0069, dtype=torch.float64) tensor(-2.7638, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0162, dtype=torch.float64) delta_t tensor(0.0673, dtype=torch.float64)
17 gae_duplicate tensor(-0.0527, dtype=torch.float64) tensor(-1.6741, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0287, dtype=torch.float64) delta_t tensor(0.1159, dtype=torch.float64)
16 gae_duplicate tensor(-0.0589, dtype=torch.float64) tensor(-2.2995, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8746, dtype=torch.float64) delta_t tensor(-0.0337, dtype=torch.float64)
15 gae_duplicate tensor(-0.2135, dtype=torch.float64) tensor(0.3424, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.6932, dtype=torch.float64) delta_t tensor(0.1823, dtype=torch.float64)
14 gae_duplicate tensor(-0.1308, dtype=torch.float64) tensor(-3.6591, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6029, dtype=torch.float64) delta_t tensor(0.0402, dtype=torch.float64)
13 gae_duplicate tensor(-0.1958, dtype=torch.float64) tensor(-1.2495, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4353, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
12 gae_duplicate tensor(-0.2140, dtype=torch.float64) tensor(-0.2009, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4479, dtype=torch.float64) delta_t tensor(-0.1248, dtype=torch.float64)
11 gae_duplicate tensor(-0.3082, dtype=torch.float64) tensor(2.5328, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0021, dtype=torch.float64) delta_t tensor(0.1401, dtype=torch.float64)
10 gae_duplicate tensor(-0.2357, dtype=torch.float64) tensor(-2.7291, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2796, dtype=torch.float64) delta_t tensor(0.3572, dtype=torch.float64)
9 gae_duplicate tensor(-0.0465, dtype=torch.float64) tensor(-7.3106, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4316, dtype=torch.float64) delta_t tensor(0.1323, dtype=torch.float64)
8 gae_duplicate tensor(-0.0202, dtype=torch.float64) tensor(-3.3942, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.7465, dtype=torch.float64) delta_t tensor(-0.5861, dtype=torch.float64)
7 gae_duplicate tensor(-4.3034, dtype=torch.float64) tensor(11.6939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7329, dtype=torch.float64) delta_t tensor(-0.0875, dtype=torch.float64)
6 gae_duplicate tensor(-1.3833, dtype=torch.float64) tensor(2.5364, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5689, dtype=torch.float64) delta_t tensor(-0.2086, dtype=torch.float64)
5 gae_duplicate tensor(-0.4964, dtype=torch.float64) tensor(4.3166, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.2169, dtype=torch.float64) delta_t tensor(0.1416, dtype=torch.float64)
4 gae_duplicate tensor(-0.0703, dtype=torch.float64) tensor(-2.2490, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3564, dtype=torch.float64) delta_t tensor(-0.2240, dtype=torch.float64)
3 gae_duplicate tensor(-0.7474, dtype=torch.float64) tensor(3.9837, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5916, dtype=torch.float64) delta_t tensor(0.2542, dtype=torch.float64)
2 gae_duplicate tensor(-0.1584, dtype=torch.float64) tensor(-4.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:378.4548034667969
value loss:44.92500686645508
entropies:354.86328125
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3953.8010)
ToM Target loss= tensor(1751.5895)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.128096103668213 seconds
19 rew tensor(1.2081, dtype=torch.float64) delta_t tensor(0.1252, dtype=torch.float64)
19 gae_duplicate tensor(-0.0629, dtype=torch.float64) tensor(-2.4983, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1570, dtype=torch.float64) delta_t tensor(0.1915, dtype=torch.float64)
18 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-3.9314, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1316, dtype=torch.float64) delta_t tensor(0.1596, dtype=torch.float64)
17 gae_duplicate tensor(-0.0478, dtype=torch.float64) tensor(-3.5674, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0161, dtype=torch.float64) delta_t tensor(0.0705, dtype=torch.float64)
16 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(-1.6698, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9402, dtype=torch.float64) delta_t tensor(0.0057, dtype=torch.float64)
15 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-0.2375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4585, dtype=torch.float64) delta_t tensor(-0.1983, dtype=torch.float64)
14 gae_duplicate tensor(-1.6994, dtype=torch.float64) tensor(4.0168, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5095, dtype=torch.float64) delta_t tensor(-0.2479, dtype=torch.float64)
13 gae_duplicate tensor(-1.4780, dtype=torch.float64) tensor(5.4403, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.4596, dtype=torch.float64) delta_t tensor(-0.6906, dtype=torch.float64)
12 gae_duplicate tensor(-3.9005, dtype=torch.float64) tensor(14.6668, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2259, dtype=torch.float64) delta_t tensor(-0.2194, dtype=torch.float64)
11 gae_duplicate tensor(-1.6055, dtype=torch.float64) tensor(5.8890, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0432, dtype=torch.float64) delta_t tensor(0.0195, dtype=torch.float64)
10 gae_duplicate tensor(-0.2360, dtype=torch.float64) tensor(0.1515, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3484, dtype=torch.float64) delta_t tensor(0.3678, dtype=torch.float64)
9 gae_duplicate tensor(0.1323, dtype=torch.float64) tensor(-7.4879, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5612, dtype=torch.float64) delta_t tensor(0.0503, dtype=torch.float64)
8 gae_duplicate tensor(-0.1286, dtype=torch.float64) tensor(-1.6086, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8986, dtype=torch.float64) delta_t tensor(0.2108, dtype=torch.float64)
7 gae_duplicate tensor(-0.1994, dtype=torch.float64) tensor(-4.1159, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6910, dtype=torch.float64) delta_t tensor(-0.0243, dtype=torch.float64)
6 gae_duplicate tensor(-0.2926, dtype=torch.float64) tensor(-0.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5650, dtype=torch.float64) delta_t tensor(-0.2206, dtype=torch.float64)
5 gae_duplicate tensor(-0.4610, dtype=torch.float64) tensor(4.3755, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1561, dtype=torch.float64) delta_t tensor(0.1445, dtype=torch.float64)
4 gae_duplicate tensor(-0.1443, dtype=torch.float64) tensor(-2.4326, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.2893, dtype=torch.float64) delta_t tensor(-0.1541, dtype=torch.float64)
3 gae_duplicate tensor(-0.7437, dtype=torch.float64) tensor(2.9954, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5051, dtype=torch.float64) delta_t tensor(0.1464, dtype=torch.float64)
2 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-2.6588, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-489.71087646484375
value loss:44.142826080322266
entropies:354.9548645019531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.098963022232056 seconds
19 rew tensor(1.2222, dtype=torch.float64) delta_t tensor(0.1457, dtype=torch.float64)
19 gae_duplicate tensor(-0.0165, dtype=torch.float64) tensor(-2.9038, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1323, dtype=torch.float64) delta_t tensor(0.1614, dtype=torch.float64)
18 gae_duplicate tensor(-0.0383, dtype=torch.float64) tensor(-3.4751, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9911, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
17 gae_duplicate tensor(-0.1941, dtype=torch.float64) tensor(-0.7718, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9784, dtype=torch.float64) delta_t tensor(0.0384, dtype=torch.float64)
16 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-0.8239, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8492, dtype=torch.float64) delta_t tensor(-0.0855, dtype=torch.float64)
15 gae_duplicate tensor(-0.2091, dtype=torch.float64) tensor(1.7368, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.8227, dtype=torch.float64) delta_t tensor(0.2272, dtype=torch.float64)
14 gae_duplicate tensor(0.0133, dtype=torch.float64) tensor(-4.4696, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5237, dtype=torch.float64) delta_t tensor(-0.2260, dtype=torch.float64)
13 gae_duplicate tensor(-0.9061, dtype=torch.float64) tensor(3.9520, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(-0.5048, dtype=torch.float64) delta_t tensor(-0.6186, dtype=torch.float64)
12 gae_duplicate tensor(-3.8541, dtype=torch.float64) tensor(12.0824, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.3013, dtype=torch.float64) delta_t tensor(-0.1209, dtype=torch.float64)
11 gae_duplicate tensor(-1.7320, dtype=torch.float64) tensor(3.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1327, dtype=torch.float64) delta_t tensor(-0.0573, dtype=torch.float64)
10 gae_duplicate tensor(-0.2101, dtype=torch.float64) tensor(1.3834, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4243, dtype=torch.float64) delta_t tensor(0.4074, dtype=torch.float64)
9 gae_duplicate tensor(0.1282, dtype=torch.float64) tensor(-7.8899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5609, dtype=torch.float64) delta_t tensor(-0.0373, dtype=torch.float64)
8 gae_duplicate tensor(-0.2300, dtype=torch.float64) tensor(-0.0996, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.9750, dtype=torch.float64) delta_t tensor(0.1860, dtype=torch.float64)
7 gae_duplicate tensor(0.0624, dtype=torch.float64) tensor(-3.7039, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6648, dtype=torch.float64) delta_t tensor(-0.0031, dtype=torch.float64)
6 gae_duplicate tensor(-0.3599, dtype=torch.float64) tensor(-0.2901, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6464, dtype=torch.float64) delta_t tensor(-0.2551, dtype=torch.float64)
5 gae_duplicate tensor(-0.4580, dtype=torch.float64) tensor(5.0161, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1378, dtype=torch.float64) delta_t tensor(0.1469, dtype=torch.float64)
4 gae_duplicate tensor(-0.0508, dtype=torch.float64) tensor(-2.4354, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3134, dtype=torch.float64) delta_t tensor(-0.1824, dtype=torch.float64)
3 gae_duplicate tensor(-0.5320, dtype=torch.float64) tensor(3.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4735, dtype=torch.float64) delta_t tensor(0.1188, dtype=torch.float64)
2 gae_duplicate tensor(-0.1918, dtype=torch.float64) tensor(-1.9238, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-235.6533203125
value loss:37.524620056152344
entropies:354.9944152832031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.973482131958008 seconds
19 rew tensor(1.1947, dtype=torch.float64) delta_t tensor(0.0962, dtype=torch.float64)
19 gae_duplicate tensor(-0.1345, dtype=torch.float64) tensor(-1.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.8852, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
18 gae_duplicate tensor(-1.4705, dtype=torch.float64) tensor(1.9001, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0283, dtype=torch.float64) delta_t tensor(0.0668, dtype=torch.float64)
17 gae_duplicate tensor(-0.1597, dtype=torch.float64) tensor(-1.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0035, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
16 gae_duplicate tensor(-0.0706, dtype=torch.float64) tensor(-1.7619, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8997, dtype=torch.float64) delta_t tensor(-0.0447, dtype=torch.float64)
15 gae_duplicate tensor(-0.2071, dtype=torch.float64) tensor(0.7238, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2174, dtype=torch.float64) delta_t tensor(-0.2776, dtype=torch.float64)
14 gae_duplicate tensor(-2.3711, dtype=torch.float64) tensor(5.1868, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7331, dtype=torch.float64) delta_t tensor(0.0383, dtype=torch.float64)
13 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(-0.2515, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2038, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
12 gae_duplicate tensor(-0.2209, dtype=torch.float64) tensor(0.9745, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5390, dtype=torch.float64) delta_t tensor(0.0499, dtype=torch.float64)
11 gae_duplicate tensor(-0.2408, dtype=torch.float64) tensor(-0.7593, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.1719, dtype=torch.float64) delta_t tensor(-0.1516, dtype=torch.float64)
10 gae_duplicate tensor(-0.2947, dtype=torch.float64) tensor(2.9251, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3443, dtype=torch.float64) delta_t tensor(0.2778, dtype=torch.float64)
9 gae_duplicate tensor(-0.0144, dtype=torch.float64) tensor(-5.1882, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5078, dtype=torch.float64) delta_t tensor(0.0032, dtype=torch.float64)
8 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-0.6229, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7089, dtype=torch.float64) delta_t tensor(0.1687, dtype=torch.float64)
7 gae_duplicate tensor(-0.1711, dtype=torch.float64) tensor(-3.3494, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7414, dtype=torch.float64) delta_t tensor(-0.0534, dtype=torch.float64)
6 gae_duplicate tensor(-0.4400, dtype=torch.float64) tensor(0.8082, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.4360, dtype=torch.float64) delta_t tensor(-0.2754, dtype=torch.float64)
5 gae_duplicate tensor(-0.5723, dtype=torch.float64) tensor(5.6195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.0479, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
4 gae_duplicate tensor(-0.1570, dtype=torch.float64) tensor(-0.7477, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.9680, dtype=torch.float64) delta_t tensor(-0.0558, dtype=torch.float64)
3 gae_duplicate tensor(-0.8200, dtype=torch.float64) tensor(1.2193, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.3137, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
2 gae_duplicate tensor(-0.2319, dtype=torch.float64) tensor(-1.0779, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-237.04489135742188
value loss:20.502296447753906
entropies:355.0324401855469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.934051036834717 seconds
19 rew tensor(1.1811, dtype=torch.float64) delta_t tensor(0.0892, dtype=torch.float64)
19 gae_duplicate tensor(-0.1426, dtype=torch.float64) tensor(-1.7873, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1428, dtype=torch.float64) delta_t tensor(0.1563, dtype=torch.float64)
18 gae_duplicate tensor(0.0354, dtype=torch.float64) tensor(-3.3016, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1434, dtype=torch.float64) delta_t tensor(0.2681, dtype=torch.float64)
17 gae_duplicate tensor(0.0477, dtype=torch.float64) tensor(-5.4517, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0655, dtype=torch.float64) delta_t tensor(0.1064, dtype=torch.float64)
16 gae_duplicate tensor(0.0012, dtype=torch.float64) tensor(-2.6860, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8378, dtype=torch.float64) delta_t tensor(0.0936, dtype=torch.float64)
15 gae_duplicate tensor(-0.2221, dtype=torch.float64) tensor(-2.2482, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.7304, dtype=torch.float64) delta_t tensor(0.0500, dtype=torch.float64)
14 gae_duplicate tensor(-0.1542, dtype=torch.float64) tensor(-1.2576, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.4768, dtype=torch.float64) delta_t tensor(-0.0059, dtype=torch.float64)
13 gae_duplicate tensor(-0.1592, dtype=torch.float64) tensor(-0.0403, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4724, dtype=torch.float64) delta_t tensor(0.0093, dtype=torch.float64)
12 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(-0.2623, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.1671, dtype=torch.float64) delta_t tensor(-0.0543, dtype=torch.float64)
11 gae_duplicate tensor(-0.3450, dtype=torch.float64) tensor(1.0457, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.1212, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
10 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(-0.6520, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0780, dtype=torch.float64) delta_t tensor(0.4031, dtype=torch.float64)
9 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-7.8492, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4573, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
8 gae_duplicate tensor(-0.0448, dtype=torch.float64) tensor(-3.7137, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9220, dtype=torch.float64) delta_t tensor(-0.4960, dtype=torch.float64)
7 gae_duplicate tensor(-1.8656, dtype=torch.float64) tensor(9.4884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6005, dtype=torch.float64) delta_t tensor(0.0324, dtype=torch.float64)
6 gae_duplicate tensor(-0.4758, dtype=torch.float64) tensor(0.1228, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.9509, dtype=torch.float64) delta_t tensor(-0.4724, dtype=torch.float64)
5 gae_duplicate tensor(-0.7412, dtype=torch.float64) tensor(9.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.5232, dtype=torch.float64) delta_t tensor(0.2820, dtype=torch.float64)
4 gae_duplicate tensor(-0.1195, dtype=torch.float64) tensor(-4.6258, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.9145, dtype=torch.float64) delta_t tensor(-0.6069, dtype=torch.float64)
3 gae_duplicate tensor(-0.9717, dtype=torch.float64) tensor(11.3260, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.8462, dtype=torch.float64) delta_t tensor(0.4433, dtype=torch.float64)
2 gae_duplicate tensor(0.0612, dtype=torch.float64) tensor(-7.5804, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:457.5104675292969
value loss:23.107370376586914
entropies:355.0523376464844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.127180099487305 seconds
19 rew tensor(1.2452, dtype=torch.float64) delta_t tensor(0.1567, dtype=torch.float64)
19 gae_duplicate tensor(0.0524, dtype=torch.float64) tensor(-3.0609, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9301, dtype=torch.float64) delta_t tensor(-0.0461, dtype=torch.float64)
18 gae_duplicate tensor(-1.4830, dtype=torch.float64) tensor(0.5254, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.1035, dtype=torch.float64) delta_t tensor(0.1393, dtype=torch.float64)
17 gae_duplicate tensor(-0.1581, dtype=torch.float64) tensor(-2.7159, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1050, dtype=torch.float64) delta_t tensor(0.1482, dtype=torch.float64)
16 gae_duplicate tensor(-0.0189, dtype=torch.float64) tensor(-3.2683, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9140, dtype=torch.float64) delta_t tensor(0.1384, dtype=torch.float64)
15 gae_duplicate tensor(-0.1539, dtype=torch.float64) tensor(-3.1880, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5634, dtype=torch.float64) delta_t tensor(-0.0585, dtype=torch.float64)
14 gae_duplicate tensor(-0.6793, dtype=torch.float64) tensor(0.7095, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5142, dtype=torch.float64) delta_t tensor(0.1455, dtype=torch.float64)
13 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-2.8125, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5233, dtype=torch.float64) delta_t tensor(0.2089, dtype=torch.float64)
12 gae_duplicate tensor(-0.0321, dtype=torch.float64) tensor(-4.2803, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.2846, dtype=torch.float64) delta_t tensor(-0.0820, dtype=torch.float64)
11 gae_duplicate tensor(-0.3017, dtype=torch.float64) tensor(1.2254, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.2124, dtype=torch.float64) delta_t tensor(0.2487, dtype=torch.float64)
10 gae_duplicate tensor(-0.0998, dtype=torch.float64) tensor(-4.7893, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2979, dtype=torch.float64) delta_t tensor(0.3975, dtype=torch.float64)
9 gae_duplicate tensor(-0.0826, dtype=torch.float64) tensor(-8.6159, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5334, dtype=torch.float64) delta_t tensor(0.0482, dtype=torch.float64)
8 gae_duplicate tensor(-0.2987, dtype=torch.float64) tensor(-1.6561, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.9731, dtype=torch.float64) delta_t tensor(-0.6620, dtype=torch.float64)
7 gae_duplicate tensor(-4.5014, dtype=torch.float64) tensor(13.0146, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8070, dtype=torch.float64) delta_t tensor(-0.1091, dtype=torch.float64)
6 gae_duplicate tensor(-1.3249, dtype=torch.float64) tensor(3.6002, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.6643, dtype=torch.float64) delta_t tensor(-0.1922, dtype=torch.float64)
5 gae_duplicate tensor(-0.6529, dtype=torch.float64) tensor(4.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.3424, dtype=torch.float64) delta_t tensor(0.1735, dtype=torch.float64)
4 gae_duplicate tensor(-0.1825, dtype=torch.float64) tensor(-2.8697, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6932, dtype=torch.float64) delta_t tensor(-0.4429, dtype=torch.float64)
3 gae_duplicate tensor(-0.9725, dtype=torch.float64) tensor(8.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.6649, dtype=torch.float64) delta_t tensor(0.2829, dtype=torch.float64)
2 gae_duplicate tensor(-0.1824, dtype=torch.float64) tensor(-4.6817, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:467.6791687011719
value loss:55.52118682861328
entropies:355.0711364746094
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3958.0596)
ToM Target loss= tensor(1721.2644)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.217069149017334 seconds
19 rew tensor(1.1411, dtype=torch.float64) delta_t tensor(0.0321, dtype=torch.float64)
19 gae_duplicate tensor(-0.0712, dtype=torch.float64) tensor(-0.6422, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1412, dtype=torch.float64) delta_t tensor(0.1485, dtype=torch.float64)
18 gae_duplicate tensor(0.0171, dtype=torch.float64) tensor(-3.0963, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0899, dtype=torch.float64) delta_t tensor(0.1144, dtype=torch.float64)
17 gae_duplicate tensor(-0.0697, dtype=torch.float64) tensor(-2.4980, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9236, dtype=torch.float64) delta_t tensor(-0.0216, dtype=torch.float64)
16 gae_duplicate tensor(-0.1478, dtype=torch.float64) tensor(0.1242, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8864, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
15 gae_duplicate tensor(-0.1276, dtype=torch.float64) tensor(-0.2094, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5085, dtype=torch.float64) delta_t tensor(-0.2290, dtype=torch.float64)
14 gae_duplicate tensor(-1.4538, dtype=torch.float64) tensor(4.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.6425, dtype=torch.float64) delta_t tensor(0.0153, dtype=torch.float64)
13 gae_duplicate tensor(-0.1354, dtype=torch.float64) tensor(0.1745, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2944, dtype=torch.float64) delta_t tensor(-0.0100, dtype=torch.float64)
12 gae_duplicate tensor(-0.2289, dtype=torch.float64) tensor(0.1936, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4098, dtype=torch.float64) delta_t tensor(-0.0221, dtype=torch.float64)
11 gae_duplicate tensor(-0.1595, dtype=torch.float64) tensor(0.4320, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0233, dtype=torch.float64) delta_t tensor(-0.0202, dtype=torch.float64)
10 gae_duplicate tensor(-0.2502, dtype=torch.float64) tensor(0.4815, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1379, dtype=torch.float64) delta_t tensor(0.2136, dtype=torch.float64)
9 gae_duplicate tensor(-0.0550, dtype=torch.float64) tensor(-4.0037, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5443, dtype=torch.float64) delta_t tensor(0.0480, dtype=torch.float64)
8 gae_duplicate tensor(-0.1739, dtype=torch.float64) tensor(-1.3667, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8243, dtype=torch.float64) delta_t tensor(0.1730, dtype=torch.float64)
7 gae_duplicate tensor(-0.4424, dtype=torch.float64) tensor(-3.5703, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6476, dtype=torch.float64) delta_t tensor(-0.0263, dtype=torch.float64)
6 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(0.0902, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5871, dtype=torch.float64) delta_t tensor(-0.3467, dtype=torch.float64)
5 gae_duplicate tensor(-0.5681, dtype=torch.float64) tensor(6.8231, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0843, dtype=torch.float64) delta_t tensor(0.1433, dtype=torch.float64)
4 gae_duplicate tensor(-0.1965, dtype=torch.float64) tensor(-2.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1868, dtype=torch.float64) delta_t tensor(-0.2253, dtype=torch.float64)
3 gae_duplicate tensor(-0.9964, dtype=torch.float64) tensor(4.3909, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4584, dtype=torch.float64) delta_t tensor(0.1059, dtype=torch.float64)
2 gae_duplicate tensor(-0.3759, dtype=torch.float64) tensor(-1.4391, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-13.811392784118652
value loss:12.387191772460938
entropies:355.0714111328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0600950717926025 seconds
19 rew tensor(1.1432, dtype=torch.float64) delta_t tensor(0.0217, dtype=torch.float64)
19 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(-0.4540, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1557, dtype=torch.float64) delta_t tensor(0.1413, dtype=torch.float64)
18 gae_duplicate tensor(-0.0192, dtype=torch.float64) tensor(-2.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0912, dtype=torch.float64) delta_t tensor(0.1083, dtype=torch.float64)
17 gae_duplicate tensor(-0.0346, dtype=torch.float64) tensor(-2.4792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9616, dtype=torch.float64) delta_t tensor(0.0423, dtype=torch.float64)
16 gae_duplicate tensor(-0.1650, dtype=torch.float64) tensor(-0.9949, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8593, dtype=torch.float64) delta_t tensor(-0.0320, dtype=torch.float64)
15 gae_duplicate tensor(-0.1412, dtype=torch.float64) tensor(0.5470, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4199, dtype=torch.float64) delta_t tensor(-0.2120, dtype=torch.float64)
14 gae_duplicate tensor(-1.5594, dtype=torch.float64) tensor(4.1092, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7449, dtype=torch.float64) delta_t tensor(-0.0855, dtype=torch.float64)
13 gae_duplicate tensor(-0.3343, dtype=torch.float64) tensor(2.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3307, dtype=torch.float64) delta_t tensor(0.1340, dtype=torch.float64)
12 gae_duplicate tensor(-0.2122, dtype=torch.float64) tensor(-2.4508, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4874, dtype=torch.float64) delta_t tensor(0.0401, dtype=torch.float64)
11 gae_duplicate tensor(-0.1548, dtype=torch.float64) tensor(-1.0796, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0407, dtype=torch.float64) delta_t tensor(-0.0848, dtype=torch.float64)
10 gae_duplicate tensor(-0.2703, dtype=torch.float64) tensor(1.5235, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.2540, dtype=torch.float64) delta_t tensor(0.2251, dtype=torch.float64)
9 gae_duplicate tensor(-0.1944, dtype=torch.float64) tensor(-4.1075, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5709, dtype=torch.float64) delta_t tensor(-0.0302, dtype=torch.float64)
8 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(0.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.3371, dtype=torch.float64) delta_t tensor(-0.3852, dtype=torch.float64)
7 gae_duplicate tensor(-3.2732, dtype=torch.float64) tensor(7.0652, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.6748, dtype=torch.float64) delta_t tensor(-0.0685, dtype=torch.float64)
6 gae_duplicate tensor(-0.7612, dtype=torch.float64) tensor(1.9807, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.5880, dtype=torch.float64) delta_t tensor(-0.3298, dtype=torch.float64)
5 gae_duplicate tensor(-0.5951, dtype=torch.float64) tensor(6.7690, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.0592, dtype=torch.float64) delta_t tensor(0.0888, dtype=torch.float64)
4 gae_duplicate tensor(-0.1281, dtype=torch.float64) tensor(-1.1409, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1771, dtype=torch.float64) delta_t tensor(-0.1266, dtype=torch.float64)
3 gae_duplicate tensor(-0.9387, dtype=torch.float64) tensor(2.5452, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.4069, dtype=torch.float64) delta_t tensor(0.1132, dtype=torch.float64)
2 gae_duplicate tensor(-0.2813, dtype=torch.float64) tensor(-1.9563, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-588.0877685546875
value loss:29.5113468170166
entropies:355.0473937988281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.343959093093872 seconds
19 rew tensor(1.1412, dtype=torch.float64) delta_t tensor(0.0141, dtype=torch.float64)
19 gae_duplicate tensor(-0.1144, dtype=torch.float64) tensor(-0.2799, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1415, dtype=torch.float64) delta_t tensor(0.1321, dtype=torch.float64)
18 gae_duplicate tensor(-0.1417, dtype=torch.float64) tensor(-2.5890, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0272, dtype=torch.float64) delta_t tensor(0.0283, dtype=torch.float64)
17 gae_duplicate tensor(-0.0831, dtype=torch.float64) tensor(-0.8014, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9769, dtype=torch.float64) delta_t tensor(0.0436, dtype=torch.float64)
16 gae_duplicate tensor(-0.0931, dtype=torch.float64) tensor(-1.0189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9136, dtype=torch.float64) delta_t tensor(0.0213, dtype=torch.float64)
15 gae_duplicate tensor(-0.2338, dtype=torch.float64) tensor(-0.4558, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.2061, dtype=torch.float64) delta_t tensor(-0.3363, dtype=torch.float64)
14 gae_duplicate tensor(-2.4345, dtype=torch.float64) tensor(6.3746, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7075, dtype=torch.float64) delta_t tensor(0.0759, dtype=torch.float64)
13 gae_duplicate tensor(-0.1474, dtype=torch.float64) tensor(-0.8441, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.2287, dtype=torch.float64) delta_t tensor(0.0186, dtype=torch.float64)
12 gae_duplicate tensor(-0.0733, dtype=torch.float64) tensor(-0.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5934, dtype=torch.float64) delta_t tensor(0.0287, dtype=torch.float64)
11 gae_duplicate tensor(-0.1877, dtype=torch.float64) tensor(-0.5438, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.0826, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
10 gae_duplicate tensor(-0.2395, dtype=torch.float64) tensor(-0.3056, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.4377, dtype=torch.float64) delta_t tensor(0.1902, dtype=torch.float64)
9 gae_duplicate tensor(0.0180, dtype=torch.float64) tensor(-3.7228, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6871, dtype=torch.float64) delta_t tensor(-0.0904, dtype=torch.float64)
8 gae_duplicate tensor(-0.3225, dtype=torch.float64) tensor(1.3764, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8431, dtype=torch.float64) delta_t tensor(-0.0791, dtype=torch.float64)
7 gae_duplicate tensor(-2.7138, dtype=torch.float64) tensor(0.9806, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9216, dtype=torch.float64) delta_t tensor(-0.2181, dtype=torch.float64)
6 gae_duplicate tensor(-0.9385, dtype=torch.float64) tensor(4.2708, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2240, dtype=torch.float64) delta_t tensor(-0.0787, dtype=torch.float64)
5 gae_duplicate tensor(-0.3676, dtype=torch.float64) tensor(1.9927, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2001, dtype=torch.float64) delta_t tensor(0.0149, dtype=torch.float64)
4 gae_duplicate tensor(-0.3008, dtype=torch.float64) tensor(-0.1093, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.8125, dtype=torch.float64) delta_t tensor(-0.1644, dtype=torch.float64)
3 gae_duplicate tensor(-0.5282, dtype=torch.float64) tensor(3.1543, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1478, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
2 gae_duplicate tensor(-0.5228, dtype=torch.float64) tensor(2.4676, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-607.7064819335938
value loss:30.306730270385742
entropies:355.0182800292969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.087186098098755 seconds
19 rew tensor(1.1559, dtype=torch.float64) delta_t tensor(0.0110, dtype=torch.float64)
19 gae_duplicate tensor(-0.1753, dtype=torch.float64) tensor(-0.2017, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1303, dtype=torch.float64) delta_t tensor(0.1162, dtype=torch.float64)
18 gae_duplicate tensor(-0.1119, dtype=torch.float64) tensor(-2.3410, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0655, dtype=torch.float64) delta_t tensor(0.0514, dtype=torch.float64)
17 gae_duplicate tensor(-0.1020, dtype=torch.float64) tensor(-1.2298, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0132, dtype=torch.float64) delta_t tensor(0.0319, dtype=torch.float64)
16 gae_duplicate tensor(-0.1280, dtype=torch.float64) tensor(-0.7253, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9762, dtype=torch.float64) delta_t tensor(0.2054, dtype=torch.float64)
15 gae_duplicate tensor(-0.1727, dtype=torch.float64) tensor(-4.0625, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.5648, dtype=torch.float64) delta_t tensor(-0.0470, dtype=torch.float64)
14 gae_duplicate tensor(-0.7679, dtype=torch.float64) tensor(0.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.7070, dtype=torch.float64) delta_t tensor(0.0750, dtype=torch.float64)
13 gae_duplicate tensor(-0.1441, dtype=torch.float64) tensor(-1.6012, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.4216, dtype=torch.float64) delta_t tensor(0.2852, dtype=torch.float64)
12 gae_duplicate tensor(-0.2081, dtype=torch.float64) tensor(-5.7921, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(-0.3318, dtype=torch.float64) delta_t tensor(-0.7810, dtype=torch.float64)
11 gae_duplicate tensor(-4.4420, dtype=torch.float64) tensor(15.7379, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(-0.3280, dtype=torch.float64) delta_t tensor(-0.2830, dtype=torch.float64)
10 gae_duplicate tensor(-1.4800, dtype=torch.float64) tensor(6.8944, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.3187, dtype=torch.float64) delta_t tensor(0.2333, dtype=torch.float64)
9 gae_duplicate tensor(-0.0213, dtype=torch.float64) tensor(-3.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4560, dtype=torch.float64) delta_t tensor(0.0658, dtype=torch.float64)
8 gae_duplicate tensor(-0.0871, dtype=torch.float64) tensor(-1.7206, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(0.2969, dtype=torch.float64)
7 gae_duplicate tensor(-0.0443, dtype=torch.float64) tensor(-5.9262, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8069, dtype=torch.float64) delta_t tensor(-0.0743, dtype=torch.float64)
6 gae_duplicate tensor(-0.4529, dtype=torch.float64) tensor(1.0057, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3267, dtype=torch.float64) delta_t tensor(-0.1859, dtype=torch.float64)
5 gae_duplicate tensor(-0.5157, dtype=torch.float64) tensor(3.7566, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.2278, dtype=torch.float64) delta_t tensor(-0.0299, dtype=torch.float64)
4 gae_duplicate tensor(-0.2719, dtype=torch.float64) tensor(1.0059, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-0.7595, dtype=torch.float64) delta_t tensor(0.0512, dtype=torch.float64)
3 gae_duplicate tensor(-0.3754, dtype=torch.float64) tensor(-1.0051, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.1328, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
2 gae_duplicate tensor(-0.9189, dtype=torch.float64) tensor(2.0720, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-230.69200134277344
value loss:46.69486999511719
entropies:354.9691467285156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.022829055786133 seconds
19 rew tensor(1.1807, dtype=torch.float64) delta_t tensor(0.0297, dtype=torch.float64)
19 gae_duplicate tensor(-0.0870, dtype=torch.float64) tensor(-0.5826, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.1812, dtype=torch.float64) delta_t tensor(0.1562, dtype=torch.float64)
18 gae_duplicate tensor(-0.0735, dtype=torch.float64) tensor(-3.1357, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0654, dtype=torch.float64) delta_t tensor(0.0461, dtype=torch.float64)
17 gae_duplicate tensor(-0.0300, dtype=torch.float64) tensor(-1.2774, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9770, dtype=torch.float64) delta_t tensor(0.0361, dtype=torch.float64)
16 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(-0.7576, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.8590, dtype=torch.float64) delta_t tensor(0.0021, dtype=torch.float64)
15 gae_duplicate tensor(-0.1577, dtype=torch.float64) tensor(-0.0661, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.4616, dtype=torch.float64) delta_t tensor(-0.1067, dtype=torch.float64)
14 gae_duplicate tensor(-0.6589, dtype=torch.float64) tensor(1.9938, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.5994, dtype=torch.float64) delta_t tensor(0.1000, dtype=torch.float64)
13 gae_duplicate tensor(-0.1284, dtype=torch.float64) tensor(-1.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.3217, dtype=torch.float64) delta_t tensor(-0.0065, dtype=torch.float64)
12 gae_duplicate tensor(-0.2155, dtype=torch.float64) tensor(-0.0411, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.4180, dtype=torch.float64) delta_t tensor(-0.0406, dtype=torch.float64)
11 gae_duplicate tensor(-0.1231, dtype=torch.float64) tensor(0.7650, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.0643, dtype=torch.float64) delta_t tensor(-0.0975, dtype=torch.float64)
10 gae_duplicate tensor(-0.2351, dtype=torch.float64) tensor(1.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1751, dtype=torch.float64) delta_t tensor(0.3067, dtype=torch.float64)
9 gae_duplicate tensor(0.0048, dtype=torch.float64) tensor(-5.7313, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4004, dtype=torch.float64) delta_t tensor(0.0704, dtype=torch.float64)
8 gae_duplicate tensor(-0.2290, dtype=torch.float64) tensor(-2.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-1.1462, dtype=torch.float64) delta_t tensor(0.0038, dtype=torch.float64)
7 gae_duplicate tensor(-0.6165, dtype=torch.float64) tensor(-0.3071, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.5043, dtype=torch.float64) delta_t tensor(0.1514, dtype=torch.float64)
6 gae_duplicate tensor(-0.0274, dtype=torch.float64) tensor(-3.0512, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.7735, dtype=torch.float64) delta_t tensor(-0.4428, dtype=torch.float64)
5 gae_duplicate tensor(-0.9285, dtype=torch.float64) tensor(8.4867, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.1933, dtype=torch.float64) delta_t tensor(0.1001, dtype=torch.float64)
4 gae_duplicate tensor(-0.1659, dtype=torch.float64) tensor(-1.1398, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.3387, dtype=torch.float64) delta_t tensor(-0.2294, dtype=torch.float64)
3 gae_duplicate tensor(-0.8149, dtype=torch.float64) tensor(4.2160, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5405, dtype=torch.float64) delta_t tensor(0.1191, dtype=torch.float64)
2 gae_duplicate tensor(-0.2455, dtype=torch.float64) tensor(-2.0116, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:155.42352294921875
value loss:10.761341094970703
entropies:354.8663024902344
Policy training finished
---------------------
ToM training started
ToM data loaded
batch_size =  600
ToM_loss = tensor(3961.3469)
ToM Target loss= tensor(1661.2576)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 453, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt