obs <crafter.objects.Shelter object at 0x13fe9bdc0> [39.  0.  0.  0. 39.  0.  0.  0. 18.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13fe9bc10> [38.  0.  0.  0. 40.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13fe8adf0> [ 9.  0.  0.  0.  9.  0.  0.  0. 12.  0.  0.  0.]
obs <crafter.objects.Shelter object at 0x13fe9bdc0> [39.  0.  0.  0. 39.  0.  0.  0. 18.  0.  0.  0.]
obs <crafter.objects.Warehouse object at 0x13fe9bc10> [37.  0.  0.  0. 38.  0.  0.  0.  9.  0.  0.  0.]
obs <crafter.objects.Station object at 0x13fe8adf0> [9. 0. 0. 0. 9. 0. 0. 0. 7. 0. 0. 0.]
{'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0} {'food': 0.0, 'drink': 0.0, 'staff': 0.0}
training start after waiting for 0.003083944320678711 seconds
19 rew tensor(0.9642, dtype=torch.float64) delta_t tensor(0.7543, dtype=torch.float64)
19 gae_duplicate tensor(0.7095, dtype=torch.float64) tensor(-15.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(1.0144, dtype=torch.float64) delta_t tensor(0.8208, dtype=torch.float64)
18 gae_duplicate tensor(0.8502, dtype=torch.float64) tensor(-17.9279, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0735, dtype=torch.float64) delta_t tensor(0.8748, dtype=torch.float64)
17 gae_duplicate tensor(0.9205, dtype=torch.float64) tensor(-18.6350, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.1447, dtype=torch.float64) delta_t tensor(0.9301, dtype=torch.float64)
16 gae_duplicate tensor(0.9625, dtype=torch.float64) tensor(-21.4360, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.2326, dtype=torch.float64) delta_t tensor(1.0219, dtype=torch.float64)
15 gae_duplicate tensor(1.0491, dtype=torch.float64) tensor(-21.4375, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.3451, dtype=torch.float64) delta_t tensor(1.1330, dtype=torch.float64)
14 gae_duplicate tensor(1.1579, dtype=torch.float64) tensor(-25.1799, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.4967, dtype=torch.float64) delta_t tensor(1.3078, dtype=torch.float64)
13 gae_duplicate tensor(1.2799, dtype=torch.float64) tensor(-28.2117, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.6933, dtype=torch.float64) delta_t tensor(1.4737, dtype=torch.float64)
12 gae_duplicate tensor(1.4606, dtype=torch.float64) tensor(-30.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(2.0148, dtype=torch.float64) delta_t tensor(1.9412, dtype=torch.float64)
11 gae_duplicate tensor(1.9648, dtype=torch.float64) tensor(-42.9622, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(2.1909, dtype=torch.float64) delta_t tensor(2.2119, dtype=torch.float64)
10 gae_duplicate tensor(2.0469, dtype=torch.float64) tensor(-47.6931, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(1.6362, dtype=torch.float64) delta_t tensor(1.6368, dtype=torch.float64)
9 gae_duplicate tensor(1.4878, dtype=torch.float64) tensor(-35.7679, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(1.3606, dtype=torch.float64) delta_t tensor(0.9866, dtype=torch.float64)
8 gae_duplicate tensor(0.8805, dtype=torch.float64) tensor(-23.9153, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(0.5763, dtype=torch.float64) delta_t tensor(0.3874, dtype=torch.float64)
7 gae_duplicate tensor(-0.0540, dtype=torch.float64) tensor(-9.7332, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(0.2264, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
6 gae_duplicate tensor(-0.2443, dtype=torch.float64) tensor(-4.2183, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-0.4380, dtype=torch.float64) delta_t tensor(-0.6472, dtype=torch.float64)
5 gae_duplicate tensor(-1.2254, dtype=torch.float64) tensor(12.5538, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(0.4774, dtype=torch.float64) delta_t tensor(0.4579, dtype=torch.float64)
4 gae_duplicate tensor(0.1717, dtype=torch.float64) tensor(-7.7525, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.1339, dtype=torch.float64) delta_t tensor(-1.1580, dtype=torch.float64)
3 gae_duplicate tensor(-1.3611, dtype=torch.float64) tensor(22.2368, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(0.5551, dtype=torch.float64) delta_t tensor(0.5251, dtype=torch.float64)
2 gae_duplicate tensor(-1.2044, dtype=torch.float64) tensor(-8.6008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:17409.3984375
value loss:267.5450744628906
entropies:351.89019775390625
Policy training finished
---------------------
gamma: 0.1
/Users/suhuangyuan/DRA/ToM2C/shared_optim.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/python_arg_parser.cpp:1420.)
  exp_avg.mul_(beta1).add_(1 - beta1, grad)
training start after waiting for 5.493613004684448 seconds
19 rew tensor(0.9684, dtype=torch.float64) delta_t tensor(0.7585, dtype=torch.float64)
19 gae_duplicate tensor(0.7278, dtype=torch.float64) tensor(-15.3710, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9928, dtype=torch.float64) delta_t tensor(0.7772, dtype=torch.float64)
18 gae_duplicate tensor(0.7390, dtype=torch.float64) tensor(-16.2461, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0191, dtype=torch.float64) delta_t tensor(0.7712, dtype=torch.float64)
17 gae_duplicate tensor(0.7423, dtype=torch.float64) tensor(-17.4324, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0476, dtype=torch.float64) delta_t tensor(0.8500, dtype=torch.float64)
16 gae_duplicate tensor(0.9154, dtype=torch.float64) tensor(-18.5407, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0787, dtype=torch.float64) delta_t tensor(0.8770, dtype=torch.float64)
15 gae_duplicate tensor(0.9490, dtype=torch.float64) tensor(-19.4119, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.1127, dtype=torch.float64) delta_t tensor(0.9122, dtype=torch.float64)
14 gae_duplicate tensor(0.9872, dtype=torch.float64) tensor(-20.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.1503, dtype=torch.float64) delta_t tensor(0.8493, dtype=torch.float64)
13 gae_duplicate tensor(0.8413, dtype=torch.float64) tensor(-18.5099, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.1919, dtype=torch.float64) delta_t tensor(0.9492, dtype=torch.float64)
12 gae_duplicate tensor(0.9887, dtype=torch.float64) tensor(-20.5573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.2385, dtype=torch.float64) delta_t tensor(1.1182, dtype=torch.float64)
11 gae_duplicate tensor(1.1393, dtype=torch.float64) tensor(-23.9352, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.9043, dtype=torch.float64) delta_t tensor(0.9130, dtype=torch.float64)
10 gae_duplicate tensor(0.9721, dtype=torch.float64) tensor(-20.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.1510, dtype=torch.float64) delta_t tensor(0.1409, dtype=torch.float64)
9 gae_duplicate tensor(0.0628, dtype=torch.float64) tensor(-4.6408, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.1326, dtype=torch.float64) delta_t tensor(-0.5141, dtype=torch.float64)
8 gae_duplicate tensor(-0.7315, dtype=torch.float64) tensor(9.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.5318, dtype=torch.float64) delta_t tensor(-0.6938, dtype=torch.float64)
7 gae_duplicate tensor(-0.9468, dtype=torch.float64) tensor(15.1753, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.7524, dtype=torch.float64) delta_t tensor(-0.8855, dtype=torch.float64)
6 gae_duplicate tensor(-1.1977, dtype=torch.float64) tensor(18.5830, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.0329, dtype=torch.float64) delta_t tensor(-1.2346, dtype=torch.float64)
5 gae_duplicate tensor(-1.4864, dtype=torch.float64) tensor(25.5232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6382, dtype=torch.float64) delta_t tensor(-0.6541, dtype=torch.float64)
4 gae_duplicate tensor(-1.0741, dtype=torch.float64) tensor(14.7922, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4964, dtype=torch.float64) delta_t tensor(-1.5203, dtype=torch.float64)
3 gae_duplicate tensor(-1.7618, dtype=torch.float64) tensor(30.6253, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5966, dtype=torch.float64) delta_t tensor(-0.6351, dtype=torch.float64)
2 gae_duplicate tensor(-1.6212, dtype=torch.float64) tensor(16.2644, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:3418.510009765625
value loss:154.34939575195312
entropies:353.84521484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9912214279174805 seconds
19 rew tensor(0.9680, dtype=torch.float64) delta_t tensor(0.7414, dtype=torch.float64)
19 gae_duplicate tensor(0.7200, dtype=torch.float64) tensor(-14.4726, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9840, dtype=torch.float64) delta_t tensor(0.7747, dtype=torch.float64)
18 gae_duplicate tensor(0.8333, dtype=torch.float64) tensor(-16.4824, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(1.0008, dtype=torch.float64) delta_t tensor(0.7625, dtype=torch.float64)
17 gae_duplicate tensor(0.7494, dtype=torch.float64) tensor(-17.2459, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0186, dtype=torch.float64) delta_t tensor(0.7451, dtype=torch.float64)
16 gae_duplicate tensor(0.7753, dtype=torch.float64) tensor(-16.6099, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0373, dtype=torch.float64) delta_t tensor(0.7823, dtype=torch.float64)
15 gae_duplicate tensor(0.7964, dtype=torch.float64) tensor(-17.4428, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0571, dtype=torch.float64) delta_t tensor(0.8168, dtype=torch.float64)
14 gae_duplicate tensor(0.8186, dtype=torch.float64) tensor(-17.7654, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0781, dtype=torch.float64) delta_t tensor(0.8359, dtype=torch.float64)
13 gae_duplicate tensor(0.8397, dtype=torch.float64) tensor(-18.3389, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.1004, dtype=torch.float64) delta_t tensor(0.7936, dtype=torch.float64)
12 gae_duplicate tensor(0.8257, dtype=torch.float64) tensor(-17.0293, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.1241, dtype=torch.float64) delta_t tensor(1.0059, dtype=torch.float64)
11 gae_duplicate tensor(1.0207, dtype=torch.float64) tensor(-21.7339, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.8185, dtype=torch.float64) delta_t tensor(0.8013, dtype=torch.float64)
10 gae_duplicate tensor(0.6731, dtype=torch.float64) tensor(-19.1060, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0769, dtype=torch.float64) delta_t tensor(0.0910, dtype=torch.float64)
9 gae_duplicate tensor(-0.0425, dtype=torch.float64) tensor(-3.4634, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2261, dtype=torch.float64) delta_t tensor(-0.6074, dtype=torch.float64)
8 gae_duplicate tensor(-0.6952, dtype=torch.float64) tensor(11.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6114, dtype=torch.float64) delta_t tensor(-0.8549, dtype=torch.float64)
7 gae_duplicate tensor(-1.1062, dtype=torch.float64) tensor(18.2895, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8189, dtype=torch.float64) delta_t tensor(-0.9428, dtype=torch.float64)
6 gae_duplicate tensor(-1.2800, dtype=torch.float64) tensor(20.8169, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1514, dtype=torch.float64) delta_t tensor(-1.3831, dtype=torch.float64)
5 gae_duplicate tensor(-1.5729, dtype=torch.float64) tensor(28.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8003, dtype=torch.float64) delta_t tensor(-0.8062, dtype=torch.float64)
4 gae_duplicate tensor(-1.2186, dtype=torch.float64) tensor(19.4492, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5431, dtype=torch.float64) delta_t tensor(-1.5602, dtype=torch.float64)
3 gae_duplicate tensor(-1.9946, dtype=torch.float64) tensor(32.6965, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4520, dtype=torch.float64) delta_t tensor(-0.4898, dtype=torch.float64)
2 gae_duplicate tensor(-1.0250, dtype=torch.float64) tensor(12.4909, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:1849.933837890625
value loss:151.22195434570312
entropies:354.93109130859375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.085774898529053 seconds
19 rew tensor(0.9703, dtype=torch.float64) delta_t tensor(0.7353, dtype=torch.float64)
19 gae_duplicate tensor(0.7136, dtype=torch.float64) tensor(-14.4371, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.7596, dtype=torch.float64)
18 gae_duplicate tensor(0.8126, dtype=torch.float64) tensor(-16.4329, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9948, dtype=torch.float64) delta_t tensor(0.7194, dtype=torch.float64)
17 gae_duplicate tensor(0.7064, dtype=torch.float64) tensor(-15.8866, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0077, dtype=torch.float64) delta_t tensor(0.7321, dtype=torch.float64)
16 gae_duplicate tensor(0.7153, dtype=torch.float64) tensor(-16.1665, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0212, dtype=torch.float64) delta_t tensor(0.7507, dtype=torch.float64)
15 gae_duplicate tensor(0.7425, dtype=torch.float64) tensor(-16.1784, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0352, dtype=torch.float64) delta_t tensor(0.7702, dtype=torch.float64)
14 gae_duplicate tensor(0.7714, dtype=torch.float64) tensor(-16.6038, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0498, dtype=torch.float64) delta_t tensor(0.7308, dtype=torch.float64)
13 gae_duplicate tensor(0.7318, dtype=torch.float64) tensor(-15.9985, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0651, dtype=torch.float64) delta_t tensor(0.8017, dtype=torch.float64)
12 gae_duplicate tensor(0.8356, dtype=torch.float64) tensor(-17.4618, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0810, dtype=torch.float64) delta_t tensor(0.8954, dtype=torch.float64)
11 gae_duplicate tensor(0.8789, dtype=torch.float64) tensor(-19.4975, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7691, dtype=torch.float64) delta_t tensor(0.7769, dtype=torch.float64)
10 gae_duplicate tensor(0.7968, dtype=torch.float64) tensor(-17.4578, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0578, dtype=torch.float64) delta_t tensor(-0.0664, dtype=torch.float64)
9 gae_duplicate tensor(-0.0946, dtype=torch.float64) tensor(-0.3936, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3230, dtype=torch.float64) delta_t tensor(-0.7094, dtype=torch.float64)
8 gae_duplicate tensor(-0.8425, dtype=torch.float64) tensor(13.8738, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7300, dtype=torch.float64) delta_t tensor(-0.9595, dtype=torch.float64)
7 gae_duplicate tensor(-1.1306, dtype=torch.float64) tensor(20.4069, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9486, dtype=torch.float64) delta_t tensor(-1.0744, dtype=torch.float64)
6 gae_duplicate tensor(-1.3036, dtype=torch.float64) tensor(23.3359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2142, dtype=torch.float64) delta_t tensor(-1.4190, dtype=torch.float64)
5 gae_duplicate tensor(-1.6865, dtype=torch.float64) tensor(29.8476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7333, dtype=torch.float64) delta_t tensor(-0.7448, dtype=torch.float64)
4 gae_duplicate tensor(-1.1906, dtype=torch.float64) tensor(17.8391, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5463, dtype=torch.float64) delta_t tensor(-1.5586, dtype=torch.float64)
3 gae_duplicate tensor(-1.8262, dtype=torch.float64) tensor(32.8811, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5500, dtype=torch.float64) delta_t tensor(-0.5577, dtype=torch.float64)
2 gae_duplicate tensor(-1.1812, dtype=torch.float64) tensor(14.2021, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:666.934326171875
value loss:150.45164489746094
entropies:355.51947021484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.532308101654053 seconds
19 rew tensor(0.9736, dtype=torch.float64) delta_t tensor(0.7277, dtype=torch.float64)
19 gae_duplicate tensor(0.6901, dtype=torch.float64) tensor(-14.3623, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.7369, dtype=torch.float64)
18 gae_duplicate tensor(0.6611, dtype=torch.float64) tensor(-15.9055, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9931, dtype=torch.float64) delta_t tensor(0.7402, dtype=torch.float64)
17 gae_duplicate tensor(0.6645, dtype=torch.float64) tensor(-16.1837, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0034, dtype=torch.float64) delta_t tensor(0.7271, dtype=torch.float64)
16 gae_duplicate tensor(0.7211, dtype=torch.float64) tensor(-16.0105, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0139, dtype=torch.float64) delta_t tensor(0.7557, dtype=torch.float64)
15 gae_duplicate tensor(0.7285, dtype=torch.float64) tensor(-16.5108, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0248, dtype=torch.float64) delta_t tensor(0.7748, dtype=torch.float64)
14 gae_duplicate tensor(0.7534, dtype=torch.float64) tensor(-16.9582, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0360, dtype=torch.float64) delta_t tensor(0.7330, dtype=torch.float64)
13 gae_duplicate tensor(0.6712, dtype=torch.float64) tensor(-16.2632, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0271, dtype=torch.float64) delta_t tensor(0.7820, dtype=torch.float64)
12 gae_duplicate tensor(0.7832, dtype=torch.float64) tensor(-16.9958, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0181, dtype=torch.float64) delta_t tensor(0.8119, dtype=torch.float64)
11 gae_duplicate tensor(0.7254, dtype=torch.float64) tensor(-17.6689, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7543, dtype=torch.float64) delta_t tensor(0.7643, dtype=torch.float64)
10 gae_duplicate tensor(0.6341, dtype=torch.float64) tensor(-16.9141, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1259, dtype=torch.float64) delta_t tensor(-0.1225, dtype=torch.float64)
9 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(0.7178, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4304, dtype=torch.float64) delta_t tensor(-0.8054, dtype=torch.float64)
8 gae_duplicate tensor(-1.0064, dtype=torch.float64) tensor(16.0808, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7754, dtype=torch.float64) delta_t tensor(-0.9017, dtype=torch.float64)
7 gae_duplicate tensor(-1.1271, dtype=torch.float64) tensor(19.2981, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9637, dtype=torch.float64) delta_t tensor(-1.1262, dtype=torch.float64)
6 gae_duplicate tensor(-1.3083, dtype=torch.float64) tensor(23.9505, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2146, dtype=torch.float64) delta_t tensor(-1.3624, dtype=torch.float64)
5 gae_duplicate tensor(-1.6369, dtype=torch.float64) tensor(28.9152, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8102, dtype=torch.float64) delta_t tensor(-0.8395, dtype=torch.float64)
4 gae_duplicate tensor(-1.4110, dtype=torch.float64) tensor(19.8255, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6130, dtype=torch.float64) delta_t tensor(-1.6190, dtype=torch.float64)
3 gae_duplicate tensor(-2.0476, dtype=torch.float64) tensor(34.0232, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8089, dtype=torch.float64) delta_t tensor(-0.7722, dtype=torch.float64)
2 gae_duplicate tensor(-1.6356, dtype=torch.float64) tensor(18.6515, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:28.71160125732422
value loss:157.27748107910156
entropies:355.732666015625
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3956.6221)
ToM Target loss= tensor(3487.5305)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.245481252670288 seconds
19 rew tensor(0.9753, dtype=torch.float64) delta_t tensor(0.7174, dtype=torch.float64)
19 gae_duplicate tensor(0.6631, dtype=torch.float64) tensor(-14.2927, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(0.7463, dtype=torch.float64)
18 gae_duplicate tensor(0.7698, dtype=torch.float64) tensor(-16.1470, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9915, dtype=torch.float64) delta_t tensor(0.7484, dtype=torch.float64)
17 gae_duplicate tensor(0.7960, dtype=torch.float64) tensor(-16.2781, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(1.0000, dtype=torch.float64) delta_t tensor(0.7395, dtype=torch.float64)
16 gae_duplicate tensor(0.7833, dtype=torch.float64) tensor(-16.1511, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0086, dtype=torch.float64) delta_t tensor(0.7566, dtype=torch.float64)
15 gae_duplicate tensor(0.7926, dtype=torch.float64) tensor(-16.4688, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0175, dtype=torch.float64) delta_t tensor(0.7673, dtype=torch.float64)
14 gae_duplicate tensor(0.8020, dtype=torch.float64) tensor(-16.7057, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0267, dtype=torch.float64) delta_t tensor(0.7659, dtype=torch.float64)
13 gae_duplicate tensor(0.7569, dtype=torch.float64) tensor(-16.8513, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.6213, dtype=torch.float64) delta_t tensor(0.3731, dtype=torch.float64)
12 gae_duplicate tensor(-1.4503, dtype=torch.float64) tensor(-8.9469, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0031, dtype=torch.float64) delta_t tensor(0.8362, dtype=torch.float64)
11 gae_duplicate tensor(0.5820, dtype=torch.float64) tensor(-17.4602, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6948, dtype=torch.float64) delta_t tensor(0.7599, dtype=torch.float64)
10 gae_duplicate tensor(0.8092, dtype=torch.float64) tensor(-16.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0463, dtype=torch.float64) delta_t tensor(-0.0416, dtype=torch.float64)
9 gae_duplicate tensor(-0.1756, dtype=torch.float64) tensor(-0.8380, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.2695, dtype=torch.float64) delta_t tensor(-0.6062, dtype=torch.float64)
8 gae_duplicate tensor(-0.7858, dtype=torch.float64) tensor(11.8296, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.6031, dtype=torch.float64) delta_t tensor(-0.8136, dtype=torch.float64)
7 gae_duplicate tensor(-1.1087, dtype=torch.float64) tensor(17.2309, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8970, dtype=torch.float64) delta_t tensor(-0.9992, dtype=torch.float64)
6 gae_duplicate tensor(-1.4379, dtype=torch.float64) tensor(21.5129, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1300, dtype=torch.float64) delta_t tensor(-1.2370, dtype=torch.float64)
5 gae_duplicate tensor(-1.6794, dtype=torch.float64) tensor(26.5631, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8776, dtype=torch.float64) delta_t tensor(-0.8813, dtype=torch.float64)
4 gae_duplicate tensor(-1.3000, dtype=torch.float64) tensor(19.9901, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5554, dtype=torch.float64) delta_t tensor(-1.5569, dtype=torch.float64)
3 gae_duplicate tensor(-2.0596, dtype=torch.float64) tensor(32.7760, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7534, dtype=torch.float64) delta_t tensor(-0.7825, dtype=torch.float64)
2 gae_duplicate tensor(-1.6923, dtype=torch.float64) tensor(18.9008, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:351.3493957519531
value loss:149.72708129882812
entropies:355.861328125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.268779039382935 seconds
19 rew tensor(0.9762, dtype=torch.float64) delta_t tensor(0.6978, dtype=torch.float64)
19 gae_duplicate tensor(0.6753, dtype=torch.float64) tensor(-13.7653, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(0.7147, dtype=torch.float64)
18 gae_duplicate tensor(0.7508, dtype=torch.float64) tensor(-15.7156, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9901, dtype=torch.float64) delta_t tensor(0.6938, dtype=torch.float64)
17 gae_duplicate tensor(0.6875, dtype=torch.float64) tensor(-15.3152, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9973, dtype=torch.float64) delta_t tensor(0.6740, dtype=torch.float64)
16 gae_duplicate tensor(0.6465, dtype=torch.float64) tensor(-14.7869, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(1.0047, dtype=torch.float64) delta_t tensor(0.6926, dtype=torch.float64)
15 gae_duplicate tensor(0.6686, dtype=torch.float64) tensor(-15.2905, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0122, dtype=torch.float64) delta_t tensor(0.6957, dtype=torch.float64)
14 gae_duplicate tensor(0.7015, dtype=torch.float64) tensor(-15.2679, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0198, dtype=torch.float64) delta_t tensor(0.6793, dtype=torch.float64)
13 gae_duplicate tensor(0.6481, dtype=torch.float64) tensor(-14.9031, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0277, dtype=torch.float64) delta_t tensor(0.7132, dtype=torch.float64)
12 gae_duplicate tensor(0.6705, dtype=torch.float64) tensor(-15.5581, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0357, dtype=torch.float64) delta_t tensor(0.8110, dtype=torch.float64)
11 gae_duplicate tensor(0.8489, dtype=torch.float64) tensor(-17.5987, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7374, dtype=torch.float64) delta_t tensor(0.7329, dtype=torch.float64)
10 gae_duplicate tensor(0.7354, dtype=torch.float64) tensor(-16.2631, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1959, dtype=torch.float64) delta_t tensor(-0.1877, dtype=torch.float64)
9 gae_duplicate tensor(-0.1956, dtype=torch.float64) tensor(2.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4174, dtype=torch.float64) delta_t tensor(-0.8064, dtype=torch.float64)
8 gae_duplicate tensor(-1.1376, dtype=torch.float64) tensor(16.1838, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7777, dtype=torch.float64) delta_t tensor(-0.9327, dtype=torch.float64)
7 gae_duplicate tensor(-1.1898, dtype=torch.float64) tensor(20.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9752, dtype=torch.float64) delta_t tensor(-1.1020, dtype=torch.float64)
6 gae_duplicate tensor(-1.3385, dtype=torch.float64) tensor(23.7721, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3058, dtype=torch.float64) delta_t tensor(-1.4541, dtype=torch.float64)
5 gae_duplicate tensor(-1.6853, dtype=torch.float64) tensor(31.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7704, dtype=torch.float64) delta_t tensor(-0.7701, dtype=torch.float64)
4 gae_duplicate tensor(-1.1832, dtype=torch.float64) tensor(18.3027, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5633, dtype=torch.float64) delta_t tensor(-1.5574, dtype=torch.float64)
3 gae_duplicate tensor(-1.8744, dtype=torch.float64) tensor(32.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6542, dtype=torch.float64) delta_t tensor(-0.6411, dtype=torch.float64)
2 gae_duplicate tensor(-1.4916, dtype=torch.float64) tensor(15.9391, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-408.17230224609375
value loss:146.10755920410156
entropies:355.8643493652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.958553075790405 seconds
19 rew tensor(0.9753, dtype=torch.float64) delta_t tensor(0.6686, dtype=torch.float64)
19 gae_duplicate tensor(0.6285, dtype=torch.float64) tensor(-13.1208, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(0.7102, dtype=torch.float64)
18 gae_duplicate tensor(0.7657, dtype=torch.float64) tensor(-15.4538, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9874, dtype=torch.float64) delta_t tensor(0.6839, dtype=torch.float64)
17 gae_duplicate tensor(0.6219, dtype=torch.float64) tensor(-15.1948, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(0.6920, dtype=torch.float64)
16 gae_duplicate tensor(0.6957, dtype=torch.float64) tensor(-15.0956, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9999, dtype=torch.float64) delta_t tensor(0.6865, dtype=torch.float64)
15 gae_duplicate tensor(0.6354, dtype=torch.float64) tensor(-15.1601, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0064, dtype=torch.float64) delta_t tensor(0.6973, dtype=torch.float64)
14 gae_duplicate tensor(0.6569, dtype=torch.float64) tensor(-15.3144, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0130, dtype=torch.float64) delta_t tensor(0.6485, dtype=torch.float64)
13 gae_duplicate tensor(0.6475, dtype=torch.float64) tensor(-14.3368, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0197, dtype=torch.float64) delta_t tensor(0.6989, dtype=torch.float64)
12 gae_duplicate tensor(0.7094, dtype=torch.float64) tensor(-15.2885, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0266, dtype=torch.float64) delta_t tensor(0.8743, dtype=torch.float64)
11 gae_duplicate tensor(0.8233, dtype=torch.float64) tensor(-18.9547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6962, dtype=torch.float64) delta_t tensor(0.7214, dtype=torch.float64)
10 gae_duplicate tensor(0.7036, dtype=torch.float64) tensor(-16.1896, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(0.0002, dtype=torch.float64) delta_t tensor(0.0139, dtype=torch.float64)
9 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(-1.8956, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4074, dtype=torch.float64) delta_t tensor(-0.7523, dtype=torch.float64)
8 gae_duplicate tensor(-1.2085, dtype=torch.float64) tensor(14.7929, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7520, dtype=torch.float64) delta_t tensor(-0.9234, dtype=torch.float64)
7 gae_duplicate tensor(-1.2115, dtype=torch.float64) tensor(19.6947, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9758, dtype=torch.float64) delta_t tensor(-1.0104, dtype=torch.float64)
6 gae_duplicate tensor(-1.3655, dtype=torch.float64) tensor(21.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2487, dtype=torch.float64) delta_t tensor(-1.4119, dtype=torch.float64)
5 gae_duplicate tensor(-1.6045, dtype=torch.float64) tensor(30.1666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8764, dtype=torch.float64) delta_t tensor(-0.8373, dtype=torch.float64)
4 gae_duplicate tensor(-1.2513, dtype=torch.float64) tensor(19.5911, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7485, dtype=torch.float64) delta_t tensor(-1.7246, dtype=torch.float64)
3 gae_duplicate tensor(-1.9551, dtype=torch.float64) tensor(36.2400, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6397, dtype=torch.float64) delta_t tensor(-0.6156, dtype=torch.float64)
2 gae_duplicate tensor(-1.2066, dtype=torch.float64) tensor(15.7331, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-210.41220092773438
value loss:147.7337646484375
entropies:355.8352355957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.457070827484131 seconds
19 rew tensor(0.9770, dtype=torch.float64) delta_t tensor(0.6582, dtype=torch.float64)
19 gae_duplicate tensor(0.6149, dtype=torch.float64) tensor(-13.0032, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9824, dtype=torch.float64) delta_t tensor(0.6845, dtype=torch.float64)
18 gae_duplicate tensor(0.7162, dtype=torch.float64) tensor(-14.9418, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9878, dtype=torch.float64) delta_t tensor(0.6878, dtype=torch.float64)
17 gae_duplicate tensor(0.7319, dtype=torch.float64) tensor(-15.1201, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9933, dtype=torch.float64) delta_t tensor(0.6714, dtype=torch.float64)
16 gae_duplicate tensor(0.6074, dtype=torch.float64) tensor(-14.9011, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9990, dtype=torch.float64) delta_t tensor(0.6787, dtype=torch.float64)
15 gae_duplicate tensor(0.6237, dtype=torch.float64) tensor(-14.9556, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0047, dtype=torch.float64) delta_t tensor(0.7206, dtype=torch.float64)
14 gae_duplicate tensor(0.6453, dtype=torch.float64) tensor(-15.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0105, dtype=torch.float64) delta_t tensor(0.7149, dtype=torch.float64)
13 gae_duplicate tensor(0.6093, dtype=torch.float64) tensor(-15.7363, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9747, dtype=torch.float64) delta_t tensor(0.6398, dtype=torch.float64)
12 gae_duplicate tensor(0.6720, dtype=torch.float64) tensor(-14.2294, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9175, dtype=torch.float64) delta_t tensor(0.7603, dtype=torch.float64)
11 gae_duplicate tensor(0.5511, dtype=torch.float64) tensor(-16.4850, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6266, dtype=torch.float64) delta_t tensor(0.6576, dtype=torch.float64)
10 gae_duplicate tensor(0.4654, dtype=torch.float64) tensor(-14.5632, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0733, dtype=torch.float64) delta_t tensor(-0.0589, dtype=torch.float64)
9 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(-0.2905, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3999, dtype=torch.float64) delta_t tensor(-0.7564, dtype=torch.float64)
8 gae_duplicate tensor(-0.9300, dtype=torch.float64) tensor(15.0121, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7954, dtype=torch.float64) delta_t tensor(-0.9400, dtype=torch.float64)
7 gae_duplicate tensor(-1.1197, dtype=torch.float64) tensor(20.0590, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9513, dtype=torch.float64) delta_t tensor(-0.9835, dtype=torch.float64)
6 gae_duplicate tensor(-1.3182, dtype=torch.float64) tensor(21.4541, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1974, dtype=torch.float64) delta_t tensor(-1.3509, dtype=torch.float64)
5 gae_duplicate tensor(-1.6060, dtype=torch.float64) tensor(28.7962, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8053, dtype=torch.float64) delta_t tensor(-0.7731, dtype=torch.float64)
4 gae_duplicate tensor(-1.2901, dtype=torch.float64) tensor(18.2378, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6016, dtype=torch.float64) delta_t tensor(-1.5743, dtype=torch.float64)
3 gae_duplicate tensor(-1.9560, dtype=torch.float64) tensor(32.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7188, dtype=torch.float64) delta_t tensor(-0.6859, dtype=torch.float64)
2 gae_duplicate tensor(-1.5380, dtype=torch.float64) tensor(16.7454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-272.61224365234375
value loss:140.2451629638672
entropies:355.84149169921875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.276149034500122 seconds
19 rew tensor(0.9759, dtype=torch.float64) delta_t tensor(0.6517, dtype=torch.float64)
19 gae_duplicate tensor(0.6355, dtype=torch.float64) tensor(-12.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9807, dtype=torch.float64) delta_t tensor(0.6852, dtype=torch.float64)
18 gae_duplicate tensor(0.7366, dtype=torch.float64) tensor(-14.8405, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9856, dtype=torch.float64) delta_t tensor(0.6792, dtype=torch.float64)
17 gae_duplicate tensor(0.7435, dtype=torch.float64) tensor(-14.8407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9905, dtype=torch.float64) delta_t tensor(0.6695, dtype=torch.float64)
16 gae_duplicate tensor(0.7301, dtype=torch.float64) tensor(-14.7941, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9955, dtype=torch.float64) delta_t tensor(0.6573, dtype=torch.float64)
15 gae_duplicate tensor(0.6589, dtype=torch.float64) tensor(-14.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(1.0006, dtype=torch.float64) delta_t tensor(0.6558, dtype=torch.float64)
14 gae_duplicate tensor(0.6302, dtype=torch.float64) tensor(-14.3870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0058, dtype=torch.float64) delta_t tensor(0.5998, dtype=torch.float64)
13 gae_duplicate tensor(0.5967, dtype=torch.float64) tensor(-13.2262, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0110, dtype=torch.float64) delta_t tensor(0.6758, dtype=torch.float64)
12 gae_duplicate tensor(0.7017, dtype=torch.float64) tensor(-14.8314, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0164, dtype=torch.float64) delta_t tensor(0.8326, dtype=torch.float64)
11 gae_duplicate tensor(0.7780, dtype=torch.float64) tensor(-17.9100, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6827, dtype=torch.float64) delta_t tensor(0.7121, dtype=torch.float64)
10 gae_duplicate tensor(0.7122, dtype=torch.float64) tensor(-15.8667, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0200, dtype=torch.float64) delta_t tensor(0.0192, dtype=torch.float64)
9 gae_duplicate tensor(-0.1192, dtype=torch.float64) tensor(-1.9720, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3862, dtype=torch.float64) delta_t tensor(-0.7414, dtype=torch.float64)
8 gae_duplicate tensor(-1.0853, dtype=torch.float64) tensor(14.3963, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7354, dtype=torch.float64) delta_t tensor(-0.9196, dtype=torch.float64)
7 gae_duplicate tensor(-1.2030, dtype=torch.float64) tensor(19.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9705, dtype=torch.float64) delta_t tensor(-1.0179, dtype=torch.float64)
6 gae_duplicate tensor(-1.2560, dtype=torch.float64) tensor(22.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2709, dtype=torch.float64) delta_t tensor(-1.3273, dtype=torch.float64)
5 gae_duplicate tensor(-1.5779, dtype=torch.float64) tensor(28.4343, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8290, dtype=torch.float64) delta_t tensor(-0.7911, dtype=torch.float64)
4 gae_duplicate tensor(-1.2529, dtype=torch.float64) tensor(18.4710, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6380, dtype=torch.float64) delta_t tensor(-1.6378, dtype=torch.float64)
3 gae_duplicate tensor(-1.9983, dtype=torch.float64) tensor(34.1908, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5510, dtype=torch.float64) delta_t tensor(-0.5363, dtype=torch.float64)
2 gae_duplicate tensor(-1.4764, dtype=torch.float64) tensor(14.0085, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-158.56761169433594
value loss:137.03228759765625
entropies:355.8835144042969
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3960.4241)
ToM Target loss= tensor(3489.8875)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.156227111816406 seconds
19 rew tensor(0.9759, dtype=torch.float64) delta_t tensor(0.6057, dtype=torch.float64)
19 gae_duplicate tensor(0.5674, dtype=torch.float64) tensor(-11.9338, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.6385, dtype=torch.float64)
18 gae_duplicate tensor(0.6674, dtype=torch.float64) tensor(-13.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.6156, dtype=torch.float64)
17 gae_duplicate tensor(0.5873, dtype=torch.float64) tensor(-13.4938, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9891, dtype=torch.float64) delta_t tensor(0.5993, dtype=torch.float64)
16 gae_duplicate tensor(0.5777, dtype=torch.float64) tensor(-13.1358, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9936, dtype=torch.float64) delta_t tensor(0.6083, dtype=torch.float64)
15 gae_duplicate tensor(0.5671, dtype=torch.float64) tensor(-13.3694, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9983, dtype=torch.float64) delta_t tensor(0.6211, dtype=torch.float64)
14 gae_duplicate tensor(0.6009, dtype=torch.float64) tensor(-13.5710, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(1.0029, dtype=torch.float64) delta_t tensor(0.5939, dtype=torch.float64)
13 gae_duplicate tensor(0.5702, dtype=torch.float64) tensor(-13.0557, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0077, dtype=torch.float64) delta_t tensor(0.6094, dtype=torch.float64)
12 gae_duplicate tensor(0.5967, dtype=torch.float64) tensor(-13.3659, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0125, dtype=torch.float64) delta_t tensor(0.8406, dtype=torch.float64)
11 gae_duplicate tensor(0.7962, dtype=torch.float64) tensor(-17.9379, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6885, dtype=torch.float64) delta_t tensor(0.6144, dtype=torch.float64)
10 gae_duplicate tensor(0.4615, dtype=torch.float64) tensor(-13.9475, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1526, dtype=torch.float64) delta_t tensor(-0.1386, dtype=torch.float64)
9 gae_duplicate tensor(-0.2156, dtype=torch.float64) tensor(1.3430, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3581, dtype=torch.float64) delta_t tensor(-0.7306, dtype=torch.float64)
8 gae_duplicate tensor(-0.8279, dtype=torch.float64) tensor(14.5995, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7874, dtype=torch.float64) delta_t tensor(-1.0006, dtype=torch.float64)
7 gae_duplicate tensor(-1.1454, dtype=torch.float64) tensor(21.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0054, dtype=torch.float64) delta_t tensor(-1.0746, dtype=torch.float64)
6 gae_duplicate tensor(-1.4543, dtype=torch.float64) tensor(23.3896, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2036, dtype=torch.float64) delta_t tensor(-1.2863, dtype=torch.float64)
5 gae_duplicate tensor(-1.6368, dtype=torch.float64) tensor(27.7666, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.6801, dtype=torch.float64) delta_t tensor(-0.5930, dtype=torch.float64)
4 gae_duplicate tensor(-0.9418, dtype=torch.float64) tensor(14.5047, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4387, dtype=torch.float64) delta_t tensor(-1.3916, dtype=torch.float64)
3 gae_duplicate tensor(-1.7909, dtype=torch.float64) tensor(29.0306, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5203, dtype=torch.float64) delta_t tensor(-0.5259, dtype=torch.float64)
2 gae_duplicate tensor(-1.0051, dtype=torch.float64) tensor(13.2772, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-501.6080627441406
value loss:120.90568542480469
entropies:355.92608642578125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.363545179367065 seconds
19 rew tensor(0.9747, dtype=torch.float64) delta_t tensor(0.6101, dtype=torch.float64)
19 gae_duplicate tensor(0.5874, dtype=torch.float64) tensor(-12.0357, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9787, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
18 gae_duplicate tensor(0.6500, dtype=torch.float64) tensor(-13.6810, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(0.5778, dtype=torch.float64)
17 gae_duplicate tensor(0.5242, dtype=torch.float64) tensor(-12.7982, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9868, dtype=torch.float64) delta_t tensor(0.6044, dtype=torch.float64)
16 gae_duplicate tensor(0.5363, dtype=torch.float64) tensor(-13.2213, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.6067, dtype=torch.float64)
15 gae_duplicate tensor(0.5410, dtype=torch.float64) tensor(-13.2904, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9952, dtype=torch.float64) delta_t tensor(0.5933, dtype=torch.float64)
14 gae_duplicate tensor(0.5535, dtype=torch.float64) tensor(-13.0543, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9994, dtype=torch.float64) delta_t tensor(0.5572, dtype=torch.float64)
13 gae_duplicate tensor(0.5244, dtype=torch.float64) tensor(-12.3057, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0037, dtype=torch.float64) delta_t tensor(0.6479, dtype=torch.float64)
12 gae_duplicate tensor(0.6079, dtype=torch.float64) tensor(-14.0094, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0080, dtype=torch.float64) delta_t tensor(0.8542, dtype=torch.float64)
11 gae_duplicate tensor(0.7857, dtype=torch.float64) tensor(-18.2918, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6841, dtype=torch.float64) delta_t tensor(0.7140, dtype=torch.float64)
10 gae_duplicate tensor(0.7283, dtype=torch.float64) tensor(-15.9984, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0313, dtype=torch.float64) delta_t tensor(0.0147, dtype=torch.float64)
9 gae_duplicate tensor(-0.1339, dtype=torch.float64) tensor(-1.8853, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5025, dtype=torch.float64) delta_t tensor(-0.8481, dtype=torch.float64)
8 gae_duplicate tensor(-1.2491, dtype=torch.float64) tensor(16.6367, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7694, dtype=torch.float64) delta_t tensor(-0.8521, dtype=torch.float64)
7 gae_duplicate tensor(-1.1775, dtype=torch.float64) tensor(18.4907, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9042, dtype=torch.float64) delta_t tensor(-0.9268, dtype=torch.float64)
6 gae_duplicate tensor(-1.2319, dtype=torch.float64) tensor(20.3367, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3473, dtype=torch.float64) delta_t tensor(-1.4466, dtype=torch.float64)
5 gae_duplicate tensor(-1.6707, dtype=torch.float64) tensor(30.7257, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9059, dtype=torch.float64) delta_t tensor(-0.8729, dtype=torch.float64)
4 gae_duplicate tensor(-1.2621, dtype=torch.float64) tensor(20.3428, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7991, dtype=torch.float64) delta_t tensor(-1.7362, dtype=torch.float64)
3 gae_duplicate tensor(-2.0320, dtype=torch.float64) tensor(36.4440, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7394, dtype=torch.float64) delta_t tensor(-0.6580, dtype=torch.float64)
2 gae_duplicate tensor(-1.6178, dtype=torch.float64) tensor(16.6818, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1126.796875
value loss:141.7073211669922
entropies:355.9188232421875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.516188859939575 seconds
19 rew tensor(0.9757, dtype=torch.float64) delta_t tensor(0.5613, dtype=torch.float64)
19 gae_duplicate tensor(0.4275, dtype=torch.float64) tensor(-11.1699, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9793, dtype=torch.float64) delta_t tensor(0.5936, dtype=torch.float64)
18 gae_duplicate tensor(0.5286, dtype=torch.float64) tensor(-12.8115, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(0.5585, dtype=torch.float64)
17 gae_duplicate tensor(0.5028, dtype=torch.float64) tensor(-12.3250, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9868, dtype=torch.float64) delta_t tensor(0.5651, dtype=torch.float64)
16 gae_duplicate tensor(0.5171, dtype=torch.float64) tensor(-12.3935, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9906, dtype=torch.float64) delta_t tensor(0.5781, dtype=torch.float64)
15 gae_duplicate tensor(0.5214, dtype=torch.float64) tensor(-12.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9945, dtype=torch.float64) delta_t tensor(0.5801, dtype=torch.float64)
14 gae_duplicate tensor(0.5234, dtype=torch.float64) tensor(-12.7913, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9984, dtype=torch.float64) delta_t tensor(0.5441, dtype=torch.float64)
13 gae_duplicate tensor(0.5024, dtype=torch.float64) tensor(-12.0557, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0023, dtype=torch.float64) delta_t tensor(0.6315, dtype=torch.float64)
12 gae_duplicate tensor(0.5278, dtype=torch.float64) tensor(-13.8076, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9861, dtype=torch.float64) delta_t tensor(0.7007, dtype=torch.float64)
11 gae_duplicate tensor(0.7094, dtype=torch.float64) tensor(-15.2654, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6611, dtype=torch.float64) delta_t tensor(0.6722, dtype=torch.float64)
10 gae_duplicate tensor(0.5737, dtype=torch.float64) tensor(-14.8805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2376, dtype=torch.float64) delta_t tensor(-0.1957, dtype=torch.float64)
9 gae_duplicate tensor(-0.1976, dtype=torch.float64) tensor(2.3932, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5024, dtype=torch.float64) delta_t tensor(-0.8251, dtype=torch.float64)
8 gae_duplicate tensor(-1.1846, dtype=torch.float64) tensor(16.5934, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8428, dtype=torch.float64) delta_t tensor(-0.9174, dtype=torch.float64)
7 gae_duplicate tensor(-1.1563, dtype=torch.float64) tensor(19.8778, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0297, dtype=torch.float64) delta_t tensor(-1.0558, dtype=torch.float64)
6 gae_duplicate tensor(-1.3402, dtype=torch.float64) tensor(22.8596, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2897, dtype=torch.float64) delta_t tensor(-1.3352, dtype=torch.float64)
5 gae_duplicate tensor(-1.5873, dtype=torch.float64) tensor(29.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8239, dtype=torch.float64) delta_t tensor(-0.7505, dtype=torch.float64)
4 gae_duplicate tensor(-1.1776, dtype=torch.float64) tensor(17.5229, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6432, dtype=torch.float64) delta_t tensor(-1.5645, dtype=torch.float64)
3 gae_duplicate tensor(-1.9354, dtype=torch.float64) tensor(32.5988, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7811, dtype=torch.float64) delta_t tensor(-0.6975, dtype=torch.float64)
2 gae_duplicate tensor(-1.5282, dtype=torch.float64) tensor(17.0745, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1589.43115234375
value loss:127.565185546875
entropies:355.87005615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.7352659702301025 seconds
19 rew tensor(0.9756, dtype=torch.float64) delta_t tensor(0.5732, dtype=torch.float64)
19 gae_duplicate tensor(0.5469, dtype=torch.float64) tensor(-11.3701, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(0.5543, dtype=torch.float64)
18 gae_duplicate tensor(0.4723, dtype=torch.float64) tensor(-12.1993, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.5118, dtype=torch.float64)
17 gae_duplicate tensor(0.4859, dtype=torch.float64) tensor(-11.2333, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(0.5576, dtype=torch.float64)
16 gae_duplicate tensor(0.4908, dtype=torch.float64) tensor(-12.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9895, dtype=torch.float64) delta_t tensor(0.5565, dtype=torch.float64)
15 gae_duplicate tensor(0.4936, dtype=torch.float64) tensor(-12.1978, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9931, dtype=torch.float64) delta_t tensor(0.5633, dtype=torch.float64)
14 gae_duplicate tensor(0.5164, dtype=torch.float64) tensor(-12.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9967, dtype=torch.float64) delta_t tensor(0.4849, dtype=torch.float64)
13 gae_duplicate tensor(0.4751, dtype=torch.float64) tensor(-10.8005, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(1.0003, dtype=torch.float64) delta_t tensor(0.5579, dtype=torch.float64)
12 gae_duplicate tensor(0.5028, dtype=torch.float64) tensor(-12.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0040, dtype=torch.float64) delta_t tensor(0.7461, dtype=torch.float64)
11 gae_duplicate tensor(0.6530, dtype=torch.float64) tensor(-15.9295, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6802, dtype=torch.float64) delta_t tensor(0.6819, dtype=torch.float64)
10 gae_duplicate tensor(0.6676, dtype=torch.float64) tensor(-14.9929, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1539, dtype=torch.float64) delta_t tensor(-0.1120, dtype=torch.float64)
9 gae_duplicate tensor(-0.1866, dtype=torch.float64) tensor(0.7038, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5006, dtype=torch.float64) delta_t tensor(-0.7747, dtype=torch.float64)
8 gae_duplicate tensor(-1.0664, dtype=torch.float64) tensor(15.3101, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8697, dtype=torch.float64) delta_t tensor(-0.9973, dtype=torch.float64)
7 gae_duplicate tensor(-1.1245, dtype=torch.float64) tensor(21.2087, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0768, dtype=torch.float64) delta_t tensor(-1.0657, dtype=torch.float64)
6 gae_duplicate tensor(-1.4038, dtype=torch.float64) tensor(23.0975, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2653, dtype=torch.float64) delta_t tensor(-1.2872, dtype=torch.float64)
5 gae_duplicate tensor(-1.4999, dtype=torch.float64) tensor(27.6361, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9230, dtype=torch.float64) delta_t tensor(-0.8905, dtype=torch.float64)
4 gae_duplicate tensor(-1.3661, dtype=torch.float64) tensor(20.2999, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7835, dtype=torch.float64) delta_t tensor(-1.6814, dtype=torch.float64)
3 gae_duplicate tensor(-2.0525, dtype=torch.float64) tensor(35.0063, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8421, dtype=torch.float64) delta_t tensor(-0.7327, dtype=torch.float64)
2 gae_duplicate tensor(-1.6207, dtype=torch.float64) tensor(18.1046, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2035.8797607421875
value loss:132.02020263671875
entropies:355.7588806152344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.052390098571777 seconds
19 rew tensor(0.9766, dtype=torch.float64) delta_t tensor(0.5434, dtype=torch.float64)
19 gae_duplicate tensor(0.5031, dtype=torch.float64) tensor(-10.6827, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9798, dtype=torch.float64) delta_t tensor(0.5621, dtype=torch.float64)
18 gae_duplicate tensor(0.4486, dtype=torch.float64) tensor(-12.2839, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9830, dtype=torch.float64) delta_t tensor(0.5639, dtype=torch.float64)
17 gae_duplicate tensor(0.4618, dtype=torch.float64) tensor(-12.3585, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.5627, dtype=torch.float64)
16 gae_duplicate tensor(0.4528, dtype=torch.float64) tensor(-12.3840, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9896, dtype=torch.float64) delta_t tensor(0.5683, dtype=torch.float64)
15 gae_duplicate tensor(0.4677, dtype=torch.float64) tensor(-12.6096, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9929, dtype=torch.float64) delta_t tensor(0.5763, dtype=torch.float64)
14 gae_duplicate tensor(0.4964, dtype=torch.float64) tensor(-12.8212, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9963, dtype=torch.float64) delta_t tensor(0.5377, dtype=torch.float64)
13 gae_duplicate tensor(0.5192, dtype=torch.float64) tensor(-11.9034, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9997, dtype=torch.float64) delta_t tensor(0.5949, dtype=torch.float64)
12 gae_duplicate tensor(0.6028, dtype=torch.float64) tensor(-13.0567, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9824, dtype=torch.float64) delta_t tensor(0.7465, dtype=torch.float64)
11 gae_duplicate tensor(0.6633, dtype=torch.float64) tensor(-16.1340, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5549, dtype=torch.float64) delta_t tensor(0.6152, dtype=torch.float64)
10 gae_duplicate tensor(0.5414, dtype=torch.float64) tensor(-13.5963, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1591, dtype=torch.float64) delta_t tensor(-0.1095, dtype=torch.float64)
9 gae_duplicate tensor(-0.1724, dtype=torch.float64) tensor(0.7524, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4672, dtype=torch.float64) delta_t tensor(-0.7740, dtype=torch.float64)
8 gae_duplicate tensor(-1.0777, dtype=torch.float64) tensor(15.4787, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8231, dtype=torch.float64) delta_t tensor(-0.8821, dtype=torch.float64)
7 gae_duplicate tensor(-1.0850, dtype=torch.float64) tensor(18.9615, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9982, dtype=torch.float64) delta_t tensor(-0.9609, dtype=torch.float64)
6 gae_duplicate tensor(-1.1891, dtype=torch.float64) tensor(21.0804, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2046, dtype=torch.float64) delta_t tensor(-1.2039, dtype=torch.float64)
5 gae_duplicate tensor(-1.3783, dtype=torch.float64) tensor(26.1027, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7839, dtype=torch.float64) delta_t tensor(-0.6547, dtype=torch.float64)
4 gae_duplicate tensor(-0.9947, dtype=torch.float64) tensor(15.6614, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6326, dtype=torch.float64) delta_t tensor(-1.5335, dtype=torch.float64)
3 gae_duplicate tensor(-1.8334, dtype=torch.float64) tensor(31.8506, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6751, dtype=torch.float64) delta_t tensor(-0.5487, dtype=torch.float64)
2 gae_duplicate tensor(-1.4019, dtype=torch.float64) tensor(14.0454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-965.5685424804688
value loss:113.82421112060547
entropies:355.6473083496094
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3954.7476)
ToM Target loss= tensor(3485.7068)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.272401809692383 seconds
19 rew tensor(0.9764, dtype=torch.float64) delta_t tensor(0.5177, dtype=torch.float64)
19 gae_duplicate tensor(0.5040, dtype=torch.float64) tensor(-10.3308, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(0.5539, dtype=torch.float64)
18 gae_duplicate tensor(0.5923, dtype=torch.float64) tensor(-12.0463, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.4683, dtype=torch.float64)
17 gae_duplicate tensor(0.4418, dtype=torch.float64) tensor(-10.3744, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.4907, dtype=torch.float64)
16 gae_duplicate tensor(0.4393, dtype=torch.float64) tensor(-10.8226, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9886, dtype=torch.float64) delta_t tensor(0.5080, dtype=torch.float64)
15 gae_duplicate tensor(0.4592, dtype=torch.float64) tensor(-10.9660, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9917, dtype=torch.float64) delta_t tensor(0.5205, dtype=torch.float64)
14 gae_duplicate tensor(0.4637, dtype=torch.float64) tensor(-11.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9948, dtype=torch.float64) delta_t tensor(0.4954, dtype=torch.float64)
13 gae_duplicate tensor(0.4277, dtype=torch.float64) tensor(-11.0277, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9980, dtype=torch.float64) delta_t tensor(0.5150, dtype=torch.float64)
12 gae_duplicate tensor(0.4508, dtype=torch.float64) tensor(-11.1680, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(1.0012, dtype=torch.float64) delta_t tensor(0.7434, dtype=torch.float64)
11 gae_duplicate tensor(0.6522, dtype=torch.float64) tensor(-15.7202, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6966, dtype=torch.float64) delta_t tensor(0.7198, dtype=torch.float64)
10 gae_duplicate tensor(0.7513, dtype=torch.float64) tensor(-16.0903, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1425, dtype=torch.float64) delta_t tensor(-0.0921, dtype=torch.float64)
9 gae_duplicate tensor(-0.1882, dtype=torch.float64) tensor(0.1646, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4081, dtype=torch.float64) delta_t tensor(-0.6695, dtype=torch.float64)
8 gae_duplicate tensor(-0.8530, dtype=torch.float64) tensor(13.0815, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8374, dtype=torch.float64) delta_t tensor(-0.9883, dtype=torch.float64)
7 gae_duplicate tensor(-1.1365, dtype=torch.float64) tensor(20.9409, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0132, dtype=torch.float64) delta_t tensor(-1.0018, dtype=torch.float64)
6 gae_duplicate tensor(-1.3352, dtype=torch.float64) tensor(21.4040, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2699, dtype=torch.float64) delta_t tensor(-1.2200, dtype=torch.float64)
5 gae_duplicate tensor(-1.4807, dtype=torch.float64) tensor(26.1496, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8059, dtype=torch.float64) delta_t tensor(-0.6823, dtype=torch.float64)
4 gae_duplicate tensor(-1.1351, dtype=torch.float64) tensor(16.2012, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5834, dtype=torch.float64) delta_t tensor(-1.4614, dtype=torch.float64)
3 gae_duplicate tensor(-1.8112, dtype=torch.float64) tensor(29.9207, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5721, dtype=torch.float64) delta_t tensor(-0.4155, dtype=torch.float64)
2 gae_duplicate tensor(-1.0048, dtype=torch.float64) tensor(11.4252, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1134.9498291015625
value loss:108.4897232055664
entropies:355.5546569824219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.026734113693237 seconds
19 rew tensor(0.9762, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
19 gae_duplicate tensor(0.4934, dtype=torch.float64) tensor(-10.2163, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(0.5473, dtype=torch.float64)
18 gae_duplicate tensor(0.5738, dtype=torch.float64) tensor(-12.0675, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.4636, dtype=torch.float64)
17 gae_duplicate tensor(0.4237, dtype=torch.float64) tensor(-10.2135, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.4759, dtype=torch.float64)
16 gae_duplicate tensor(0.4130, dtype=torch.float64) tensor(-10.4759, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9876, dtype=torch.float64) delta_t tensor(0.4861, dtype=torch.float64)
15 gae_duplicate tensor(0.4145, dtype=torch.float64) tensor(-10.8993, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9906, dtype=torch.float64) delta_t tensor(0.4888, dtype=torch.float64)
14 gae_duplicate tensor(0.4119, dtype=torch.float64) tensor(-10.5277, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9935, dtype=torch.float64) delta_t tensor(0.4169, dtype=torch.float64)
13 gae_duplicate tensor(0.4058, dtype=torch.float64) tensor(-9.2793, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9965, dtype=torch.float64) delta_t tensor(0.5499, dtype=torch.float64)
12 gae_duplicate tensor(0.4257, dtype=torch.float64) tensor(-11.8328, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9995, dtype=torch.float64) delta_t tensor(0.6800, dtype=torch.float64)
11 gae_duplicate tensor(0.5830, dtype=torch.float64) tensor(-14.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6846, dtype=torch.float64) delta_t tensor(0.7439, dtype=torch.float64)
10 gae_duplicate tensor(0.7122, dtype=torch.float64) tensor(-16.0987, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1427, dtype=torch.float64) delta_t tensor(-0.0584, dtype=torch.float64)
9 gae_duplicate tensor(-0.1798, dtype=torch.float64) tensor(-0.5653, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5098, dtype=torch.float64) delta_t tensor(-0.7787, dtype=torch.float64)
8 gae_duplicate tensor(-1.0969, dtype=torch.float64) tensor(15.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7778, dtype=torch.float64) delta_t tensor(-0.8271, dtype=torch.float64)
7 gae_duplicate tensor(-1.0876, dtype=torch.float64) tensor(17.6881, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0038, dtype=torch.float64) delta_t tensor(-0.9928, dtype=torch.float64)
6 gae_duplicate tensor(-1.3049, dtype=torch.float64) tensor(21.3395, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2720, dtype=torch.float64) delta_t tensor(-1.2103, dtype=torch.float64)
5 gae_duplicate tensor(-1.4155, dtype=torch.float64) tensor(25.8468, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8878, dtype=torch.float64) delta_t tensor(-0.7539, dtype=torch.float64)
4 gae_duplicate tensor(-1.1884, dtype=torch.float64) tensor(17.4074, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7071, dtype=torch.float64) delta_t tensor(-1.5969, dtype=torch.float64)
3 gae_duplicate tensor(-1.9647, dtype=torch.float64) tensor(33.2758, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8052, dtype=torch.float64) delta_t tensor(-0.6626, dtype=torch.float64)
2 gae_duplicate tensor(-1.5512, dtype=torch.float64) tensor(16.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1761.748779296875
value loss:113.8626480102539
entropies:355.54339599609375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.13254714012146 seconds
19 rew tensor(0.9761, dtype=torch.float64) delta_t tensor(0.4922, dtype=torch.float64)
19 gae_duplicate tensor(0.4711, dtype=torch.float64) tensor(-9.8582, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(0.5326, dtype=torch.float64)
18 gae_duplicate tensor(0.5613, dtype=torch.float64) tensor(-11.4809, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9815, dtype=torch.float64) delta_t tensor(0.4967, dtype=torch.float64)
17 gae_duplicate tensor(0.3818, dtype=torch.float64) tensor(-10.9036, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.4810, dtype=torch.float64)
16 gae_duplicate tensor(0.3804, dtype=torch.float64) tensor(-10.7415, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9869, dtype=torch.float64) delta_t tensor(0.5003, dtype=torch.float64)
15 gae_duplicate tensor(0.3835, dtype=torch.float64) tensor(-10.9616, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9896, dtype=torch.float64) delta_t tensor(0.5083, dtype=torch.float64)
14 gae_duplicate tensor(0.3966, dtype=torch.float64) tensor(-11.1431, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9924, dtype=torch.float64) delta_t tensor(0.5116, dtype=torch.float64)
13 gae_duplicate tensor(0.4089, dtype=torch.float64) tensor(-11.3078, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9747, dtype=torch.float64) delta_t tensor(0.5020, dtype=torch.float64)
12 gae_duplicate tensor(0.4403, dtype=torch.float64) tensor(-11.2552, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9569, dtype=torch.float64) delta_t tensor(0.6597, dtype=torch.float64)
11 gae_duplicate tensor(0.4936, dtype=torch.float64) tensor(-14.1239, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6828, dtype=torch.float64) delta_t tensor(0.7432, dtype=torch.float64)
10 gae_duplicate tensor(0.7431, dtype=torch.float64) tensor(-16.1071, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0844, dtype=torch.float64) delta_t tensor(0.0103, dtype=torch.float64)
9 gae_duplicate tensor(-0.1537, dtype=torch.float64) tensor(-1.7779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4710, dtype=torch.float64) delta_t tensor(-0.7232, dtype=torch.float64)
8 gae_duplicate tensor(-1.1031, dtype=torch.float64) tensor(14.0640, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7803, dtype=torch.float64) delta_t tensor(-0.7723, dtype=torch.float64)
7 gae_duplicate tensor(-1.0924, dtype=torch.float64) tensor(16.8519, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9446, dtype=torch.float64) delta_t tensor(-0.8874, dtype=torch.float64)
6 gae_duplicate tensor(-1.1904, dtype=torch.float64) tensor(19.0910, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2742, dtype=torch.float64) delta_t tensor(-1.1867, dtype=torch.float64)
5 gae_duplicate tensor(-1.4465, dtype=torch.float64) tensor(24.7210, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9290, dtype=torch.float64) delta_t tensor(-0.7735, dtype=torch.float64)
4 gae_duplicate tensor(-1.2035, dtype=torch.float64) tensor(17.5021, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6984, dtype=torch.float64) delta_t tensor(-1.5778, dtype=torch.float64)
3 gae_duplicate tensor(-1.9028, dtype=torch.float64) tensor(33.5545, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7560, dtype=torch.float64) delta_t tensor(-0.5948, dtype=torch.float64)
2 gae_duplicate tensor(-1.4699, dtype=torch.float64) tensor(15.0053, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1236.9781494140625
value loss:108.89961242675781
entropies:355.6051025390625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.261992931365967 seconds
19 rew tensor(0.9779, dtype=torch.float64) delta_t tensor(0.4535, dtype=torch.float64)
19 gae_duplicate tensor(0.2703, dtype=torch.float64) tensor(-9.1802, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9804, dtype=torch.float64) delta_t tensor(0.4985, dtype=torch.float64)
18 gae_duplicate tensor(0.3707, dtype=torch.float64) tensor(-10.7646, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9830, dtype=torch.float64) delta_t tensor(0.4505, dtype=torch.float64)
17 gae_duplicate tensor(0.3587, dtype=torch.float64) tensor(-9.9490, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.4565, dtype=torch.float64)
16 gae_duplicate tensor(0.3598, dtype=torch.float64) tensor(-9.9524, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9881, dtype=torch.float64) delta_t tensor(0.4725, dtype=torch.float64)
15 gae_duplicate tensor(0.3728, dtype=torch.float64) tensor(-10.3569, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9907, dtype=torch.float64) delta_t tensor(0.4766, dtype=torch.float64)
14 gae_duplicate tensor(0.3787, dtype=torch.float64) tensor(-10.4389, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9934, dtype=torch.float64) delta_t tensor(0.4772, dtype=torch.float64)
13 gae_duplicate tensor(0.3802, dtype=torch.float64) tensor(-10.4866, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9759, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
12 gae_duplicate tensor(0.3671, dtype=torch.float64) tensor(-11.7866, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.5230, dtype=torch.float64) delta_t tensor(0.2902, dtype=torch.float64)
11 gae_duplicate tensor(-1.6743, dtype=torch.float64) tensor(-6.7877, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.4248, dtype=torch.float64) delta_t tensor(0.5199, dtype=torch.float64)
10 gae_duplicate tensor(-0.6642, dtype=torch.float64) tensor(-10.8920, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1233, dtype=torch.float64) delta_t tensor(-0.0004, dtype=torch.float64)
9 gae_duplicate tensor(-0.1336, dtype=torch.float64) tensor(-1.0783, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4908, dtype=torch.float64) delta_t tensor(-0.6794, dtype=torch.float64)
8 gae_duplicate tensor(-0.9760, dtype=torch.float64) tensor(13.4033, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7568, dtype=torch.float64) delta_t tensor(-0.6679, dtype=torch.float64)
7 gae_duplicate tensor(-1.0499, dtype=torch.float64) tensor(14.4971, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9833, dtype=torch.float64) delta_t tensor(-0.9290, dtype=torch.float64)
6 gae_duplicate tensor(-1.1428, dtype=torch.float64) tensor(19.9939, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.1707, dtype=torch.float64) delta_t tensor(-1.0758, dtype=torch.float64)
5 gae_duplicate tensor(-1.3247, dtype=torch.float64) tensor(22.8258, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9914, dtype=torch.float64) delta_t tensor(-0.8089, dtype=torch.float64)
4 gae_duplicate tensor(-1.3287, dtype=torch.float64) tensor(18.2045, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7795, dtype=torch.float64) delta_t tensor(-1.5950, dtype=torch.float64)
3 gae_duplicate tensor(-1.9269, dtype=torch.float64) tensor(33.0328, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0128, dtype=torch.float64) delta_t tensor(-0.8054, dtype=torch.float64)
2 gae_duplicate tensor(-1.5192, dtype=torch.float64) tensor(19.2272, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2229.655517578125
value loss:111.69707489013672
entropies:355.7130432128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.506783962249756 seconds
19 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(0.4476, dtype=torch.float64)
19 gae_duplicate tensor(0.4329, dtype=torch.float64) tensor(-8.8809, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(0.4647, dtype=torch.float64)
18 gae_duplicate tensor(0.3245, dtype=torch.float64) tensor(-10.0390, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9826, dtype=torch.float64) delta_t tensor(0.3669, dtype=torch.float64)
17 gae_duplicate tensor(0.3323, dtype=torch.float64) tensor(-8.2738, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9850, dtype=torch.float64) delta_t tensor(0.3618, dtype=torch.float64)
16 gae_duplicate tensor(0.3197, dtype=torch.float64) tensor(-7.9864, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9874, dtype=torch.float64) delta_t tensor(0.3982, dtype=torch.float64)
15 gae_duplicate tensor(0.3315, dtype=torch.float64) tensor(-8.6525, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9899, dtype=torch.float64) delta_t tensor(0.4034, dtype=torch.float64)
14 gae_duplicate tensor(0.3343, dtype=torch.float64) tensor(-8.7916, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9924, dtype=torch.float64) delta_t tensor(0.3547, dtype=torch.float64)
13 gae_duplicate tensor(0.3337, dtype=torch.float64) tensor(-7.8824, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9949, dtype=torch.float64) delta_t tensor(0.4212, dtype=torch.float64)
12 gae_duplicate tensor(0.3436, dtype=torch.float64) tensor(-9.1257, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9974, dtype=torch.float64) delta_t tensor(0.5955, dtype=torch.float64)
11 gae_duplicate tensor(0.5232, dtype=torch.float64) tensor(-12.6809, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.7033, dtype=torch.float64) delta_t tensor(0.7020, dtype=torch.float64)
10 gae_duplicate tensor(0.5821, dtype=torch.float64) tensor(-15.2119, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1644, dtype=torch.float64) delta_t tensor(-0.0578, dtype=torch.float64)
9 gae_duplicate tensor(-0.1737, dtype=torch.float64) tensor(-0.4207, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4904, dtype=torch.float64) delta_t tensor(-0.6929, dtype=torch.float64)
8 gae_duplicate tensor(-0.9362, dtype=torch.float64) tensor(13.4245, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7781, dtype=torch.float64) delta_t tensor(-0.8683, dtype=torch.float64)
7 gae_duplicate tensor(-1.0918, dtype=torch.float64) tensor(18.5976, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0237, dtype=torch.float64) delta_t tensor(-0.9804, dtype=torch.float64)
6 gae_duplicate tensor(-1.2686, dtype=torch.float64) tensor(21.4523, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2095, dtype=torch.float64) delta_t tensor(-1.0929, dtype=torch.float64)
5 gae_duplicate tensor(-1.3113, dtype=torch.float64) tensor(23.3304, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8659, dtype=torch.float64) delta_t tensor(-0.6793, dtype=torch.float64)
4 gae_duplicate tensor(-1.0264, dtype=torch.float64) tensor(15.8203, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6634, dtype=torch.float64) delta_t tensor(-1.4799, dtype=torch.float64)
3 gae_duplicate tensor(-1.7924, dtype=torch.float64) tensor(31.1122, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8340, dtype=torch.float64) delta_t tensor(-0.6809, dtype=torch.float64)
2 gae_duplicate tensor(-1.2641, dtype=torch.float64) tensor(16.5450, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2382.2333984375
value loss:95.71597290039062
entropies:355.82421875
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3953.8853)
ToM Target loss= tensor(3480.9839)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.278142929077148 seconds
19 rew tensor(0.9771, dtype=torch.float64) delta_t tensor(0.3959, dtype=torch.float64)
19 gae_duplicate tensor(0.2558, dtype=torch.float64) tensor(-7.8323, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(0.4235, dtype=torch.float64)
18 gae_duplicate tensor(0.3313, dtype=torch.float64) tensor(-9.1860, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(0.4036, dtype=torch.float64)
17 gae_duplicate tensor(0.2928, dtype=torch.float64) tensor(-8.8567, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9840, dtype=torch.float64) delta_t tensor(0.4037, dtype=torch.float64)
16 gae_duplicate tensor(0.3030, dtype=torch.float64) tensor(-8.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.4124, dtype=torch.float64)
15 gae_duplicate tensor(0.3226, dtype=torch.float64) tensor(-9.0162, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9887, dtype=torch.float64) delta_t tensor(0.4519, dtype=torch.float64)
14 gae_duplicate tensor(0.3575, dtype=torch.float64) tensor(-9.7576, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.4379, dtype=torch.float64)
13 gae_duplicate tensor(0.2978, dtype=torch.float64) tensor(-9.6556, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9934, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
12 gae_duplicate tensor(0.3476, dtype=torch.float64) tensor(-8.6987, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9958, dtype=torch.float64) delta_t tensor(0.6997, dtype=torch.float64)
11 gae_duplicate tensor(0.5532, dtype=torch.float64) tensor(-14.6808, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6288, dtype=torch.float64) delta_t tensor(0.6737, dtype=torch.float64)
10 gae_duplicate tensor(0.6765, dtype=torch.float64) tensor(-14.7992, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0040, dtype=torch.float64) delta_t tensor(0.1044, dtype=torch.float64)
9 gae_duplicate tensor(-0.1130, dtype=torch.float64) tensor(-3.5712, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3529, dtype=torch.float64) delta_t tensor(-0.5557, dtype=torch.float64)
8 gae_duplicate tensor(-0.7284, dtype=torch.float64) tensor(10.6457, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7322, dtype=torch.float64) delta_t tensor(-0.8750, dtype=torch.float64)
7 gae_duplicate tensor(-1.0946, dtype=torch.float64) tensor(18.4122, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.8969, dtype=torch.float64) delta_t tensor(-0.7588, dtype=torch.float64)
6 gae_duplicate tensor(-1.0817, dtype=torch.float64) tensor(16.8075, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2161, dtype=torch.float64) delta_t tensor(-1.0837, dtype=torch.float64)
5 gae_duplicate tensor(-1.3006, dtype=torch.float64) tensor(23.1944, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9015, dtype=torch.float64) delta_t tensor(-0.6854, dtype=torch.float64)
4 gae_duplicate tensor(-1.0817, dtype=torch.float64) tensor(15.7114, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4274, dtype=torch.float64) delta_t tensor(-1.2741, dtype=torch.float64)
3 gae_duplicate tensor(-1.6757, dtype=torch.float64) tensor(26.7201, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5176, dtype=torch.float64) delta_t tensor(-0.3118, dtype=torch.float64)
2 gae_duplicate tensor(-0.9995, dtype=torch.float64) tensor(8.8466, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-930.2520751953125
value loss:83.56085968017578
entropies:355.8843994140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.316455125808716 seconds
19 rew tensor(0.9777, dtype=torch.float64) delta_t tensor(0.3650, dtype=torch.float64)
19 gae_duplicate tensor(0.1766, dtype=torch.float64) tensor(-7.2573, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(0.3856, dtype=torch.float64)
18 gae_duplicate tensor(0.2763, dtype=torch.float64) tensor(-8.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9821, dtype=torch.float64) delta_t tensor(0.3229, dtype=torch.float64)
17 gae_duplicate tensor(0.2744, dtype=torch.float64) tensor(-7.2046, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.3339, dtype=torch.float64)
16 gae_duplicate tensor(0.2858, dtype=torch.float64) tensor(-7.2678, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9865, dtype=torch.float64) delta_t tensor(0.3543, dtype=torch.float64)
15 gae_duplicate tensor(0.3061, dtype=torch.float64) tensor(-7.7410, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.3942, dtype=torch.float64)
14 gae_duplicate tensor(0.3320, dtype=torch.float64) tensor(-8.5224, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.3912, dtype=torch.float64)
13 gae_duplicate tensor(0.2869, dtype=torch.float64) tensor(-8.5954, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9730, dtype=torch.float64) delta_t tensor(0.4263, dtype=torch.float64)
12 gae_duplicate tensor(0.2773, dtype=torch.float64) tensor(-9.2811, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9549, dtype=torch.float64) delta_t tensor(0.5462, dtype=torch.float64)
11 gae_duplicate tensor(0.4232, dtype=torch.float64) tensor(-11.8313, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6192, dtype=torch.float64) delta_t tensor(0.6197, dtype=torch.float64)
10 gae_duplicate tensor(0.3877, dtype=torch.float64) tensor(-13.4327, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2102, dtype=torch.float64) delta_t tensor(-0.1044, dtype=torch.float64)
9 gae_duplicate tensor(-0.1330, dtype=torch.float64) tensor(0.7175, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4359, dtype=torch.float64) delta_t tensor(-0.5534, dtype=torch.float64)
8 gae_duplicate tensor(-0.7783, dtype=torch.float64) tensor(11.0224, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8247, dtype=torch.float64) delta_t tensor(-0.9049, dtype=torch.float64)
7 gae_duplicate tensor(-1.0766, dtype=torch.float64) tensor(18.8360, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1326, dtype=torch.float64) delta_t tensor(-1.0146, dtype=torch.float64)
6 gae_duplicate tensor(-1.2085, dtype=torch.float64) tensor(21.9203, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2585, dtype=torch.float64) delta_t tensor(-1.0821, dtype=torch.float64)
5 gae_duplicate tensor(-1.3512, dtype=torch.float64) tensor(23.4582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8929, dtype=torch.float64) delta_t tensor(-0.6553, dtype=torch.float64)
4 gae_duplicate tensor(-1.2329, dtype=torch.float64) tensor(15.2773, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6827, dtype=torch.float64) delta_t tensor(-1.4498, dtype=torch.float64)
3 gae_duplicate tensor(-1.8159, dtype=torch.float64) tensor(30.3035, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8187, dtype=torch.float64) delta_t tensor(-0.6027, dtype=torch.float64)
2 gae_duplicate tensor(-1.3984, dtype=torch.float64) tensor(14.9568, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2631.8564453125
value loss:89.21995544433594
entropies:355.8554992675781
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.216107130050659 seconds
19 rew tensor(0.9779, dtype=torch.float64) delta_t tensor(0.3414, dtype=torch.float64)
19 gae_duplicate tensor(0.1369, dtype=torch.float64) tensor(-6.7258, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(0.3687, dtype=torch.float64)
18 gae_duplicate tensor(0.2362, dtype=torch.float64) tensor(-8.0241, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9821, dtype=torch.float64) delta_t tensor(0.3442, dtype=torch.float64)
17 gae_duplicate tensor(0.2370, dtype=torch.float64) tensor(-7.5170, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.3787, dtype=torch.float64)
16 gae_duplicate tensor(0.2449, dtype=torch.float64) tensor(-8.2659, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
15 gae_duplicate tensor(0.2587, dtype=torch.float64) tensor(-8.3318, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9885, dtype=torch.float64) delta_t tensor(0.3735, dtype=torch.float64)
14 gae_duplicate tensor(0.2653, dtype=torch.float64) tensor(-8.1611, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9906, dtype=torch.float64) delta_t tensor(0.3421, dtype=torch.float64)
13 gae_duplicate tensor(0.2496, dtype=torch.float64) tensor(-7.5234, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9928, dtype=torch.float64) delta_t tensor(0.4456, dtype=torch.float64)
12 gae_duplicate tensor(0.2807, dtype=torch.float64) tensor(-9.5728, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9950, dtype=torch.float64) delta_t tensor(0.6320, dtype=torch.float64)
11 gae_duplicate tensor(0.6267, dtype=torch.float64) tensor(-13.4067, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5444, dtype=torch.float64) delta_t tensor(0.6114, dtype=torch.float64)
10 gae_duplicate tensor(0.2945, dtype=torch.float64) tensor(-13.4171, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1694, dtype=torch.float64) delta_t tensor(-0.0621, dtype=torch.float64)
9 gae_duplicate tensor(-0.1326, dtype=torch.float64) tensor(-0.1073, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4362, dtype=torch.float64) delta_t tensor(-0.5818, dtype=torch.float64)
8 gae_duplicate tensor(-1.0628, dtype=torch.float64) tensor(11.6031, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8351, dtype=torch.float64) delta_t tensor(-0.9094, dtype=torch.float64)
7 gae_duplicate tensor(-1.0807, dtype=torch.float64) tensor(19.1446, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0501, dtype=torch.float64) delta_t tensor(-0.8754, dtype=torch.float64)
6 gae_duplicate tensor(-1.1638, dtype=torch.float64) tensor(19.1226, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2564, dtype=torch.float64) delta_t tensor(-1.0489, dtype=torch.float64)
5 gae_duplicate tensor(-1.2388, dtype=torch.float64) tensor(22.8292, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8117, dtype=torch.float64) delta_t tensor(-0.5411, dtype=torch.float64)
4 gae_duplicate tensor(-0.9048, dtype=torch.float64) tensor(12.9388, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6917, dtype=torch.float64) delta_t tensor(-1.4554, dtype=torch.float64)
3 gae_duplicate tensor(-1.7884, dtype=torch.float64) tensor(30.0569, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6445, dtype=torch.float64) delta_t tensor(-0.3626, dtype=torch.float64)
2 gae_duplicate tensor(-1.3731, dtype=torch.float64) tensor(10.1038, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1972.3369140625
value loss:83.57183074951172
entropies:355.7790222167969
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.235188007354736 seconds
19 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(0.3144, dtype=torch.float64)
19 gae_duplicate tensor(0.1196, dtype=torch.float64) tensor(-6.0517, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9808, dtype=torch.float64) delta_t tensor(0.3503, dtype=torch.float64)
18 gae_duplicate tensor(0.2037, dtype=torch.float64) tensor(-7.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(0.3330, dtype=torch.float64)
17 gae_duplicate tensor(0.2156, dtype=torch.float64) tensor(-7.3407, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(0.3332, dtype=torch.float64)
16 gae_duplicate tensor(0.2214, dtype=torch.float64) tensor(-7.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9869, dtype=torch.float64) delta_t tensor(0.3428, dtype=torch.float64)
15 gae_duplicate tensor(0.2363, dtype=torch.float64) tensor(-7.5043, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9890, dtype=torch.float64) delta_t tensor(0.3855, dtype=torch.float64)
14 gae_duplicate tensor(0.2603, dtype=torch.float64) tensor(-8.2595, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.5347, dtype=torch.float64)
13 gae_duplicate tensor(0.3515, dtype=torch.float64) tensor(-11.5507, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.5672, dtype=torch.float64) delta_t tensor(0.0226, dtype=torch.float64)
12 gae_duplicate tensor(-1.5665, dtype=torch.float64) tensor(-1.7080, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9323, dtype=torch.float64) delta_t tensor(0.5281, dtype=torch.float64)
11 gae_duplicate tensor(0.3478, dtype=torch.float64) tensor(-10.7184, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6278, dtype=torch.float64) delta_t tensor(0.7205, dtype=torch.float64)
10 gae_duplicate tensor(0.5991, dtype=torch.float64) tensor(-15.1696, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1691, dtype=torch.float64) delta_t tensor(-0.0446, dtype=torch.float64)
9 gae_duplicate tensor(-0.1323, dtype=torch.float64) tensor(-0.6492, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3542, dtype=torch.float64) delta_t tensor(-0.4350, dtype=torch.float64)
8 gae_duplicate tensor(-0.5919, dtype=torch.float64) tensor(8.6950, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8037, dtype=torch.float64) delta_t tensor(-0.7488, dtype=torch.float64)
7 gae_duplicate tensor(-1.0202, dtype=torch.float64) tensor(15.4423, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1106, dtype=torch.float64) delta_t tensor(-0.9439, dtype=torch.float64)
6 gae_duplicate tensor(-1.1584, dtype=torch.float64) tensor(20.5513, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2565, dtype=torch.float64) delta_t tensor(-0.9993, dtype=torch.float64)
5 gae_duplicate tensor(-1.2467, dtype=torch.float64) tensor(21.6275, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8925, dtype=torch.float64) delta_t tensor(-0.6239, dtype=torch.float64)
4 gae_duplicate tensor(-1.0139, dtype=torch.float64) tensor(14.5113, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7323, dtype=torch.float64) delta_t tensor(-1.4641, dtype=torch.float64)
3 gae_duplicate tensor(-1.7481, dtype=torch.float64) tensor(30.3354, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8605, dtype=torch.float64) delta_t tensor(-0.5900, dtype=torch.float64)
2 gae_duplicate tensor(-1.3376, dtype=torch.float64) tensor(14.8902, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2370.48291015625
value loss:87.16902160644531
entropies:355.6505432128906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.837564706802368 seconds
19 rew tensor(0.9793, dtype=torch.float64) delta_t tensor(0.2435, dtype=torch.float64)
19 gae_duplicate tensor(0.0992, dtype=torch.float64) tensor(-4.8551, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.3092, dtype=torch.float64)
18 gae_duplicate tensor(0.1987, dtype=torch.float64) tensor(-6.5891, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.2181, dtype=torch.float64)
17 gae_duplicate tensor(0.2021, dtype=torch.float64) tensor(-4.9349, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(0.2846, dtype=torch.float64)
16 gae_duplicate tensor(0.2137, dtype=torch.float64) tensor(-6.1427, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9871, dtype=torch.float64) delta_t tensor(0.3065, dtype=torch.float64)
15 gae_duplicate tensor(0.2195, dtype=torch.float64) tensor(-6.5770, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9890, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
14 gae_duplicate tensor(0.2418, dtype=torch.float64) tensor(-8.0861, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9910, dtype=torch.float64) delta_t tensor(0.2034, dtype=torch.float64)
13 gae_duplicate tensor(0.2097, dtype=torch.float64) tensor(-4.8000, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9930, dtype=torch.float64) delta_t tensor(0.3557, dtype=torch.float64)
12 gae_duplicate tensor(0.2456, dtype=torch.float64) tensor(-7.4445, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9950, dtype=torch.float64) delta_t tensor(0.5688, dtype=torch.float64)
11 gae_duplicate tensor(0.5664, dtype=torch.float64) tensor(-12.0685, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6291, dtype=torch.float64) delta_t tensor(0.7425, dtype=torch.float64)
10 gae_duplicate tensor(0.7103, dtype=torch.float64) tensor(-16.0115, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2506, dtype=torch.float64) delta_t tensor(-0.1115, dtype=torch.float64)
9 gae_duplicate tensor(-0.1031, dtype=torch.float64) tensor(0.6193, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5166, dtype=torch.float64) delta_t tensor(-0.5948, dtype=torch.float64)
8 gae_duplicate tensor(-0.8483, dtype=torch.float64) tensor(11.6500, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8440, dtype=torch.float64) delta_t tensor(-0.8751, dtype=torch.float64)
7 gae_duplicate tensor(-1.0963, dtype=torch.float64) tensor(18.4864, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0695, dtype=torch.float64) delta_t tensor(-0.8783, dtype=torch.float64)
6 gae_duplicate tensor(-1.0896, dtype=torch.float64) tensor(19.0437, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2358, dtype=torch.float64) delta_t tensor(-0.9668, dtype=torch.float64)
5 gae_duplicate tensor(-1.2247, dtype=torch.float64) tensor(20.8544, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8296, dtype=torch.float64) delta_t tensor(-0.5131, dtype=torch.float64)
4 gae_duplicate tensor(-0.7375, dtype=torch.float64) tensor(12.1615, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6470, dtype=torch.float64) delta_t tensor(-1.3606, dtype=torch.float64)
3 gae_duplicate tensor(-1.5720, dtype=torch.float64) tensor(28.2195, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7737, dtype=torch.float64) delta_t tensor(-0.5082, dtype=torch.float64)
2 gae_duplicate tensor(-1.0332, dtype=torch.float64) tensor(13.0076, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2608.76806640625
value loss:73.46199035644531
entropies:355.54229736328125
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3957.6802)
ToM Target loss= tensor(3464.2241)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.0837016105651855 seconds
19 rew tensor(0.9795, dtype=torch.float64) delta_t tensor(0.2823, dtype=torch.float64)
19 gae_duplicate tensor(0.1458, dtype=torch.float64) tensor(-5.6387, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(0.3111, dtype=torch.float64)
18 gae_duplicate tensor(0.2453, dtype=torch.float64) tensor(-6.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.2569, dtype=torch.float64)
17 gae_duplicate tensor(0.1760, dtype=torch.float64) tensor(-5.7532, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(0.2802, dtype=torch.float64)
16 gae_duplicate tensor(0.1906, dtype=torch.float64) tensor(-6.1341, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9869, dtype=torch.float64) delta_t tensor(0.2596, dtype=torch.float64)
15 gae_duplicate tensor(0.1756, dtype=torch.float64) tensor(-5.8086, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.3024, dtype=torch.float64)
14 gae_duplicate tensor(0.1870, dtype=torch.float64) tensor(-6.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9907, dtype=torch.float64) delta_t tensor(0.2774, dtype=torch.float64)
13 gae_duplicate tensor(0.1935, dtype=torch.float64) tensor(-6.0938, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9927, dtype=torch.float64) delta_t tensor(0.3927, dtype=torch.float64)
12 gae_duplicate tensor(0.2098, dtype=torch.float64) tensor(-8.3596, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9744, dtype=torch.float64) delta_t tensor(0.5365, dtype=torch.float64)
11 gae_duplicate tensor(0.4610, dtype=torch.float64) tensor(-11.4967, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6689, dtype=torch.float64) delta_t tensor(0.8137, dtype=torch.float64)
10 gae_duplicate tensor(0.7273, dtype=torch.float64) tensor(-16.7805, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2291, dtype=torch.float64) delta_t tensor(-0.0797, dtype=torch.float64)
9 gae_duplicate tensor(-0.0922, dtype=torch.float64) tensor(-0.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5147, dtype=torch.float64) delta_t tensor(-0.5797, dtype=torch.float64)
8 gae_duplicate tensor(-0.8681, dtype=torch.float64) tensor(11.5196, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8839, dtype=torch.float64) delta_t tensor(-0.8262, dtype=torch.float64)
7 gae_duplicate tensor(-1.0292, dtype=torch.float64) tensor(17.2424, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0495, dtype=torch.float64) delta_t tensor(-0.8228, dtype=torch.float64)
6 gae_duplicate tensor(-1.0943, dtype=torch.float64) tensor(18.1934, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2969, dtype=torch.float64) delta_t tensor(-0.9908, dtype=torch.float64)
5 gae_duplicate tensor(-1.2423, dtype=torch.float64) tensor(21.4415, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8697, dtype=torch.float64) delta_t tensor(-0.5692, dtype=torch.float64)
4 gae_duplicate tensor(-0.9211, dtype=torch.float64) tensor(13.2295, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6784, dtype=torch.float64) delta_t tensor(-1.3694, dtype=torch.float64)
3 gae_duplicate tensor(-1.6853, dtype=torch.float64) tensor(28.1939, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8026, dtype=torch.float64) delta_t tensor(-0.4792, dtype=torch.float64)
2 gae_duplicate tensor(-1.2565, dtype=torch.float64) tensor(12.2477, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2386.6142578125
value loss:75.27759552001953
entropies:355.475830078125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.6842241287231445 seconds
19 rew tensor(0.9791, dtype=torch.float64) delta_t tensor(0.2953, dtype=torch.float64)
19 gae_duplicate tensor(0.1871, dtype=torch.float64) tensor(-5.8040, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(0.2924, dtype=torch.float64)
18 gae_duplicate tensor(0.1424, dtype=torch.float64) tensor(-6.2893, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9827, dtype=torch.float64) delta_t tensor(0.2593, dtype=torch.float64)
17 gae_duplicate tensor(0.1542, dtype=torch.float64) tensor(-5.7491, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9845, dtype=torch.float64) delta_t tensor(0.3037, dtype=torch.float64)
16 gae_duplicate tensor(0.1606, dtype=torch.float64) tensor(-6.6113, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.3080, dtype=torch.float64)
15 gae_duplicate tensor(0.1794, dtype=torch.float64) tensor(-6.8571, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9882, dtype=torch.float64) delta_t tensor(0.3181, dtype=torch.float64)
14 gae_duplicate tensor(0.2110, dtype=torch.float64) tensor(-6.9526, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9900, dtype=torch.float64) delta_t tensor(0.2746, dtype=torch.float64)
13 gae_duplicate tensor(0.1799, dtype=torch.float64) tensor(-6.1754, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9918, dtype=torch.float64) delta_t tensor(0.3004, dtype=torch.float64)
12 gae_duplicate tensor(0.1761, dtype=torch.float64) tensor(-6.4892, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9937, dtype=torch.float64) delta_t tensor(0.5411, dtype=torch.float64)
11 gae_duplicate tensor(0.4713, dtype=torch.float64) tensor(-11.2642, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6884, dtype=torch.float64) delta_t tensor(0.7347, dtype=torch.float64)
10 gae_duplicate tensor(0.6572, dtype=torch.float64) tensor(-15.9040, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0695, dtype=torch.float64) delta_t tensor(0.0930, dtype=torch.float64)
9 gae_duplicate tensor(-0.0749, dtype=torch.float64) tensor(-3.4390, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4173, dtype=torch.float64) delta_t tensor(-0.4828, dtype=torch.float64)
8 gae_duplicate tensor(-0.6714, dtype=torch.float64) tensor(9.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7644, dtype=torch.float64) delta_t tensor(-0.8088, dtype=torch.float64)
7 gae_duplicate tensor(-1.0526, dtype=torch.float64) tensor(17.1667, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0309, dtype=torch.float64) delta_t tensor(-0.7912, dtype=torch.float64)
6 gae_duplicate tensor(-1.0232, dtype=torch.float64) tensor(17.4136, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2566, dtype=torch.float64) delta_t tensor(-0.9611, dtype=torch.float64)
5 gae_duplicate tensor(-1.1463, dtype=torch.float64) tensor(20.8637, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8307, dtype=torch.float64) delta_t tensor(-0.4844, dtype=torch.float64)
4 gae_duplicate tensor(-0.8587, dtype=torch.float64) tensor(11.7442, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6182, dtype=torch.float64) delta_t tensor(-1.3067, dtype=torch.float64)
3 gae_duplicate tensor(-1.5261, dtype=torch.float64) tensor(26.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5312, dtype=torch.float64) delta_t tensor(-0.2445, dtype=torch.float64)
2 gae_duplicate tensor(-0.6359, dtype=torch.float64) tensor(7.4484, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1676.67822265625
value loss:65.58124542236328
entropies:355.4670715332031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.074095964431763 seconds
19 rew tensor(0.9791, dtype=torch.float64) delta_t tensor(0.2485, dtype=torch.float64)
19 gae_duplicate tensor(0.0240, dtype=torch.float64) tensor(-5.0176, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9808, dtype=torch.float64) delta_t tensor(0.3157, dtype=torch.float64)
18 gae_duplicate tensor(0.1236, dtype=torch.float64) tensor(-6.7244, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.2420, dtype=torch.float64)
17 gae_duplicate tensor(0.1344, dtype=torch.float64) tensor(-5.4922, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.2477, dtype=torch.float64)
16 gae_duplicate tensor(0.1382, dtype=torch.float64) tensor(-5.4985, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(0.2918, dtype=torch.float64)
15 gae_duplicate tensor(0.1402, dtype=torch.float64) tensor(-6.3303, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9877, dtype=torch.float64) delta_t tensor(0.3223, dtype=torch.float64)
14 gae_duplicate tensor(0.1422, dtype=torch.float64) tensor(-7.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9895, dtype=torch.float64) delta_t tensor(0.2774, dtype=torch.float64)
13 gae_duplicate tensor(0.1447, dtype=torch.float64) tensor(-6.0330, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9913, dtype=torch.float64) delta_t tensor(0.4024, dtype=torch.float64)
12 gae_duplicate tensor(0.3304, dtype=torch.float64) tensor(-8.4923, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9726, dtype=torch.float64) delta_t tensor(0.6201, dtype=torch.float64)
11 gae_duplicate tensor(0.3588, dtype=torch.float64) tensor(-13.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6358, dtype=torch.float64) delta_t tensor(0.7518, dtype=torch.float64)
10 gae_duplicate tensor(0.7089, dtype=torch.float64) tensor(-16.3707, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1299, dtype=torch.float64) delta_t tensor(0.0431, dtype=torch.float64)
9 gae_duplicate tensor(-0.0657, dtype=torch.float64) tensor(-2.5379, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4783, dtype=torch.float64) delta_t tensor(-0.4862, dtype=torch.float64)
8 gae_duplicate tensor(-0.6927, dtype=torch.float64) tensor(9.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8473, dtype=torch.float64) delta_t tensor(-0.8109, dtype=torch.float64)
7 gae_duplicate tensor(-1.2270, dtype=torch.float64) tensor(17.1047, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0740, dtype=torch.float64) delta_t tensor(-0.7644, dtype=torch.float64)
6 gae_duplicate tensor(-1.1274, dtype=torch.float64) tensor(16.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3011, dtype=torch.float64) delta_t tensor(-0.9601, dtype=torch.float64)
5 gae_duplicate tensor(-1.1237, dtype=torch.float64) tensor(20.5839, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8748, dtype=torch.float64) delta_t tensor(-0.5081, dtype=torch.float64)
4 gae_duplicate tensor(-1.1342, dtype=torch.float64) tensor(11.9343, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6441, dtype=torch.float64) delta_t tensor(-1.3105, dtype=torch.float64)
3 gae_duplicate tensor(-1.8321, dtype=torch.float64) tensor(26.9164, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6341, dtype=torch.float64) delta_t tensor(-0.2567, dtype=torch.float64)
2 gae_duplicate tensor(-1.3976, dtype=torch.float64) tensor(7.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1621.6060791015625
value loss:70.19342803955078
entropies:355.4758605957031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.978653192520142 seconds
19 rew tensor(0.9787, dtype=torch.float64) delta_t tensor(0.2263, dtype=torch.float64)
19 gae_duplicate tensor(0.0019, dtype=torch.float64) tensor(-4.4865, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9804, dtype=torch.float64) delta_t tensor(0.2492, dtype=torch.float64)
18 gae_duplicate tensor(0.1023, dtype=torch.float64) tensor(-5.4514, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9821, dtype=torch.float64) delta_t tensor(0.2562, dtype=torch.float64)
17 gae_duplicate tensor(0.1123, dtype=torch.float64) tensor(-5.6538, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(0.3081, dtype=torch.float64)
16 gae_duplicate tensor(0.1169, dtype=torch.float64) tensor(-6.6687, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(0.3052, dtype=torch.float64)
15 gae_duplicate tensor(0.1272, dtype=torch.float64) tensor(-6.6862, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9871, dtype=torch.float64) delta_t tensor(0.3094, dtype=torch.float64)
14 gae_duplicate tensor(0.1460, dtype=torch.float64) tensor(-6.7943, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.2549, dtype=torch.float64)
13 gae_duplicate tensor(0.1615, dtype=torch.float64) tensor(-5.6497, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9905, dtype=torch.float64) delta_t tensor(0.2866, dtype=torch.float64)
12 gae_duplicate tensor(0.1290, dtype=torch.float64) tensor(-6.2657, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9922, dtype=torch.float64) delta_t tensor(0.5609, dtype=torch.float64)
11 gae_duplicate tensor(0.4644, dtype=torch.float64) tensor(-11.5774, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6347, dtype=torch.float64) delta_t tensor(0.7101, dtype=torch.float64)
10 gae_duplicate tensor(0.5606, dtype=torch.float64) tensor(-15.1256, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0517, dtype=torch.float64) delta_t tensor(0.1290, dtype=torch.float64)
9 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-4.1275, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3788, dtype=torch.float64) delta_t tensor(-0.3792, dtype=torch.float64)
8 gae_duplicate tensor(-0.5099, dtype=torch.float64) tensor(7.1128, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8087, dtype=torch.float64) delta_t tensor(-0.7744, dtype=torch.float64)
7 gae_duplicate tensor(-0.9723, dtype=torch.float64) tensor(16.3099, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0448, dtype=torch.float64) delta_t tensor(-0.7376, dtype=torch.float64)
6 gae_duplicate tensor(-0.9631, dtype=torch.float64) tensor(16.2274, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3221, dtype=torch.float64) delta_t tensor(-0.9540, dtype=torch.float64)
5 gae_duplicate tensor(-1.1448, dtype=torch.float64) tensor(20.6701, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8340, dtype=torch.float64) delta_t tensor(-0.4358, dtype=torch.float64)
4 gae_duplicate tensor(-0.7047, dtype=torch.float64) tensor(10.8193, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6738, dtype=torch.float64) delta_t tensor(-1.3205, dtype=torch.float64)
3 gae_duplicate tensor(-1.4622, dtype=torch.float64) tensor(26.9598, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4616, dtype=torch.float64) delta_t tensor(-0.1207, dtype=torch.float64)
2 gae_duplicate tensor(-0.4322, dtype=torch.float64) tensor(5.2402, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1438.0478515625
value loss:60.50568389892578
entropies:355.5328063964844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.144914150238037 seconds
19 rew tensor(0.9786, dtype=torch.float64) delta_t tensor(0.1223, dtype=torch.float64)
19 gae_duplicate tensor(-0.0269, dtype=torch.float64) tensor(-2.4186, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.2061, dtype=torch.float64)
18 gae_duplicate tensor(0.0736, dtype=torch.float64) tensor(-4.2412, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(0.1513, dtype=torch.float64)
17 gae_duplicate tensor(0.0690, dtype=torch.float64) tensor(-3.4312, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9835, dtype=torch.float64) delta_t tensor(0.2081, dtype=torch.float64)
16 gae_duplicate tensor(0.0718, dtype=torch.float64) tensor(-4.5530, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(0.2444, dtype=torch.float64)
15 gae_duplicate tensor(0.0824, dtype=torch.float64) tensor(-5.3481, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9867, dtype=torch.float64) delta_t tensor(0.2535, dtype=torch.float64)
14 gae_duplicate tensor(0.1025, dtype=torch.float64) tensor(-5.5078, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9884, dtype=torch.float64) delta_t tensor(0.1559, dtype=torch.float64)
13 gae_duplicate tensor(0.0901, dtype=torch.float64) tensor(-3.6475, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9900, dtype=torch.float64) delta_t tensor(0.3209, dtype=torch.float64)
12 gae_duplicate tensor(0.2019, dtype=torch.float64) tensor(-6.8615, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9917, dtype=torch.float64) delta_t tensor(0.4942, dtype=torch.float64)
11 gae_duplicate tensor(0.4013, dtype=torch.float64) tensor(-10.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6753, dtype=torch.float64) delta_t tensor(0.7964, dtype=torch.float64)
10 gae_duplicate tensor(0.7165, dtype=torch.float64) tensor(-16.9390, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1348, dtype=torch.float64) delta_t tensor(0.0688, dtype=torch.float64)
9 gae_duplicate tensor(-0.0129, dtype=torch.float64) tensor(-3.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4617, dtype=torch.float64) delta_t tensor(-0.4266, dtype=torch.float64)
8 gae_duplicate tensor(-0.6846, dtype=torch.float64) tensor(8.0982, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8506, dtype=torch.float64) delta_t tensor(-0.7127, dtype=torch.float64)
7 gae_duplicate tensor(-1.0144, dtype=torch.float64) tensor(14.8068, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0163, dtype=torch.float64) delta_t tensor(-0.6822, dtype=torch.float64)
6 gae_duplicate tensor(-0.9162, dtype=torch.float64) tensor(14.8930, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3234, dtype=torch.float64) delta_t tensor(-0.9156, dtype=torch.float64)
5 gae_duplicate tensor(-1.1006, dtype=torch.float64) tensor(19.7246, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8350, dtype=torch.float64) delta_t tensor(-0.4005, dtype=torch.float64)
4 gae_duplicate tensor(-0.7372, dtype=torch.float64) tensor(9.8439, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6748, dtype=torch.float64) delta_t tensor(-1.2811, dtype=torch.float64)
3 gae_duplicate tensor(-1.6607, dtype=torch.float64) tensor(26.2141, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6159, dtype=torch.float64) delta_t tensor(-0.2029, dtype=torch.float64)
2 gae_duplicate tensor(-0.8006, dtype=torch.float64) tensor(6.5031, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1905.401611328125
value loss:56.577999114990234
entropies:355.51806640625
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3959.0623)
ToM Target loss= tensor(3465.8223)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.048387050628662 seconds
19 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(0.2241, dtype=torch.float64)
19 gae_duplicate tensor(0.0597, dtype=torch.float64) tensor(-4.3357, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9803, dtype=torch.float64) delta_t tensor(0.2919, dtype=torch.float64)
18 gae_duplicate tensor(0.1593, dtype=torch.float64) tensor(-6.1545, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
17 gae_duplicate tensor(0.0706, dtype=torch.float64) tensor(-5.5008, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.2557, dtype=torch.float64)
16 gae_duplicate tensor(0.0817, dtype=torch.float64) tensor(-5.5944, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9850, dtype=torch.float64) delta_t tensor(0.2766, dtype=torch.float64)
15 gae_duplicate tensor(0.1754, dtype=torch.float64) tensor(-6.0805, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9866, dtype=torch.float64) delta_t tensor(0.3938, dtype=torch.float64)
14 gae_duplicate tensor(0.3402, dtype=torch.float64) tensor(-8.3448, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9882, dtype=torch.float64) delta_t tensor(0.3311, dtype=torch.float64)
13 gae_duplicate tensor(0.0933, dtype=torch.float64) tensor(-7.4137, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9693, dtype=torch.float64) delta_t tensor(0.3027, dtype=torch.float64)
12 gae_duplicate tensor(0.2831, dtype=torch.float64) tensor(-6.7391, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9503, dtype=torch.float64) delta_t tensor(0.4889, dtype=torch.float64)
11 gae_duplicate tensor(0.2458, dtype=torch.float64) tensor(-10.2840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6029, dtype=torch.float64) delta_t tensor(0.7698, dtype=torch.float64)
10 gae_duplicate tensor(0.7317, dtype=torch.float64) tensor(-16.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0929, dtype=torch.float64) delta_t tensor(0.1201, dtype=torch.float64)
9 gae_duplicate tensor(-0.0176, dtype=torch.float64) tensor(-3.9643, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4413, dtype=torch.float64) delta_t tensor(-0.3859, dtype=torch.float64)
8 gae_duplicate tensor(-0.6777, dtype=torch.float64) tensor(7.2751, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8315, dtype=torch.float64) delta_t tensor(-0.5957, dtype=torch.float64)
7 gae_duplicate tensor(-0.7497, dtype=torch.float64) tensor(12.6727, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0070, dtype=torch.float64) delta_t tensor(-0.6567, dtype=torch.float64)
6 gae_duplicate tensor(-0.8264, dtype=torch.float64) tensor(14.2875, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2847, dtype=torch.float64) delta_t tensor(-0.8395, dtype=torch.float64)
5 gae_duplicate tensor(-1.0755, dtype=torch.float64) tensor(18.1197, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8562, dtype=torch.float64) delta_t tensor(-0.4198, dtype=torch.float64)
4 gae_duplicate tensor(-0.7586, dtype=torch.float64) tensor(10.0536, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6668, dtype=torch.float64) delta_t tensor(-1.2571, dtype=torch.float64)
3 gae_duplicate tensor(-1.5932, dtype=torch.float64) tensor(25.9074, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6559, dtype=torch.float64) delta_t tensor(-0.2325, dtype=torch.float64)
2 gae_duplicate tensor(-1.1735, dtype=torch.float64) tensor(7.2454, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-903.73291015625
value loss:57.14124298095703
entropies:355.56488037109375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.51829719543457 seconds
19 rew tensor(0.9781, dtype=torch.float64) delta_t tensor(0.2322, dtype=torch.float64)
19 gae_duplicate tensor(0.2131, dtype=torch.float64) tensor(-4.5065, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9796, dtype=torch.float64) delta_t tensor(0.2580, dtype=torch.float64)
18 gae_duplicate tensor(0.0764, dtype=torch.float64) tensor(-5.5625, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.2179, dtype=torch.float64)
17 gae_duplicate tensor(0.0574, dtype=torch.float64) tensor(-4.8476, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9827, dtype=torch.float64) delta_t tensor(0.3002, dtype=torch.float64)
16 gae_duplicate tensor(0.2822, dtype=torch.float64) tensor(-6.4212, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.2920, dtype=torch.float64)
15 gae_duplicate tensor(0.2840, dtype=torch.float64) tensor(-6.6035, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9857, dtype=torch.float64) delta_t tensor(0.2933, dtype=torch.float64)
14 gae_duplicate tensor(0.2857, dtype=torch.float64) tensor(-6.3492, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9872, dtype=torch.float64) delta_t tensor(0.2020, dtype=torch.float64)
13 gae_duplicate tensor(0.0687, dtype=torch.float64) tensor(-4.6436, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.2150, dtype=torch.float64)
12 gae_duplicate tensor(0.1431, dtype=torch.float64) tensor(-4.6917, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9903, dtype=torch.float64) delta_t tensor(0.5364, dtype=torch.float64)
11 gae_duplicate tensor(0.3999, dtype=torch.float64) tensor(-11.0278, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6424, dtype=torch.float64) delta_t tensor(0.6528, dtype=torch.float64)
10 gae_duplicate tensor(0.3800, dtype=torch.float64) tensor(-14.1795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0152, dtype=torch.float64) delta_t tensor(0.1952, dtype=torch.float64)
9 gae_duplicate tensor(0.0743, dtype=torch.float64) tensor(-5.2259, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3839, dtype=torch.float64) delta_t tensor(-0.3508, dtype=torch.float64)
8 gae_duplicate tensor(-0.4608, dtype=torch.float64) tensor(6.3001, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7333, dtype=torch.float64) delta_t tensor(-0.6577, dtype=torch.float64)
7 gae_duplicate tensor(-1.0260, dtype=torch.float64) tensor(13.4876, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9603, dtype=torch.float64) delta_t tensor(-0.6408, dtype=torch.float64)
6 gae_duplicate tensor(-0.9737, dtype=torch.float64) tensor(14.0359, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2068, dtype=torch.float64) delta_t tensor(-0.7941, dtype=torch.float64)
5 gae_duplicate tensor(-1.0127, dtype=torch.float64) tensor(16.9766, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7987, dtype=torch.float64) delta_t tensor(-0.3664, dtype=torch.float64)
4 gae_duplicate tensor(-0.7406, dtype=torch.float64) tensor(9.0488, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.4575, dtype=torch.float64) delta_t tensor(-1.0682, dtype=torch.float64)
3 gae_duplicate tensor(-1.6069, dtype=torch.float64) tensor(22.0894, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5371, dtype=torch.float64) delta_t tensor(-0.1706, dtype=torch.float64)
2 gae_duplicate tensor(-0.7377, dtype=torch.float64) tensor(5.7078, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-829.7001953125
value loss:48.97942352294922
entropies:355.5436096191406
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.57172703742981 seconds
19 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(0.0993, dtype=torch.float64)
19 gae_duplicate tensor(-0.0345, dtype=torch.float64) tensor(-1.9380, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(0.0675, dtype=torch.float64)
18 gae_duplicate tensor(-0.0100, dtype=torch.float64) tensor(-1.5402, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9814, dtype=torch.float64) delta_t tensor(0.0699, dtype=torch.float64)
17 gae_duplicate tensor(0.0014, dtype=torch.float64) tensor(-1.5004, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(0.1071, dtype=torch.float64)
16 gae_duplicate tensor(0.0050, dtype=torch.float64) tensor(-2.2960, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.1111, dtype=torch.float64)
15 gae_duplicate tensor(0.0104, dtype=torch.float64) tensor(-2.3665, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9858, dtype=torch.float64) delta_t tensor(0.1226, dtype=torch.float64)
14 gae_duplicate tensor(0.0250, dtype=torch.float64) tensor(-2.6182, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(0.0729, dtype=torch.float64)
13 gae_duplicate tensor(0.0360, dtype=torch.float64) tensor(-1.6784, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.2211, dtype=torch.float64)
12 gae_duplicate tensor(0.0599, dtype=torch.float64) tensor(-4.6160, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9903, dtype=torch.float64) delta_t tensor(0.4936, dtype=torch.float64)
11 gae_duplicate tensor(0.3532, dtype=torch.float64) tensor(-10.1938, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6228, dtype=torch.float64) delta_t tensor(0.8211, dtype=torch.float64)
10 gae_duplicate tensor(0.7015, dtype=torch.float64) tensor(-17.5190, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2391, dtype=torch.float64) delta_t tensor(0.0210, dtype=torch.float64)
9 gae_duplicate tensor(0.0374, dtype=torch.float64) tensor(-2.1578, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6089, dtype=torch.float64) delta_t tensor(-0.4932, dtype=torch.float64)
8 gae_duplicate tensor(-0.6734, dtype=torch.float64) tensor(9.5105, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8550, dtype=torch.float64) delta_t tensor(-0.7419, dtype=torch.float64)
7 gae_duplicate tensor(-1.0006, dtype=torch.float64) tensor(15.5219, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0197, dtype=torch.float64) delta_t tensor(-0.6103, dtype=torch.float64)
6 gae_duplicate tensor(-0.7633, dtype=torch.float64) tensor(13.5947, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2480, dtype=torch.float64) delta_t tensor(-0.7076, dtype=torch.float64)
5 gae_duplicate tensor(-0.9163, dtype=torch.float64) tensor(14.9790, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9011, dtype=torch.float64) delta_t tensor(-0.3963, dtype=torch.float64)
4 gae_duplicate tensor(-0.5867, dtype=torch.float64) tensor(9.4628, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7534, dtype=torch.float64) delta_t tensor(-1.2686, dtype=torch.float64)
3 gae_duplicate tensor(-1.5331, dtype=torch.float64) tensor(25.8878, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9590, dtype=torch.float64) delta_t tensor(-0.4445, dtype=torch.float64)
2 gae_duplicate tensor(-1.0055, dtype=torch.float64) tensor(11.3671, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2898.5732421875
value loss:52.36747741699219
entropies:355.5432434082031
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0824713706970215 seconds
19 rew tensor(0.9787, dtype=torch.float64) delta_t tensor(0.1401, dtype=torch.float64)
19 gae_duplicate tensor(-0.0720, dtype=torch.float64) tensor(-2.7624, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(0.0883, dtype=torch.float64)
18 gae_duplicate tensor(-0.0303, dtype=torch.float64) tensor(-2.0471, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9815, dtype=torch.float64) delta_t tensor(0.0721, dtype=torch.float64)
17 gae_duplicate tensor(-0.0190, dtype=torch.float64) tensor(-1.5767, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9829, dtype=torch.float64) delta_t tensor(0.0932, dtype=torch.float64)
16 gae_duplicate tensor(-0.0063, dtype=torch.float64) tensor(-2.0677, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9844, dtype=torch.float64) delta_t tensor(0.1027, dtype=torch.float64)
15 gae_duplicate tensor(0.0142, dtype=torch.float64) tensor(-2.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9858, dtype=torch.float64) delta_t tensor(0.1248, dtype=torch.float64)
14 gae_duplicate tensor(0.0170, dtype=torch.float64) tensor(-2.7281, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9872, dtype=torch.float64) delta_t tensor(0.0882, dtype=torch.float64)
13 gae_duplicate tensor(0.0054, dtype=torch.float64) tensor(-1.9979, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9887, dtype=torch.float64) delta_t tensor(0.1720, dtype=torch.float64)
12 gae_duplicate tensor(0.0288, dtype=torch.float64) tensor(-3.5052, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9901, dtype=torch.float64) delta_t tensor(0.4835, dtype=torch.float64)
11 gae_duplicate tensor(0.4080, dtype=torch.float64) tensor(-10.0031, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6626, dtype=torch.float64) delta_t tensor(0.8082, dtype=torch.float64)
10 gae_duplicate tensor(0.7023, dtype=torch.float64) tensor(-17.0096, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1972, dtype=torch.float64) delta_t tensor(0.0435, dtype=torch.float64)
9 gae_duplicate tensor(0.0114, dtype=torch.float64) tensor(-2.5316, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5059, dtype=torch.float64) delta_t tensor(-0.3369, dtype=torch.float64)
8 gae_duplicate tensor(-0.5729, dtype=torch.float64) tensor(6.4549, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8553, dtype=torch.float64) delta_t tensor(-0.7990, dtype=torch.float64)
7 gae_duplicate tensor(-0.9621, dtype=torch.float64) tensor(16.7615, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0601, dtype=torch.float64) delta_t tensor(-0.6182, dtype=torch.float64)
6 gae_duplicate tensor(-0.8260, dtype=torch.float64) tensor(13.8108, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2681, dtype=torch.float64) delta_t tensor(-0.7278, dtype=torch.float64)
5 gae_duplicate tensor(-1.0115, dtype=torch.float64) tensor(15.6757, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8399, dtype=torch.float64) delta_t tensor(-0.3155, dtype=torch.float64)
4 gae_duplicate tensor(-0.4871, dtype=torch.float64) tensor(7.6724, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6405, dtype=torch.float64) delta_t tensor(-1.1520, dtype=torch.float64)
3 gae_duplicate tensor(-1.3065, dtype=torch.float64) tensor(23.7251, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6990, dtype=torch.float64) delta_t tensor(-0.1990, dtype=torch.float64)
2 gae_duplicate tensor(-0.6461, dtype=torch.float64) tensor(6.3225, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2362.478759765625
value loss:45.50398635864258
entropies:355.5626525878906
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0142998695373535 seconds
19 rew tensor(0.9784, dtype=torch.float64) delta_t tensor(0.1496, dtype=torch.float64)
19 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-2.9163, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9798, dtype=torch.float64) delta_t tensor(0.1761, dtype=torch.float64)
18 gae_duplicate tensor(-0.0117, dtype=torch.float64) tensor(-3.8312, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9811, dtype=torch.float64) delta_t tensor(0.1263, dtype=torch.float64)
17 gae_duplicate tensor(-0.0431, dtype=torch.float64) tensor(-2.8422, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.2058, dtype=torch.float64)
16 gae_duplicate tensor(-0.0364, dtype=torch.float64) tensor(-4.3508, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9839, dtype=torch.float64) delta_t tensor(0.2011, dtype=torch.float64)
15 gae_duplicate tensor(-0.0191, dtype=torch.float64) tensor(-4.2958, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(0.2048, dtype=torch.float64)
14 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-4.4043, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9867, dtype=torch.float64) delta_t tensor(0.1348, dtype=torch.float64)
13 gae_duplicate tensor(-0.0061, dtype=torch.float64) tensor(-3.2007, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9881, dtype=torch.float64) delta_t tensor(0.2431, dtype=torch.float64)
12 gae_duplicate tensor(0.0715, dtype=torch.float64) tensor(-5.1015, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9895, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
11 gae_duplicate tensor(0.4426, dtype=torch.float64) tensor(-10.5225, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6314, dtype=torch.float64) delta_t tensor(0.7753, dtype=torch.float64)
10 gae_duplicate tensor(0.6848, dtype=torch.float64) tensor(-16.1977, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0557, dtype=torch.float64) delta_t tensor(0.1842, dtype=torch.float64)
9 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-5.3160, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4242, dtype=torch.float64) delta_t tensor(-0.2832, dtype=torch.float64)
8 gae_duplicate tensor(-0.5368, dtype=torch.float64) tensor(5.0047, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7951, dtype=torch.float64) delta_t tensor(-0.5831, dtype=torch.float64)
7 gae_duplicate tensor(-0.7585, dtype=torch.float64) tensor(12.3686, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9908, dtype=torch.float64) delta_t tensor(-0.5582, dtype=torch.float64)
6 gae_duplicate tensor(-0.8121, dtype=torch.float64) tensor(12.2797, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3306, dtype=torch.float64) delta_t tensor(-0.8159, dtype=torch.float64)
5 gae_duplicate tensor(-1.0306, dtype=torch.float64) tensor(17.4615, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8809, dtype=torch.float64) delta_t tensor(-0.3548, dtype=torch.float64)
4 gae_duplicate tensor(-0.7716, dtype=torch.float64) tensor(8.9873, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6924, dtype=torch.float64) delta_t tensor(-1.2003, dtype=torch.float64)
3 gae_duplicate tensor(-1.3668, dtype=torch.float64) tensor(24.5430, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5047, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
2 gae_duplicate tensor(-0.6692, dtype=torch.float64) tensor(1.3346, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1122.022705078125
value loss:45.960426330566406
entropies:355.5421142578125
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3958.2939)
ToM Target loss= tensor(3468.6755)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.177250862121582 seconds
19 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
19 gae_duplicate tensor(-0.1468, dtype=torch.float64) tensor(-2.0877, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9798, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
18 gae_duplicate tensor(-0.0479, dtype=torch.float64) tensor(-0.9944, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.0124, dtype=torch.float64)
17 gae_duplicate tensor(-0.0502, dtype=torch.float64) tensor(-0.3645, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.0255, dtype=torch.float64)
16 gae_duplicate tensor(-0.0505, dtype=torch.float64) tensor(-0.5111, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9839, dtype=torch.float64) delta_t tensor(0.0385, dtype=torch.float64)
15 gae_duplicate tensor(-0.0412, dtype=torch.float64) tensor(-0.7707, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9852, dtype=torch.float64) delta_t tensor(0.0947, dtype=torch.float64)
14 gae_duplicate tensor(-0.0262, dtype=torch.float64) tensor(-1.9808, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9866, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
13 gae_duplicate tensor(-0.0281, dtype=torch.float64) tensor(-2.1444, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9879, dtype=torch.float64) delta_t tensor(0.2490, dtype=torch.float64)
12 gae_duplicate tensor(0.0163, dtype=torch.float64) tensor(-5.1026, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9893, dtype=torch.float64) delta_t tensor(0.5010, dtype=torch.float64)
11 gae_duplicate tensor(0.4539, dtype=torch.float64) tensor(-10.2649, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6519, dtype=torch.float64) delta_t tensor(0.8242, dtype=torch.float64)
10 gae_duplicate tensor(0.4903, dtype=torch.float64) tensor(-17.0074, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2199, dtype=torch.float64) delta_t tensor(0.0575, dtype=torch.float64)
9 gae_duplicate tensor(0.0146, dtype=torch.float64) tensor(-2.9868, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5682, dtype=torch.float64) delta_t tensor(-0.4103, dtype=torch.float64)
8 gae_duplicate tensor(-0.5511, dtype=torch.float64) tensor(7.6849, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7744, dtype=torch.float64) delta_t tensor(-0.4426, dtype=torch.float64)
7 gae_duplicate tensor(-0.9117, dtype=torch.float64) tensor(9.3943, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9807, dtype=torch.float64) delta_t tensor(-0.5112, dtype=torch.float64)
6 gae_duplicate tensor(-0.7085, dtype=torch.float64) tensor(10.8485, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3093, dtype=torch.float64) delta_t tensor(-0.6918, dtype=torch.float64)
5 gae_duplicate tensor(-0.9544, dtype=torch.float64) tensor(14.5799, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9427, dtype=torch.float64) delta_t tensor(-0.3830, dtype=torch.float64)
4 gae_duplicate tensor(-0.9052, dtype=torch.float64) tensor(8.9739, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6919, dtype=torch.float64) delta_t tensor(-1.1504, dtype=torch.float64)
3 gae_duplicate tensor(-1.3852, dtype=torch.float64) tensor(23.7582, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8233, dtype=torch.float64) delta_t tensor(-0.2573, dtype=torch.float64)
2 gae_duplicate tensor(-0.8629, dtype=torch.float64) tensor(7.5301, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2177.9306640625
value loss:43.20707702636719
entropies:355.505615234375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.155027151107788 seconds
19 rew tensor(0.9784, dtype=torch.float64) delta_t tensor(0.0063, dtype=torch.float64)
19 gae_duplicate tensor(-0.1466, dtype=torch.float64) tensor(-0.1629, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9797, dtype=torch.float64) delta_t tensor(0.0712, dtype=torch.float64)
18 gae_duplicate tensor(-0.0467, dtype=torch.float64) tensor(-1.4146, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(0.0618, dtype=torch.float64)
17 gae_duplicate tensor(-0.0625, dtype=torch.float64) tensor(-1.3093, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.1131, dtype=torch.float64)
16 gae_duplicate tensor(-0.0695, dtype=torch.float64) tensor(-2.3771, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(0.1076, dtype=torch.float64)
15 gae_duplicate tensor(-0.0643, dtype=torch.float64) tensor(-2.3286, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9850, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
14 gae_duplicate tensor(-0.0496, dtype=torch.float64) tensor(-2.3391, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.0744, dtype=torch.float64)
13 gae_duplicate tensor(-0.0378, dtype=torch.float64) tensor(-1.6682, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9876, dtype=torch.float64) delta_t tensor(0.2218, dtype=torch.float64)
12 gae_duplicate tensor(-0.0398, dtype=torch.float64) tensor(-4.5380, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9890, dtype=torch.float64) delta_t tensor(0.4905, dtype=torch.float64)
11 gae_duplicate tensor(0.3987, dtype=torch.float64) tensor(-10.0819, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5894, dtype=torch.float64) delta_t tensor(0.7611, dtype=torch.float64)
10 gae_duplicate tensor(0.5503, dtype=torch.float64) tensor(-15.9070, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1378, dtype=torch.float64) delta_t tensor(0.1477, dtype=torch.float64)
9 gae_duplicate tensor(0.0460, dtype=torch.float64) tensor(-4.5959, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5071, dtype=torch.float64) delta_t tensor(-0.3256, dtype=torch.float64)
8 gae_duplicate tensor(-0.6027, dtype=torch.float64) tensor(5.9905, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8355, dtype=torch.float64) delta_t tensor(-0.5934, dtype=torch.float64)
7 gae_duplicate tensor(-0.8174, dtype=torch.float64) tensor(12.3495, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0208, dtype=torch.float64) delta_t tensor(-0.5303, dtype=torch.float64)
6 gae_duplicate tensor(-0.7373, dtype=torch.float64) tensor(11.6075, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2881, dtype=torch.float64) delta_t tensor(-0.6574, dtype=torch.float64)
5 gae_duplicate tensor(-0.9188, dtype=torch.float64) tensor(14.5340, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8605, dtype=torch.float64) delta_t tensor(-0.2896, dtype=torch.float64)
4 gae_duplicate tensor(-0.4500, dtype=torch.float64) tensor(7.1100, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7427, dtype=torch.float64) delta_t tensor(-1.1953, dtype=torch.float64)
3 gae_duplicate tensor(-1.4694, dtype=torch.float64) tensor(24.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7317, dtype=torch.float64) delta_t tensor(-0.1643, dtype=torch.float64)
2 gae_duplicate tensor(-0.9293, dtype=torch.float64) tensor(5.7832, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1996.6806640625
value loss:42.592796325683594
entropies:355.4398498535156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.9244561195373535 seconds
19 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(0.0674, dtype=torch.float64)
19 gae_duplicate tensor(-0.1912, dtype=torch.float64) tensor(-1.3299, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9798, dtype=torch.float64) delta_t tensor(0.0722, dtype=torch.float64)
18 gae_duplicate tensor(-0.0949, dtype=torch.float64) tensor(-1.5383, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9811, dtype=torch.float64) delta_t tensor(0.0145, dtype=torch.float64)
17 gae_duplicate tensor(-0.0837, dtype=torch.float64) tensor(-0.4621, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.0303, dtype=torch.float64)
16 gae_duplicate tensor(-0.0801, dtype=torch.float64) tensor(-0.6522, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
15 gae_duplicate tensor(-0.0630, dtype=torch.float64) tensor(-0.8623, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(0.0865, dtype=torch.float64)
14 gae_duplicate tensor(-0.0384, dtype=torch.float64) tensor(-1.7870, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9862, dtype=torch.float64) delta_t tensor(0.0848, dtype=torch.float64)
13 gae_duplicate tensor(-0.0532, dtype=torch.float64) tensor(-1.9518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9875, dtype=torch.float64) delta_t tensor(0.0960, dtype=torch.float64)
12 gae_duplicate tensor(-0.0415, dtype=torch.float64) tensor(-2.0764, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9888, dtype=torch.float64) delta_t tensor(0.4857, dtype=torch.float64)
11 gae_duplicate tensor(0.4374, dtype=torch.float64) tensor(-9.6642, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6618, dtype=torch.float64) delta_t tensor(0.8203, dtype=torch.float64)
10 gae_duplicate tensor(0.7239, dtype=torch.float64) tensor(-16.8627, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2217, dtype=torch.float64) delta_t tensor(0.0566, dtype=torch.float64)
9 gae_duplicate tensor(0.0225, dtype=torch.float64) tensor(-2.8397, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4469, dtype=torch.float64) delta_t tensor(-0.1892, dtype=torch.float64)
8 gae_duplicate tensor(-0.4738, dtype=torch.float64) tensor(3.4636, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8574, dtype=torch.float64) delta_t tensor(-0.6553, dtype=torch.float64)
7 gae_duplicate tensor(-0.9516, dtype=torch.float64) tensor(13.2433, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0537, dtype=torch.float64) delta_t tensor(-0.5219, dtype=torch.float64)
6 gae_duplicate tensor(-0.6738, dtype=torch.float64) tensor(11.5149, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3319, dtype=torch.float64) delta_t tensor(-0.7433, dtype=torch.float64)
5 gae_duplicate tensor(-0.9507, dtype=torch.float64) tensor(15.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7801, dtype=torch.float64) delta_t tensor(-0.1869, dtype=torch.float64)
4 gae_duplicate tensor(-0.3438, dtype=torch.float64) tensor(5.2332, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5504, dtype=torch.float64) delta_t tensor(-1.0035, dtype=torch.float64)
3 gae_duplicate tensor(-1.1245, dtype=torch.float64) tensor(19.9768, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5382, dtype=torch.float64) delta_t tensor(-0.0559, dtype=torch.float64)
2 gae_duplicate tensor(-0.5077, dtype=torch.float64) tensor(3.1053, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1823.6536865234375
value loss:35.99392318725586
entropies:355.3036193847656
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.961066961288452 seconds
19 rew tensor(0.9785, dtype=torch.float64) delta_t tensor(0.0320, dtype=torch.float64)
19 gae_duplicate tensor(-0.1968, dtype=torch.float64) tensor(-0.6417, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9797, dtype=torch.float64) delta_t tensor(0.0976, dtype=torch.float64)
18 gae_duplicate tensor(-0.0975, dtype=torch.float64) tensor(-1.9847, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(0.0137, dtype=torch.float64)
17 gae_duplicate tensor(-0.0832, dtype=torch.float64) tensor(-0.5205, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9822, dtype=torch.float64) delta_t tensor(0.0717, dtype=torch.float64)
16 gae_duplicate tensor(-0.0797, dtype=torch.float64) tensor(-1.5697, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.0820, dtype=torch.float64)
15 gae_duplicate tensor(-0.0654, dtype=torch.float64) tensor(-1.7462, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.0914, dtype=torch.float64)
14 gae_duplicate tensor(-0.0430, dtype=torch.float64) tensor(-1.9789, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9859, dtype=torch.float64) delta_t tensor(0.0547, dtype=torch.float64)
13 gae_duplicate tensor(-0.0609, dtype=torch.float64) tensor(-1.2724, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9872, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
12 gae_duplicate tensor(-0.0660, dtype=torch.float64) tensor(-1.5420, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9885, dtype=torch.float64) delta_t tensor(0.4267, dtype=torch.float64)
11 gae_duplicate tensor(0.3256, dtype=torch.float64) tensor(-8.5518, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6609, dtype=torch.float64) delta_t tensor(0.8274, dtype=torch.float64)
10 gae_duplicate tensor(0.7000, dtype=torch.float64) tensor(-17.1689, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1402, dtype=torch.float64) delta_t tensor(0.1298, dtype=torch.float64)
9 gae_duplicate tensor(0.0655, dtype=torch.float64) tensor(-4.3161, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4069, dtype=torch.float64) delta_t tensor(-0.1285, dtype=torch.float64)
8 gae_duplicate tensor(-0.1977, dtype=torch.float64) tensor(2.0900, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8587, dtype=torch.float64) delta_t tensor(-0.5880, dtype=torch.float64)
7 gae_duplicate tensor(-0.7319, dtype=torch.float64) tensor(11.8884, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0442, dtype=torch.float64) delta_t tensor(-0.5166, dtype=torch.float64)
6 gae_duplicate tensor(-0.6331, dtype=torch.float64) tensor(11.5634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2918, dtype=torch.float64) delta_t tensor(-0.6904, dtype=torch.float64)
5 gae_duplicate tensor(-0.9075, dtype=torch.float64) tensor(14.7195, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7812, dtype=torch.float64) delta_t tensor(-0.1756, dtype=torch.float64)
4 gae_duplicate tensor(-0.3345, dtype=torch.float64) tensor(4.9669, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5924, dtype=torch.float64) delta_t tensor(-1.0249, dtype=torch.float64)
3 gae_duplicate tensor(-1.2490, dtype=torch.float64) tensor(20.5898, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5385, dtype=torch.float64) delta_t tensor(-0.0063, dtype=torch.float64)
2 gae_duplicate tensor(-0.2950, dtype=torch.float64) tensor(2.2253, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1540.438232421875
value loss:33.78670883178711
entropies:355.2455139160156
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.043428659439087 seconds
19 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(-0.1826, dtype=torch.float64)
19 gae_duplicate tensor(-0.2213, dtype=torch.float64) tensor(3.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0840, dtype=torch.float64)
18 gae_duplicate tensor(-0.1222, dtype=torch.float64) tensor(2.0469, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(-0.0810, dtype=torch.float64)
17 gae_duplicate tensor(-0.1141, dtype=torch.float64) tensor(1.7823, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(-0.0756, dtype=torch.float64)
16 gae_duplicate tensor(-0.1069, dtype=torch.float64) tensor(1.6103, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(-0.0308, dtype=torch.float64)
15 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(0.7634, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(-0.0158, dtype=torch.float64)
14 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(0.3921, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9861, dtype=torch.float64) delta_t tensor(0.0558, dtype=torch.float64)
13 gae_duplicate tensor(-0.0875, dtype=torch.float64) tensor(-1.1518, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9665, dtype=torch.float64) delta_t tensor(0.1115, dtype=torch.float64)
12 gae_duplicate tensor(-0.0433, dtype=torch.float64) tensor(-2.3048, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9469, dtype=torch.float64) delta_t tensor(0.3172, dtype=torch.float64)
11 gae_duplicate tensor(0.1167, dtype=torch.float64) tensor(-6.5016, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6401, dtype=torch.float64) delta_t tensor(0.8966, dtype=torch.float64)
10 gae_duplicate tensor(0.5552, dtype=torch.float64) tensor(-18.6450, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2827, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
9 gae_duplicate tensor(0.0279, dtype=torch.float64) tensor(-3.2968, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.6316, dtype=torch.float64) delta_t tensor(-0.3271, dtype=torch.float64)
8 gae_duplicate tensor(-0.6266, dtype=torch.float64) tensor(5.9453, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8790, dtype=torch.float64) delta_t tensor(-0.6956, dtype=torch.float64)
7 gae_duplicate tensor(-0.8903, dtype=torch.float64) tensor(14.0247, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0436, dtype=torch.float64) delta_t tensor(-0.4358, dtype=torch.float64)
6 gae_duplicate tensor(-0.5692, dtype=torch.float64) tensor(9.9735, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2503, dtype=torch.float64) delta_t tensor(-0.4545, dtype=torch.float64)
5 gae_duplicate tensor(-0.5801, dtype=torch.float64) tensor(9.9039, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9038, dtype=torch.float64) delta_t tensor(-0.2321, dtype=torch.float64)
4 gae_duplicate tensor(-0.4399, dtype=torch.float64) tensor(5.6119, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7049, dtype=torch.float64) delta_t tensor(-1.0879, dtype=torch.float64)
3 gae_duplicate tensor(-1.4926, dtype=torch.float64) tensor(21.4039, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-1.0215, dtype=torch.float64) delta_t tensor(-0.4111, dtype=torch.float64)
2 gae_duplicate tensor(-1.0651, dtype=torch.float64) tensor(10.3876, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-3098.472412109375
value loss:38.96672821044922
entropies:355.1202697753906
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3962.0369)
ToM Target loss= tensor(3467.7556)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.892443895339966 seconds
19 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(-0.0126, dtype=torch.float64)
19 gae_duplicate tensor(-0.2240, dtype=torch.float64) tensor(0.2666, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(0.0086, dtype=torch.float64)
18 gae_duplicate tensor(-0.1254, dtype=torch.float64) tensor(-0.1980, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.0078, dtype=torch.float64)
17 gae_duplicate tensor(-0.1311, dtype=torch.float64) tensor(-0.1533, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9824, dtype=torch.float64) delta_t tensor(0.0373, dtype=torch.float64)
16 gae_duplicate tensor(-0.1250, dtype=torch.float64) tensor(-0.7049, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(0.0814, dtype=torch.float64)
15 gae_duplicate tensor(-0.1076, dtype=torch.float64) tensor(-1.8065, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9847, dtype=torch.float64) delta_t tensor(0.1016, dtype=torch.float64)
14 gae_duplicate tensor(-0.0843, dtype=torch.float64) tensor(-2.1473, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9859, dtype=torch.float64) delta_t tensor(0.1011, dtype=torch.float64)
13 gae_duplicate tensor(-0.0928, dtype=torch.float64) tensor(-2.1758, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9670, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
12 gae_duplicate tensor(-0.0519, dtype=torch.float64) tensor(-1.6777, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9480, dtype=torch.float64) delta_t tensor(0.3748, dtype=torch.float64)
11 gae_duplicate tensor(-0.0099, dtype=torch.float64) tensor(-7.3903, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6506, dtype=torch.float64) delta_t tensor(0.8478, dtype=torch.float64)
10 gae_duplicate tensor(0.6308, dtype=torch.float64) tensor(-17.2502, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1797, dtype=torch.float64) delta_t tensor(0.1357, dtype=torch.float64)
9 gae_duplicate tensor(0.0593, dtype=torch.float64) tensor(-4.4418, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5066, dtype=torch.float64) delta_t tensor(-0.1282, dtype=torch.float64)
8 gae_duplicate tensor(-0.4000, dtype=torch.float64) tensor(2.0296, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8759, dtype=torch.float64) delta_t tensor(-0.5126, dtype=torch.float64)
7 gae_duplicate tensor(-0.8906, dtype=torch.float64) tensor(10.5485, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1229, dtype=torch.float64) delta_t tensor(-0.5115, dtype=torch.float64)
6 gae_duplicate tensor(-0.6932, dtype=torch.float64) tensor(11.0620, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3085, dtype=torch.float64) delta_t tensor(-0.5302, dtype=torch.float64)
5 gae_duplicate tensor(-0.7964, dtype=torch.float64) tensor(11.5173, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9819, dtype=torch.float64) delta_t tensor(-0.2893, dtype=torch.float64)
4 gae_duplicate tensor(-0.5632, dtype=torch.float64) tensor(6.8593, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.8541, dtype=torch.float64) delta_t tensor(-1.2115, dtype=torch.float64)
3 gae_duplicate tensor(-1.5841, dtype=torch.float64) tensor(24.2064, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.9343, dtype=torch.float64) delta_t tensor(-0.2538, dtype=torch.float64)
2 gae_duplicate tensor(-1.1671, dtype=torch.float64) tensor(7.2693, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-2029.79541015625
value loss:40.54030990600586
entropies:355.0829772949219
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1531078815460205 seconds
19 rew tensor(0.9788, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
19 gae_duplicate tensor(-0.2222, dtype=torch.float64) tensor(-0.1324, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(0.0066, dtype=torch.float64)
18 gae_duplicate tensor(-0.1230, dtype=torch.float64) tensor(-0.1033, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9811, dtype=torch.float64) delta_t tensor(-0.0121, dtype=torch.float64)
17 gae_duplicate tensor(-0.1120, dtype=torch.float64) tensor(0.1616, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.0170, dtype=torch.float64)
16 gae_duplicate tensor(-0.1100, dtype=torch.float64) tensor(-0.3202, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.0164, dtype=torch.float64)
15 gae_duplicate tensor(-0.0997, dtype=torch.float64) tensor(-0.3409, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.0748, dtype=torch.float64)
14 gae_duplicate tensor(-0.0859, dtype=torch.float64) tensor(-1.5810, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9857, dtype=torch.float64) delta_t tensor(-0.0699, dtype=torch.float64)
13 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(1.2155, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9869, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
12 gae_duplicate tensor(-0.0918, dtype=torch.float64) tensor(-1.2961, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9881, dtype=torch.float64) delta_t tensor(0.5134, dtype=torch.float64)
11 gae_duplicate tensor(0.4092, dtype=torch.float64) tensor(-10.2852, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6198, dtype=torch.float64) delta_t tensor(0.8108, dtype=torch.float64)
10 gae_duplicate tensor(0.7502, dtype=torch.float64) tensor(-17.2050, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1407, dtype=torch.float64) delta_t tensor(0.1530, dtype=torch.float64)
9 gae_duplicate tensor(0.1190, dtype=torch.float64) tensor(-4.6463, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4065, dtype=torch.float64) delta_t tensor(-0.1205, dtype=torch.float64)
8 gae_duplicate tensor(-0.2434, dtype=torch.float64) tensor(1.9035, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7558, dtype=torch.float64) delta_t tensor(-0.5018, dtype=torch.float64)
7 gae_duplicate tensor(-0.8696, dtype=torch.float64) tensor(10.1130, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9719, dtype=torch.float64) delta_t tensor(-0.4109, dtype=torch.float64)
6 gae_duplicate tensor(-0.5191, dtype=torch.float64) tensor(8.9196, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2292, dtype=torch.float64) delta_t tensor(-0.4957, dtype=torch.float64)
5 gae_duplicate tensor(-0.8564, dtype=torch.float64) tensor(10.7598, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8612, dtype=torch.float64) delta_t tensor(-0.2137, dtype=torch.float64)
4 gae_duplicate tensor(-0.5730, dtype=torch.float64) tensor(5.3229, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5394, dtype=torch.float64) delta_t tensor(-0.9305, dtype=torch.float64)
3 gae_duplicate tensor(-1.1339, dtype=torch.float64) tensor(19.2383, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5582, dtype=torch.float64) delta_t tensor(7.9711e-05, dtype=torch.float64)
2 gae_duplicate tensor(-0.4723, dtype=torch.float64) tensor(1.8198, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1367.2352294921875
value loss:29.718666076660156
entropies:355.1369323730469
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.851043224334717 seconds
19 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(0.0325, dtype=torch.float64)
19 gae_duplicate tensor(-0.1170, dtype=torch.float64) tensor(-0.6464, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(-0.0180, dtype=torch.float64)
18 gae_duplicate tensor(-0.1414, dtype=torch.float64) tensor(0.2753, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(-0.0579, dtype=torch.float64)
17 gae_duplicate tensor(-0.1422, dtype=torch.float64) tensor(1.1677, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(-0.0014, dtype=torch.float64)
16 gae_duplicate tensor(-0.1214, dtype=torch.float64) tensor(0.1690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(-0.0006, dtype=torch.float64)
15 gae_duplicate tensor(-0.1086, dtype=torch.float64) tensor(0.0266, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(0.0531, dtype=torch.float64)
14 gae_duplicate tensor(-0.1073, dtype=torch.float64) tensor(-1.0134, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9857, dtype=torch.float64) delta_t tensor(-0.0167, dtype=torch.float64)
13 gae_duplicate tensor(-0.0954, dtype=torch.float64) tensor(0.1751, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9869, dtype=torch.float64) delta_t tensor(0.0602, dtype=torch.float64)
12 gae_duplicate tensor(-0.1055, dtype=torch.float64) tensor(-1.2363, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9880, dtype=torch.float64) delta_t tensor(0.3873, dtype=torch.float64)
11 gae_duplicate tensor(0.3320, dtype=torch.float64) tensor(-7.7982, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6500, dtype=torch.float64) delta_t tensor(0.8543, dtype=torch.float64)
10 gae_duplicate tensor(0.7898, dtype=torch.float64) tensor(-17.5189, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2228, dtype=torch.float64) delta_t tensor(0.1048, dtype=torch.float64)
9 gae_duplicate tensor(0.1018, dtype=torch.float64) tensor(-3.8170, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4903, dtype=torch.float64) delta_t tensor(-0.1132, dtype=torch.float64)
8 gae_duplicate tensor(-0.3337, dtype=torch.float64) tensor(1.8923, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8595, dtype=torch.float64) delta_t tensor(-0.5108, dtype=torch.float64)
7 gae_duplicate tensor(-0.7951, dtype=torch.float64) tensor(10.2939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0751, dtype=torch.float64) delta_t tensor(-0.4738, dtype=torch.float64)
6 gae_duplicate tensor(-0.5694, dtype=torch.float64) tensor(10.3460, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2924, dtype=torch.float64) delta_t tensor(-0.5756, dtype=torch.float64)
5 gae_duplicate tensor(-0.8041, dtype=torch.float64) tensor(12.2620, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7395, dtype=torch.float64) delta_t tensor(-0.0612, dtype=torch.float64)
4 gae_duplicate tensor(-0.2722, dtype=torch.float64) tensor(2.4931, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5196, dtype=torch.float64) delta_t tensor(-0.8815, dtype=torch.float64)
3 gae_duplicate tensor(-1.1223, dtype=torch.float64) tensor(17.5765, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5684, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
2 gae_duplicate tensor(-0.4214, dtype=torch.float64) tensor(1.9738, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1533.441650390625
value loss:27.838560104370117
entropies:355.20233154296875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.902090072631836 seconds
19 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(-0.1084, dtype=torch.float64)
19 gae_duplicate tensor(-0.2262, dtype=torch.float64) tensor(2.1313, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
18 gae_duplicate tensor(-0.1587, dtype=torch.float64) tensor(1.6898, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(-0.0706, dtype=torch.float64)
17 gae_duplicate tensor(-0.1524, dtype=torch.float64) tensor(1.5432, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.0451, dtype=torch.float64)
16 gae_duplicate tensor(-0.1337, dtype=torch.float64) tensor(-0.7351, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.0405, dtype=torch.float64)
15 gae_duplicate tensor(-0.1249, dtype=torch.float64) tensor(-0.8955, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9845, dtype=torch.float64) delta_t tensor(0.0490, dtype=torch.float64)
14 gae_duplicate tensor(-0.1237, dtype=torch.float64) tensor(-1.0352, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9856, dtype=torch.float64) delta_t tensor(-0.0641, dtype=torch.float64)
13 gae_duplicate tensor(-0.1174, dtype=torch.float64) tensor(1.1824, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9867, dtype=torch.float64) delta_t tensor(0.0594, dtype=torch.float64)
12 gae_duplicate tensor(-0.1035, dtype=torch.float64) tensor(-1.0523, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9878, dtype=torch.float64) delta_t tensor(0.3783, dtype=torch.float64)
11 gae_duplicate tensor(0.3127, dtype=torch.float64) tensor(-7.5070, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6605, dtype=torch.float64) delta_t tensor(0.8673, dtype=torch.float64)
10 gae_duplicate tensor(0.8018, dtype=torch.float64) tensor(-18.0917, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2235, dtype=torch.float64) delta_t tensor(0.0877, dtype=torch.float64)
9 gae_duplicate tensor(0.0977, dtype=torch.float64) tensor(-3.4911, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4494, dtype=torch.float64) delta_t tensor(-0.0156, dtype=torch.float64)
8 gae_duplicate tensor(-0.1562, dtype=torch.float64) tensor(-0.0580, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8597, dtype=torch.float64) delta_t tensor(-0.4794, dtype=torch.float64)
7 gae_duplicate tensor(-0.7334, dtype=torch.float64) tensor(9.4939, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1278, dtype=torch.float64) delta_t tensor(-0.4379, dtype=torch.float64)
6 gae_duplicate tensor(-0.5567, dtype=torch.float64) tensor(9.6716, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3134, dtype=torch.float64) delta_t tensor(-0.5274, dtype=torch.float64)
5 gae_duplicate tensor(-0.7936, dtype=torch.float64) tensor(11.0610, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8026, dtype=torch.float64) delta_t tensor(-0.0843, dtype=torch.float64)
4 gae_duplicate tensor(-0.1917, dtype=torch.float64) tensor(2.8587, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6348, dtype=torch.float64) delta_t tensor(-0.9508, dtype=torch.float64)
3 gae_duplicate tensor(-1.1792, dtype=torch.float64) tensor(19.0436, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6326, dtype=torch.float64) delta_t tensor(-0.0186, dtype=torch.float64)
2 gae_duplicate tensor(-0.3398, dtype=torch.float64) tensor(2.2438, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-1610.7999267578125
value loss:27.746204376220703
entropies:355.2603454589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.0059919357299805 seconds
19 rew tensor(0.9791, dtype=torch.float64) delta_t tensor(0.0258, dtype=torch.float64)
19 gae_duplicate tensor(-0.2106, dtype=torch.float64) tensor(-0.5422, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.1116, dtype=torch.float64)
18 gae_duplicate tensor(-0.1583, dtype=torch.float64) tensor(-2.2275, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(0.1107, dtype=torch.float64)
17 gae_duplicate tensor(-0.1473, dtype=torch.float64) tensor(-2.3777, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.1057, dtype=torch.float64)
16 gae_duplicate tensor(-0.1499, dtype=torch.float64) tensor(-2.3890, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.1074, dtype=torch.float64)
15 gae_duplicate tensor(-0.1407, dtype=torch.float64) tensor(-2.3960, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9845, dtype=torch.float64) delta_t tensor(0.1261, dtype=torch.float64)
14 gae_duplicate tensor(-0.1013, dtype=torch.float64) tensor(-2.7400, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.2374, dtype=torch.float64)
13 gae_duplicate tensor(0.1823, dtype=torch.float64) tensor(-4.8508, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9451, dtype=torch.float64) delta_t tensor(0.0921, dtype=torch.float64)
12 gae_duplicate tensor(-0.0861, dtype=torch.float64) tensor(-2.2439, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9255, dtype=torch.float64) delta_t tensor(0.4019, dtype=torch.float64)
11 gae_duplicate tensor(0.0845, dtype=torch.float64) tensor(-8.2102, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6394, dtype=torch.float64) delta_t tensor(0.8250, dtype=torch.float64)
10 gae_duplicate tensor(0.7142, dtype=torch.float64) tensor(-17.1078, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.0396, dtype=torch.float64) delta_t tensor(0.3232, dtype=torch.float64)
9 gae_duplicate tensor(0.0645, dtype=torch.float64) tensor(-8.2004, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4503, dtype=torch.float64) delta_t tensor(-0.0192, dtype=torch.float64)
8 gae_duplicate tensor(-0.3123, dtype=torch.float64) tensor(-0.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8604, dtype=torch.float64) delta_t tensor(-0.2005, dtype=torch.float64)
7 gae_duplicate tensor(-0.4279, dtype=torch.float64) tensor(3.9315, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9437, dtype=torch.float64) delta_t tensor(-0.3162, dtype=torch.float64)
6 gae_duplicate tensor(-0.5120, dtype=torch.float64) tensor(6.6190, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2929, dtype=torch.float64) delta_t tensor(-0.4673, dtype=torch.float64)
5 gae_duplicate tensor(-0.7183, dtype=torch.float64) tensor(10.0712, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8843, dtype=torch.float64) delta_t tensor(-0.1536, dtype=torch.float64)
4 gae_duplicate tensor(-0.3109, dtype=torch.float64) tensor(4.0848, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6960, dtype=torch.float64) delta_t tensor(-0.9962, dtype=torch.float64)
3 gae_duplicate tensor(-1.2409, dtype=torch.float64) tensor(20.2825, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6647, dtype=torch.float64) delta_t tensor(0.0605, dtype=torch.float64)
2 gae_duplicate tensor(-0.6719, dtype=torch.float64) tensor(0.8548, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:330.4172058105469
value loss:29.813053131103516
entropies:355.2661437988281
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3961.0752)
ToM Target loss= tensor(3468.6206)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 4.963058233261108 seconds
19 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(-0.0454, dtype=torch.float64)
19 gae_duplicate tensor(-0.2525, dtype=torch.float64) tensor(0.8759, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(0.0148, dtype=torch.float64)
18 gae_duplicate tensor(-0.1574, dtype=torch.float64) tensor(-0.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9811, dtype=torch.float64) delta_t tensor(-0.0257, dtype=torch.float64)
17 gae_duplicate tensor(-0.1518, dtype=torch.float64) tensor(0.4374, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9822, dtype=torch.float64) delta_t tensor(0.0358, dtype=torch.float64)
16 gae_duplicate tensor(-0.1459, dtype=torch.float64) tensor(-0.7118, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(0.0398, dtype=torch.float64)
15 gae_duplicate tensor(-0.1315, dtype=torch.float64) tensor(-0.8613, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.0564, dtype=torch.float64)
14 gae_duplicate tensor(-0.1107, dtype=torch.float64) tensor(-1.1806, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(0.1635, dtype=torch.float64)
13 gae_duplicate tensor(0.0978, dtype=torch.float64) tensor(-3.3235, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9864, dtype=torch.float64) delta_t tensor(0.0416, dtype=torch.float64)
12 gae_duplicate tensor(-0.1075, dtype=torch.float64) tensor(-1.1520, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9875, dtype=torch.float64) delta_t tensor(0.4808, dtype=torch.float64)
11 gae_duplicate tensor(0.3221, dtype=torch.float64) tensor(-9.4843, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6186, dtype=torch.float64) delta_t tensor(0.8010, dtype=torch.float64)
10 gae_duplicate tensor(0.7774, dtype=torch.float64) tensor(-17.1363, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1835, dtype=torch.float64) delta_t tensor(0.1189, dtype=torch.float64)
9 gae_duplicate tensor(0.0499, dtype=torch.float64) tensor(-4.0238, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3681, dtype=torch.float64) delta_t tensor(0.1100, dtype=torch.float64)
8 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-2.5892, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8612, dtype=torch.float64) delta_t tensor(-0.2647, dtype=torch.float64)
7 gae_duplicate tensor(-0.2797, dtype=torch.float64) tensor(4.8629, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0983, dtype=torch.float64) delta_t tensor(-0.4060, dtype=torch.float64)
6 gae_duplicate tensor(-0.4852, dtype=torch.float64) tensor(8.5714, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3566, dtype=torch.float64) delta_t tensor(-0.5607, dtype=torch.float64)
5 gae_duplicate tensor(-0.7365, dtype=torch.float64) tensor(11.7775, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7835, dtype=torch.float64) delta_t tensor(-0.0306, dtype=torch.float64)
4 gae_duplicate tensor(-0.1728, dtype=torch.float64) tensor(1.7502, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5955, dtype=torch.float64) delta_t tensor(-0.8948, dtype=torch.float64)
3 gae_duplicate tensor(-1.0926, dtype=torch.float64) tensor(18.1370, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4578, dtype=torch.float64) delta_t tensor(0.2801, dtype=torch.float64)
2 gae_duplicate tensor(-0.0958, dtype=torch.float64) tensor(-3.8498, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-198.9420623779297
value loss:25.592388153076172
entropies:355.1744079589844
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.999178171157837 seconds
19 rew tensor(0.9792, dtype=torch.float64) delta_t tensor(-0.0773, dtype=torch.float64)
19 gae_duplicate tensor(-0.2668, dtype=torch.float64) tensor(1.5475, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(-0.0494, dtype=torch.float64)
18 gae_duplicate tensor(-0.1679, dtype=torch.float64) tensor(1.1540, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(-0.0630, dtype=torch.float64)
17 gae_duplicate tensor(-0.1543, dtype=torch.float64) tensor(1.3552, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(-0.0123, dtype=torch.float64)
16 gae_duplicate tensor(-0.1521, dtype=torch.float64) tensor(0.3996, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(-0.0048, dtype=torch.float64)
15 gae_duplicate tensor(-0.1343, dtype=torch.float64) tensor(0.0846, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9844, dtype=torch.float64) delta_t tensor(0.0738, dtype=torch.float64)
14 gae_duplicate tensor(-0.1088, dtype=torch.float64) tensor(-1.4871, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(0.0136, dtype=torch.float64)
13 gae_duplicate tensor(-0.1263, dtype=torch.float64) tensor(-0.4316, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9864, dtype=torch.float64) delta_t tensor(0.1420, dtype=torch.float64)
12 gae_duplicate tensor(-0.0903, dtype=torch.float64) tensor(-2.7998, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9875, dtype=torch.float64) delta_t tensor(0.3924, dtype=torch.float64)
11 gae_duplicate tensor(0.2861, dtype=torch.float64) tensor(-7.7996, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6082, dtype=torch.float64) delta_t tensor(0.8717, dtype=torch.float64)
10 gae_duplicate tensor(0.7295, dtype=torch.float64) tensor(-18.0004, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2034, dtype=torch.float64) delta_t tensor(0.1703, dtype=torch.float64)
9 gae_duplicate tensor(0.0915, dtype=torch.float64) tensor(-5.2127, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5116, dtype=torch.float64) delta_t tensor(-0.0451, dtype=torch.float64)
8 gae_duplicate tensor(-0.2537, dtype=torch.float64) tensor(0.3731, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8627, dtype=torch.float64) delta_t tensor(-0.3150, dtype=torch.float64)
7 gae_duplicate tensor(-0.6870, dtype=torch.float64) tensor(6.1779, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0072, dtype=torch.float64) delta_t tensor(-0.2939, dtype=torch.float64)
6 gae_duplicate tensor(-0.5318, dtype=torch.float64) tensor(6.4170, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2765, dtype=torch.float64) delta_t tensor(-0.4509, dtype=torch.float64)
5 gae_duplicate tensor(-0.7575, dtype=torch.float64) tensor(9.8007, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7838, dtype=torch.float64) delta_t tensor(-0.0244, dtype=torch.float64)
4 gae_duplicate tensor(-0.2043, dtype=torch.float64) tensor(1.4096, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5654, dtype=torch.float64) delta_t tensor(-0.8396, dtype=torch.float64)
3 gae_duplicate tensor(-1.0154, dtype=torch.float64) tensor(16.6918, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6096, dtype=torch.float64) delta_t tensor(0.0897, dtype=torch.float64)
2 gae_duplicate tensor(-0.4471, dtype=torch.float64) tensor(-0.0273, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-617.1228637695312
value loss:25.1535701751709
entropies:355.119140625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1788318157196045 seconds
19 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(-0.0816, dtype=torch.float64)
19 gae_duplicate tensor(-0.2673, dtype=torch.float64) tensor(1.6659, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9804, dtype=torch.float64) delta_t tensor(0.0003, dtype=torch.float64)
18 gae_duplicate tensor(-0.1704, dtype=torch.float64) tensor(0.2565, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9814, dtype=torch.float64) delta_t tensor(-0.0882, dtype=torch.float64)
17 gae_duplicate tensor(-0.1662, dtype=torch.float64) tensor(1.7780, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
16 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(1.6214, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9835, dtype=torch.float64) delta_t tensor(-0.0647, dtype=torch.float64)
15 gae_duplicate tensor(-0.1593, dtype=torch.float64) tensor(1.3847, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9845, dtype=torch.float64) delta_t tensor(-0.0169, dtype=torch.float64)
14 gae_duplicate tensor(-0.1498, dtype=torch.float64) tensor(0.4941, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9855, dtype=torch.float64) delta_t tensor(0.0574, dtype=torch.float64)
13 gae_duplicate tensor(-0.1403, dtype=torch.float64) tensor(-0.9795, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9865, dtype=torch.float64) delta_t tensor(0.0969, dtype=torch.float64)
12 gae_duplicate tensor(-0.1068, dtype=torch.float64) tensor(-2.0489, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9875, dtype=torch.float64) delta_t tensor(0.4262, dtype=torch.float64)
11 gae_duplicate tensor(0.2923, dtype=torch.float64) tensor(-8.6279, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5767, dtype=torch.float64) delta_t tensor(0.8719, dtype=torch.float64)
10 gae_duplicate tensor(0.4691, dtype=torch.float64) tensor(-17.9290, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3069, dtype=torch.float64) delta_t tensor(0.0655, dtype=torch.float64)
9 gae_duplicate tensor(0.0780, dtype=torch.float64) tensor(-3.0838, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5123, dtype=torch.float64) delta_t tensor(-0.0128, dtype=torch.float64)
8 gae_duplicate tensor(-0.4217, dtype=torch.float64) tensor(-0.1670, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8623, dtype=torch.float64) delta_t tensor(-0.3151, dtype=torch.float64)
7 gae_duplicate tensor(-0.6156, dtype=torch.float64) tensor(6.1415, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0484, dtype=torch.float64) delta_t tensor(-0.2520, dtype=torch.float64)
6 gae_duplicate tensor(-0.4520, dtype=torch.float64) tensor(5.4852, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2749, dtype=torch.float64) delta_t tensor(-0.2730, dtype=torch.float64)
5 gae_duplicate tensor(-0.6697, dtype=torch.float64) tensor(5.9091, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8661, dtype=torch.float64) delta_t tensor(-0.0728, dtype=torch.float64)
4 gae_duplicate tensor(-0.1870, dtype=torch.float64) tensor(2.0186, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6481, dtype=torch.float64) delta_t tensor(-0.8807, dtype=torch.float64)
3 gae_duplicate tensor(-1.0567, dtype=torch.float64) tensor(17.7218, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7665, dtype=torch.float64) delta_t tensor(0.0274, dtype=torch.float64)
2 gae_duplicate tensor(-0.6510, dtype=torch.float64) tensor(1.3491, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-797.3008422851562
value loss:25.370201110839844
entropies:355.01507568359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.027312278747559 seconds
19 rew tensor(0.9793, dtype=torch.float64) delta_t tensor(0.0713, dtype=torch.float64)
19 gae_duplicate tensor(-0.0307, dtype=torch.float64) tensor(-1.3851, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9803, dtype=torch.float64) delta_t tensor(0.0739, dtype=torch.float64)
18 gae_duplicate tensor(-0.1600, dtype=torch.float64) tensor(-1.5927, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9813, dtype=torch.float64) delta_t tensor(0.0081, dtype=torch.float64)
17 gae_duplicate tensor(-0.1619, dtype=torch.float64) tensor(-0.3191, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(0.0206, dtype=torch.float64)
16 gae_duplicate tensor(-0.1560, dtype=torch.float64) tensor(-0.3590, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(0.0277, dtype=torch.float64)
15 gae_duplicate tensor(-0.1387, dtype=torch.float64) tensor(-0.6071, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.0714, dtype=torch.float64)
14 gae_duplicate tensor(-0.1138, dtype=torch.float64) tensor(-1.4594, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(0.0702, dtype=torch.float64)
13 gae_duplicate tensor(-0.1444, dtype=torch.float64) tensor(-1.5163, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.0473, dtype=torch.float64)
12 gae_duplicate tensor(-0.1227, dtype=torch.float64) tensor(-1.1345, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9873, dtype=torch.float64) delta_t tensor(0.3777, dtype=torch.float64)
11 gae_duplicate tensor(0.2798, dtype=torch.float64) tensor(-7.6140, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6693, dtype=torch.float64) delta_t tensor(0.8537, dtype=torch.float64)
10 gae_duplicate tensor(0.7578, dtype=torch.float64) tensor(-18.1283, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1233, dtype=torch.float64) delta_t tensor(0.2258, dtype=torch.float64)
9 gae_duplicate tensor(0.0991, dtype=torch.float64) tensor(-6.2779, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4316, dtype=torch.float64) delta_t tensor(0.0542, dtype=torch.float64)
8 gae_duplicate tensor(-0.0276, dtype=torch.float64) tensor(-1.6978, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7811, dtype=torch.float64) delta_t tensor(-0.2409, dtype=torch.float64)
7 gae_duplicate tensor(-0.7424, dtype=torch.float64) tensor(4.4690, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0292, dtype=torch.float64) delta_t tensor(-0.2768, dtype=torch.float64)
6 gae_duplicate tensor(-0.4614, dtype=torch.float64) tensor(5.8634, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2357, dtype=torch.float64) delta_t tensor(-0.3426, dtype=torch.float64)
5 gae_duplicate tensor(-0.6995, dtype=torch.float64) tensor(7.6241, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8260, dtype=torch.float64) delta_t tensor(-0.0493, dtype=torch.float64)
4 gae_duplicate tensor(-0.2925, dtype=torch.float64) tensor(1.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.5774, dtype=torch.float64) delta_t tensor(-0.8167, dtype=torch.float64)
3 gae_duplicate tensor(-0.9532, dtype=torch.float64) tensor(16.2867, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5826, dtype=torch.float64) delta_t tensor(0.1275, dtype=torch.float64)
2 gae_duplicate tensor(-0.3125, dtype=torch.float64) tensor(-0.8093, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:274.6497802734375
value loss:22.548227310180664
entropies:354.9398193359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.057628870010376 seconds
19 rew tensor(0.9793, dtype=torch.float64) delta_t tensor(-0.0341, dtype=torch.float64)
19 gae_duplicate tensor(-0.2631, dtype=torch.float64) tensor(0.5813, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9803, dtype=torch.float64) delta_t tensor(-0.0564, dtype=torch.float64)
18 gae_duplicate tensor(-0.1640, dtype=torch.float64) tensor(1.1472, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(-0.0854, dtype=torch.float64)
17 gae_duplicate tensor(-0.1547, dtype=torch.float64) tensor(1.8775, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9822, dtype=torch.float64) delta_t tensor(-0.0598, dtype=torch.float64)
16 gae_duplicate tensor(-0.1656, dtype=torch.float64) tensor(1.2934, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9832, dtype=torch.float64) delta_t tensor(-0.0499, dtype=torch.float64)
15 gae_duplicate tensor(-0.1588, dtype=torch.float64) tensor(1.1177, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9841, dtype=torch.float64) delta_t tensor(-0.0099, dtype=torch.float64)
14 gae_duplicate tensor(-0.1434, dtype=torch.float64) tensor(0.3657, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(-0.0208, dtype=torch.float64)
13 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(0.4671, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9861, dtype=torch.float64) delta_t tensor(0.0706, dtype=torch.float64)
12 gae_duplicate tensor(-0.1003, dtype=torch.float64) tensor(-1.3542, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9871, dtype=torch.float64) delta_t tensor(0.3683, dtype=torch.float64)
11 gae_duplicate tensor(0.2319, dtype=torch.float64) tensor(-7.3348, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6177, dtype=torch.float64) delta_t tensor(0.8905, dtype=torch.float64)
10 gae_duplicate tensor(0.7002, dtype=torch.float64) tensor(-18.1108, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2058, dtype=torch.float64) delta_t tensor(0.1693, dtype=torch.float64)
9 gae_duplicate tensor(0.1148, dtype=torch.float64) tensor(-5.2692, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4728, dtype=torch.float64) delta_t tensor(0.0615, dtype=torch.float64)
8 gae_duplicate tensor(-0.2294, dtype=torch.float64) tensor(-1.7646, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8635, dtype=torch.float64) delta_t tensor(-0.1203, dtype=torch.float64)
7 gae_duplicate tensor(-0.3139, dtype=torch.float64) tensor(2.2056, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0392, dtype=torch.float64) delta_t tensor(-0.2758, dtype=torch.float64)
6 gae_duplicate tensor(-0.3556, dtype=torch.float64) tensor(5.8129, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3384, dtype=torch.float64) delta_t tensor(-0.3974, dtype=torch.float64)
5 gae_duplicate tensor(-0.6576, dtype=torch.float64) tensor(8.6582, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8468, dtype=torch.float64) delta_t tensor(-0.0252, dtype=torch.float64)
4 gae_duplicate tensor(-0.2044, dtype=torch.float64) tensor(1.3050, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6803, dtype=torch.float64) delta_t tensor(-0.8919, dtype=torch.float64)
3 gae_duplicate tensor(-1.1439, dtype=torch.float64) tensor(17.7750, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6658, dtype=torch.float64) delta_t tensor(0.1254, dtype=torch.float64)
2 gae_duplicate tensor(-0.6155, dtype=torch.float64) tensor(-0.8088, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-525.8927001953125
value loss:24.158262252807617
entropies:354.8928527832031
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3957.4431)
ToM Target loss= tensor(3480.1016)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.054322242736816 seconds
19 rew tensor(0.9795, dtype=torch.float64) delta_t tensor(-0.1337, dtype=torch.float64)
19 gae_duplicate tensor(-0.2628, dtype=torch.float64) tensor(2.6656, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9804, dtype=torch.float64) delta_t tensor(-0.0353, dtype=torch.float64)
18 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(1.0889, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9814, dtype=torch.float64) delta_t tensor(-0.0359, dtype=torch.float64)
17 gae_duplicate tensor(-0.1733, dtype=torch.float64) tensor(0.8227, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9823, dtype=torch.float64) delta_t tensor(-0.0336, dtype=torch.float64)
16 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.6363, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(-0.0232, dtype=torch.float64)
15 gae_duplicate tensor(-0.1460, dtype=torch.float64) tensor(0.5448, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(0.0348, dtype=torch.float64)
14 gae_duplicate tensor(-0.1325, dtype=torch.float64) tensor(-0.6925, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9852, dtype=torch.float64) delta_t tensor(-0.0322, dtype=torch.float64)
13 gae_duplicate tensor(-0.1628, dtype=torch.float64) tensor(0.5140, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9861, dtype=torch.float64) delta_t tensor(0.0330, dtype=torch.float64)
12 gae_duplicate tensor(-0.1044, dtype=torch.float64) tensor(-0.5558, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9665, dtype=torch.float64) delta_t tensor(0.3475, dtype=torch.float64)
11 gae_duplicate tensor(0.2259, dtype=torch.float64) tensor(-6.9840, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5973, dtype=torch.float64) delta_t tensor(0.8819, dtype=torch.float64)
10 gae_duplicate tensor(0.6431, dtype=torch.float64) tensor(-17.8057, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2053, dtype=torch.float64) delta_t tensor(0.1898, dtype=torch.float64)
9 gae_duplicate tensor(0.1152, dtype=torch.float64) tensor(-5.8114, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4929, dtype=torch.float64) delta_t tensor(0.0789, dtype=torch.float64)
8 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(-2.0494, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8638, dtype=torch.float64) delta_t tensor(-0.2985, dtype=torch.float64)
7 gae_duplicate tensor(-0.6971, dtype=torch.float64) tensor(5.9284, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0292, dtype=torch.float64) delta_t tensor(-0.2069, dtype=torch.float64)
6 gae_duplicate tensor(-0.3487, dtype=torch.float64) tensor(4.5918, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2774, dtype=torch.float64) delta_t tensor(-0.2413, dtype=torch.float64)
5 gae_duplicate tensor(-0.6567, dtype=torch.float64) tensor(5.2457, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8467, dtype=torch.float64) delta_t tensor(-0.0077, dtype=torch.float64)
4 gae_duplicate tensor(-0.1429, dtype=torch.float64) tensor(0.6803, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6391, dtype=torch.float64) delta_t tensor(-0.8284, dtype=torch.float64)
3 gae_duplicate tensor(-1.0154, dtype=torch.float64) tensor(16.5682, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6742, dtype=torch.float64) delta_t tensor(0.2074, dtype=torch.float64)
2 gae_duplicate tensor(-0.3816, dtype=torch.float64) tensor(-2.8211, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-234.4015350341797
value loss:23.50958251953125
entropies:354.7410888671875
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.119101047515869 seconds
19 rew tensor(0.9793, dtype=torch.float64) delta_t tensor(0.0026, dtype=torch.float64)
19 gae_duplicate tensor(-0.0778, dtype=torch.float64) tensor(-0.0755, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9803, dtype=torch.float64) delta_t tensor(-0.0487, dtype=torch.float64)
18 gae_duplicate tensor(-0.1788, dtype=torch.float64) tensor(0.9428, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9812, dtype=torch.float64) delta_t tensor(-0.0435, dtype=torch.float64)
17 gae_duplicate tensor(-0.1710, dtype=torch.float64) tensor(1.0201, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9821, dtype=torch.float64) delta_t tensor(0.0046, dtype=torch.float64)
16 gae_duplicate tensor(-0.1638, dtype=torch.float64) tensor(0.0202, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9831, dtype=torch.float64) delta_t tensor(0.0097, dtype=torch.float64)
15 gae_duplicate tensor(-0.1517, dtype=torch.float64) tensor(-0.1685, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9840, dtype=torch.float64) delta_t tensor(0.0669, dtype=torch.float64)
14 gae_duplicate tensor(-0.1244, dtype=torch.float64) tensor(-1.2833, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9849, dtype=torch.float64) delta_t tensor(-0.0507, dtype=torch.float64)
13 gae_duplicate tensor(-0.1579, dtype=torch.float64) tensor(0.7606, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9859, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
12 gae_duplicate tensor(-0.1496, dtype=torch.float64) tensor(-0.4736, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9868, dtype=torch.float64) delta_t tensor(0.3506, dtype=torch.float64)
11 gae_duplicate tensor(0.2757, dtype=torch.float64) tensor(-6.6986, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6891, dtype=torch.float64) delta_t tensor(0.8983, dtype=torch.float64)
10 gae_duplicate tensor(0.8290, dtype=torch.float64) tensor(-18.3795, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1244, dtype=torch.float64) delta_t tensor(0.2460, dtype=torch.float64)
9 gae_duplicate tensor(0.1649, dtype=torch.float64) tensor(-6.7761, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4326, dtype=torch.float64) delta_t tensor(0.1410, dtype=torch.float64)
8 gae_duplicate tensor(0.0299, dtype=torch.float64) tensor(-3.4870, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8440, dtype=torch.float64) delta_t tensor(-0.0882, dtype=torch.float64)
7 gae_duplicate tensor(-0.1614, dtype=torch.float64) tensor(1.3285, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0302, dtype=torch.float64) delta_t tensor(-0.2720, dtype=torch.float64)
6 gae_duplicate tensor(-0.3364, dtype=torch.float64) tensor(5.5759, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3597, dtype=torch.float64) delta_t tensor(-0.3876, dtype=torch.float64)
5 gae_duplicate tensor(-0.6443, dtype=torch.float64) tensor(8.0633, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8264, dtype=torch.float64) delta_t tensor(0.0077, dtype=torch.float64)
4 gae_duplicate tensor(-0.3047, dtype=torch.float64) tensor(0.6914, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6293, dtype=torch.float64) delta_t tensor(-0.8275, dtype=torch.float64)
3 gae_duplicate tensor(-1.1260, dtype=torch.float64) tensor(16.4442, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.5007, dtype=torch.float64) delta_t tensor(0.2991, dtype=torch.float64)
2 gae_duplicate tensor(-0.1502, dtype=torch.float64) tensor(-4.1211, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:261.5403747558594
value loss:22.694854736328125
entropies:354.5775146484375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.976078987121582 seconds
19 rew tensor(0.9792, dtype=torch.float64) delta_t tensor(-0.0029, dtype=torch.float64)
19 gae_duplicate tensor(-0.2790, dtype=torch.float64) tensor(0.1602, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9801, dtype=torch.float64) delta_t tensor(0.0027, dtype=torch.float64)
18 gae_duplicate tensor(-0.1802, dtype=torch.float64) tensor(-0.0973, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(-0.0515, dtype=torch.float64)
17 gae_duplicate tensor(-0.1822, dtype=torch.float64) tensor(0.8981, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9819, dtype=torch.float64) delta_t tensor(0.0301, dtype=torch.float64)
16 gae_duplicate tensor(-0.1616, dtype=torch.float64) tensor(-0.5897, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9828, dtype=torch.float64) delta_t tensor(0.0282, dtype=torch.float64)
15 gae_duplicate tensor(-0.1604, dtype=torch.float64) tensor(-0.6883, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9837, dtype=torch.float64) delta_t tensor(0.0595, dtype=torch.float64)
14 gae_duplicate tensor(-0.1594, dtype=torch.float64) tensor(-1.2292, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9846, dtype=torch.float64) delta_t tensor(-0.0134, dtype=torch.float64)
13 gae_duplicate tensor(-0.1509, dtype=torch.float64) tensor(0.1399, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9856, dtype=torch.float64) delta_t tensor(0.0079, dtype=torch.float64)
12 gae_duplicate tensor(-0.1360, dtype=torch.float64) tensor(-0.1342, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9865, dtype=torch.float64) delta_t tensor(0.3713, dtype=torch.float64)
11 gae_duplicate tensor(0.2379, dtype=torch.float64) tensor(-7.3305, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6478, dtype=torch.float64) delta_t tensor(0.8598, dtype=torch.float64)
10 gae_duplicate tensor(0.7758, dtype=torch.float64) tensor(-17.1826, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1441, dtype=torch.float64) delta_t tensor(0.2045, dtype=torch.float64)
9 gae_duplicate tensor(0.1108, dtype=torch.float64) tensor(-5.7899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.3916, dtype=torch.float64) delta_t tensor(0.2060, dtype=torch.float64)
8 gae_duplicate tensor(0.1645, dtype=torch.float64) tensor(-4.5275, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8444, dtype=torch.float64) delta_t tensor(-0.0349, dtype=torch.float64)
7 gae_duplicate tensor(-0.1393, dtype=torch.float64) tensor(0.3307, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0918, dtype=torch.float64) delta_t tensor(-0.3012, dtype=torch.float64)
6 gae_duplicate tensor(-0.3849, dtype=torch.float64) tensor(6.0441, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3608, dtype=torch.float64) delta_t tensor(-0.3522, dtype=torch.float64)
5 gae_duplicate tensor(-0.6008, dtype=torch.float64) tensor(7.4933, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8279, dtype=torch.float64) delta_t tensor(0.0241, dtype=torch.float64)
4 gae_duplicate tensor(-0.3061, dtype=torch.float64) tensor(0.3280, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6518, dtype=torch.float64) delta_t tensor(-0.8264, dtype=torch.float64)
3 gae_duplicate tensor(-1.1337, dtype=torch.float64) tensor(16.6632, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4908, dtype=torch.float64) delta_t tensor(0.3185, dtype=torch.float64)
2 gae_duplicate tensor(-0.1377, dtype=torch.float64) tensor(-4.9218, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:467.7192687988281
value loss:22.03606414794922
entropies:354.39007568359375
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1497581005096436 seconds
19 rew tensor(0.9791, dtype=torch.float64) delta_t tensor(-0.0298, dtype=torch.float64)
19 gae_duplicate tensor(-0.2734, dtype=torch.float64) tensor(0.6097, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0794, dtype=torch.float64)
18 gae_duplicate tensor(-0.1884, dtype=torch.float64) tensor(1.6576, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(-0.0894, dtype=torch.float64)
17 gae_duplicate tensor(-0.1776, dtype=torch.float64) tensor(1.9858, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(-0.0748, dtype=torch.float64)
16 gae_duplicate tensor(-0.1757, dtype=torch.float64) tensor(1.5793, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9827, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
15 gae_duplicate tensor(-0.1746, dtype=torch.float64) tensor(1.1378, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9836, dtype=torch.float64) delta_t tensor(-0.0407, dtype=torch.float64)
14 gae_duplicate tensor(-0.1751, dtype=torch.float64) tensor(0.9351, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9845, dtype=torch.float64) delta_t tensor(-0.0102, dtype=torch.float64)
13 gae_duplicate tensor(-0.1617, dtype=torch.float64) tensor(0.4893, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9854, dtype=torch.float64) delta_t tensor(0.0764, dtype=torch.float64)
12 gae_duplicate tensor(-0.1437, dtype=torch.float64) tensor(-1.4699, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9863, dtype=torch.float64) delta_t tensor(0.3798, dtype=torch.float64)
11 gae_duplicate tensor(0.1871, dtype=torch.float64) tensor(-7.5912, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6576, dtype=torch.float64) delta_t tensor(0.9296, dtype=torch.float64)
10 gae_duplicate tensor(0.7171, dtype=torch.float64) tensor(-19.1655, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2054, dtype=torch.float64) delta_t tensor(0.2072, dtype=torch.float64)
9 gae_duplicate tensor(0.1322, dtype=torch.float64) tensor(-5.7517, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.5352, dtype=torch.float64) delta_t tensor(0.0511, dtype=torch.float64)
8 gae_duplicate tensor(-0.3612, dtype=torch.float64) tensor(-1.4704, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8545, dtype=torch.float64) delta_t tensor(-0.0994, dtype=torch.float64)
7 gae_duplicate tensor(-0.3356, dtype=torch.float64) tensor(1.7222, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9881, dtype=torch.float64) delta_t tensor(-0.1197, dtype=torch.float64)
6 gae_duplicate tensor(-0.2864, dtype=torch.float64) tensor(2.5096, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3185, dtype=torch.float64) delta_t tensor(-0.1908, dtype=torch.float64)
5 gae_duplicate tensor(-0.2966, dtype=torch.float64) tensor(3.9383, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8677, dtype=torch.float64) delta_t tensor(0.0004, dtype=torch.float64)
4 gae_duplicate tensor(-0.0904, dtype=torch.float64) tensor(0.3534, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7116, dtype=torch.float64) delta_t tensor(-0.8483, dtype=torch.float64)
3 gae_duplicate tensor(-1.0844, dtype=torch.float64) tensor(16.4869, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8395, dtype=torch.float64) delta_t tensor(0.0268, dtype=torch.float64)
2 gae_duplicate tensor(-0.6888, dtype=torch.float64) tensor(1.1513, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-47.39654541015625
value loss:23.35530662536621
entropies:354.05523681640625
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.159203052520752 seconds
19 rew tensor(0.9791, dtype=torch.float64) delta_t tensor(-0.1020, dtype=torch.float64)
19 gae_duplicate tensor(-0.2781, dtype=torch.float64) tensor(1.9003, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0645, dtype=torch.float64)
18 gae_duplicate tensor(-0.1860, dtype=torch.float64) tensor(1.4535, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9808, dtype=torch.float64) delta_t tensor(-0.0490, dtype=torch.float64)
17 gae_duplicate tensor(-0.1763, dtype=torch.float64) tensor(1.1792, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(0.0434, dtype=torch.float64)
16 gae_duplicate tensor(-0.1666, dtype=torch.float64) tensor(-0.6794, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9826, dtype=torch.float64) delta_t tensor(0.0379, dtype=torch.float64)
15 gae_duplicate tensor(-0.1655, dtype=torch.float64) tensor(-0.8595, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9835, dtype=torch.float64) delta_t tensor(0.0424, dtype=torch.float64)
14 gae_duplicate tensor(-0.1647, dtype=torch.float64) tensor(-0.7964, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9844, dtype=torch.float64) delta_t tensor(-0.0942, dtype=torch.float64)
13 gae_duplicate tensor(-0.1661, dtype=torch.float64) tensor(1.8928, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9853, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
12 gae_duplicate tensor(-0.1424, dtype=torch.float64) tensor(-1.4197, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9861, dtype=torch.float64) delta_t tensor(0.3165, dtype=torch.float64)
11 gae_duplicate tensor(0.2518, dtype=torch.float64) tensor(-6.4903, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6163, dtype=torch.float64) delta_t tensor(0.8765, dtype=torch.float64)
10 gae_duplicate tensor(0.6511, dtype=torch.float64) tensor(-17.1168, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1650, dtype=torch.float64) delta_t tensor(0.2359, dtype=torch.float64)
9 gae_duplicate tensor(0.2364, dtype=torch.float64) tensor(-6.6222, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4942, dtype=torch.float64) delta_t tensor(0.1138, dtype=torch.float64)
8 gae_duplicate tensor(-0.3102, dtype=torch.float64) tensor(-2.7674, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8652, dtype=torch.float64) delta_t tensor(-0.1349, dtype=torch.float64)
7 gae_duplicate tensor(-0.3541, dtype=torch.float64) tensor(2.4623, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0408, dtype=torch.float64) delta_t tensor(-0.2071, dtype=torch.float64)
6 gae_duplicate tensor(-0.4208, dtype=torch.float64) tensor(4.3738, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2989, dtype=torch.float64) delta_t tensor(-0.2675, dtype=torch.float64)
5 gae_duplicate tensor(-0.6207, dtype=torch.float64) tensor(5.7572, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8066, dtype=torch.float64) delta_t tensor(0.0796, dtype=torch.float64)
4 gae_duplicate tensor(-0.1110, dtype=torch.float64) tensor(-0.9999, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6509, dtype=torch.float64) delta_t tensor(-0.7930, dtype=torch.float64)
3 gae_duplicate tensor(-1.1591, dtype=torch.float64) tensor(14.5749, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6236, dtype=torch.float64) delta_t tensor(0.1638, dtype=torch.float64)
2 gae_duplicate tensor(-0.5444, dtype=torch.float64) tensor(-1.9606, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:234.9137725830078
value loss:21.73480796813965
entropies:353.5741882324219
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3969.1780)
ToM Target loss= tensor(3481.3469)
optimized based on ToM loss
---------------------
gamma: 0.1
training start after waiting for 5.139859914779663 seconds
19 rew tensor(0.9790, dtype=torch.float64) delta_t tensor(-0.0643, dtype=torch.float64)
19 gae_duplicate tensor(-0.2639, dtype=torch.float64) tensor(1.0897, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9799, dtype=torch.float64) delta_t tensor(-0.0365, dtype=torch.float64)
18 gae_duplicate tensor(-0.1642, dtype=torch.float64) tensor(0.8949, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9807, dtype=torch.float64) delta_t tensor(-0.0488, dtype=torch.float64)
17 gae_duplicate tensor(-0.1641, dtype=torch.float64) tensor(1.2264, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9816, dtype=torch.float64) delta_t tensor(0.0336, dtype=torch.float64)
16 gae_duplicate tensor(-0.1505, dtype=torch.float64) tensor(-0.6409, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(0.0419, dtype=torch.float64)
15 gae_duplicate tensor(-0.1392, dtype=torch.float64) tensor(-0.9208, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9833, dtype=torch.float64) delta_t tensor(0.0726, dtype=torch.float64)
14 gae_duplicate tensor(-0.1175, dtype=torch.float64) tensor(-1.6108, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(-0.0264, dtype=torch.float64)
13 gae_duplicate tensor(-0.1747, dtype=torch.float64) tensor(0.3333, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(0.0252, dtype=torch.float64)
12 gae_duplicate tensor(-0.1293, dtype=torch.float64) tensor(-0.3975, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(0.3638, dtype=torch.float64)
11 gae_duplicate tensor(0.2317, dtype=torch.float64) tensor(-7.1736, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5957, dtype=torch.float64) delta_t tensor(0.8175, dtype=torch.float64)
10 gae_duplicate tensor(0.7070, dtype=torch.float64) tensor(-17.3257, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1245, dtype=torch.float64) delta_t tensor(0.2449, dtype=torch.float64)
9 gae_duplicate tensor(0.1329, dtype=torch.float64) tensor(-6.4899, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4129, dtype=torch.float64) delta_t tensor(0.2226, dtype=torch.float64)
8 gae_duplicate tensor(0.0919, dtype=torch.float64) tensor(-4.7289, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8660, dtype=torch.float64) delta_t tensor(-0.2094, dtype=torch.float64)
7 gae_duplicate tensor(-0.6176, dtype=torch.float64) tensor(3.5764, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0520, dtype=torch.float64) delta_t tensor(-0.2483, dtype=torch.float64)
6 gae_duplicate tensor(-0.4197, dtype=torch.float64) tensor(5.2718, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3207, dtype=torch.float64) delta_t tensor(-0.2615, dtype=torch.float64)
5 gae_duplicate tensor(-0.6182, dtype=torch.float64) tensor(5.8368, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.7870, dtype=torch.float64) delta_t tensor(0.0826, dtype=torch.float64)
4 gae_duplicate tensor(-0.0874, dtype=torch.float64) tensor(-0.9827, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6111, dtype=torch.float64) delta_t tensor(-0.7597, dtype=torch.float64)
3 gae_duplicate tensor(-0.9342, dtype=torch.float64) tensor(14.5227, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.4703, dtype=torch.float64) delta_t tensor(0.3204, dtype=torch.float64)
2 gae_duplicate tensor(-0.3023, dtype=torch.float64) tensor(-4.8027, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:570.0189819335938
value loss:20.43117904663086
entropies:353.1065368652344
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 4.8565168380737305 seconds
19 rew tensor(0.9792, dtype=torch.float64) delta_t tensor(-0.1430, dtype=torch.float64)
19 gae_duplicate tensor(-0.2725, dtype=torch.float64) tensor(3.0114, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0782, dtype=torch.float64)
18 gae_duplicate tensor(-0.1740, dtype=torch.float64) tensor(1.7318, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(-0.1022, dtype=torch.float64)
17 gae_duplicate tensor(-0.1665, dtype=torch.float64) tensor(2.1807, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(-0.0460, dtype=torch.float64)
16 gae_duplicate tensor(-0.1601, dtype=torch.float64) tensor(0.9690, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9826, dtype=torch.float64) delta_t tensor(-0.0047, dtype=torch.float64)
15 gae_duplicate tensor(-0.1624, dtype=torch.float64) tensor(0.1319, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.0115, dtype=torch.float64)
14 gae_duplicate tensor(-0.1578, dtype=torch.float64) tensor(-0.2107, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(-0.0777, dtype=torch.float64)
13 gae_duplicate tensor(-0.1507, dtype=torch.float64) tensor(1.4788, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(-0.0027, dtype=torch.float64)
12 gae_duplicate tensor(-0.1529, dtype=torch.float64) tensor(0.3266, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9860, dtype=torch.float64) delta_t tensor(0.3399, dtype=torch.float64)
11 gae_duplicate tensor(0.2537, dtype=torch.float64) tensor(-6.8547, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6057, dtype=torch.float64) delta_t tensor(0.8745, dtype=torch.float64)
10 gae_duplicate tensor(0.7673, dtype=torch.float64) tensor(-18.2703, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2286, dtype=torch.float64) delta_t tensor(0.1810, dtype=torch.float64)
9 gae_duplicate tensor(0.1858, dtype=torch.float64) tensor(-5.2217, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4961, dtype=torch.float64) delta_t tensor(0.1425, dtype=torch.float64)
8 gae_duplicate tensor(-0.1832, dtype=torch.float64) tensor(-3.1098, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8666, dtype=torch.float64) delta_t tensor(-0.0941, dtype=torch.float64)
7 gae_duplicate tensor(-0.3099, dtype=torch.float64) tensor(1.5311, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0526, dtype=torch.float64) delta_t tensor(-0.1221, dtype=torch.float64)
6 gae_duplicate tensor(-0.2625, dtype=torch.float64) tensor(2.5464, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3001, dtype=torch.float64) delta_t tensor(-0.1286, dtype=torch.float64)
5 gae_duplicate tensor(-0.4997, dtype=torch.float64) tensor(2.7416, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8078, dtype=torch.float64) delta_t tensor(0.1304, dtype=torch.float64)
4 gae_duplicate tensor(0.0478, dtype=torch.float64) tensor(-2.1910, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6109, dtype=torch.float64) delta_t tensor(-0.7338, dtype=torch.float64)
3 gae_duplicate tensor(-1.0391, dtype=torch.float64) tensor(14.1406, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.6670, dtype=torch.float64) delta_t tensor(0.1613, dtype=torch.float64)
2 gae_duplicate tensor(-0.5188, dtype=torch.float64) tensor(-1.6624, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:268.2202453613281
value loss:18.703792572021484
entropies:352.7048645019531
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.249074220657349 seconds
19 rew tensor(0.9792, dtype=torch.float64) delta_t tensor(-0.0887, dtype=torch.float64)
19 gae_duplicate tensor(-0.2550, dtype=torch.float64) tensor(1.7056, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9800, dtype=torch.float64) delta_t tensor(-0.0803, dtype=torch.float64)
18 gae_duplicate tensor(-0.1582, dtype=torch.float64) tensor(1.7335, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9809, dtype=torch.float64) delta_t tensor(-0.0987, dtype=torch.float64)
17 gae_duplicate tensor(-0.1800, dtype=torch.float64) tensor(2.0520, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9817, dtype=torch.float64) delta_t tensor(-0.0724, dtype=torch.float64)
16 gae_duplicate tensor(-0.1643, dtype=torch.float64) tensor(1.6128, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9825, dtype=torch.float64) delta_t tensor(-0.0496, dtype=torch.float64)
15 gae_duplicate tensor(-0.1633, dtype=torch.float64) tensor(1.0868, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(-0.0030, dtype=torch.float64)
14 gae_duplicate tensor(-0.1623, dtype=torch.float64) tensor(0.0344, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9842, dtype=torch.float64) delta_t tensor(-0.0712, dtype=torch.float64)
13 gae_duplicate tensor(-0.1782, dtype=torch.float64) tensor(1.3720, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9643, dtype=torch.float64) delta_t tensor(0.0468, dtype=torch.float64)
12 gae_duplicate tensor(-0.1458, dtype=torch.float64) tensor(-0.7162, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9651, dtype=torch.float64) delta_t tensor(0.3434, dtype=torch.float64)
11 gae_duplicate tensor(0.1037, dtype=torch.float64) tensor(-6.5194, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6467, dtype=torch.float64) delta_t tensor(0.9319, dtype=torch.float64)
10 gae_duplicate tensor(0.7645, dtype=torch.float64) tensor(-18.6526, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.1664, dtype=torch.float64) delta_t tensor(0.2215, dtype=torch.float64)
9 gae_duplicate tensor(0.2191, dtype=torch.float64) tensor(-5.9050, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4755, dtype=torch.float64) delta_t tensor(0.0169, dtype=torch.float64)
8 gae_duplicate tensor(-0.4787, dtype=torch.float64) tensor(-0.8920, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.7837, dtype=torch.float64) delta_t tensor(-0.0740, dtype=torch.float64)
7 gae_duplicate tensor(-0.3348, dtype=torch.float64) tensor(1.1994, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-0.9898, dtype=torch.float64) delta_t tensor(-0.0625, dtype=torch.float64)
6 gae_duplicate tensor(-0.2536, dtype=torch.float64) tensor(1.3466, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2791, dtype=torch.float64) delta_t tensor(-0.0935, dtype=torch.float64)
5 gae_duplicate tensor(-0.5379, dtype=torch.float64) tensor(2.1476, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8906, dtype=torch.float64) delta_t tensor(0.0160, dtype=torch.float64)
4 gae_duplicate tensor(-0.3100, dtype=torch.float64) tensor(-0.0924, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6518, dtype=torch.float64) delta_t tensor(-0.7393, dtype=torch.float64)
3 gae_duplicate tensor(-0.9276, dtype=torch.float64) tensor(14.0871, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7910, dtype=torch.float64) delta_t tensor(0.0862, dtype=torch.float64)
2 gae_duplicate tensor(-0.4574, dtype=torch.float64) tensor(-0.0929, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:147.4563446044922
value loss:20.765060424804688
entropies:352.4155578613281
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.020920991897583 seconds
19 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(-0.0550, dtype=torch.float64)
19 gae_duplicate tensor(-0.2523, dtype=torch.float64) tensor(0.9501, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(0.0043, dtype=torch.float64)
18 gae_duplicate tensor(-0.1856, dtype=torch.float64) tensor(0.0382, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(-0.0549, dtype=torch.float64)
17 gae_duplicate tensor(-0.1749, dtype=torch.float64) tensor(1.0795, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(-0.0425, dtype=torch.float64)
16 gae_duplicate tensor(-0.1790, dtype=torch.float64) tensor(0.8562, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9826, dtype=torch.float64) delta_t tensor(0.0013, dtype=torch.float64)
15 gae_duplicate tensor(-0.1715, dtype=torch.float64) tensor(0.3643, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(0.0382, dtype=torch.float64)
14 gae_duplicate tensor(-0.1362, dtype=torch.float64) tensor(-0.6518, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.0020, dtype=torch.float64)
13 gae_duplicate tensor(-0.1645, dtype=torch.float64) tensor(-0.2819, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9644, dtype=torch.float64) delta_t tensor(-0.0668, dtype=torch.float64)
12 gae_duplicate tensor(-0.1507, dtype=torch.float64) tensor(1.4573, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9444, dtype=torch.float64) delta_t tensor(0.3193, dtype=torch.float64)
11 gae_duplicate tensor(0.0038, dtype=torch.float64) tensor(-6.3652, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.5744, dtype=torch.float64) delta_t tensor(0.8430, dtype=torch.float64)
10 gae_duplicate tensor(0.6100, dtype=torch.float64) tensor(-16.5555, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.2481, dtype=torch.float64) delta_t tensor(0.1535, dtype=torch.float64)
9 gae_duplicate tensor(0.1168, dtype=torch.float64) tensor(-4.5211, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4546, dtype=torch.float64) delta_t tensor(0.2246, dtype=torch.float64)
8 gae_duplicate tensor(0.0940, dtype=torch.float64) tensor(-5.0291, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8555, dtype=torch.float64) delta_t tensor(-0.0666, dtype=torch.float64)
7 gae_duplicate tensor(-0.6545, dtype=torch.float64) tensor(0.6444, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.0925, dtype=torch.float64) delta_t tensor(-0.1779, dtype=torch.float64)
6 gae_duplicate tensor(-0.3059, dtype=torch.float64) tensor(3.6742, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.2784, dtype=torch.float64) delta_t tensor(0.0267, dtype=torch.float64)
5 gae_duplicate tensor(-0.1473, dtype=torch.float64) tensor(-0.1232, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.9104, dtype=torch.float64) delta_t tensor(0.0678, dtype=torch.float64)
4 gae_duplicate tensor(-0.0432, dtype=torch.float64) tensor(-1.3418, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.7448, dtype=torch.float64) delta_t tensor(-0.8263, dtype=torch.float64)
3 gae_duplicate tensor(-1.1898, dtype=torch.float64) tensor(15.5624, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.8427, dtype=torch.float64) delta_t tensor(0.0774, dtype=torch.float64)
2 gae_duplicate tensor(-0.7740, dtype=torch.float64) tensor(-0.0725, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:461.9926452636719
value loss:20.809560775756836
entropies:352.01300048828125
Policy training finished
---------------------
gamma: 0.1
training start after waiting for 5.1189539432525635 seconds
19 rew tensor(0.9794, dtype=torch.float64) delta_t tensor(-0.1748, dtype=torch.float64)
19 gae_duplicate tensor(-0.2840, dtype=torch.float64) tensor(3.5907, dtype=torch.float64, grad_fn=<SumBackward0>)
18 rew tensor(0.9802, dtype=torch.float64) delta_t tensor(-0.1093, dtype=torch.float64)
18 gae_duplicate tensor(-0.1878, dtype=torch.float64) tensor(2.4693, dtype=torch.float64, grad_fn=<SumBackward0>)
17 rew tensor(0.9810, dtype=torch.float64) delta_t tensor(-0.1518, dtype=torch.float64)
17 gae_duplicate tensor(-0.1772, dtype=torch.float64) tensor(3.1713, dtype=torch.float64, grad_fn=<SumBackward0>)
16 rew tensor(0.9818, dtype=torch.float64) delta_t tensor(-0.1466, dtype=torch.float64)
16 gae_duplicate tensor(-0.1754, dtype=torch.float64) tensor(3.1606, dtype=torch.float64, grad_fn=<SumBackward0>)
15 rew tensor(0.9826, dtype=torch.float64) delta_t tensor(-0.1357, dtype=torch.float64)
15 gae_duplicate tensor(-0.1680, dtype=torch.float64) tensor(2.8815, dtype=torch.float64, grad_fn=<SumBackward0>)
14 rew tensor(0.9834, dtype=torch.float64) delta_t tensor(-0.0779, dtype=torch.float64)
14 gae_duplicate tensor(-0.1635, dtype=torch.float64) tensor(1.9729, dtype=torch.float64, grad_fn=<SumBackward0>)
13 rew tensor(0.9843, dtype=torch.float64) delta_t tensor(0.0146, dtype=torch.float64)
13 gae_duplicate tensor(-0.1627, dtype=torch.float64) tensor(-0.1142, dtype=torch.float64, grad_fn=<SumBackward0>)
12 rew tensor(0.9851, dtype=torch.float64) delta_t tensor(-0.0113, dtype=torch.float64)
12 gae_duplicate tensor(-0.1116, dtype=torch.float64) tensor(0.1731, dtype=torch.float64, grad_fn=<SumBackward0>)
11 rew tensor(0.9859, dtype=torch.float64) delta_t tensor(0.3626, dtype=torch.float64)
11 gae_duplicate tensor(0.1606, dtype=torch.float64) tensor(-6.6969, dtype=torch.float64, grad_fn=<SumBackward0>)
10 rew tensor(0.6469, dtype=torch.float64) delta_t tensor(0.9387, dtype=torch.float64)
10 gae_duplicate tensor(0.8379, dtype=torch.float64) tensor(-18.9495, dtype=torch.float64, grad_fn=<SumBackward0>)
9 rew tensor(-0.3097, dtype=torch.float64) delta_t tensor(0.0837, dtype=torch.float64)
9 gae_duplicate tensor(0.1039, dtype=torch.float64) tensor(-3.5800, dtype=torch.float64, grad_fn=<SumBackward0>)
8 rew tensor(-0.4943, dtype=torch.float64) delta_t tensor(0.1836, dtype=torch.float64)
8 gae_duplicate tensor(-0.1785, dtype=torch.float64) tensor(-4.1817, dtype=torch.float64, grad_fn=<SumBackward0>)
7 rew tensor(-0.8860, dtype=torch.float64) delta_t tensor(-0.0704, dtype=torch.float64)
7 gae_duplicate tensor(-0.4035, dtype=torch.float64) tensor(0.9378, dtype=torch.float64, grad_fn=<SumBackward0>)
6 rew tensor(-1.1026, dtype=torch.float64) delta_t tensor(-0.1314, dtype=torch.float64)
6 gae_duplicate tensor(-0.3457, dtype=torch.float64) tensor(2.8655, dtype=torch.float64, grad_fn=<SumBackward0>)
5 rew tensor(-1.3611, dtype=torch.float64) delta_t tensor(-0.0661, dtype=torch.float64)
5 gae_duplicate tensor(-0.3094, dtype=torch.float64) tensor(1.7278, dtype=torch.float64, grad_fn=<SumBackward0>)
4 rew tensor(-0.8475, dtype=torch.float64) delta_t tensor(0.1178, dtype=torch.float64)
4 gae_duplicate tensor(0.0351, dtype=torch.float64) tensor(-2.1917, dtype=torch.float64, grad_fn=<SumBackward0>)
3 rew tensor(-1.6294, dtype=torch.float64) delta_t tensor(-0.7103, dtype=torch.float64)
3 gae_duplicate tensor(-0.9930, dtype=torch.float64) tensor(14.2093, dtype=torch.float64, grad_fn=<SumBackward0>)
2 rew tensor(-0.7253, dtype=torch.float64) delta_t tensor(0.1105, dtype=torch.float64)
2 gae_duplicate tensor(-0.5975, dtype=torch.float64) tensor(-1.0725, dtype=torch.float64, grad_fn=<SumBackward0>)
policy loss:-115.09139251708984
value loss:19.519149780273438
entropies:351.60931396484375
Policy training finished
---------------------
ToM training started
ToM data loaded
ToM_loss = tensor(3967.9424)
ToM Target loss= tensor(3489.5759)
optimized based on ToM loss
---------------------
gamma: 0.1
Process Process-9:
Traceback (most recent call last):
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/Users/suhuangyuan/DRA/ToM2C/train.py", line 452, in train
    if train_modes[rank] != -10:
  File "<string>", line 2, in __getitem__
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/managers.py", line 810, in _callmethod
    kind, result = conn.recv()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/Users/suhuangyuan/miniconda3/envs/resource/lib/python3.9/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt